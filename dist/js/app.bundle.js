!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=230)}([function(t,e,n){"use strict";n.r(e),n.d(e,"getParent",function(){return u}),n.d(e,"closest",function(){return c}),n.d(e,"closestDown",function(){return f}),n.d(e,"isChildOf",function(){return h}),n.d(e,"isChildOfWebComponentTable",function(){return d}),n.d(e,"polymerWrap",function(){return p}),n.d(e,"polymerUnwrap",function(){return g}),n.d(e,"index",function(){return v}),n.d(e,"overlayContainsElement",function(){return y}),n.d(e,"hasClass",function(){return C}),n.d(e,"addClass",function(){return O}),n.d(e,"removeClass",function(){return E}),n.d(e,"removeTextNodes",function(){return S}),n.d(e,"empty",function(){return k}),n.d(e,"HTML_CHARACTERS",function(){return T}),n.d(e,"fastInnerHTML",function(){return M}),n.d(e,"fastInnerText",function(){return _}),n.d(e,"isVisible",function(){return N}),n.d(e,"offset",function(){return A}),n.d(e,"getWindowScrollTop",function(){return x}),n.d(e,"getWindowScrollLeft",function(){return j}),n.d(e,"getScrollTop",function(){return I}),n.d(e,"getScrollLeft",function(){return D}),n.d(e,"getScrollableElement",function(){return P}),n.d(e,"getTrimmingContainer",function(){return L}),n.d(e,"getStyle",function(){return H}),n.d(e,"getComputedStyle",function(){return F}),n.d(e,"outerWidth",function(){return B}),n.d(e,"outerHeight",function(){return W}),n.d(e,"innerHeight",function(){return V}),n.d(e,"innerWidth",function(){return U}),n.d(e,"addEvent",function(){return Y}),n.d(e,"removeEvent",function(){return z}),n.d(e,"getCaretPosition",function(){return G}),n.d(e,"getSelectionEndPosition",function(){return X}),n.d(e,"getSelectionText",function(){return q}),n.d(e,"clearTextSelection",function(){return K}),n.d(e,"setCaretPosition",function(){return $}),n.d(e,"getScrollbarWidth",function(){return Z}),n.d(e,"hasVerticalScrollbar",function(){return Q}),n.d(e,"hasHorizontalScrollbar",function(){return J}),n.d(e,"setOverlayPosition",function(){return tt}),n.d(e,"getCssTransform",function(){return et}),n.d(e,"resetCssTransform",function(){return nt}),n.d(e,"isInput",function(){return rt}),n.d(e,"isOutsideInput",function(){return ot}),n.d(e,"selectElementIfAllowed",function(){return it});n(10),n(11),n(12),n(24),n(29),n(44),n(21),n(7),n(64),n(35),n(6),n(125),n(26),n(50),n(8),n(52),n(61),n(107),n(9);var r,o,i,a=n(40),s=n(34);function l(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,o=t;null!==o;){if(n===e){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(n+=1,o=o.parentNode)}return r}function c(t,e,n){for(var r=t;null!==r&&r!==n;){if(r.nodeType===Node.ELEMENT_NODE&&(e.indexOf(r.nodeName)>-1||e.indexOf(r)>-1))return r;r=r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r.host:r.parentNode}return null}function f(t,e,n){for(var r=[],o=t;o&&(o=c(o,e,n))&&(!n||n.contains(o));)r.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode;var i=r.length;return i?r[i-1]:null}function h(t,e){var n=t.parentNode,r=[];for("string"==typeof e?r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function d(t){var e="hot-table",n=!1,r=p(t);function o(t){return t.nodeType===Node.ELEMENT_NODE&&t.nodeName===e.toUpperCase()}for(;null!==r;){if(o(r)){n=!0;break}if(r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n=o(r.host))break;r=r.host}r=r.parentNode}return n}function p(t){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(t):t}function g(t){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(t):t}function v(t){var e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function y(t,e){var n=e.ownerDocument.querySelector(".ht_clone_".concat(t));return n?n.contains(e):null}function m(t){var e=[];if(!t||!t.length)return e;for(var n=0;t[n];)e.push(t[n]),n+=1;return e}if(Object(s.isClassListSupported)()){var b=function(t){var e=t.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")};r=function(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)},o=function(t,e){var n,r=t.ownerDocument,o=e;if("string"==typeof o&&(o=o.split(" ")),(o=m(o)).length>0)if(b(r))(n=t.classList).add.apply(n,l(o));else for(var i=0;o&&o[i];)t.classList.add(o[i]),i+=1},i=function(t,e){var n,r=e;if("string"==typeof r&&(r=r.split(" ")),(r=m(r)).length>0)if(b)(n=t.classList).remove.apply(n,l(r));else for(var o=0;r&&r[o];)t.classList.remove(r[o]),o+=1}}else{var w=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};r=function(t,e){return void 0!==t.className&&w(e).test(t.className)},o=function(t,e){var n=0,r=t.className,o=e;if("string"==typeof o&&(o=o.split(" ")),""===r)r=o.join(" ");else for(;o&&o[n];)w(o[n]).test(r)||(r+=" ".concat(o[n])),n+=1;t.className=r},i=function(t,e){var n=0,r=t.className,o=e;for("string"==typeof o&&(o=o.split(" "));o&&o[n];)r=r.replace(w(o[n])," ").trim(),n+=1;t.className!==r&&(t.className=r)}}function C(t,e){return r(t,e)}function O(t,e){return o(t,e)}function E(t,e){return i(t,e)}function S(t,e){if(3===t.nodeType)e.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var n=t.childNodes,r=n.length-1;r>=0;r--)S(n[r],t)}function k(t){for(var e;e=t.lastChild;)t.removeChild(e)}var R,T=/(<(.*)>|&(.*);)/;function M(t,e){T.test(e)?t.innerHTML=e:_(t,e)}function _(t,e){var n=t.firstChild;n&&3===n.nodeType&&null===n.nextSibling?s.isTextContentSupported?n.textContent=e:n.data=e:(k(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function N(t){for(var e=t.ownerDocument.documentElement,n=t;g(n)!==e;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return N(n.host.impl);if(n.host)return N(n.host);throw new Error("Lost in Web Components world")}return!1}if(n.style&&"none"===n.style.display)return!1;n=n.parentNode}return!0}function A(t){var e,n,r,o,i=t.ownerDocument,a=i.defaultView,l=i.documentElement,u=t;if(Object(s.hasCaptionProblem)()&&u.firstChild&&"CAPTION"===u.firstChild.nodeName)return{top:(o=u.getBoundingClientRect()).top+(a.pageYOffset||l.scrollTop)-(l.clientTop||0),left:o.left+(a.pageXOffset||l.scrollLeft)-(l.clientLeft||0)};for(e=u.offsetLeft,n=u.offsetTop,r=u;(u=u.offsetParent)&&u!==i.body;)e+=u.offsetLeft,n+=u.offsetTop,r=u;return r&&"fixed"===r.style.position&&(e+=a.pageXOffset||l.scrollLeft,n+=a.pageYOffset||l.scrollTop),{left:e,top:n}}function x(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollY;return void 0===e&&(e=t.document.documentElement.scrollTop),e}function j(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollX;return void 0===e&&(e=t.document.documentElement.scrollLeft),e}function I(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?x(e):t.scrollTop}function D(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?j(e):t.scrollLeft}function P(t){var e=t.ownerDocument,n=e?e.defaultView:void 0;e||(n=(e=t.document?t.document:t).defaultView);for(var r=["auto","scroll"],o=Object(s.isGetComputedStyleSupported)(),i=t.parentNode;i&&i.style&&e.body!==i;){var a=i.style,l=a.overflow,u=a.overflowX,c=a.overflowY;if([l,u,c].includes("scroll"))return i;if(o){var f=n.getComputedStyle(i);if(l=f.overflow,u=f.overflowX,c=f.overflowY,r.includes(l)||r.includes(u)||r.includes(c))return i}if(i.clientHeight<=i.scrollHeight+1&&(r.includes(c)||r.includes(l)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(u)||r.includes(l)))return i;i=i.parentNode}return n}function L(t){for(var e=t.ownerDocument,n=e.defaultView,r=t.parentNode;r&&r.style&&e.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;var o=F(r,n),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),s=o.getPropertyValue("overflow-y"),l=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(s)||i.includes(l))return r;r=r.parentNode}return n}function H(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(t){if(t===n)return"width"===e?"".concat(n.innerWidth,"px"):"height"===e?"".concat(n.innerHeight,"px"):void 0;var r=t.style[e];if(""!==r&&void 0!==r)return r;var o=F(t,n);return""!==o[e]&&void 0!==o[e]?o[e]:void 0}}function F(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function B(t){return t.offsetWidth}function W(t){return Object(s.hasCaptionProblem)()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight}function V(t){return t.clientHeight||t.innerHeight}function U(t){return t.clientWidth||t.innerWidth}function Y(t,e,n){var r=t.defaultView;r||(r=t.document?t:t.ownerDocument.defaultView),r.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on".concat(e),n)}function z(t,e,n){var r=t.defaultView;r||(r=t.document?t:t.ownerDocument.defaultView),r.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on".concat(e),n)}function G(t){var e=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(e.selection){t.focus();var n=e.selection.createRange();if(null===n)return 0;var r=t.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function X(t){var e=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(e.selection){var n=e.selection.createRange();return null===n?0:t.createTextRange().text.indexOf(n.text)+n.text.length}return 0}function q(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document,n="";return t.getSelection?n=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(n=e.selection.createRange().text),n}function K(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():e.selection&&e.selection.empty()}function $(t,e,n){if(void 0===n&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch(i){var r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=o}}else if(t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",e),i.select()}}function Z(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===R&&(R=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";var n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);var r=e.offsetWidth;n.style.overflow="scroll";var o=e.offsetWidth;return r===o&&(o=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-o}(t)),R}function Q(t){return t.offsetWidth!==t.clientWidth}function J(t){return t.offsetHeight!==t.clientHeight}function tt(t,e,n){Object(a.isIE8)()||Object(a.isIE9)()?(t.style.top=n,t.style.left=e):Object(a.isSafari)()?(t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(n,",0)"),t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(n,",0)")):t.style.transform="translate3d(".concat(e,",").concat(n,",0)")}function et(t){var e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:t.style["-webkit-transform"]&&""!==(e=t.style["-webkit-transform"])?["-webkit-transform",e]:-1}function nt(t){t.style.transform&&""!==t.style.transform?t.style.transform="":t.style["-webkit-transform"]&&""!==t.style["-webkit-transform"]&&(t.style["-webkit-transform"]="")}function rt(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function ot(t){return rt(t)&&-1===t.className.indexOf("handsontableInput")&&-1===t.className.indexOf("copyPaste")}function it(t){ot(t.ownerDocument.activeElement)||t.select()}},function(t,e,n){"use strict";n.r(e),n.d(e,"to2dArray",function(){return r}),n.d(e,"extendArray",function(){return o}),n.d(e,"pivot",function(){return i}),n.d(e,"arrayReduce",function(){return a}),n.d(e,"arrayFilter",function(){return s}),n.d(e,"arrayMap",function(){return l}),n.d(e,"arrayEach",function(){return u}),n.d(e,"arraySum",function(){return c}),n.d(e,"arrayMax",function(){return f}),n.d(e,"arrayMin",function(){return h}),n.d(e,"arrayAvg",function(){return d}),n.d(e,"arrayFlatten",function(){return p}),n.d(e,"arrayUnique",function(){return g});n(24),n(29),n(21),n(8);function r(t){for(var e=t.length,n=0;n<e;)t[n]=[t[n]],n+=1}function o(t,e){for(var n=e.length,r=0;r<n;)t.push(e[r]),r+=1}function i(t){var e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;for(var n=t.length,r=t[0].length,o=0;o<n;o++)for(var i=0;i<r;i++)e[i]||(e[i]=[]),e[i][o]=t[o][i];return e}function a(t,e,n,r){var o=-1,i=t,a=n;Array.isArray(t)||(i=Array.from(t));var s=i.length;for(r&&s&&(a=i[o+=1]),o+=1;o<s;)a=e(a,i[o],o,i),o+=1;return a}function s(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length,i=[],a=-1;n<o;){var s=r[n];e(s,n,r)&&(i[a+=1]=s),n+=1}return i}function l(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length,i=[],a=-1;n<o;){var s=r[n];i[a+=1]=e(s,n,r),n+=1}return i}function u(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length;n<o&&!1!==e(r[n],n,r);)n+=1;return t}function c(t){return a(t,function(t,e){return t+e},0)}function f(t){return a(t,function(t,e){return t>e?t:e},Array.isArray(t)?t[0]:void 0)}function h(t){return a(t,function(t,e){return t<e?t:e},Array.isArray(t)?t[0]:void 0)}function d(t){return t.length?c(t)/t.length:0}function p(t){return a(t,function(t,e){return t.concat(Array.isArray(e)?p(e):e)},[])}function g(t){var e=[];return u(t,function(t){-1===e.indexOf(t)&&e.push(t)}),e}},function(t,e,n){"use strict";n.r(e),n.d(e,"duckSchema",function(){return a}),n.d(e,"inherit",function(){return s}),n.d(e,"extend",function(){return l}),n.d(e,"deepExtend",function(){return u}),n.d(e,"deepClone",function(){return c}),n.d(e,"clone",function(){return f}),n.d(e,"mixin",function(){return h}),n.d(e,"isObjectEqual",function(){return d}),n.d(e,"isObject",function(){return p}),n.d(e,"defineGetter",function(){return g}),n.d(e,"objectEach",function(){return v}),n.d(e,"getProperty",function(){return y}),n.d(e,"deepObjectSize",function(){return m}),n.d(e,"createObjectPropListener",function(){return b}),n.d(e,"hasOwnProperty",function(){return w});n(10),n(11),n(12),n(7),n(6),n(26),n(8),n(61),n(9);var r=n(1);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){var e;return Array.isArray(t)?e=[]:(e={},v(t,function(t,n){"__children"!==n&&(t&&"object"===i(t)&&!Array.isArray(t)?e[n]=a(t):Array.isArray(t)?t.length&&"object"===i(t[0])&&!Array.isArray(t[0])?e[n]=[a(t[0])]:e[n]=[]:e[n]=null)})),e}function s(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function l(t,e){return v(e,function(e,n){t[n]=e}),t}function u(t,e){v(e,function(n,r){e[r]&&"object"===i(e[r])?(t[r]||(Array.isArray(e[r])?t[r]=[]:"[object Date]"===Object.prototype.toString.call(e[r])?t[r]=e[r]:t[r]={}),u(t[r],e[r])):t[r]=e[r]})}function c(t){return"object"===i(t)?JSON.parse(JSON.stringify(t)):t}function f(t){var e={};return v(t,function(t,n){e[n]=t}),e}function h(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object(r.arrayEach)(n,function(e){t.MIXINS.push(e.MIXIN_NAME),v(e,function(e,n){if(void 0!==t.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"==typeof e)t.prototype[n]=e;else{Object.defineProperty(t.prototype,n,{get:(r=n,o=e,i="_".concat(r),function(){var t;return void 0===this[i]&&(this[i]=(t=o,(Array.isArray(t)||p(t))&&(t=c(t)),t)),this[i]}),set:function(t){var e="_".concat(t);return function(t){this[e]=t}}(n),configurable:!0})}var r,o,i})}),t}function d(t,e){return JSON.stringify(t)===JSON.stringify(e)}function p(t){return"[object Object]"===Object.prototype.toString.call(t)}function g(t,e,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(t,e,r)}function v(t,e){for(var n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&!1===e(t[n],n,t))break;return t}function y(t,e){var n=e.split("."),r=t;return v(n,function(t){if(void 0===(r=r[t]))return r=void 0,!1}),r}function m(t){if(!p(t))return 0;return function t(e){var n=0;return p(e)?v(e,function(e){n+=t(e)}):n+=1,n}(t)}function b(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),i=(o(e={_touched:!1},r,t),o(e,"isTouched",function(){return this._touched}),e);return Object.defineProperty(i,n,{get:function(){return this[r]},set:function(t){this._touched=!0,this[r]=t},enumerable:!0,configurable:!0}),i}function w(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},function(t,e,n){"use strict";n.r(e),n.d(e,"CONTEXT_MENU_ITEMS_NAMESPACE",function(){return r}),n.d(e,"CONTEXTMENU_ITEMS_NO_ITEMS",function(){return o}),n.d(e,"CONTEXTMENU_ITEMS_ROW_ABOVE",function(){return i}),n.d(e,"CONTEXTMENU_ITEMS_ROW_BELOW",function(){return a}),n.d(e,"CONTEXTMENU_ITEMS_INSERT_LEFT",function(){return s}),n.d(e,"CONTEXTMENU_ITEMS_INSERT_RIGHT",function(){return l}),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_ROW",function(){return u}),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",function(){return c}),n.d(e,"CONTEXTMENU_ITEMS_UNDO",function(){return f}),n.d(e,"CONTEXTMENU_ITEMS_REDO",function(){return h}),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY",function(){return d}),n.d(e,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",function(){return p}),n.d(e,"CONTEXTMENU_ITEMS_COPY",function(){return g}),n.d(e,"CONTEXTMENU_ITEMS_CUT",function(){return v}),n.d(e,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",function(){return y}),n.d(e,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",function(){return m}),n.d(e,"CONTEXTMENU_ITEMS_MERGE_CELLS",function(){return b}),n.d(e,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",function(){return w}),n.d(e,"CONTEXTMENU_ITEMS_ADD_COMMENT",function(){return C}),n.d(e,"CONTEXTMENU_ITEMS_EDIT_COMMENT",function(){return O}),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",function(){return E}),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",function(){return S}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT",function(){return k}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",function(){return R}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",function(){return T}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",function(){return M}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",function(){return _}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",function(){return N}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",function(){return A}),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",function(){return x}),n.d(e,"CONTEXTMENU_ITEMS_BORDERS",function(){return j}),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_TOP",function(){return I}),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",function(){return D}),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",function(){return P}),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_LEFT",function(){return L}),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",function(){return H}),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",function(){return F}),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",function(){return B}),n.d(e,"CONTEXTMENU_ITEMS_HIDE_COLUMN",function(){return W}),n.d(e,"CONTEXTMENU_ITEMS_SHOW_COLUMN",function(){return V}),n.d(e,"CONTEXTMENU_ITEMS_HIDE_ROW",function(){return U}),n.d(e,"CONTEXTMENU_ITEMS_SHOW_ROW",function(){return Y}),n.d(e,"FILTERS_NAMESPACE",function(){return z}),n.d(e,"FILTERS_CONDITIONS_NAMESPACE",function(){return G}),n.d(e,"FILTERS_CONDITIONS_NONE",function(){return X}),n.d(e,"FILTERS_CONDITIONS_EMPTY",function(){return q}),n.d(e,"FILTERS_CONDITIONS_NOT_EMPTY",function(){return K}),n.d(e,"FILTERS_CONDITIONS_EQUAL",function(){return $}),n.d(e,"FILTERS_CONDITIONS_NOT_EQUAL",function(){return Z}),n.d(e,"FILTERS_CONDITIONS_BEGINS_WITH",function(){return Q}),n.d(e,"FILTERS_CONDITIONS_ENDS_WITH",function(){return J}),n.d(e,"FILTERS_CONDITIONS_CONTAINS",function(){return tt}),n.d(e,"FILTERS_CONDITIONS_NOT_CONTAIN",function(){return et}),n.d(e,"FILTERS_CONDITIONS_BY_VALUE",function(){return nt}),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN",function(){return rt}),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",function(){return ot}),n.d(e,"FILTERS_CONDITIONS_LESS_THAN",function(){return it}),n.d(e,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",function(){return at}),n.d(e,"FILTERS_CONDITIONS_BETWEEN",function(){return st}),n.d(e,"FILTERS_CONDITIONS_NOT_BETWEEN",function(){return lt}),n.d(e,"FILTERS_CONDITIONS_AFTER",function(){return ut}),n.d(e,"FILTERS_CONDITIONS_BEFORE",function(){return ct}),n.d(e,"FILTERS_CONDITIONS_TODAY",function(){return ft}),n.d(e,"FILTERS_CONDITIONS_TOMORROW",function(){return ht}),n.d(e,"FILTERS_CONDITIONS_YESTERDAY",function(){return dt}),n.d(e,"FILTERS_DIVS_FILTER_BY_CONDITION",function(){return pt}),n.d(e,"FILTERS_DIVS_FILTER_BY_VALUE",function(){return gt}),n.d(e,"FILTERS_LABELS_CONJUNCTION",function(){return vt}),n.d(e,"FILTERS_LABELS_DISJUNCTION",function(){return yt}),n.d(e,"FILTERS_VALUES_BLANK_CELLS",function(){return mt}),n.d(e,"FILTERS_BUTTONS_SELECT_ALL",function(){return bt}),n.d(e,"FILTERS_BUTTONS_CLEAR",function(){return wt}),n.d(e,"FILTERS_BUTTONS_OK",function(){return Ct}),n.d(e,"FILTERS_BUTTONS_CANCEL",function(){return Ot}),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",function(){return Et}),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",function(){return St}),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",function(){return kt});var r="ContextMenu:items",o="".concat(r,".noItems"),i="".concat(r,".insertRowAbove"),a="".concat(r,".insertRowBelow"),s="".concat(r,".insertColumnOnTheLeft"),l="".concat(r,".insertColumnOnTheRight"),u="".concat(r,".removeRow"),c="".concat(r,".removeColumn"),f="".concat(r,".undo"),h="".concat(r,".redo"),d="".concat(r,".readOnly"),p="".concat(r,".clearColumn"),g="".concat(r,".copy"),v="".concat(r,".cut"),y="".concat(r,".freezeColumn"),m="".concat(r,".unfreezeColumn"),b="".concat(r,".mergeCells"),w="".concat(r,".unmergeCells"),C="".concat(r,".addComment"),O="".concat(r,".editComment"),E="".concat(r,".removeComment"),S="".concat(r,".readOnlyComment"),k="".concat(r,".align"),R="".concat(r,".align.left"),T="".concat(r,".align.center"),M="".concat(r,".align.right"),_="".concat(r,".align.justify"),N="".concat(r,".align.top"),A="".concat(r,".align.middle"),x="".concat(r,".align.bottom"),j="".concat(r,".borders"),I="".concat(r,".borders.top"),D="".concat(r,".borders.right"),P="".concat(r,".borders.bottom"),L="".concat(r,".borders.left"),H="".concat(r,".borders.remove"),F="".concat(r,".nestedHeaders.insertChildRow"),B="".concat(r,".nestedHeaders.detachFromParent"),W="".concat(r,".hideColumn"),V="".concat(r,".showColumn"),U="".concat(r,".hideRow"),Y="".concat(r,".showRow"),z="Filters:",G="".concat(z,"conditions"),X="".concat(G,".none"),q="".concat(G,".isEmpty"),K="".concat(G,".isNotEmpty"),$="".concat(G,".isEqualTo"),Z="".concat(G,".isNotEqualTo"),Q="".concat(G,".beginsWith"),J="".concat(G,".endsWith"),tt="".concat(G,".contains"),et="".concat(G,".doesNotContain"),nt="".concat(G,".byValue"),rt="".concat(G,".greaterThan"),ot="".concat(G,".greaterThanOrEqualTo"),it="".concat(G,".lessThan"),at="".concat(G,".lessThanOrEqualTo"),st="".concat(G,".isBetween"),lt="".concat(G,".isNotBetween"),ut="".concat(G,".after"),ct="".concat(G,".before"),ft="".concat(G,".today"),ht="".concat(G,".tomorrow"),dt="".concat(G,".yesterday"),pt="".concat(z,"labels.filterByCondition"),gt="".concat(z,"labels.filterByValue"),vt="".concat(z,"labels.conjunction"),yt="".concat(z,"labels.disjunction"),mt="".concat(z,"values.blankCells"),bt="".concat(z,"buttons.selectAll"),wt="".concat(z,"buttons.clear"),Ct="".concat(z,"buttons.ok"),Ot="".concat(z,"buttons.cancel"),Et="".concat(z,"buttons.placeholder.search"),St="".concat(z,"buttons.placeholder.value"),kt="".concat(z,"buttons.placeholder.secondValue")},function(t,e,n){"use strict";n.r(e),n.d(e,"isNumeric",function(){return o}),n.d(e,"rangeEach",function(){return i}),n.d(e,"rangeEachReverse",function(){return a}),n.d(e,"valueAccordingPercent",function(){return s});n(10),n(11),n(12),n(7),n(6),n(26),n(8),n(52),n(9);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){var e=r(t);return"number"==e?!isNaN(t)&&isFinite(t):"string"==e?!!t.length&&(1==t.length?/\d/.test(t):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(t)):"object"==e&&!(!t||"number"!=typeof t.valueOf()||t instanceof Date)}function i(t,e,n){var r=-1;for("function"==typeof e?(n=e,e=t):r=t-1;++r<=e&&!1!==n(r););}function a(t,e,n){var r=t+1;for("function"==typeof e&&(n=e,e=0);--r>=e&&!1!==n(r););}function s(t,e){return e=parseInt(e.toString().replace("%",""),10),e=parseInt(t*e/100,10)}},function(t,e,n){"use strict";n(7),n(6),n(8),n(31),n(9);function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}var i=new WeakMap,a=function(){function t(e,n,r,o,a,s,l){var u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:function(t){return t};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i.set(this,{viewportWidth:e,scrollOffset:n,totalColumns:r,columnWidthFn:o,overrideFn:a,onlyFullyVisible:s,stretchingColumnWidthFn:u}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return o(t,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),o(t,[{key:"calculate",value:function(){for(var t,e=0,n=!0,r=[],o=i.get(this),a=o.onlyFullyVisible,s=o.overrideFn,l=o.scrollOffset,u=o.totalColumns,c=o.viewportWidth,f=0;f<u;f++){if(t=this._getColumnWidth(f),e<=l&&!a&&(this.startColumn=f),e>=l&&e+t<=l+(l>0?c+1:c)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=f),this.endColumn=f),r.push(e),e+=t,a||(this.endColumn=f),e>=l+c){n=!1;break}}if(this.endColumn===u-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var h=r[this.endColumn]+t-r[this.startColumn-1];if((h<=c||!a)&&(this.startColumn-=1),h>c)break}null!==this.startColumn&&s&&s(this),this.startPosition=r[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if("none"!==this.stretch){var e=t;this.totalTargetWidth=e;for(var n=i.get(this),r=n.totalColumns,o=0,a=0;a<r;a++){var s=this._getColumnWidth(a),l=n.stretchingColumnWidthFn(void 0,a);"number"==typeof l?e-=l:o+=s}var u=e-o;if("all"===this.stretch&&u>0)this.stretchAllRatio=e/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){var c=this._getColumnWidth(r-1),f=u+c;this.stretchLastWidth=f>=0?f:c}}}},{key:"getStretchedColumnWidth",value:function(t,e){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}},{key:"_getStretchedAllColumnWidth",value:function(t,e){var n=0,r=i.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[t]){var a=Math.round(e*this.stretchAllRatio),s=r.stretchingColumnWidthFn(a,t);this.stretchAllColumnsWidth[t]=void 0===s?a:isNaN(s)?this._getColumnWidth(t):s}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;l<this.stretchAllColumnsWidth.length;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){return t===i.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(e){var n=i.get(this).columnWidthFn(e);return isNaN(n)&&(n=t.DEFAULT_WIDTH),n}}]),t}();function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}var u=new WeakMap,c=function(){function t(e,n,r,o,i,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),u.set(this,{viewportHeight:e,scrollOffset:n,totalRows:r,rowHeightFn:o,overrideFn:i,onlyFullyVisible:a,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return l(t,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),l(t,[{key:"calculate",value:function(){for(var e,n=0,r=!0,o=[],i=u.get(this),a=i.onlyFullyVisible,s=i.overrideFn,l=i.rowHeightFn,c=i.scrollOffset,f=i.totalRows,h=i.viewportHeight,d=i.horizontalScrollbarHeight||0,p=0;p<f;p++)if(e=l(p),isNaN(e)&&(e=t.DEFAULT_HEIGHT),n<=c&&!a&&(this.startRow=p),n>=c&&n+e<=c+h-d&&(null===this.startRow&&(this.startRow=p),this.endRow=p),o.push(n),n+=e,a||(this.endRow=p),n>=c+h-d){r=!1;break}if(this.endRow===f-1&&r)for(this.startRow=this.endRow;this.startRow>0;){var g=o[this.endRow]+e-o[this.startRow-1];if((g<=h-d||!a)&&(this.startRow-=1),g>=h-d)break}null!==this.startRow&&s&&s(this),this.startPosition=o[this.startRow],void 0===this.startPosition&&(this.startPosition=null),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}]),t}();function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.row=null,this.col=null,void 0!==e&&void 0!==n&&(this.row=e,this.col=n)}var e,n,r;return e=t,(n=[{key:"isValid",value:function(t){return!(this.row<0||this.col<0)&&!(this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}},{key:"isEqual",value:function(t){return t===this||this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&this.col>=t.col}},{key:"isNorthWestOf",value:function(t){return this.row<=t.row&&this.col<=t.col}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&this.col<=t.col}},{key:"isNorthEastOf",value:function(t){return this.row<=t.row&&this.col>=t.col}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}])&&f(e.prototype,n),r&&f(e,r),t}();n(44),n(21),n(50);function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.highlight=e,this.from=n,this.to=r}var e,n,r;return e=t,(n=[{key:"setHighlight",value:function(t){return this.highlight=t,this}},{key:"setFrom",value:function(t){return this.from=t,this}},{key:"setTo",value:function(t){return this.to=t,this}},{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(t){var e=t.row,n=t.col,r=this.getTopLeftCorner(),o=this.getBottomRightCorner();return r.row<=e&&o.row>=e&&r.col<=n&&o.col>=n}},{key:"includesRange",value:function(t){return this.includes(t.getTopLeftCorner())&&this.includes(t.getBottomRightCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getTopLeftCorner())&&t.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getTopLeftCorner().isSouthEastOf(t)||this.getBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getTopLeftCorner().isNorthWestOf(t)||this.getBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function(t){return this.getTopRightCorner().col>=t.getTopLeftCorner().col&&this.getTopRightCorner().col<=t.getTopRightCorner().col||this.getTopLeftCorner().col<=t.getTopRightCorner().col&&this.getTopLeftCorner().col>=t.getTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(t){return this.getBottomRightCorner().row>=t.getTopRightCorner().row&&this.getBottomRightCorner().row<=t.getBottomRightCorner().row||this.getTopRightCorner().row<=t.getBottomRightCorner().row&&this.getTopRightCorner().row>=t.getTopRightCorner().row}},{key:"expand",value:function(t){var e=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=new h(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=new h(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var e=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=this.getDirection(),o=t.getTopLeftCorner(),i=t.getBottomRightCorner(),a=Math.min(e.row,o.row),s=Math.min(e.col,o.col),l=Math.max(n.row,i.row),u=Math.max(n.col,i.col),c=new h(a,s),f=new h(l,u);return this.from=c,this.to=f,this.setDirection(r),this.highlight.row===this.getBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var e=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=e[0],this.to=e[1];break;case"NE-SW":var n=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopLeftCorner",value:function(){return new h(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new h(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new h(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new h(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(t,e){return!!(e&&e.includes(t)&&(this.getTopLeftCorner().isEqual(new h(e.from.row,e.from.col))||this.getTopRightCorner().isEqual(new h(e.from.row,e.to.col))||this.getBottomLeftCorner().isEqual(new h(e.to.row,e.from.col))||this.getBottomRightCorner().isEqual(new h(e.to.row,e.to.col))))||(t.isEqual(this.getTopLeftCorner())||t.isEqual(this.getTopRightCorner())||t.isEqual(this.getBottomLeftCorner())||t.isEqual(this.getBottomRightCorner()))}},{key:"getOppositeCorner",value:function(t,e){if(!(t instanceof h))return!1;if(e&&e.includes(t)){if(this.getTopLeftCorner().isEqual(new h(e.from.row,e.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new h(e.from.row,e.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new h(e.to.row,e.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new h(e.to.row,e.to.col)))return this.getTopLeftCorner()}return t.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():t.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():t.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():t.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var e=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),o=Math.max(this.from.col,this.to.col),i=Math.min(t.from.row,t.to.row),a=Math.max(t.from.row,t.to.row),s=Math.min(t.from.col,t.to.col),l=Math.max(t.from.col,t.to.col),u=[];return e===i&&u.push("top"),o===l&&u.push("right"),n===a&&u.push("bottom"),r===s&&u.push("left"),u}},{key:"getInner",value:function(){for(var t=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(new h(r,o));return n}},{key:"getAll",value:function(){for(var t=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)t.row===r&&t.col===o?n.push(t):e.row===r&&e.col===o?n.push(e):n.push(new h(r,o));return n}},{key:"forAll",value:function(t){for(var e=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=e.row;r<=n.row;r++)for(var o=e.col;o<=n.col;o++){if(!1===t(r,o))return}}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}])&&d(e.prototype,n),r&&d(e,r),t}();function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.offset=e,this.total=n,this.countTH=r}var e,n,r;return e=t,(n=[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}])&&g(e.prototype,n),r&&g(e,r),t}();function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var m=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.offset=e,this.total=n,this.countTH=r}var e,n,r;return e=t,(n=[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}])&&y(e.prototype,n),r&&y(e,r),t}(),b=(n(10),n(11),n(12),n(18),n(19),n(0)),w=n(2),C=n(1),O=n(30),E=n(20),S=n(36),k=(n(45),n(28)),R=n(34),T=n(40);function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _=new WeakMap,N=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.eventManager=new E.a(e),_.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}var e,n,r;return e=t,(n=[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",function(e){return t.onContextMenu(e)}),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",function(e){return t.onMouseOut(e)});var e=function(){t.eventManager.addEventListener(t.instance.wtTable.holder,"touchstart",function(e){return t.onTouchStart(e)}),t.eventManager.addEventListener(t.instance.wtTable.holder,"touchend",function(e){return t.onTouchEnd(e)}),t.instance.momentumScrolling||(t.instance.momentumScrolling={}),t.eventManager.addEventListener(t.instance.wtTable.holder,"scroll",function(){clearTimeout(t.instance.momentumScrolling._timeout),t.instance.momentumScrolling.ongoing||t.instance.getSetting("onBeforeTouchScroll"),t.instance.momentumScrolling.ongoing=!0,t.instance.momentumScrolling._timeout=setTimeout(function(){t.instance.touchApplied||(t.instance.momentumScrolling.ongoing=!1,t.instance.getSetting("onAfterMomentumScroll"))},200)})};Object(T.isMobileBrowser)()?e():(Object(R.isTouchSupported)()&&e(),t.eventManager.addEventListener(t.instance.wtTable.holder,"mouseup",function(e){return t.onMouseUp(e)}),t.eventManager.addEventListener(t.instance.wtTable.holder,"mousedown",function(e){return t.onMouseDown(e)}))}},{key:"selectedCellWasTouched",value:function(t){var e=_.get(this),n=this.parentCell(t).coords;if(e.selectedCellBeforeTouchEnd&&n){var r=[n.row,e.selectedCellBeforeTouchEnd.from.row],o=r[0],i=r[1],a=[n.col,e.selectedCellBeforeTouchEnd.from.col];return o===i&&a[0]===a[1]}return!1}},{key:"parentCell",value:function(t){var e={},n=this.instance.wtTable.TABLE,r=Object(b.closestDown)(t,["TD","TH"],n);return r?(e.coords=this.instance.wtTable.getCoords(r),e.TD=r):Object(b.hasClass)(t,"wtBorder")&&Object(b.hasClass)(t,"current")?(e.coords=this.instance.selections.getCell().cellRange.highlight,e.TD=this.instance.wtTable.getCell(e.coords)):Object(b.hasClass)(t,"wtBorder")&&Object(b.hasClass)(t,"area")&&this.instance.selections.createOrGetArea().cellRange&&(e.coords=this.instance.selections.createOrGetArea().cellRange.to,e.TD=this.instance.wtTable.getCell(e.coords)),e}},{key:"onMouseDown",value:function(t){var e=_.get(this),n=this.instance.rootDocument.activeElement,r=Object(k.partial)(b.getParent,t.realTarget),o=t.realTarget;if(o!==n&&r(0)!==n&&r(1)!==n){var i=this.parentCell(o);Object(b.hasClass)(o,"corner")?this.instance.getSetting("onCellCornerMouseDown",t,o):i.TD&&this.instance.hasSetting("onCellMouseDown")&&this.instance.getSetting("onCellMouseDown",t,i.coords,i.TD,this.instance),2!==t.button&&i.TD&&(e.dblClickOrigin[0]=i.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout(function(){e.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(t){if(this.instance.hasSetting("onCellContextMenu")){var e=this.parentCell(t.realTarget);e.TD&&this.instance.getSetting("onCellContextMenu",t,e.coords,e.TD,this.instance)}}},{key:"onMouseOver",value:function(t){if(this.instance.hasSetting("onCellMouseOver")){var e=this.instance.wtTable.TABLE,n=Object(b.closestDown)(t.realTarget,["TD","TH"],e),r=this.instance.cloneSource||this.instance;n&&n!==r.lastMouseOver&&Object(b.isChildOf)(n,e)&&(r.lastMouseOver=n,this.instance.getSetting("onCellMouseOver",t,this.instance.wtTable.getCoords(n),n,this.instance))}}},{key:"onMouseOut",value:function(t){if(this.instance.hasSetting("onCellMouseOut")){var e=this.instance.wtTable.TABLE,n=Object(b.closestDown)(t.realTarget,["TD","TH"],e),r=Object(b.closestDown)(t.relatedTarget,["TD","TH"],e);n&&n!==r&&Object(b.isChildOf)(n,e)&&this.instance.getSetting("onCellMouseOut",t,this.instance.wtTable.getCoords(n),n,this.instance)}}},{key:"onMouseUp",value:function(t){if(2!==t.button){var e=_.get(this),n=this.parentCell(t.realTarget);n.TD&&this.instance.hasSetting("onCellMouseUp")&&this.instance.getSetting("onCellMouseUp",t,n.coords,n.TD,this.instance),n.TD===e.dblClickOrigin[0]&&n.TD===e.dblClickOrigin[1]?(Object(b.hasClass)(t.realTarget,"corner")?this.instance.getSetting("onCellCornerDblClick",t,n.coords,n.TD,this.instance):this.instance.getSetting("onCellDblClick",t,n.coords,n.TD,this.instance),e.dblClickOrigin[0]=null,e.dblClickOrigin[1]=null):n.TD===e.dblClickOrigin[0]&&(e.dblClickOrigin[1]=n.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout(function(){e.dblClickOrigin[1]=null},500))}}},{key:"onTouchStart",value:function(t){_.get(this).selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange,this.instance.touchApplied=!0,this.onMouseDown(t)}},{key:"onTouchEnd",value:function(t){var e=t.target;this.instance.touchApplied=!1,!1===this.selectedCellWasTouched(e)&&["A","BUTTON","INPUT"].includes(e.tagName)&&t.preventDefault(),this.onMouseUp(t)}},{key:"destroy",value:function(){var t=_.get(this);clearTimeout(t.dblClickTimeout[0]),clearTimeout(t.dblClickTimeout[1]),this.eventManager.destroy()}}])&&M(e.prototype,n),r&&M(e,r),t}(),A=(n(29),n(26),n(17));function x(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var I=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wot=e;var n=this.wot,r=n.rootDocument,o=n.rootWindow,i=n.wtTable,a=parseInt(o.getComputedStyle(r.body).lineHeight,10),s=1.2*parseInt(o.getComputedStyle(r.body).fontSize,10);this.instance=this.wot,this.eventManager=new E.a(this.wot),this.scrollbarSize=Object(b.getScrollbarWidth)(r),this.wot.update("scrollbarWidth",this.scrollbarSize),this.wot.update("scrollbarHeight",this.scrollbarSize),"hidden"===o.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=i.holder:this.scrollableElement=Object(b.getScrollableElement)(i.TABLE),this.prepareOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}},this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.delegatedScrollCallback=!1,this.registeredListeners=[],this.browserLineHeight=a||s,this.registerListeners(),this.lastScrollX=o.scrollX,this.lastScrollY=o.scrollY}var e,n,r;return e=t,(n=[{key:"prepareOverlays",value:function(){var t=!1;return this.topOverlay?t=this.topOverlay.updateStateOfRendering()||t:this.topOverlay=it.createOverlay(it.CLONE_TOP,this.wot),it.hasOverlay(it.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),it.hasOverlay(it.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?t=this.bottomOverlay.updateStateOfRendering()||t:this.bottomOverlay=it.createOverlay(it.CLONE_BOTTOM,this.wot),this.leftOverlay?t=this.leftOverlay.updateStateOfRendering()||t:this.leftOverlay=it.createOverlay(it.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?t=this.topLeftCornerOverlay.updateStateOfRendering()||t:this.topLeftCornerOverlay=it.createOverlay(it.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?t=this.bottomLeftCornerOverlay.updateStateOfRendering()||t:this.bottomLeftCornerOverlay=it.createOverlay(it.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=it.createOverlay(it.CLONE_DEBUG,this.wot)),t}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wot.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var t=this,e=this.wot,n=e.rootDocument,r=e.rootWindow,o=this.topOverlay.mainTableScrollableElement,i=this.leftOverlay.mainTableScrollableElement,a=[];a.push([n.documentElement,"keydown",function(e){return t.onKeyDown(e)}]),a.push([n.documentElement,"keyup",function(){return t.onKeyUp()}]),a.push([n,"visibilitychange",function(){return t.onKeyUp()}]),a.push([o,"scroll",function(e){return t.onTableScroll(e)},{passive:!0}]),o!==i&&a.push([i,"scroll",function(e){return t.onTableScroll(e)},{passive:!0}]);var s,l=r.devicePixelRatio&&r.devicePixelRatio>1,u=this.scrollableElement===r;for(l||!Object(T.isChrome)()?a.push([this.wot.wtTable.wtRootElement.parentNode,"wheel",function(e){return t.onCloneWheel(e)},{passive:u}]):(this.topOverlay.needFullRender&&a.push([this.topOverlay.clone.wtTable.holder,"wheel",function(e){return t.onCloneWheel(e)},{passive:u}]),this.bottomOverlay.needFullRender&&a.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(e){return t.onCloneWheel(e)},{passive:u}]),this.leftOverlay.needFullRender&&a.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(e){return t.onCloneWheel(e)},{passive:u}]),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&a.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(e){return t.onCloneWheel(e)},{passive:u}]),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&a.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(e){return t.onCloneWheel(e)},{passive:u}])),a.push([r,"resize",function(){clearTimeout(s),s=setTimeout(function(){t.wot.getSetting("onWindowResize")},200)}]);a.length;){var c,f=a.pop();(c=this.eventManager).addEventListener.apply(c,x(f)),this.registeredListeners.push(f)}}},{key:"deregisterListeners",value:function(){for(;this.registeredListeners.length;){var t=this.registeredListeners.pop();this.eventManager.removeEventListener(t[0],t[1],t[2])}}},{key:"onTableScroll",value:function(t){var e=this.wot.rootWindow,n=this.leftOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=t.target;this.keyPressed&&(r!==e&&o!==e&&!t.target.contains(r)||n!==e&&o!==e&&!t.target.contains(n))||this.syncScrollPositions(t)}},{key:"onCloneWheel",value:function(t){var e=this.wot.rootWindow;this.scrollableElement!==e&&t.preventDefault();var n=this.leftOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=t.target,i=r!==e&&o!==e&&!o.contains(r),a=n!==e&&o!==e&&!o.contains(n);this.keyPressed&&(i||a)||this.translateMouseWheelToScroll(t)}},{key:"onKeyDown",value:function(t){this.keyPressed=Object(A.isKey)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var e=this.browserLineHeight,n=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,r=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(r+=r*e,n+=n*e),this.scrollVertically(n),this.scrollHorizontally(r)}},{key:"scrollVertically",value:function(t){this.scrollableElement.scrollTop+=t}},{key:"scrollHorizontally",value:function(t){this.scrollableElement.scrollLeft+=t}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var t=this.wot.rootWindow,e=this.topOverlay.clone.wtTable.holder,n=this.leftOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],i=r[1];if(this.horizontalScrolling=e.scrollLeft!==o||this.lastScrollX!==t.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=o;var a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,e=t.scrollLeft,n=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var t=this.wot,e=t.rootWindow,n=t.wtTable;"hidden"===e.getComputedStyle(n.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=n.holder:this.scrollableElement=Object(b.getScrollableElement)(n.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var e=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,n=e.clientWidth,r=e.clientHeight;n===this.spreaderLastSize.width&&r===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.leftOverlay.refresh(t),this.topOverlay.refresh(t),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(t),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(t),this.debug&&this.debug.refresh(t)}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wot,n=e.wtViewport,r=e.wtTable,o=this.wot.getSetting("totalColumns"),i=this.wot.getSetting("totalRows"),a=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width="".concat(a+this.leftOverlay.sumCellSizes(0,o),"px"),l.height="".concat(s+this.topOverlay.sumCellSizes(0,i)+1,"px"),this.scrollbarSize>0){var u=r.wtRootElement,c=u.scrollHeight,f=u.scrollWidth,h=r.holder,d=h.scrollHeight,p=h.scrollWidth;this.hasScrollbarRight=c<d,this.hasScrollbarBottom=f<p,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>f?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.leftOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM()}},{key:"getParentOverlay",value:function(t){if(!t)return null;var e=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],n=null;return Object(C.arrayEach)(e,function(e){e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(n=e.clone)}),n}}])&&j(e.prototype,n),r&&j(e,r),t}(),D=n(4);function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var L=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wot=e,this.instance=e}var e,n,r;return e=t,(n=[{key:"scrollViewport",value:function(t,e,n,r,o){var i=this.scrollViewportHorizontally(t.col,n,o),a=this.scrollViewportVertically(t.row,e,r);return i||a}},{key:"scrollViewportHorizontally",value:function(t,e,n){if(!this.wot.drawn)return!1;var r=this._getVariables(),o=r.fixedColumnsLeft,i=r.leftOverlay,a=r.totalColumns,s=!1;return t>=0&&t<=Math.max(a-1,0)&&(t>=o&&(t<this.getFirstVisibleColumn()||n)?s=i.scrollTo(t):(t>this.getLastVisibleColumn()||e)&&(s=i.scrollTo(t,!0))),s}},{key:"scrollViewportVertically",value:function(t,e,n){if(!this.wot.drawn)return!1;var r=this._getVariables(),o=r.fixedRowsBottom,i=r.fixedRowsTop,a=r.topOverlay,s=r.totalRows,l=!1;return t>=0&&t<=Math.max(s-1,0)&&(t>=i&&(t<this.getFirstVisibleRow()||e)?l=a.scrollTo(t):(t>this.getLastVisibleRow()&&t<s-o||n)&&(l=a.scrollTo(t,!0))),l}},{key:"getFirstVisibleRow",value:function(){var t=this._getVariables(),e=t.topOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalRows,i=t.fixedRowsTop,a=this.wot.rootWindow,s=n.getFirstVisibleRow();if(e.mainTableScrollableElement===a){var l=Object(b.offset)(n.wtRootElement),u=Object(b.innerHeight)(n.hider),c=Object(b.innerHeight)(a),f=Object(b.getScrollTop)(a,a);if(l.top+u-c<=f){var h=r.getColumnHeaderHeight();h+=e.sumCellSizes(0,i),Object(D.rangeEachReverse)(o,1,function(t){if(h+=e.sumCellSizes(t-1,t),l.top+u-h<=f)return s=t,!1})}}return s}},{key:"getLastVisibleRow",value:function(){var t=this._getVariables(),e=t.topOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalRows,i=this.wot.rootWindow,a=n.getLastVisibleRow();if(e.mainTableScrollableElement===i){var s=Object(b.offset)(n.wtRootElement),l=Object(b.innerHeight)(i),u=Object(b.getScrollTop)(i,i);if(s.top>u){var c=r.getColumnHeaderHeight();Object(D.rangeEach)(1,o,function(t){if(c+=e.sumCellSizes(t-1,t),s.top+c-u>=l)return a=t-2,!1})}}return a}},{key:"getFirstVisibleColumn",value:function(){var t=this._getVariables(),e=t.leftOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalColumns,i=this.wot.rootWindow,a=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===i){var s=Object(b.offset)(n.wtRootElement),l=Object(b.innerWidth)(n.hider),u=Object(b.innerWidth)(i),c=Object(b.getScrollLeft)(i,i);if(s.left+l-u<=c){var f=r.getRowHeaderWidth();Object(D.rangeEachReverse)(o,1,function(t){if(f+=e.sumCellSizes(t-1,t),s.left+l-f<=c)return a=t,!1})}}return a}},{key:"getLastVisibleColumn",value:function(){var t=this._getVariables(),e=t.leftOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalColumns,i=this.wot.rootWindow,a=n.getLastVisibleColumn();if(e.mainTableScrollableElement===i){var s=Object(b.offset)(n.wtRootElement),l=Object(b.innerWidth)(i),u=Object(b.getScrollLeft)(i,i);if(s.left>u){var c=r.getRowHeaderWidth();Object(D.rangeEach)(1,o,function(t){if(c+=e.sumCellSizes(t-1,t),s.left+c-u>=l)return a=t-2,!1})}}return a}},{key:"_getVariables",value:function(){var t=this.wot;return{topOverlay:t.wtOverlays.topOverlay,leftOverlay:t.wtOverlays.leftOverlay,wtTable:t.wtTable,wtViewport:t.wtViewport,totalRows:t.getSetting("totalRows"),totalColumns:t.getSetting("totalColumns"),fixedRowsTop:t.getSetting("fixedRowsTop"),fixedRowsBottom:t.getSetting("fixedRowsBottom"),fixedColumnsLeft:t.getSetting("fixedColumnsLeft")}}}])&&P(e.prototype,n),r&&P(e,r),t}();function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var F=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wot=e,this.instance=e,this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(t,e,n){var o=r.getSetting("data",t,e);Object(b.fastInnerText)(n,null==o?"":o)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(t){return t},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onWindowResize:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},Object(w.objectEach)(this.defaults,function(t,e){if(void 0!==n[e])r.settings[e]=n[e];else{if(void 0===t)throw new Error('A required setting "'.concat(e,'" was not provided'));r.settings[e]=t}})}var e,n,r;return e=t,(n=[{key:"update",value:function(t,e){var n=this;return void 0===e?Object(w.objectEach)(t,function(t,e){n.settings[e]=t}):this.settings[t]=e,this.wot}},{key:"getSetting",value:function(t,e,n,r,o){return"function"==typeof this.settings[t]?this.settings[t](e,n,r,o):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}])&&H(e.prototype,n),r&&H(e,r),t}(),B=(n(35),n(72),n(33));function W(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number\n          of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']);return W=function(){return t},t}function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var U=!1;function Y(t,e,n){var r=t.createElement("TH");return n.insertBefore(r,e),n.removeChild(e),r}function z(t,e,n){var r=t.createElement("TD");return n.insertBefore(r,e),n.removeChild(e),r}var G=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wtTable=e,this.wot=e.instance,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0,this.fixedRowsBottom=0}var e,n,r;return e=t,(n=[{key:"render",value:function(){if(!this.wtTable.isWorkingOnClone()){var t={};if(this.wot.getSetting("beforeDraw",!0,t),!0===t.skipRender)return}this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e,n=this.wtTable.getRenderedColumnsCount(),r=this.wtTable.getRenderedRowsCount(),o=this.wot.getSetting("totalColumns"),i=this.wot.getSetting("totalRows"),a=!1;if((it.isOverlayTypeOf(this.wot.cloneOverlay,it.CLONE_BOTTOM)||it.isOverlayTypeOf(this.wot.cloneOverlay,it.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),o>=0&&(this.adjustAvailableNodes(),a=!0,this.renderColumnHeaders(),this.renderRows(i,r,n),this.wtTable.isWorkingOnClone()||(e=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(n),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),a||this.adjustAvailableNodes(),this.removeRedundantRows(r),this.wtTable.isWorkingOnClone()&&!this.wot.isOverlayName(it.CLONE_BOTTOM)||this.markOversizedRows(),this.wtTable.isWorkingOnClone())this.wot.isOverlayName(it.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var s=Object(b.outerWidth)(this.wtTable.hider),l=Object(b.outerWidth)(this.wtTable.TABLE);if(0!==s&&l!==s&&this.adjustColumnWidths(n),e!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var u=this.wtTable.getFirstRenderedColumn(),c=this.wtTable.getLastRenderedColumn(),f=this.wot.getSetting("defaultColumnWidth"),h=this.wot.getSetting("rowHeaderWidth");if(null!=(h=this.instance.getSetting("onModifyRowHeaderWidth",h)))for(var d=0;d<this.rowHeaderCount;d++){var p=Array.isArray(h)?h[d]:h;p=null==p?f:p,this.COLGROUP.childNodes[d].style.width="".concat(p,"px")}for(var g=u;g<c;g++){var v=this.wtTable.getStretchedColumnWidth(g),y=this.columnFilter.sourceToRendered(g);this.COLGROUP.childNodes[y+this.rowHeaderCount].style.width="".concat(v,"px")}}this.wot.getSetting("onDraw",!0)}}},{key:"removeRedundantRows",value:function(t){for(;this.wtTable.tbodyChildrenLength>t;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength-=1}},{key:"renderRows",value:function(t,e,n){for(var r,o=0,i=this.rowFilter.renderedToSource(o),a=this.wtTable.isWorkingOnClone();i<t&&i>=0&&(!U&&o>1e3&&(U=!0,Object(O.b)(Object(B.a)(W()))),void 0===e||o!==e);){if(r=this.getOrCreateTrForRow(o,r),this.renderRowHeaders(i,r),this.adjustColumns(r,n+this.rowHeaderCount),this.renderCells(i,r,n),a&&!this.wot.isOverlayName(it.CLONE_BOTTOM)||this.resetOversizedRow(i),r.firstChild){var s=this.wot.wtTable.getRowHeight(i);s?(s-=1,r.firstChild.style.height="".concat(s,"px")):r.firstChild.style.height=""}o+=1,i=this.rowFilter.renderedToSource(o)}}},{key:"resetOversizedRow",value:function(t){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[t]&&(this.wot.wtViewport.oversizedRows[t]=void 0)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var t,e,n,r,o,i=this.instance.wtTable.TBODY.childNodes.length;if(i*this.instance.wtSettings.settings.defaultRowHeight!==Object(b.innerHeight)(this.instance.wtTable.TBODY)-1||this.instance.getSetting("fixedRowsBottom"))for(;i;)i-=1,n=this.instance.wtTable.rowFilter.renderedToSource(i),t=this.instance.wtTable.getRowHeight(n),e=(o=(r=this.instance.wtTable.getTrForRow(n)).querySelector("th"))?Object(b.innerHeight)(o):Object(b.innerHeight)(r)-1,(!t&&this.instance.wtSettings.settings.defaultRowHeight<e||t<e)&&(e+=1,this.instance.wtViewport.oversizedRows[n]=e)}}},{key:"markOversizedColumnHeaders",value:function(){var t=this.wot.getOverlayName();if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[t]&&!this.wtTable.isWorkingOnClone()){for(var e=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(var r=-1*this.rowHeaderCount;r<e;r++)this.markIfOversizedColumnHeader(r);this.wot.wtViewport.hasOversizedColumnHeadersMarked[t]=!0}}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wot.getSetting("columnHeaders"),e=this.wot.wtTable.THEAD.childNodes,n=this.wot.wtViewport.oversizedColumnHeaders,r=0,o=t.length;r<o;r++)if(n[r]){if(!e[r]||0===e[r].childNodes.length)return;e[r].childNodes[0].style.height="".concat(n[r],"px")}}},{key:"markIfOversizedColumnHeader",value:function(t){for(var e,n,r,o=this.wot.wtTable.columnFilter.renderedToSource(t),i=this.columnHeaderCount,a=this.wot.wtSettings.settings.defaultRowHeight,s=this.wot.getSetting("columnHeaderHeight")||[];i;)i-=1,e=this.wot.wtTable.getColumnHeaderHeight(i),(n=this.wot.wtTable.getColumnHeader(o,i))&&(r=Object(b.innerHeight)(n),(!e&&a<r||e<r)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=r),Array.isArray(s)?null!==s[i]&&void 0!==s[i]&&(this.wot.wtViewport.oversizedColumnHeaders[i]=s[i]):isNaN(s)||(this.wot.wtViewport.oversizedColumnHeaders[i]=s),this.wot.wtViewport.oversizedColumnHeaders[i]<(s[i]||s)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=s[i]||s))}},{key:"renderCells",value:function(t,e,n){for(var r,o,i=0;i<n;i++)o=this.columnFilter.renderedToSource(i),"TH"===(r=0===i?e.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)]:r.nextSibling).nodeName&&(r=z(this.wot.rootDocument,r,e)),Object(b.hasClass)(r,"hide")||(r.className=""),r.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(t,o,r);return r}},{key:"adjustColumnWidths",value:function(t){var e=0,n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,r=this.wot.getSetting("defaultColumnWidth"),o=this.wot.getSetting("rowHeaderWidth");if(n.offsetHeight<n.scrollHeight&&(e=Object(b.getScrollbarWidth)(this.wot.rootDocument)),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-e),null!=(o=this.instance.getSetting("onModifyRowHeaderWidth",o)))for(var i=0;i<this.rowHeaderCount;i++){var a=Array.isArray(o)?o[i]:o;a=null==a?r:a,this.COLGROUP.childNodes[i].style.width="".concat(a,"px")}for(var s=0;s<t;s++){var l=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(s));this.COLGROUP.childNodes[s+this.rowHeaderCount].style.width="".concat(l,"px")}}},{key:"appendToTbody",value:function(t){this.TBODY.appendChild(t),this.wtTable.tbodyChildrenLength+=1}},{key:"getOrCreateTrForRow",value:function(t,e){var n;return t>=this.wtTable.tbodyChildrenLength?(n=this.createRow(),this.appendToTbody(n)):n=0===t?this.TBODY.firstChild:e.nextSibling,n.className&&n.removeAttribute("class"),n}},{key:"createRow",value:function(){for(var t=this.wot.rootDocument,e=t.createElement("TR"),n=0;n<this.rowHeaderCount;n++)e.appendChild(t.createElement("TH"));return e}},{key:"renderRowHeader",value:function(t,e,n){n.className="",n.removeAttribute("style"),this.rowHeaders[e](t,n,e)}},{key:"renderRowHeaders",value:function(t,e){for(var n=e.firstChild,r=0;r<this.rowHeaderCount;r++)n?"TD"===n.nodeName&&(n=Y(this.wot.rootDocument,n,e)):(n=this.wot.rootDocument.createElement("TH"),e.appendChild(n)),this.renderRowHeader(t,r,n),n=n.nextSibling}},{key:"adjustAvailableNodes",value:function(){this.adjustColGroups(),this.adjustThead()}},{key:"renderColumnHeaders",value:function(){if(this.columnHeaderCount)for(var t=this.wtTable.getRenderedColumnsCount(),e=0;e<this.columnHeaderCount;e++)for(var n=this.getTrForColumnHeaders(e),r=-1*this.rowHeaderCount;r<t;r++){var o=this.columnFilter.renderedToSource(r);this.renderColumnHeader(e,o,n.childNodes[r+this.rowHeaderCount])}}},{key:"adjustColGroups",value:function(){for(var t=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<t+this.rowHeaderCount;)this.COLGROUP.appendChild(this.wot.rootDocument.createElement("COL")),this.wtTable.colgroupChildrenLength+=1;for(;this.wtTable.colgroupChildrenLength>t+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength-=1;this.rowHeaderCount&&Object(b.addClass)(this.COLGROUP.childNodes[0],"rowHeader")}},{key:"adjustThead",value:function(){var t=this.wtTable.getRenderedColumnsCount(),e=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=this.wot.rootDocument,r=0,o=this.columnHeaders.length;r<o;r++){for((e=this.THEAD.childNodes[r])||(e=n.createElement("TR"),this.THEAD.appendChild(e)),this.theadChildrenLength=e.childNodes.length;this.theadChildrenLength<t+this.rowHeaderCount;)e.appendChild(n.createElement("TH")),this.theadChildrenLength+=1;for(;this.theadChildrenLength>t+this.rowHeaderCount;)e.removeChild(e.lastChild),this.theadChildrenLength-=1}var i=this.THEAD.childNodes.length;if(i>this.columnHeaders.length)for(var a=this.columnHeaders.length;a<i;a++)this.THEAD.removeChild(this.THEAD.lastChild)}else e&&Object(b.empty)(e)}},{key:"getTrForColumnHeaders",value:function(t){return this.THEAD.childNodes[t]}},{key:"renderColumnHeader",value:function(t,e,n){return n.className="",n.removeAttribute("style"),this.columnHeaders[t](e,n,t)}},{key:"adjustColumns",value:function(t,e){for(var n=this.wot.rootDocument,r=t.childNodes.length;r<e;){var o=n.createElement("TD");t.appendChild(o),r+=1}for(;r>e;)t.removeChild(t.lastChild),r-=1}},{key:"removeRedundantColumns",value:function(t){for(;this.wtTable.tbodyChildrenLength>t;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength-=1}}])&&V(e.prototype,n),r&&V(e,r),t}();function X(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function K(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function $(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Z=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wot=e,this.instance=this.wot,this.TABLE=n,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,Object(b.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var o=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return r._modifyRowHeaderWidth(o)}}var e,n,r;return e=t,(n=[{key:"fixTableDomTree",value:function(){var t=this.wot.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(t.createElement("TR"))}},{key:"createSpreader",value:function(t){var e,n=t.parentNode;return n&&1===n.nodeType&&Object(b.hasClass)(n,"wtHolder")||((e=this.wot.rootDocument.createElement("div")).className="wtSpreader",n&&n.insertBefore(e,t),e.appendChild(t)),e.style.position="relative",e}},{key:"createHider",value:function(t){var e,n=t.parentNode;return n&&1===n.nodeType&&Object(b.hasClass)(n,"wtHolder")||((e=this.wot.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(e,t),e.appendChild(t)),e}},{key:"createHolder",value:function(t){var e,n=t.parentNode;return n&&1===n.nodeType&&Object(b.hasClass)(n,"wtHolder")||((e=this.wot.rootDocument.createElement("div")).style.position="relative",e.className="wtHolder",n&&n.insertBefore(e,t),this.isWorkingOnClone()||(e.parentNode.className+="ht_master handsontable"),e.appendChild(t)),e}},{key:"alignOverlaysWithTrimmingContainer",value:function(){var t=Object(b.getTrimmingContainer)(this.wtRootElement);if(!this.isWorkingOnClone()){var e=this.wot.rootWindow;if(this.holder.parentNode.style.position="relative",t===e){this.wot.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var n=Object(b.getStyle)(t,"height",e),r=this.holder.style,o=t.scrollWidth,i=t.scrollHeight,a=t.getBoundingClientRect(),s=a.width,l=a.height;s=Math.min(s,o),l=Math.min(l,i),r.width="".concat(s,"px"),r.height="auto"===n?"auto":"".concat(l,"px"),r.overflow=""}}}},{key:"isWorkingOnClone",value:function(){return!!this.wot.cloneSource}},{key:"draw",value:function(t){var e=this.wot,n=e.wtOverlays,r=e.wtViewport,o=this.instance.getSetting("totalRows"),i=e.getSetting("rowHeaders").length,a=e.getSetting("columnHeaders").length,s=!1,l=t;if(!this.isWorkingOnClone()&&(this.holderOffset=Object(b.offset)(this.holder),l=r.createRenderCalculators(l),i&&!e.getSetting("fixedColumnsLeft"))){var u=n.leftOverlay.getScrollPosition(),c=this.correctHeaderWidth;this.correctHeaderWidth=u>0,c!==this.correctHeaderWidth&&(l=!1)}if(this.isWorkingOnClone()||(s=n.prepareOverlays()),l)this.isWorkingOnClone()||r.createVisibleCalculators(),n&&n.refresh(!0);else{var f,h,d=e.cloneOverlay;this.isWorkingOnClone()?this.tableOffset=e.cloneSource.wtTable.tableOffset:this.tableOffset=Object(b.offset)(this.TABLE),f=it.isOverlayTypeOf(d,it.CLONE_DEBUG)||it.isOverlayTypeOf(d,it.CLONE_TOP)||it.isOverlayTypeOf(d,it.CLONE_TOP_LEFT_CORNER)?0:it.isOverlayTypeOf(d,it.CLONE_BOTTOM)||it.isOverlayTypeOf(d,it.CLONE_BOTTOM_LEFT_CORNER)?Math.max(o-e.getSetting("fixedRowsBottom"),0):r.rowsRenderCalculator.startRow,h=it.isOverlayTypeOf(d,it.CLONE_DEBUG)||it.isOverlayTypeOf(d,it.CLONE_LEFT)||it.isOverlayTypeOf(d,it.CLONE_TOP_LEFT_CORNER)||it.isOverlayTypeOf(d,it.CLONE_BOTTOM_LEFT_CORNER)?0:r.columnsRenderCalculator.startColumn,this.rowFilter=new m(f,o,a),this.columnFilter=new v(h,e.getSetting("totalColumns"),i),this.alignOverlaysWithTrimmingContainer(),this._doDraw()}return this.refreshSelections(l),this.isWorkingOnClone()||(n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&n.bottomOverlay.resetFixedPosition(),n.leftOverlay.resetFixedPosition(),n.topLeftCornerOverlay&&n.topLeftCornerOverlay.resetFixedPosition(),n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.resetFixedPosition()),s&&n.syncScrollWithMaster(),e.drawn=!0,this}},{key:"_doDraw",value:function(){new G(this).render()}},{key:"removeClassFromCells",value:function(t){for(var e=this.TABLE.querySelectorAll(".".concat(t)),n=0,r=e.length;n<r;n++)Object(b.removeClass)(e[n],t)}},{key:"refreshSelections",value:function(t){var e=this.wot;if(e.selections){var n=Array.from(e.selections),r=n.length;if(t){for(var o=[],i=0;i<r;i++){for(var a=n[i].settings,s=a.highlightHeaderClassName,l=a.highlightRowClassName,u=a.highlightColumnClassName,c=n[i].classNames,f=c.length,h=0;h<f;h++)o.includes(c[h])||o.push(c[h]);s&&!o.includes(s)&&o.push(s),l&&!o.includes(l)&&o.push(l),u&&!o.includes(u)&&o.push(u)}var d=e.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(d))for(var p=0;p<d.length;p++)o.push(d[p]);for(var g=o.length,v=0;v<g;v++)this.removeClassFromCells(o[v])}for(var y=0;y<r;y++)n[y].draw(e,t)}}},{key:"getCell",value:function(t){var e=t.row,n=t.col,r=this.wot.getSetting("onModifyGetCellCoords",e,n);if(r&&Array.isArray(r)){var o=K(r,2);e=o[0],n=o[1]}if(this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return i?i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)]:void 0}},{key:"getColumnHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[e];if(n)return n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}},{key:"getRowHeader",value:function(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var e=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return e?e.childNodes[0]:void 0}},{key:"getCoords",value:function(t){var e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=Object(b.closest)(e,["TD","TH"])),null===e)return null;var n=e.parentNode,r=n.parentNode,o=Object(b.index)(n),i=e.cellIndex;if(Object(b.overlayContainsElement)(it.CLONE_TOP_LEFT_CORNER,e)||Object(b.overlayContainsElement)(it.CLONE_TOP,e))"THEAD"===r.nodeName&&(o-=r.childNodes.length);else if(Object(b.overlayContainsElement)(it.CLONE_BOTTOM_LEFT_CORNER,e)||Object(b.overlayContainsElement)(it.CLONE_BOTTOM,e)){o=this.wot.getSetting("totalRows")-r.childNodes.length+o}else o=r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o);return i=Object(b.overlayContainsElement)(it.CLONE_TOP_LEFT_CORNER,e)||Object(b.overlayContainsElement)(it.CLONE_LEFT,e)||Object(b.overlayContainsElement)(it.CLONE_BOTTOM_LEFT_CORNER,e)||Object(b.overlayContainsElement)(it.CLONE_BOTTOM,e)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),new h(o,i)}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"getFirstRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow}},{key:"getFirstVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow}},{key:"getFirstRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn}},{key:"getFirstVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn}},{key:"getLastRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow}},{key:"getLastVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow}},{key:"getLastRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn}},{key:"getLastVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn}},{key:"isRowBeforeRenderedRows",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)<0&&t>=0}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(t){return this.rowFilter&&this.rowFilter.sourceToRendered(t)>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}},{key:"isColumnBeforeRenderedColumns",value:function(t){return this.columnFilter&&this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)<0&&t>=0}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)>this.getLastVisibleColumn()}},{key:"isColumnAfterRenderedColumns",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)>this.getLastRenderedColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"getRenderedColumnsCount",value:function(){var t=this.wot,e=t.getSetting("totalColumns"),n=t.wtViewport.columnsRenderCalculator.count;if(t.isOverlayName(it.CLONE_DEBUG))n=e;else if(t.isOverlayName(it.CLONE_LEFT)||t.isOverlayName(it.CLONE_TOP_LEFT_CORNER)||t.isOverlayName(it.CLONE_BOTTOM_LEFT_CORNER))return Math.min(t.getSetting("fixedColumnsLeft"),e);return n}},{key:"getRenderedRowsCount",value:function(){var t=this.wot,e=t.getSetting("totalRows"),n=t.wtViewport.rowsRenderCalculator.count;return t.isOverlayName(it.CLONE_DEBUG)?n=e:t.isOverlayName(it.CLONE_TOP)||t.isOverlayName(it.CLONE_TOP_LEFT_CORNER)?n=Math.min(t.getSetting("fixedRowsTop"),e):(t.isOverlayName(it.CLONE_BOTTOM)||t.isOverlayName(it.CLONE_BOTTOM_LEFT_CORNER))&&(n=Math.min(t.getSetting("fixedRowsBottom"),e)),n}},{key:"getVisibleRowsCount",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"getRowHeight",value:function(t){var e=this.wot.wtSettings.settings.rowHeight(t),n=this.wot.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}},{key:"getColumnHeaderHeight",value:function(t){var e=this.wot.wtSettings.settings.defaultRowHeight,n=this.wot.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}},{key:"getVisibleColumnsCount",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getColumnWidth",value:function(t){var e=this.wot.wtSettings.settings.columnWidth;return"function"==typeof e?e=e(t):"object"===q(e)&&(e=e[t]),e||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(t){var e=this.getColumnWidth(t),n=null==e?this.instance.wtSettings.settings.defaultColumnWidth:e,r=this.wot.wtViewport.columnsRenderCalculator;if(r){var o=r.getStretchedColumnWidth(t,n);o&&(n=o)}return n}},{key:"_modifyRowHeaderWidth",value:function(t){var e=Object(k.isFunction)(t)?t():null;return Array.isArray(e)?(e=X(e))[e.length-1]=this._correctRowHeaderWidth(e[e.length-1]):e=this._correctRowHeaderWidth(e),e}},{key:"_correctRowHeaderWidth",value:function(t){var e=t;return"number"!=typeof t&&(e=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}])&&$(e.prototype,n),r&&$(e,r),t}();function Q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var J=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wot=e,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new E.a(this.wot),this.eventManager.addEventListener(this.wot.rootWindow,"resize",function(){n.clientHeight=n.getWorkspaceHeight()})}var e,n,r;return e=t,(n=[{key:"getWorkspaceHeight",value:function(){var t=this.wot.rootDocument,e=this.instance.wtOverlays.topOverlay.trimmingContainer;return e===this.wot.rootWindow?t.documentElement.clientHeight:Object(b.outerHeight)(e)>0&&e.clientHeight>0?e.clientHeight:1/0}},{key:"getWorkspaceWidth",value:function(){var t,e,n=this.wot,r=n.rootDocument,o=n.rootWindow,i=this.instance.wtOverlays.leftOverlay.trimmingContainer,a=r.documentElement.offsetWidth,s=n.getSetting("totalColumns"),l=n.getSetting("stretchH");return n.getSetting("preventOverflow")?Object(b.outerWidth)(this.instance.wtTable.wtRootElement):(t=n.getSetting("freezeOverlays")?Math.min(a-this.getWorkspaceOffset().left,a):Math.min(this.getContainerFillWidth(),a-this.getWorkspaceOffset().left,a),i===o&&s>0&&this.sumColumnWidths(0,s-1)>t?r.documentElement.clientWidth:i===o||"scroll"!==(e=Object(b.getStyle)(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow",o))&&"hidden"!==e&&"auto"!==e?"none"!==l&&l?t:Math.max(t,Object(b.outerWidth)(this.instance.wtTable.TABLE)):Math.max(t,i.clientWidth))}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,e){for(var n=this.wot.wtTable,r=0,o=t;o<e;)r+=n.getColumnWidth(o),o+=1;return r}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.instance.wtTable.holder,e=this.wot.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);var n=e.offsetWidth;return this.containerWidth=n,t.removeChild(e),n}},{key:"getWorkspaceOffset",value:function(){return Object(b.offset)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return Object(b.outerHeight)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){var t=this.wot.wtTable;return Object(b.outerWidth)(t.TABLE)||Object(b.outerWidth)(t.TBODY)||Object(b.outerWidth)(t.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return this.instance.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Object(b.outerHeight)(this.wot.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight();if(t===1/0)return t;var e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}},{key:"getRowHeaderWidth",value:function(){var t=this.instance.getSetting("rowHeaderWidth"),e=this.instance.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var n=0,r=e.length;n<r;n++)this.rowHeaderWidth+=t[n]||t}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(e.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,a=e.length;i<a;i++)o?(this.rowHeaderWidth+=Object(b.outerWidth)(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth();if(t===1/0)return t;var e=this.getRowHeaderWidth();return e>0?t-e:t}},{key:"createRowsCalculator",value:function(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=this.wot,i=o.wtSettings,a=o.wtOverlays,s=o.wtTable,l=o.rootDocument;this.rowHeaderWidth=NaN,t=i.settings.renderAllRows&&!r?1/0:this.getViewportHeight();var u=a.topOverlay.getScrollPosition()-a.topOverlay.getTableParentOffset();u<0&&(u=0);var f=o.getSetting("fixedRowsTop"),h=o.getSetting("fixedRowsBottom"),d=o.getSetting("totalRows");return f&&(u+=n=a.topOverlay.sumCellSizes(0,f),t-=n),h&&a.bottomOverlay.clone&&(t-=n=a.bottomOverlay.sumCellSizes(d-h,d)),e=s.holder.clientHeight===s.holder.offsetHeight?0:Object(b.getScrollbarWidth)(l),new c(t,u,o.getSetting("totalRows"),function(t){return s.getRowHeight(t)},r?null:i.settings.viewportRowCalculatorOverride,r,e)}},{key:"createColumnsCalculator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wot,n=e.wtSettings,r=e.wtOverlays,o=e.wtTable,i=e.rootDocument,s=this.getViewportWidth(),l=r.leftOverlay.getScrollPosition()-r.leftOverlay.getTableParentOffset();this.columnHeaderHeight=NaN,l<0&&(l=0);var u=e.getSetting("fixedColumnsLeft");if(u){var c=r.leftOverlay.sumCellSizes(0,u);l+=c,s-=c}return o.holder.clientWidth!==o.holder.offsetWidth&&(s-=Object(b.getScrollbarWidth)(i)),new a(s,l,e.getSetting("totalColumns"),function(t){return e.wtTable.getColumnWidth(t)},t?null:n.settings.viewportColumnCalculatorOverride,t,e.getSetting("stretchH"),function(t,n){return e.getSetting("onBeforeStretchingColumnWidth",t,n)})}},{key:"createRenderCalculators",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t){var e=this.createRowsCalculator(!0),n=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(e)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){return!!this.rowsVisibleCalculator&&(!(t.startRow<this.rowsRenderCalculator.startRow||t.startRow===this.rowsRenderCalculator.startRow&&t.startRow>0)&&!(t.endRow>this.rowsRenderCalculator.endRow||t.endRow===this.rowsRenderCalculator.endRow&&t.endRow<this.wot.getSetting("totalRows")-1))}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){return!!this.columnsVisibleCalculator&&(!(t.startColumn<this.columnsRenderCalculator.startColumn||t.startColumn===this.columnsRenderCalculator.startColumn&&t.startColumn>0)&&!(t.endColumn>this.columnsRenderCalculator.endColumn||t.endColumn===this.columnsRenderCalculator.endColumn&&t.endColumn<this.wot.getSetting("totalColumns")-1))}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Object(w.objectEach)(this.hasOversizedColumnHeadersMarked,function(t,e,n){n[e]=void 0})}}])&&Q(e.prototype,n),r&&Q(e,r),t}();function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var et=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=[];if(this.guid="wt_".concat(Object(S.randomString)()),this.rootDocument=e.table.ownerDocument,this.rootWindow=this.rootDocument.defaultView,e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new Z(this,e.table,e.wtRootElement),this.wtScroll=new L(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new N(this),this.selections=this.cloneSource.selections):(this.wtSettings=new F(this,e),this.wtTable=new Z(this,e.table),this.wtScroll=new L(this),this.wtViewport=new J(this),this.wtEvent=new N(this),this.selections=this.getSetting("selections"),this.wtOverlays=new I(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var r=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;r<o;r++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(t,e){Object(b.fastInnerText)(e,n[t])}])}this.drawn=!1,this.drawInterrupted=!1}var e,n,r;return e=t,(n=[{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||Object(b.isVisible)(this.wtTable.TABLE)?this.wtTable.draw(t):this.drawInterrupted=!0,this}},{key:"getCell",value:function(t){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(t);var e=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsLeft");if(t.row<n&&t.col<o)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<o&&t.row>=e-r){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<o)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(t);if(t.row<e&&t.row>e-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}},{key:"update",value:function(t,e){return this.wtSettings.update(t,e)}},{key:"scrollViewport",value:function(t,e,n,r,o){return this.wtScroll.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this.wtScroll.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this.wtScroll.scrollViewportVertically(t,e,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"isOverlayName",value:function(t){return!!this.cloneOverlay&&this.cloneOverlay.type===t}},{key:"exportSettingsAsClassNames",value:function(){var t=this,e=[],n=[];Object(w.objectEach)({rowHeaders:["array"],columnHeaders:["array"]},function(r,o){r.indexOf("array")>-1&&t.getSetting(o).length&&n.push("ht".concat(Object(S.toUpperCaseFirst)(o))),e.push("ht".concat(Object(S.toUpperCaseFirst)(o)))}),Object(b.removeClass)(this.wtTable.wtRootElement.parentNode,e),Object(b.addClass)(this.wtTable.wtRootElement.parentNode,n)}},{key:"getSetting",value:function(t,e,n,r,o){return this.wtSettings.getSetting(t,e,n,r,o)}},{key:"hasSetting",value:function(t){return this.wtSettings.has(t)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}])&&tt(e.prototype,n),r&&tt(e,r),t}();function nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rt(t,e,n){return e&&nt(t.prototype,e),n&&nt(t,n),t}var ot={},it=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object(w.defineGetter)(this,"wot",e,{writable:!1});var n=this.wot.wtTable,r=n.TABLE,o=n.hider,i=n.spreader,a=n.holder,s=n.wtRootElement;this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=r,this.hider=o,this.spreader=i,this.holder=a,this.wtRootElement=s,this.trimmingContainer=Object(b.getTrimmingContainer)(this.hider.parentNode.parentNode),this.areElementSizesAdjusted=!1,this.updateStateOfRendering()}return rt(t,null,[{key:"registerOverlay",value:function(e,n){if(-1===t.CLONE_TYPES.indexOf(e))throw new Error("Unsupported overlay (".concat(e,")."));ot[e]=n}},{key:"createOverlay",value:function(t,e){return new ot[t](e)}},{key:"hasOverlay",value:function(t){return void 0!==ot[t]}},{key:"isOverlayTypeOf",value:function(t,e){return!(!t||!ot[e])&&t instanceof ot[e]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_DEBUG",get:function(){return"debug"}},{key:"CLONE_TYPES",get:function(){return[t.CLONE_TOP,t.CLONE_BOTTOM,t.CLONE_LEFT,t.CLONE_TOP_LEFT_CORNER,t.CLONE_BOTTOM_LEFT_CORNER,t.CLONE_DEBUG]}}]),rt(t,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Object(b.getTrimmingContainer)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var t=this.wot,e=t.wtTable;"hidden"===t.rootWindow.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Object(b.getScrollableElement)(e.TABLE)}},{key:"getRelativeCellPosition",value:function(t,e,n){if(!1!==this.clone.wtTable.holder.contains(t)){var r=this.mainTableScrollableElement===this.wot.rootWindow,o=n<this.wot.getSetting("fixedColumnsLeft"),i=e<this.wot.getSetting("fixedRowsTop"),a=e>=this.wot.getSetting("totalRows")-this.wot.getSetting("fixedRowsBottom"),s={left:this.clone.wtTable.spreader.offsetLeft,top:this.clone.wtTable.spreader.offsetTop},l={left:t.offsetLeft,top:t.offsetTop};return r?this.getRelativeCellPositionWithinWindow(i,o,l,s):this.getRelativeCellPositionWithinHolder(i,a,o,l,s)}Object(O.b)("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeCellPositionWithinWindow",value:function(t,e,n,r){var o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),i=0,a=0;(i=e?o.left<=0?-1*o.left:0:r.left,t)?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=r.top;return{left:n.left+i,top:n.top+a}}},{key:"getRelativeCellPositionWithinHolder",value:function(t,e,n,r,o){var i=this.clone.cloneSource.wtOverlays.leftOverlay.getScrollPosition(),a=this.clone.cloneSource.wtOverlays.topOverlay.getScrollPosition(),s=0,l=0;if(n||(s=i-o.left),e){var u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+u.top}else t||(l=a-o.top);return{left:r.left-s,top:r.top-l}}},{key:"makeClone",value:function(e){if(-1===t.CLONE_TYPES.indexOf(e))throw new Error('Clone type "'.concat(e,'" is not supported.'));var n=this.wot,r=n.wtTable,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),s=o.createElement("TABLE");a.className="ht_clone_".concat(e," handsontable"),a.style.position="absolute",a.style.top=0,a.style.left=0,a.style.overflow="hidden",s.className=r.TABLE.className,a.appendChild(s),this.type=e,r.wtRootElement.parentNode.appendChild(a);var l=this.wot.getSetting("preventOverflow");return!0===l||"horizontal"===l&&this.type===t.CLONE_TOP||"vertical"===l&&this.type===t.CLONE_LEFT?this.mainTableScrollableElement=i:"hidden"===i.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Object(b.getScrollableElement)(r.TABLE),new et({cloneSource:this.wot,cloneOverlay:this,table:s})}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,n=t.style,r=e.style,o=t.parentNode.style;Object(C.arrayEach)([n,r,o],function(t){t.width="",t.height=""})}}},{key:"destroy",value:function(){new E.a(this.clone).destroy()}}]),t}();function at(t){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function st(t,e){return!e||"object"!==at(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lt(t){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ut(t,e){return(ut=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ct=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=st(this,lt(e).call(this,t))).clone=n.makeClone(it.CLONE_DEBUG),n.clone.wtTable.holder.style.opacity=.4,n.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",Object(b.addClass)(n.clone.wtTable.holder.parentNode,"wtDebugVisible"),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ut(t,e)}(e,it),e}();it.registerOverlay(it.CLONE_DEBUG,ct);function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function dt(t,e){return!e||"object"!==ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pt(t){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gt(t,e){return(gt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=dt(this,pt(e).call(this,t))).clone=n.makeClone(it.CLONE_LEFT),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gt(t,e)}(e,it),n=e,(r=[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){var t=this.wot.wtTable;if(this.needFullRender&&t.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,n=0,r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==this.wot.rootWindow||r&&"horizontal"===r)n=this.getScrollPosition(),Object(b.resetCssTransform)(e);else{var o,i,a=t.hider.getBoundingClientRect(),s=Math.ceil(a.left),l=Math.ceil(a.right);i=""===(i=t.hider.style.top)?0:i,n=o=s<0&&l-e.offsetWidth>0?-s:0,o+="px",Object(b.setOverlayPosition)(e,o,i)}this.adjustHeaderBordersPosition(n),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(t){var e=this.wot.rootWindow,n=!1;return this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,Object(b.getWindowScrollTop)(e)),n=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,n=!0),n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wot.wtSettings.defaultColumnWidth,r=t,o=0;r<e;)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),t||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot,e=t.wtTable,n=t.rootDocument,r=t.rootWindow,o=Object(b.getScrollbarWidth)(n),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===a){var s=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(s-=o),s=Math.min(s,e.wtRootElement.scrollHeight),i.height="".concat(s,"px")}else i.height="";this.clone.wtTable.holder.style.height=i.height;var l=Object(b.outerWidth)(this.clone.wtTable.TABLE);i.width="".concat(0===l?l:l+4,"px")}},{key:"adjustRootChildrenSize",value:function(){var t=Object(b.getScrollbarWidth)(this.wot.rootDocument);this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===t&&(t=30),this.clone.wtTable.holder.style.width="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+t,"px")}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;return e&&r.offsetWidth!==r.clientWidth&&(o=Object(b.getScrollbarWidth)(this.wot.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),t),n+=o,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var t=0;return this.wot.getSetting("preventOverflow")||this.trimmingContainer!==this.wot.rootWindow||(t=this.wot.wtTable.holderOffset.left),t}},{key:"getScrollPosition",value:function(){return Object(b.getScrollLeft)(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("rowHeaders"),r=this.wot.getSetting("fixedColumnsLeft");if(this.wot.getSetting("totalRows")?Object(b.removeClass)(e,"emptyRows"):Object(b.addClass)(e,"emptyRows"),r&&!n.length)Object(b.addClass)(e,"innerBorderLeft");else if(!r&&n.length){var o=Object(b.hasClass)(e,"innerBorderLeft");t?Object(b.addClass)(e,"innerBorderLeft"):Object(b.removeClass)(e,"innerBorderLeft"),(!o&&t||o&&!t)&&this.wot.wtOverlays.adjustElementsSize()}}}])&&ht(n.prototype,r),o&&ht(n,o),e}();it.registerOverlay(it.CLONE_LEFT,vt);function yt(t){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bt(t,e){return!e||"object"!==yt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wt(t){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ct(t,e){return(Ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ot=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=bt(this,wt(e).call(this,t))).clone=n.makeClone(it.CLONE_TOP),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ct(t,e)}(e,it),n=e,(r=[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==this.wot.rootWindow||n&&"vertical"===n)e=this.getScrollPosition(),Object(b.resetCssTransform)(t);else{var r,o,i=this.wot.wtTable.hider.getBoundingClientRect(),a=Math.ceil(i.top),s=Math.ceil(i.bottom);r=""===(r=this.wot.wtTable.hider.style.left)?0:r,e=o=a<0&&s-t.offsetHeight>0?-a:0,o+="px",Object(b.setOverlayPosition)(t,r,o)}this.adjustHeaderBordersPosition(e),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(t){var e=this.wot.rootWindow,n=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(Object(b.getWindowScrollLeft)(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wot.wtSettings.settings.defaultRowHeight,r=t,o=0;r<e;){var i=this.wot.wtTable.getRowHeight(r);o+=void 0===i?n:i,r+=1}return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),t||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot,e=t.wtTable,n=t.rootDocument,r=t.rootWindow,o=Object(b.getScrollbarWidth)(n),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===a){var s=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=o),s=Math.min(s,e.wtRootElement.scrollWidth),i.width="".concat(s,"px")}else i.width="";this.clone.wtTable.holder.style.width=i.width;var l=Object(b.outerHeight)(this.clone.wtTable.TABLE);i.height="".concat(0===l?l:l+4,"px")}},{key:"adjustRootChildrenSize",value:function(){var t=Object(b.getScrollbarWidth)(this.wot.rootDocument);this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===t&&(t=30),this.clone.wtTable.holder.style.height="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+t,"px")}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(t,e){var n=this.wot,r=(n.cloneSource?n.cloneSource:n).wtTable.holder,o=this.getTableParentOffset(),i=0;if(e&&r.offsetHeight!==r.clientHeight&&(i=Object(b.getScrollbarWidth)(n.rootDocument)),e){var a=n.getSetting("fixedRowsBottom"),s=n.getSetting("totalRows");o+=this.sumCellSizes(0,t+1),o-=n.wtViewport.getViewportHeight()-this.sumCellSizes(s-a,s),o+=1}else o+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);return o+=i,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(b.getScrollTop)(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"redrawSelectionBorders",value:function(t){if(t&&t.cellRange){var e=t.getBorder(this.wot),n=t.getCorners();e.disappear(),e.appear(n)}}},{key:"redrawAllSelectionsBorders",value:function(){var t=this,e=this.wot.selections;this.redrawSelectionBorders(e.getCell()),Object(C.arrayEach)(e.getAreas(),function(e){t.redrawSelectionBorders(e)}),this.redrawSelectionBorders(e.getFill()),this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode;if(this.wot.getSetting("totalColumns")?Object(b.removeClass)(e,"emptyColumns"):Object(b.addClass)(e,"emptyColumns"),0===this.wot.getSetting("fixedRowsTop")&&this.wot.getSetting("columnHeaders").length>0){var n=Object(b.hasClass)(e,"innerBorderTop");t||0===this.wot.getSetting("totalRows")?Object(b.addClass)(e,"innerBorderTop"):Object(b.removeClass)(e,"innerBorderTop"),(!n&&t||n&&!t)&&(this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders())}if(0===this.wot.getSetting("rowHeaders").length){var r=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(r)for(var o=0;o<r.length;o++)r[o].style["border-left-width"]=0}}}])&&mt(n.prototype,r),o&&mt(n,o),e}();it.registerOverlay(it.CLONE_TOP,Ot);function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function St(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kt(t,e){return!e||"object"!==Et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rt(t){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tt(t,e){return(Tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=kt(this,Rt(e).call(this,t))).clone=n.makeClone(it.CLONE_TOP_LEFT_CORNER),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tt(t,e)}(e,it),n=e,(r=[{key:"shouldBeRendered",value:function(){var t=this.wot;return!(!t.getSetting("fixedRowsTop")&&!t.getSetting("columnHeaders").length||!t.getSetting("fixedColumnsLeft")&&!t.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=Object(b.outerHeight)(this.clone.wtTable.TABLE),n=Object(b.outerWidth)(this.clone.wtTable.TABLE),r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow){var o=this.wot.wtTable.hider.getBoundingClientRect(),i=Math.ceil(o.top),a=Math.ceil(o.left),s=Math.ceil(o.bottom),l=Math.ceil(o.right),u="0",c="0";r&&"vertical"!==r||a<0&&l-t.offsetWidth>0&&(u="".concat(-a,"px")),r&&"horizontal"!==r||i<0&&s-t.offsetHeight>0&&(c="".concat(-i,"px")),Object(b.setOverlayPosition)(t,u,c)}else Object(b.resetCssTransform)(t);t.style.height="".concat(0===e?e:e+4,"px"),t.style.width="".concat(0===n?n:n+4,"px")}}}])&&St(n.prototype,r),o&&St(n,o),e}();it.registerOverlay(it.CLONE_TOP_LEFT_CORNER,Mt);function _t(t){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function At(t,e){return!e||"object"!==_t(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xt(t){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jt(t,e){return(jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var It=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=At(this,xt(e).call(this,t))).clone=n.makeClone(it.CLONE_BOTTOM),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jt(t,e)}(e,it),n=e,(r=[{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.rootDocument,r=this.clone.wtTable.holder.parentNode,o=Object(b.getScrollbarWidth)(n);e.holder.clientHeight===e.holder.offsetHeight&&(o=0),r.style.top="",r.style.bottom="".concat(o,"px")}},{key:"shouldBeRendered",value:function(){return!!this.wot.getSetting("fixedRowsBottom")}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0;if(t.style.top="",this.wot.wtOverlays.leftOverlay.trimmingContainer===this.wot.rootWindow){var n,r,o=this.wot,i=o.rootDocument,a=o.wtTable,s=a.hider.getBoundingClientRect(),l=Math.ceil(s.bottom),u=i.body.offsetHeight;n=""===(n=a.hider.style.left)?0:n,e=r=l>u?l-u:0,r+="px",t.style.top="",t.style.left=n,t.style.bottom=r}else e=this.getScrollPosition(),Object(b.resetCssTransform)(t),this.repositionOverlay();this.adjustHeaderBordersPosition(e)}}},{key:"setScrollPosition",value:function(t){var e=this.wot.rootWindow;this.mainTableScrollableElement===e?e.scrollTo(Object(b.getWindowScrollLeft)(e),t):this.mainTableScrollableElement.scrollTop=t}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wot,r=n.wtTable,o=n.wtSettings.settings.defaultRowHeight,i=t,a=0;i<e;){var s=r.getRowHeight(i);a+=void 0===s?o:s,i+=1}return a}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),t||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,r=t.rootWindow,o=Object(b.getScrollbarWidth)(this.wot.rootDocument),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===a){var s=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=o),s=Math.min(s,e.wtRootElement.scrollWidth),i.width="".concat(s,"px")}else i.width="";this.clone.wtTable.holder.style.width=i.width;var l=Object(b.outerHeight)(this.clone.wtTable.TABLE);i.height="".concat(l,"px")}},{key:"adjustRootChildrenSize",value:function(){var t=Object(b.getScrollbarWidth)(this.wot.rootDocument);this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===t&&(t=30),this.clone.wtTable.holder.style.height="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+t,"px")}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;e&&r.offsetHeight!==r.clientHeight&&(o=Object(b.getScrollbarWidth)(this.wot.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),t),n+=o,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(b.getScrollTop)(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(t){if(0===this.wot.getSetting("fixedRowsBottom")&&this.wot.getSetting("columnHeaders").length>0){var e=this.wot.wtTable.holder.parentNode,n=Object(b.hasClass)(e,"innerBorderTop");t?Object(b.addClass)(e,"innerBorderTop"):Object(b.removeClass)(e,"innerBorderTop"),(!n&&t||n&&!t)&&this.wot.wtOverlays.adjustElementsSize()}if(0===this.wot.getSetting("rowHeaders").length){var r=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");r&&(r.style["border-left-width"]=0)}}}])&&Nt(n.prototype,r),o&&Nt(n,o),e}();it.registerOverlay(it.CLONE_BOTTOM,It);function Dt(t){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Lt(t,e){return!e||"object"!==Dt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ht(t){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ft(t,e){return(Ft=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Lt(this,Ht(e).call(this,t))).clone=n.makeClone(it.CLONE_BOTTOM_LEFT_CORNER),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ft(t,e)}(e,it),n=e,(r=[{key:"shouldBeRendered",value:function(){var t=this.wot;return!(!t.getSetting("fixedRowsBottom")||!t.getSetting("fixedColumnsLeft")&&!t.getSetting("rowHeaders").length)}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.rootDocument,r=this.clone.wtTable.holder.parentNode,o=Object(b.getScrollbarWidth)(n);e.holder.clientHeight===e.holder.offsetHeight&&(o=0),r.style.top="",r.style.bottom="".concat(o,"px")}},{key:"resetFixedPosition",value:function(){var t=this.wot;if(this.updateTrimmingContainer(),t.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,n=Object(b.outerHeight)(this.clone.wtTable.TABLE),r=Object(b.outerWidth)(this.clone.wtTable.TABLE);if(e.style.top="",this.trimmingContainer===t.rootWindow){var o,i,a=t.wtTable.hider.getBoundingClientRect(),s=Math.ceil(a.bottom),l=Math.ceil(a.left),u=t.rootDocument.body.offsetHeight;o=l<0?-l:0,i=s>u?s-u:0,i+="px",o+="px",e.style.top="",e.style.left=o,e.style.bottom=i}else Object(b.resetCssTransform)(e),this.repositionOverlay();e.style.height="".concat(n,"px"),e.style.width="".concat(r,"px")}}}])&&Pt(n.prototype,r),o&&Pt(n,o),e}();it.registerOverlay(it.CLONE_BOTTOM_LEFT_CORNER,Bt);n(64);var Wt=n(14);function Vt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Yt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n&&(this.eventManager=new E.a(e),this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}var e,n,r;return e=t,(n=[{key:"registerListeners",value:function(){var t=this,e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",function(){return t.onMouseDown()}),this.eventManager.addEventListener(e,"mouseup",function(){return t.onMouseUp()});for(var n=function(e,n){t.eventManager.addEventListener(t.main.childNodes[e],"mouseenter",function(n){return t.onMouseEnter(n,t.main.childNodes[e])})},r=0,o=this.main.childNodes.length;r<o;r++)n(r)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,e){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),Object(Wt.stopImmediatePropagation)(t);var n=this,r=this.wot.rootDocument.body,o=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(r,"mousemove",function t(i){var a;((a=i).clientY<Math.floor(o.top)||a.clientY>Math.ceil(o.top+o.height)||a.clientX<Math.floor(o.left)||a.clientX>Math.ceil(o.left+o.width))&&(n.eventManager.removeEventListener(r,"mousemove",t),e.style.display="block")})}}},{key:"createBorders",value:function(t){var e=this.wot.rootDocument;this.main=e.createElement("div");var n=["top","left","bottom","right","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(var o=0;o<5;o++){var i=n[o],a=e.createElement("div");a.className="wtBorder ".concat(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(a.className+=" hidden"),(r=a.style).backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,r.height=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(t.border.width,"px"),r.width=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(t.border.width,"px"),this.main.appendChild(a)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Object(T.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear();var s=this.wot.wtTable,l=s.bordersHolder;l||((l=e.createElement("div")).className="htBorders",s.bordersHolder=l,s.spreader.appendChild(l)),l.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var t=this,e=this.wot.rootDocument;this.selectionHandles={topLeft:e.createElement("DIV"),topLeftHitArea:e.createElement("DIV"),bottomRight:e.createElement("DIV"),bottomRightHitArea:e.createElement("DIV")};this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var n={position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")};Object(w.objectEach)(n,function(e,n){t.selectionHandles.styles.bottomRightHitArea[n]=e,t.selectionHandles.styles.topLeftHitArea[n]=e});var r={position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Object(w.objectEach)(r,function(e,n){t.selectionHandles.styles.bottomRight[n]=e,t.selectionHandles.styles.topLeft[n]=e}),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(t,e){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||t===n.cellRange.to.row&&e===n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,e,n,r,o,i){var a=parseInt(this.selectionHandles.styles.topLeft.width,10),s=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top="".concat(parseInt(n-a,10),"px"),this.selectionHandles.styles.topLeft.left="".concat(parseInt(r-a,10),"px"),this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(n-s/4*3,10),"px"),this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(r-s/4*3,10),"px"),this.selectionHandles.styles.bottomRight.top="".concat(parseInt(n+i,10),"px"),this.selectionHandles.styles.bottomRight.left="".concat(parseInt(r+o,10),"px"),this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(n+i-s/4,10),"px"),this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(r+o-s/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(t,e)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){for(var e,n,r,o,i=this.wot,a=i.wtTable,s=i.rootDocument,l=i.rootWindow,u=a.getRenderedRowsCount(),c=0;c<u;c+=1){var f=a.rowFilter.renderedToSource(c);if(f>=t[0]&&f<=t[2]){e=f;break}}for(var d=u-1;d>=0;d-=1){var p=a.rowFilter.renderedToSource(d);if(p>=t[0]&&p<=t[2]){n=p;break}}for(var g=a.getRenderedColumnsCount(),v=0;v<g;v+=1){var y=a.columnFilter.renderedToSource(v);if(y>=t[1]&&y<=t[3]){r=y;break}}for(var m=g-1;m>=0;m-=1){var w=a.columnFilter.renderedToSource(m);if(w>=t[1]&&w<=t[3]){o=w;break}}if(void 0!==e&&void 0!==r){var C=a.getCell(new h(e,r)),O=e!==n||r!==o,E=O?a.getCell(new h(n,o)):C,S=Object(b.offset)(C),k=O?Object(b.offset)(E):S,R=Object(b.offset)(a.TABLE),M=S.top,_=S.left,N=_-R.left-1,A=k.left+Object(b.outerWidth)(E)-_;if(this.isEntireColumnSelected(e,n)){var x=this.getDimensionsFromHeader("columns",r,o,R),j=null;if(x){var I=Vt(x,3);j=I[0],N=I[1],A=I[2]}j&&(C=j)}var D=M-R.top-1,P=k.top+Object(b.outerHeight)(E)-M;if(this.isEntireRowSelected(r,o)){var L=this.getDimensionsFromHeader("rows",e,n,R),H=null;if(L){var F=Vt(L,3);H=F[0],D=F[1],P=F[2]}H&&(C=H)}var B=Object(b.getComputedStyle)(C,l);parseInt(B.borderTopWidth,10)>0&&(D+=1,P=P>0?P-1:0),parseInt(B.borderLeftWidth,10)>0&&(N+=1,A=A>0?A-1:0),this.topStyle.top="".concat(D,"px"),this.topStyle.left="".concat(N,"px"),this.topStyle.width="".concat(A,"px"),this.topStyle.display="block",this.leftStyle.top="".concat(D,"px"),this.leftStyle.left="".concat(N,"px"),this.leftStyle.height="".concat(P,"px"),this.leftStyle.display="block";var W=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(D+P-W,"px"),this.bottomStyle.left="".concat(N,"px"),this.bottomStyle.width="".concat(A,"px"),this.bottomStyle.display="block",this.rightStyle.top="".concat(D,"px"),this.rightStyle.left="".concat(N+A-W,"px"),this.rightStyle.height="".concat(P+1,"px"),this.rightStyle.display="block";var V=this.settings.border.cornerVisible;V="function"==typeof V?V(this.settings.layerLevel):V;var U=this.wot.getSetting("onModifyGetCellCoords",n,o),Y=n,z=o;if(U&&Array.isArray(U)){var G=Vt(U,4);Y=G[2],z=G[3]}if(Object(T.isMobileBrowser)()||!V||this.isPartRange(Y,z))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(D+P-4,"px"),this.cornerStyle.left="".concat(N+A-4,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var X=Object(b.getTrimmingContainer)(a.TABLE),q=X===l;if(q&&(X=s.documentElement),o===this.wot.getSetting("totalColumns")-1)(q?E.getBoundingClientRect().left:E.offsetLeft)+Object(b.outerWidth)(E)+parseInt(this.cornerDefaultStyle.width,10)/2>=Object(b.innerWidth)(X)&&(this.cornerStyle.left="".concat(Math.floor(N+A-3-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle.borderRightWidth=0);if(n===this.wot.getSetting("totalRows")-1)(q?E.getBoundingClientRect().top:E.offsetTop)+Object(b.outerHeight)(E)+parseInt(this.cornerDefaultStyle.height,10)/2>=Object(b.innerHeight)(X)&&(this.cornerStyle.top="".concat(Math.floor(D+P-3-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0);this.cornerStyle.display="block"}Object(T.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(n,o,D,N,A,P)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(t,e,n,r){var o=this.wot.wtTable,i=o.wtRootElement.parentNode,a=null,s=null,l=null,u=null,c=null,f=null,h=null,d=null;switch(t){case"rows":a=function(){return o.getRowHeader.apply(o,arguments)},s=function(){return b.outerHeight.apply(void 0,arguments)},l="ht__selection--rows",f="top";break;case"columns":a=function(){return o.getColumnHeader.apply(o,arguments)},s=function(){return b.outerWidth.apply(void 0,arguments)},l="ht__selection--columns",f="left"}if(i.className.includes(l)){var p=this.wot.getSetting("columnHeaders").length;if(h=a(e,p-1),d=a(n,p-1),!h||!d)return!1;var g=Object(b.offset)(h),v=Object(b.offset)(d);return h&&d&&(u=g[f]-r[f]-1,c=v[f]+s(d)-g[f]),[h,u,c]}return!1}},{key:"changeBorderStyle",value:function(t,e){var n=this[t].style,r=e[t];!r||r.hide?Object(b.addClass)(this[t],"hidden"):(Object(b.hasClass)(this[t],"hidden")&&Object(b.removeClass)(this[t],"hidden"),n.backgroundColor=r.color,"top"!==t&&"bottom"!==t||(n.height="".concat(r.width,"px")),"right"!==t&&"left"!==t||(n.width="".concat(r.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(t){var e=1,n="#000",r=this[t].style;r.backgroundColor=n,r.width="".concat(e,"px"),r.height="".concat(e,"px")}},{key:"toggleHiddenClass",value:function(t,e){this.changeBorderToDefaultStyle(t),e?Object(b.addClass)(this[t],"hidden"):Object(b.removeClass)(this[t],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",Object(T.isMobileBrowser)()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}}])&&Ut(e.prototype,n),r&&Ut(e,r),t}();n(24);function zt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Gt(t){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var qt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}var e,n,r;return e=t,(n=[{key:"getBorder",value:function(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new Yt(t,this.settings)),this.instanceBorders[t.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(t){return this.isEmpty()?this.cellRange=new p(t):this.cellRange.expand(t),this}},{key:"replace",value:function(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var t=this.cellRange.getTopLeftCorner(),e=this.cellRange.getBottomRightCorner();return[t.row,t.col,e.row,e.col]}},{key:"addClassAtCoords",value:function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t.wtTable.getCell(new h(e,n));if("object"===Gt(i)){var a=r;o&&(a=this.classNameGenerator(i),this.classNames.includes(a)||this.classNames.push(a)),Object(b.addClass)(i,a)}return this}},{key:"linearClassNameGenerator",value:function(t,e){return function n(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===e||0===o)return t;var i=o>=0?o:e,a=t,s=0===(i-=1)?t:"".concat(t,"-").concat(i);if(Object(b.hasClass)(r,s)){var l=i+1;a="".concat(t,"-").concat(l)}else a=n(r,i);return a}}},{key:"draw",value:function(t){if(this.isEmpty())this.settings.border&&this.getBorder(t).disappear();else{for(var e=t.wtTable.getRenderedRowsCount(),n=t.wtTable.getRenderedColumnsCount(),r=this.getCorners(),o=zt(r,4),i=o[0],a=o[1],s=o[2],l=o[3],u=0;u<n;u+=1){var c=t.wtTable.columnFilter.renderedToSource(u);if(c>=a&&c<=l){var f=t.wtTable.getColumnHeader(c);if(f){var h=[];this.settings.highlightHeaderClassName&&h.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&h.push(this.settings.highlightColumnClassName),Object(b.addClass)(f,h)}}}for(var d=0;d<e;d+=1){var p=t.wtTable.rowFilter.renderedToSource(d);if(p>=i&&p<=s){var g=t.wtTable.getRowHeader(p);if(g){var v=[];this.settings.highlightHeaderClassName&&v.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&v.push(this.settings.highlightRowClassName),Object(b.addClass)(g,v)}}for(var y=0;y<n;y+=1){var m=t.wtTable.columnFilter.renderedToSource(y);p>=i&&p<=s&&m>=a&&m<=l?this.settings.className&&this.addClassAtCoords(t,p,m,this.settings.className,this.settings.markIntersections):p>=i&&p<=s?this.settings.highlightRowClassName&&this.addClassAtCoords(t,p,m,this.settings.highlightRowClassName):m>=a&&m<=l&&this.settings.highlightColumnClassName&&this.addClassAtCoords(t,p,m,this.settings.highlightColumnClassName);var w=t.getSetting("onAfterDrawSelection",p,m,r,this.settings.layerLevel);"string"==typeof w&&this.addClassAtCoords(t,p,m,w)}}t.getSetting("onBeforeDrawBorders",r,this.settings.className),this.settings.border&&this.getBorder(t).appear(r)}}}])&&Xt(e.prototype,n),r&&Xt(e,r),t}();n.d(e,"d",function(){return a}),n.d(e,"a",function(){return h}),n.d(e,"b",function(){return p}),n.d(e,"e",function(){return et}),n.d(e,"c",function(){return qt})},function(t,e,n){var r=n(199),o=Object.prototype;r!==o.toString&&n(71)(o,"toString",r,{unsafe:!0})},function(t,e,n){"use strict";var r=n(70),o=n(116),i=n(102),a=n(86),s=n(138),l=a.set,u=a.getterFor("Array Iterator");t.exports=s(Array,"Array",function(t,e){l(this,{type:"Array Iterator",target:r(t),index:0,kind:e})},function(){var t=u(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}},"values"),i.Arguments=i.Array,o("keys"),o("values"),o("entries")},function(t,e,n){"use strict";var r=n(140),o=n(86),i=n(138),a=o.set,s=o.getterFor("String Iterator");i(String,"String",function(t){a(this,{type:"String Iterator",string:String(t),index:0})},function(){var t,e=s(this),n=e.string,o=e.index;return o>=n.length?{value:void 0,done:!0}:(t=r(n,o,!0),e.index+=t.length,{value:t,done:!1})})},function(t,e,n){var r=n(174),o=n(7),i=n(41),a=n(67),s=n(46),l=s("iterator"),u=s("toStringTag"),c=o.values;for(var f in r){var h=i[f],d=h&&h.prototype;if(d){if(d[l]!==c)try{a(d,l,c)}catch(t){d[l]=c}if(d[u]||a(d,u,f),r[f])for(var p in o)if(d[p]!==o[p])try{a(d,p,o[p])}catch(t){d[p]=o[p]}}}},function(t,e,n){"use strict";var r=n(41),o=n(55),i=n(58),a=n(111),s=n(27),l=n(71),u=n(96),c=n(37),f=n(100),h=n(118),d=n(113),p=n(46),g=n(175),v=n(176),y=n(200),m=n(119),b=n(53),w=n(49),C=n(70),O=n(99),E=n(98),S=n(101),k=n(157),R=n(90),T=n(59),M=n(97),_=n(67),N=n(91),A=n(112)("hidden"),x=n(86),j=x.set,I=x.getterFor("Symbol"),D=R.f,P=T.f,L=k.f,H=r.Symbol,F=r.JSON,B=F&&F.stringify,W=p("toPrimitive"),V=M.f,U=f("symbol-registry"),Y=f("symbols"),z=f("op-symbols"),G=f("wks"),X=Object.prototype,q=r.QObject,K=n(163),$=!q||!q.prototype||!q.prototype.findChild,Z=i&&c(function(){return 7!=S(P({},"a",{get:function(){return P(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=D(X,e);r&&delete X[e],P(t,e,n),r&&t!==X&&P(X,e,r)}:P,Q=function(t,e){var n=Y[t]=S(H.prototype);return j(n,{type:"Symbol",tag:t,description:e}),i||(n.description=e),n},J=K&&"symbol"==typeof H.iterator?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof H},tt=function(t,e,n){return t===X&&tt(z,e,n),b(t),e=O(e,!0),b(n),o(Y,e)?(n.enumerable?(o(t,A)&&t[A][e]&&(t[A][e]=!1),n=S(n,{enumerable:E(0,!1)})):(o(t,A)||P(t,A,E(1,{})),t[A][e]=!0),Z(t,e,n)):P(t,e,n)},et=function(t,e){b(t);for(var n,r=y(e=C(e)),o=0,i=r.length;i>o;)tt(t,n=r[o++],e[n]);return t},nt=function(t){var e=V.call(this,t=O(t,!0));return!(this===X&&o(Y,t)&&!o(z,t))&&(!(e||!o(this,t)||!o(Y,t)||o(this,A)&&this[A][t])||e)},rt=function(t,e){if(t=C(t),e=O(e,!0),t!==X||!o(Y,e)||o(z,e)){var n=D(t,e);return!n||!o(Y,e)||o(t,A)&&t[A][e]||(n.enumerable=!0),n}},ot=function(t){for(var e,n=L(C(t)),r=[],i=0;n.length>i;)o(Y,e=n[i++])||o(u,e)||r.push(e);return r},it=function(t){for(var e,n=t===X,r=L(n?z:C(t)),i=[],a=0;r.length>a;)!o(Y,e=r[a++])||n&&!o(X,e)||i.push(Y[e]);return i};K||(l((H=function(){if(this instanceof H)throw TypeError("Symbol is not a constructor");var t=void 0===arguments[0]?void 0:String(arguments[0]),e=d(t),n=function(t){this===X&&n.call(z,t),o(this,A)&&o(this[A],e)&&(this[A][e]=!1),Z(this,e,E(1,t))};return i&&$&&Z(X,e,{configurable:!0,set:n}),Q(e,t)}).prototype,"toString",function(){return I(this).tag}),M.f=nt,T.f=tt,R.f=rt,n(95).f=k.f=ot,n(114).f=it,i&&(P(H.prototype,"description",{configurable:!0,get:function(){return I(this).description}}),a||l(X,"propertyIsEnumerable",nt,{unsafe:!0})),g.f=function(t){return Q(p(t),t)}),s({global:!0,wrap:!0,forced:!K,sham:!K},{Symbol:H});for(var at=N(G),st=0;at.length>st;)v(at[st++]);s({target:"Symbol",stat:!0,forced:!K},{for:function(t){return o(U,t+="")?U[t]:U[t]=H(t)},keyFor:function(t){if(!J(t))throw TypeError(t+" is not a symbol");for(var e in U)if(U[e]===t)return e},useSetter:function(){$=!0},useSimple:function(){$=!1}}),s({target:"Object",stat:!0,forced:!K,sham:!i},{create:function(t,e){return void 0===e?S(t):et(S(t),e)},defineProperty:tt,defineProperties:et,getOwnPropertyDescriptor:rt}),s({target:"Object",stat:!0,forced:!K},{getOwnPropertyNames:ot,getOwnPropertySymbols:it}),F&&s({target:"JSON",stat:!0,forced:!K||c(function(){var t=H();return"[null]"!=B([t])||"{}"!=B({a:t})||"{}"!=B(Object(t))})},{stringify:function(t){for(var e,n,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);if(n=e=r[1],(w(e)||void 0!==t)&&!J(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!J(e))return e}),r[1]=e,B.apply(F,r)}}),H.prototype[W]||_(H.prototype,W,H.prototype.valueOf),h(H,"Symbol"),u[A]=!0},function(t,e,n){"use strict";var r=n(58),o=n(55),i=n(49),a=n(59).f,s=n(162),l=n(41).Symbol;if(r&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var u={},c=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof c?new l(t):void 0===t?l():l(t);return""===t&&(u[e]=!0),e};s(c,l);var f=c.prototype=l.prototype;f.constructor=c;var h=f.toString,d="Symbol(test)"==String(l("test")),p=/^Symbol\((.*)\)[^)]+$/;a(f,"description",{configurable:!0,get:function(){var t=i(this)?this.valueOf():this,e=h.call(t);if(o(u,t))return"";var n=d?e.slice(7,-1):e.replace(p,"$1");return""===n?void 0:n}}),n(27)({global:!0,forced:!0},{Symbol:c})}},function(t,e,n){n(176)("iterator")},function(t,e,n){"use strict";n.r(e),n.d(e,"stringify",function(){return p}),n.d(e,"isDefined",function(){return g}),n.d(e,"isUndefined",function(){return v}),n.d(e,"isEmpty",function(){return y}),n.d(e,"isRegExp",function(){return m}),n.d(e,"_injectProductInfo",function(){return N});n(10),n(11),n(12),n(7),n(35),n(72),n(6),n(26),n(205),n(8),n(183),n(52),n(61),n(9);var r=n(25),o=n.n(r),i=n(33);function a(){var t=h(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.']);return a=function(){return t},t}function s(){var t=h(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.']);return s=function(){return t},t}function l(){var t=h(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.']);return l=function(){return t},t}function u(){var t=h(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."]);return u=function(){return t},t}function c(){var t=h(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."]);return c=function(){return t},t}function f(){var t=h(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."]);return f=function(){return t},t}function h(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t){var e;switch(d(t)){case"string":case"number":e="".concat(t);break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function g(t){return void 0!==t}function v(t){return void 0===t}function y(t){return null===t||""===t||v(t)}function m(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var b="length",w=function(t){return parseInt(t,16)},C=function(t){return parseInt(t,10)},O=function(t,e,n){return t.substr(e,n)},E=function(t){return t.codePointAt(0)-65},S=function(t){return"".concat(t).replace(/\-/g,"")},k=function(t){return w(O(S(t),w("12"),E("F")))/(w(O(S(t),E("B"),~~![][b]))||9)},R=function(){return"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},T=!1,M={invalid:function(){return Object(i.a)(f())},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return Object(i.a)(c(),e,n,e)},missing:function(){return Object(i.a)(u())},non_commercial:function(){return""}},_={invalid:function(){return Object(i.a)(l())},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return Object(i.a)(s(),e,n,e)},missing:function(){return Object(i.a)(a())},non_commercial:function(){return""}};function N(t,e){var n,r=!y(t),i="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),a="invalid",s="invalid",l=function(t){var e=[][b],n=e;if(t[b]!==E("Z"))return!1;for(var r="",o="B<H4P+".split(""),i=E(o.shift());i;i=E(o.shift()||"A"))--i<""[b]?n|=(C("".concat(C(w(r)+(w(O(t,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:r=O(t,i,i?1===o[b]?9:8:6);return n===e}(t=S(t||""));if(r||i||l)if(l){var u=o()("09/04/2019","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=k(t);if(n=o()(864e5*(f+1),"x").format("MMMM DD, YYYY"),c>f){var h=o()().diff(u,"days");a=h<=1?"valid":"expired",s=h<=15?"valid":"expired"}else a="valid",s="valid"}else i?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";(R()&&(a="valid",s="valid"),T||"valid"===a)||(M[a]({keyValidityDate:n,hotVersion:"7.0.2"})&&console["non_commercial"===a?"info":"warn"](M[a]({keyValidityDate:n,hotVersion:"7.0.2"})),T=!0);if("valid"!==s&&e.parentNode&&_[s]({keyValidityDate:n,hotVersion:"7.0.2"})){var d=document.createElement("div");d.id="hot-display-license-info",d.innerHTML=_[s]({keyValidityDate:n,hotVersion:"7.0.2"}),e.parentNode.insertBefore(d,e.nextSibling)}}},function(t,e,n){"use strict";n.r(e),n.d(e,"stopImmediatePropagation",function(){return o}),n.d(e,"isImmediatePropagationStopped",function(){return i}),n.d(e,"stopPropagation",function(){return a}),n.d(e,"pageX",function(){return s}),n.d(e,"pageY",function(){return l}),n.d(e,"isRightClick",function(){return u}),n.d(e,"isLeftClick",function(){return c});var r=n(0);function o(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function i(t){return!1===t.isImmediatePropagationEnabled}function a(t){"function"==typeof t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function s(t){if(t.pageX)return t.pageX;var e=t.target.ownerDocument.defaultView;return t.clientX+Object(r.getWindowScrollLeft)(e)}function l(t){if(t.pageY)return t.pageY;var e=t.target.ownerDocument.defaultView;return t.clientY+Object(r.getWindowScrollTop)(e)}function u(t){return 2===t.button}function c(t){return 0===t.button}},function(t,e,n){"use strict";n.d(e,"d",function(){return s}),n.d(e,"a",function(){return l}),n.d(e,"c",function(){return u}),n.d(e,"b",function(){return c});n(7),n(73),n(6),n(8),n(31),n(9);var r=n(16),o=n(2),i=n(36),a=new WeakMap;function s(t,e){var n=Object(i.toUpperCaseFirst)(t);r.a.getSingleton().add("construct",function(){a.has(this)||a.set(this,{});var t=a.get(this);t[n]||(t[n]=new e(this))}),r.a.getSingleton().add("afterDestroy",function(){if(a.has(this)){var t=a.get(this);Object(o.objectEach)(t,function(t){return t.destroy()}),a.delete(this)}})}function l(t,e){if("string"!=typeof e)throw Error('Only strings can be passed as "plugin" parameter');var n=Object(i.toUpperCaseFirst)(e);if(a.has(t)&&a.get(t)[n])return a.get(t)[n]}function u(t){return a.has(t)?Object.keys(a.get(t)):[]}function c(t,e){var n=null;return a.has(t)&&Object(o.objectEach)(a.get(t),function(t,r){t===e&&(n=r)}),n}},function(t,e,n){"use strict";n(21),n(43);var r=n(1),o=n(2);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}var s=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","skipLengthCache","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions"],l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.globalBucket=this.createEmptyBucket()}return a(t,null,[{key:"getSingleton",value:function(){return u}}]),a(t,[{key:"createEmptyBucket",value:function(){var t=Object.create(null);return Object(r.arrayEach)(s,function(e){return t[e]=[]}),t}},{key:"getBucket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}},{key:"add",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))Object(r.arrayEach)(e,function(e){return n.add(t,e,o)});else{var i=this.getBucket(o);if(void 0===i[t]&&(this.register(t),i[t]=[]),e.skip=!1,-1===i[t].indexOf(e)){var a=!1;e.initialHook&&Object(r.arrayEach)(i[t],function(n,r){if(n.initialHook)return i[t][r]=e,a=!0,!1}),a||i[t].push(e)}}return this}},{key:"once",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?Object(r.arrayEach)(e,function(e){return n.once(t,e,o)}):(e.runOnce=!0,this.add(t,e,o))}},{key:"remove",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return void 0!==r[t]&&r[t].indexOf(e)>=0&&(e.skip=!0,!0)}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(e);return!(void 0===n[t]||!n[t].length)}},{key:"run",value:function(t,e,n,r,o,i,a,s){var l=this.globalBucket[e],u=l?l.length:0,c=0;if(u)for(;c<u;)if(l[c]&&!l[c].skip){var f=l[c].call(t,n,r,o,i,a,s);void 0!==f&&(n=f),l[c]&&l[c].runOnce&&this.remove(e,l[c]),c+=1}else c+=1;var h=this.getBucket(t)[e],d=h?h.length:0,p=0;if(d)for(;p<d;)if(h[p]&&!h[p].skip){var g=h[p].call(t,n,r,o,i,a,s);void 0!==g&&(n=g),h[p]&&h[p].runOnce&&this.remove(e,h[p],t),p+=1}else p+=1;return n}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(o.objectEach)(this.getBucket(t),function(t,e,n){return n[e].length=0})}},{key:"register",value:function(t){this.isRegistered(t)||s.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&s.splice(s.indexOf(t),1)}},{key:"isRegistered",value:function(t){return s.indexOf(t)>=0}},{key:"getRegistered",value:function(){return s}}]),t}(),u=new l;e.a=l},function(t,e,n){"use strict";n.r(e),n.d(e,"KEY_CODES",function(){return o}),n.d(e,"isPrintableChar",function(){return i}),n.d(e,"isMetaKey",function(){return a}),n.d(e,"isCtrlKey",function(){return s}),n.d(e,"isCtrlMetaKey",function(){return l}),n.d(e,"isKey",function(){return u});n(44),n(21),n(50),n(61);var r=n(1),o={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88};function i(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function a(t){return-1!==[o.ARROW_DOWN,o.ARROW_UP,o.ARROW_LEFT,o.ARROW_RIGHT,o.HOME,o.END,o.DELETE,o.BACKSPACE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.TAB,o.PAGE_DOWN,o.PAGE_UP,o.ENTER,o.ESCAPE,o.SHIFT,o.CAPS_LOCK,o.ALT].indexOf(t)}function s(t){var e=[];return navigator.platform.includes("Mac")?e.push(o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX):e.push(o.CONTROL),e.includes(t)}function l(t){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(t)}function u(t,e){var n=e.split("|"),i=!1;return Object(r.arrayEach)(n,function(e){if(t===o[e])return i=!0,!1}),i}},function(t,e,n){var r=n(68),o=n(117),i=n(166),a=n(37)(function(){o(1)});n(27)({target:"Object",stat:!0,forced:a,sham:!i},{getPrototypeOf:function(t){return o(r(t))}})},function(t,e,n){n(27)({target:"Object",stat:!0},{setPrototypeOf:n(139)})},function(t,e,n){"use strict";n.d(e,"b",function(){return f});n(43);var r=n(0),o=n(2),i=n(34),a=n(14);function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=0,u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}var e,n,r;return e=t,(n=[{key:"addEventListener",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this.context;function s(t){n.call(this,c(a,t))}return"boolean"==typeof o||Object(i.isPassiveEventSupported)()||(o=!1),this.context.eventListeners.push({element:t,event:e,callback:n,callbackProxy:s,options:o}),t.addEventListener(e,s,o),l+=1,function(){r.removeEventListener(t,e,n)}}},{key:"removeEventListener",value:function(t,e,n){for(var r,o=this.context.eventListeners.length;o;)if(o-=1,(r=this.context.eventListeners[o]).event===e&&r.element===t){if(n&&n!==r.callback)continue;this.context.eventListeners.splice(o,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),l-=1}}},{key:"clearEvents",value:function(){if(this.context)for(var t=this.context.eventListeners.length;t;){t-=1;var e=this.context.eventListeners[t];e&&this.removeEventListener(e.element,e.event,e.callback)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"fireEvent",value:function(t,e){var n=t.document,r=t;n||(r=(n=t.ownerDocument?t.ownerDocument:t).defaultView);var o,i={bubbles:!0,cancelable:"mousemove"!==e,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};n.createEvent?(o=n.createEvent("MouseEvents")).initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode):o=n.createEventObject(),t.dispatchEvent?t.dispatchEvent(o):t.fireEvent("on".concat(e),o)}}])&&s(e.prototype,n),r&&s(e,r),t}();function c(t,e){var n,s,l,c,f;e.isTargetWebComponent=!1,e.realTarget=e.target;var h=e.stopImmediatePropagation;if(e.stopImmediatePropagation=function(){h.apply(this),Object(a.stopImmediatePropagation)(this)},!u.isHotTableEnv)return e;for(f=(e=Object(r.polymerWrap)(e)).path?e.path.length:0;f;){if(f-=1,"HOT-TABLE"===e.path[f].nodeName)n=!0;else if(n&&e.path[f].shadowRoot){c=e.path[f];break}0!==f||c||(c=e.path[f])}return c||(c=e.target),e.isTargetWebComponent=!0,Object(i.isWebComponentSupportedNatively)()?e.realTarget=e.srcElement||e.toElement:(Object(o.hasOwnProperty)(t,"hot")||t.isHotTableEnv||t.wtTable)&&(Object(o.hasOwnProperty)(t,"hot")?s=t.hot?t.hot.view.wt.wtTable.TABLE:null:t.isHotTableEnv?s=t.view.activeWt.wtTable.TABLE.parentNode.parentNode:t.wtTable&&(s=t.wtTable.TABLE.parentNode.parentNode),l=Object(r.closest)(e.target,["HOT-TABLE"],s),e.realTarget=l&&s.querySelector("HOT-TABLE")||e.target),Object.defineProperty(e,"target",{get:function(){return Object(r.polymerWrap)(c)},enumerable:!0,configurable:!0}),e}function f(){return l}e.a=u},function(t,e,n){"use strict";var r=n(134)(!1),o=[].indexOf,i=!!o&&1/[1].indexOf(1,-0)<0,a=n(122)("indexOf");n(27)({target:"Array",proto:!0,forced:i||a},{indexOf:function(t){return i?o.apply(this,arguments)||0:r(this,t,arguments[1])}})},function(t,e,n){var r=n(70),o=n(90).f,i=n(58),a=n(37)(function(){o(1)}),s=!i||a;n(27)({target:"Object",stat:!0,forced:s,sham:!i},{getOwnPropertyDescriptor:function(t,e){return o(r(t),e)}})},function(t,e,n){var r=n(90),o=n(117),i=n(55),a=n(49),s=n(53);n(27)({target:"Reflect",stat:!0},{get:function t(e,n){var l,u,c=arguments.length<3?e:arguments[2];return s(e)===c?e[n]:(l=r.f(e,n))?i(l,"value")?l.value:void 0===l.get?void 0:l.get.call(c):a(u=o(e))?t(u,n,c):void 0}})},function(t,e,n){"use strict";var r=n(119),o=n(49),i=n(68),a=n(57),s=n(121),l=n(145),u=n(46)("isConcatSpreadable"),c=!n(37)(function(){var t=[];return t[u]=!1,t.concat()[0]!==t}),f=n(106)("concat"),h=function(t){if(!o(t))return!1;var e=t[u];return void 0!==e?!!e:r(t)},d=!c||!f;n(27)({target:"Array",proto:!0,forced:d},{concat:function(t){var e,n,r,o,u,c=i(this),f=l(c,0),d=0;for(e=-1,r=arguments.length;e<r;e++)if(u=-1===e?c:arguments[e],h(u)){if(d+(o=a(u.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<o;n++,d++)n in u&&s(f,d,u[n])}else{if(d>=9007199254740991)throw TypeError("Maximum allowed index exceeded");s(f,d++,u)}return f.length=d,f}})},function(t,e,n){(function(t){t.exports=function(){"use strict";var e,n;function r(){return e.apply(null,arguments)}function o(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function i(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function a(t){return void 0===t}function s(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function l(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function u(t,e){var n,r=[];for(n=0;n<t.length;++n)r.push(e(t[n],n));return r}function c(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function f(t,e){for(var n in e)c(e,n)&&(t[n]=e[n]);return c(e,"toString")&&(t.toString=e.toString),c(e,"valueOf")&&(t.valueOf=e.valueOf),t}function h(t,e,n,r){return Me(t,e,n,r,!0).utc()}function d(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function p(t){if(null==t._isValid){var e=d(t),r=n.call(e.parsedDateParts,function(t){return null!=t}),o=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r);if(t._strict&&(o=o&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return o;t._isValid=o}return t._isValid}function g(t){var e=h(NaN);return null!=t?f(d(e),t):d(e).userInvalidated=!0,e}n=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),n=e.length>>>0,r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};var v=r.momentProperties=[];function y(t,e){var n,r,o;if(a(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),a(e._i)||(t._i=e._i),a(e._f)||(t._f=e._f),a(e._l)||(t._l=e._l),a(e._strict)||(t._strict=e._strict),a(e._tzm)||(t._tzm=e._tzm),a(e._isUTC)||(t._isUTC=e._isUTC),a(e._offset)||(t._offset=e._offset),a(e._pf)||(t._pf=d(e)),a(e._locale)||(t._locale=e._locale),v.length>0)for(n=0;n<v.length;n++)r=v[n],a(o=e[r])||(t[r]=o);return t}var m=!1;function b(t){y(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===m&&(m=!0,r.updateOffset(this),m=!1)}function w(t){return t instanceof b||null!=t&&null!=t._isAMomentObject}function C(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function O(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=C(e)),n}function E(t,e,n){var r,o=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),a=0;for(r=0;r<o;r++)(n&&t[r]!==e[r]||!n&&O(t[r])!==O(e[r]))&&a++;return a+i}function S(t){!1===r.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function k(t,e){var n=!0;return f(function(){if(null!=r.deprecationHandler&&r.deprecationHandler(null,t),n){for(var o,i=[],a=0;a<arguments.length;a++){if(o="","object"==typeof arguments[a]){for(var s in o+="\n["+a+"] ",arguments[0])o+=s+": "+arguments[0][s]+", ";o=o.slice(0,-2)}else o=arguments[a];i.push(o)}S(t+"\nArguments: "+Array.prototype.slice.call(i).join("")+"\n"+(new Error).stack),n=!1}return e.apply(this,arguments)},e)}var R,T={};function M(t,e){null!=r.deprecationHandler&&r.deprecationHandler(t,e),T[t]||(S(e),T[t]=!0)}function _(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function N(t,e){var n,r=f({},t);for(n in e)c(e,n)&&(i(t[n])&&i(e[n])?(r[n]={},f(r[n],t[n]),f(r[n],e[n])):null!=e[n]?r[n]=e[n]:delete r[n]);for(n in t)c(t,n)&&!c(e,n)&&i(t[n])&&(r[n]=f({},r[n]));return r}function A(t){null!=t&&this.set(t)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null,R=Object.keys?Object.keys:function(t){var e,n=[];for(e in t)c(t,e)&&n.push(e);return n};var x={};function j(t,e){var n=t.toLowerCase();x[n]=x[n+"s"]=x[e]=t}function I(t){return"string"==typeof t?x[t]||x[t.toLowerCase()]:void 0}function D(t){var e,n,r={};for(n in t)c(t,n)&&(e=I(n))&&(r[e]=t[n]);return r}var P={};function L(t,e){P[t]=e}function H(t,e,n){var r=""+Math.abs(t),o=e-r.length,i=t>=0;return(i?n?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+r}var F=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,B=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,W={},V={};function U(t,e,n,r){var o=r;"string"==typeof r&&(o=function(){return this[r]()}),t&&(V[t]=o),e&&(V[e[0]]=function(){return H(o.apply(this,arguments),e[1],e[2])}),n&&(V[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),t)})}function Y(t,e){return t.isValid()?(e=z(e,t.localeData()),W[e]=W[e]||function(t){var e,n,r,o=t.match(F);for(e=0,n=o.length;e<n;e++)V[o[e]]?o[e]=V[o[e]]:o[e]=(r=o[e]).match(/\[[\s\S]/)?r.replace(/^\[|\]$/g,""):r.replace(/\\/g,"");return function(e){var r,i="";for(r=0;r<n;r++)i+=_(o[r])?o[r].call(e,t):o[r];return i}}(e),W[e](t)):t.localeData().invalidDate()}function z(t,e){var n=5;function r(t){return e.longDateFormat(t)||t}for(B.lastIndex=0;n>=0&&B.test(t);)t=t.replace(B,r),B.lastIndex=0,n-=1;return t}var G=/\d/,X=/\d\d/,q=/\d{3}/,K=/\d{4}/,$=/[+-]?\d{6}/,Z=/\d\d?/,Q=/\d\d\d\d?/,J=/\d\d\d\d\d\d?/,tt=/\d{1,3}/,et=/\d{1,4}/,nt=/[+-]?\d{1,6}/,rt=/\d+/,ot=/[+-]?\d+/,it=/Z|[+-]\d\d:?\d\d/gi,at=/Z|[+-]\d\d(?::?\d\d)?/gi,st=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,lt={};function ut(t,e,n){lt[t]=_(e)?e:function(t,r){return t&&n?n:e}}function ct(t,e){return c(lt,t)?lt[t](e._strict,e._locale):new RegExp(ft(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,n,r,o){return e||n||r||o})))}function ft(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var ht={};function dt(t,e){var n,r=e;for("string"==typeof t&&(t=[t]),s(e)&&(r=function(t,n){n[e]=O(t)}),n=0;n<t.length;n++)ht[t[n]]=r}function pt(t,e){dt(t,function(t,n,r,o){r._w=r._w||{},e(t,r._w,r,o)})}function gt(t,e,n){null!=e&&c(ht,t)&&ht[t](e,n._a,n,t)}var vt=0,yt=1,mt=2,bt=3,wt=4,Ct=5,Ot=6,Et=7,St=8;function kt(t){return Rt(t)?366:365}function Rt(t){return t%4==0&&t%100!=0||t%400==0}U("Y",0,0,function(){var t=this.year();return t<=9999?""+t:"+"+t}),U(0,["YY",2],0,function(){return this.year()%100}),U(0,["YYYY",4],0,"year"),U(0,["YYYYY",5],0,"year"),U(0,["YYYYYY",6,!0],0,"year"),j("year","y"),L("year",1),ut("Y",ot),ut("YY",Z,X),ut("YYYY",et,K),ut("YYYYY",nt,$),ut("YYYYYY",nt,$),dt(["YYYYY","YYYYYY"],vt),dt("YYYY",function(t,e){e[vt]=2===t.length?r.parseTwoDigitYear(t):O(t)}),dt("YY",function(t,e){e[vt]=r.parseTwoDigitYear(t)}),dt("Y",function(t,e){e[vt]=parseInt(t,10)}),r.parseTwoDigitYear=function(t){return O(t)+(O(t)>68?1900:2e3)};var Tt,Mt=_t("FullYear",!0);function _t(t,e){return function(n){return null!=n?(At(this,t,n),r.updateOffset(this,e),this):Nt(this,t)}}function Nt(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function At(t,e,n){t.isValid()&&!isNaN(n)&&("FullYear"===e&&Rt(t.year())&&1===t.month()&&29===t.date()?t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),xt(n,t.month())):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function xt(t,e){if(isNaN(t)||isNaN(e))return NaN;var n,r=(e%(n=12)+n)%n;return t+=(e-r)/12,1===r?Rt(t)?29:28:31-r%7%2}Tt=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},U("M",["MM",2],"Mo",function(){return this.month()+1}),U("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),U("MMMM",0,0,function(t){return this.localeData().months(this,t)}),j("month","M"),L("month",8),ut("M",Z),ut("MM",Z,X),ut("MMM",function(t,e){return e.monthsShortRegex(t)}),ut("MMMM",function(t,e){return e.monthsRegex(t)}),dt(["M","MM"],function(t,e){e[yt]=O(t)-1}),dt(["MMM","MMMM"],function(t,e,n,r){var o=n._locale.monthsParse(t,r,n._strict);null!=o?e[yt]=o:d(n).invalidMonth=t});var jt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,It="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Dt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Pt(t,e){var n;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=O(e);else if(!s(e=t.localeData().monthsParse(e)))return t;return n=Math.min(t.date(),xt(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function Lt(t){return null!=t?(Pt(this,t),r.updateOffset(this,!0),this):Nt(this,"Month")}var Ht=st,Ft=st;function Bt(){function t(t,e){return e.length-t.length}var e,n,r=[],o=[],i=[];for(e=0;e<12;e++)n=h([2e3,e]),r.push(this.monthsShort(n,"")),o.push(this.months(n,"")),i.push(this.months(n,"")),i.push(this.monthsShort(n,""));for(r.sort(t),o.sort(t),i.sort(t),e=0;e<12;e++)r[e]=ft(r[e]),o[e]=ft(o[e]);for(e=0;e<24;e++)i[e]=ft(i[e]);this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function Wt(t){var e=new Date(Date.UTC.apply(null,arguments));return t<100&&t>=0&&isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t),e}function Vt(t,e,n){var r=7+e-n,o=(7+Wt(t,0,r).getUTCDay()-e)%7;return-o+r-1}function Ut(t,e,n,r,o){var i,a,s=(7+n-r)%7,l=Vt(t,r,o),u=1+7*(e-1)+s+l;return u<=0?a=kt(i=t-1)+u:u>kt(t)?(i=t+1,a=u-kt(t)):(i=t,a=u),{year:i,dayOfYear:a}}function Yt(t,e,n){var r,o,i=Vt(t.year(),e,n),a=Math.floor((t.dayOfYear()-i-1)/7)+1;return a<1?(o=t.year()-1,r=a+zt(o,e,n)):a>zt(t.year(),e,n)?(r=a-zt(t.year(),e,n),o=t.year()+1):(o=t.year(),r=a),{week:r,year:o}}function zt(t,e,n){var r=Vt(t,e,n),o=Vt(t+1,e,n);return(kt(t)-r+o)/7}U("w",["ww",2],"wo","week"),U("W",["WW",2],"Wo","isoWeek"),j("week","w"),j("isoWeek","W"),L("week",5),L("isoWeek",5),ut("w",Z),ut("ww",Z,X),ut("W",Z),ut("WW",Z,X),pt(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=O(t)}),U("d",0,"do","day"),U("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),U("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),U("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),U("e",0,0,"weekday"),U("E",0,0,"isoWeekday"),j("day","d"),j("weekday","e"),j("isoWeekday","E"),L("day",11),L("weekday",11),L("isoWeekday",11),ut("d",Z),ut("e",Z),ut("E",Z),ut("dd",function(t,e){return e.weekdaysMinRegex(t)}),ut("ddd",function(t,e){return e.weekdaysShortRegex(t)}),ut("dddd",function(t,e){return e.weekdaysRegex(t)}),pt(["dd","ddd","dddd"],function(t,e,n,r){var o=n._locale.weekdaysParse(t,r,n._strict);null!=o?e.d=o:d(n).invalidWeekday=t}),pt(["d","e","E"],function(t,e,n,r){e[r]=O(t)});var Gt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Xt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),qt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Kt=st,$t=st,Zt=st;function Qt(){function t(t,e){return e.length-t.length}var e,n,r,o,i,a=[],s=[],l=[],u=[];for(e=0;e<7;e++)n=h([2e3,1]).day(e),r=this.weekdaysMin(n,""),o=this.weekdaysShort(n,""),i=this.weekdays(n,""),a.push(r),s.push(o),l.push(i),u.push(r),u.push(o),u.push(i);for(a.sort(t),s.sort(t),l.sort(t),u.sort(t),e=0;e<7;e++)s[e]=ft(s[e]),l[e]=ft(l[e]),u[e]=ft(u[e]);this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Jt(){return this.hours()%12||12}function te(t,e){U(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function ee(t,e){return e._meridiemParse}U("H",["HH",2],0,"hour"),U("h",["hh",2],0,Jt),U("k",["kk",2],0,function(){return this.hours()||24}),U("hmm",0,0,function(){return""+Jt.apply(this)+H(this.minutes(),2)}),U("hmmss",0,0,function(){return""+Jt.apply(this)+H(this.minutes(),2)+H(this.seconds(),2)}),U("Hmm",0,0,function(){return""+this.hours()+H(this.minutes(),2)}),U("Hmmss",0,0,function(){return""+this.hours()+H(this.minutes(),2)+H(this.seconds(),2)}),te("a",!0),te("A",!1),j("hour","h"),L("hour",13),ut("a",ee),ut("A",ee),ut("H",Z),ut("h",Z),ut("k",Z),ut("HH",Z,X),ut("hh",Z,X),ut("kk",Z,X),ut("hmm",Q),ut("hmmss",J),ut("Hmm",Q),ut("Hmmss",J),dt(["H","HH"],bt),dt(["k","kk"],function(t,e,n){var r=O(t);e[bt]=24===r?0:r}),dt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t}),dt(["h","hh"],function(t,e,n){e[bt]=O(t),d(n).bigHour=!0}),dt("hmm",function(t,e,n){var r=t.length-2;e[bt]=O(t.substr(0,r)),e[wt]=O(t.substr(r)),d(n).bigHour=!0}),dt("hmmss",function(t,e,n){var r=t.length-4,o=t.length-2;e[bt]=O(t.substr(0,r)),e[wt]=O(t.substr(r,2)),e[Ct]=O(t.substr(o)),d(n).bigHour=!0}),dt("Hmm",function(t,e,n){var r=t.length-2;e[bt]=O(t.substr(0,r)),e[wt]=O(t.substr(r))}),dt("Hmmss",function(t,e,n){var r=t.length-4,o=t.length-2;e[bt]=O(t.substr(0,r)),e[wt]=O(t.substr(r,2)),e[Ct]=O(t.substr(o))});var ne,re=_t("Hours",!0),oe={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:It,monthsShort:Dt,week:{dow:0,doy:6},weekdays:Gt,weekdaysMin:qt,weekdaysShort:Xt,meridiemParse:/[ap]\.?m?\.?/i},ie={},ae={};function se(t){return t?t.toLowerCase().replace("_","-"):t}function le(e){var n=null;if(!ie[e]&&void 0!==t&&t&&t.exports)try{n=ne._abbr,!function(){var t=new Error("Cannot find module 'undefined'");throw t.code="MODULE_NOT_FOUND",t}(),ue(n)}catch(t){}return ie[e]}function ue(t,e){var n;return t&&(n=a(e)?fe(t):ce(t,e))&&(ne=n),ne._abbr}function ce(t,e){if(null!==e){var n=oe;if(e.abbr=t,null!=ie[t])M("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ie[t]._config;else if(null!=e.parentLocale){if(null==ie[e.parentLocale])return ae[e.parentLocale]||(ae[e.parentLocale]=[]),ae[e.parentLocale].push({name:t,config:e}),null;n=ie[e.parentLocale]._config}return ie[t]=new A(N(n,e)),ae[t]&&ae[t].forEach(function(t){ce(t.name,t.config)}),ue(t),ie[t]}return delete ie[t],null}function fe(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return ne;if(!o(t)){if(e=le(t))return e;t=[t]}return function(t){for(var e,n,r,o,i=0;i<t.length;){for(o=se(t[i]).split("-"),e=o.length,n=(n=se(t[i+1]))?n.split("-"):null;e>0;){if(r=le(o.slice(0,e).join("-")))return r;if(n&&n.length>=e&&E(o,n,!0)>=e-1)break;e--}i++}return null}(t)}function he(t){var e,n=t._a;return n&&-2===d(t).overflow&&(e=n[yt]<0||n[yt]>11?yt:n[mt]<1||n[mt]>xt(n[vt],n[yt])?mt:n[bt]<0||n[bt]>24||24===n[bt]&&(0!==n[wt]||0!==n[Ct]||0!==n[Ot])?bt:n[wt]<0||n[wt]>59?wt:n[Ct]<0||n[Ct]>59?Ct:n[Ot]<0||n[Ot]>999?Ot:-1,d(t)._overflowDayOfYear&&(e<vt||e>mt)&&(e=mt),d(t)._overflowWeeks&&-1===e&&(e=Et),d(t)._overflowWeekday&&-1===e&&(e=St),d(t).overflow=e),t}function de(t,e,n){return null!=t?t:null!=e?e:n}function pe(t){var e,n,o,i,a,s=[];if(!t._d){for(o=function(t){var e=new Date(r.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}(t),t._w&&null==t._a[mt]&&null==t._a[yt]&&function(t){var e,n,r,o,i,a,s,l;if(null!=(e=t._w).GG||null!=e.W||null!=e.E)i=1,a=4,n=de(e.GG,t._a[vt],Yt(_e(),1,4).year),r=de(e.W,1),((o=de(e.E,1))<1||o>7)&&(l=!0);else{i=t._locale._week.dow,a=t._locale._week.doy;var u=Yt(_e(),i,a);n=de(e.gg,t._a[vt],u.year),r=de(e.w,u.week),null!=e.d?((o=e.d)<0||o>6)&&(l=!0):null!=e.e?(o=e.e+i,(e.e<0||e.e>6)&&(l=!0)):o=i}r<1||r>zt(n,i,a)?d(t)._overflowWeeks=!0:null!=l?d(t)._overflowWeekday=!0:(s=Ut(n,r,o,i,a),t._a[vt]=s.year,t._dayOfYear=s.dayOfYear)}(t),null!=t._dayOfYear&&(a=de(t._a[vt],o[vt]),(t._dayOfYear>kt(a)||0===t._dayOfYear)&&(d(t)._overflowDayOfYear=!0),n=Wt(a,0,t._dayOfYear),t._a[yt]=n.getUTCMonth(),t._a[mt]=n.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=s[e]=o[e];for(;e<7;e++)t._a[e]=s[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[bt]&&0===t._a[wt]&&0===t._a[Ct]&&0===t._a[Ot]&&(t._nextDay=!0,t._a[bt]=0),t._d=(t._useUTC?Wt:function(t,e,n,r,o,i,a){var s=new Date(t,e,n,r,o,i,a);return t<100&&t>=0&&isFinite(s.getFullYear())&&s.setFullYear(t),s}).apply(null,s),i=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[bt]=24),t._w&&void 0!==t._w.d&&t._w.d!==i&&(d(t).weekdayMismatch=!0)}}var ge=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ve=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ye=/Z|[+-]\d\d(?::?\d\d)?/,me=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],be=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],we=/^\/?Date\((\-?\d+)/i;function Ce(t){var e,n,r,o,i,a,s=t._i,l=ge.exec(s)||ve.exec(s);if(l){for(d(t).iso=!0,e=0,n=me.length;e<n;e++)if(me[e][1].exec(l[1])){o=me[e][0],r=!1!==me[e][2];break}if(null==o)return void(t._isValid=!1);if(l[3]){for(e=0,n=be.length;e<n;e++)if(be[e][1].exec(l[3])){i=(l[2]||" ")+be[e][0];break}if(null==i)return void(t._isValid=!1)}if(!r&&null!=i)return void(t._isValid=!1);if(l[4]){if(!ye.exec(l[4]))return void(t._isValid=!1);a="Z"}t._f=o+(i||"")+(a||""),Re(t)}else t._isValid=!1}var Oe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Ee(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}var Se={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function ke(t){var e,n,r,o,i,a,s,l=Oe.exec(t._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim());if(l){var u=(e=l[4],n=l[3],r=l[2],o=l[5],i=l[6],a=l[7],s=[Ee(e),Dt.indexOf(n),parseInt(r,10),parseInt(o,10),parseInt(i,10)],a&&s.push(parseInt(a,10)),s);if(!function(t,e,n){if(t){var r=Xt.indexOf(t),o=new Date(e[0],e[1],e[2]).getDay();if(r!==o)return d(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}(l[1],u,t))return;t._a=u,t._tzm=function(t,e,n){if(t)return Se[t];if(e)return 0;var r=parseInt(n,10),o=r%100,i=(r-o)/100;return 60*i+o}(l[8],l[9],l[10]),t._d=Wt.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),d(t).rfc2822=!0}else t._isValid=!1}function Re(t){if(t._f!==r.ISO_8601)if(t._f!==r.RFC_2822){t._a=[],d(t).empty=!0;var e,n,o,i,a,s=""+t._i,l=s.length,u=0;for(o=z(t._f,t._locale).match(F)||[],e=0;e<o.length;e++)i=o[e],(n=(s.match(ct(i,t))||[])[0])&&((a=s.substr(0,s.indexOf(n))).length>0&&d(t).unusedInput.push(a),s=s.slice(s.indexOf(n)+n.length),u+=n.length),V[i]?(n?d(t).empty=!1:d(t).unusedTokens.push(i),gt(i,n,t)):t._strict&&!n&&d(t).unusedTokens.push(i);d(t).charsLeftOver=l-u,s.length>0&&d(t).unusedInput.push(s),t._a[bt]<=12&&!0===d(t).bigHour&&t._a[bt]>0&&(d(t).bigHour=void 0),d(t).parsedDateParts=t._a.slice(0),d(t).meridiem=t._meridiem,t._a[bt]=(c=t._locale,f=t._a[bt],null==(h=t._meridiem)?f:null!=c.meridiemHour?c.meridiemHour(f,h):null!=c.isPM?((p=c.isPM(h))&&f<12&&(f+=12),p||12!==f||(f=0),f):f),pe(t),he(t)}else ke(t);else Ce(t);var c,f,h,p}function Te(t){var e=t._i,n=t._f;return t._locale=t._locale||fe(t._l),null===e||void 0===n&&""===e?g({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),w(e)?new b(he(e)):(l(e)?t._d=e:o(n)?function(t){var e,n,r,o,i;if(0===t._f.length)return d(t).invalidFormat=!0,void(t._d=new Date(NaN));for(o=0;o<t._f.length;o++)i=0,e=y({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[o],Re(e),p(e)&&(i+=d(e).charsLeftOver,i+=10*d(e).unusedTokens.length,d(e).score=i,(null==r||i<r)&&(r=i,n=e));f(t,n||e)}(t):n?Re(t):function(t){var e=t._i;a(e)?t._d=new Date(r.now()):l(e)?t._d=new Date(e.valueOf()):"string"==typeof e?function(t){var e=we.exec(t._i);null===e?(Ce(t),!1===t._isValid&&(delete t._isValid,ke(t),!1===t._isValid&&(delete t._isValid,r.createFromInputFallback(t)))):t._d=new Date(+e[1])}(t):o(e)?(t._a=u(e.slice(0),function(t){return parseInt(t,10)}),pe(t)):i(e)?function(t){if(!t._d){var e=D(t._i);t._a=u([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],function(t){return t&&parseInt(t,10)}),pe(t)}}(t):s(e)?t._d=new Date(e):r.createFromInputFallback(t)}(t),p(t)||(t._d=null),t))}function Me(t,e,n,r,a){var s,l={};return!0!==n&&!1!==n||(r=n,n=void 0),(i(t)&&function(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(t.hasOwnProperty(e))return!1;return!0}(t)||o(t)&&0===t.length)&&(t=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=a,l._l=n,l._i=t,l._f=e,l._strict=r,(s=new b(he(Te(l))))._nextDay&&(s.add(1,"d"),s._nextDay=void 0),s}function _e(t,e,n,r){return Me(t,e,n,r,!1)}r.createFromInputFallback=k("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),r.ISO_8601=function(){},r.RFC_2822=function(){};var Ne=k("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=_e.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:g()}),Ae=k("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=_e.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:g()});function xe(t,e){var n,r;if(1===e.length&&o(e[0])&&(e=e[0]),!e.length)return _e();for(n=e[0],r=1;r<e.length;++r)e[r].isValid()&&!e[r][t](n)||(n=e[r]);return n}var je=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ie(t){var e=D(t),n=e.year||0,r=e.quarter||0,o=e.month||0,i=e.week||0,a=e.day||0,s=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=function(t){for(var e in t)if(-1===Tt.call(je,e)||null!=t[e]&&isNaN(t[e]))return!1;for(var n=!1,r=0;r<je.length;++r)if(t[je[r]]){if(n)return!1;parseFloat(t[je[r]])!==O(t[je[r]])&&(n=!0)}return!0}(e),this._milliseconds=+c+1e3*u+6e4*l+1e3*s*60*60,this._days=+a+7*i,this._months=+o+3*r+12*n,this._data={},this._locale=fe(),this._bubble()}function De(t){return t instanceof Ie}function Pe(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function Le(t,e){U(t,0,0,function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+H(~~(t/60),2)+e+H(~~t%60,2)})}Le("Z",":"),Le("ZZ",""),ut("Z",at),ut("ZZ",at),dt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Fe(at,t)});var He=/([\+\-]|\d\d)/gi;function Fe(t,e){var n=(e||"").match(t);if(null===n)return null;var r=n[n.length-1]||[],o=(r+"").match(He)||["-",0,0],i=60*o[1]+O(o[2]);return 0===i?0:"+"===o[0]?i:-i}function Be(t,e){var n,o;return e._isUTC?(n=e.clone(),o=(w(t)||l(t)?t.valueOf():_e(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+o),r.updateOffset(n,!1),n):_e(t).local()}function We(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function Ve(){return!!this.isValid()&&this._isUTC&&0===this._offset}r.updateOffset=function(){};var Ue=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Ye=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ze(t,e){var n,r,o,i,a,l,u=t,f=null;return De(t)?u={ms:t._milliseconds,d:t._days,M:t._months}:s(t)?(u={},e?u[e]=t:u.milliseconds=t):(f=Ue.exec(t))?(n="-"===f[1]?-1:1,u={y:0,d:O(f[mt])*n,h:O(f[bt])*n,m:O(f[wt])*n,s:O(f[Ct])*n,ms:O(Pe(1e3*f[Ot]))*n}):(f=Ye.exec(t))?(n="-"===f[1]?-1:(f[1],1),u={y:Ge(f[2],n),M:Ge(f[3],n),w:Ge(f[4],n),d:Ge(f[5],n),h:Ge(f[6],n),m:Ge(f[7],n),s:Ge(f[8],n)}):null==u?u={}:"object"==typeof u&&("from"in u||"to"in u)&&(i=_e(u.from),a=_e(u.to),o=i.isValid()&&a.isValid()?(a=Be(a,i),i.isBefore(a)?l=Xe(i,a):((l=Xe(a,i)).milliseconds=-l.milliseconds,l.months=-l.months),l):{milliseconds:0,months:0},(u={}).ms=o.milliseconds,u.M=o.months),r=new Ie(u),De(t)&&c(t,"_locale")&&(r._locale=t._locale),r}function Ge(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Xe(t,e){var n={milliseconds:0,months:0};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function qe(t,e){return function(n,r){var o;return null===r||isNaN(+r)||(M(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),Ke(this,ze(n="string"==typeof n?+n:n,r),t),this}}function Ke(t,e,n,o){var i=e._milliseconds,a=Pe(e._days),s=Pe(e._months);t.isValid()&&(o=null==o||o,s&&Pt(t,Nt(t,"Month")+s*n),a&&At(t,"Date",Nt(t,"Date")+a*n),i&&t._d.setTime(t._d.valueOf()+i*n),o&&r.updateOffset(t,a||s))}ze.fn=Ie.prototype,ze.invalid=function(){return ze(NaN)};var $e=qe(1,"add"),Ze=qe(-1,"subtract");function Qe(t,e){var n,r,o=12*(e.year()-t.year())+(e.month()-t.month()),i=t.clone().add(o,"months");return e-i<0?(n=t.clone().add(o-1,"months"),r=(e-i)/(i-n)):(n=t.clone().add(o+1,"months"),r=(e-i)/(n-i)),-(o+r)||0}function Je(t){var e;return void 0===t?this._locale._abbr:(null!=(e=fe(t))&&(this._locale=e),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var tn=k("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)});function en(){return this._locale}function nn(t,e){U(0,[t,t.length],0,e)}function rn(t,e,n,r,o){var i;return null==t?Yt(this,r,o).year:(i=zt(t,r,o),e>i&&(e=i),function(t,e,n,r,o){var i=Ut(t,e,n,r,o),a=Wt(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}.call(this,t,e,n,r,o))}U(0,["gg",2],0,function(){return this.weekYear()%100}),U(0,["GG",2],0,function(){return this.isoWeekYear()%100}),nn("gggg","weekYear"),nn("ggggg","weekYear"),nn("GGGG","isoWeekYear"),nn("GGGGG","isoWeekYear"),j("weekYear","gg"),j("isoWeekYear","GG"),L("weekYear",1),L("isoWeekYear",1),ut("G",ot),ut("g",ot),ut("GG",Z,X),ut("gg",Z,X),ut("GGGG",et,K),ut("gggg",et,K),ut("GGGGG",nt,$),ut("ggggg",nt,$),pt(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=O(t)}),pt(["gg","GG"],function(t,e,n,o){e[o]=r.parseTwoDigitYear(t)}),U("Q",0,"Qo","quarter"),j("quarter","Q"),L("quarter",7),ut("Q",G),dt("Q",function(t,e){e[yt]=3*(O(t)-1)}),U("D",["DD",2],"Do","date"),j("date","D"),L("date",9),ut("D",Z),ut("DD",Z,X),ut("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),dt(["D","DD"],mt),dt("Do",function(t,e){e[mt]=O(t.match(Z)[0])});var on=_t("Date",!0);U("DDD",["DDDD",3],"DDDo","dayOfYear"),j("dayOfYear","DDD"),L("dayOfYear",4),ut("DDD",tt),ut("DDDD",q),dt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=O(t)}),U("m",["mm",2],0,"minute"),j("minute","m"),L("minute",14),ut("m",Z),ut("mm",Z,X),dt(["m","mm"],wt);var an=_t("Minutes",!1);U("s",["ss",2],0,"second"),j("second","s"),L("second",15),ut("s",Z),ut("ss",Z,X),dt(["s","ss"],Ct);var sn,ln=_t("Seconds",!1);for(U("S",0,0,function(){return~~(this.millisecond()/100)}),U(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),U(0,["SSS",3],0,"millisecond"),U(0,["SSSS",4],0,function(){return 10*this.millisecond()}),U(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),U(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),U(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),U(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),U(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),j("millisecond","ms"),L("millisecond",16),ut("S",tt,G),ut("SS",tt,X),ut("SSS",tt,q),sn="SSSS";sn.length<=9;sn+="S")ut(sn,rt);function un(t,e){e[Ot]=O(1e3*("0."+t))}for(sn="S";sn.length<=9;sn+="S")dt(sn,un);var cn=_t("Milliseconds",!1);U("z",0,0,"zoneAbbr"),U("zz",0,0,"zoneName");var fn=b.prototype;function hn(t){return t}fn.add=$e,fn.calendar=function(t,e){var n=t||_e(),o=Be(n,this).startOf("day"),i=r.calendarFormat(this,o)||"sameElse",a=e&&(_(e[i])?e[i].call(this,n):e[i]);return this.format(a||this.localeData().calendar(i,this,_e(n)))},fn.clone=function(){return new b(this)},fn.diff=function(t,e,n){var r,o,i;if(!this.isValid())return NaN;if(!(r=Be(t,this)).isValid())return NaN;switch(o=6e4*(r.utcOffset()-this.utcOffset()),e=I(e)){case"year":i=Qe(this,r)/12;break;case"month":i=Qe(this,r);break;case"quarter":i=Qe(this,r)/3;break;case"second":i=(this-r)/1e3;break;case"minute":i=(this-r)/6e4;break;case"hour":i=(this-r)/36e5;break;case"day":i=(this-r-o)/864e5;break;case"week":i=(this-r-o)/6048e5;break;default:i=this-r}return n?i:C(i)},fn.endOf=function(t){return void 0===(t=I(t))||"millisecond"===t?this:("date"===t&&(t="day"),this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms"))},fn.format=function(t){t||(t=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var e=Y(this,t);return this.localeData().postformat(e)},fn.from=function(t,e){return this.isValid()&&(w(t)&&t.isValid()||_e(t).isValid())?ze({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},fn.fromNow=function(t){return this.from(_e(),t)},fn.to=function(t,e){return this.isValid()&&(w(t)&&t.isValid()||_e(t).isValid())?ze({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},fn.toNow=function(t){return this.to(_e(),t)},fn.get=function(t){return _(this[t=I(t)])?this[t]():this},fn.invalidAt=function(){return d(this).overflow},fn.isAfter=function(t,e){var n=w(t)?t:_e(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=I(a(e)?"millisecond":e))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf())},fn.isBefore=function(t,e){var n=w(t)?t:_e(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=I(a(e)?"millisecond":e))?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf())},fn.isBetween=function(t,e,n,r){return("("===(r=r||"()")[0]?this.isAfter(t,n):!this.isBefore(t,n))&&(")"===r[1]?this.isBefore(e,n):!this.isAfter(e,n))},fn.isSame=function(t,e){var n,r=w(t)?t:_e(t);return!(!this.isValid()||!r.isValid())&&("millisecond"===(e=I(e||"millisecond"))?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf()))},fn.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},fn.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},fn.isValid=function(){return p(this)},fn.lang=tn,fn.locale=Je,fn.localeData=en,fn.max=Ae,fn.min=Ne,fn.parsingFlags=function(){return f({},d(this))},fn.set=function(t,e){if("object"==typeof t)for(var n=function(t){var e=[];for(var n in t)e.push({unit:n,priority:P[n]});return e.sort(function(t,e){return t.priority-e.priority}),e}(t=D(t)),r=0;r<n.length;r++)this[n[r].unit](t[n[r].unit]);else if(_(this[t=I(t)]))return this[t](e);return this},fn.startOf=function(t){switch(t=I(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t&&this.weekday(0),"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this},fn.subtract=Ze,fn.toArray=function(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]},fn.toObject=function(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}},fn.toDate=function(){return new Date(this.valueOf())},fn.toISOString=function(t){if(!this.isValid())return null;var e=!0!==t,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Y(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):_(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this._d.valueOf()).toISOString().replace("Z",Y(n,"Z")):Y(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},fn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o=e+'[")]';return this.format(n+r+"-MM-DD[T]HH:mm:ss.SSS"+o)},fn.toJSON=function(){return this.isValid()?this.toISOString():null},fn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},fn.unix=function(){return Math.floor(this.valueOf()/1e3)},fn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},fn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},fn.year=Mt,fn.isLeapYear=function(){return Rt(this.year())},fn.weekYear=function(t){return rn.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},fn.isoWeekYear=function(t){return rn.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},fn.quarter=fn.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},fn.month=Lt,fn.daysInMonth=function(){return xt(this.year(),this.month())},fn.week=fn.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},fn.isoWeek=fn.isoWeeks=function(t){var e=Yt(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},fn.weeksInYear=function(){var t=this.localeData()._week;return zt(this.year(),t.dow,t.doy)},fn.isoWeeksInYear=function(){return zt(this.year(),1,4)},fn.date=on,fn.day=fn.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=function(t,e){return"string"!=typeof t?t:isNaN(t)?"number"==typeof(t=e.weekdaysParse(t))?t:null:parseInt(t,10)}(t,this.localeData()),this.add(t-e,"d")):e},fn.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},fn.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=function(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7},fn.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},fn.hour=fn.hours=re,fn.minute=fn.minutes=an,fn.second=fn.seconds=ln,fn.millisecond=fn.milliseconds=cn,fn.utcOffset=function(t,e,n){var o,i=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"==typeof t){if(null===(t=Fe(at,t)))return this}else Math.abs(t)<16&&!n&&(t*=60);return!this._isUTC&&e&&(o=We(this)),this._offset=t,this._isUTC=!0,null!=o&&this.add(o,"m"),i!==t&&(!e||this._changeInProgress?Ke(this,ze(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:We(this)},fn.utc=function(t){return this.utcOffset(0,t)},fn.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(We(this),"m")),this},fn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=Fe(it,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},fn.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?_e(t).utcOffset():0,(this.utcOffset()-t)%60==0)},fn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},fn.isLocal=function(){return!!this.isValid()&&!this._isUTC},fn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},fn.isUtc=Ve,fn.isUTC=Ve,fn.zoneAbbr=function(){return this._isUTC?"UTC":""},fn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},fn.dates=k("dates accessor is deprecated. Use date instead.",on),fn.months=k("months accessor is deprecated. Use month instead",Lt),fn.years=k("years accessor is deprecated. Use year instead",Mt),fn.zone=k("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}),fn.isDSTShifted=k("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!a(this._isDSTShifted))return this._isDSTShifted;var t={};if(y(t,this),(t=Te(t))._a){var e=t._isUTC?h(t._a):_e(t._a);this._isDSTShifted=this.isValid()&&E(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted});var dn=A.prototype;function pn(t,e,n,r){var o=fe(),i=h().set(r,e);return o[n](i,t)}function gn(t,e,n){if(s(t)&&(e=t,t=void 0),t=t||"",null!=e)return pn(t,e,n,"month");var r,o=[];for(r=0;r<12;r++)o[r]=pn(t,r,n,"month");return o}function vn(t,e,n,r){"boolean"==typeof t?(s(e)&&(n=e,e=void 0),e=e||""):(n=e=t,t=!1,s(e)&&(n=e,e=void 0),e=e||"");var o,i=fe(),a=t?i._week.dow:0;if(null!=n)return pn(e,(n+a)%7,r,"day");var l=[];for(o=0;o<7;o++)l[o]=pn(e,(o+a)%7,r,"day");return l}dn.calendar=function(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return _(r)?r.call(e,n):r},dn.longDateFormat=function(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t])},dn.invalidDate=function(){return this._invalidDate},dn.ordinal=function(t){return this._ordinal.replace("%d",t)},dn.preparse=hn,dn.postformat=hn,dn.relativeTime=function(t,e,n,r){var o=this._relativeTime[n];return _(o)?o(t,e,n,r):o.replace(/%d/i,t)},dn.pastFuture=function(t,e){var n=this._relativeTime[t>0?"future":"past"];return _(n)?n(e):n.replace(/%s/i,e)},dn.set=function(t){var e,n;for(n in t)_(e=t[n])?this[n]=e:this["_"+n]=e;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},dn.months=function(t,e){return t?o(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||jt).test(e)?"format":"standalone"][t.month()]:o(this._months)?this._months:this._months.standalone},dn.monthsShort=function(t,e){return t?o(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[jt.test(e)?"format":"standalone"][t.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},dn.monthsParse=function(t,e,n){var r,o,i;if(this._monthsParseExact)return function(t,e,n){var r,o,i,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)i=h([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(i,"").toLocaleLowerCase();return n?"MMM"===e?-1!==(o=Tt.call(this._shortMonthsParse,a))?o:null:-1!==(o=Tt.call(this._longMonthsParse,a))?o:null:"MMM"===e?-1!==(o=Tt.call(this._shortMonthsParse,a))?o:-1!==(o=Tt.call(this._longMonthsParse,a))?o:null:-1!==(o=Tt.call(this._longMonthsParse,a))?o:-1!==(o=Tt.call(this._shortMonthsParse,a))?o:null}.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(o=h([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[r].test(t))return r;if(n&&"MMM"===e&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}},dn.monthsRegex=function(t){return this._monthsParseExact?(c(this,"_monthsRegex")||Bt.call(this),t?this._monthsStrictRegex:this._monthsRegex):(c(this,"_monthsRegex")||(this._monthsRegex=Ft),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},dn.monthsShortRegex=function(t){return this._monthsParseExact?(c(this,"_monthsRegex")||Bt.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(c(this,"_monthsShortRegex")||(this._monthsShortRegex=Ht),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},dn.week=function(t){return Yt(t,this._week.dow,this._week.doy).week},dn.firstDayOfYear=function(){return this._week.doy},dn.firstDayOfWeek=function(){return this._week.dow},dn.weekdays=function(t,e){return t?o(this._weekdays)?this._weekdays[t.day()]:this._weekdays[this._weekdays.isFormat.test(e)?"format":"standalone"][t.day()]:o(this._weekdays)?this._weekdays:this._weekdays.standalone},dn.weekdaysMin=function(t){return t?this._weekdaysMin[t.day()]:this._weekdaysMin},dn.weekdaysShort=function(t){return t?this._weekdaysShort[t.day()]:this._weekdaysShort},dn.weekdaysParse=function(t,e,n){var r,o,i;if(this._weekdaysParseExact)return function(t,e,n){var r,o,i,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)i=h([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(i,"").toLocaleLowerCase();return n?"dddd"===e?-1!==(o=Tt.call(this._weekdaysParse,a))?o:null:"ddd"===e?-1!==(o=Tt.call(this._shortWeekdaysParse,a))?o:null:-1!==(o=Tt.call(this._minWeekdaysParse,a))?o:null:"dddd"===e?-1!==(o=Tt.call(this._weekdaysParse,a))?o:-1!==(o=Tt.call(this._shortWeekdaysParse,a))?o:-1!==(o=Tt.call(this._minWeekdaysParse,a))?o:null:"ddd"===e?-1!==(o=Tt.call(this._shortWeekdaysParse,a))?o:-1!==(o=Tt.call(this._weekdaysParse,a))?o:-1!==(o=Tt.call(this._minWeekdaysParse,a))?o:null:-1!==(o=Tt.call(this._minWeekdaysParse,a))?o:-1!==(o=Tt.call(this._weekdaysParse,a))?o:-1!==(o=Tt.call(this._shortWeekdaysParse,a))?o:null}.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(o=h([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(o,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(o,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(o,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),n&&"dddd"===e&&this._fullWeekdaysParse[r].test(t))return r;if(n&&"ddd"===e&&this._shortWeekdaysParse[r].test(t))return r;if(n&&"dd"===e&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}},dn.weekdaysRegex=function(t){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||Qt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(c(this,"_weekdaysRegex")||(this._weekdaysRegex=Kt),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},dn.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||Qt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(c(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=$t),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},dn.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||Qt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(c(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Zt),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},dn.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},dn.meridiem=function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},ue("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=1===O(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+n}}),r.lang=k("moment.lang is deprecated. Use moment.locale instead.",ue),r.langData=k("moment.langData is deprecated. Use moment.localeData instead.",fe);var yn=Math.abs;function mn(t,e,n,r){var o=ze(e,n);return t._milliseconds+=r*o._milliseconds,t._days+=r*o._days,t._months+=r*o._months,t._bubble()}function bn(t){return t<0?Math.floor(t):Math.ceil(t)}function wn(t){return 4800*t/146097}function Cn(t){return 146097*t/4800}function On(t){return function(){return this.as(t)}}var En=On("ms"),Sn=On("s"),kn=On("m"),Rn=On("h"),Tn=On("d"),Mn=On("w"),_n=On("M"),Nn=On("y");function An(t){return function(){return this.isValid()?this._data[t]:NaN}}var xn=An("milliseconds"),jn=An("seconds"),In=An("minutes"),Dn=An("hours"),Pn=An("days"),Ln=An("months"),Hn=An("years"),Fn=Math.round,Bn={ss:44,s:45,m:45,h:22,d:26,M:11},Wn=Math.abs;function Vn(t){return(t>0)-(t<0)||+t}function Un(){if(!this.isValid())return this.localeData().invalidDate();var t,e,n=Wn(this._milliseconds)/1e3,r=Wn(this._days),o=Wn(this._months);t=C(n/60),e=C(t/60),n%=60,t%=60;var i=C(o/12),a=o%=12,s=r,l=e,u=t,c=n?n.toFixed(3).replace(/\.?0+$/,""):"",f=this.asSeconds();if(!f)return"P0D";var h=f<0?"-":"",d=Vn(this._months)!==Vn(f)?"-":"",p=Vn(this._days)!==Vn(f)?"-":"",g=Vn(this._milliseconds)!==Vn(f)?"-":"";return h+"P"+(i?d+i+"Y":"")+(a?d+a+"M":"")+(s?p+s+"D":"")+(l||u||c?"T":"")+(l?g+l+"H":"")+(u?g+u+"M":"")+(c?g+c+"S":"")}var Yn=Ie.prototype;return Yn.isValid=function(){return this._isValid},Yn.abs=function(){var t=this._data;return this._milliseconds=yn(this._milliseconds),this._days=yn(this._days),this._months=yn(this._months),t.milliseconds=yn(t.milliseconds),t.seconds=yn(t.seconds),t.minutes=yn(t.minutes),t.hours=yn(t.hours),t.months=yn(t.months),t.years=yn(t.years),this},Yn.add=function(t,e){return mn(this,t,e,1)},Yn.subtract=function(t,e){return mn(this,t,e,-1)},Yn.as=function(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if("month"===(t=I(t))||"year"===t)return e=this._days+r/864e5,n=this._months+wn(e),"month"===t?n:n/12;switch(e=this._days+Math.round(Cn(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return 24*e+r/36e5;case"minute":return 1440*e+r/6e4;case"second":return 86400*e+r/1e3;case"millisecond":return Math.floor(864e5*e)+r;default:throw new Error("Unknown unit "+t)}},Yn.asMilliseconds=En,Yn.asSeconds=Sn,Yn.asMinutes=kn,Yn.asHours=Rn,Yn.asDays=Tn,Yn.asWeeks=Mn,Yn.asMonths=_n,Yn.asYears=Nn,Yn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*O(this._months/12):NaN},Yn._bubble=function(){var t,e,n,r,o,i=this._milliseconds,a=this._days,s=this._months,l=this._data;return i>=0&&a>=0&&s>=0||i<=0&&a<=0&&s<=0||(i+=864e5*bn(Cn(s)+a),a=0,s=0),l.milliseconds=i%1e3,t=C(i/1e3),l.seconds=t%60,e=C(t/60),l.minutes=e%60,n=C(e/60),l.hours=n%24,a+=C(n/24),o=C(wn(a)),s+=o,a-=bn(Cn(o)),r=C(s/12),s%=12,l.days=a,l.months=s,l.years=r,this},Yn.clone=function(){return ze(this)},Yn.get=function(t){return t=I(t),this.isValid()?this[t+"s"]():NaN},Yn.milliseconds=xn,Yn.seconds=jn,Yn.minutes=In,Yn.hours=Dn,Yn.days=Pn,Yn.weeks=function(){return C(this.days()/7)},Yn.months=Ln,Yn.years=Hn,Yn.humanize=function(t){if(!this.isValid())return this.localeData().invalidDate();var e=this.localeData(),n=function(t,e,n){var r=ze(t).abs(),o=Fn(r.as("s")),i=Fn(r.as("m")),a=Fn(r.as("h")),s=Fn(r.as("d")),l=Fn(r.as("M")),u=Fn(r.as("y")),c=o<=Bn.ss&&["s",o]||o<Bn.s&&["ss",o]||i<=1&&["m"]||i<Bn.m&&["mm",i]||a<=1&&["h"]||a<Bn.h&&["hh",a]||s<=1&&["d"]||s<Bn.d&&["dd",s]||l<=1&&["M"]||l<Bn.M&&["MM",l]||u<=1&&["y"]||["yy",u];return c[2]=e,c[3]=+t>0,c[4]=n,function(t,e,n,r,o){return o.relativeTime(e||1,!!n,t,r)}.apply(null,c)}(this,!t,e);return t&&(n=e.pastFuture(+this,n)),e.postformat(n)},Yn.toISOString=Un,Yn.toString=Un,Yn.toJSON=Un,Yn.locale=Je,Yn.localeData=en,Yn.toIsoString=k("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Un),Yn.lang=tn,U("X",0,0,"unix"),U("x",0,0,"valueOf"),ut("x",ot),ut("X",/[+-]?\d+(\.\d{1,3})?/),dt("X",function(t,e,n){n._d=new Date(1e3*parseFloat(t,10))}),dt("x",function(t,e,n){n._d=new Date(O(t))}),r.version="2.20.1",e=_e,r.fn=fn,r.min=function(){return xe("isBefore",[].slice.call(arguments,0))},r.max=function(){return xe("isAfter",[].slice.call(arguments,0))},r.now=function(){return Date.now?Date.now():+new Date},r.utc=h,r.unix=function(t){return _e(1e3*t)},r.months=function(t,e){return gn(t,e,"months")},r.isDate=l,r.locale=ue,r.invalid=g,r.duration=ze,r.isMoment=w,r.weekdays=function(t,e,n){return vn(t,e,n,"weekdays")},r.parseZone=function(){return _e.apply(null,arguments).parseZone()},r.localeData=fe,r.isDuration=De,r.monthsShort=function(t,e){return gn(t,e,"monthsShort")},r.weekdaysMin=function(t,e,n){return vn(t,e,n,"weekdaysMin")},r.defineLocale=ce,r.updateLocale=function(t,e){if(null!=e){var n,r,o=oe;null!=(r=le(t))&&(o=r._config),e=N(o,e),(n=new A(e)).parentLocale=ie[t],ie[t]=n,ue(t)}else null!=ie[t]&&(null!=ie[t].parentLocale?ie[t]=ie[t].parentLocale:null!=ie[t]&&delete ie[t]);return ie[t]},r.locales=function(){return R(ie)},r.weekdaysShort=function(t,e,n){return vn(t,e,n,"weekdaysShort")},r.normalizeUnits=I,r.relativeTimeRounding=function(t){return void 0===t?Fn:"function"==typeof t&&(Fn=t,!0)},r.relativeTimeThreshold=function(t,e){return void 0!==Bn[t]&&(void 0===e?Bn[t]:(Bn[t]=e,"s"===t&&(Bn.ss=e-1),!0))},r.calendarFormat=function(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},r.prototype=fn,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},r}()}).call(this,n(208)(t))},function(t,e,n){"use strict";var r=n(53),o=n(37),i=n(147),a=n(58),s=/./.toString,l=o(function(){return"/a/b"!=s.call({source:"a",flags:"b"})}),u="toString"!=s.name;(l||u)&&n(71)(RegExp.prototype,"toString",function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!a&&t instanceof RegExp?i.call(t):void 0)},{unsafe:!0})},function(t,e,n){var r=n(41),o=n(90).f,i=n(67),a=n(71),s=n(137),l=n(162),u=n(115);t.exports=function(t,e){var n,c,f,h,d,p=t.target,g=t.global,v=t.stat;if(n=g?r:v?r[p]||s(p,{}):(r[p]||{}).prototype)for(c in e){if(h=e[c],f=t.noTargetGet?(d=o(n,c))&&d.value:n[c],!u(g?c:p+(v?".":"#")+c,t.forced)&&void 0!==f){if(typeof h==typeof f)continue;l(h,f)}(t.sham||f&&f.sham)&&i(h,"sham",!0),a(n,c,h,t)}}},function(t,e,n){"use strict";n.r(e),n.d(e,"isFunction",function(){return o}),n.d(e,"throttle",function(){return i}),n.d(e,"throttleAfterHits",function(){return a}),n.d(e,"debounce",function(){return s}),n.d(e,"pipe",function(){return l}),n.d(e,"partial",function(){return u}),n.d(e,"curry",function(){return c}),n.d(e,"curryRight",function(){return f});n(24),n(35),n(45);var r=n(1);function o(t){return"function"==typeof t}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,r={lastCallThrottled:!0},o=null;return function(){for(var i=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];var u=Date.now(),c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);var f=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,s)):(o&&clearTimeout(o),o=setTimeout(function(){r.lastCallThrottled=!1,t.apply(i,s),n=0,o=void 0},f)),r}}function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=i(t,e),o=n;function a(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return o?(o-=1,t.apply(this,n)):r.apply(this,n)}return a.clearHits=function(){o=n},a}function s(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var o=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(function(){e=t.apply(o,a)},n),e}}function l(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=e[0],i=e.slice(1);return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Object(r.arrayReduce)(i,function(t,e){return e(t)},o.apply(this,e))}}function u(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(this,n.concat(r))}}function c(t){var e=t.length;return function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r.concat(i);return s.length>=e?t.apply(this,s):n(s)}}([])}function f(t){var e=t.length;return function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r.concat(i.reverse());return s.length>=e?t.apply(this,s):n(s)}}([])}},function(t,e,n){var r=!n(173)(function(t){Array.from(t)});n(27)({target:"Array",stat:!0,forced:r},{from:n(201)})},function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return i});var r=n(13);function o(){var t;Object(r.isDefined)(console)&&(t=console).warn.apply(t,arguments)}function i(){var t;Object(r.isDefined)(console)&&(t=console).error.apply(t,arguments)}},function(t,e,n){"use strict";var r,o=n(41),i=n(141),a=n(103),s=n(169),l=n(49),u=n(86).enforce,c=n(161),f=!o.ActiveXObject&&"ActiveXObject"in o,h=Object.isExtensible,d=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},p=t.exports=n(120)("WeakMap",d,s,!0,!0);if(c&&f){r=s.getConstructor(d,"WeakMap",!0),a.REQUIRED=!0;var g=p.prototype,v=g.delete,y=g.has,m=g.get,b=g.set;i(g,{delete:function(t){if(l(t)&&!h(t)){var e=u(this);return e.frozen||(e.frozen=new r),v.call(this,t)||e.frozen.delete(t)}return v.call(this,t)},has:function(t){if(l(t)&&!h(t)){var e=u(this);return e.frozen||(e.frozen=new r),y.call(this,t)||e.frozen.has(t)}return y.call(this,t)},get:function(t){if(l(t)&&!h(t)){var e=u(this);return e.frozen||(e.frozen=new r),y.call(this,t)?m.call(this,t):e.frozen.get(t)}return m.call(this,t)},set:function(t,e){if(l(t)&&!h(t)){var n=u(this);n.frozen||(n.frozen=new r),y.call(this,t)?b.call(this,t,e):n.frozen.set(t,e)}else b.call(this,t,e);return this}})}},function(t,e,n){"use strict";n(7),n(6),n(8),n(31),n(9);var r=n(54),o=n(16),i=n(60),a=(n(10),n(11),n(12),n(56),n(153),n(21),n(76),n(22),n(18),n(19),n(23),n(52),n(17)),s=n(13),l=n(36),u=n(1),c=n(0),f=n(2),h=n(14),d=(n(24),n(44),n(35),n(188)),p=n.n(d),g=n(40),v=n(20);function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t,e,n){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=C(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var E=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,o=C(e).call(this,t),(n=!o||"object"!==y(o)&&"function"!=typeof o?b(r):o).eventManager=new v.a(b(n)),n.autoResize=p()(),n.holderZIndex=-1,n.TEXTAREA=void 0,n.textareaStyle=void 0,n.TEXTAREA_PARENT=void 0,n.textareaParentStyle=void 0,n.createElements(),n.bindEvents(),n.hot.addHookOnce("afterDestroy",function(){return n.destroy()}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(e,i["b"]),n=e,(r=[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(t){this.TEXTAREA.value=t}},{key:"open",value:function(){var t=this;this.refreshDimensions(),this.showEditableElement(),this.addHook("beforeKeyDown",function(e){return t.onBeforeKeyDown(e)})}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.removeHooksByKey("beforeKeyDown")}},{key:"prepare",value:function(t,n,r,o,a,s){var l=this,u=this.state;if(w(C(e.prototype),"prepare",this).call(this,t,n,r,o,a,s),!s.readOnly){this.refreshDimensions(!0);var c=s.allowInvalid,f=s.fragmentSelection;c&&(this.TEXTAREA.value=""),u!==i.a.FINISHED&&this.hideEditableElement(),!f&&!Object(g.isMobileBrowser)()&&this.hot._registerImmediate(function(){return l.focus(!0)})}}},{key:"beginEditing",value:function(t,n){this.state===i.a.VIRGIN&&(this.TEXTAREA.value="",w(C(e.prototype),"beginEditing",this).call(this,t,n))}},{key:"focus",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?Object(c.selectElementIfAllowed)(this.TEXTAREA):(this.TEXTAREA.select(),Object(c.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length))}},{key:"createElements",value:function(){var t=this.hot.rootDocument;this.TEXTAREA=t.createElement("TEXTAREA"),this.TEXTAREA.tabIndex=-1,Object(c.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),Object(c.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.zIndex="-1",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"getEditedCell",value:function(){var t;switch(this.checkEditorSection()){case"top":t=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=101;break;case"top-left-corner":t=this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=103;break;case"bottom-left-corner":t=this.hot.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=103;break;case"left":t=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=102;break;case"bottom":t=this.hot.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.holderZIndex=102;break;default:t=this.hot.getCell(this.row,this.col),this.holderZIndex=-1}return t<0?void 0:t}},{key:"hideEditableElement",value:function(){(Object(g.isIE)()||Object(g.isEdge)())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",this.textareaParentStyle.zIndex="-1"}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle.right="auto",this.textareaParentStyle.zIndex=this.holderZIndex>=0?this.holderZIndex:"",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="auto"}},{key:"refreshValue",value:function(){var t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===i.a.EDITING||t)if(this.TD=this.getEditedCell(),this.TD){var e,n=this.hot.view.wt,r=n.wtOverlays,o=n.wtViewport,a=Object(c.offset)(this.TD),s=Object(c.offset)(this.hot.rootElement),l=r.topOverlay.holder,u=r.leftOverlay.holder,f=this.hot.countRows(),h=l!==this.hot.rootWindow?l.scrollTop:0,d=u!==this.hot.rootWindow?u.scrollLeft:0,p=this.checkEditorSection(),g=["","left"].includes(p)?h:0,v=["","top","bottom"].includes(p)?d:0,y=a.top===s.top?0:1,m=this.hot.getSettings(),b=this.hot.hasColHeaders(),w=this.TD.style.backgroundColor,C=a.top-s.top-y-g,O=a.left-s.left-1-v;switch(p){case"top":e=Object(c.getCssTransform)(r.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=Object(c.getCssTransform)(r.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=Object(c.getCssTransform)(r.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=Object(c.getCssTransform)(r.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=Object(c.getCssTransform)(r.bottomOverlay.clone.wtTable.holder.parentNode)}(b&&0===this.hot.getSelectedLast()[0]||m.fixedRowsBottom&&this.hot.getSelectedLast()[0]===f-m.fixedRowsBottom)&&(C+=1),0===this.hot.getSelectedLast()[1]&&(O+=1),e&&-1!==e?this.textareaParentStyle[e[0]]=e[1]:Object(c.resetCssTransform)(this.TEXTAREA_PARENT),this.textareaParentStyle.top="".concat(C,"px"),this.textareaParentStyle.left="".concat(O,"px"),this.showEditableElement();var E=o.rowsRenderCalculator.startPosition,S=o.columnsRenderCalculator.startPosition,k=r.leftOverlay.getScrollPosition(),R=r.topOverlay.getScrollPosition(),T=Object(c.getScrollbarWidth)(this.hot.rootDocument),M=this.TD.offsetTop+E-R,_=this.TD.offsetLeft+S-k,N=Object(c.innerWidth)(this.TD)-8,A=Object(c.hasVerticalScrollbar)(l)?T:0,x=Object(c.hasHorizontalScrollbar)(u)?T:0,j=this.hot.view.maximumVisibleElementWidth(_)-9-A,I=this.TD.scrollHeight+1,D=Math.max(this.hot.view.maximumVisibleElementHeight(M)-x,23),P=Object(c.getComputedStyle)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=P.fontSize,this.TEXTAREA.style.fontFamily=P.fontFamily,this.TEXTAREA.style.backgroundColor=w,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(I,D),maxHeight:D,minWidth:Math.min(N,j),maxWidth:j},!0)}else t||this.close()}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(t){return Object(h.stopPropagation)(t)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(t){return Object(h.stopPropagation)(t)}),this.addHook("afterScrollHorizontally",function(){return t.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return t.refreshDimensions()}),this.addHook("afterColumnResize",function(){t.refreshDimensions(),t.focus()}),this.addHook("afterRowResize",function(){t.refreshDimensions(),t.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"onBeforeKeyDown",value:function(t){var e=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.target===this.TEXTAREA&&!Object(h.isImmediatePropagationStopped)(t)){switch(t.keyCode){case a.KEY_CODES.ARROW_RIGHT:case a.KEY_CODES.ARROW_LEFT:this.isInFullEditMode()&&(this.isWaiting()||this.allowKeyEventPropagation(t.keyCode)||Object(h.stopImmediatePropagation)(t));break;case a.KEY_CODES.ARROW_UP:case a.KEY_CODES.ARROW_DOWN:this.isInFullEditMode()&&(this.isWaiting()||this.allowKeyEventPropagation(t.keyCode)||Object(h.stopImmediatePropagation)(t));break;case a.KEY_CODES.ENTER:var n=this.hot.selection.isMultiple();if(e&&!n||t.altKey){if(this.isOpened()){var r=Object(c.getCaretPosition)(this.TEXTAREA),o=this.getValue(),i="".concat(o.slice(0,r),"\n").concat(o.slice(r));this.setValue(i),Object(c.setCaretPosition)(this.TEXTAREA,r+1)}else this.beginEditing("".concat(this.originalValue,"\n"));Object(h.stopImmediatePropagation)(t)}t.preventDefault();break;case a.KEY_CODES.BACKSPACE:case a.KEY_CODES.DELETE:case a.KEY_CODES.HOME:case a.KEY_CODES.END:Object(h.stopImmediatePropagation)(t)}-1===[a.KEY_CODES.ARROW_UP,a.KEY_CODES.ARROW_RIGHT,a.KEY_CODES.ARROW_DOWN,a.KEY_CODES.ARROW_LEFT].indexOf(t.keyCode)&&this.autoResize.resize(String.fromCharCode(t.keyCode))}}}])&&m(n.prototype,r),o&&m(n,o),e}();function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function R(t,e){return!e||"object"!==S(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function T(t,e,n){return(T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var N=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),R(this,M(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(e,E),n=e,(r=[{key:"open",value:function(){T(M(e.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Object(c.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length)}},{key:"close",value:function(){this.htEditor.rootElement.style.display="none",this.removeHooksByKey("beforeKeyDown"),T(M(e.prototype),"close",this).call(this)}},{key:"prepare",value:function(t,n,r,o,i,a){T(M(e.prototype),"prepare",this).call(this,t,n,r,o,i,a);var s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(t,e){var n=this.getSourceData(e.row,e.col);void 0!==n&&s.setValue(n),s.instance.destroyEditor()}};this.cellProperties.handsontable&&Object(f.extend)(l,a.handsontable),this.htOptions=l}},{key:"beginEditing",value:function(t,n){var r=this.hot.getSettings().onBeginEditing;r&&!1===r()||T(M(e.prototype),"beginEditing",this).call(this,t,n)}},{key:"focus",value:function(){T(M(e.prototype),"focus",this).call(this)}},{key:"createElements",value:function(){T(M(e.prototype),"createElements",this).call(this);var t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}},{key:"finishEditing",value:function(t,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var o=this.htEditor.getInstance().getValue();void 0!==o&&this.setValue(o)}return T(M(e.prototype),"finishEditing",this).call(this,t,n,r)}},{key:"assignHooks",value:function(){var t=this;this.hot.addHook("afterDestroy",function(){t.htEditor&&t.htEditor.destroy()})}},{key:"onBeforeKeyDown",value:function(t){if(!Object(h.isImmediatePropagationStopped)(t)){var n,r,o=this.htEditor.getInstance();if(t.keyCode===a.KEY_CODES.ARROW_DOWN)if(o.getSelectedLast()||o.flipped){if(o.getSelectedLast())if(o.flipped)n=o.getSelectedLast()[0]+1;else if(!o.flipped){var i=o.countRows()-1;r=o.getSelectedLast()[0],n=Math.min(i,r+1)}}else n=0;else t.keyCode===a.KEY_CODES.ARROW_UP&&(!o.getSelectedLast()&&o.flipped?n=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(r=o.getSelectedLast()[0],n=Math.max(0,r-1)):n=(r=o.getSelectedLast()[0])-1));void 0!==n&&(n<0||o.flipped&&n>o.countRows()-1?o.deselectCell():o.selectCell(n,0),o.getData().length&&(t.preventDefault(),Object(h.stopImmediatePropagation)(t),this.hot.listen(),this.TEXTAREA.focus())),T(M(e.prototype),"onBeforeKeyDown",this).call(this,t)}}}])&&k(n.prototype,r),o&&k(n,o),e}();function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function j(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(t,e,n){return(I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=D(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var L=new WeakMap,H=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=D(e).call(this,t))||"object"!==A(o)&&"function"!=typeof o?j(r):o).query=null,n.strippedChoices=[],n.rawChoices=[],L.set(j(n),{skipOne:!1}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(e,N),n=e,(r=[{key:"getValue",value:function(){var t=this,e=this.rawChoices.find(function(e){return t.stripValueIfNeeded(e)===t.TEXTAREA.value});return Object(s.isDefined)(e)?e:this.TEXTAREA.value}},{key:"createElements",value:function(){I(D(e.prototype),"createElements",this).call(this),Object(c.addClass)(this.htContainer,"autocompleteEditor"),Object(c.addClass)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var t=this,n=L.get(this);this.TEXTAREA_PARENT.style.overflow="auto",I(D(e.prototype),"open",this).call(this),this.TEXTAREA_PARENT.style.overflow="";var r=this.htEditor.getInstance(),o=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var i=Object(c.getScrollbarWidth)(this.hot.rootDocument);r.updateSettings({colWidths:o?[Object(c.outerWidth)(this.TEXTAREA)-2]:void 0,width:o?Object(c.outerWidth)(this.TEXTAREA)+i+2:void 0,afterRenderer:function(e,n,r,o,i){var a,l,u=t.cellProperties,c=u.filteringCaseSensitive,f=u.allowHtml,h=t.query,d=Object(s.stringify)(i);d&&!f&&-1!==(a=!0===c?d.indexOf(h):d.toLowerCase().indexOf(h.toLowerCase()))&&(l=d.substr(a,h.length),d=d.replace(l,"<strong>".concat(l,"</strong>"))),e.innerHTML=d},autoColumnSize:!0,modifyColWidth:function(t,e){var n=this.getPlugin("autoColumnSize"),r=t;if(n){var i=n.widths;i[e]&&(r=i[e])}return o?r:r+15}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]="".concat(i+2,"px"),n.skipOne&&(n.skipOne=!1),this.hot._registerTimeout(function(){t.queryChoices(t.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),I(D(e.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(t){I(D(e.prototype),"discardEditor",this).call(this,t),this.hot.view.render()}},{key:"queryChoices",value:function(t){var e=this,n=this.cellProperties.source;this.query=t,"function"==typeof n?n.call(this.cellProperties,t,function(t){e.rawChoices=t,e.updateChoicesList(e.stripValuesIfNeeded(t))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(t){var n=Object(c.getCaretPosition)(this.TEXTAREA),r=Object(c.getSelectionEndPosition)(this.TEXTAREA),o=this.cellProperties.sortByRelevance,i=this.cellProperties.filter,a=null,s=null,l=t;o&&(a=e.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));var f=Array.isArray(a)?a.length:0;if(!1===i)f&&(s=a[0]);else{for(var h=[],d=0,p=l.length;d<p&&!(o&&f<=d);d++)f?h.push(l[a[d]]):h.push(l[d]);s=0,l=h}this.strippedChoices=l,this.htEditor.loadData(Object(u.pivot)([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s),this.hot.listen(!1),Object(c.setCaretPosition)(this.TEXTAREA,n,n===r?void 0:r)}},{key:"flipDropdownIfNeeded",value:function(){var t=Object(c.offset)(this.TEXTAREA),e=Object(c.outerHeight)(this.TEXTAREA),n=this.getDropdownHeight(),r=Object(c.getTrimmingContainer)(this.hot.view.wt.wtTable.TABLE),o=r.scrollTop,i=Object(c.outerHeight)(this.hot.view.wt.wtTable.THEAD),a={row:0,col:0};r!==this.hot.rootWindow&&(a=Object(c.offset)(r));var s=t.top-a.top-i+o,l=r.scrollHeight-s-i-e,u=n>l&&s>l;return u?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(u?s:l,n),u}},{key:"limitDropdownIfNeeded",value:function(t,e){if(e>t){var n,r=0,o=0,i=0;do{r+=i=this.htEditor.getRowHeight(o)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,o+=1}while(r<t);n=r-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+e-n,"px")),this.setDropdownHeight(r-i)}}},{key:"flipDropdown",value:function(t){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="".concat(-t,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var t=this.htEditor.rootElement.style;"absolute"===t.position&&(t.position="",t.top=""),this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var t=this.htEditor.getColWidth(0)+Object(c.getScrollbarWidth)(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(t){this.htEditor.updateSettings({height:t})}},{key:"highlightBestMatchingChoice",value:function(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var t=this.htEditor.getInstance().getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}},{key:"stripValueIfNeeded",value:function(t){return this.stripValuesIfNeeded([t])[0]}},{key:"stripValuesIfNeeded",value:function(t){var e=this.cellProperties.allowHtml,n=Object(u.arrayMap)(t,function(t){return Object(s.stringify)(t)});return Object(u.arrayMap)(n,function(t){return e?t:Object(l.stripTags)(t)})}},{key:"allowKeyEventPropagation",value:function(t){var e=this.htEditor.getSelectedRangeLast(),n=e?e.from.row:-1,r=!1;return t===a.KEY_CODES.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(r=!0),t===a.KEY_CODES.ARROW_UP&&n>-1&&(r=!0),r}},{key:"onBeforeKeyDown",value:function(t){var n=this,r=L.get(this);if(r.skipOne=!1,Object(a.isPrintableChar)(t.keyCode)||t.keyCode===a.KEY_CODES.BACKSPACE||t.keyCode===a.KEY_CODES.DELETE||t.keyCode===a.KEY_CODES.INSERT){var o=0;if(t.keyCode===a.KEY_CODES.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(o+=10),this.htEditor&&this.hot._registerTimeout(function(){n.queryChoices(n.TEXTAREA.value),r.skipOne=!0},o)}I(D(e.prototype),"onBeforeKeyDown",this).call(this,t)}}])&&x(n.prototype,r),o&&x(n,o),e}();H.sortByRelevance=function(t,e,n){var r,o,i,a,u=[],c=t.length,f=[],h=e.length;if(0===c){for(a=0;a<h;a++)f.push(a);return f}for(a=0;a<h;a++)r=Object(l.stripTags)(Object(s.stringify)(e[a])),-1!==(o=n?r.indexOf(t):r.toLowerCase().indexOf(t.toLowerCase()))&&(i=r.length-o-c,u.push({baseIndex:a,index:o,charsLeft:i,value:r}));for(u.sort(function(t,e){if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0}),a=0,h=u.length;a<h;a++)f.push(u[a].baseIndex);return f};var F=H;function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function V(t,e){return!e||"object"!==B(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Y(t,e){return(Y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var z=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),V(this,U(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Y(t,e)}(e,i["b"]),n=e,(r=[{key:"beginEditing",value:function(t,e){if(e&&"mouseup"===e.type){var n=this.TD.querySelector('input[type="checkbox"]');Object(c.hasClass)(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}])&&W(n.prototype,r),o&&W(n,o),e}(),G=n(25),X=n.n(G),q=n(156),K=n.n(q);function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Q(t,e){return!e||"object"!==$(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function J(t,e,n){return(J="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function et(t,e){return(et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Q(this,tt(e).call(this,t))).defaultDateFormat="DD/MM/YYYY",n.isCellEdited=!1,n.parentDestroyed=!1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(e,E),n=e,(r=[{key:"init",value:function(){var t=this;if("function"!=typeof X.a)throw new Error("You need to include moment.js to your project.");if("function"!=typeof K.a)throw new Error("You need to include Pikaday to your project.");J(tt(e.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){t.parentDestroyed=!0,t.destroyElements()})}},{key:"createElements",value:function(){J(tt(e.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,Object(c.addClass)(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.$datePicker=new K.a(this.getDatePickerConfig()),new v.a(this).addEventListener(this.datePicker,"mousedown",function(t){return Object(h.stopPropagation)(t)}),this.hideDatepicker()}},{key:"destroyElements",value:function(){this.$datePicker.destroy()}},{key:"prepare",value:function(t,n,r,o,i,a){J(tt(e.prototype),"prepare",this).call(this,t,n,r,o,i,a)}},{key:"open",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;J(tt(e.prototype),"open",this).call(this),this.showDatepicker(t)}},{key:"close",value:function(){var t=this;this._opened=!1,this.instance._registerTimeout(function(){t.instance._refreshBorders()}),J(tt(e.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var r=this.originalValue;void 0!==r&&this.setValue(r)}this.hideDatepicker(),J(tt(e.prototype),"finishEditing",this).call(this,t,n)}},{key:"showDatepicker",value:function(t){this.$datePicker.config(this.getDatePickerConfig());var e,n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.$datePicker.config(),i=this.instance.view.isMouseDown(),s=!!t&&Object(a.isMetaKey)(t.keyCode);this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+n.top+Object(c.outerHeight)(this.TD),"px"),this.datePickerStyle.left="".concat(this.hot.rootWindow.pageXOffset+n.left,"px"),this.$datePicker._onInputFocus=function(){},o.format=r,this.originalValue?(e=this.originalValue,X()(e,r,!0).isValid()&&this.$datePicker.setMoment(X()(e,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),s||i||this.setValue("")):this.cellProperties.defaultDate?(e=this.cellProperties.defaultDate,o.defaultDate=e,X()(e,r,!0).isValid()&&this.$datePicker.setMoment(X()(e,r),!0),s||i||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var t=this,e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Object(f.deepExtend)(n,this.cellProperties.datePickerConfig);var r=n.onSelect,o=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(e){var n=e;isNaN(n.getTime())||(n=X()(n).format(t.cellProperties.dateFormat||t.defaultDateFormat)),t.setValue(n),t.hideDatepicker(),r&&r()},n.onClose=function(){t.parentDestroyed||t.finishEditing(!1),o&&o()},n}}])&&Z(n.prototype,r),o&&Z(n,o),e}();function rt(t){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function it(t,e){return!e||"object"!==rt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function at(t,e,n){return(at="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=st(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lt(t,e){return(lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ut=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),it(this,st(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lt(t,e)}(e,F),n=e,(r=[{key:"prepare",value:function(t,n,r,o,i,a){at(st(e.prototype),"prepare",this).call(this,t,n,r,o,i,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}])&&ot(n.prototype,r),o&&ot(n,o),e}();o.a.getSingleton().add("beforeValidate",function(t,e,n){var r=this.getCellMeta(e,this.propToCol(n));r.editor===ut&&void 0===r.strict&&(r.filter=!1,r.strict=!0)});var ct=ut;function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,e){return!e||"object"!==ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dt(t){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pt(t,e){return(pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ht(this,dt(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pt(t,e)}(e,E),e}();function vt(t){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mt(t,e){return!e||"object"!==vt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bt(t,e,n){return(bt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function wt(t){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ct(t,e){return(Ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ot=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),mt(this,wt(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ct(t,e)}(e,E),n=e,(r=[{key:"createElements",value:function(){bt(wt(e.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Object(c.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}])&&yt(n.prototype,r),o&&yt(n,o),e}();function Et(t){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function St(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kt(t,e){return!e||"object"!==Et(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rt(t,e,n){return(Rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Tt(t){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mt(t,e){return(Mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),kt(this,Tt(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mt(t,e)}(e,i["b"]),n=e,(r=[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Object(c.addClass)(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(t){this.select.value=t}},{key:"open",value:function(){var t=this;this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.addHook("beforeKeyDown",function(){return t.onBeforeKeyDown()})}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var t=this;this.addHook("afterScrollHorizontally",function(){return t.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return t.refreshDimensions()}),this.addHook("afterColumnResize",function(){return t.refreshDimensions()}),this.addHook("afterRowResize",function(){return t.refreshDimensions()})}},{key:"prepare",value:function(t,n,r,o,i,a){var s=this;Rt(Tt(e.prototype),"prepare",this).call(this,t,n,r,o,i,a);var l,u=this.cellProperties.selectOptions;l="function"==typeof u?this.prepareOptions(u(this.row,this.col,this.prop)):this.prepareOptions(u),Object(c.empty)(this.select),Object(f.objectEach)(l,function(t,e){var n=s.hot.rootDocument.createElement("OPTION");n.value=e,Object(c.fastInnerHTML)(n,t),s.select.appendChild(n)})}},{key:"prepareOptions",value:function(t){var e={};if(Array.isArray(t))for(var n=0,r=t.length;n<r;n++)e[t[n]]=t[n];else"object"===Et(t)&&(e=t);return e}},{key:"refreshValue",value:function(){var t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===i.a.EDITING)if(this.TD=this.getEditedCell(),this.TD){var t,e=this.hot.view.wt.wtOverlays,n=Object(c.offset)(this.TD),r=Object(c.offset)(this.hot.rootElement),o=e.scrollableElement,a=this.checkEditorSection(),s=Object(c.outerWidth)(this.TD)+1,l=Object(c.outerHeight)(this.TD)+1,u=n.top-r.top-1-(o.scrollTop||0),f=n.left-r.left-1-(o.scrollLeft||0);switch(a){case"top":t=Object(c.getCssTransform)(e.topOverlay.clone.wtTable.holder.parentNode);break;case"left":t=Object(c.getCssTransform)(e.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":t=Object(c.getCssTransform)(e.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":t=Object(c.getCssTransform)(e.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":t=Object(c.getCssTransform)(e.bottomOverlay.clone.wtTable.holder.parentNode)}0===this.hot.getSelectedLast()[0]&&(u+=1),0===this.hot.getSelectedLast()[1]&&(f+=1);var h=this.select.style;t&&-1!==t?h[t[0]]=t[1]:Object(c.resetCssTransform)(this.select);var d=Object(c.getComputedStyle)(this.TD,this.hot.rootWindow);parseInt(d.borderTopWidth,10)>0&&(l-=1),parseInt(d.borderLeftWidth,10)>0&&(s-=1),h.height="".concat(l,"px"),h.minWidth="".concat(s,"px"),h.top="".concat(u,"px"),h.left="".concat(f,"px"),h.margin="0px"}else this.close()}},{key:"getEditedCell",value:function(){var t,e=this.hot.view.wt.wtOverlays;switch(this.checkEditorSection()){case"top":t=e.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=101;break;case"corner":t=e.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=103;break;case"left":t=e.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=102;break;default:t=this.hot.getCell(this.row,this.col),this.select.style.zIndex=""}return t<0?void 0:t}},{key:"onBeforeKeyDown",value:function(){var t=this.select.selectedIndex-1,e=this.select.selectedIndex+1;switch(event.keyCode){case a.KEY_CODES.ARROW_UP:t>=0&&(this.select[t].selected=!0),Object(h.stopImmediatePropagation)(event),event.preventDefault();break;case a.KEY_CODES.ARROW_DOWN:e<=this.select.length-1&&(this.select[e].selected=!0),Object(h.stopImmediatePropagation)(event),event.preventDefault()}}}])&&St(n.prototype,r),o&&St(n,o),e}();n.d(e,"d",function(){return Ft}),n.d(e,"a",function(){return Ht}),n.d(e,"b",function(){return Lt}),n.d(e,"c",function(){return Dt});var Nt=new WeakMap,At=Object(r.a)("editors"),xt=At.register,jt=At.getItem,It=At.hasItem,Dt=At.getNames;At.getValues;function Pt(t){var e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},o.a.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function Lt(t,e){var n;if("function"==typeof t)Nt.get(t)||Ft(null,t),n=Nt.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=jt(t)}if(!n)throw Error('No editor registered under name "'.concat(t,'"'));return n.getInstance(e)}function Ht(t){if(!It(t))throw Error('No registered editor found under "'.concat(t,'" name'));return jt(t).getConstructor()}function Ft(t,e){var n=new Pt(e);"string"==typeof t&&xt(t,n),Nt.set(e,n)}Ft("base",i.b),Ft("autocomplete",F),Ft("checkbox",z),Ft("date",nt),Ft("dropdown",ct),Ft("handsontable",N),Ft("numeric",gt),Ft("password",Ot),Ft("select",_t),Ft("text",E)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(52),n(107);var r=n(1);function o(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object(r.arrayReduce)(t,function(t,e,r){return t+e.replace(/(?:\r?\n\s+)/g,"")+(n[r]?n[r]:"")},"").trim()}},function(t,e,n){"use strict";n.r(e),n.d(e,"requestAnimationFrame",function(){return h}),n.d(e,"isClassListSupported",function(){return d}),n.d(e,"isTextContentSupported",function(){return p}),n.d(e,"isGetComputedStyleSupported",function(){return g}),n.d(e,"cancelAnimationFrame",function(){return v}),n.d(e,"isTouchSupported",function(){return y}),n.d(e,"isWebComponentSupportedNatively",function(){return m}),n.d(e,"hasCaptionProblem",function(){return b}),n.d(e,"getComparisonFunction",function(){return w}),n.d(e,"isPassiveEventSupported",function(){return C});n(10),n(11),n(12),n(7),n(6),n(26),n(8),n(126),n(9),n(45);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}for(var o,i,a,s=0,l=["ms","moz","webkit","o"],u=window.requestAnimationFrame,c=window.cancelAnimationFrame,f=0;f<l.length&&!u;++f)u=window["".concat(l[f],"RequestAnimationFrame")],c=window["".concat(l[f],"CancelAnimationFrame")]||window["".concat(l[f],"CancelRequestAnimationFrame")];function h(t){return u.call(window,t)}function d(){return!!document.documentElement.classList}function p(){return!!document.createTextNode("test").textContent}function g(){return!!window.getComputedStyle}function v(t){c.call(window,t)}function y(){return"ontouchstart"in window}function m(){var t=document.createElement("div");return!(!t.createShadowRoot||!t.createShadowRoot.toString().match(/\[native code\]/))}function b(){return void 0===o&&function(){var t=document.createElement("TABLE");t.style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0";var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",t.insertBefore(n,e),document.body.appendChild(t),o=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}(),o}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i||(i="object"===("undefined"==typeof Intl?"undefined":r(Intl))?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?function(t,e){return"".concat(t).localeCompare(e)}:function(t,e){return t===e?0:t>e?-1:1})}function C(){if(void 0!==a)return a;try{var t={get passive(){a=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){a=!1}return a}u||(u=function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-s)),r=window.setTimeout(function(){t(e+n)},n);return s=e+n,r}),c||(c=function(t){clearTimeout(t)})},function(t,e,n){"use strict";var r=n(49),o=n(119),i=n(110),a=n(57),s=n(70),l=n(121),u=n(46)("species"),c=[].slice,f=Math.max,h=n(106)("slice");n(27)({target:"Array",proto:!0,forced:!h},{slice:function(t,e){var n,h,d,p=s(this),g=a(p.length),v=i(t,g),y=i(void 0===e?g:e,g);if(o(p)&&("function"!=typeof(n=p.constructor)||n!==Array&&!o(n.prototype)?r(n)&&null===(n=n[u])&&(n=void 0):n=void 0,n===Array||void 0===n))return c.call(p,v,y);for(h=new(void 0===n?Array:n)(f(y-v,0)),d=0;v<y;v++,d++)v in p&&l(h,d,p[v]);return h.length=d,h}})},function(t,e,n){"use strict";n.r(e),n.d(e,"toUpperCaseFirst",function(){return o}),n.d(e,"equalsIgnoreCase",function(){return i}),n.d(e,"randomString",function(){return a}),n.d(e,"isPercentValue",function(){return s}),n.d(e,"substitute",function(){return l}),n.d(e,"stripTags",function(){return c});n(21),n(6),n(26),n(52);var r=n(13);function o(t){return t[0].toUpperCase()+t.substr(1)}function i(){for(var t=[],e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];for(var i=n.length;i;){i-=1;var a=Object(r.stringify)(n[i]).toLowerCase();-1===t.indexOf(a)&&t.push(a)}return 1===t.length}function a(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function s(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(t).replace(/(?:\\)?\[([^[\]]+)]/g,function(t,n){return"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]})}var u=/<\/?\w+\/?>|<\w+[\s|\/][^>]*>/gi;function c(t){return"".concat(t).replace(u,"")}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){"use strict";var r=n(54),o=(n(24),n(0));var i=function(t,e,n,r,i,a,s){var l=[],u=[];s.className&&(e.className?e.className="".concat(e.className," ").concat(s.className):e.className=s.className),s.readOnly&&l.push(s.readOnlyCellClassName),!1===s.valid&&s.invalidCellClassName?l.push(s.invalidCellClassName):u.push(s.invalidCellClassName),!1===s.wordWrap&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!a&&s.placeholder&&l.push(s.placeholderCellClassName),Object(o.removeClass)(e,u),Object(o.addClass)(e,l)},a=n(20),s=n(5);var l=function(t,e,n,r,i,l,u){var c=t.rootDocument,f=u.allowHtml?"html":"text",h=c.createElement("DIV");h.className="htAutocompleteArrow",h.appendChild(c.createTextNode(String.fromCharCode(9660)));for(var d=arguments.length,p=new Array(d>7?d-7:0),g=7;g<d;g++)p[g-7]=arguments[g];if(A(f).apply(this,[t,e,n,r,i,l,u].concat(p)),e.firstChild||e.appendChild(c.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),Object(o.addClass)(e,"htAutocomplete"),!t.acArrowListener){var v=new a.a(t);t.acArrowListener=function(i){Object(o.hasClass)(i.target,"htAutocompleteArrow")&&t.view.wt.getSetting("onCellDblClick",null,new s.a(n,r),e)},v.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",function(){v.destroy()})}},u=(n(44),n(7),n(6),n(26),n(50),n(8),n(31),n(9),n(45),n(36)),c=n(17),f=n(28),h=n(14),d=new WeakMap,p=new WeakMap,g="htBadValue";function v(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}var y=function(t,e,n,r,i,s,l){for(var y=t.rootDocument,m=arguments.length,b=new Array(m>7?m-7:0),w=7;w<m;w++)b[w-7]=arguments[w];A("base").apply(this,[t,e,n,r,i,s,l].concat(b)),function(t){var e=p.get(t);if(!e){var n=t.rootElement;(e=new a.a(t)).addEventListener(n,"click",function(e){return function(t,e){if(!v(t.target))return!1;var n=parseInt(t.target.getAttribute("data-row"),10),r=parseInt(t.target.getAttribute("data-col"),10);e.getCellMeta(n,r).readOnly&&t.preventDefault()}(e,t)}),e.addEventListener(n,"mouseup",function(e){return function(t,e){v(t.target)&&setTimeout(e.listen,10)}(e,t)}),e.addEventListener(n,"change",function(e){return function(t,e){if(!v(t.target))return!1;var n=parseInt(t.target.getAttribute("data-row"),10),r=parseInt(t.target.getAttribute("data-col"),10),o=e.getCellMeta(n,r);if(!o.readOnly){var i=null;i=t.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,e.setDataAtCell(n,r,i)}}(e,t)}),p.set(t,e)}}(t);var C=function(t){var e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(y),O=l.label,E=!1;if(void 0===l.checkedTemplate&&(l.checkedTemplate=!0),void 0===l.uncheckedTemplate&&(l.uncheckedTemplate=!1),Object(o.empty)(e),s===l.checkedTemplate||Object(u.equalsIgnoreCase)(s,l.checkedTemplate)?C.checked=!0:s===l.uncheckedTemplate||Object(u.equalsIgnoreCase)(s,l.uncheckedTemplate)?C.checked=!1:null===s?Object(o.addClass)(C,"noValue"):(C.style.display="none",Object(o.addClass)(C,g),E=!0),C.setAttribute("data-row",n),C.setAttribute("data-col",r),!E&&O){var S="";O.value?S="function"==typeof O.value?O.value.call(this,n,r,i,s):O.value:O.property&&(S=t.getDataAtRowProp(n,O.property));var k=function(t,e){var n=t.createElement("label");return n.className="htCheckboxRendererLabel",n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}(y,S);"before"===O.position?k.appendChild(C):k.insertBefore(C,k.firstChild),C=k}function R(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.getSelectedRangeLast();if(n){for(var r=n.getTopLeftCorner(),o=r.row,i=r.col,a=n.getBottomRightCorner(),s=a.row,l=a.col,u=[],c=o;c<=s;c+=1)for(var f=i;f<=l;f+=1){var h=t.getCellMeta(c,f);if("checkbox"!==h.type)return;if(!0!==h.readOnly){void 0===h.checkedTemplate&&(h.checkedTemplate=!0),void 0===h.uncheckedTemplate&&(h.uncheckedTemplate=!1);var d=t.getDataAtCell(c,f);!1===e?[h.checkedTemplate,h.checkedTemplate.toString()].includes(d)?u.push([c,f,h.uncheckedTemplate]):[h.uncheckedTemplate,h.uncheckedTemplate.toString(),null,void 0].includes(d)&&u.push([c,f,h.checkedTemplate]):u.push([c,f,h.uncheckedTemplate])}}u.length>0&&t.setDataAtCell(u)}}e.appendChild(C),E&&e.appendChild(y.createTextNode("#bad-value#")),d.has(t)||(d.set(t,!0),t.addHook("beforeKeyDown",function(e){var n=Object(f.partial)(c.isKey,e.keyCode);!t.getSettings().enterBeginsEditing&&n("ENTER")||(n("".concat("SPACE|ENTER","|").concat("DELETE|BACKSPACE"))&&!Object(h.isImmediatePropagationStopped)(e)&&function(e){var n=t.getSelectedRangeLast();if(n)for(var r=n.getTopLeftCorner(),o=n.getBottomRightCorner(),i=r.row;i<=o.row;i++)for(var a=r.col;a<=o.col;a++){var s=t.getCellMeta(i,a);if("checkbox"!==s.type)return;var l=t.getCell(i,a);if(null==l)e(i,a,s);else{var u=l.querySelectorAll("input[type=checkbox]");u.length>0&&!s.readOnly&&e(u)}}}(function(){Object(h.stopImmediatePropagation)(e),e.preventDefault()}),n("SPACE|ENTER")&&R(),n("DELETE|BACKSPACE")&&R(!0))}))};var m=function(t,e,n,r,i,a){for(var s=arguments.length,l=new Array(s>6?s-6:0),u=6;u<s;u++)l[u-6]=arguments[u];A("base").apply(this,[t,e,n,r,i,a].concat(l)),Object(o.fastInnerHTML)(e,null==a?"":a)},b=(n(21),n(64),n(52),n(61),n(84)),w=n.n(b),C=n(4);var O=function(t,e,n,r,o,i,a){var s=i;if(Object(C.isNumeric)(s)){var l=a.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,f=a.className||"",h=f.length?f.split(" "):[];if(void 0!==u&&!w.a.languages()[u]){var d=u.replace("-",""),p=w.a.allLanguages?w.a.allLanguages[u]:w.a[d];p&&w.a.registerLanguage(p)}w.a.setLanguage(u),s=w()(s).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" ")}A("text")(t,e,n,r,o,s,a)};var E=function(t,e,n,r,i,a,s){for(var l=arguments.length,u=new Array(l>7?l-7:0),c=7;c<l;c++)u[c-7]=arguments[c];A("text").apply(this,[t,e,n,r,i,a,s].concat(u));var f=s.hashLength||e.innerHTML.length,h=s.hashSymbol||"*",d="";Object(C.rangeEach)(f-1,function(){d+=h}),Object(o.fastInnerHTML)(e,d)},S=n(13);var k=function(t,e,n,r,i,a,s){for(var l=arguments.length,u=new Array(l>7?l-7:0),c=7;c<l;c++)u[c-7]=arguments[c];A("base").apply(this,[t,e,n,r,i,a,s].concat(u));var f=a;if(!f&&s.placeholder&&(f=s.placeholder),f=Object(S.stringify)(f),t.getSettings().trimWhitespace||(f=f.replace(/ /g,String.fromCharCode(160))),s.rendererTemplate){Object(o.empty)(e);var h=t.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=t.getSourceDataAtRow(n),e.appendChild(h)}else Object(o.fastInnerText)(e,f)};n.d(e,"c",function(){return T}),n.d(e,"b",function(){return A}),n.d(e,"a",function(){return N});var R=Object(r.a)("renderers"),T=R.register,M=R.getItem,_=R.hasItem,N=R.getNames;R.getValues;function A(t){if("function"==typeof t)return t;if(!_(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return M(t)}T("base",i),T("autocomplete",l),T("checkbox",y),T("html",m),T("numeric",O),T("password",E),T("text",k)},function(t,e,n){"use strict";var r=n(1),o=n(2),i={_localHooks:Object.create(null),addLocalHook:function(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks:function(t){for(var e=this,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this._localHooks[t]&&Object(r.arrayEach)(this._localHooks[t],function(t){return t.apply(e,o)})},clearLocalHooks:function(){return this._localHooks={},this}};Object(o.defineGetter)(i,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),e.a=i},function(t,e,n){"use strict";n.r(e),n.d(e,"setBrowserMeta",function(){return a}),n.d(e,"isChrome",function(){return s}),n.d(e,"isEdge",function(){return l}),n.d(e,"isIE",function(){return u}),n.d(e,"isIE8",function(){return c}),n.d(e,"isIE9",function(){return f}),n.d(e,"isMSBrowser",function(){return h}),n.d(e,"isMobileBrowser",function(){return d}),n.d(e,"isSafari",function(){return p});var r=n(2),o=function(t){var e={value:!1,test:function(n,r){e.value=t(n,r)}};return e},i={chrome:o(function(t,e){return/Chrome/.test(t)&&/Google/.test(e)}),edge:o(function(t){return/Edge/.test(t)}),ie:o(function(t){return/Trident/.test(t)}),ie8:o(function(){return!document.createTextNode("test").textContent}),ie9:o(function(){return!!document.documentMode}),mobile:o(function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}),safari:o(function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)})};function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.userAgent,n=void 0===e?navigator.userAgent:e,o=t.vendor,a=void 0===o?navigator.vendor:o;Object(r.objectEach)(i,function(t){(0,t.test)(n,a)})}function s(){return i.chrome.value}function l(){return i.edge.value}function u(){return i.ie.value}function c(){return i.ie8.value}function f(){return i.ie9.value}function h(){return i.ie.value||i.edge.value}function d(){return i.mobile.value}function p(){return i.safari.value}a()},function(t,e){t.exports="object"==typeof window&&window&&window.Math==Math?window:"object"==typeof self&&self&&self.Math==Math?self:Function("return this")()},function(t,e,n){var r,o;!function(){var i={version:"3.5.17"},a=[].slice,s=function(t){return a.call(t)},l=this.document;function u(t){return t&&(t.ownerDocument||t.document||t).documentElement}function c(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}if(l)try{s(l.documentElement.childNodes)[0].nodeType}catch(t){s=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),l)try{l.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var f=this.Element.prototype,h=f.setAttribute,d=f.setAttributeNS,p=this.CSSStyleDeclaration.prototype,g=p.setProperty;f.setAttribute=function(t,e){h.call(this,t,e+"")},f.setAttributeNS=function(t,e,n){d.call(this,t,e,n+"")},p.setProperty=function(t,e,n){g.call(this,t,e+"",n)}}function v(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function y(t){return null===t?NaN:+t}function m(t){return!isNaN(t)}function b(t){return{left:function(e,n,r,o){for(arguments.length<3&&(r=0),arguments.length<4&&(o=e.length);r<o;){var i=r+o>>>1;t(e[i],n)<0?r=i+1:o=i}return r},right:function(e,n,r,o){for(arguments.length<3&&(r=0),arguments.length<4&&(o=e.length);r<o;){var i=r+o>>>1;t(e[i],n)>0?o=i:r=i+1}return r}}}i.ascending=v,i.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},i.min=function(t,e){var n,r,o=-1,i=t.length;if(1===arguments.length){for(;++o<i;)if(null!=(r=t[o])&&r>=r){n=r;break}for(;++o<i;)null!=(r=t[o])&&n>r&&(n=r)}else{for(;++o<i;)if(null!=(r=e.call(t,t[o],o))&&r>=r){n=r;break}for(;++o<i;)null!=(r=e.call(t,t[o],o))&&n>r&&(n=r)}return n},i.max=function(t,e){var n,r,o=-1,i=t.length;if(1===arguments.length){for(;++o<i;)if(null!=(r=t[o])&&r>=r){n=r;break}for(;++o<i;)null!=(r=t[o])&&r>n&&(n=r)}else{for(;++o<i;)if(null!=(r=e.call(t,t[o],o))&&r>=r){n=r;break}for(;++o<i;)null!=(r=e.call(t,t[o],o))&&r>n&&(n=r)}return n},i.extent=function(t,e){var n,r,o,i=-1,a=t.length;if(1===arguments.length){for(;++i<a;)if(null!=(r=t[i])&&r>=r){n=o=r;break}for(;++i<a;)null!=(r=t[i])&&(n>r&&(n=r),o<r&&(o=r))}else{for(;++i<a;)if(null!=(r=e.call(t,t[i],i))&&r>=r){n=o=r;break}for(;++i<a;)null!=(r=e.call(t,t[i],i))&&(n>r&&(n=r),o<r&&(o=r))}return[n,o]},i.sum=function(t,e){var n,r=0,o=t.length,i=-1;if(1===arguments.length)for(;++i<o;)m(n=+t[i])&&(r+=n);else for(;++i<o;)m(n=+e.call(t,t[i],i))&&(r+=n);return r},i.mean=function(t,e){var n,r=0,o=t.length,i=-1,a=o;if(1===arguments.length)for(;++i<o;)m(n=y(t[i]))?r+=n:--a;else for(;++i<o;)m(n=y(e.call(t,t[i],i)))?r+=n:--a;if(a)return r/a},i.quantile=function(t,e){var n=(t.length-1)*e+1,r=Math.floor(n),o=+t[r-1],i=n-r;return i?o+i*(t[r]-o):o},i.median=function(t,e){var n,r=[],o=t.length,a=-1;if(1===arguments.length)for(;++a<o;)m(n=y(t[a]))&&r.push(n);else for(;++a<o;)m(n=y(e.call(t,t[a],a)))&&r.push(n);if(r.length)return i.quantile(r.sort(v),.5)},i.variance=function(t,e){var n,r,o=t.length,i=0,a=0,s=-1,l=0;if(1===arguments.length)for(;++s<o;)m(n=y(t[s]))&&(a+=(r=n-i)*(n-(i+=r/++l)));else for(;++s<o;)m(n=y(e.call(t,t[s],s)))&&(a+=(r=n-i)*(n-(i+=r/++l)));if(l>1)return a/(l-1)},i.deviation=function(){var t=i.variance.apply(this,arguments);return t?Math.sqrt(t):t};var w=b(v);function C(t){return t.length}i.bisectLeft=w.left,i.bisect=i.bisectRight=w.right,i.bisector=function(t){return b(1===t.length?function(e,n){return v(t(e),n)}:t)},i.shuffle=function(t,e,n){(i=arguments.length)<3&&(n=t.length,i<2&&(e=0));for(var r,o,i=n-e;i;)o=Math.random()*i--|0,r=t[i+e],t[i+e]=t[o+e],t[o+e]=r;return t},i.permute=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},i.pairs=function(t){for(var e=0,n=t.length-1,r=t[0],o=new Array(n<0?0:n);e<n;)o[e]=[r,r=t[++e]];return o},i.transpose=function(t){if(!(o=t.length))return[];for(var e=-1,n=i.min(t,C),r=new Array(n);++e<n;)for(var o,a=-1,s=r[e]=new Array(o);++a<o;)s[a]=t[a][e];return r},i.zip=function(){return i.transpose(arguments)},i.keys=function(t){var e=[];for(var n in t)e.push(n);return e},i.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},i.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},i.merge=function(t){for(var e,n,r,o=t.length,i=-1,a=0;++i<o;)a+=t[i].length;for(n=new Array(a);--o>=0;)for(e=(r=t[o]).length;--e>=0;)n[--a]=r[e];return n};var O=Math.abs;function E(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function S(){this._=Object.create(null)}i.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n==1/0)throw new Error("infinite range");var r,o=[],i=function(t){var e=1;for(;t*e%1;)e*=10;return e}(O(n)),a=-1;if(t*=i,e*=i,(n*=i)<0)for(;(r=t+n*++a)>e;)o.push(r/i);else for(;(r=t+n*++a)<e;)o.push(r/i);return o},i.map=function(t,e){var n=new S;if(t instanceof S)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var r,o=-1,i=t.length;if(1===arguments.length)for(;++o<i;)n.set(o,t[o]);else for(;++o<i;)n.set(e.call(t,r=t[o],o),r)}else for(var a in t)n.set(a,t[a]);return n};var k="__proto__",R="\0";function T(t){return(t+="")===k||t[0]===R?R+t:t}function M(t){return(t+="")[0]===R?t.slice(1):t}function _(t){return T(t)in this._}function N(t){return(t=T(t))in this._&&delete this._[t]}function A(){var t=[];for(var e in this._)t.push(M(e));return t}function x(){var t=0;for(var e in this._)++t;return t}function j(){for(var t in this._)return!1;return!0}function I(){this._=Object.create(null)}function D(t){return t}function P(t,e,n){return function(){var r=n.apply(e,arguments);return r===e?t:r}}function L(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,r=H.length;n<r;++n){var o=H[n]+e;if(o in t)return o}}E(S,{has:_,get:function(t){return this._[T(t)]},set:function(t,e){return this._[T(t)]=e},remove:N,keys:A,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:M(e),value:this._[e]});return t},size:x,empty:j,forEach:function(t){for(var e in this._)t.call(this,M(e),this._[e])}}),i.nest=function(){var t,e,n={},r=[],o=[];function a(o,i,s){if(s>=r.length)return e?e.call(n,i):t?i.sort(t):i;for(var l,u,c,f,h=-1,d=i.length,p=r[s++],g=new S;++h<d;)(f=g.get(l=p(u=i[h])))?f.push(u):g.set(l,[u]);return o?(u=o(),c=function(t,e){u.set(t,a(o,e,s))}):(u={},c=function(t,e){u[t]=a(o,e,s)}),g.forEach(c),u}return n.map=function(t,e){return a(e,t,0)},n.entries=function(t){return function t(e,n){if(n>=r.length)return e;var i=[],a=o[n++];return e.forEach(function(e,r){i.push({key:e,values:t(r,n)})}),a?i.sort(function(t,e){return a(t.key,e.key)}):i}(a(i.map,t,0),0)},n.key=function(t){return r.push(t),n},n.sortKeys=function(t){return o[r.length-1]=t,n},n.sortValues=function(e){return t=e,n},n.rollup=function(t){return e=t,n},n},i.set=function(t){var e=new I;if(t)for(var n=0,r=t.length;n<r;++n)e.add(t[n]);return e},E(I,{has:_,add:function(t){return this._[T(t+="")]=!0,t},remove:N,values:A,size:x,empty:j,forEach:function(t){for(var e in this._)t.call(this,M(e))}}),i.behavior={},i.rebind=function(t,e){for(var n,r=1,o=arguments.length;++r<o;)t[n=arguments[r]]=P(t,e,e[n]);return t};var H=["webkit","ms","moz","Moz","o","O"];function F(){}function B(){}function W(t){var e=[],n=new S;function r(){for(var n,r=e,o=-1,i=r.length;++o<i;)(n=r[o].on)&&n.apply(this,arguments);return t}return r.on=function(r,o){var i,a=n.get(r);return arguments.length<2?a&&a.on:(a&&(a.on=null,e=e.slice(0,i=e.indexOf(a)).concat(e.slice(i+1)),n.remove(r)),o&&e.push(n.set(r,{on:o})),t)},r}function V(){i.event.preventDefault()}function U(){for(var t,e=i.event;t=e.sourceEvent;)e=t;return e}function Y(t){for(var e=new B,n=0,r=arguments.length;++n<r;)e[arguments[n]]=W(e);return e.of=function(n,r){return function(o){try{var a=o.sourceEvent=i.event;o.target=t,i.event=o,e[o.type].apply(n,r)}finally{i.event=a}}},e}i.dispatch=function(){for(var t=new B,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=W(t);return t},B.prototype.on=function(t,e){var n=t.indexOf("."),r="";if(n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(r):this[t].on(r,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},i.event=null,i.requote=function(t){return t.replace(z,"\\$&")};var z=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,G={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]};function X(t){return G(t,Z),t}var q=function(t,e){return e.querySelector(t)},K=function(t,e){return e.querySelectorAll(t)},$=function(t,e){var n=t.matches||t[L(t,"matchesSelector")];return($=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&(q=function(t,e){return Sizzle(t,e)[0]||null},K=Sizzle,$=Sizzle.matchesSelector),i.selection=function(){return i.select(l.documentElement)};var Z=i.selection.prototype=[];function Q(t){return"function"==typeof t?t:function(){return q(t,this)}}function J(t){return"function"==typeof t?t:function(){return K(t,this)}}Z.select=function(t){var e,n,r,o,i=[];t=Q(t);for(var a=-1,s=this.length;++a<s;){i.push(e=[]),e.parentNode=(r=this[a]).parentNode;for(var l=-1,u=r.length;++l<u;)(o=r[l])?(e.push(n=t.call(o,o.__data__,l,a)),n&&"__data__"in o&&(n.__data__=o.__data__)):e.push(null)}return X(i)},Z.selectAll=function(t){var e,n,r=[];t=J(t);for(var o=-1,i=this.length;++o<i;)for(var a=this[o],l=-1,u=a.length;++l<u;)(n=a[l])&&(r.push(e=s(t.call(n,n.__data__,l,o))),e.parentNode=n);return X(r)};var tt="http://www.w3.org/1999/xhtml",et={svg:"http://www.w3.org/2000/svg",xhtml:tt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nt(t,e){return t=i.ns.qualify(t),null==e?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof e?t.local?function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}:function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}:t.local?function(){this.setAttributeNS(t.space,t.local,e)}:function(){this.setAttribute(t,e)}}function rt(t){return t.trim().replace(/\s+/g," ")}function ot(t){return new RegExp("(?:^|\\s+)"+i.requote(t)+"(?:\\s+|$)","g")}function it(t){return(t+"").trim().split(/^|\s+/)}function at(t,e){var n=(t=it(t).map(st)).length;return"function"==typeof e?function(){for(var r=-1,o=e.apply(this,arguments);++r<n;)t[r](this,o)}:function(){for(var r=-1;++r<n;)t[r](this,e)}}function st(t){var e=ot(t);return function(n,r){if(o=n.classList)return r?o.add(t):o.remove(t);var o=n.getAttribute("class")||"";r?(e.lastIndex=0,e.test(o)||n.setAttribute("class",rt(o+" "+t))):n.setAttribute("class",rt(o.replace(e," ")))}}function lt(t,e,n){return null==e?function(){this.style.removeProperty(t)}:"function"==typeof e?function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}:function(){this.style.setProperty(t,e,n)}}function ut(t,e){return null==e?function(){delete this[t]}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}:function(){this[t]=e}}function ct(t){return"function"==typeof t?t:(t=i.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){var e=this.ownerDocument,n=this.namespaceURI;return n===tt&&e.documentElement.namespaceURI===tt?e.createElement(t):e.createElementNS(n,t)}}function ft(){var t=this.parentNode;t&&t.removeChild(this)}function ht(t){return{__data__:t}}function dt(t){return function(){return $(this,t)}}function pt(t,e){for(var n=0,r=t.length;n<r;n++)for(var o,i=t[n],a=0,s=i.length;a<s;a++)(o=i[a])&&e(o,a,n);return t}function gt(t){return G(t,vt),t}i.ns={prefix:et,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),et.hasOwnProperty(n)?{space:et[n],local:t}:t}},Z.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return(t=i.ns.qualify(t)).local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(nt(e,t[e]));return this}return this.each(nt(t,e))},Z.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),r=(t=it(t)).length,o=-1;if(e=n.classList){for(;++o<r;)if(!e.contains(t[o]))return!1}else for(e=n.getAttribute("class");++o<r;)if(!ot(t[o]).test(e))return!1;return!0}for(e in t)this.each(at(e,t[e]));return this}return this.each(at(t,e))},Z.style=function(t,e,n){var r=arguments.length;if(r<3){if("string"!=typeof t){for(n in r<2&&(e=""),t)this.each(lt(n,t[n],e));return this}if(r<2){var o=this.node();return c(o).getComputedStyle(o,null).getPropertyValue(t)}n=""}return this.each(lt(t,e,n))},Z.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(ut(e,t[e]));return this}return this.each(ut(t,e))},Z.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},Z.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},Z.append=function(t){return t=ct(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},Z.insert=function(t,e){return t=ct(t),e=Q(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},Z.remove=function(){return this.each(ft)},Z.data=function(t,e){var n,r,o=-1,i=this.length;if(!arguments.length){for(t=new Array(i=(n=this[0]).length);++o<i;)(r=n[o])&&(t[o]=r.__data__);return t}function a(t,n){var r,o,i,a=t.length,c=n.length,f=Math.min(a,c),h=new Array(c),d=new Array(c),p=new Array(a);if(e){var g,v=new S,y=new Array(a);for(r=-1;++r<a;)(o=t[r])&&(v.has(g=e.call(o,o.__data__,r))?p[r]=o:v.set(g,o),y[r]=g);for(r=-1;++r<c;)(o=v.get(g=e.call(n,i=n[r],r)))?!0!==o&&(h[r]=o,o.__data__=i):d[r]=ht(i),v.set(g,!0);for(r=-1;++r<a;)r in y&&!0!==v.get(y[r])&&(p[r]=t[r])}else{for(r=-1;++r<f;)o=t[r],i=n[r],o?(o.__data__=i,h[r]=o):d[r]=ht(i);for(;r<c;++r)d[r]=ht(n[r]);for(;r<a;++r)p[r]=t[r]}d.update=h,d.parentNode=h.parentNode=p.parentNode=t.parentNode,s.push(d),l.push(h),u.push(p)}var s=gt([]),l=X([]),u=X([]);if("function"==typeof t)for(;++o<i;)a(n=this[o],t.call(n,n.parentNode.__data__,o));else for(;++o<i;)a(n=this[o],t);return l.enter=function(){return s},l.exit=function(){return u},l},Z.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},Z.filter=function(t){var e,n,r,o=[];"function"!=typeof t&&(t=dt(t));for(var i=0,a=this.length;i<a;i++){o.push(e=[]),e.parentNode=(n=this[i]).parentNode;for(var s=0,l=n.length;s<l;s++)(r=n[s])&&t.call(r,r.__data__,s,i)&&e.push(r)}return X(o)},Z.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,r=this[t],o=r.length-1,i=r[o];--o>=0;)(n=r[o])&&(i&&i!==n.nextSibling&&i.parentNode.insertBefore(n,i),i=n);return this},Z.sort=function(t){t=function(t){arguments.length||(t=v);return function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},Z.each=function(t){return pt(this,function(e,n,r){t.call(e,e.__data__,n,r)})},Z.call=function(t){var e=s(arguments);return t.apply(e[0]=this,e),this},Z.empty=function(){return!this.node()},Z.node=function(){for(var t=0,e=this.length;t<e;t++)for(var n=this[t],r=0,o=n.length;r<o;r++){var i=n[r];if(i)return i}return null},Z.size=function(){var t=0;return pt(this,function(){++t}),t};var vt=[];function yt(t,e,n){var r="__on"+t,o=t.indexOf("."),a=bt;o>0&&(t=t.slice(0,o));var l=mt.get(t);function u(){var e=this[r];e&&(this.removeEventListener(t,e,e.$),delete this[r])}return l&&(t=l,a=wt),o?e?function(){var o=a(e,s(arguments));u.call(this),this.addEventListener(t,this[r]=o,o.$=n),o._=e}:u:e?F:function(){var e,n=new RegExp("^__on([^.]+)"+i.requote(t)+"$");for(var r in this)if(e=r.match(n)){var o=this[r];this.removeEventListener(e[1],o,o.$),delete this[r]}}}i.selection.enter=gt,i.selection.enter.prototype=vt,vt.append=Z.append,vt.empty=Z.empty,vt.node=Z.node,vt.call=Z.call,vt.size=Z.size,vt.select=function(t){for(var e,n,r,o,i,a=[],s=-1,l=this.length;++s<l;){r=(o=this[s]).update,a.push(e=[]),e.parentNode=o.parentNode;for(var u=-1,c=o.length;++u<c;)(i=o[u])?(e.push(r[u]=n=t.call(o.parentNode,i.__data__,u,s)),n.__data__=i.__data__):e.push(null)}return X(a)},vt.insert=function(t,e){var n,r,o;return arguments.length<2&&(n=this,e=function(t,e,i){var a,s=n[i].update,l=s.length;for(i!=o&&(o=i,r=0),e>=r&&(r=e+1);!(a=s[r])&&++r<l;);return a}),Z.insert.call(this,t,e)},i.select=function(t){var e;return"string"==typeof t?(e=[q(t,l)]).parentNode=l.documentElement:(e=[t]).parentNode=u(t),X([e])},i.selectAll=function(t){var e;return"string"==typeof t?(e=s(K(t,l))).parentNode=l.documentElement:(e=s(t)).parentNode=null,X([e])},Z.on=function(t,e,n){var r=arguments.length;if(r<3){if("string"!=typeof t){for(n in r<2&&(e=!1),t)this.each(yt(n,t[n],e));return this}if(r<2)return(r=this.node()["__on"+t])&&r._;n=!1}return this.each(yt(t,e,n))};var mt=i.map({mouseenter:"mouseover",mouseleave:"mouseout"});function bt(t,e){return function(n){var r=i.event;i.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{i.event=r}}}function wt(t,e){var n=bt(t,e);return function(t){var e=t.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||n.call(this,t)}}l&&mt.forEach(function(t){"on"+t in l&&mt.remove(t)});var Ct,Ot=0;function Et(t){var e=".dragsuppress-"+ ++Ot,n="click"+e,r=i.select(c(t)).on("touchmove"+e,V).on("dragstart"+e,V).on("selectstart"+e,V);if(null==Ct&&(Ct=!("onselectstart"in t)&&L(t.style,"userSelect")),Ct){var o=u(t).style,a=o[Ct];o[Ct]="none"}return function(t){if(r.on(e,null),Ct&&(o[Ct]=a),t){var i=function(){r.on(n,null)};r.on(n,function(){V(),i()},!0),setTimeout(i,0)}}}i.mouse=function(t){return kt(t,U())};var St=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function kt(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();if(St<0){var o=c(t);if(o.scrollX||o.scrollY){var a=(n=i.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();St=!(a.f||a.e),n.remove()}}return St?(r.x=e.pageX,r.y=e.pageY):(r.x=e.clientX,r.y=e.clientY),[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}function Rt(){return i.event.changedTouches[0].identifier}i.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=U().changedTouches),e)for(var r,o=0,i=e.length;o<i;++o)if((r=e[o]).identifier===n)return kt(t,r)},i.behavior.drag=function(){var t=Y(o,"drag","dragstart","dragend"),e=null,n=a(F,i.mouse,c,"mousemove","mouseup"),r=a(Rt,i.touch,D,"touchmove","touchend");function o(){this.on("mousedown.drag",n).on("touchstart.drag",r)}function a(n,r,o,a,s){return function(){var l,u=i.event.target.correspondingElement||i.event.target,c=this.parentNode,f=t.of(this,arguments),h=0,d=n(),p=".drag"+(null==d?"":"-"+d),g=i.select(o(u)).on(a+p,function(){var t,e,n=r(c,d);if(!n)return;t=n[0]-y[0],e=n[1]-y[1],h|=t|e,y=n,f({type:"drag",x:n[0]+l[0],y:n[1]+l[1],dx:t,dy:e})}).on(s+p,function(){if(!r(c,d))return;g.on(a+p,null).on(s+p,null),v(h),f({type:"dragend"})}),v=Et(u),y=r(c,d);l=e?[(l=e.apply(this,arguments)).x-y[0],l.y-y[1]]:[0,0],f({type:"dragstart"})}}return o.origin=function(t){return arguments.length?(e=t,o):e},i.rebind(o,t,"on")},i.touches=function(t,e){return arguments.length<2&&(e=U().touches),e?s(e).map(function(e){var n=kt(t,e);return n.identifier=e.identifier,n}):[]};var Tt=1e-6,Mt=Tt*Tt,_t=Math.PI,Nt=2*_t,At=Nt-Tt,xt=_t/2,jt=_t/180,It=180/_t;function Dt(t){return t>0?1:t<0?-1:0}function Pt(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function Lt(t){return t>1?0:t<-1?_t:Math.acos(t)}function Ht(t){return t>1?xt:t<-1?-xt:Math.asin(t)}function Ft(t){return((t=Math.exp(t))+1/t)/2}function Bt(t){return(t=Math.sin(t/2))*t}var Wt=Math.SQRT2;i.interpolateZoom=function(t,e){var n,r,o=t[0],i=t[1],a=t[2],s=e[0],l=e[1],u=e[2],c=s-o,f=l-i,h=c*c+f*f;if(h<Mt)r=Math.log(u/a)/Wt,n=function(t){return[o+t*c,i+t*f,a*Math.exp(Wt*t*r)]};else{var d=Math.sqrt(h),p=(u*u-a*a+4*h)/(2*a*2*d),g=(u*u-a*a-4*h)/(2*u*2*d),v=Math.log(Math.sqrt(p*p+1)-p),y=Math.log(Math.sqrt(g*g+1)-g);r=(y-v)/Wt,n=function(t){var e,n=t*r,s=Ft(v),l=a/(2*d)*(s*(e=Wt*n+v,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(v));return[o+l*c,i+l*f,a*s/Ft(Wt*n+v)]}}return n.duration=1e3*r,n},i.behavior.zoom=function(){var t,e,n,r,o,a,s,u,f,h={x:0,y:0,k:1},d=[960,500],p=Yt,g=250,v=0,y="mousedown.zoom",m="mousemove.zoom",b="mouseup.zoom",w="touchstart.zoom",C=Y(O,"zoomstart","zoom","zoomend");function O(t){t.on(y,A).on(Ut+".zoom",j).on("dblclick.zoom",I).on(w,x)}function E(t){return[(t[0]-h.x)/h.k,(t[1]-h.y)/h.k]}function S(t){h.k=Math.max(p[0],Math.min(p[1],t))}function k(t,e){e=function(t){return[t[0]*h.k+h.x,t[1]*h.k+h.y]}(e),h.x+=t[0]-e[0],h.y+=t[1]-e[1]}function R(t,n,r,o){t.__chart__={x:h.x,y:h.y,k:h.k},S(Math.pow(2,o)),k(e=n,r),t=i.select(t),g>0&&(t=t.transition().duration(g)),t.call(O.event)}function T(){s&&s.domain(a.range().map(function(t){return(t-h.x)/h.k}).map(a.invert)),f&&f.domain(u.range().map(function(t){return(t-h.y)/h.k}).map(u.invert))}function M(t){v++||t({type:"zoomstart"})}function _(t){T(),t({type:"zoom",scale:h.k,translate:[h.x,h.y]})}function N(t){--v||(t({type:"zoomend"}),e=null)}function A(){var t=this,e=C.of(t,arguments),n=0,r=i.select(c(t)).on(m,function(){n=1,k(i.mouse(t),o),_(e)}).on(b,function(){r.on(m,null).on(b,null),a(n),N(e)}),o=E(i.mouse(t)),a=Et(t);ys.call(t),M(e)}function x(){var t,e=this,n=C.of(e,arguments),r={},a=0,s=".zoom-"+i.event.changedTouches[0].identifier,l="touchmove"+s,u="touchend"+s,c=[],f=i.select(e),d=Et(e);function p(){var n=i.touches(e);return t=h.k,n.forEach(function(t){t.identifier in r&&(r[t.identifier]=E(t))}),n}function g(){var t=i.event.target;i.select(t).on(l,v).on(u,m),c.push(t);for(var n=i.event.changedTouches,s=0,f=n.length;s<f;++s)r[n[s].identifier]=null;var d=p(),g=Date.now();if(1===d.length){if(g-o<500){var y=d[0];R(e,y,r[y.identifier],Math.floor(Math.log(h.k)/Math.LN2)+1),V()}o=g}else if(d.length>1){y=d[0];var b=d[1],w=y[0]-b[0],C=y[1]-b[1];a=w*w+C*C}}function v(){var s,l,u,c,f=i.touches(e);ys.call(e);for(var h=0,d=f.length;h<d;++h,c=null)if(u=f[h],c=r[u.identifier]){if(l)break;s=u,l=c}if(c){var p=(p=u[0]-s[0])*p+(p=u[1]-s[1])*p,g=a&&Math.sqrt(p/a);s=[(s[0]+u[0])/2,(s[1]+u[1])/2],l=[(l[0]+c[0])/2,(l[1]+c[1])/2],S(g*t)}o=null,k(s,l),_(n)}function m(){if(i.event.touches.length){for(var t=i.event.changedTouches,e=0,o=t.length;e<o;++e)delete r[t[e].identifier];for(var a in r)return void p()}i.selectAll(c).on(s,null),f.on(y,A).on(w,x),d(),N(n)}g(),M(n),f.on(y,null).on(w,g)}function j(){var o=C.of(this,arguments);r?clearTimeout(r):(ys.call(this),t=E(e=n||i.mouse(this)),M(o)),r=setTimeout(function(){r=null,N(o)},50),V(),S(Math.pow(2,.002*Vt())*h.k),k(e,t),_(o)}function I(){var t=i.mouse(this),e=Math.log(h.k)/Math.LN2;R(this,t,E(t),i.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}return Ut||(Ut="onwheel"in l?(Vt=function(){return-i.event.deltaY*(i.event.deltaMode?120:1)},"wheel"):"onmousewheel"in l?(Vt=function(){return i.event.wheelDelta},"mousewheel"):(Vt=function(){return-i.event.detail},"MozMousePixelScroll")),O.event=function(t){t.each(function(){var t=C.of(this,arguments),n=h;ws?i.select(this).transition().each("start.zoom",function(){h=this.__chart__||{x:0,y:0,k:1},M(t)}).tween("zoom:zoom",function(){var r=d[0],o=d[1],a=e?e[0]:r/2,s=e?e[1]:o/2,l=i.interpolateZoom([(a-h.x)/h.k,(s-h.y)/h.k,r/h.k],[(a-n.x)/n.k,(s-n.y)/n.k,r/n.k]);return function(e){var n=l(e),o=r/n[2];this.__chart__=h={x:a-n[0]*o,y:s-n[1]*o,k:o},_(t)}}).each("interrupt.zoom",function(){N(t)}).each("end.zoom",function(){N(t)}):(this.__chart__=h,M(t),_(t),N(t))})},O.translate=function(t){return arguments.length?(h={x:+t[0],y:+t[1],k:h.k},T(),O):[h.x,h.y]},O.scale=function(t){return arguments.length?(h={x:h.x,y:h.y,k:null},S(+t),T(),O):h.k},O.scaleExtent=function(t){return arguments.length?(p=null==t?Yt:[+t[0],+t[1]],O):p},O.center=function(t){return arguments.length?(n=t&&[+t[0],+t[1]],O):n},O.size=function(t){return arguments.length?(d=t&&[+t[0],+t[1]],O):d},O.duration=function(t){return arguments.length?(g=+t,O):g},O.x=function(t){return arguments.length?(s=t,a=t.copy(),h={x:0,y:0,k:1},O):s},O.y=function(t){return arguments.length?(f=t,u=t.copy(),h={x:0,y:0,k:1},O):f},i.rebind(O,C,"on")};var Vt,Ut,Yt=[0,1/0];function zt(){}function Gt(t,e,n){return this instanceof Gt?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof Gt?new Gt(t.h,t.s,t.l):pe(""+t,ge,Gt):new Gt(t,e,n)}i.color=zt,zt.prototype.toString=function(){return this.rgb()+""},i.hsl=Gt;var Xt=Gt.prototype=new zt;function qt(t,e,n){var r,o;function i(t){return Math.round(255*function(t){return t>360?t-=360:t<0&&(t+=360),t<60?r+(o-r)*t/60:t<180?o:t<240?r+(o-r)*(240-t)/60:r}(t))}return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:e<0?0:e>1?1:e,r=2*(n=n<0?0:n>1?1:n)-(o=n<=.5?n*(1+e):n+e-n*e),new ue(i(t+120),i(t),i(t-120))}function Kt(t,e,n){return this instanceof Kt?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof Kt?new Kt(t.h,t.c,t.l):ie(t instanceof Qt?t.l:(t=ve((t=i.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new Kt(t,e,n)}Xt.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new Gt(this.h,this.s,this.l/t)},Xt.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new Gt(this.h,this.s,t*this.l)},Xt.rgb=function(){return qt(this.h,this.s,this.l)},i.hcl=Kt;var $t=Kt.prototype=new zt;function Zt(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new Qt(n,Math.cos(t*=jt)*e,Math.sin(t)*e)}function Qt(t,e,n){return this instanceof Qt?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof Qt?new Qt(t.l,t.a,t.b):t instanceof Kt?Zt(t.h,t.c,t.l):ve((t=ue(t)).r,t.g,t.b):new Qt(t,e,n)}$t.brighter=function(t){return new Kt(this.h,this.c,Math.min(100,this.l+Jt*(arguments.length?t:1)))},$t.darker=function(t){return new Kt(this.h,this.c,Math.max(0,this.l-Jt*(arguments.length?t:1)))},$t.rgb=function(){return Zt(this.h,this.c,this.l).rgb()},i.lab=Qt;var Jt=18,te=.95047,ee=1,ne=1.08883,re=Qt.prototype=new zt;function oe(t,e,n){var r=(t+16)/116,o=r+e/500,i=r-n/200;return new ue(le(3.2404542*(o=ae(o)*te)-1.5371385*(r=ae(r)*ee)-.4985314*(i=ae(i)*ne)),le(-.969266*o+1.8760108*r+.041556*i),le(.0556434*o-.2040259*r+1.0572252*i))}function ie(t,e,n){return t>0?new Kt(Math.atan2(n,e)*It,Math.sqrt(e*e+n*n),t):new Kt(NaN,NaN,t)}function ae(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function se(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function le(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function ue(t,e,n){return this instanceof ue?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof ue?new ue(t.r,t.g,t.b):pe(""+t,ue,qt):new ue(t,e,n)}function ce(t){return new ue(t>>16,t>>8&255,255&t)}function fe(t){return ce(t)+""}re.brighter=function(t){return new Qt(Math.min(100,this.l+Jt*(arguments.length?t:1)),this.a,this.b)},re.darker=function(t){return new Qt(Math.max(0,this.l-Jt*(arguments.length?t:1)),this.a,this.b)},re.rgb=function(){return oe(this.l,this.a,this.b)},i.rgb=ue;var he=ue.prototype=new zt;function de(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function pe(t,e,n){var r,o,i,a=0,s=0,l=0;if(r=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(o=r[2].split(","),r[1]){case"hsl":return n(parseFloat(o[0]),parseFloat(o[1])/100,parseFloat(o[2])/100);case"rgb":return e(me(o[0]),me(o[1]),me(o[2]))}return(i=be.get(t))?e(i.r,i.g,i.b):(null==t||"#"!==t.charAt(0)||isNaN(i=parseInt(t.slice(1),16))||(4===t.length?(a=(3840&i)>>4,a|=a>>4,s=240&i,s|=s>>4,l=15&i,l|=l<<4):7===t.length&&(a=(16711680&i)>>16,s=(65280&i)>>8,l=255&i)),e(a,s,l))}function ge(t,e,n){var r,o,i=Math.min(t/=255,e/=255,n/=255),a=Math.max(t,e,n),s=a-i,l=(a+i)/2;return s?(o=l<.5?s/(a+i):s/(2-a-i),r=t==a?(e-n)/s+(e<n?6:0):e==a?(n-t)/s+2:(t-e)/s+4,r*=60):(r=NaN,o=l>0&&l<1?0:r),new Gt(r,o,l)}function ve(t,e,n){var r=se((.4124564*(t=ye(t))+.3575761*(e=ye(e))+.1804375*(n=ye(n)))/te),o=se((.2126729*t+.7151522*e+.072175*n)/ee);return Qt(116*o-16,500*(r-o),200*(o-se((.0193339*t+.119192*e+.9503041*n)/ne)))}function ye(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function me(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}he.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,r=this.b,o=30;return e||n||r?(e&&e<o&&(e=o),n&&n<o&&(n=o),r&&r<o&&(r=o),new ue(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,r/t))):new ue(o,o,o)},he.darker=function(t){return new ue((t=Math.pow(.7,arguments.length?t:1))*this.r,t*this.g,t*this.b)},he.hsl=function(){return ge(this.r,this.g,this.b)},he.toString=function(){return"#"+de(this.r)+de(this.g)+de(this.b)};var be=i.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function we(t){return"function"==typeof t?t:function(){return t}}function Ce(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=null),Oe(e,n,t,r)}}function Oe(t,e,n,r){var o={},a=i.dispatch("beforesend","progress","load","error"),l={},u=new XMLHttpRequest,c=null;function f(){var t,e=u.status;if(!e&&function(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}(u)||e>=200&&e<300||304===e){try{t=n.call(o,u)}catch(t){return void a.error.call(o,t)}a.load.call(o,t)}else a.error.call(o,u)}return!this.XDomainRequest||"withCredentials"in u||!/^(http(s)?:)?\/\//.test(t)||(u=new XDomainRequest),"onload"in u?u.onload=u.onerror=f:u.onreadystatechange=function(){u.readyState>3&&f()},u.onprogress=function(t){var e=i.event;i.event=t;try{a.progress.call(o,u)}finally{i.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l[t]:(null==e?delete l[t]:l[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",o):e},o.responseType=function(t){return arguments.length?(c=t,o):c},o.response=function(t){return n=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(s(arguments)))}}),o.send=function(n,r,i){if(2===arguments.length&&"function"==typeof r&&(i=r,r=null),u.open(n,t,!0),null==e||"accept"in l||(l.accept=e+",*/*"),u.setRequestHeader)for(var s in l)u.setRequestHeader(s,l[s]);return null!=e&&u.overrideMimeType&&u.overrideMimeType(e),null!=c&&(u.responseType=c),null!=i&&o.on("error",i).on("load",function(t){i(null,t)}),a.beforesend.call(o,u),u.send(null==r?null:r),o},o.abort=function(){return u.abort(),o},i.rebind(o,a,"on"),null==r?o:o.get(function(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}(r))}be.forEach(function(t,e){be.set(t,ce(e))}),i.functor=we,i.xhr=Ce(D),i.dsv=function(t,e){var n=new RegExp('["'+t+"\n]"),r=t.charCodeAt(0);function o(t,n,r){arguments.length<3&&(r=n,n=null);var o=Oe(t,e,null==n?i:a(n),r);return o.row=function(t){return arguments.length?o.response(null==(n=t)?i:a(t)):n},o}function i(t){return o.parse(t.responseText)}function a(t){return function(e){return o.parse(e.responseText,t)}}function s(e){return e.map(l).join(t)}function l(t){return n.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}return o.parse=function(t,e){var n;return o.parseRows(t,function(t,r){if(n)return n(t,r-1);var o=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");n=e?function(t,n){return e(o(t),n)}:o})},o.parseRows=function(t,e){var n,o,i={},a={},s=[],l=t.length,u=0,c=0;function f(){if(u>=l)return a;if(o)return o=!1,i;var e=u;if(34===t.charCodeAt(e)){for(var n=e;n++<l;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}return u=n+2,13===(s=t.charCodeAt(n+1))?(o=!0,10===t.charCodeAt(n+2)&&++u):10===s&&(o=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;u<l;){var s,c=1;if(10===(s=t.charCodeAt(u++)))o=!0;else if(13===s)o=!0,10===t.charCodeAt(u)&&(++u,++c);else if(s!==r)continue;return t.slice(e,u-c)}return t.slice(e)}for(;(n=f())!==a;){for(var h=[];n!==i&&n!==a;)h.push(n),n=f();e&&null==(h=e(h,c++))||s.push(h)}return s},o.format=function(e){if(Array.isArray(e[0]))return o.formatRows(e);var n=new I,r=[];return e.forEach(function(t){for(var e in t)n.has(e)||r.push(n.add(e))}),[r.map(l).join(t)].concat(e.map(function(e){return r.map(function(t){return l(e[t])}).join(t)})).join("\n")},o.formatRows=function(t){return t.map(s).join("\n")},o},i.csv=i.dsv(",","text/csv"),i.tsv=i.dsv("\t","text/tab-separated-values");var Ee,Se,ke,Re,Te=this[L(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};function Me(t,e,n){var r=arguments.length;r<2&&(e=0),r<3&&(n=Date.now());var o={c:t,t:n+e,n:null};return Se?Se.n=o:Ee=o,Se=o,ke||(Re=clearTimeout(Re),ke=1,Te(_e)),o}function _e(){var t=Ne(),e=Ae()-t;e>24?(isFinite(e)&&(clearTimeout(Re),Re=setTimeout(_e,e)),ke=0):(ke=1,Te(_e))}function Ne(){for(var t=Date.now(),e=Ee;e;)t>=e.t&&e.c(t-e.t)&&(e.c=null),e=e.n;return t}function Ae(){for(var t,e=Ee,n=1/0;e;)e.c?(e.t<n&&(n=e.t),e=(t=e).n):e=t?t.n=e.n:Ee=e.n;return Se=t,n}function xe(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}i.timer=function(){Me.apply(this,arguments)},i.timer.flush=function(){Ne(),Ae()},i.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var je=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(function(t,e){var n=Math.pow(10,3*O(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}});function Ie(t){var e=t.decimal,n=t.thousands,r=t.grouping,o=t.currency,a=r&&n?function(t,e){for(var o=t.length,i=[],a=0,s=r[0],l=0;o>0&&s>0&&(l+s+1>e&&(s=Math.max(1,e-l)),i.push(t.substring(o-=s,o+s)),!((l+=s+1)>e));)s=r[a=(a+1)%r.length];return i.reverse().join(n)}:D;return function(t){var n=De.exec(t),r=n[1]||" ",s=n[2]||">",l=n[3]||"-",u=n[4]||"",c=n[5],f=+n[6],h=n[7],d=n[8],p=n[9],g=1,v="",y="",m=!1,b=!0;switch(d&&(d=+d.substring(1)),(c||"0"===r&&"="===s)&&(c=r="0",s="="),p){case"n":h=!0,p="g";break;case"%":g=100,y="%",p="f";break;case"p":g=100,y="%",p="r";break;case"b":case"o":case"x":case"X":"#"===u&&(v="0"+p.toLowerCase());case"c":b=!1;case"d":m=!0,d=0;break;case"s":g=-1,p="r"}"$"===u&&(v=o[0],y=o[1]),"r"!=p||d||(p="g"),null!=d&&("g"==p?d=Math.max(1,Math.min(21,d)):"e"!=p&&"f"!=p||(d=Math.max(0,Math.min(20,d)))),p=Pe.get(p)||Le;var w=c&&h;return function(t){var n=y;if(m&&t%1)return"";var o=t<0||0===t&&1/t<0?(t=-t,"-"):"-"===l?"":l;if(g<0){var u=i.formatPrefix(t,d);t=u.scale(t),n=u.symbol+y}else t*=g;var C,O,E=(t=p(t,d)).lastIndexOf(".");if(E<0){var S=b?t.lastIndexOf("e"):-1;S<0?(C=t,O=""):(C=t.substring(0,S),O=t.substring(S))}else C=t.substring(0,E),O=e+t.substring(E+1);!c&&h&&(C=a(C,1/0));var k=v.length+C.length+O.length+(w?0:o.length),R=k<f?new Array(k=f-k+1).join(r):"";return w&&(C=a(R+C,R.length?f-O.length:1/0)),o+=v,t=C+O,("<"===s?o+t+R:">"===s?R+o+t:"^"===s?R.substring(0,k>>=1)+o+t+R.substring(k):o+(w?t:R+t))+n}}}i.formatPrefix=function(t,e){var n=0;return(t=+t)&&(t<0&&(t*=-1),e&&(t=i.round(t,xe(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),je[8+n/3]};var De=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Pe=i.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=i.round(t,xe(t,e))).toFixed(Math.max(0,Math.min(20,xe(t*(1+1e-15),e))))}});function Le(t){return t+""}var He=i.time={},Fe=Date;function Be(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}Be.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){We.setUTCDate.apply(this._,arguments)},setDay:function(){We.setUTCDay.apply(this._,arguments)},setFullYear:function(){We.setUTCFullYear.apply(this._,arguments)},setHours:function(){We.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){We.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){We.setUTCMinutes.apply(this._,arguments)},setMonth:function(){We.setUTCMonth.apply(this._,arguments)},setSeconds:function(){We.setUTCSeconds.apply(this._,arguments)},setTime:function(){We.setTime.apply(this._,arguments)}};var We=Date.prototype;function Ve(t,e,n){function r(e){var n=t(e),r=i(n,1);return e-n<r-e?n:r}function o(n){return e(n=t(new Fe(n-1)),1),n}function i(t,n){return e(t=new Fe(+t),n),t}function a(t,r,i){var a=o(t),s=[];if(i>1)for(;a<r;)n(a)%i||s.push(new Date(+a)),e(a,1);else for(;a<r;)s.push(new Date(+a)),e(a,1);return s}t.floor=t,t.round=r,t.ceil=o,t.offset=i,t.range=a;var s=t.utc=Ue(t);return s.floor=s,s.round=Ue(r),s.ceil=Ue(o),s.offset=Ue(i),s.range=function(t,e,n){try{Fe=Be;var r=new Be;return r._=t,a(r,e,n)}finally{Fe=Date}},t}function Ue(t){return function(e,n){try{Fe=Be;var r=new Be;return r._=e,t(r,n)._}finally{Fe=Date}}}function Ye(t){var e=t.dateTime,n=t.date,r=t.time,o=t.periods,a=t.days,s=t.shortDays,l=t.months,u=t.shortMonths;function c(t){var e=t.length;function n(n){for(var r,o,i,a=[],s=-1,l=0;++s<e;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(o=ze[r=t.charAt(++s)])&&(r=t.charAt(++s)),(i=C[r])&&(r=i(n,null==o?"e"===r?" ":"0":o)),a.push(r),l=s+1);return a.push(t.slice(l,s)),a.join("")}return n.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(f(n,t,e,0)!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var r=null!=n.Z&&Fe!==Be,o=new(r?Be:Fe);return"j"in n?o.setFullYear(n.y,0,n.j):"W"in n||"U"in n?("w"in n||(n.w="W"in n?1:0),o.setFullYear(n.y,0,1),o.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(o.getDay()+5)%7:n.w+7*n.U-(o.getDay()+6)%7)):o.setFullYear(n.y,n.m,n.d),o.setHours(n.H+(n.Z/100|0),n.M+n.Z%100,n.S,n.L),r?o._:o},n.toString=function(){return t},n}function f(t,e,n,r){for(var o,i,a,s=0,l=e.length,u=n.length;s<l;){if(r>=u)return-1;if(37===(o=e.charCodeAt(s++))){if(a=e.charAt(s++),!(i=O[a in ze?e.charAt(s++):a])||(r=i(t,n,r))<0)return-1}else if(o!=n.charCodeAt(r++))return-1}return r}c.utc=function(t){var e=c(t);function n(t){try{var n=new(Fe=Be);return n._=t,e(n)}finally{Fe=Date}}return n.parse=function(t){try{Fe=Be;var n=e.parse(t);return n&&n._}finally{Fe=Date}},n.toString=e.toString,n},c.multi=c.utc.multi=dn;var h=i.map(),d=Ke(a),p=$e(a),g=Ke(s),v=$e(s),y=Ke(l),m=$e(l),b=Ke(u),w=$e(u);o.forEach(function(t,e){h.set(t.toLowerCase(),e)});var C={a:function(t){return s[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return l[t.getMonth()]},c:c(e),d:function(t,e){return qe(t.getDate(),e,2)},e:function(t,e){return qe(t.getDate(),e,2)},H:function(t,e){return qe(t.getHours(),e,2)},I:function(t,e){return qe(t.getHours()%12||12,e,2)},j:function(t,e){return qe(1+He.dayOfYear(t),e,3)},L:function(t,e){return qe(t.getMilliseconds(),e,3)},m:function(t,e){return qe(t.getMonth()+1,e,2)},M:function(t,e){return qe(t.getMinutes(),e,2)},p:function(t){return o[+(t.getHours()>=12)]},S:function(t,e){return qe(t.getSeconds(),e,2)},U:function(t,e){return qe(He.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return qe(He.mondayOfYear(t),e,2)},x:c(n),X:c(r),y:function(t,e){return qe(t.getFullYear()%100,e,2)},Y:function(t,e){return qe(t.getFullYear()%1e4,e,4)},Z:fn,"%":function(){return"%"}},O={a:function(t,e,n){g.lastIndex=0;var r=g.exec(e.slice(n));return r?(t.w=v.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){d.lastIndex=0;var r=d.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){b.lastIndex=0;var r=b.exec(e.slice(n));return r?(t.m=w.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){y.lastIndex=0;var r=y.exec(e.slice(n));return r?(t.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,e,n){return f(t,C.c.toString(),e,n)},d:on,e:on,H:sn,I:sn,j:an,L:cn,m:rn,M:ln,p:function(t,e,n){var r=h.get(e.slice(n,n+=2).toLowerCase());return null==r?-1:(t.p=r,n)},S:un,U:Qe,w:Ze,W:Je,x:function(t,e,n){return f(t,C.x.toString(),e,n)},X:function(t,e,n){return f(t,C.X.toString(),e,n)},y:en,Y:tn,Z:nn,"%":hn};return c}He.year=Ve(function(t){return(t=He.day(t)).setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),He.years=He.year.range,He.years.utc=He.year.utc.range,He.day=Ve(function(t){var e=new Fe(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),He.days=He.day.range,He.days.utc=He.day.utc.range,He.dayOfYear=function(t){var e=He.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=He[t]=Ve(function(t){return(t=He.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=He.year(t).getDay();return Math.floor((He.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});He[t+"s"]=n.range,He[t+"s"].utc=n.utc.range,He[t+"OfYear"]=function(t){var n=He.year(t).getDay();return Math.floor((He.dayOfYear(t)+(n+e)%7)/7)}}),He.week=He.sunday,He.weeks=He.sunday.range,He.weeks.utc=He.sunday.utc.range,He.weekOfYear=He.sundayOfYear;var ze={"-":"",_:" ",0:"0"},Ge=/^\s*\d+/,Xe=/^%/;function qe(t,e,n){var r=t<0?"-":"",o=(r?-t:t)+"",i=o.length;return r+(i<n?new Array(n-i+1).join(e)+o:o)}function Ke(t){return new RegExp("^(?:"+t.map(i.requote).join("|")+")","i")}function $e(t){for(var e=new S,n=-1,r=t.length;++n<r;)e.set(t[n].toLowerCase(),n);return e}function Ze(t,e,n){Ge.lastIndex=0;var r=Ge.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Qe(t,e,n){Ge.lastIndex=0;var r=Ge.exec(e.slice(n));return r?(t.U=+r[0],n+r[0].length):-1}function Je(t,e,n){Ge.lastIndex=0;var r=Ge.exec(e.slice(n));return r?(t.W=+r[0],n+r[0].length):-1}function tn(t,e,n){Ge.lastIndex=0;var r=Ge.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function en(t,e,n){Ge.lastIndex=0;var r,o=Ge.exec(e.slice(n,n+2));return o?(t.y=(r=+o[0])+(r>68?1900:2e3),n+o[0].length):-1}function nn(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function rn(t,e,n){Ge.lastIndex=0;var r=Ge.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function on(t,e,n){Ge.lastIndex=0;var r=Ge.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function an(t,e,n){Ge.lastIndex=0;var r=Ge.exec(e.slice(n,n+3));return r?(t.j=+r[0],n+r[0].length):-1}function sn(t,e,n){Ge.lastIndex=0;var r=Ge.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function ln(t,e,n){Ge.lastIndex=0;var r=Ge.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function un(t,e,n){Ge.lastIndex=0;var r=Ge.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function cn(t,e,n){Ge.lastIndex=0;var r=Ge.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function fn(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",r=O(e)/60|0,o=O(e)%60;return n+qe(r,"0",2)+qe(o,"0",2)}function hn(t,e,n){Xe.lastIndex=0;var r=Xe.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function dn(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,r=t[n];!r[1](e);)r=t[++n];return r[0](e)}}i.locale=function(t){return{numberFormat:Ie(t),timeFormat:Ye(t)}};var pn=i.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function gn(){}i.format=pn.numberFormat,i.geo={},gn.prototype={s:0,t:0,add:function(t){yn(t,this.t,vn),yn(vn.s,this.s,this),this.s?this.t+=vn.t:this.s=vn.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var vn=new gn;function yn(t,e,n){var r=n.s=t+e,o=r-t,i=r-o;n.t=t-i+(e-o)}function mn(t,e){t&&wn.hasOwnProperty(t.type)&&wn[t.type](t,e)}i.geo.stream=function(t,e){t&&bn.hasOwnProperty(t.type)?bn[t.type](t,e):mn(t,e)};var bn={Feature:function(t,e){mn(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,o=n.length;++r<o;)mn(n[r].geometry,e)}},wn={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){Cn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)Cn(n[r],e,0)},Polygon:function(t,e){On(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)On(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,o=n.length;++r<o;)mn(n[r],e)}};function Cn(t,e,n){var r,o=-1,i=t.length-n;for(e.lineStart();++o<i;)r=t[o],e.point(r[0],r[1],r[2]);e.lineEnd()}function On(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)Cn(t[n],e,1);e.polygonEnd()}i.geo.area=function(t){return En=0,i.geo.stream(t,Pn),En};var En,Sn,kn,Rn,Tn,Mn,_n,Nn,An,xn,jn,In,Dn=new gn,Pn={sphere:function(){En+=4*_t},point:F,lineStart:F,lineEnd:F,polygonStart:function(){Dn.reset(),Pn.lineStart=Ln},polygonEnd:function(){var t=2*Dn;En+=t<0?4*_t+t:t,Pn.lineStart=Pn.lineEnd=Pn.point=F}};function Ln(){var t,e,n,r,o;function i(t,e){e=e*jt/2+_t/4;var i=(t*=jt)-n,a=i>=0?1:-1,s=a*i,l=Math.cos(e),u=Math.sin(e),c=o*u,f=r*l+c*Math.cos(s),h=c*a*Math.sin(s);Dn.add(Math.atan2(h,f)),n=t,r=l,o=u}Pn.point=function(a,s){Pn.point=i,n=(t=a)*jt,r=Math.cos(s=(e=s)*jt/2+_t/4),o=Math.sin(s)},Pn.lineEnd=function(){i(t,e)}}function Hn(t){var e=t[0],n=t[1],r=Math.cos(n);return[r*Math.cos(e),r*Math.sin(e),Math.sin(n)]}function Fn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Bn(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Wn(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Vn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Un(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Yn(t){return[Math.atan2(t[1],t[0]),Ht(t[2])]}function zn(t,e){return O(t[0]-e[0])<Tt&&O(t[1]-e[1])<Tt}i.geo.bounds=function(){var t,e,n,r,o,a,s,l,u,c,f,h={point:d,lineStart:g,lineEnd:v,polygonStart:function(){h.point=y,h.lineStart=m,h.lineEnd=b,u=0,Pn.polygonStart()},polygonEnd:function(){Pn.polygonEnd(),h.point=d,h.lineStart=g,h.lineEnd=v,Dn<0?(t=-(n=180),e=-(r=90)):u>Tt?r=90:u<-Tt&&(e=-90),f[0]=t,f[1]=n}};function d(o,i){c.push(f=[t=o,n=o]),i<e&&(e=i),i>r&&(r=i)}function p(i,a){var s=Hn([i*jt,a*jt]);if(l){var u=Bn(l,s),c=Bn([u[1],-u[0],0],u);Un(c),c=Yn(c);var f=i-o,h=f>0?1:-1,p=c[0]*It*h,g=O(f)>180;if(g^(h*o<p&&p<h*i))(v=c[1]*It)>r&&(r=v);else if(g^(h*o<(p=(p+360)%360-180)&&p<h*i)){var v;(v=-c[1]*It)<e&&(e=v)}else a<e&&(e=a),a>r&&(r=a);g?i<o?w(t,i)>w(t,n)&&(n=i):w(i,n)>w(t,n)&&(t=i):n>=t?(i<t&&(t=i),i>n&&(n=i)):i>o?w(t,i)>w(t,n)&&(n=i):w(i,n)>w(t,n)&&(t=i)}else d(i,a);l=s,o=i}function g(){h.point=p}function v(){f[0]=t,f[1]=n,h.point=d,l=null}function y(t,e){if(l){var n=t-o;u+=O(n)>180?n+(n>0?360:-360):n}else a=t,s=e;Pn.point(t,e),p(t,e)}function m(){Pn.lineStart()}function b(){y(a,s),Pn.lineEnd(),O(u)>Tt&&(t=-(n=180)),f[0]=t,f[1]=n,l=null}function w(t,e){return(e-=t)<0?e+360:e}function C(t,e){return t[0]-e[0]}function E(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}return function(o){if(r=n=-(t=e=1/0),c=[],i.geo.stream(o,h),u=c.length){c.sort(C);for(var a=1,s=[g=c[0]];a<u;++a)E((d=c[a])[0],g)||E(d[1],g)?(w(g[0],d[1])>w(g[0],g[1])&&(g[1]=d[1]),w(d[0],g[1])>w(g[0],g[1])&&(g[0]=d[0])):s.push(g=d);for(var l,u,d,p=-1/0,g=(a=0,s[u=s.length-1]);a<=u;g=d,++a)d=s[a],(l=w(g[1],d[0]))>p&&(p=l,t=d[0],n=g[1])}return c=f=null,t===1/0||e===1/0?[[NaN,NaN],[NaN,NaN]]:[[t,e],[n,r]]}}(),i.geo.centroid=function(t){Sn=kn=Rn=Tn=Mn=_n=Nn=An=xn=jn=In=0,i.geo.stream(t,Gn);var e=xn,n=jn,r=In,o=e*e+n*n+r*r;return o<Mt&&(e=_n,n=Nn,r=An,kn<Tt&&(e=Rn,n=Tn,r=Mn),(o=e*e+n*n+r*r)<Mt)?[NaN,NaN]:[Math.atan2(n,e)*It,Ht(r/Math.sqrt(o))*It]};var Gn={sphere:F,point:Xn,lineStart:Kn,lineEnd:$n,polygonStart:function(){Gn.lineStart=Zn},polygonEnd:function(){Gn.lineStart=Kn}};function Xn(t,e){t*=jt;var n=Math.cos(e*=jt);qn(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function qn(t,e,n){Rn+=(t-Rn)/++Sn,Tn+=(e-Tn)/Sn,Mn+=(n-Mn)/Sn}function Kn(){var t,e,n;function r(r,o){r*=jt;var i=Math.cos(o*=jt),a=i*Math.cos(r),s=i*Math.sin(r),l=Math.sin(o),u=Math.atan2(Math.sqrt((u=e*l-n*s)*u+(u=n*a-t*l)*u+(u=t*s-e*a)*u),t*a+e*s+n*l);kn+=u,_n+=u*(t+(t=a)),Nn+=u*(e+(e=s)),An+=u*(n+(n=l)),qn(t,e,n)}Gn.point=function(o,i){o*=jt;var a=Math.cos(i*=jt);t=a*Math.cos(o),e=a*Math.sin(o),n=Math.sin(i),Gn.point=r,qn(t,e,n)}}function $n(){Gn.point=Xn}function Zn(){var t,e,n,r,o;function i(t,e){t*=jt;var i=Math.cos(e*=jt),a=i*Math.cos(t),s=i*Math.sin(t),l=Math.sin(e),u=r*l-o*s,c=o*a-n*l,f=n*s-r*a,h=Math.sqrt(u*u+c*c+f*f),d=n*a+r*s+o*l,p=h&&-Lt(d)/h,g=Math.atan2(h,d);xn+=p*u,jn+=p*c,In+=p*f,kn+=g,_n+=g*(n+(n=a)),Nn+=g*(r+(r=s)),An+=g*(o+(o=l)),qn(n,r,o)}Gn.point=function(a,s){t=a,e=s,Gn.point=i,a*=jt;var l=Math.cos(s*=jt);n=l*Math.cos(a),r=l*Math.sin(a),o=Math.sin(s),qn(n,r,o)},Gn.lineEnd=function(){i(t,e),Gn.lineEnd=$n,Gn.point=Xn}}function Qn(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function Jn(){return!0}function tr(t,e,n,r,o){var i=[],a=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],r=t[e];if(zn(n,r)){o.lineStart();for(var s=0;s<e;++s)o.point((n=t[s])[0],n[1]);o.lineEnd()}else{var l=new nr(n,t,null,!0),u=new nr(n,null,l,!1);l.o=u,i.push(l),a.push(u),l=new nr(r,t,null,!1),u=new nr(r,null,l,!0),l.o=u,i.push(l),a.push(u)}}}),a.sort(e),er(i),er(a),i.length){for(var s=0,l=n,u=a.length;s<u;++s)a[s].e=l=!l;for(var c,f,h=i[0];;){for(var d=h,p=!0;d.v;)if((d=d.n)===h)return;c=d.z,o.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(s=0,u=c.length;s<u;++s)o.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,o);d=d.n}else{if(p)for(s=(c=d.p.z).length-1;s>=0;--s)o.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,o);d=d.p}c=(d=d.o).z,p=!p}while(!d.v);o.lineEnd()}}}function er(t){if(e=t.length){for(var e,n,r=0,o=t[0];++r<e;)o.n=n=t[r],n.p=o,o=n;o.n=n=t[0],n.p=o}}function nr(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function rr(t,e,n,r){return function(o,a){var s,l=e(a),u=o.invert(r[0],r[1]),c={point:f,lineStart:d,lineEnd:p,polygonStart:function(){c.point=w,c.lineStart=C,c.lineEnd=O,s=[],g=[]},polygonEnd:function(){c.point=f,c.lineStart=d,c.lineEnd=p,s=i.merge(s);var t=function(t,e){var n=t[0],r=t[1],o=[Math.sin(n),-Math.cos(n),0],i=0,a=0;Dn.reset();for(var s=0,l=e.length;s<l;++s){var u=e[s],c=u.length;if(c)for(var f=u[0],h=f[0],d=f[1]/2+_t/4,p=Math.sin(d),g=Math.cos(d),v=1;;){v===c&&(v=0);var y=(t=u[v])[0],m=t[1]/2+_t/4,b=Math.sin(m),w=Math.cos(m),C=y-h,O=C>=0?1:-1,E=O*C,S=E>_t,k=p*b;if(Dn.add(Math.atan2(k*O*Math.sin(E),g*w+k*Math.cos(E))),i+=S?C+O*Nt:C,S^h>=n^y>=n){var R=Bn(Hn(f),Hn(t));Un(R);var T=Bn(o,R);Un(T);var M=(S^C>=0?-1:1)*Ht(T[2]);(r>M||r===M&&(R[0]||R[1]))&&(a+=S^C>=0?1:-1)}if(!v++)break;h=y,p=b,g=w,f=t}}return(i<-Tt||i<Tt&&Dn<-Tt)^1&a}(u,g);s.length?(b||(a.polygonStart(),b=!0),tr(s,ar,t,n,a)):t&&(b||(a.polygonStart(),b=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),b&&(a.polygonEnd(),b=!1),s=g=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function f(e,n){var r=o(e,n);t(e=r[0],n=r[1])&&a.point(e,n)}function h(t,e){var n=o(t,e);l.point(n[0],n[1])}function d(){c.point=h,l.lineStart()}function p(){c.point=f,l.lineEnd()}var g,v,y=ir(),m=e(y),b=!1;function w(t,e){v.push([t,e]);var n=o(t,e);m.point(n[0],n[1])}function C(){m.lineStart(),v=[]}function O(){w(v[0][0],v[0][1]),m.lineEnd();var t,e=m.clean(),n=y.buffer(),r=n.length;if(v.pop(),g.push(v),v=null,r)if(1&e){var o,i=-1;if((r=(t=n[0]).length-1)>0){for(b||(a.polygonStart(),b=!0),a.lineStart();++i<r;)a.point((o=t[i])[0],o[1]);a.lineEnd()}}else r>1&&2&e&&n.push(n.pop().concat(n.shift())),s.push(n.filter(or))}return c}}function or(t){return t.length>1}function ir(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:F,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function ar(t,e){return((t=t.x)[0]<0?t[1]-xt-Tt:xt-t[1])-((e=e.x)[0]<0?e[1]-xt-Tt:xt-e[1])}var sr=rr(Jn,function(t){var e,n=NaN,r=NaN,o=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(i,a){var s=i>0?_t:-_t,l=O(i-n);O(l-_t)<Tt?(t.point(n,r=(r+a)/2>0?xt:-xt),t.point(o,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(i,r),e=0):o!==s&&l>=_t&&(O(n-o)<Tt&&(n-=o*Tt),O(i-s)<Tt&&(i-=s*Tt),r=function(t,e,n,r){var o,i,a=Math.sin(t-n);return O(a)>Tt?Math.atan((Math.sin(e)*(i=Math.cos(r))*Math.sin(n)-Math.sin(r)*(o=Math.cos(e))*Math.sin(t))/(o*i*a)):(e+r)/2}(n,r,i,a),t.point(o,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=i,r=a),o=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}},function(t,e,n,r){var o;if(null==t)o=n*xt,r.point(-_t,o),r.point(0,o),r.point(_t,o),r.point(_t,0),r.point(_t,-o),r.point(0,-o),r.point(-_t,-o),r.point(-_t,0),r.point(-_t,o);else if(O(t[0]-e[0])>Tt){var i=t[0]<e[0]?_t:-_t;o=n*i/2,r.point(-i,o),r.point(0,o),r.point(i,o)}else r.point(e[0],e[1])},[-_t,-_t/2]);function lr(t,e,n,r){return function(o){var i,a=o.a,s=o.b,l=a.x,u=a.y,c=0,f=1,h=s.x-l,d=s.y-u;if(i=t-l,h||!(i>0)){if(i/=h,h<0){if(i<c)return;i<f&&(f=i)}else if(h>0){if(i>f)return;i>c&&(c=i)}if(i=n-l,h||!(i<0)){if(i/=h,h<0){if(i>f)return;i>c&&(c=i)}else if(h>0){if(i<c)return;i<f&&(f=i)}if(i=e-u,d||!(i>0)){if(i/=d,d<0){if(i<c)return;i<f&&(f=i)}else if(d>0){if(i>f)return;i>c&&(c=i)}if(i=r-u,d||!(i<0)){if(i/=d,d<0){if(i>f)return;i>c&&(c=i)}else if(d>0){if(i<c)return;i<f&&(f=i)}return c>0&&(o.a={x:l+c*h,y:u+c*d}),f<1&&(o.b={x:l+f*h,y:u+f*d}),o}}}}}}var ur=1e9;function cr(t,e,n,r){return function(l){var u,c,f,h,d,p,g,v,y,m,b,w=l,C=ir(),O=lr(t,e,n,r),E={point:R,lineStart:function(){E.point=T,c&&c.push(f=[]);m=!0,y=!1,g=v=NaN},lineEnd:function(){u&&(T(h,d),p&&y&&C.rejoin(),u.push(C.buffer()));E.point=R,y&&l.lineEnd()},polygonStart:function(){l=C,u=[],c=[],b=!0},polygonEnd:function(){l=w,u=i.merge(u);var e=function(t){for(var e=0,n=c.length,r=t[1],o=0;o<n;++o)for(var i,a=1,s=c[o],l=s.length,u=s[0];a<l;++a)i=s[a],u[1]<=r?i[1]>r&&Pt(u,i,t)>0&&++e:i[1]<=r&&Pt(u,i,t)<0&&--e,u=i;return 0!==e}([t,r]),n=b&&e,o=u.length;(n||o)&&(l.polygonStart(),n&&(l.lineStart(),S(null,null,1,l),l.lineEnd()),o&&tr(u,a,e,S,l),l.polygonEnd()),u=c=f=null}};function S(i,a,l,u){var c=0,f=0;if(null==i||(c=o(i,l))!==(f=o(a,l))||s(i,a)<0^l>0)do{u.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+l+4)%4)!==f);else u.point(a[0],a[1])}function k(o,i){return t<=o&&o<=n&&e<=i&&i<=r}function R(t,e){k(t,e)&&l.point(t,e)}function T(t,e){var n=k(t=Math.max(-ur,Math.min(ur,t)),e=Math.max(-ur,Math.min(ur,e)));if(c&&f.push([t,e]),m)h=t,d=e,p=n,m=!1,n&&(l.lineStart(),l.point(t,e));else if(n&&y)l.point(t,e);else{var r={a:{x:g,y:v},b:{x:t,y:e}};O(r)?(y||(l.lineStart(),l.point(r.a.x,r.a.y)),l.point(r.b.x,r.b.y),n||l.lineEnd(),b=!1):n&&(l.lineStart(),l.point(t,e),b=!1)}g=t,v=e,y=n}return E};function o(r,o){return O(r[0]-t)<Tt?o>0?0:3:O(r[0]-n)<Tt?o>0?2:1:O(r[1]-e)<Tt?o>0?1:0:o>0?3:2}function a(t,e){return s(t.x,e.x)}function s(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}}function fr(t){var e=0,n=_t/3,r=Dr(t),o=r(e,n);return o.parallels=function(t){return arguments.length?r(e=t[0]*_t/180,n=t[1]*_t/180):[e/_t*180,n/_t*180]},o}function hr(t,e){var n=Math.sin(t),r=(n+Math.sin(e))/2,o=1+n*(2*r-n),i=Math.sqrt(o)/r;function a(t,e){var n=Math.sqrt(o-2*r*Math.sin(e))/r;return[n*Math.sin(t*=r),i-n*Math.cos(t)]}return a.invert=function(t,e){var n=i-e;return[Math.atan2(t,n)/r,Ht((o-(t*t+n*n)*r*r)/(2*r))]},a}i.geo.clipExtent=function(){var t,e,n,r,o,i,a={stream:function(t){return o&&(o.valid=!1),(o=i(t)).valid=!0,o},extent:function(s){return arguments.length?(i=cr(t=+s[0][0],e=+s[0][1],n=+s[1][0],r=+s[1][1]),o&&(o.valid=!1,o=null),a):[[t,e],[n,r]]}};return a.extent([[0,0],[960,500]])},(i.geo.conicEqualArea=function(){return fr(hr)}).raw=hr,i.geo.albers=function(){return i.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},i.geo.albersUsa=function(){var t,e,n,r,o=i.geo.albers(),a=i.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=i.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,n){t=[e,n]}};function u(o){var i=o[0],a=o[1];return t=null,e(i,a),t||(n(i,a),t)||r(i,a),t}return u.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?a:i>=.166&&i<.234&&r>=-.214&&r<-.115?s:o).invert(t)},u.stream=function(t){var e=o.stream(t),n=a.stream(t),r=s.stream(t);return{point:function(t,o){e.point(t,o),n.point(t,o),r.point(t,o)},sphere:function(){e.sphere(),n.sphere(),r.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),r.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),r.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),r.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),r.polygonEnd()}}},u.precision=function(t){return arguments.length?(o.precision(t),a.precision(t),s.precision(t),u):o.precision()},u.scale=function(t){return arguments.length?(o.scale(t),a.scale(.35*t),s.scale(t),u.translate(o.translate())):o.scale()},u.translate=function(t){if(!arguments.length)return o.translate();var i=o.scale(),c=+t[0],f=+t[1];return e=o.translate(t).clipExtent([[c-.455*i,f-.238*i],[c+.455*i,f+.238*i]]).stream(l).point,n=a.translate([c-.307*i,f+.201*i]).clipExtent([[c-.425*i+Tt,f+.12*i+Tt],[c-.214*i-Tt,f+.234*i-Tt]]).stream(l).point,r=s.translate([c-.205*i,f+.212*i]).clipExtent([[c-.214*i+Tt,f+.166*i+Tt],[c-.115*i-Tt,f+.234*i-Tt]]).stream(l).point,u},u.scale(1070)};var dr,pr,gr,vr,yr,mr,br={point:F,lineStart:F,lineEnd:F,polygonStart:function(){pr=0,br.lineStart=wr},polygonEnd:function(){br.lineStart=br.lineEnd=br.point=F,dr+=O(pr/2)}};function wr(){var t,e,n,r;function o(t,e){pr+=r*t-n*e,n=t,r=e}br.point=function(i,a){br.point=o,t=n=i,e=r=a},br.lineEnd=function(){o(t,e)}}var Cr={point:function(t,e){t<gr&&(gr=t);t>yr&&(yr=t);e<vr&&(vr=e);e>mr&&(mr=e)},lineStart:F,lineEnd:F,polygonStart:F,polygonEnd:F};function Or(){var t=Er(4.5),e=[],n={point:r,lineStart:function(){n.point=o},lineEnd:a,polygonStart:function(){n.lineEnd=s},polygonEnd:function(){n.lineEnd=a,n.point=r},pointRadius:function(e){return t=Er(e),n},result:function(){if(e.length){var t=e.join("");return e=[],t}}};function r(n,r){e.push("M",n,",",r,t)}function o(t,r){e.push("M",t,",",r),n.point=i}function i(t,n){e.push("L",t,",",n)}function a(){n.point=r}function s(){e.push("Z")}return n}function Er(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}var Sr,kr={point:Rr,lineStart:Tr,lineEnd:Mr,polygonStart:function(){kr.lineStart=_r},polygonEnd:function(){kr.point=Rr,kr.lineStart=Tr,kr.lineEnd=Mr}};function Rr(t,e){Rn+=t,Tn+=e,++Mn}function Tr(){var t,e;function n(n,r){var o=n-t,i=r-e,a=Math.sqrt(o*o+i*i);_n+=a*(t+n)/2,Nn+=a*(e+r)/2,An+=a,Rr(t=n,e=r)}kr.point=function(r,o){kr.point=n,Rr(t=r,e=o)}}function Mr(){kr.point=Rr}function _r(){var t,e,n,r;function o(t,e){var o=t-n,i=e-r,a=Math.sqrt(o*o+i*i);_n+=a*(n+t)/2,Nn+=a*(r+e)/2,An+=a,xn+=(a=r*t-n*e)*(n+t),jn+=a*(r+e),In+=3*a,Rr(n=t,r=e)}kr.point=function(i,a){kr.point=o,Rr(t=n=i,e=r=a)},kr.lineEnd=function(){o(t,e)}}function Nr(t){var e=4.5,n={point:r,lineStart:function(){n.point=o},lineEnd:a,polygonStart:function(){n.lineEnd=s},polygonEnd:function(){n.lineEnd=a,n.point=r},pointRadius:function(t){return e=t,n},result:F};function r(n,r){t.moveTo(n+e,r),t.arc(n,r,e,0,Nt)}function o(e,r){t.moveTo(e,r),n.point=i}function i(e,n){t.lineTo(e,n)}function a(){n.point=r}function s(){t.closePath()}return n}function Ar(t){var e=.5,n=Math.cos(30*jt),r=16;function o(e){return(r?function(e){var n,o,a,s,l,u,c,f,h,d,p,g,v={point:y,lineStart:m,lineEnd:w,polygonStart:function(){e.polygonStart(),v.lineStart=C},polygonEnd:function(){e.polygonEnd(),v.lineStart=m}};function y(n,r){n=t(n,r),e.point(n[0],n[1])}function m(){f=NaN,v.point=b,e.lineStart()}function b(n,o){var a=Hn([n,o]),s=t(n,o);i(f,h,c,d,p,g,f=s[0],h=s[1],c=n,d=a[0],p=a[1],g=a[2],r,e),e.point(f,h)}function w(){v.point=y,e.lineEnd()}function C(){m(),v.point=O,v.lineEnd=E}function O(t,e){b(n=t,e),o=f,a=h,s=d,l=p,u=g,v.point=b}function E(){i(f,h,c,d,p,g,o,a,n,s,l,u,r,e),v.lineEnd=w,w()}return v}:function(e){return jr(e,function(n,r){n=t(n,r),e.point(n[0],n[1])})})(e)}function i(r,o,a,s,l,u,c,f,h,d,p,g,v,y){var m=c-r,b=f-o,w=m*m+b*b;if(w>4*e&&v--){var C=s+d,E=l+p,S=u+g,k=Math.sqrt(C*C+E*E+S*S),R=Math.asin(S/=k),T=O(O(S)-1)<Tt||O(a-h)<Tt?(a+h)/2:Math.atan2(E,C),M=t(T,R),_=M[0],N=M[1],A=_-r,x=N-o,j=b*A-m*x;(j*j/w>e||O((m*A+b*x)/w-.5)>.3||s*d+l*p+u*g<n)&&(i(r,o,a,s,l,u,_,N,T,C/=k,E/=k,S,v,y),y.point(_,N),i(_,N,T,C,E,S,c,f,h,d,p,g,v,y))}}return o.precision=function(t){return arguments.length?(r=(e=t*t)>0&&16,o):Math.sqrt(e)},o}function xr(t){this.stream=t}function jr(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function Ir(t){return Dr(function(){return t})()}function Dr(t){var e,n,r,o,a,s,l=Ar(function(t,n){return[(t=e(t,n))[0]*u+o,a-t[1]*u]}),u=150,c=480,f=250,h=0,d=0,p=0,g=0,v=0,y=sr,m=D,b=null,w=null;function C(t){return[(t=r(t[0]*jt,t[1]*jt))[0]*u+o,a-t[1]*u]}function E(t){return(t=r.invert((t[0]-o)/u,(a-t[1])/u))&&[t[0]*It,t[1]*It]}function S(){r=Qn(n=Fr(p,g,v),e);var t=e(h,d);return o=c-t[0]*u,a=f+t[1]*u,k()}function k(){return s&&(s.valid=!1,s=null),C}return C.stream=function(t){return s&&(s.valid=!1),(s=Pr(y(n,l(m(t))))).valid=!0,s},C.clipAngle=function(t){return arguments.length?(y=null==t?(b=t,sr):function(t){var e=Math.cos(t),n=e>0,r=O(e)>Tt;return rr(o,function(t){var e,s,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(f,h){var d,p=[f,h],g=o(f,h),v=n?g?0:a(f,h):g?a(f+(f<0?_t:-_t),h):0;if(!e&&(u=l=g)&&t.lineStart(),g!==l&&(d=i(e,p),(zn(e,d)||zn(p,d))&&(p[0]+=Tt,p[1]+=Tt,g=o(p[0],p[1]))),g!==l)c=0,g?(t.lineStart(),d=i(p,e),t.point(d[0],d[1])):(d=i(e,p),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(r&&e&&n^g){var y;v&s||!(y=i(p,e,!0))||(c=0,n?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!g||e&&zn(e,p)||t.point(p[0],p[1]),e=p,l=g,s=v},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}},Ur(t,6*jt),n?[0,-t]:[-_t,t-_t]);function o(t,n){return Math.cos(t)*Math.cos(n)>e}function i(t,n,r){var o=[1,0,0],i=Bn(Hn(t),Hn(n)),a=Fn(i,i),s=i[0],l=a-s*s;if(!l)return!r&&t;var u=e*a/l,c=-e*s/l,f=Bn(o,i),h=Vn(o,u);Wn(h,Vn(i,c));var d=f,p=Fn(h,d),g=Fn(d,d),v=p*p-g*(Fn(h,h)-1);if(!(v<0)){var y=Math.sqrt(v),m=Vn(d,(-p-y)/g);if(Wn(m,h),m=Yn(m),!r)return m;var b,w=t[0],C=n[0],E=t[1],S=n[1];C<w&&(b=w,w=C,C=b);var k=C-w,R=O(k-_t)<Tt;if(!R&&S<E&&(b=E,E=S,S=b),R||k<Tt?R?E+S>0^m[1]<(O(m[0]-w)<Tt?E:S):E<=m[1]&&m[1]<=S:k>_t^(w<=m[0]&&m[0]<=C)){var T=Vn(d,(-p+y)/g);return Wn(T,h),[m,Yn(T)]}}}function a(e,r){var o=n?t:_t-t,i=0;return e<-o?i|=1:e>o&&(i|=2),r<-o?i|=4:r>o&&(i|=8),i}}((b=+t)*jt),k()):b},C.clipExtent=function(t){return arguments.length?(w=t,m=t?cr(t[0][0],t[0][1],t[1][0],t[1][1]):D,k()):w},C.scale=function(t){return arguments.length?(u=+t,S()):u},C.translate=function(t){return arguments.length?(c=+t[0],f=+t[1],S()):[c,f]},C.center=function(t){return arguments.length?(h=t[0]%360*jt,d=t[1]%360*jt,S()):[h*It,d*It]},C.rotate=function(t){return arguments.length?(p=t[0]%360*jt,g=t[1]%360*jt,v=t.length>2?t[2]%360*jt:0,S()):[p*It,g*It,v*It]},i.rebind(C,l,"precision"),function(){return e=t.apply(this,arguments),C.invert=e.invert&&E,S()}}function Pr(t){return jr(t,function(e,n){t.point(e*jt,n*jt)})}function Lr(t,e){return[t,e]}function Hr(t,e){return[t>_t?t-Nt:t<-_t?t+Nt:t,e]}function Fr(t,e,n){return t?e||n?Qn(Wr(t),Vr(e,n)):Wr(t):e||n?Vr(e,n):Hr}function Br(t){return function(e,n){return[(e+=t)>_t?e-Nt:e<-_t?e+Nt:e,n]}}function Wr(t){var e=Br(t);return e.invert=Br(-t),e}function Vr(t,e){var n=Math.cos(t),r=Math.sin(t),o=Math.cos(e),i=Math.sin(e);function a(t,e){var a=Math.cos(e),s=Math.cos(t)*a,l=Math.sin(t)*a,u=Math.sin(e),c=u*n+s*r;return[Math.atan2(l*o-c*i,s*n-u*r),Ht(c*o+l*i)]}return a.invert=function(t,e){var a=Math.cos(e),s=Math.cos(t)*a,l=Math.sin(t)*a,u=Math.sin(e),c=u*o-l*i;return[Math.atan2(l*o+u*i,s*n+c*r),Ht(c*n-s*r)]},a}function Ur(t,e){var n=Math.cos(t),r=Math.sin(t);return function(o,i,a,s){var l=a*e;null!=o?(o=Yr(n,o),i=Yr(n,i),(a>0?o<i:o>i)&&(o+=a*Nt)):(o=t+a*Nt,i=t-.5*l);for(var u,c=o;a>0?c>i:c<i;c-=l)s.point((u=Yn([n,-r*Math.cos(c),-r*Math.sin(c)]))[0],u[1])}}function Yr(t,e){var n=Hn(e);n[0]-=t,Un(n);var r=Lt(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-Tt)%(2*Math.PI)}function zr(t,e,n){var r=i.range(t,e-Tt,n).concat(e);return function(t){return r.map(function(e){return[t,e]})}}function Gr(t,e,n){var r=i.range(t,e-Tt,n).concat(e);return function(t){return r.map(function(e){return[e,t]})}}function Xr(t){return t.source}function qr(t){return t.target}i.geo.path=function(){var t,e,n,r,o,a=4.5;function s(t){return t&&("function"==typeof a&&r.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=n(r)),i.geo.stream(t,o)),r.result()}function l(){return o=null,s}return s.area=function(t){return dr=0,i.geo.stream(t,n(br)),dr},s.centroid=function(t){return Rn=Tn=Mn=_n=Nn=An=xn=jn=In=0,i.geo.stream(t,n(kr)),In?[xn/In,jn/In]:An?[_n/An,Nn/An]:Mn?[Rn/Mn,Tn/Mn]:[NaN,NaN]},s.bounds=function(t){return yr=mr=-(gr=vr=1/0),i.geo.stream(t,n(Cr)),[[gr,vr],[yr,mr]]},s.projection=function(e){return arguments.length?(n=(t=e)?e.stream||(r=e,o=Ar(function(t,e){return r([t*It,e*It])}),function(t){return Pr(o(t))}):D,l()):t;var r,o},s.context=function(t){return arguments.length?(r=null==(e=t)?new Or:new Nr(t),"function"!=typeof a&&r.pointRadius(a),l()):e},s.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(r.pointRadius(+t),+t),s):a},s.projection(i.geo.albersUsa()).context(null)},i.geo.transform=function(t){return{stream:function(e){var n=new xr(e);for(var r in t)n[r]=t[r];return n}}},xr.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},i.geo.projection=Ir,i.geo.projectionMutator=Dr,(i.geo.equirectangular=function(){return Ir(Lr)}).raw=Lr.invert=Lr,i.geo.rotation=function(t){function e(e){return(e=t(e[0]*jt,e[1]*jt))[0]*=It,e[1]*=It,e}return t=Fr(t[0]%360*jt,t[1]*jt,t.length>2?t[2]*jt:0),e.invert=function(e){return(e=t.invert(e[0]*jt,e[1]*jt))[0]*=It,e[1]*=It,e},e},Hr.invert=Lr,i.geo.circle=function(){var t,e,n=[0,0],r=6;function o(){var t="function"==typeof n?n.apply(this,arguments):n,r=Fr(-t[0]*jt,-t[1]*jt,0).invert,o=[];return e(null,null,1,{point:function(t,e){o.push(t=r(t,e)),t[0]*=It,t[1]*=It}}),{type:"Polygon",coordinates:[o]}}return o.origin=function(t){return arguments.length?(n=t,o):n},o.angle=function(n){return arguments.length?(e=Ur((t=+n)*jt,r*jt),o):t},o.precision=function(n){return arguments.length?(e=Ur(t*jt,(r=+n)*jt),o):r},o.angle(90)},i.geo.distance=function(t,e){var n,r=(e[0]-t[0])*jt,o=t[1]*jt,i=e[1]*jt,a=Math.sin(r),s=Math.cos(r),l=Math.sin(o),u=Math.cos(o),c=Math.sin(i),f=Math.cos(i);return Math.atan2(Math.sqrt((n=f*a)*n+(n=u*c-l*f*s)*n),l*c+u*f*s)},i.geo.graticule=function(){var t,e,n,r,o,a,s,l,u,c,f,h,d=10,p=d,g=90,v=360,y=2.5;function m(){return{type:"MultiLineString",coordinates:b()}}function b(){return i.range(Math.ceil(r/g)*g,n,g).map(f).concat(i.range(Math.ceil(l/v)*v,s,v).map(h)).concat(i.range(Math.ceil(e/d)*d,t,d).filter(function(t){return O(t%g)>Tt}).map(u)).concat(i.range(Math.ceil(a/p)*p,o,p).filter(function(t){return O(t%v)>Tt}).map(c))}return m.lines=function(){return b().map(function(t){return{type:"LineString",coordinates:t}})},m.outline=function(){return{type:"Polygon",coordinates:[f(r).concat(h(s).slice(1),f(n).reverse().slice(1),h(l).reverse().slice(1))]}},m.extent=function(t){return arguments.length?m.majorExtent(t).minorExtent(t):m.minorExtent()},m.majorExtent=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],l=+t[0][1],s=+t[1][1],r>n&&(t=r,r=n,n=t),l>s&&(t=l,l=s,s=t),m.precision(y)):[[r,l],[n,s]]},m.minorExtent=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],a=+n[0][1],o=+n[1][1],e>t&&(n=e,e=t,t=n),a>o&&(n=a,a=o,o=n),m.precision(y)):[[e,a],[t,o]]},m.step=function(t){return arguments.length?m.majorStep(t).minorStep(t):m.minorStep()},m.majorStep=function(t){return arguments.length?(g=+t[0],v=+t[1],m):[g,v]},m.minorStep=function(t){return arguments.length?(d=+t[0],p=+t[1],m):[d,p]},m.precision=function(i){return arguments.length?(y=+i,u=zr(a,o,90),c=Gr(e,t,y),f=zr(l,s,90),h=Gr(r,n,y),m):y},m.majorExtent([[-180,-90+Tt],[180,90-Tt]]).minorExtent([[-180,-80-Tt],[180,80+Tt]])},i.geo.greatArc=function(){var t,e,n=Xr,r=qr;function o(){return{type:"LineString",coordinates:[t||n.apply(this,arguments),e||r.apply(this,arguments)]}}return o.distance=function(){return i.geo.distance(t||n.apply(this,arguments),e||r.apply(this,arguments))},o.source=function(e){return arguments.length?(n=e,t="function"==typeof e?null:e,o):n},o.target=function(t){return arguments.length?(r=t,e="function"==typeof t?null:t,o):r},o.precision=function(){return arguments.length?o:0},o},i.geo.interpolate=function(t,e){return n=t[0]*jt,r=t[1]*jt,o=e[0]*jt,i=e[1]*jt,a=Math.cos(r),s=Math.sin(r),l=Math.cos(i),u=Math.sin(i),c=a*Math.cos(n),f=a*Math.sin(n),h=l*Math.cos(o),d=l*Math.sin(o),p=2*Math.asin(Math.sqrt(Bt(i-r)+a*l*Bt(o-n))),g=1/Math.sin(p),(v=p?function(t){var e=Math.sin(t*=p)*g,n=Math.sin(p-t)*g,r=n*c+e*h,o=n*f+e*d,i=n*s+e*u;return[Math.atan2(o,r)*It,Math.atan2(i,Math.sqrt(r*r+o*o))*It]}:function(){return[n*It,r*It]}).distance=p,v;var n,r,o,i,a,s,l,u,c,f,h,d,p,g,v},i.geo.length=function(t){return Sr=0,i.geo.stream(t,Kr),Sr};var Kr={sphere:F,point:F,lineStart:function(){var t,e,n;function r(r,o){var i=Math.sin(o*=jt),a=Math.cos(o),s=O((r*=jt)-t),l=Math.cos(s);Sr+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=n*i-e*a*l)*s),e*i+n*a*l),t=r,e=i,n=a}Kr.point=function(o,i){t=o*jt,e=Math.sin(i*=jt),n=Math.cos(i),Kr.point=r},Kr.lineEnd=function(){Kr.point=Kr.lineEnd=F}},lineEnd:F,polygonStart:F,polygonEnd:F};function $r(t,e){function n(e,n){var r=Math.cos(e),o=Math.cos(n),i=t(r*o);return[i*o*Math.sin(e),i*Math.sin(n)]}return n.invert=function(t,n){var r=Math.sqrt(t*t+n*n),o=e(r),i=Math.sin(o),a=Math.cos(o);return[Math.atan2(t*i,r*a),Math.asin(r&&n*i/r)]},n}var Zr=$r(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(i.geo.azimuthalEqualArea=function(){return Ir(Zr)}).raw=Zr;var Qr=$r(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},D);function Jr(t,e){var n=Math.cos(t),r=function(t){return Math.tan(_t/4+t/2)},o=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(r(e)/r(t)),i=n*Math.pow(r(t),o)/o;if(!o)return no;function a(t,e){i>0?e<-xt+Tt&&(e=-xt+Tt):e>xt-Tt&&(e=xt-Tt);var n=i/Math.pow(r(e),o);return[n*Math.sin(o*t),i-n*Math.cos(o*t)]}return a.invert=function(t,e){var n=i-e,r=Dt(o)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/o,2*Math.atan(Math.pow(i/r,1/o))-xt]},a}function to(t,e){var n=Math.cos(t),r=t===e?Math.sin(t):(n-Math.cos(e))/(e-t),o=n/r+t;if(O(r)<Tt)return Lr;function i(t,e){var n=o-e;return[n*Math.sin(r*t),o-n*Math.cos(r*t)]}return i.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/r,o-Dt(r)*Math.sqrt(t*t+n*n)]},i}(i.geo.azimuthalEquidistant=function(){return Ir(Qr)}).raw=Qr,(i.geo.conicConformal=function(){return fr(Jr)}).raw=Jr,(i.geo.conicEquidistant=function(){return fr(to)}).raw=to;var eo=$r(function(t){return 1/t},Math.atan);function no(t,e){return[t,Math.log(Math.tan(_t/4+e/2))]}function ro(t){var e,n=Ir(t),r=n.scale,o=n.translate,i=n.clipExtent;return n.scale=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=o.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var a=i.apply(n,arguments);if(a===n){if(e=null==t){var s=_t*r(),l=o();i([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else e&&(a=null);return a},n.clipExtent(null)}(i.geo.gnomonic=function(){return Ir(eo)}).raw=eo,no.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-xt]},(i.geo.mercator=function(){return ro(no)}).raw=no;var oo=$r(function(){return 1},Math.asin);(i.geo.orthographic=function(){return Ir(oo)}).raw=oo;var io=$r(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});function ao(t,e){return[Math.log(Math.tan(_t/4+e/2)),-t]}function so(t){return t[0]}function lo(t){return t[1]}function uo(t){for(var e=t.length,n=[0,1],r=2,o=2;o<e;o++){for(;r>1&&Pt(t[n[r-2]],t[n[r-1]],t[o])<=0;)--r;n[r++]=o}return n.slice(0,r)}function co(t,e){return t[0]-e[0]||t[1]-e[1]}(i.geo.stereographic=function(){return Ir(io)}).raw=io,ao.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-xt]},(i.geo.transverseMercator=function(){var t=ro(ao),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90])}).raw=ao,i.geom={},i.geom.hull=function(t){var e=so,n=lo;if(arguments.length)return r(t);function r(t){if(t.length<3)return[];var r,o=we(e),i=we(n),a=t.length,s=[],l=[];for(r=0;r<a;r++)s.push([+o.call(this,t[r],r),+i.call(this,t[r],r),r]);for(s.sort(co),r=0;r<a;r++)l.push([s[r][0],-s[r][1]]);var u=uo(s),c=uo(l),f=c[0]===u[0],h=c[c.length-1]===u[u.length-1],d=[];for(r=u.length-1;r>=0;--r)d.push(t[s[u[r]][2]]);for(r=+f;r<c.length-h;++r)d.push(t[s[c[r]][2]]);return d}return r.x=function(t){return arguments.length?(e=t,r):e},r.y=function(t){return arguments.length?(n=t,r):n},r},i.geom.polygon=function(t){return G(t,fo),t};var fo=i.geom.polygon.prototype=[];function ho(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function po(t,e,n,r){var o=t[0],i=n[0],a=e[0]-o,s=r[0]-i,l=t[1],u=n[1],c=e[1]-l,f=r[1]-u,h=(s*(l-u)-f*(o-i))/(f*a-s*c);return[o+h*a,l+h*c]}function go(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}fo.area=function(){for(var t,e=-1,n=this.length,r=this[n-1],o=0;++e<n;)t=r,r=this[e],o+=t[1]*r[0]-t[0]*r[1];return.5*o},fo.centroid=function(t){var e,n,r=-1,o=this.length,i=0,a=0,s=this[o-1];for(arguments.length||(t=-1/(6*this.area()));++r<o;)e=s,s=this[r],n=e[0]*s[1]-s[0]*e[1],i+=(e[0]+s[0])*n,a+=(e[1]+s[1])*n;return[i*t,a*t]},fo.clip=function(t){for(var e,n,r,o,i,a,s=go(t),l=-1,u=this.length-go(this),c=this[u-1];++l<u;){for(e=t.slice(),t.length=0,o=this[l],i=e[(r=e.length-s)-1],n=-1;++n<r;)ho(a=e[n],c,o)?(ho(i,c,o)||t.push(po(i,a,c,o)),t.push(a)):ho(i,c,o)&&t.push(po(i,a,c,o)),i=a;s&&t.push(t[0]),c=o}return t};var vo,yo,mo,bo,wo,Co=[],Oo=[];function Eo(){Wo(this),this.edge=this.site=this.circle=null}function So(t){var e=Co.pop()||new Eo;return e.site=t,e}function ko(t){Io(t),mo.remove(t),Co.push(t),Wo(t)}function Ro(t){var e=t.circle,n=e.x,r=e.cy,o={x:n,y:r},i=t.P,a=t.N,s=[t];ko(t);for(var l=i;l.circle&&O(n-l.circle.x)<Tt&&O(r-l.circle.cy)<Tt;)i=l.P,s.unshift(l),ko(l),l=i;s.unshift(l),Io(l);for(var u=a;u.circle&&O(n-u.circle.x)<Tt&&O(r-u.circle.cy)<Tt;)a=u.N,s.push(u),ko(u),u=a;s.push(u),Io(u);var c,f=s.length;for(c=1;c<f;++c)u=s[c],l=s[c-1],Ho(u.edge,l.site,u.site,o);l=s[0],(u=s[f-1]).edge=Lo(l.site,u.site,null,o),jo(l),jo(u)}function To(t){for(var e,n,r,o,i=t.x,a=t.y,s=mo._;s;)if((r=Mo(s,a)-i)>Tt)s=s.L;else{if(!((o=i-_o(s,a))>Tt)){r>-Tt?(e=s.P,n=s):o>-Tt?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}var l=So(t);if(mo.insert(e,l),e||n){if(e===n)return Io(e),n=So(e.site),mo.insert(l,n),l.edge=n.edge=Lo(e.site,l.site),jo(e),void jo(n);if(n){Io(e),Io(n);var u=e.site,c=u.x,f=u.y,h=t.x-c,d=t.y-f,p=n.site,g=p.x-c,v=p.y-f,y=2*(h*v-d*g),m=h*h+d*d,b=g*g+v*v,w={x:(v*m-d*b)/y+c,y:(h*b-g*m)/y+f};Ho(n.edge,u,p,w),l.edge=Lo(u,t,null,w),n.edge=Lo(t,p,null,w),jo(e),jo(n)}else l.edge=Lo(e.site,l.site)}}function Mo(t,e){var n=t.site,r=n.x,o=n.y,i=o-e;if(!i)return r;var a=t.P;if(!a)return-1/0;var s=(n=a.site).x,l=n.y,u=l-e;if(!u)return s;var c=s-r,f=1/i-1/u,h=c/u;return f?(-h+Math.sqrt(h*h-2*f*(c*c/(-2*u)-l+u/2+o-i/2)))/f+r:(r+s)/2}function _o(t,e){var n=t.N;if(n)return Mo(n,e);var r=t.site;return r.y===e?r.x:1/0}function No(t){this.site=t,this.edges=[]}function Ao(t,e){return e.angle-t.angle}function xo(){Wo(this),this.x=this.y=this.arc=this.site=this.cy=null}function jo(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,o=t.site,i=n.site;if(r!==i){var a=o.x,s=o.y,l=r.x-a,u=r.y-s,c=i.x-a,f=2*(l*(v=i.y-s)-u*c);if(!(f>=-Mt)){var h=l*l+u*u,d=c*c+v*v,p=(v*h-u*d)/f,g=(l*d-c*h)/f,v=g+s,y=Oo.pop()||new xo;y.arc=t,y.site=o,y.x=p+a,y.y=v+Math.sqrt(p*p+g*g),y.cy=v,t.circle=y;for(var m=null,b=wo._;b;)if(y.y<b.y||y.y===b.y&&y.x<=b.x){if(!b.L){m=b.P;break}b=b.L}else{if(!b.R){m=b;break}b=b.R}wo.insert(m,y),m||(bo=y)}}}}function Io(t){var e=t.circle;e&&(e.P||(bo=e.N),wo.remove(e),Oo.push(e),Wo(e),t.circle=null)}function Do(t,e){var n=t.b;if(n)return!0;var r,o,i=t.a,a=e[0][0],s=e[1][0],l=e[0][1],u=e[1][1],c=t.l,f=t.r,h=c.x,d=c.y,p=f.x,g=f.y,v=(h+p)/2,y=(d+g)/2;if(g===d){if(v<a||v>=s)return;if(h>p){if(i){if(i.y>=u)return}else i={x:v,y:l};n={x:v,y:u}}else{if(i){if(i.y<l)return}else i={x:v,y:u};n={x:v,y:l}}}else if(o=y-(r=(h-p)/(g-d))*v,r<-1||r>1)if(h>p){if(i){if(i.y>=u)return}else i={x:(l-o)/r,y:l};n={x:(u-o)/r,y:u}}else{if(i){if(i.y<l)return}else i={x:(u-o)/r,y:u};n={x:(l-o)/r,y:l}}else if(d<g){if(i){if(i.x>=s)return}else i={x:a,y:r*a+o};n={x:s,y:r*s+o}}else{if(i){if(i.x<a)return}else i={x:s,y:r*s+o};n={x:a,y:r*a+o}}return t.a=i,t.b=n,!0}function Po(t,e){this.l=t,this.r=e,this.a=this.b=null}function Lo(t,e,n,r){var o=new Po(t,e);return vo.push(o),n&&Ho(o,t,e,n),r&&Ho(o,e,t,r),yo[t.i].edges.push(new Fo(o,t,e)),yo[e.i].edges.push(new Fo(o,e,t)),o}function Ho(t,e,n,r){t.a||t.b?t.l===n?t.b=r:t.a=r:(t.a=r,t.l=e,t.r=n)}function Fo(t,e,n){var r=t.a,o=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(o.x-r.x,r.y-o.y):Math.atan2(r.x-o.x,o.y-r.y)}function Bo(){this._=null}function Wo(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Vo(t,e){var n=e,r=e.R,o=n.U;o?o.L===n?o.L=r:o.R=r:t._=r,r.U=o,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Uo(t,e){var n=e,r=e.L,o=n.U;o?o.L===n?o.L=r:o.R=r:t._=r,r.U=o,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Yo(t){for(;t.L;)t=t.L;return t}function zo(t,e){var n,r,o,i=t.sort(Go).pop();for(vo=[],yo=new Array(t.length),mo=new Bo,wo=new Bo;;)if(o=bo,i&&(!o||i.y<o.y||i.y===o.y&&i.x<o.x))i.x===n&&i.y===r||(yo[i.i]=new No(i),To(i),n=i.x,r=i.y),i=t.pop();else{if(!o)break;Ro(o.arc)}e&&(function(t){for(var e,n=vo,r=lr(t[0][0],t[0][1],t[1][0],t[1][1]),o=n.length;o--;)(!Do(e=n[o],t)||!r(e)||O(e.a.x-e.b.x)<Tt&&O(e.a.y-e.b.y)<Tt)&&(e.a=e.b=null,n.splice(o,1))}(e),function(t){for(var e,n,r,o,i,a,s,l,u,c,f=t[0][0],h=t[1][0],d=t[0][1],p=t[1][1],g=yo,v=g.length;v--;)if((i=g[v])&&i.prepare())for(l=(s=i.edges).length,a=0;a<l;)r=(c=s[a].end()).x,o=c.y,e=(u=s[++a%l].start()).x,n=u.y,(O(r-e)>Tt||O(o-n)>Tt)&&(s.splice(a,0,new Fo((y=i.site,m=c,b=O(r-f)<Tt&&p-o>Tt?{x:f,y:O(e-f)<Tt?n:p}:O(o-p)<Tt&&h-r>Tt?{x:O(n-p)<Tt?e:h,y:p}:O(r-h)<Tt&&o-d>Tt?{x:h,y:O(e-h)<Tt?n:d}:O(o-d)<Tt&&r-f>Tt?{x:O(n-d)<Tt?e:f,y:d}:null,w=void 0,w=new Po(y,null),w.a=m,w.b=b,vo.push(w),w),i.site,null)),++l);var y,m,b,w}(e));var a={cells:yo,edges:vo};return mo=wo=vo=yo=null,a}function Go(t,e){return e.y-t.y||e.x-t.x}No.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)(t=e[n].edge).b&&t.a||e.splice(n,1);return e.sort(Ao),e.length},Fo.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Bo.prototype={insert:function(t,e){var n,r,o;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Yo(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(o=r.R)&&o.C?(n.C=o.C=!1,r.C=!0,t=r):(t===n.R&&(Vo(this,n),n=(t=n).U),n.C=!1,r.C=!0,Uo(this,r)):(o=r.L)&&o.C?(n.C=o.C=!1,r.C=!0,t=r):(t===n.L&&(Uo(this,n),n=(t=n).U),n.C=!1,r.C=!0,Vo(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,o=t.U,i=t.L,a=t.R;if(n=i?a?Yo(a):i:a,o?o.L===t?o.L=n:o.R=n:this._=n,i&&a?(r=n.C,n.C=t.C,n.L=i,i.U=n,n!==a?(o=n.U,n.U=t.U,t=n.R,o.L=t,n.R=a,a.U=n):(n.U=o,o=n,t=n.R)):(r=t.C,t=n),t&&(t.U=o),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===o.L){if((e=o.R).C&&(e.C=!1,o.C=!0,Vo(this,o),e=o.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Uo(this,e),e=o.R),e.C=o.C,o.C=e.R.C=!1,Vo(this,o),t=this._;break}}else if((e=o.L).C&&(e.C=!1,o.C=!0,Uo(this,o),e=o.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Vo(this,e),e=o.L),e.C=o.C,o.C=e.L.C=!1,Uo(this,o),t=this._;break}e.C=!0,t=o,o=o.U}while(!t.C);t&&(t.C=!1)}}},i.geom.voronoi=function(t){var e=so,n=lo,r=e,o=n,i=Xo;if(t)return a(t);function a(t){var e=new Array(t.length),n=i[0][0],r=i[0][1],o=i[1][0],a=i[1][1];return zo(s(t),i).cells.forEach(function(i,s){var l=i.edges,u=i.site;(e[s]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=n&&u.x<=o&&u.y>=r&&u.y<=a?[[n,a],[o,a],[o,r],[n,r]]:[]).point=t[s]}),e}function s(t){return t.map(function(t,e){return{x:Math.round(r(t,e)/Tt)*Tt,y:Math.round(o(t,e)/Tt)*Tt,i:e}})}return a.links=function(t){return zo(s(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},a.triangles=function(t){var e=[];return zo(s(t)).cells.forEach(function(n,r){for(var o,i,a,s,l=n.site,u=n.edges.sort(Ao),c=-1,f=u.length,h=u[f-1].edge,d=h.l===l?h.r:h.l;++c<f;)h,o=d,d=(h=u[c].edge).l===l?h.r:h.l,r<o.i&&r<d.i&&(a=o,s=d,((i=l).x-s.x)*(a.y-i.y)-(i.x-a.x)*(s.y-i.y)<0)&&e.push([t[r],t[o.i],t[d.i]])}),e},a.x=function(t){return arguments.length?(r=we(e=t),a):e},a.y=function(t){return arguments.length?(o=we(n=t),a):n},a.clipExtent=function(t){return arguments.length?(i=null==t?Xo:t,a):i===Xo?null:i},a.size=function(t){return arguments.length?a.clipExtent(t&&[[0,0],t]):i===Xo?null:i&&i[1]},a};var Xo=[[-1e6,-1e6],[1e6,1e6]];function qo(t){return t.x}function Ko(t){return t.y}function $o(t,e){t=i.rgb(t),e=i.rgb(e);var n=t.r,r=t.g,o=t.b,a=e.r-n,s=e.g-r,l=e.b-o;return function(t){return"#"+de(Math.round(n+a*t))+de(Math.round(r+s*t))+de(Math.round(o+l*t))}}function Zo(t,e){var n,r={},o={};for(n in t)n in e?r[n]=ni(t[n],e[n]):o[n]=t[n];for(n in e)n in t||(o[n]=e[n]);return function(t){for(n in r)o[n]=r[n](t);return o}}function Qo(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Jo(t,e){var n,r,o,i=ti.lastIndex=ei.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=ti.exec(t))&&(r=ei.exec(e));)(o=r.index)>i&&(o=e.slice(i,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:Qo(n,r)})),i=ei.lastIndex;return i<e.length&&(o=e.slice(i),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}i.geom.delaunay=function(t){return i.geom.voronoi().triangles(t)},i.geom.quadtree=function(t,e,n,r,o){var i,a=so,s=lo;if(i=arguments.length)return a=qo,s=Ko,3===i&&(o=n,r=e,n=e=0),l(t);function l(t){var l,u,c,f,h,d,p,g,v,y=we(a),m=we(s);if(null!=e)d=e,p=n,g=r,v=o;else if(g=v=-(d=p=1/0),u=[],c=[],h=t.length,i)for(f=0;f<h;++f)(l=t[f]).x<d&&(d=l.x),l.y<p&&(p=l.y),l.x>g&&(g=l.x),l.y>v&&(v=l.y),u.push(l.x),c.push(l.y);else for(f=0;f<h;++f){var b=+y(l=t[f],f),w=+m(l,f);b<d&&(d=b),w<p&&(p=w),b>g&&(g=b),w>v&&(v=w),u.push(b),c.push(w)}var C=g-d,E=v-p;function S(t,e,n,r,o,i,a,s){if(!isNaN(n)&&!isNaN(r))if(t.leaf){var l=t.x,u=t.y;if(null!=l)if(O(l-n)+O(u-r)<.01)k(t,e,n,r,o,i,a,s);else{var c=t.point;t.x=t.y=t.point=null,k(t,c,l,u,o,i,a,s),k(t,e,n,r,o,i,a,s)}else t.x=n,t.y=r,t.point=e}else k(t,e,n,r,o,i,a,s)}function k(t,e,n,r,o,i,a,s){var l=.5*(o+a),u=.5*(i+s),c=n>=l,f=r>=u,h=f<<1|c;t.leaf=!1,c?o=l:a=l,f?i=u:s=u,S(t=t.nodes[h]||(t.nodes[h]={leaf:!0,nodes:[],point:null,x:null,y:null}),e,n,r,o,i,a,s)}C>E?v=p+C:g=d+E;var R={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){S(R,t,+y(t,++f),+m(t,f),d,p,g,v)}};if(R.visit=function(t){!function t(e,n,r,o,i,a){if(!e(n,r,o,i,a)){var s=.5*(r+i),l=.5*(o+a),u=n.nodes;u[0]&&t(e,u[0],r,o,s,l),u[1]&&t(e,u[1],s,o,i,l),u[2]&&t(e,u[2],r,l,s,a),u[3]&&t(e,u[3],s,l,i,a)}}(t,R,d,p,g,v)},R.find=function(t){return function(t,e,n,r,o,i,a){var s,l=1/0;return function t(u,c,f,h,d){if(!(c>i||f>a||h<r||d<o)){if(p=u.point){var p,g=e-u.x,v=n-u.y,y=g*g+v*v;if(y<l){var m=Math.sqrt(l=y);r=e-m,o=n-m,i=e+m,a=n+m,s=p}}for(var b=u.nodes,w=.5*(c+h),C=.5*(f+d),O=(n>=C)<<1|e>=w,E=O+4;O<E;++O)if(u=b[3&O])switch(3&O){case 0:t(u,c,f,w,C);break;case 1:t(u,w,f,h,C);break;case 2:t(u,c,C,w,d);break;case 3:t(u,w,C,h,d)}}}(t,r,o,i,a),s}(R,t[0],t[1],d,p,g,v)},f=-1,null==e){for(;++f<h;)S(R,t[f],u[f],c[f],d,p,g,v);--f}else t.forEach(R.add);return u=c=t=l=null,R}return l.x=function(t){return arguments.length?(a=t,l):a},l.y=function(t){return arguments.length?(s=t,l):s},l.extent=function(t){return arguments.length?(null==t?e=n=r=o=null:(e=+t[0][0],n=+t[0][1],r=+t[1][0],o=+t[1][1]),l):null==e?null:[[e,n],[r,o]]},l.size=function(t){return arguments.length?(null==t?e=n=r=o=null:(e=n=0,r=+t[0],o=+t[1]),l):null==e?null:[r-e,o-n]},l},i.interpolateRgb=$o,i.interpolateObject=Zo,i.interpolateNumber=Qo,i.interpolateString=Jo;var ti=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ei=new RegExp(ti.source,"g");function ni(t,e){for(var n,r=i.interpolators.length;--r>=0&&!(n=i.interpolators[r](t,e)););return n}function ri(t,e){var n,r=[],o=[],i=t.length,a=e.length,s=Math.min(t.length,e.length);for(n=0;n<s;++n)r.push(ni(t[n],e[n]));for(;n<i;++n)o[n]=t[n];for(;n<a;++n)o[n]=e[n];return function(t){for(n=0;n<s;++n)o[n]=r[n](t);return o}}i.interpolate=ni,i.interpolators=[function(t,e){var n=typeof e;return("string"===n?be.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?$o:Jo:e instanceof zt?$o:Array.isArray(e)?ri:"object"===n&&isNaN(e)?Zo:Qo)(t,e)}],i.interpolateArray=ri;var oi=function(){return D},ii=i.map({linear:oi,poly:function(t){return function(e){return Math.pow(e,t)}},quad:function(){return ui},cubic:function(){return ci},sin:function(){return hi},exp:function(){return di},circle:function(){return pi},elastic:function(t,e){var n;arguments.length<2&&(e=.45);arguments.length?n=e/Nt*Math.asin(1/t):(t=1,n=e/4);return function(r){return 1+t*Math.pow(2,-10*r)*Math.sin((r-n)*Nt/e)}},back:function(t){t||(t=1.70158);return function(e){return e*e*((t+1)*e-t)}},bounce:function(){return gi}}),ai=i.map({in:D,out:si,"in-out":li,"out-in":function(t){return li(si(t))}});function si(t){return function(e){return 1-t(1-e)}}function li(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function ui(t){return t*t}function ci(t){return t*t*t}function fi(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function hi(t){return 1-Math.cos(t*xt)}function di(t){return Math.pow(2,10*(t-1))}function pi(t){return 1-Math.sqrt(1-t*t)}function gi(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function vi(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function yi(t){var e,n,r,o=[t.a,t.b],i=[t.c,t.d],a=bi(o),s=mi(o,i),l=bi(((e=i)[0]+=(r=-s)*(n=o)[0],e[1]+=r*n[1],e))||0;o[0]*i[1]<i[0]*o[1]&&(o[0]*=-1,o[1]*=-1,a*=-1,s*=-1),this.rotate=(a?Math.atan2(o[1],o[0]):Math.atan2(-i[0],i[1]))*It,this.translate=[t.e,t.f],this.scale=[a,l],this.skew=l?Math.atan2(s,l)*It:0}function mi(t,e){return t[0]*e[0]+t[1]*e[1]}function bi(t){var e=Math.sqrt(mi(t,t));return e&&(t[0]/=e,t[1]/=e),e}i.ease=function(t){var e,n=t.indexOf("-"),r=n>=0?t.slice(0,n):t,o=n>=0?t.slice(n+1):"in";return r=ii.get(r)||oi,o=ai.get(o)||D,e=o(r.apply(null,a.call(arguments,1))),function(t){return t<=0?0:t>=1?1:e(t)}},i.interpolateHcl=function(t,e){t=i.hcl(t),e=i.hcl(e);var n=t.h,r=t.c,o=t.l,a=e.h-n,s=e.c-r,l=e.l-o;isNaN(s)&&(s=0,r=isNaN(r)?e.c:r);isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:a<-180&&(a+=360);return function(t){return Zt(n+a*t,r+s*t,o+l*t)+""}},i.interpolateHsl=function(t,e){t=i.hsl(t),e=i.hsl(e);var n=t.h,r=t.s,o=t.l,a=e.h-n,s=e.s-r,l=e.l-o;isNaN(s)&&(s=0,r=isNaN(r)?e.s:r);isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:a<-180&&(a+=360);return function(t){return qt(n+a*t,r+s*t,o+l*t)+""}},i.interpolateLab=function(t,e){t=i.lab(t),e=i.lab(e);var n=t.l,r=t.a,o=t.b,a=e.l-n,s=e.a-r,l=e.b-o;return function(t){return oe(n+a*t,r+s*t,o+l*t)+""}},i.interpolateRound=vi,i.transform=function(t){var e=l.createElementNS(i.ns.prefix.svg,"g");return(i.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new yi(n?n.matrix:wi)})(t)},yi.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var wi={a:1,b:0,c:0,d:1,e:0,f:0};function Ci(t){return t.length?t.pop()+",":""}function Oi(t,e){var n=[],r=[];return t=i.transform(t),e=i.transform(e),function(t,e,n,r){if(t[0]!==e[0]||t[1]!==e[1]){var o=n.push("translate(",null,",",null,")");r.push({i:o-4,x:Qo(t[0],e[0])},{i:o-2,x:Qo(t[1],e[1])})}else(e[0]||e[1])&&n.push("translate("+e+")")}(t.translate,e.translate,n,r),function(t,e,n,r){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),r.push({i:n.push(Ci(n)+"rotate(",null,")")-2,x:Qo(t,e)})):e&&n.push(Ci(n)+"rotate("+e+")")}(t.rotate,e.rotate,n,r),function(t,e,n,r){t!==e?r.push({i:n.push(Ci(n)+"skewX(",null,")")-2,x:Qo(t,e)}):e&&n.push(Ci(n)+"skewX("+e+")")}(t.skew,e.skew,n,r),function(t,e,n,r){if(t[0]!==e[0]||t[1]!==e[1]){var o=n.push(Ci(n)+"scale(",null,",",null,")");r.push({i:o-4,x:Qo(t[0],e[0])},{i:o-2,x:Qo(t[1],e[1])})}else 1===e[0]&&1===e[1]||n.push(Ci(n)+"scale("+e+")")}(t.scale,e.scale,n,r),t=e=null,function(t){for(var e,o=-1,i=r.length;++o<i;)n[(e=r[o]).i]=e.x(t);return n.join("")}}function Ei(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function Si(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function ki(t){for(var e=t.source,n=t.target,r=function(t,e){if(t===e)return t;var n=Ri(t),r=Ri(e),o=n.pop(),i=r.pop(),a=null;for(;o===i;)a=o,o=n.pop(),i=r.pop();return a}(e,n),o=[e];e!==r;)e=e.parent,o.push(e);for(var i=o.length;n!==r;)o.splice(i,0,n),n=n.parent;return o}function Ri(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Ti(t){t.fixed|=2}function Mi(t){t.fixed&=-7}function _i(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Ni(t){t.fixed&=-5}i.interpolateTransform=Oi,i.layout={},i.layout.bundle=function(){return function(t){for(var e=[],n=-1,r=t.length;++n<r;)e.push(ki(t[n]));return e}},i.layout.chord=function(){var t,e,n,r,o,a,s,l={},u=0;function c(){var l,c,h,d,p,g={},v=[],y=i.range(r),m=[];for(t=[],e=[],l=0,d=-1;++d<r;){for(c=0,p=-1;++p<r;)c+=n[d][p];v.push(c),m.push(i.range(r)),l+=c}for(o&&y.sort(function(t,e){return o(v[t],v[e])}),a&&m.forEach(function(t,e){t.sort(function(t,r){return a(n[e][t],n[e][r])})}),l=(Nt-u*r)/l,c=0,d=-1;++d<r;){for(h=c,p=-1;++p<r;){var b=y[d],w=m[b][p],C=n[b][w],O=c,E=c+=C*l;g[b+"-"+w]={index:b,subindex:w,startAngle:O,endAngle:E,value:C}}e[b]={index:b,startAngle:h,endAngle:c,value:v[b]},c+=u}for(d=-1;++d<r;)for(p=d-1;++p<r;){var S=g[d+"-"+p],k=g[p+"-"+d];(S.value||k.value)&&t.push(S.value<k.value?{source:k,target:S}:{source:S,target:k})}s&&f()}function f(){t.sort(function(t,e){return s((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}return l.matrix=function(o){return arguments.length?(r=(n=o)&&n.length,t=e=null,l):n},l.padding=function(n){return arguments.length?(u=n,t=e=null,l):u},l.sortGroups=function(n){return arguments.length?(o=n,t=e=null,l):o},l.sortSubgroups=function(e){return arguments.length?(a=e,t=null,l):a},l.sortChords=function(e){return arguments.length?(s=e,t&&f(),l):s},l.chords=function(){return t||c(),t},l.groups=function(){return e||c(),e},l},i.layout.force=function(){var t,e,n,r,o,a,s={},l=i.dispatch("start","tick","end"),u=[1,1],c=.9,f=Ai,h=xi,d=-30,p=ji,g=.1,v=.64,y=[],m=[];function b(t){return function(e,n,r,o){if(e.point!==t){var i=e.cx-t.x,a=e.cy-t.y,s=o-n,l=i*i+a*a;if(s*s/v<l){if(l<p){var u=e.charge/l;t.px-=i*u,t.py-=a*u}return!0}if(e.point&&l&&l<p){u=e.pointCharge/l;t.px-=i*u,t.py-=a*u}}return!e.charge}}function w(t){t.px=i.event.x,t.py=i.event.y,s.resume()}return s.tick=function(){if((n*=.99)<.005)return t=null,l.end({type:"end",alpha:n=0}),!0;var e,s,f,h,p,v,w,C,O,E=y.length,S=m.length;for(s=0;s<S;++s)h=(f=m[s]).source,(v=(C=(p=f.target).x-h.x)*C+(O=p.y-h.y)*O)&&(C*=v=n*o[s]*((v=Math.sqrt(v))-r[s])/v,O*=v,p.x-=C*(w=h.weight+p.weight?h.weight/(h.weight+p.weight):.5),p.y-=O*w,h.x+=C*(w=1-w),h.y+=O*w);if((w=n*g)&&(C=u[0]/2,O=u[1]/2,s=-1,w))for(;++s<E;)(f=y[s]).x+=(C-f.x)*w,f.y+=(O-f.y)*w;if(d)for(!function t(e,n,r){var o=0,i=0;e.charge=0;if(!e.leaf)for(var a,s=e.nodes,l=s.length,u=-1;++u<l;)null!=(a=s[u])&&(t(a,n,r),e.charge+=a.charge,o+=a.charge*a.cx,i+=a.charge*a.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var c=n*r[e.point.index];e.charge+=e.pointCharge=c,o+=c*e.point.x,i+=c*e.point.y}e.cx=o/e.charge;e.cy=i/e.charge}(e=i.geom.quadtree(y),n,a),s=-1;++s<E;)(f=y[s]).fixed||e.visit(b(f));for(s=-1;++s<E;)(f=y[s]).fixed?(f.x=f.px,f.y=f.py):(f.x-=(f.px-(f.px=f.x))*c,f.y-=(f.py-(f.py=f.y))*c);l.tick({type:"tick",alpha:n})},s.nodes=function(t){return arguments.length?(y=t,s):y},s.links=function(t){return arguments.length?(m=t,s):m},s.size=function(t){return arguments.length?(u=t,s):u},s.linkDistance=function(t){return arguments.length?(f="function"==typeof t?t:+t,s):f},s.distance=s.linkDistance,s.linkStrength=function(t){return arguments.length?(h="function"==typeof t?t:+t,s):h},s.friction=function(t){return arguments.length?(c=+t,s):c},s.charge=function(t){return arguments.length?(d="function"==typeof t?t:+t,s):d},s.chargeDistance=function(t){return arguments.length?(p=t*t,s):Math.sqrt(p)},s.gravity=function(t){return arguments.length?(g=+t,s):g},s.theta=function(t){return arguments.length?(v=t*t,s):Math.sqrt(v)},s.alpha=function(e){return arguments.length?(e=+e,n?e>0?n=e:(t.c=null,t.t=NaN,t=null,l.end({type:"end",alpha:n=0})):e>0&&(l.start({type:"start",alpha:n=e}),t=Me(s.tick)),s):n},s.start=function(){var t,e,n,i=y.length,l=m.length,c=u[0],p=u[1];for(t=0;t<i;++t)(n=y[t]).index=t,n.weight=0;for(t=0;t<l;++t)"number"==typeof(n=m[t]).source&&(n.source=y[n.source]),"number"==typeof n.target&&(n.target=y[n.target]),++n.source.weight,++n.target.weight;for(t=0;t<i;++t)n=y[t],isNaN(n.x)&&(n.x=g("x",c)),isNaN(n.y)&&(n.y=g("y",p)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(r=[],"function"==typeof f)for(t=0;t<l;++t)r[t]=+f.call(this,m[t],t);else for(t=0;t<l;++t)r[t]=f;if(o=[],"function"==typeof h)for(t=0;t<l;++t)o[t]=+h.call(this,m[t],t);else for(t=0;t<l;++t)o[t]=h;if(a=[],"function"==typeof d)for(t=0;t<i;++t)a[t]=+d.call(this,y[t],t);else for(t=0;t<i;++t)a[t]=d;function g(n,r){if(!e){for(e=new Array(i),u=0;u<i;++u)e[u]=[];for(u=0;u<l;++u){var o=m[u];e[o.source.index].push(o.target),e[o.target.index].push(o.source)}}for(var a,s=e[t],u=-1,c=s.length;++u<c;)if(!isNaN(a=s[u][n]))return a;return Math.random()*r}return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){if(e||(e=i.behavior.drag().origin(D).on("dragstart.force",Ti).on("drag.force",w).on("dragend.force",Mi)),!arguments.length)return e;this.on("mouseover.force",_i).on("mouseout.force",Ni).call(e)},i.rebind(s,l,"on")};var Ai=20,xi=1,ji=1/0;function Ii(t,e){return i.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=Bi,t}function Di(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(o=t.children)&&(r=o.length))for(var r,o;--r>=0;)n.push(o[r])}function Pi(t,e){for(var n=[t],r=[];null!=(t=n.pop());)if(r.push(t),(i=t.children)&&(o=i.length))for(var o,i,a=-1;++a<o;)n.push(i[a]);for(;null!=(t=r.pop());)e(t)}function Li(t){return t.children}function Hi(t){return t.value}function Fi(t,e){return e.value-t.value}function Bi(t){return i.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}i.layout.hierarchy=function(){var t=Fi,e=Li,n=Hi;function r(o){var i,a=[o],s=[];for(o.depth=0;null!=(i=a.pop());)if(s.push(i),(u=e.call(r,i,i.depth))&&(l=u.length)){for(var l,u,c;--l>=0;)a.push(c=u[l]),c.parent=i,c.depth=i.depth+1;n&&(i.value=0),i.children=u}else n&&(i.value=+n.call(r,i,i.depth)||0),delete i.children;return Pi(o,function(e){var r,o;t&&(r=e.children)&&r.sort(t),n&&(o=e.parent)&&(o.value+=e.value)}),s}return r.sort=function(e){return arguments.length?(t=e,r):t},r.children=function(t){return arguments.length?(e=t,r):e},r.value=function(t){return arguments.length?(n=t,r):n},r.revalue=function(t){return n&&(Di(t,function(t){t.children&&(t.value=0)}),Pi(t,function(t){var e;t.children||(t.value=+n.call(r,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},r},i.layout.partition=function(){var t=i.layout.hierarchy(),e=[1,1];function n(n,r){var o=t.call(this,n,r);return function t(e,n,r,o){var i=e.children;if(e.x=n,e.y=e.depth*o,e.dx=r,e.dy=o,i&&(a=i.length)){var a,s,l,u=-1;for(r=e.value?r/e.value:0;++u<a;)t(s=i[u],n,l=s.value*r,o),n+=l}}(o[0],0,e[0],e[1]/function t(e){var n=e.children,r=0;if(n&&(o=n.length))for(var o,i=-1;++i<o;)r=Math.max(r,t(n[i]));return 1+r}(o[0])),o}return n.size=function(t){return arguments.length?(e=t,n):e},Ii(n,t)},i.layout.pie=function(){var t=Number,e=Wi,n=0,r=Nt,o=0;function a(s){var l,u=s.length,c=s.map(function(e,n){return+t.call(a,e,n)}),f=+("function"==typeof n?n.apply(this,arguments):n),h=("function"==typeof r?r.apply(this,arguments):r)-f,d=Math.min(Math.abs(h)/u,+("function"==typeof o?o.apply(this,arguments):o)),p=d*(h<0?-1:1),g=i.sum(c),v=g?(h-u*p)/g:0,y=i.range(u),m=[];return null!=e&&y.sort(e===Wi?function(t,e){return c[e]-c[t]}:function(t,n){return e(s[t],s[n])}),y.forEach(function(t){m[t]={data:s[t],value:l=c[t],startAngle:f,endAngle:f+=l*v+p,padAngle:d}}),m}return a.value=function(e){return arguments.length?(t=e,a):t},a.sort=function(t){return arguments.length?(e=t,a):e},a.startAngle=function(t){return arguments.length?(n=t,a):n},a.endAngle=function(t){return arguments.length?(r=t,a):r},a.padAngle=function(t){return arguments.length?(o=t,a):o},a};var Wi={};function Vi(t){return t.x}function Ui(t){return t.y}function Yi(t,e,n){t.y0=e,t.y=n}i.layout.stack=function(){var t=D,e=Xi,n=qi,r=Yi,o=Vi,a=Ui;function s(l,u){if(!(d=l.length))return l;var c=l.map(function(e,n){return t.call(s,e,n)}),f=c.map(function(t){return t.map(function(t,e){return[o.call(s,t,e),a.call(s,t,e)]})}),h=e.call(s,f,u);c=i.permute(c,h),f=i.permute(f,h);var d,p,g,v,y=n.call(s,f,u),m=c[0].length;for(g=0;g<m;++g)for(r.call(s,c[0][g],v=y[g],f[0][g][1]),p=1;p<d;++p)r.call(s,c[p][g],v+=f[p-1][g][1],f[p][g][1]);return l}return s.values=function(e){return arguments.length?(t=e,s):t},s.order=function(t){return arguments.length?(e="function"==typeof t?t:zi.get(t)||Xi,s):e},s.offset=function(t){return arguments.length?(n="function"==typeof t?t:Gi.get(t)||qi,s):n},s.x=function(t){return arguments.length?(o=t,s):o},s.y=function(t){return arguments.length?(a=t,s):a},s.out=function(t){return arguments.length?(r=t,s):r},s};var zi=i.map({"inside-out":function(t){var e,n,r=t.length,o=t.map(Ki),a=t.map($i),s=i.range(r).sort(function(t,e){return o[t]-o[e]}),l=0,u=0,c=[],f=[];for(e=0;e<r;++e)n=s[e],l<u?(l+=a[n],c.push(n)):(u+=a[n],f.push(n));return f.reverse().concat(c)},reverse:function(t){return i.range(t.length).reverse()},default:Xi}),Gi=i.map({silhouette:function(t){var e,n,r,o=t.length,i=t[0].length,a=[],s=0,l=[];for(n=0;n<i;++n){for(e=0,r=0;e<o;e++)r+=t[e][n][1];r>s&&(s=r),a.push(r)}for(n=0;n<i;++n)l[n]=(s-a[n])/2;return l},wiggle:function(t){var e,n,r,o,i,a,s,l,u,c=t.length,f=t[0],h=f.length,d=[];for(d[0]=l=u=0,n=1;n<h;++n){for(e=0,o=0;e<c;++e)o+=t[e][n][1];for(e=0,i=0,s=f[n][0]-f[n-1][0];e<c;++e){for(r=0,a=(t[e][n][1]-t[e][n-1][1])/(2*s);r<e;++r)a+=(t[r][n][1]-t[r][n-1][1])/s;i+=a*t[e][n][1]}d[n]=l-=o?i/o*s:0,l<u&&(u=l)}for(n=0;n<h;++n)d[n]-=u;return d},expand:function(t){var e,n,r,o=t.length,i=t[0].length,a=1/o,s=[];for(n=0;n<i;++n){for(e=0,r=0;e<o;e++)r+=t[e][n][1];if(r)for(e=0;e<o;e++)t[e][n][1]/=r;else for(e=0;e<o;e++)t[e][n][1]=a}for(n=0;n<i;++n)s[n]=0;return s},zero:qi});function Xi(t){return i.range(t.length)}function qi(t){for(var e=-1,n=t[0].length,r=[];++e<n;)r[e]=0;return r}function Ki(t){for(var e,n=1,r=0,o=t[0][1],i=t.length;n<i;++n)(e=t[n][1])>o&&(r=n,o=e);return r}function $i(t){return t.reduce(Zi,0)}function Zi(t,e){return t+e[1]}function Qi(t,e){return Ji(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function Ji(t,e){for(var n=-1,r=+t[0],o=(t[1]-r)/e,i=[];++n<=e;)i[n]=o*n+r;return i}function ta(t){return[i.min(t),i.max(t)]}function ea(t,e){return t.value-e.value}function na(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function ra(t,e){t._pack_next=e,e._pack_prev=t}function oa(t,e){var n=e.x-t.x,r=e.y-t.y,o=t.r+e.r;return.999*o*o>n*n+r*r}function ia(t){if((e=t.children)&&(l=e.length)){var e,n,r,o,i,a,s,l,u=1/0,c=-1/0,f=1/0,h=-1/0;if(e.forEach(aa),(n=e[0]).x=-n.r,n.y=0,b(n),l>1&&((r=e[1]).x=r.r,r.y=0,b(r),l>2))for(la(n,r,o=e[2]),b(o),na(n,o),n._pack_prev=o,na(o,r),r=n._pack_next,i=3;i<l;i++){la(n,r,o=e[i]);var d=0,p=1,g=1;for(a=r._pack_next;a!==r;a=a._pack_next,p++)if(oa(a,o)){d=1;break}if(1==d)for(s=n._pack_prev;s!==a._pack_prev&&!oa(s,o);s=s._pack_prev,g++);d?(p<g||p==g&&r.r<n.r?ra(n,r=a):ra(n=s,r),i--):(na(n,o),r=o,b(o))}var v=(u+c)/2,y=(f+h)/2,m=0;for(i=0;i<l;i++)(o=e[i]).x-=v,o.y-=y,m=Math.max(m,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=m,e.forEach(sa)}function b(t){u=Math.min(t.x-t.r,u),c=Math.max(t.x+t.r,c),f=Math.min(t.y-t.r,f),h=Math.max(t.y+t.r,h)}}function aa(t){t._pack_next=t._pack_prev=t}function sa(t){delete t._pack_next,delete t._pack_prev}function la(t,e,n){var r=t.r+n.r,o=e.x-t.x,i=e.y-t.y;if(r&&(o||i)){var a=e.r+n.r,s=o*o+i*i,l=.5+((r*=r)-(a*=a))/(2*s),u=Math.sqrt(Math.max(0,2*a*(r+s)-(r-=s)*r-a*a))/(2*s);n.x=t.x+l*o+u*i,n.y=t.y+l*i-u*o}else n.x=t.x+r,n.y=t.y}function ua(t,e){return t.parent==e.parent?1:2}function ca(t){var e=t.children;return e.length?e[0]:t.t}function fa(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function ha(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function da(t,e,n){return t.a.parent===e.parent?t.a:n}function pa(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function ga(t,e){var n=t.x+e[3],r=t.y+e[0],o=t.dx-e[1]-e[3],i=t.dy-e[0]-e[2];return o<0&&(n+=o/2,o=0),i<0&&(r+=i/2,i=0),{x:n,y:r,dx:o,dy:i}}function va(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]}function ya(t){return t.rangeExtent?t.rangeExtent():va(t.range())}function ma(t,e,n,r){var o=n(t[0],t[1]),i=r(e[0],e[1]);return function(t){return i(o(t))}}function ba(t,e){var n,r=0,o=t.length-1,i=t[r],a=t[o];return a<i&&(n=r,r=o,o=n,n=i,i=a,a=n),t[r]=e.floor(i),t[o]=e.ceil(a),t}function wa(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:Ca}i.layout.histogram=function(){var t=!0,e=Number,n=ta,r=Qi;function o(o,a){for(var s,l,u=[],c=o.map(e,this),f=n.call(this,c,a),h=r.call(this,f,c,a),d=(a=-1,c.length),p=h.length-1,g=t?1:1/d;++a<p;)(s=u[a]=[]).dx=h[a+1]-(s.x=h[a]),s.y=0;if(p>0)for(a=-1;++a<d;)(l=c[a])>=f[0]&&l<=f[1]&&((s=u[i.bisect(h,l,1,p)-1]).y+=g,s.push(o[a]));return u}return o.value=function(t){return arguments.length?(e=t,o):e},o.range=function(t){return arguments.length?(n=we(t),o):n},o.bins=function(t){return arguments.length?(r="number"==typeof t?function(e){return Ji(e,t)}:we(t),o):r},o.frequency=function(e){return arguments.length?(t=!!e,o):t},o},i.layout.pack=function(){var t,e=i.layout.hierarchy().sort(ea),n=0,r=[1,1];function o(o,i){var a=e.call(this,o,i),s=a[0],l=r[0],u=r[1],c=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(s.x=s.y=0,Pi(s,function(t){t.r=+c(t.value)}),Pi(s,ia),n){var f=n*(t?1:Math.max(2*s.r/l,2*s.r/u))/2;Pi(s,function(t){t.r+=f}),Pi(s,ia),Pi(s,function(t){t.r-=f})}return function t(e,n,r,o){var i=e.children;e.x=n+=o*e.x;e.y=r+=o*e.y;e.r*=o;if(i)for(var a=-1,s=i.length;++a<s;)t(i[a],n,r,o)}(s,l/2,u/2,t?1:1/Math.max(2*s.r/l,2*s.r/u)),a}return o.size=function(t){return arguments.length?(r=t,o):r},o.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,o):t},o.padding=function(t){return arguments.length?(n=+t,o):n},Ii(o,e)},i.layout.tree=function(){var t=i.layout.hierarchy().sort(null).value(null),e=ua,n=[1,1],r=null;function o(o,i){var u=t.call(this,o,i),c=u[0],f=function(t){var e,n={A:null,children:[t]},r=[n];for(;null!=(e=r.pop());)for(var o,i=e.children,a=0,s=i.length;a<s;++a)r.push((i[a]=o={_:i[a],parent:e,children:(o=i[a].children)&&o.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=o);return n.children[0]}(c);if(Pi(f,a),f.parent.m=-f.z,Di(f,s),r)Di(c,l);else{var h=c,d=c,p=c;Di(c,function(t){t.x<h.x&&(h=t),t.x>d.x&&(d=t),t.depth>p.depth&&(p=t)});var g=e(h,d)/2-h.x,v=n[0]/(d.x+e(d,h)/2+g),y=n[1]/(p.depth||1);Di(c,function(t){t.x=(t.x+g)*v,t.y=t.depth*y})}return u}function a(t){var n=t.children,r=t.parent.children,o=t.i?r[t.i-1]:null;if(n.length){!function(t){var e,n=0,r=0,o=t.children,i=o.length;for(;--i>=0;)(e=o[i]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(t);var i=(n[0].z+n[n.length-1].z)/2;o?(t.z=o.z+e(t._,o._),t.m=t.z-i):t.z=i}else o&&(t.z=o.z+e(t._,o._));t.parent.A=function(t,n,r){if(n){for(var o,i=t,a=t,s=n,l=i.parent.children[0],u=i.m,c=a.m,f=s.m,h=l.m;s=fa(s),i=ca(i),s&&i;)l=ca(l),(a=fa(a)).a=t,(o=s.z+f-i.z-u+e(s._,i._))>0&&(ha(da(s,t,r),t,o),u+=o,c+=o),f+=s.m,u+=i.m,h+=l.m,c+=a.m;s&&!fa(a)&&(a.t=s,a.m+=f-c),i&&!ca(l)&&(l.t=i,l.m+=u-h,r=t)}return r}(t,o,t.parent.A||r[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function l(t){t.x*=n[0],t.y=t.depth*n[1]}return o.separation=function(t){return arguments.length?(e=t,o):e},o.size=function(t){return arguments.length?(r=null==(n=t)?l:null,o):r?null:n},o.nodeSize=function(t){return arguments.length?(r=null==(n=t)?null:l,o):r?n:null},Ii(o,t)},i.layout.cluster=function(){var t=i.layout.hierarchy().sort(null).value(null),e=ua,n=[1,1],r=!1;function o(o,a){var s,l=t.call(this,o,a),u=l[0],c=0;Pi(u,function(t){var n=t.children;n&&n.length?(t.x=function(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}(n),t.y=function(t){return 1+i.max(t,function(t){return t.y})}(n)):(t.x=s?c+=e(t,s):0,t.y=0,s=t)});var f=function t(e){var n=e.children;return n&&n.length?t(n[0]):e}(u),h=function t(e){var n,r=e.children;return r&&(n=r.length)?t(r[n-1]):e}(u),d=f.x-e(f,h)/2,p=h.x+e(h,f)/2;return Pi(u,r?function(t){t.x=(t.x-u.x)*n[0],t.y=(u.y-t.y)*n[1]}:function(t){t.x=(t.x-d)/(p-d)*n[0],t.y=(1-(u.y?t.y/u.y:1))*n[1]}),l}return o.separation=function(t){return arguments.length?(e=t,o):e},o.size=function(t){return arguments.length?(r=null==(n=t),o):r?null:n},o.nodeSize=function(t){return arguments.length?(r=null!=(n=t),o):r?n:null},Ii(o,t)},i.layout.treemap=function(){var t,e=i.layout.hierarchy(),n=Math.round,r=[1,1],o=null,a=pa,s=!1,l="squarify",u=.5*(1+Math.sqrt(5));function c(t,e){for(var n,r,o=-1,i=t.length;++o<i;)r=(n=t[o]).value*(e<0?0:e),n.area=isNaN(r)||r<=0?0:r}function f(t){var e=t.children;if(e&&e.length){var n,r,o,i=a(t),s=[],u=e.slice(),h=1/0,g="slice"===l?i.dx:"dice"===l?i.dy:"slice-dice"===l?1&t.depth?i.dy:i.dx:Math.min(i.dx,i.dy);for(c(u,i.dx*i.dy/t.value),s.area=0;(o=u.length)>0;)s.push(n=u[o-1]),s.area+=n.area,"squarify"!==l||(r=d(s,g))<=h?(u.pop(),h=r):(s.area-=s.pop().area,p(s,g,i,!1),g=Math.min(i.dx,i.dy),s.length=s.area=0,h=1/0);s.length&&(p(s,g,i,!0),s.length=s.area=0),e.forEach(f)}}function h(t){var e=t.children;if(e&&e.length){var n,r=a(t),o=e.slice(),i=[];for(c(o,r.dx*r.dy/t.value),i.area=0;n=o.pop();)i.push(n),i.area+=n.area,null!=n.z&&(p(i,n.z?r.dx:r.dy,r,!o.length),i.length=i.area=0);e.forEach(h)}}function d(t,e){for(var n,r=t.area,o=0,i=1/0,a=-1,s=t.length;++a<s;)(n=t[a].area)&&(n<i&&(i=n),n>o&&(o=n));return e*=e,(r*=r)?Math.max(e*o*u/r,r/(e*i*u)):1/0}function p(t,e,r,o){var i,a=-1,s=t.length,l=r.x,u=r.y,c=e?n(t.area/e):0;if(e==r.dx){for((o||c>r.dy)&&(c=r.dy);++a<s;)(i=t[a]).x=l,i.y=u,i.dy=c,l+=i.dx=Math.min(r.x+r.dx-l,c?n(i.area/c):0);i.z=!0,i.dx+=r.x+r.dx-l,r.y+=c,r.dy-=c}else{for((o||c>r.dx)&&(c=r.dx);++a<s;)(i=t[a]).x=l,i.y=u,i.dx=c,u+=i.dy=Math.min(r.y+r.dy-u,c?n(i.area/c):0);i.z=!1,i.dy+=r.y+r.dy-u,r.x+=c,r.dx-=c}}function g(n){var o=t||e(n),i=o[0];return i.x=i.y=0,i.value?(i.dx=r[0],i.dy=r[1]):i.dx=i.dy=0,t&&e.revalue(i),c([i],i.dx*i.dy/i.value),(t?h:f)(i),s&&(t=o),o}return g.size=function(t){return arguments.length?(r=t,g):r},g.padding=function(t){if(!arguments.length)return o;function e(e){return ga(e,t)}var n;return a=null==(o=t)?pa:"function"==(n=typeof t)?function(e){var n=t.call(g,e,e.depth);return null==n?pa(e):ga(e,"number"==typeof n?[n,n,n,n]:n)}:"number"===n?(t=[t,t,t,t],e):e,g},g.round=function(t){return arguments.length?(n=t?Math.round:Number,g):n!=Number},g.sticky=function(e){return arguments.length?(s=e,t=null,g):s},g.ratio=function(t){return arguments.length?(u=t,g):u},g.mode=function(t){return arguments.length?(l=t+"",g):l},Ii(g,e)},i.random={normal:function(t,e){var n=arguments.length;return n<2&&(e=1),n<1&&(t=0),function(){var n,r,o;do{o=(n=2*Math.random()-1)*n+(r=2*Math.random()-1)*r}while(!o||o>1);return t+e*n*Math.sqrt(-2*Math.log(o)/o)}},logNormal:function(){var t=i.random.normal.apply(i,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=i.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;n<t;n++)e+=Math.random();return e}}},i.scale={};var Ca={floor:D,ceil:D};function Oa(t,e,n,r){var o=[],a=[],s=0,l=Math.min(t.length,e.length)-1;for(t[l]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<=l;)o.push(n(t[s-1],t[s])),a.push(r(e[s-1],e[s]));return function(e){var n=i.bisect(t,e,1,l)-1;return a[n](o[n](e))}}function Ea(t,e){return i.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Sa(t,e){return ba(t,wa(ka(t,e)[2])),ba(t,wa(ka(t,e)[2])),t}function ka(t,e){null==e&&(e=10);var n=va(t),r=n[1]-n[0],o=Math.pow(10,Math.floor(Math.log(r/e)/Math.LN10)),i=e/r*o;return i<=.15?o*=10:i<=.35?o*=5:i<=.75&&(o*=2),n[0]=Math.ceil(n[0]/o)*o,n[1]=Math.floor(n[1]/o)*o+.5*o,n[2]=o,n}function Ra(t,e){return i.range.apply(i,ka(t,e))}function Ta(t,e,n){var r=ka(t,e);if(n){var o=De.exec(n);if(o.shift(),"s"===o[8]){var a=i.formatPrefix(Math.max(O(r[0]),O(r[1])));return o[7]||(o[7]="."+_a(a.scale(r[2]))),o[8]="f",n=i.format(o.join("")),function(t){return n(a.scale(t))+a.symbol}}o[7]||(o[7]="."+function(t,e){var n=_a(e[2]);return t in Ma?Math.abs(n-_a(Math.max(O(e[0]),O(e[1]))))+ +("e"!==t):n-2*("%"===t)}(o[8],r)),n=o.join("")}else n=",."+_a(r[2])+"f";return i.format(n)}i.scale.linear=function(){return function t(e,n,r,o){var i,a;function s(){var t=Math.min(e.length,n.length)>2?Oa:ma,s=o?Si:Ei;return i=t(e,n,s,r),a=t(n,e,s,ni),l}function l(t){return i(t)}l.invert=function(t){return a(t)};l.domain=function(t){return arguments.length?(e=t.map(Number),s()):e};l.range=function(t){return arguments.length?(n=t,s()):n};l.rangeRound=function(t){return l.range(t).interpolate(vi)};l.clamp=function(t){return arguments.length?(o=t,s()):o};l.interpolate=function(t){return arguments.length?(r=t,s()):r};l.ticks=function(t){return Ra(e,t)};l.tickFormat=function(t,n){return Ta(e,t,n)};l.nice=function(t){return Sa(e,t),s()};l.copy=function(){return t(e,n,r,o)};return s()}([0,1],[0,1],ni,!1)};var Ma={s:1,g:1,p:1,r:1,e:1};function _a(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}i.scale.log=function(){return function t(e,n,r,o){function a(t){return(r?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(n)}function s(t){return r?Math.pow(n,t):-Math.pow(n,-t)}function l(t){return e(a(t))}l.invert=function(t){return s(e.invert(t))};l.domain=function(t){return arguments.length?(r=t[0]>=0,e.domain((o=t.map(Number)).map(a)),l):o};l.base=function(t){return arguments.length?(n=+t,e.domain(o.map(a)),l):n};l.nice=function(){var t=ba(o.map(a),r?Math:Aa);return e.domain(t),o=t.map(s),l};l.ticks=function(){var t=va(o),e=[],i=t[0],l=t[1],u=Math.floor(a(i)),c=Math.ceil(a(l)),f=n%1?2:n;if(isFinite(c-u)){if(r){for(;u<c;u++)for(var h=1;h<f;h++)e.push(s(u)*h);e.push(s(u))}else for(e.push(s(u));u++<c;)for(var h=f-1;h>0;h--)e.push(s(u)*h);for(u=0;e[u]<i;u++);for(c=e.length;e[c-1]>l;c--);e=e.slice(u,c)}return e};l.tickFormat=function(t,e){if(!arguments.length)return Na;arguments.length<2?e=Na:"function"!=typeof e&&(e=i.format(e));var r=Math.max(1,n*t/l.ticks().length);return function(t){var o=t/s(Math.round(a(t)));return o*n<n-.5&&(o*=n),o<=r?e(t):""}};l.copy=function(){return t(e.copy(),n,r,o)};return Ea(l,e)}(i.scale.linear().domain([0,1]),10,!0,[1,10])};var Na=i.format(".0e"),Aa={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};function xa(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}i.scale.pow=function(){return function t(e,n,r){var o=xa(n),i=xa(1/n);function a(t){return e(o(t))}a.invert=function(t){return i(e.invert(t))};a.domain=function(t){return arguments.length?(e.domain((r=t.map(Number)).map(o)),a):r};a.ticks=function(t){return Ra(r,t)};a.tickFormat=function(t,e){return Ta(r,t,e)};a.nice=function(t){return a.domain(Sa(r,t))};a.exponent=function(t){return arguments.length?(o=xa(n=t),i=xa(1/n),e.domain(r.map(o)),a):n};a.copy=function(){return t(e.copy(),n,r)};return Ea(a,e)}(i.scale.linear(),1,[0,1])},i.scale.sqrt=function(){return i.scale.pow().exponent(.5)},i.scale.ordinal=function(){return function t(e,n){var r,o,a;function s(t){return o[((r.get(t)||("range"===n.t?r.set(t,e.push(t)):NaN))-1)%o.length]}function l(t,n){return i.range(e.length).map(function(e){return t+n*e})}s.domain=function(t){if(!arguments.length)return e;e=[],r=new S;for(var o,i=-1,a=t.length;++i<a;)r.has(o=t[i])||r.set(o,e.push(o));return s[n.t].apply(s,n.a)};s.range=function(t){return arguments.length?(o=t,a=0,n={t:"range",a:arguments},s):o};s.rangePoints=function(t,r){arguments.length<2&&(r=0);var i=t[0],u=t[1],c=e.length<2?(i=(i+u)/2,0):(u-i)/(e.length-1+r);return o=l(i+c*r/2,c),a=0,n={t:"rangePoints",a:arguments},s};s.rangeRoundPoints=function(t,r){arguments.length<2&&(r=0);var i=t[0],u=t[1],c=e.length<2?(i=u=Math.round((i+u)/2),0):(u-i)/(e.length-1+r)|0;return o=l(i+Math.round(c*r/2+(u-i-(e.length-1+r)*c)/2),c),a=0,n={t:"rangeRoundPoints",a:arguments},s};s.rangeBands=function(t,r,i){arguments.length<2&&(r=0),arguments.length<3&&(i=r);var u=t[1]<t[0],c=t[u-0],f=t[1-u],h=(f-c)/(e.length-r+2*i);return o=l(c+h*i,h),u&&o.reverse(),a=h*(1-r),n={t:"rangeBands",a:arguments},s};s.rangeRoundBands=function(t,r,i){arguments.length<2&&(r=0),arguments.length<3&&(i=r);var u=t[1]<t[0],c=t[u-0],f=t[1-u],h=Math.floor((f-c)/(e.length-r+2*i));return o=l(c+Math.round((f-c-(e.length-r)*h)/2),h),u&&o.reverse(),a=Math.round(h*(1-r)),n={t:"rangeRoundBands",a:arguments},s};s.rangeBand=function(){return a};s.rangeExtent=function(){return va(n.a[0])};s.copy=function(){return t(e,n)};return s.domain(e)}([],{t:"range",a:[[]]})},i.scale.category10=function(){return i.scale.ordinal().range(ja)},i.scale.category20=function(){return i.scale.ordinal().range(Ia)},i.scale.category20b=function(){return i.scale.ordinal().range(Da)},i.scale.category20c=function(){return i.scale.ordinal().range(Pa)};var ja=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(fe),Ia=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(fe),Da=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(fe),Pa=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(fe);function La(){return 0}i.scale.quantile=function(){return function t(e,n){var r;function o(){var t=0,o=n.length;for(r=[];++t<o;)r[t-1]=i.quantile(e,t/o);return a}function a(t){if(!isNaN(t=+t))return n[i.bisect(r,t)]}a.domain=function(t){return arguments.length?(e=t.map(y).filter(m).sort(v),o()):e};a.range=function(t){return arguments.length?(n=t,o()):n};a.quantiles=function(){return r};a.invertExtent=function(t){return(t=n.indexOf(t))<0?[NaN,NaN]:[t>0?r[t-1]:e[0],t<r.length?r[t]:e[e.length-1]]};a.copy=function(){return t(e,n)};return o()}([],[])},i.scale.quantize=function(){return function t(e,n,r){var o,i;function a(t){return r[Math.max(0,Math.min(i,Math.floor(o*(t-e))))]}function s(){return o=r.length/(n-e),i=r.length-1,a}a.domain=function(t){return arguments.length?(e=+t[0],n=+t[t.length-1],s()):[e,n]};a.range=function(t){return arguments.length?(r=t,s()):r};a.invertExtent=function(t){return[t=(t=r.indexOf(t))<0?NaN:t/o+e,t+1/o]};a.copy=function(){return t(e,n,r)};return s()}(0,1,[0,1])},i.scale.threshold=function(){return function t(e,n){function r(t){if(t<=t)return n[i.bisect(e,t)]}r.domain=function(t){return arguments.length?(e=t,r):e};r.range=function(t){return arguments.length?(n=t,r):n};r.invertExtent=function(t){return t=n.indexOf(t),[e[t-1],e[t]]};r.copy=function(){return t(e,n)};return r}([.5],[0,1])},i.scale.identity=function(){return function t(e){function n(t){return+t}n.invert=n;n.domain=n.range=function(t){return arguments.length?(e=t.map(n),n):e};n.ticks=function(t){return Ra(e,t)};n.tickFormat=function(t,n){return Ta(e,t,n)};n.copy=function(){return t(e)};return n}([0,1])},i.svg={},i.svg.arc=function(){var t=Fa,e=Ba,n=La,r=Ha,o=Wa,i=Va,a=Ua;function s(){var s=Math.max(0,+t.apply(this,arguments)),u=Math.max(0,+e.apply(this,arguments)),c=o.apply(this,arguments)-xt,f=i.apply(this,arguments)-xt,h=Math.abs(f-c),d=c>f?0:1;if(u<s&&(p=u,u=s,s=p),h>=At)return l(u,d)+(s?l(s,1-d):"")+"Z";var p,g,v,y,m,b,w,C,O,E,S,k,R=0,T=0,M=[];if((y=(+a.apply(this,arguments)||0)/2)&&(v=r===Ha?Math.sqrt(s*s+u*u):+r.apply(this,arguments),d||(T*=-1),u&&(T=Ht(v/u*Math.sin(y))),s&&(R=Ht(v/s*Math.sin(y)))),u){m=u*Math.cos(c+T),b=u*Math.sin(c+T),w=u*Math.cos(f-T),C=u*Math.sin(f-T);var _=Math.abs(f-c-2*T)<=_t?0:1;if(T&&Ya(m,b,w,C)===d^_){var N=(c+f)/2;m=u*Math.cos(N),b=u*Math.sin(N),w=C=null}}else m=b=0;if(s){O=s*Math.cos(f-R),E=s*Math.sin(f-R),S=s*Math.cos(c+R),k=s*Math.sin(c+R);var A=Math.abs(c-f+2*R)<=_t?0:1;if(R&&Ya(O,E,S,k)===1-d^A){var x=(c+f)/2;O=s*Math.cos(x),E=s*Math.sin(x),S=k=null}}else O=E=0;if(h>Tt&&(p=Math.min(Math.abs(u-s)/2,+n.apply(this,arguments)))>.001){g=s<u^d?0:1;var j=p,I=p;if(h<_t){var D=null==S?[O,E]:null==w?[m,b]:po([m,b],[S,k],[w,C],[O,E]),P=m-D[0],L=b-D[1],H=w-D[0],F=C-D[1],B=1/Math.sin(Math.acos((P*H+L*F)/(Math.sqrt(P*P+L*L)*Math.sqrt(H*H+F*F)))/2),W=Math.sqrt(D[0]*D[0]+D[1]*D[1]);I=Math.min(p,(s-W)/(B-1)),j=Math.min(p,(u-W)/(B+1))}if(null!=w){var V=za(null==S?[O,E]:[S,k],[m,b],u,j,d),U=za([w,C],[O,E],u,j,d);p===j?M.push("M",V[0],"A",j,",",j," 0 0,",g," ",V[1],"A",u,",",u," 0 ",1-d^Ya(V[1][0],V[1][1],U[1][0],U[1][1]),",",d," ",U[1],"A",j,",",j," 0 0,",g," ",U[0]):M.push("M",V[0],"A",j,",",j," 0 1,",g," ",U[0])}else M.push("M",m,",",b);if(null!=S){var Y=za([m,b],[S,k],s,-I,d),z=za([O,E],null==w?[m,b]:[w,C],s,-I,d);p===I?M.push("L",z[0],"A",I,",",I," 0 0,",g," ",z[1],"A",s,",",s," 0 ",d^Ya(z[1][0],z[1][1],Y[1][0],Y[1][1]),",",1-d," ",Y[1],"A",I,",",I," 0 0,",g," ",Y[0]):M.push("L",z[0],"A",I,",",I," 0 0,",g," ",Y[0])}else M.push("L",O,",",E)}else M.push("M",m,",",b),null!=w&&M.push("A",u,",",u," 0 ",_,",",d," ",w,",",C),M.push("L",O,",",E),null!=S&&M.push("A",s,",",s," 0 ",A,",",1-d," ",S,",",k);return M.push("Z"),M.join("")}function l(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}return s.innerRadius=function(e){return arguments.length?(t=we(e),s):t},s.outerRadius=function(t){return arguments.length?(e=we(t),s):e},s.cornerRadius=function(t){return arguments.length?(n=we(t),s):n},s.padRadius=function(t){return arguments.length?(r=t==Ha?Ha:we(t),s):r},s.startAngle=function(t){return arguments.length?(o=we(t),s):o},s.endAngle=function(t){return arguments.length?(i=we(t),s):i},s.padAngle=function(t){return arguments.length?(a=we(t),s):a},s.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+o.apply(this,arguments)+ +i.apply(this,arguments))/2-xt;return[Math.cos(r)*n,Math.sin(r)*n]},s};var Ha="auto";function Fa(t){return t.innerRadius}function Ba(t){return t.outerRadius}function Wa(t){return t.startAngle}function Va(t){return t.endAngle}function Ua(t){return t&&t.padAngle}function Ya(t,e,n,r){return(t-n)*e-(e-r)*t>0?0:1}function za(t,e,n,r,o){var i=t[0]-e[0],a=t[1]-e[1],s=(o?r:-r)/Math.sqrt(i*i+a*a),l=s*a,u=-s*i,c=t[0]+l,f=t[1]+u,h=e[0]+l,d=e[1]+u,p=(c+h)/2,g=(f+d)/2,v=h-c,y=d-f,m=v*v+y*y,b=n-r,w=c*d-h*f,C=(y<0?-1:1)*Math.sqrt(Math.max(0,b*b*m-w*w)),O=(w*y-v*C)/m,E=(-w*v-y*C)/m,S=(w*y+v*C)/m,k=(-w*v+y*C)/m,R=O-p,T=E-g,M=S-p,_=k-g;return R*R+T*T>M*M+_*_&&(O=S,E=k),[[O-l,E-u],[O*n/b,E*n/b]]}function Ga(t){var e=so,n=lo,r=Jn,o=qa,i=o.key,a=.7;function s(i){var s,l=[],u=[],c=-1,f=i.length,h=we(e),d=we(n);function p(){l.push("M",o(t(u),a))}for(;++c<f;)r.call(this,s=i[c],c)?u.push([+h.call(this,s,c),+d.call(this,s,c)]):u.length&&(p(),u=[]);return u.length&&p(),l.length?l.join(""):null}return s.x=function(t){return arguments.length?(e=t,s):e},s.y=function(t){return arguments.length?(n=t,s):n},s.defined=function(t){return arguments.length?(r=t,s):r},s.interpolate=function(t){return arguments.length?(i="function"==typeof t?o=t:(o=Xa.get(t)||qa).key,s):i},s.tension=function(t){return arguments.length?(a=t,s):a},s}i.svg.line=function(){return Ga(D)};var Xa=i.map({linear:qa,"linear-closed":Ka,step:function(t){var e=0,n=t.length,r=t[0],o=[r[0],",",r[1]];for(;++e<n;)o.push("H",(r[0]+(r=t[e])[0])/2,"V",r[1]);n>1&&o.push("H",r[0]);return o.join("")},"step-before":$a,"step-after":Za,basis:ts,"basis-open":function(t){if(t.length<4)return qa(t);var e,n=[],r=-1,o=t.length,i=[0],a=[0];for(;++r<3;)e=t[r],i.push(e[0]),a.push(e[1]);n.push(es(os,i)+","+es(os,a)),--r;for(;++r<o;)e=t[r],i.shift(),i.push(e[0]),a.shift(),a.push(e[1]),is(n,i,a);return n.join("")},"basis-closed":function(t){var e,n,r=-1,o=t.length,i=o+4,a=[],s=[];for(;++r<4;)n=t[r%o],a.push(n[0]),s.push(n[1]);e=[es(os,a),",",es(os,s)],--r;for(;++r<i;)n=t[r%o],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),is(e,a,s);return e.join("")},bundle:function(t,e){var n=t.length-1;if(n)for(var r,o,i=t[0][0],a=t[0][1],s=t[n][0]-i,l=t[n][1]-a,u=-1;++u<=n;)r=t[u],o=u/n,r[0]=e*r[0]+(1-e)*(i+o*s),r[1]=e*r[1]+(1-e)*(a+o*l);return ts(t)},cardinal:function(t,e){return t.length<3?qa(t):t[0]+Qa(t,Ja(t,e))},"cardinal-open":function(t,e){return t.length<4?qa(t):t[1]+Qa(t.slice(1,-1),Ja(t,e))},"cardinal-closed":function(t,e){return t.length<3?Ka(t):t[0]+Qa((t.push(t[0]),t),Ja([t[t.length-2]].concat(t,[t[1]]),e))},monotone:function(t){return t.length<3?qa(t):t[0]+Qa(t,function(t){var e,n,r,o,i=[],a=function(t){var e=0,n=t.length-1,r=[],o=t[0],i=t[1],a=r[0]=as(o,i);for(;++e<n;)r[e]=(a+(a=as(o=i,i=t[e+1])))/2;return r[e]=a,r}(t),s=-1,l=t.length-1;for(;++s<l;)e=as(t[s],t[s+1]),O(e)<Tt?a[s]=a[s+1]=0:(n=a[s]/e,r=a[s+1]/e,(o=n*n+r*r)>9&&(o=3*e/Math.sqrt(o),a[s]=o*n,a[s+1]=o*r));s=-1;for(;++s<=l;)o=(t[Math.min(l,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),i.push([o||0,a[s]*o||0]);return i}(t))}});function qa(t){return t.length>1?t.join("L"):t+"Z"}function Ka(t){return t.join("L")+"Z"}function $a(t){for(var e=0,n=t.length,r=t[0],o=[r[0],",",r[1]];++e<n;)o.push("V",(r=t[e])[1],"H",r[0]);return o.join("")}function Za(t){for(var e=0,n=t.length,r=t[0],o=[r[0],",",r[1]];++e<n;)o.push("H",(r=t[e])[0],"V",r[1]);return o.join("")}function Qa(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return qa(t);var n=t.length!=e.length,r="",o=t[0],i=t[1],a=e[0],s=a,l=1;if(n&&(r+="Q"+(i[0]-2*a[0]/3)+","+(i[1]-2*a[1]/3)+","+i[0]+","+i[1],o=t[1],l=2),e.length>1){s=e[1],i=t[l],l++,r+="C"+(o[0]+a[0])+","+(o[1]+a[1])+","+(i[0]-s[0])+","+(i[1]-s[1])+","+i[0]+","+i[1];for(var u=2;u<e.length;u++,l++)i=t[l],s=e[u],r+="S"+(i[0]-s[0])+","+(i[1]-s[1])+","+i[0]+","+i[1]}if(n){var c=t[l];r+="Q"+(i[0]+2*s[0]/3)+","+(i[1]+2*s[1]/3)+","+c[0]+","+c[1]}return r}function Ja(t,e){for(var n,r=[],o=(1-e)/2,i=t[0],a=t[1],s=1,l=t.length;++s<l;)n=i,i=a,a=t[s],r.push([o*(a[0]-n[0]),o*(a[1]-n[1])]);return r}function ts(t){if(t.length<3)return qa(t);var e=1,n=t.length,r=t[0],o=r[0],i=r[1],a=[o,o,o,(r=t[1])[0]],s=[i,i,i,r[1]],l=[o,",",i,"L",es(os,a),",",es(os,s)];for(t.push(t[n-1]);++e<=n;)r=t[e],a.shift(),a.push(r[0]),s.shift(),s.push(r[1]),is(l,a,s);return t.pop(),l.push("L",r),l.join("")}function es(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}Xa.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var ns=[0,2/3,1/3,0],rs=[0,1/3,2/3,0],os=[0,1/6,2/3,1/6];function is(t,e,n){t.push("C",es(ns,e),",",es(ns,n),",",es(rs,e),",",es(rs,n),",",es(os,e),",",es(os,n))}function as(t,e){return(e[1]-t[1])/(e[0]-t[0])}function ss(t){for(var e,n,r,o=-1,i=t.length;++o<i;)n=(e=t[o])[0],r=e[1]-xt,e[0]=n*Math.cos(r),e[1]=n*Math.sin(r);return t}function ls(t){var e=so,n=so,r=0,o=lo,i=Jn,a=qa,s=a.key,l=a,u="L",c=.7;function f(s){var f,h,d,p=[],g=[],v=[],y=-1,m=s.length,b=we(e),w=we(r),C=e===n?function(){return h}:we(n),O=r===o?function(){return d}:we(o);function E(){p.push("M",a(t(v),c),u,l(t(g.reverse()),c),"Z")}for(;++y<m;)i.call(this,f=s[y],y)?(g.push([h=+b.call(this,f,y),d=+w.call(this,f,y)]),v.push([+C.call(this,f,y),+O.call(this,f,y)])):g.length&&(E(),g=[],v=[]);return g.length&&E(),p.length?p.join(""):null}return f.x=function(t){return arguments.length?(e=n=t,f):n},f.x0=function(t){return arguments.length?(e=t,f):e},f.x1=function(t){return arguments.length?(n=t,f):n},f.y=function(t){return arguments.length?(r=o=t,f):o},f.y0=function(t){return arguments.length?(r=t,f):r},f.y1=function(t){return arguments.length?(o=t,f):o},f.defined=function(t){return arguments.length?(i=t,f):i},f.interpolate=function(t){return arguments.length?(s="function"==typeof t?a=t:(a=Xa.get(t)||qa).key,l=a.reverse||a,u=a.closed?"M":"L",f):s},f.tension=function(t){return arguments.length?(c=t,f):c},f}function us(t){return t.radius}function cs(t){return[t.x,t.y]}function fs(){return 64}function hs(){return"circle"}function ds(t){var e=Math.sqrt(t/_t);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}i.svg.line.radial=function(){var t=Ga(ss);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},$a.reverse=Za,Za.reverse=$a,i.svg.area=function(){return ls(D)},i.svg.area.radial=function(){var t=ls(ss);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},i.svg.chord=function(){var t=Xr,e=qr,n=us,r=Wa,o=Va;function i(n,r){var o,i,u=a(this,t,n,r),c=a(this,e,n,r);return"M"+u.p0+s(u.r,u.p1,u.a1-u.a0)+(i=c,(o=u).a0==i.a0&&o.a1==i.a1?l(u.r,u.p1,u.r,u.p0):l(u.r,u.p1,c.r,c.p0)+s(c.r,c.p1,c.a1-c.a0)+l(c.r,c.p1,u.r,u.p0))+"Z"}function a(t,e,i,a){var s=e.call(t,i,a),l=n.call(t,s,a),u=r.call(t,s,a)-xt,c=o.call(t,s,a)-xt;return{r:l,a0:u,a1:c,p0:[l*Math.cos(u),l*Math.sin(u)],p1:[l*Math.cos(c),l*Math.sin(c)]}}function s(t,e,n){return"A"+t+","+t+" 0 "+ +(n>_t)+",1 "+e}function l(t,e,n,r){return"Q 0,0 "+r}return i.radius=function(t){return arguments.length?(n=we(t),i):n},i.source=function(e){return arguments.length?(t=we(e),i):t},i.target=function(t){return arguments.length?(e=we(t),i):e},i.startAngle=function(t){return arguments.length?(r=we(t),i):r},i.endAngle=function(t){return arguments.length?(o=we(t),i):o},i},i.svg.diagonal=function(){var t=Xr,e=qr,n=cs;function r(r,o){var i=t.call(this,r,o),a=e.call(this,r,o),s=(i.y+a.y)/2,l=[i,{x:i.x,y:s},{x:a.x,y:s},a];return"M"+(l=l.map(n))[0]+"C"+l[1]+" "+l[2]+" "+l[3]}return r.source=function(e){return arguments.length?(t=we(e),r):t},r.target=function(t){return arguments.length?(e=we(t),r):e},r.projection=function(t){return arguments.length?(n=t,r):n},r},i.svg.diagonal.radial=function(){var t=i.svg.diagonal(),e=cs,n=t.projection;return t.projection=function(t){return arguments.length?n(function(t){return function(){var e=t.apply(this,arguments),n=e[0],r=e[1]-xt;return[n*Math.cos(r),n*Math.sin(r)]}}(e=t)):e},t},i.svg.symbol=function(){var t=hs,e=fs;function n(n,r){return(ps.get(t.call(this,n,r))||ds)(e.call(this,n,r))}return n.type=function(e){return arguments.length?(t=we(e),n):t},n.size=function(t){return arguments.length?(e=we(t),n):e},n};var ps=i.map({circle:ds,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*vs)),n=e*vs;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/gs),n=e*gs/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/gs),n=e*gs/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});i.svg.symbolTypes=ps.keys();var gs=Math.sqrt(3),vs=Math.tan(30*jt);Z.transition=function(t){for(var e,n,r=ws||++Es,o=Rs(t),i=[],a=Cs||{time:Date.now(),ease:fi,delay:0,duration:250},s=-1,l=this.length;++s<l;){i.push(e=[]);for(var u=this[s],c=-1,f=u.length;++c<f;)(n=u[c])&&Ts(n,c,o,r,a),e.push(n)}return bs(i,o,r)},Z.interrupt=function(t){return this.each(null==t?ys:ms(Rs(t)))};var ys=ms(Rs());function ms(t){return function(){var e,n,r;(e=this[t])&&(r=e[n=e.active])&&(r.timer.c=null,r.timer.t=NaN,--e.count?delete e[n]:delete this[t],e.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function bs(t,e,n){return G(t,Os),t.namespace=e,t.id=n,t}var ws,Cs,Os=[],Es=0;function Ss(t,e,n,r){var o=t.id,i=t.namespace;return pt(t,"function"==typeof n?function(t,a,s){t[i][o].tween.set(e,r(n.call(t,t.__data__,a,s)))}:(n=r(n),function(t){t[i][o].tween.set(e,n)}))}function ks(t){return null==t&&(t=""),function(){this.textContent=t}}function Rs(t){return null==t?"__transition__":"__transition_"+t+"__"}function Ts(t,e,n,r,o){var i,a,s,l,u,c=t[n]||(t[n]={active:0,count:0}),f=c[r];function h(n){var o=c.active,h=c[o];for(var p in h&&(h.timer.c=null,h.timer.t=NaN,--c.count,delete c[o],h.event&&h.event.interrupt.call(t,t.__data__,h.index)),c)if(+p<r){var g=c[p];g.timer.c=null,g.timer.t=NaN,--c.count,delete c[p]}a.c=d,Me(function(){return a.c&&d(n||1)&&(a.c=null,a.t=NaN),1},0,i),c.active=r,f.event&&f.event.start.call(t,t.__data__,e),u=[],f.tween.forEach(function(n,r){(r=r.call(t,t.__data__,e))&&u.push(r)}),l=f.ease,s=f.duration}function d(o){for(var i=o/s,a=l(i),h=u.length;h>0;)u[--h].call(t,a);if(i>=1)return f.event&&f.event.end.call(t,t.__data__,e),--c.count?delete c[r]:delete t[n],1}f||(i=o.time,a=Me(function(t){var e=f.delay;if(a.t=e+i,e<=t)return h(t-e);a.c=h},0,i),f=c[r]={tween:new S,time:i,timer:a,delay:o.delay,duration:o.duration,ease:o.ease,index:e},o=null,++c.count)}Os.call=Z.call,Os.empty=Z.empty,Os.node=Z.node,Os.size=Z.size,i.transition=function(t,e){return t&&t.transition?ws?t.transition(e):t:i.selection().transition(t)},i.transition.prototype=Os,Os.select=function(t){var e,n,r,o=this.id,i=this.namespace,a=[];t=Q(t);for(var s=-1,l=this.length;++s<l;){a.push(e=[]);for(var u=this[s],c=-1,f=u.length;++c<f;)(r=u[c])&&(n=t.call(r,r.__data__,c,s))?("__data__"in r&&(n.__data__=r.__data__),Ts(n,c,i,o,r[i][o]),e.push(n)):e.push(null)}return bs(a,i,o)},Os.selectAll=function(t){var e,n,r,o,i,a=this.id,s=this.namespace,l=[];t=J(t);for(var u=-1,c=this.length;++u<c;)for(var f=this[u],h=-1,d=f.length;++h<d;)if(r=f[h]){i=r[s][a],n=t.call(r,r.__data__,h,u),l.push(e=[]);for(var p=-1,g=n.length;++p<g;)(o=n[p])&&Ts(o,p,s,a,i),e.push(o)}return bs(l,s,a)},Os.filter=function(t){var e,n,r=[];"function"!=typeof t&&(t=dt(t));for(var o=0,i=this.length;o<i;o++){r.push(e=[]);for(var a,s=0,l=(a=this[o]).length;s<l;s++)(n=a[s])&&t.call(n,n.__data__,s,o)&&e.push(n)}return bs(r,this.namespace,this.id)},Os.tween=function(t,e){var n=this.id,r=this.namespace;return arguments.length<2?this.node()[r][n].tween.get(t):pt(this,null==e?function(e){e[r][n].tween.remove(t)}:function(o){o[r][n].tween.set(t,e)})},Os.attr=function(t,e){if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var n="transform"==t?Oi:ni,r=i.ns.qualify(t);function o(){this.removeAttribute(r)}function a(){this.removeAttributeNS(r.space,r.local)}return Ss(this,"attr."+t,e,r.local?function(t){return null==t?a:(t+="",function(){var e,o=this.getAttributeNS(r.space,r.local);return o!==t&&(e=n(o,t),function(t){this.setAttributeNS(r.space,r.local,e(t))})})}:function(t){return null==t?o:(t+="",function(){var e,o=this.getAttribute(r);return o!==t&&(e=n(o,t),function(t){this.setAttribute(r,e(t))})})})},Os.attrTween=function(t,e){var n=i.ns.qualify(t);return this.tween("attr."+t,n.local?function(t,r){var o=e.call(this,t,r,this.getAttributeNS(n.space,n.local));return o&&function(t){this.setAttributeNS(n.space,n.local,o(t))}}:function(t,r){var o=e.call(this,t,r,this.getAttribute(n));return o&&function(t){this.setAttribute(n,o(t))}})},Os.style=function(t,e,n){var r=arguments.length;if(r<3){if("string"!=typeof t){for(n in r<2&&(e=""),t)this.style(n,t[n],e);return this}n=""}function o(){this.style.removeProperty(t)}return Ss(this,"style."+t,e,function(e){return null==e?o:(e+="",function(){var r,o=c(this).getComputedStyle(this,null).getPropertyValue(t);return o!==e&&(r=ni(o,e),function(e){this.style.setProperty(t,r(e),n)})})})},Os.styleTween=function(t,e,n){return arguments.length<3&&(n=""),this.tween("style."+t,function(r,o){var i=e.call(this,r,o,c(this).getComputedStyle(this,null).getPropertyValue(t));return i&&function(e){this.style.setProperty(t,i(e),n)}})},Os.text=function(t){return Ss(this,"text",t,ks)},Os.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)})},Os.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=i.ease.apply(i,arguments)),pt(this,function(r){r[n][e].ease=t}))},Os.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:pt(this,"function"==typeof t?function(r,o,i){r[n][e].delay=+t.call(r,r.__data__,o,i)}:(t=+t,function(r){r[n][e].delay=t}))},Os.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:pt(this,"function"==typeof t?function(r,o,i){r[n][e].duration=Math.max(1,t.call(r,r.__data__,o,i))}:(t=Math.max(1,t),function(r){r[n][e].duration=t}))},Os.each=function(t,e){var n=this.id,r=this.namespace;if(arguments.length<2){var o=Cs,a=ws;try{ws=n,pt(this,function(e,o,i){Cs=e[r][n],t.call(e,e.__data__,o,i)})}finally{Cs=o,ws=a}}else pt(this,function(o){var a=o[r][n];(a.event||(a.event=i.dispatch("start","end","interrupt"))).on(t,e)});return this},Os.transition=function(){for(var t,e,n,r=this.id,o=++Es,i=this.namespace,a=[],s=0,l=this.length;s<l;s++){a.push(t=[]);for(var u,c=0,f=(u=this[s]).length;c<f;c++)(e=u[c])&&Ts(e,c,i,o,{time:(n=e[i][r]).time,ease:n.ease,delay:n.delay+n.duration,duration:n.duration}),t.push(e)}return bs(a,i,o)},i.svg.axis=function(){var t,e=i.scale.linear(),n=Ms,r=6,o=6,a=3,l=[10],u=null;function c(s){s.each(function(){var s,c=i.select(this),f=this.__chart__||e,h=this.__chart__=e.copy(),d=null==u?h.ticks?h.ticks.apply(h,l):h.domain():u,p=null==t?h.tickFormat?h.tickFormat.apply(h,l):D:t,g=c.selectAll(".tick").data(d,h),v=g.enter().insert("g",".domain").attr("class","tick").style("opacity",Tt),y=i.transition(g.exit()).style("opacity",Tt).remove(),m=i.transition(g.order()).style("opacity",1),b=Math.max(r,0)+a,w=ya(h),C=c.selectAll(".domain").data([0]),O=(C.enter().append("path").attr("class","domain"),i.transition(C));v.append("line"),v.append("text");var E,S,k,R,T=v.select("line"),M=m.select("line"),_=g.select("text").text(p),N=v.select("text"),A=m.select("text"),x="top"===n||"left"===n?-1:1;if("bottom"===n||"top"===n?(s=Ns,E="x",k="y",S="x2",R="y2",_.attr("dy",x<0?"0em":".71em").style("text-anchor","middle"),O.attr("d","M"+w[0]+","+x*o+"V0H"+w[1]+"V"+x*o)):(s=As,E="y",k="x",S="y2",R="x2",_.attr("dy",".32em").style("text-anchor",x<0?"end":"start"),O.attr("d","M"+x*o+","+w[0]+"H0V"+w[1]+"H"+x*o)),T.attr(R,x*r),N.attr(k,x*b),M.attr(S,0).attr(R,x*r),A.attr(E,0).attr(k,x*b),h.rangeBand){var j=h,I=j.rangeBand()/2;f=h=function(t){return j(t)+I}}else f.rangeBand?f=h:y.call(s,h,f);v.call(s,f,h),m.call(s,h,h)})}return c.scale=function(t){return arguments.length?(e=t,c):e},c.orient=function(t){return arguments.length?(n=t in _s?t+"":Ms,c):n},c.ticks=function(){return arguments.length?(l=s(arguments),c):l},c.tickValues=function(t){return arguments.length?(u=t,c):u},c.tickFormat=function(e){return arguments.length?(t=e,c):t},c.tickSize=function(t){var e=arguments.length;return e?(r=+t,o=+arguments[e-1],c):r},c.innerTickSize=function(t){return arguments.length?(r=+t,c):r},c.outerTickSize=function(t){return arguments.length?(o=+t,c):o},c.tickPadding=function(t){return arguments.length?(a=+t,c):a},c.tickSubdivide=function(){return arguments.length&&c},c};var Ms="bottom",_s={top:1,right:1,bottom:1,left:1};function Ns(t,e,n){t.attr("transform",function(t){var r=e(t);return"translate("+(isFinite(r)?r:n(t))+",0)"})}function As(t,e,n){t.attr("transform",function(t){var r=e(t);return"translate(0,"+(isFinite(r)?r:n(t))+")"})}i.svg.brush=function(){var t,e,n=Y(h,"brushstart","brush","brushend"),r=null,o=null,a=[0,0],s=[0,0],l=!0,u=!0,f=js[0];function h(t){t.each(function(){var t=i.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",v).on("touchstart.brush",v),e=t.selectAll(".background").data([0]);e.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var n=t.selectAll(".resize").data(f,D);n.exit().remove(),n.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return xs[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),n.style("display",h.empty()?"none":null);var a,s=i.transition(t),l=i.transition(e);r&&(a=ya(r),l.attr("x",a[0]).attr("width",a[1]-a[0]),p(s)),o&&(a=ya(o),l.attr("y",a[0]).attr("height",a[1]-a[0]),g(s)),d(s)})}function d(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+a[+/e$/.test(t)]+","+s[+/^s/.test(t)]+")"})}function p(t){t.select(".extent").attr("x",a[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",a[1]-a[0])}function g(t){t.select(".extent").attr("y",s[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",s[1]-s[0])}function v(){var f,v,y=this,m=i.select(i.event.target),b=n.of(y,arguments),w=i.select(y),C=m.datum(),O=!/^(n|s)$/.test(C)&&r,E=!/^(e|w)$/.test(C)&&o,S=m.classed("extent"),k=Et(y),R=i.mouse(y),T=i.select(c(y)).on("keydown.brush",function(){32==i.event.keyCode&&(S||(f=null,R[0]-=a[1],R[1]-=s[1],S=2),V())}).on("keyup.brush",function(){32==i.event.keyCode&&2==S&&(R[0]+=a[1],R[1]+=s[1],S=0,V())});if(i.event.changedTouches?T.on("touchmove.brush",N).on("touchend.brush",x):T.on("mousemove.brush",N).on("mouseup.brush",x),w.interrupt().selectAll("*").interrupt(),S)R[0]=a[0]-R[0],R[1]=s[0]-R[1];else if(C){var M=+/w$/.test(C),_=+/^n/.test(C);v=[a[1-M]-R[0],s[1-_]-R[1]],R[0]=a[M],R[1]=s[_]}else i.event.altKey&&(f=R.slice());function N(){var t=i.mouse(y),e=!1;v&&(t[0]+=v[0],t[1]+=v[1]),S||(i.event.altKey?(f||(f=[(a[0]+a[1])/2,(s[0]+s[1])/2]),R[0]=a[+(t[0]<f[0])],R[1]=s[+(t[1]<f[1])]):f=null),O&&A(t,r,0)&&(p(w),e=!0),E&&A(t,o,1)&&(g(w),e=!0),e&&(d(w),b({type:"brush",mode:S?"move":"resize"}))}function A(n,r,o){var i,c,h=ya(r),d=h[0],p=h[1],g=R[o],v=o?s:a,y=v[1]-v[0];if(S&&(d-=g,p-=y+g),i=(o?u:l)?Math.max(d,Math.min(p,n[o])):n[o],S?c=(i+=g)+y:(f&&(g=Math.max(d,Math.min(p,2*f[o]-i))),g<i?(c=i,i=g):c=g),v[0]!=i||v[1]!=c)return o?e=null:t=null,v[0]=i,v[1]=c,!0}function x(){N(),w.style("pointer-events","all").selectAll(".resize").style("display",h.empty()?"none":null),i.select("body").style("cursor",null),T.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),k(),b({type:"brushend"})}w.style("pointer-events","none").selectAll(".resize").style("display",null),i.select("body").style("cursor",m.style("cursor")),b({type:"brushstart"}),N()}return h.event=function(r){r.each(function(){var r=n.of(this,arguments),o={x:a,y:s,i:t,j:e},l=this.__chart__||o;this.__chart__=o,ws?i.select(this).transition().each("start.brush",function(){t=l.i,e=l.j,a=l.x,s=l.y,r({type:"brushstart"})}).tween("brush:brush",function(){var n=ri(a,o.x),i=ri(s,o.y);return t=e=null,function(t){a=o.x=n(t),s=o.y=i(t),r({type:"brush",mode:"resize"})}}).each("end.brush",function(){t=o.i,e=o.j,r({type:"brush",mode:"resize"}),r({type:"brushend"})}):(r({type:"brushstart"}),r({type:"brush",mode:"resize"}),r({type:"brushend"}))})},h.x=function(t){return arguments.length?(f=js[!(r=t)<<1|!o],h):r},h.y=function(t){return arguments.length?(f=js[!r<<1|!(o=t)],h):o},h.clamp=function(t){return arguments.length?(r&&o?(l=!!t[0],u=!!t[1]):r?l=!!t:o&&(u=!!t),h):r&&o?[l,u]:r?l:o?u:null},h.extent=function(n){var i,l,u,c,f;return arguments.length?(r&&(i=n[0],l=n[1],o&&(i=i[0],l=l[0]),t=[i,l],r.invert&&(i=r(i),l=r(l)),l<i&&(f=i,i=l,l=f),i==a[0]&&l==a[1]||(a=[i,l])),o&&(u=n[0],c=n[1],r&&(u=u[1],c=c[1]),e=[u,c],o.invert&&(u=o(u),c=o(c)),c<u&&(f=u,u=c,c=f),u==s[0]&&c==s[1]||(s=[u,c])),h):(r&&(t?(i=t[0],l=t[1]):(i=a[0],l=a[1],r.invert&&(i=r.invert(i),l=r.invert(l)),l<i&&(f=i,i=l,l=f))),o&&(e?(u=e[0],c=e[1]):(u=s[0],c=s[1],o.invert&&(u=o.invert(u),c=o.invert(c)),c<u&&(f=u,u=c,c=f))),r&&o?[[i,u],[l,c]]:r?[i,l]:o&&[u,c])},h.clear=function(){return h.empty()||(a=[0,0],s=[0,0],t=e=null),h},h.empty=function(){return!!r&&a[0]==a[1]||!!o&&s[0]==s[1]},i.rebind(h,n,"on")};var xs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},js=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Is=He.format=pn.timeFormat,Ds=Is.utc,Ps=Ds("%Y-%m-%dT%H:%M:%S.%LZ");function Ls(t){return t.toISOString()}function Hs(t,e,n){function r(e){return t(e)}function o(t,n){var r=(t[1]-t[0])/n,o=i.bisect(Bs,r);return o==Bs.length?[e.year,ka(t.map(function(t){return t/31536e6}),n)[2]]:o?e[r/Bs[o-1]<Bs[o]/r?o-1:o]:[Us,ka(t,n)[2]]}return r.invert=function(e){return Fs(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain(e),r):t.domain().map(Fs)},r.nice=function(t,e){var n=r.domain(),i=va(n),a=null==t?o(i,10):"number"==typeof t&&o(i,t);function s(n){return!isNaN(n)&&!t.range(n,Fs(+n+1),e).length}return a&&(t=a[0],e=a[1]),r.domain(ba(n,e>1?{floor:function(e){for(;s(e=t.floor(e));)e=Fs(e-1);return e},ceil:function(e){for(;s(e=t.ceil(e));)e=Fs(+e+1);return e}}:t))},r.ticks=function(t,e){var n=va(r.domain()),i=null==t?o(n,10):"number"==typeof t?o(n,t):!t.range&&[{range:t},e];return i&&(t=i[0],e=i[1]),t.range(n[0],Fs(+n[1]+1),e<1?1:e)},r.tickFormat=function(){return n},r.copy=function(){return Hs(t.copy(),e,n)},Ea(r,t)}function Fs(t){return new Date(t)}Is.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Ls:Ps,Ls.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Ls.toString=Ps.toString,He.second=Ve(function(t){return new Fe(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),He.seconds=He.second.range,He.seconds.utc=He.second.utc.range,He.minute=Ve(function(t){return new Fe(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),He.minutes=He.minute.range,He.minutes.utc=He.minute.utc.range,He.hour=Ve(function(t){var e=t.getTimezoneOffset()/60;return new Fe(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),He.hours=He.hour.range,He.hours.utc=He.hour.utc.range,He.month=Ve(function(t){return(t=He.day(t)).setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),He.months=He.month.range,He.months.utc=He.month.utc.range;var Bs=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Ws=[[He.second,1],[He.second,5],[He.second,15],[He.second,30],[He.minute,1],[He.minute,5],[He.minute,15],[He.minute,30],[He.hour,1],[He.hour,3],[He.hour,6],[He.hour,12],[He.day,1],[He.day,2],[He.week,1],[He.month,1],[He.month,3],[He.year,1]],Vs=Is.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Jn]]),Us={range:function(t,e,n){return i.range(Math.ceil(t/n)*n,+e,n).map(Fs)},floor:D,ceil:D};Ws.year=He.year,He.scale=function(){return Hs(i.scale.linear(),Ws,Vs)};var Ys=Ws.map(function(t){return[t[0].utc,t[1]]}),zs=Ds.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Jn]]);function Gs(t){return JSON.parse(t.responseText)}function Xs(t){var e=l.createRange();return e.selectNode(l.body),e.createContextualFragment(t.responseText)}Ys.year=He.year.utc,He.scale.utc=function(){return Hs(i.scale.linear(),Ys,zs)},i.text=Ce(function(t){return t.responseText}),i.json=function(t,e){return Oe(t,"application/json",Gs,e)},i.html=function(t,e){return Oe(t,"text/html",Xs,e)},i.xml=Ce(function(t){return t.responseXML}),this.d3=i,void 0===(o="function"==typeof(r=i)?r.call(e,n,e,t):r)||(t.exports=o)}()},function(t,e,n){"use strict";var r=n(110),o=n(85),i=n(57),a=n(68),s=n(145),l=n(121),u=Math.max,c=Math.min,f=n(106)("splice");n(27)({target:"Array",proto:!0,forced:!f},{splice:function(t,e){var n,f,h,d,p,g,v=a(this),y=i(v.length),m=r(t,y),b=arguments.length;if(0===b?n=f=0:1===b?(n=0,f=y-m):(n=b-2,f=c(u(o(e),0),y-m)),y+n-f>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(h=s(v,f),d=0;d<f;d++)(p=m+d)in v&&l(h,d,v[p]);if(h.length=f,n<f){for(d=m;d<y-f;d++)g=d+n,(p=d+f)in v?v[g]=v[p]:delete v[g];for(d=y;d>y-f+n;d--)delete v[d-1]}else if(n>f)for(d=y-f;d>m;d--)g=d+n-1,(p=d+f-1)in v?v[g]=v[p]:delete v[g];for(d=0;d<n;d++)v[d+m]=arguments[d+2];return v.length=y-f+n,h}})},function(t,e,n){"use strict";var r=n(134)(!0);n(27)({target:"Array",proto:!0},{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(116)("includes")},function(t,e,n){var r=n(41),o=n(182),i=[].slice,a=/MSIE .\./.test(o),s=function(t){return function(e,n){var r=arguments.length>2,o=!!r&&i.call(arguments,2);return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,o)}:e,n)}};n(27)({global:!0,bind:!0,forced:a},{setTimeout:s(r.setTimeout),setInterval:s(r.setInterval)})},function(t,e,n){var r=n(100)("wks"),o=n(113),i=n(41).Symbol,a=n(163);t.exports=function(t){return r[t]||(r[t]=a&&i[t]||(a?i:o)("Symbol."+t))}},function(t,e,n){var o;"undefined"!=typeof self&&self,o=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=15)}([function(t,e){e.nil=new Error("#NULL!"),e.div0=new Error("#DIV/0!"),e.value=new Error("#VALUE!"),e.ref=new Error("#REF!"),e.name=new Error("#NAME?"),e.num=new Error("#NUM!"),e.na=new Error("#N/A"),e.error=new Error("#ERROR!"),e.data=new Error("#GETTING_DATA")},function(t,e,n){var r=n(0);e.flattenShallow=function(t){return t&&t.reduce?t.reduce(function(t,e){var n=Array.isArray(t),r=Array.isArray(e);return n&&r?t.concat(e):n?(t.push(e),t):r?[t].concat(e):[t,e]}):t},e.isFlat=function(t){if(!t)return!1;for(var e=0;e<t.length;++e)if(Array.isArray(t[e]))return!1;return!0},e.flatten=function(){for(var t=e.argsToArray.apply(null,arguments);!e.isFlat(t);)t=e.flattenShallow(t);return t},e.argsToArray=function(t){var n=[];return e.arrayEach(t,function(t){n.push(t)}),n},e.numbers=function(){return this.flatten.apply(null,arguments).filter(function(t){return"number"==typeof t})},e.cleanFloat=function(t){return Math.round(1e14*t)/1e14},e.parseBool=function(t){if("boolean"==typeof t)return t;if(t instanceof Error)return t;if("number"==typeof t)return 0!==t;if("string"==typeof t){var e=t.toUpperCase();if("TRUE"===e)return!0;if("FALSE"===e)return!1}return t instanceof Date&&!isNaN(t)||r.value},e.parseNumber=function(t){return void 0===t||""===t?r.value:isNaN(t)?r.value:parseFloat(t)},e.parseNumberArray=function(t){var n,o;if(!t||0===(n=t.length))return r.value;for(;n--;){if((o=e.parseNumber(t[n]))===r.value)return o;t[n]=o}return t},e.parseMatrix=function(t){var n;if(!t||0===t.length)return r.value;for(var o=0;o<t.length;o++)if(n=e.parseNumberArray(t[o]),t[o]=n,n instanceof Error)return n;return t};var o=new Date(Date.UTC(1900,0,1));e.parseDate=function(t){if(!isNaN(t)){if(t instanceof Date)return new Date(t);var e=parseInt(t,10);return e<0?r.num:e<=60?new Date(o.getTime()+864e5*(e-1)):new Date(o.getTime()+864e5*(e-2))}return"string"!=typeof t||(t=new Date(t),isNaN(t))?r.value:t},e.parseDateArray=function(t){for(var e,n=t.length;n--;){if((e=this.parseDate(t[n]))===r.value)return e;t[n]=e}return t},e.anyIsError=function(){for(var t=arguments.length;t--;)if(arguments[t]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(t){for(var e,n=t.length;n--;)if("number"!=typeof(e=t[n]))if(!0!==e)if(!1!==e){if("string"==typeof e){var r=this.parseNumber(e);r instanceof Error?t[n]=0:t[n]=r}}else t[n]=0;else t[n]=1;return t},e.rest=function(t,e){return e=e||1,t&&"function"==typeof t.slice?t.slice(e):t},e.initial=function(t,e){return e=e||1,t&&"function"==typeof t.slice?t.slice(0,t.length-e):t},e.arrayEach=function(t,e){for(var n=-1,r=t.length;++n<r&&!1!==e(t[n],n,t););return t},e.transpose=function(t){return t?t[0].map(function(e,n){return t.map(function(t){return t[n]})}):r.value}},function(t,e,n){"use strict";var r;e.__esModule=!0,e.default=function(t){var e=void 0;t=(t+"").replace(/#|!|\?/g,""),h[t]&&(e=h[t]);return e||null},e.isValidStrict=function(t){var e=!1;for(var n in h)if(Object.prototype.hasOwnProperty.call(h,n)&&h[n]===t){e=!0;break}return e};var o=e.ERROR="ERROR",i=e.ERROR_DIV_ZERO="DIV/0",a=e.ERROR_NAME="NAME",s=e.ERROR_NOT_AVAILABLE="N/A",l=e.ERROR_NULL="NULL",u=e.ERROR_NUM="NUM",c=e.ERROR_REF="REF",f=e.ERROR_VALUE="VALUE",h=((r={})[o]="#ERROR!",r[i]="#DIV/0!",r[a]="#NAME?",r[s]="#N/A",r[l]="#NULL!",r[u]="#NUM!",r[c]="#REF!",r[f]="#VALUE!",r)},function(t,e,n){"use strict";function r(t){var e=void 0;return"number"==typeof t?e=t:"string"==typeof t&&(e=t.indexOf(".")>-1?parseFloat(t):parseInt(t,10)),e}e.__esModule=!0,e.toNumber=r,e.invertNumber=function(t){return-1*r(t)}},function(t,e,n){var r=n(1),o=n(0),i=n(5),a=n(8),s=n(7);e.ABS=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.abs(t)},e.ACOS=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.acos(t);return isNaN(e)&&(e=o.num),e},e.ACOSH=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.log(t+Math.sqrt(t*t-1));return isNaN(e)&&(e=o.num),e},e.ACOT=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.atan(1/t)},e.ACOTH=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=.5*Math.log((t+1)/(t-1));return isNaN(e)&&(e=o.num),e},e.AGGREGATE=function(t,n,a,s){if(t=r.parseNumber(t),n=r.parseNumber(t),r.anyIsError(t,n))return o.value;switch(t){case 1:return i.AVERAGE(a);case 2:return i.COUNT(a);case 3:return i.COUNTA(a);case 4:return i.MAX(a);case 5:return i.MIN(a);case 6:return e.PRODUCT(a);case 7:return i.STDEV.S(a);case 8:return i.STDEV.P(a);case 9:return e.SUM(a);case 10:return i.VAR.S(a);case 11:return i.VAR.P(a);case 12:return i.MEDIAN(a);case 13:return i.MODE.SNGL(a);case 14:return i.LARGE(a,s);case 15:return i.SMALL(a,s);case 16:return i.PERCENTILE.INC(a,s);case 17:return i.QUARTILE.INC(a,s);case 18:return i.PERCENTILE.EXC(a,s);case 19:return i.QUARTILE.EXC(a,s)}},e.ARABIC=function(t){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return o.value;var e=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(t){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]}),e},e.ASIN=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.asin(t);return isNaN(e)&&(e=o.num),e},e.ASINH=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.log(t+Math.sqrt(t*t+1))},e.ATAN=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.atan(t)},e.ATAN2=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:Math.atan2(t,e)},e.ATANH=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.log((1+t)/(1-t))/2;return isNaN(e)&&(e=o.num),e},e.BASE=function(t,e,n){if(n=n||0,t=r.parseNumber(t),e=r.parseNumber(e),n=r.parseNumber(n),r.anyIsError(t,e,n))return o.value;n=void 0===n?0:n;var i=t.toString(e);return new Array(Math.max(n+1-i.length,0)).join("0")+i},e.CEILING=function(t,n,i){if(n=void 0===n?1:Math.abs(n),i=i||0,t=r.parseNumber(t),n=r.parseNumber(n),i=r.parseNumber(i),r.anyIsError(t,n,i))return o.value;if(0===n)return 0;var a=-Math.floor(Math.log(n)/Math.log(10));return t>=0?e.ROUND(Math.ceil(t/n)*n,a):0===i?-e.ROUND(Math.floor(Math.abs(t)/n)*n,a):-e.ROUND(Math.ceil(Math.abs(t)/n)*n,a)},e.CEILING.MATH=e.CEILING,e.CEILING.PRECISE=e.CEILING,e.COMBIN=function(t,n){return t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n)?o.value:e.FACT(t)/(e.FACT(n)*e.FACT(t-n))},e.COMBINA=function(t,n){return t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n)?o.value:0===t&&0===n?1:e.COMBIN(t+n-1,t-1)},e.COS=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.cos(t)},e.COSH=function(t){return(t=r.parseNumber(t))instanceof Error?t:(Math.exp(t)+Math.exp(-t))/2},e.COT=function(t){return(t=r.parseNumber(t))instanceof Error?t:1/Math.tan(t)},e.COTH=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e+1)/(e-1)},e.CSC=function(t){return(t=r.parseNumber(t))instanceof Error?t:1/Math.sin(t)},e.CSCH=function(t){return(t=r.parseNumber(t))instanceof Error?t:2/(Math.exp(t)-Math.exp(-t))},e.DECIMAL=function(t,e){return arguments.length<1?o.value:parseInt(t,e)},e.DEGREES=function(t){return(t=r.parseNumber(t))instanceof Error?t:180*t/Math.PI},e.EVEN=function(t){return(t=r.parseNumber(t))instanceof Error?t:e.CEILING(t,-2,-1)},e.EXP=function(t){return arguments.length<1?o.na:"number"!=typeof t||arguments.length>1?o.error:t=Math.exp(t)};var l=[];e.FACT=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var n=Math.floor(t);return 0===n||1===n?1:l[n]>0?l[n]:(l[n]=e.FACT(n-1)*n,l[n])},e.FACTDOUBLE=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var n=Math.floor(t);return n<=0?1:n*e.FACTDOUBLE(n-2)},e.FLOOR=function(t,n){if(t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n))return o.value;if(0===n)return 0;if(!(t>0&&n>0||t<0&&n<0))return o.num;n=Math.abs(n);var i=-Math.floor(Math.log(n)/Math.log(10));return t>=0?e.ROUND(Math.floor(t/n)*n,i):-e.ROUND(Math.ceil(Math.abs(t)/n),i)},e.FLOOR.MATH=function(t,n,i){if(n=void 0===n?1:n,i=void 0===i?0:i,t=r.parseNumber(t),n=r.parseNumber(n),i=r.parseNumber(i),r.anyIsError(t,n,i))return o.value;if(0===n)return 0;n=n?Math.abs(n):1;var a=-Math.floor(Math.log(n)/Math.log(10));return t>=0?e.ROUND(Math.floor(t/n)*n,a):0===i||void 0===i?-e.ROUND(Math.ceil(Math.abs(t)/n)*n,a):-e.ROUND(Math.floor(Math.abs(t)/n)*n,a)},e.FLOOR.PRECISE=e.FLOOR.MATH,e.GCD=function(){var t=r.parseNumberArray(r.flatten(arguments));if(t instanceof Error)return t;for(var e=t.length,n=t[0],o=n<0?-n:n,i=1;i<e;i++){for(var a=t[i],s=a<0?-a:a;o&&s;)o>s?o%=s:s%=o;o+=s}return o},e.INT=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.floor(t)},e.ISO={CEILING:e.CEILING},e.LCM=function(){var t=r.parseNumberArray(r.flatten(arguments));if(t instanceof Error)return t;for(var e,n,o,i,a=1;void 0!==(o=t.pop());)for(;o>1;){if(o%2){for(e=3,n=Math.floor(Math.sqrt(o));e<=n&&o%e;e+=2);i=e<=n?e:o}else i=2;for(o/=i,a*=i,e=t.length;e;t[--e]%i==0&&1==(t[e]/=i)&&t.splice(e,1));}return a},e.LN=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.log(t)},e.LN10=function(){return Math.log(10)},e.LN2=function(){return Math.log(2)},e.LOG10E=function(){return Math.LOG10E},e.LOG2E=function(){return Math.LOG2E},e.LOG=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:(e=void 0===e?10:e,Math.log(t)/Math.log(e))},e.LOG10=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.log(t)/Math.log(10)},e.MOD=function(t,e){if(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e))return o.value;if(0===e)return o.div0;var n=Math.abs(t%e);return e>0?n:-n},e.MROUND=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:t*e<0?o.num:Math.round(t/e)*e},e.MULTINOMIAL=function(){var t=r.parseNumberArray(r.flatten(arguments));if(t instanceof Error)return t;for(var n=0,o=1,i=0;i<t.length;i++)n+=t[i],o*=e.FACT(t[i]);return e.FACT(n)/o},e.ODD=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.ceil(Math.abs(t));return e=1&e?e:e+1,t>0?e:-e},e.PI=function(){return Math.PI},e.E=function(){return Math.E},e.POWER=function(t,e){if(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e))return o.value;var n=Math.pow(t,e);return isNaN(n)?o.num:n},e.PRODUCT=function(){var t=r.parseNumberArray(r.flatten(arguments));if(t instanceof Error)return t;for(var e=1,n=0;n<t.length;n++)e*=t[n];return e},e.QUOTIENT=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:parseInt(t/e,10)},e.RADIANS=function(t){return(t=r.parseNumber(t))instanceof Error?t:t*Math.PI/180},e.RAND=function(){return Math.random()},e.RANDBETWEEN=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:t+Math.ceil((e-t+1)*Math.random())-1},e.ROMAN=function(t){if((t=r.parseNumber(t))instanceof Error)return t;for(var e=String(t).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],o="",i=3;i--;)o=(n[+e.pop()+10*i]||"")+o;return new Array(+e.join("")+1).join("M")+o},e.ROUND=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:Math.round(t*Math.pow(10,e))/Math.pow(10,e)},e.ROUNDDOWN=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)},e.ROUNDUP=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:(t>0?1:-1)*Math.ceil(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)},e.SEC=function(t){return(t=r.parseNumber(t))instanceof Error?t:1/Math.cos(t)},e.SECH=function(t){return(t=r.parseNumber(t))instanceof Error?t:2/(Math.exp(t)+Math.exp(-t))},e.SERIESSUM=function(t,e,n,i){if(t=r.parseNumber(t),e=r.parseNumber(e),n=r.parseNumber(n),i=r.parseNumberArray(i),r.anyIsError(t,e,n,i))return o.value;for(var a=i[0]*Math.pow(t,e),s=1;s<i.length;s++)a+=i[s]*Math.pow(t,e+s*n);return a},e.SIGN=function(t){return(t=r.parseNumber(t))instanceof Error?t:t<0?-1:0===t?0:1},e.SIN=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.sin(t)},e.SINH=function(t){return(t=r.parseNumber(t))instanceof Error?t:(Math.exp(t)-Math.exp(-t))/2},e.SQRT=function(t){return(t=r.parseNumber(t))instanceof Error?t:t<0?o.num:Math.sqrt(t)},e.SQRTPI=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.sqrt(t*Math.PI)},e.SQRT1_2=function(){return 1/Math.sqrt(2)},e.SQRT2=function(){return Math.sqrt(2)},e.SUBTOTAL=function(t,n){if((t=r.parseNumber(t))instanceof Error)return t;switch(t){case 1:return i.AVERAGE(n);case 2:return i.COUNT(n);case 3:return i.COUNTA(n);case 4:return i.MAX(n);case 5:return i.MIN(n);case 6:return e.PRODUCT(n);case 7:return i.STDEV.S(n);case 8:return i.STDEV.P(n);case 9:return e.SUM(n);case 10:return i.VAR.S(n);case 11:return i.VAR.P(n);case 101:return i.AVERAGE(n);case 102:return i.COUNT(n);case 103:return i.COUNTA(n);case 104:return i.MAX(n);case 105:return i.MIN(n);case 106:return e.PRODUCT(n);case 107:return i.STDEV.S(n);case 108:return i.STDEV.P(n);case 109:return e.SUM(n);case 110:return i.VAR.S(n);case 111:return i.VAR.P(n)}},e.ADD=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:t+e)},e.MINUS=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:t-e)},e.DIVIDE=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:0===e?o.div0:t/e)},e.MULTIPLY=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:t*e)},e.GTE=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.error:t>=e)},e.LT=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.error:t<e)},e.LTE=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.error:t<=e)},e.EQ=function(t,e){return 2!==arguments.length?o.na:t===e},e.NE=function(t,e){return 2!==arguments.length?o.na:t!==e},e.POW=function(t,n){return 2!==arguments.length?o.na:(t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n)?o.error:e.POWER(t,n))},e.SUM=function(){var t=0;return r.arrayEach(r.argsToArray(arguments),function(n){if("number"==typeof n)t+=n;else if("string"==typeof n){var r=parseFloat(n);!isNaN(r)&&(t+=r)}else Array.isArray(n)&&(t+=e.SUM.apply(null,n))}),t},e.SUMIF=function(t,e){if((t=r.parseNumberArray(r.flatten(t)))instanceof Error)return t;for(var n=0,o=void 0===e||"*"===e,i=o?null:s.parse(e+""),a=0;a<t.length;a++){var l=t[a];if(o)n+=l;else{var u=[s.createToken(l,s.TOKEN_TYPE_LITERAL)].concat(i);n+=s.compute(u)?l:0}}return n},e.SUMIFS=function(){var t=r.argsToArray(arguments),e=r.parseNumberArray(r.flatten(t.shift()));if(e instanceof Error)return e;for(var n=t,o=e.length,i=n.length,a=0,l=0;l<o;l++){for(var u=e[l],c=!1,f=0;f<i;f++){var h=n[f],d=!1;if(void 0===h||"*"===h)d=!0;else{var p=s.parse(h+""),g=[s.createToken(u,s.TOKEN_TYPE_LITERAL)].concat(p);d=s.compute(g)}if(!d){c=!1;break}c=!0}c&&(a+=u)}return a},e.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return o.value;for(var t,e,n,i,a=arguments.length+1,s=0,l=0;l<arguments[0].length;l++)if(arguments[0][l]instanceof Array)for(var u=0;u<arguments[0][l].length;u++){for(t=1,e=1;e<a;e++){if((i=r.parseNumber(arguments[e-1][l][u]))instanceof Error)return i;t*=i}s+=t}else{for(t=1,e=1;e<a;e++){if((n=r.parseNumber(arguments[e-1][l]))instanceof Error)return n;t*=n}s+=t}return s},e.SUMSQ=function(){var t=r.parseNumberArray(r.flatten(arguments));if(t instanceof Error)return t;for(var e=0,n=t.length,o=0;o<n;o++)e+=a.ISNUMBER(t[o])?t[o]*t[o]:0;return e},e.SUMX2MY2=function(t,e){if(t=r.parseNumberArray(r.flatten(t)),e=r.parseNumberArray(r.flatten(e)),r.anyIsError(t,e))return o.value;for(var n=0,i=0;i<t.length;i++)n+=t[i]*t[i]-e[i]*e[i];return n},e.SUMX2PY2=function(t,e){if(t=r.parseNumberArray(r.flatten(t)),e=r.parseNumberArray(r.flatten(e)),r.anyIsError(t,e))return o.value;var n=0;t=r.parseNumberArray(r.flatten(t)),e=r.parseNumberArray(r.flatten(e));for(var i=0;i<t.length;i++)n+=t[i]*t[i]+e[i]*e[i];return n},e.SUMXMY2=function(t,e){if(t=r.parseNumberArray(r.flatten(t)),e=r.parseNumberArray(r.flatten(e)),r.anyIsError(t,e))return o.value;var n=0;t=r.flatten(t),e=r.flatten(e);for(var i=0;i<t.length;i++)n+=Math.pow(t[i]-e[i],2);return n},e.TAN=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.tan(t)},e.TANH=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e-1)/(e+1)},e.TRUNC=function(t,e){return e=void 0===e?0:e,t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)}},function(t,e,n){var r=n(4),o=n(6),i=n(10),a=n(1),s=n(7),l=n(0),u=n(11);e.AVEDEV=function(){var t=a.parseNumberArray(a.flatten(arguments));return t instanceof Error?t:i.sum(i(t).subtract(i.mean(t)).abs()[0])/t.length},e.AVERAGE=function(){for(var t,e=a.numbers(a.flatten(arguments)),n=e.length,r=0,o=0,i=0;i<n;i++)r+=e[i],o+=1;return t=r/o,isNaN(t)&&(t=l.num),t},e.AVERAGEA=function(){for(var t,e=a.flatten(arguments),n=e.length,r=0,o=0,i=0;i<n;i++){var s=e[i];"number"==typeof s&&(r+=s),!0===s&&r++,null!==s&&o++}return t=r/o,isNaN(t)&&(t=l.num),t},e.AVERAGEIF=function(t,e,n){if(arguments.length<=1)return l.na;if(n=n||t,t=a.flatten(t),(n=a.parseNumberArray(a.flatten(n)))instanceof Error)return n;for(var r=0,o=0,i=void 0===e||"*"===e,u=i?null:s.parse(e+""),c=0;c<t.length;c++){var f=t[c];if(i)o+=n[c],r++;else{var h=[s.createToken(f,s.TOKEN_TYPE_LITERAL)].concat(u);s.compute(h)&&(o+=n[c],r++)}}return o/r},e.AVERAGEIFS=function(){for(var t=a.argsToArray(arguments),e=(t.length-1)/2,n=a.flatten(t[0]),r=0,o=0,i=0;i<n.length;i++){for(var l=!1,u=0;u<e;u++){var c=t[2*u+1][i],f=t[2*u+2],h=!1;if(void 0===f||"*"===f)h=!0;else{var d=s.parse(f+""),p=[s.createToken(c,s.TOKEN_TYPE_LITERAL)].concat(d);h=s.compute(p)}if(!h){l=!1;break}l=!0}l&&(o+=n[i],r++)}var g=o/r;return isNaN(g)?0:g},e.BETA={},e.BETA.DIST=function(t,e,n,r,o,s){return arguments.length<4?l.value:(o=void 0===o?0:o,s=void 0===s?1:s,t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),o=a.parseNumber(o),s=a.parseNumber(s),a.anyIsError(t,e,n,o,s)?l.value:(t=(t-o)/(s-o),r?i.beta.cdf(t,e,n):i.beta.pdf(t,e,n)))},e.BETA.INV=function(t,e,n,r,o){return r=void 0===r?0:r,o=void 0===o?1:o,t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(t,e,n,r,o)?l.value:i.beta.inv(t,e,n)*(o-r)+r},e.BINOM={},e.BINOM.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),r=a.parseNumber(r),a.anyIsError(t,e,n,r)?l.value:r?i.binomial.cdf(t,e,n):i.binomial.pdf(t,e,n)},e.BINOM.DIST.RANGE=function(t,e,n,o){if(o=void 0===o?n:o,t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),o=a.parseNumber(o),a.anyIsError(t,e,n,o))return l.value;for(var i=0,s=n;s<=o;s++)i+=r.COMBIN(t,s)*Math.pow(e,s)*Math.pow(1-e,t-s);return i},e.BINOM.INV=function(t,e,n){if(t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n))return l.value;for(var r=0;r<=t;){if(i.binomial.cdf(r,t,e)>=n)return r;r++}},e.CHISQ={},e.CHISQ.DIST=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:n?i.chisquare.cdf(t,e):i.chisquare.pdf(t,e)},e.CHISQ.DIST.RT=function(t,e){return!t|!e?l.na:t<1||e>Math.pow(10,10)?l.num:"number"!=typeof t||"number"!=typeof e?l.value:1-i.chisquare.cdf(t,e)},e.CHISQ.INV=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:i.chisquare.inv(t,e)},e.CHISQ.INV.RT=function(t,e){return!t|!e?l.na:t<0||t>1||e<1||e>Math.pow(10,10)?l.num:"number"!=typeof t||"number"!=typeof e?l.value:i.chisquare.inv(1-t,e)},e.CHISQ.TEST=function(t,e){if(2!==arguments.length)return l.na;if(!(t instanceof Array&&e instanceof Array))return l.value;if(t.length!==e.length)return l.value;if(t[0]&&e[0]&&t[0].length!==e[0].length)return l.value;var n,r,o,i=t.length;for(r=0;r<i;r++)t[r]instanceof Array||(n=t[r],t[r]=[],t[r].push(n)),e[r]instanceof Array||(n=e[r],e[r]=[],e[r].push(n));var a=t[0].length,s=1===a?i-1:(i-1)*(a-1),u=0,c=Math.PI;for(r=0;r<i;r++)for(o=0;o<a;o++)u+=Math.pow(t[r][o]-e[r][o],2)/e[r][o];return Math.round(1e6*function(t,e){var n=Math.exp(-.5*t);e%2==1&&(n*=Math.sqrt(2*t/c));for(var r=e;r>=2;)n=n*t/r,r-=2;for(var o=n,i=e;o>1e-10*n;)n+=o=o*t/(i+=2);return 1-n}(u,s))/1e6},e.COLUMN=function(t,e){return 2!==arguments.length?l.na:e<0?l.num:t instanceof Array&&"number"==typeof e?0!==t.length?i.col(t,e):void 0:l.value},e.COLUMNS=function(t){return 1!==arguments.length?l.na:t instanceof Array?0===t.length?0:i.cols(t):l.value},e.CONFIDENCE={},e.CONFIDENCE.NORM=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:i.normalci(1,t,e,n)[1]-1},e.CONFIDENCE.T=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:i.tci(1,t,e,n)[1]-1},e.CORREL=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e)?l.value:i.corrcoeff(t,e)},e.COUNT=function(){return a.numbers(a.flatten(arguments)).length},e.COUNTA=function(){var t=a.flatten(arguments);return t.length-e.COUNTBLANK(t)},e.COUNTIN=function(t,e){var n=0;t=a.flatten(t);for(var r=0;r<t.length;r++)t[r]===e&&n++;return n},e.COUNTBLANK=function(){for(var t,e=a.flatten(arguments),n=0,r=0;r<e.length;r++)null!==(t=e[r])&&""!==t||n++;return n},e.COUNTIF=function(t,e){if(t=a.flatten(t),void 0===e||"*"===e)return t.length;for(var n=0,r=s.parse(e+""),o=0;o<t.length;o++){var i=t[o],l=[s.createToken(i,s.TOKEN_TYPE_LITERAL)].concat(r);s.compute(l)&&n++}return n},e.COUNTIFS=function(){for(var t=a.argsToArray(arguments),e=new Array(a.flatten(t[0]).length),n=0;n<e.length;n++)e[n]=!0;for(n=0;n<t.length;n+=2){var r=a.flatten(t[n]),o=t[n+1];if(!(void 0===o||"*"===o))for(var i=s.parse(o+""),l=0;l<r.length;l++){var u=r[l],c=[s.createToken(u,s.TOKEN_TYPE_LITERAL)].concat(i);e[l]=e[l]&&s.compute(c)}}var f=0;for(n=0;n<e.length;n++)e[n]&&f++;return f},e.COUNTUNIQUE=function(){return u.UNIQUE.apply(null,a.flatten(arguments)).length},e.COVARIANCE={},e.COVARIANCE.P=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var n=i.mean(t),r=i.mean(e),o=0,s=t.length,u=0;u<s;u++)o+=(t[u]-n)*(e[u]-r);return o/s},e.COVARIANCE.S=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e)?l.value:i.covariance(t,e)},e.DEVSQ=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},e.EXPON={},e.EXPON.DIST=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:n?i.exponential.cdf(t,e):i.exponential.pdf(t,e)},e.F={},e.F.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:r?i.centralF.cdf(t,e,n):i.centralF.pdf(t,e,n)},e.F.DIST.RT=function(t,e,n){return 3!==arguments.length?l.na:t<0||e<1||n<1?l.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?l.value:1-i.centralF.cdf(t,e,n)},e.F.INV=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:t<=0||t>1?l.num:i.centralF.inv(t,e,n)},e.F.INV.RT=function(t,e,n){return 3!==arguments.length?l.na:t<0||t>1||e<1||e>Math.pow(10,10)||n<1||n>Math.pow(10,10)?l.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?l.value:i.centralF.inv(1-t,e,n)},e.F.TEST=function(t,e){if(!t||!e)return l.na;if(!(t instanceof Array&&e instanceof Array))return l.na;if(t.length<2||e.length<2)return l.div0;var n=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},o=r.SUM(t)/t.length,i=r.SUM(e)/e.length;return n(t,o)/(t.length-1)/(n(e,i)/(e.length-1))},e.FISHER=function(t){return(t=a.parseNumber(t))instanceof Error?t:Math.log((1+t)/(1-t))/2},e.FISHERINV=function(t){if((t=a.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e-1)/(e+1)},e.FORECAST=function(t,e,n){if(t=a.parseNumber(t),e=a.parseNumberArray(a.flatten(e)),n=a.parseNumberArray(a.flatten(n)),a.anyIsError(t,e,n))return l.value;for(var r=i.mean(n),o=i.mean(e),s=n.length,u=0,c=0,f=0;f<s;f++)u+=(n[f]-r)*(e[f]-o),c+=Math.pow(n[f]-r,2);var h=u/c;return o-h*r+h*t},e.FREQUENCY=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var n=t.length,r=e.length,o=[],i=0;i<=r;i++){o[i]=0;for(var s=0;s<n;s++)0===i?t[s]<=e[0]&&(o[0]+=1):i<r?t[s]>e[i-1]&&t[s]<=e[i]&&(o[i]+=1):i===r&&t[s]>e[r-1]&&(o[r]+=1)}return o},e.GAMMA=function(t){return(t=a.parseNumber(t))instanceof Error?t:0===t?l.num:parseInt(t,10)===t&&t<0?l.num:i.gammafn(t)},e.GAMMA.DIST=function(t,e,n,r){return 4!==arguments.length?l.na:t<0||e<=0||n<=0?l.value:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?l.value:r?i.gamma.cdf(t,e,n,!0):i.gamma.pdf(t,e,n,!1)},e.GAMMA.INV=function(t,e,n){return 3!==arguments.length?l.na:t<0||t>1||e<=0||n<=0?l.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?l.value:i.gamma.inv(t,e,n)},e.GAMMALN=function(t){return(t=a.parseNumber(t))instanceof Error?t:i.gammaln(t)},e.GAMMALN.PRECISE=function(t){return 1!==arguments.length?l.na:t<=0?l.num:"number"!=typeof t?l.value:i.gammaln(t)},e.GAUSS=function(t){return(t=a.parseNumber(t))instanceof Error?t:i.normal.cdf(t,0,1)-.5},e.GEOMEAN=function(){var t=a.parseNumberArray(a.flatten(arguments));return t instanceof Error?t:i.geomean(t)},e.GROWTH=function(t,e,n,r){if((t=a.parseNumberArray(t))instanceof Error)return t;var o;if(void 0===e)for(e=[],o=1;o<=t.length;o++)e.push(o);if(void 0===n)for(n=[],o=1;o<=t.length;o++)n.push(o);if(e=a.parseNumberArray(e),n=a.parseNumberArray(n),a.anyIsError(e,n))return l.value;void 0===r&&(r=!0);var i,s,u=t.length,c=0,f=0,h=0,d=0;for(o=0;o<u;o++){var p=e[o],g=Math.log(t[o]);c+=p,f+=g,h+=p*g,d+=p*p}c/=u,f/=u,h/=u,d/=u,r?s=f-(i=(h-c*f)/(d-c*c))*c:(i=h/d,s=0);var v=[];for(o=0;o<n.length;o++)v.push(Math.exp(s+i*n[o]));return v},e.HARMEAN=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=t.length,n=0,r=0;r<e;r++)n+=1/t[r];return e/n},e.HYPGEOM={},e.HYPGEOM.DIST=function(t,e,n,o,i){if(t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),o=a.parseNumber(o),a.anyIsError(t,e,n,o))return l.value;function s(t,e,n,o){return r.COMBIN(n,t)*r.COMBIN(o-n,e-t)/r.COMBIN(o,e)}return i?function(t,e,n,r){for(var o=0,i=0;i<=t;i++)o+=s(i,e,n,r);return o}(t,e,n,o):s(t,e,n,o)},e.INTERCEPT=function(t,n){return t=a.parseNumberArray(t),n=a.parseNumberArray(n),a.anyIsError(t,n)?l.value:t.length!==n.length?l.na:e.FORECAST(0,t,n)},e.KURT=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),n=t.length,r=0,o=0;o<n;o++)r+=Math.pow(t[o]-e,4);return n*(n+1)/((n-1)*(n-2)*(n-3))*(r/=Math.pow(i.stdev(t,!0),4))-3*(n-1)*(n-1)/((n-2)*(n-3))},e.LARGE=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e)?t:t.sort(function(t,e){return e-t})[e-1]},e.LINEST=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var n=i.mean(t),r=i.mean(e),o=e.length,s=0,u=0,c=0;c<o;c++)s+=(e[c]-r)*(t[c]-n),u+=Math.pow(e[c]-r,2);var f=s/u;return[f,n-f*r]},e.LOGEST=function(t,n){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumberArray(a.flatten(n)),a.anyIsError(t,n))return l.value;for(var r=0;r<t.length;r++)t[r]=Math.log(t[r]);var o=e.LINEST(t,n);return o[0]=Math.round(1e6*Math.exp(o[0]))/1e6,o[1]=Math.round(1e6*Math.exp(o[1]))/1e6,o},e.LOGNORM={},e.LOGNORM.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:r?i.lognormal.cdf(t,e,n):i.lognormal.pdf(t,e,n)},e.LOGNORM.INV=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:i.lognormal.inv(t,e,n)},e.MAX=function(){var t=a.numbers(a.flatten(arguments));return 0===t.length?0:Math.max.apply(Math,t)},e.MAXA=function(){var t=a.arrayValuesToNumbers(a.flatten(arguments));return 0===t.length?0:Math.max.apply(Math,t)},e.MEDIAN=function(){var t=a.arrayValuesToNumbers(a.flatten(arguments)),e=i.median(t);return isNaN(e)&&(e=l.num),e},e.MIN=function(){var t=a.numbers(a.flatten(arguments));return 0===t.length?0:Math.min.apply(Math,t)},e.MINA=function(){var t=a.arrayValuesToNumbers(a.flatten(arguments));return 0===t.length?0:Math.min.apply(Math,t)},e.MODE={},e.MODE.MULT=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e,n=t.length,r={},o=[],i=0,s=0;s<n;s++)r[e=t[s]]=r[e]?r[e]+1:1,r[e]>i&&(i=r[e],o=[]),r[e]===i&&(o[o.length]=e);return o},e.MODE.SNGL=function(){var t=a.parseNumberArray(a.flatten(arguments));return t instanceof Error?t:e.MODE.MULT(t).sort(function(t,e){return t-e})[0]},e.NEGBINOM={},e.NEGBINOM.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:r?i.negbin.cdf(t,e,n):i.negbin.pdf(t,e,n)},e.NORM={},e.NORM.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:n<=0?l.num:r?i.normal.cdf(t,e,n):i.normal.pdf(t,e,n)},e.NORM.INV=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:i.normal.inv(t,e,n)},e.NORM.S={},e.NORM.S.DIST=function(t,e){return(t=a.parseNumber(t))instanceof Error?l.value:e?i.normal.cdf(t,0,1):i.normal.pdf(t,0,1)},e.NORM.S.INV=function(t){return(t=a.parseNumber(t))instanceof Error?l.value:i.normal.inv(t,0,1)},e.PEARSON=function(t,e){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return l.value;for(var n=i.mean(t),r=i.mean(e),o=t.length,s=0,u=0,c=0,f=0;f<o;f++)s+=(t[f]-n)*(e[f]-r),u+=Math.pow(t[f]-n,2),c+=Math.pow(e[f]-r,2);return s/Math.sqrt(u*c)},e.PERCENTILE={},e.PERCENTILE.EXC=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e))return l.value;var n=(t=t.sort(function(t,e){return t-e})).length;if(e<1/(n+1)||e>1-1/(n+1))return l.num;var r=e*(n+1)-1,o=Math.floor(r);return a.cleanFloat(r===o?t[r]:t[o]+(r-o)*(t[o+1]-t[o]))},e.PERCENTILE.INC=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e))return l.value;var n=e*((t=t.sort(function(t,e){return t-e})).length-1),r=Math.floor(n);return a.cleanFloat(n===r?t[n]:t[r]+(n-r)*(t[r+1]-t[r]))},e.PERCENTRANK={},e.PERCENTRANK.EXC=function(t,e,n){if(n=void 0===n?3:n,t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n))return l.value;t=t.sort(function(t,e){return t-e});for(var r=u.UNIQUE.apply(null,t),o=t.length,i=r.length,s=Math.pow(10,n),c=0,f=!1,h=0;!f&&h<i;)e===r[h]?(c=(t.indexOf(r[h])+1)/(o+1),f=!0):e>=r[h]&&(e<r[h+1]||h===i-1)&&(c=(t.indexOf(r[h])+1+(e-r[h])/(r[h+1]-r[h]))/(o+1),f=!0),h++;return Math.floor(c*s)/s},e.PERCENTRANK.INC=function(t,e,n){if(n=void 0===n?3:n,t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n))return l.value;t=t.sort(function(t,e){return t-e});for(var r=u.UNIQUE.apply(null,t),o=t.length,i=r.length,s=Math.pow(10,n),c=0,f=!1,h=0;!f&&h<i;)e===r[h]?(c=t.indexOf(r[h])/(o-1),f=!0):e>=r[h]&&(e<r[h+1]||h===i-1)&&(c=(t.indexOf(r[h])+(e-r[h])/(r[h+1]-r[h]))/(o-1),f=!0),h++;return Math.floor(c*s)/s},e.PERMUT=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:r.FACT(t)/r.FACT(t-e)},e.PERMUTATIONA=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:Math.pow(t,e)},e.PHI=function(t){return(t=a.parseNumber(t))instanceof Error?l.value:Math.exp(-.5*t*t)/2.5066282746310002},e.POISSON={},e.POISSON.DIST=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:n?i.poisson.cdf(t,e):i.poisson.pdf(t,e)},e.PROB=function(t,e,n,r){if(void 0===n)return 0;if(r=void 0===r?n:r,t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),n=a.parseNumber(n),r=a.parseNumber(r),a.anyIsError(t,e,n,r))return l.value;if(n===r)return t.indexOf(n)>=0?e[t.indexOf(n)]:0;for(var o=t.sort(function(t,e){return t-e}),i=o.length,s=0,u=0;u<i;u++)o[u]>=n&&o[u]<=r&&(s+=e[t.indexOf(o[u])]);return s},e.QUARTILE={},e.QUARTILE.EXC=function(t,n){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumber(n),a.anyIsError(t,n))return l.value;switch(n){case 1:return e.PERCENTILE.EXC(t,.25);case 2:return e.PERCENTILE.EXC(t,.5);case 3:return e.PERCENTILE.EXC(t,.75);default:return l.num}},e.QUARTILE.INC=function(t,n){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumber(n),a.anyIsError(t,n))return l.value;switch(n){case 1:return e.PERCENTILE.INC(t,.25);case 2:return e.PERCENTILE.INC(t,.5);case 3:return e.PERCENTILE.INC(t,.75);default:return l.num}},e.RANK={},e.RANK.AVG=function(t,e,n){if(t=a.parseNumber(t),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var r=(n=n||!1)?function(t,e){return t-e}:function(t,e){return e-t},o=(e=(e=a.flatten(e)).sort(r)).length,i=0,s=0;s<o;s++)e[s]===t&&i++;return i>1?(2*e.indexOf(t)+i+1)/2:e.indexOf(t)+1},e.RANK.EQ=function(t,e,n){if(t=a.parseNumber(t),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;var r=(n=n||!1)?function(t,e){return t-e}:function(t,e){return e-t};return(e=e.sort(r)).indexOf(t)+1},e.ROW=function(t,e){return 2!==arguments.length?l.na:e<0?l.num:t instanceof Array&&"number"==typeof e?0!==t.length?i.row(t,e):void 0:l.value},e.ROWS=function(t){return 1!==arguments.length?l.na:t instanceof Array?0===t.length?0:i.rows(t):l.value},e.RSQ=function(t,n){return t=a.parseNumberArray(a.flatten(t)),n=a.parseNumberArray(a.flatten(n)),a.anyIsError(t,n)?l.value:Math.pow(e.PEARSON(t,n),2)},e.SKEW=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),n=t.length,r=0,o=0;o<n;o++)r+=Math.pow(t[o]-e,3);return n*r/((n-1)*(n-2)*Math.pow(i.stdev(t,!0),3))},e.SKEW.P=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),n=t.length,r=0,o=0,s=0;s<n;s++)o+=Math.pow(t[s]-e,3),r+=Math.pow(t[s]-e,2);return r/=n,(o/=n)/Math.pow(r,1.5)},e.SLOPE=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var n=i.mean(e),r=i.mean(t),o=e.length,s=0,u=0,c=0;c<o;c++)s+=(e[c]-n)*(t[c]-r),u+=Math.pow(e[c]-n,2);return s/u},e.SMALL=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e)?t:t.sort(function(t,e){return t-e})[e-1]},e.STANDARDIZE=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:(t-e)/n},e.STDEV={},e.STDEV.P=function(){var t=e.VAR.P.apply(this,arguments),n=Math.sqrt(t);return isNaN(n)&&(n=l.num),n},e.STDEV.S=function(){var t=e.VAR.S.apply(this,arguments);return Math.sqrt(t)},e.STDEVA=function(){var t=e.VARA.apply(this,arguments);return Math.sqrt(t)},e.STDEVPA=function(){var t=e.VARPA.apply(this,arguments),n=Math.sqrt(t);return isNaN(n)&&(n=l.num),n},e.STEYX=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var n=i.mean(e),r=i.mean(t),o=e.length,s=0,u=0,c=0,f=0;f<o;f++)s+=Math.pow(t[f]-r,2),u+=(e[f]-n)*(t[f]-r),c+=Math.pow(e[f]-n,2);return Math.sqrt((s-u*u/c)/(o-2))},e.TRANSPOSE=function(t){return t?i.transpose(t):l.na},e.T=o.T,e.T.DIST=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:n?i.studentt.cdf(t,e):i.studentt.pdf(t,e)},e.T.DIST["2T"]=function(t,e){return 2!==arguments.length?l.na:t<0||e<1?l.num:"number"!=typeof t||"number"!=typeof e?l.value:2*(1-i.studentt.cdf(t,e))},e.T.DIST.RT=function(t,e){return 2!==arguments.length?l.na:t<0||e<1?l.num:"number"!=typeof t||"number"!=typeof e?l.value:1-i.studentt.cdf(t,e)},e.T.INV=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:i.studentt.inv(t,e)},e.T.INV["2T"]=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),t<=0||t>1||e<1?l.num:a.anyIsError(t,e)?l.value:Math.abs(i.studentt.inv(t/2,e))},e.T.TEST=function(t,n){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumberArray(a.flatten(n)),a.anyIsError(t,n))return l.value;var r,o=i.mean(t),s=i.mean(n),u=0,c=0;for(r=0;r<t.length;r++)u+=Math.pow(t[r]-o,2);for(r=0;r<n.length;r++)c+=Math.pow(n[r]-s,2);u/=t.length-1,c/=n.length-1;var f=Math.abs(o-s)/Math.sqrt(u/t.length+c/n.length);return e.T.DIST["2T"](f,t.length+n.length-2)},e.TREND=function(t,n,r){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumberArray(a.flatten(n)),r=a.parseNumberArray(a.flatten(r)),a.anyIsError(t,n,r))return l.value;var o=e.LINEST(t,n),i=o[0],s=o[1],u=[];return r.forEach(function(t){u.push(i*t+s)}),u},e.TRIMMEAN=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e))return l.value;var n=r.FLOOR(t.length*e,2)/2;return i.mean(a.initial(a.rest(t.sort(function(t,e){return t-e}),n),n))},e.VAR={},e.VAR.P=function(){for(var t,n=a.numbers(a.flatten(arguments)),r=n.length,o=0,i=e.AVERAGE(n),s=0;s<r;s++)o+=Math.pow(n[s]-i,2);return t=o/r,isNaN(t)&&(t=l.num),t},e.VAR.S=function(){for(var t=a.numbers(a.flatten(arguments)),n=t.length,r=0,o=e.AVERAGE(t),i=0;i<n;i++)r+=Math.pow(t[i]-o,2);return r/(n-1)},e.VARA=function(){for(var t=a.flatten(arguments),n=t.length,r=0,o=0,i=e.AVERAGEA(t),s=0;s<n;s++){var l=t[s];r+="number"==typeof l?Math.pow(l-i,2):!0===l?Math.pow(1-i,2):Math.pow(0-i,2),null!==l&&o++}return r/(o-1)},e.VARPA=function(){for(var t,n=a.flatten(arguments),r=n.length,o=0,i=0,s=e.AVERAGEA(n),u=0;u<r;u++){var c=n[u];o+="number"==typeof c?Math.pow(c-s,2):!0===c?Math.pow(1-s,2):Math.pow(0-s,2),null!==c&&i++}return t=o/i,isNaN(t)&&(t=l.num),t},e.WEIBULL={},e.WEIBULL.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:r?1-Math.exp(-Math.pow(t/n,e)):Math.pow(t,e-1)*Math.exp(-Math.pow(t/n,e))*e/Math.pow(n,e)},e.Z={},e.Z.TEST=function(t,n,r){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumber(n),a.anyIsError(t,n))return l.value;r=r||e.STDEV.S(t);var o=t.length;return 1-e.NORM.S.DIST((e.AVERAGE(t)-n)/(r/Math.sqrt(o)),!0)}},function(t,e,n){var r=n(1),o=n(0);e.ASC=function(){throw new Error("ASC is not implemented")},e.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},e.CHAR=function(t){return(t=r.parseNumber(t))instanceof Error?t:String.fromCharCode(t)},e.CLEAN=function(t){return(t=t||"").replace(/[\0-\x1F]/g,"")},e.CODE=function(t){var e=(t=t||"").charCodeAt(0);return isNaN(e)&&(e=o.na),e},e.CONCATENATE=function(){for(var t=r.flatten(arguments),e=0;(e=t.indexOf(!0))>-1;)t[e]="TRUE";for(var n=0;(n=t.indexOf(!1))>-1;)t[n]="FALSE";return t.join("")},e.DBCS=function(){throw new Error("DBCS is not implemented")},e.DOLLAR=function(){throw new Error("DOLLAR is not implemented")},e.EXACT=function(t,e){return 2!==arguments.length?o.na:t===e},e.FIND=function(t,e,n){return arguments.length<2?o.na:(n=void 0===n?0:n,e?e.indexOf(t,n-1)+1:null)},e.FIXED=function(){throw new Error("FIXED is not implemented")},e.HTML2TEXT=function(t){var e="";return t&&(t instanceof Array?t.forEach(function(t){""!==e&&(e+="\n"),e+=t.replace(/<(?:.|\n)*?>/gm,"")}):e=t.replace(/<(?:.|\n)*?>/gm,"")),e},e.LEFT=function(t,e){return e=void 0===e?1:e,(e=r.parseNumber(e))instanceof Error||"string"!=typeof t?o.value:t?t.substring(0,e):null},e.LEN=function(t){return 0===arguments.length?o.error:"string"==typeof t?t?t.length:0:t.length?t.length:o.value},e.LOWER=function(t){return"string"!=typeof t?o.value:t?t.toLowerCase():t},e.MID=function(t,e,n){if(e=r.parseNumber(e),n=r.parseNumber(n),r.anyIsError(e,n)||"string"!=typeof t)return n;var o=e-1,i=o+n;return t.substring(o,i)},e.NUMBERVALUE=function(t,e,n){return e=void 0===e?".":e,n=void 0===n?",":n,Number(t.replace(e,".").replace(n,""))},e.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},e.PROPER=function(t){return void 0===t||0===t.length?o.value:(!0===t&&(t="TRUE"),!1===t&&(t="FALSE"),isNaN(t)&&"number"==typeof t?o.value:("number"==typeof t&&(t=""+t),t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})))},e.REGEXEXTRACT=function(t,e){if(arguments.length<2)return o.na;var n=t.match(new RegExp(e));return n?n[n.length>1?n.length-1:0]:null},e.REGEXMATCH=function(t,e,n){if(arguments.length<2)return o.na;var r=t.match(new RegExp(e));return n?r:!!r},e.REGEXREPLACE=function(t,e,n){return arguments.length<3?o.na:t.replace(new RegExp(e),n)},e.REPLACE=function(t,e,n,i){return e=r.parseNumber(e),n=r.parseNumber(n),r.anyIsError(e,n)||"string"!=typeof t||"string"!=typeof i?o.value:t.substr(0,e-1)+i+t.substr(e-1+n)},e.REPT=function(t,e){return(e=r.parseNumber(e))instanceof Error?e:new Array(e+1).join(t)},e.RIGHT=function(t,e){return e=void 0===e?1:e,(e=r.parseNumber(e))instanceof Error?e:t?t.substring(t.length-e):o.na},e.SEARCH=function(t,e,n){var r;return"string"!=typeof t||"string"!=typeof e?o.value:(n=void 0===n?0:n,0===(r=e.toLowerCase().indexOf(t.toLowerCase(),n-1)+1)?o.value:r)},e.SPLIT=function(t,e){return t.split(e)},e.SUBSTITUTE=function(t,e,n,r){if(arguments.length<2)return o.na;if(!(t&&e&&n))return t;if(void 0===r)return t.replace(new RegExp(e,"g"),n);for(var i=0,a=0;t.indexOf(e,i)>0;)if(i=t.indexOf(e,i+1),++a===r)return t.substring(0,i)+n+t.substring(i+e.length)},e.T=function(t){return"string"==typeof t?t:""},e.TEXT=function(){throw new Error("TEXT is not implemented")},e.TRIM=function(t){return"string"!=typeof t?o.value:t.replace(/ +/g," ").trim()},e.UNICHAR=e.CHAR,e.UNICODE=e.CODE,e.UPPER=function(t){return"string"!=typeof t?o.value:t.toUpperCase()},e.VALUE=function(){throw new Error("VALUE is not implemented")}},function(t,e){var n="=",r=[">",">=","<","<=","=","<>"],o="operator",i="literal",a=[o,i];function s(t,e){if(-1===a.indexOf(e))throw new Error("Unsupported token type: "+e);return{value:t,type:e}}function l(t){for(var e,a="",l=[],u=0;u<t.length;u++){var c=t[u];0===u&&r.indexOf(c)>=0?l.push(s(c,o)):a+=c}return a.length>0&&l.push(s("string"!=typeof(e=a)?e:(/^\d+(\.\d+)?$/.test(e)&&(e=-1===e.indexOf(".")?parseInt(e,10):parseFloat(e)),e),i)),l.length>0&&l[0].type!==o&&l.unshift(s(n,o)),l}e.TOKEN_TYPE_OPERATOR=o,e.TOKEN_TYPE_LITERAL=i,e.parse=function(t){return l(function(t){for(var e=t.length,n=[],r=0,o="",i="";r<e;){var a=t.charAt(r);switch(a){case">":case"<":case"=":i+=a,o.length>0&&(n.push(o),o="");break;default:i.length>0&&(n.push(i),i=""),o+=a}r++}return o.length>0&&n.push(o),i.length>0&&n.push(i),n}(t))},e.createToken=s,e.compute=function(t){for(var e,n=[],r=0;r<t.length;r++){var a=t[r];switch(a.type){case o:e=a.value;break;case i:n.push(a.value)}}return function(t,e){var n=!1;switch(e){case">":n=t[0]>t[1];break;case">=":n=t[0]>=t[1];break;case"<":n=t[0]<t[1];break;case"<=":n=t[0]<=t[1];break;case"=":n=t[0]==t[1];break;case"<>":n=t[0]!=t[1]}return n}(n,e)}},function(t,e,n){var r=n(0);e.CELL=function(){throw new Error("CELL is not implemented")},e.ERROR={},e.ERROR.TYPE=function(t){switch(t){case r.nil:return 1;case r.div0:return 2;case r.value:return 3;case r.ref:return 4;case r.name:return 5;case r.num:return 6;case r.na:return 7;case r.data:return 8}return r.na},e.INFO=function(){throw new Error("INFO is not implemented")},e.ISBLANK=function(t){return null===t},e.ISBINARY=function(t){return/^[01]{1,10}$/.test(t)},e.ISERR=function(t){return[r.value,r.ref,r.div0,r.num,r.name,r.nil].indexOf(t)>=0||"number"==typeof t&&(isNaN(t)||!isFinite(t))},e.ISERROR=function(t){return e.ISERR(t)||t===r.na},e.ISEVEN=function(t){return!(1&Math.floor(Math.abs(t)))},e.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},e.ISLOGICAL=function(t){return!0===t||!1===t},e.ISNA=function(t){return t===r.na},e.ISNONTEXT=function(t){return"string"!=typeof t},e.ISNUMBER=function(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)},e.ISODD=function(t){return!!(1&Math.floor(Math.abs(t)))},e.ISREF=function(){throw new Error("ISREF is not implemented")},e.ISTEXT=function(t){return"string"==typeof t},e.N=function(t){return this.ISNUMBER(t)?t:t instanceof Date?t.getTime():!0===t?1:!1===t?0:this.ISERROR(t)?t:0},e.NA=function(){return r.na},e.SHEET=function(){throw new Error("SHEET is not implemented")},e.SHEETS=function(){throw new Error("SHEETS is not implemented")},e.TYPE=function(t){return this.ISNUMBER(t)?1:this.ISTEXT(t)?2:this.ISLOGICAL(t)?4:this.ISERROR(t)?16:Array.isArray(t)?64:void 0}},function(t,e,n){var r=n(0),o=n(1),i=new Date(Date.UTC(1900,0,1)),a=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],s=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function u(t){return 1===new Date(t,1,29).getMonth()}function c(t,e){return Math.ceil((e-t)/1e3/60/60/24)}function f(t){var e=t>-22038912e5?2:1;return Math.ceil((t-i)/864e5)+e}e.DATE=function(t,e,n){return t=o.parseNumber(t),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(t,e,n)?r.value:t<0||e<0||n<0?r.num:new Date(t,e-1,n)},e.DATEVALUE=function(t){var e,n=2;return"string"!=typeof t?r.value:(e=Date.parse(t),isNaN(e)?r.value:(e<=-22038912e5&&(n=1),Math.ceil((e-i)/864e5)+n))},e.DAY=function(t){var e=o.parseDate(t);return e instanceof Error?e:e.getDate()},e.DAYS=function(t,e){return t=o.parseDate(t),e=o.parseDate(e),t instanceof Error?t:e instanceof Error?e:f(t)-f(e)},e.DAYS360=function(t,e,n){if(n=o.parseBool(n),t=o.parseDate(t),e=o.parseDate(e),t instanceof Error)return t;if(e instanceof Error)return e;if(n instanceof Error)return n;var r,i,a=t.getMonth(),s=e.getMonth();if(n)r=31===t.getDate()?30:t.getDate(),i=31===e.getDate()?30:e.getDate();else{var l=new Date(t.getFullYear(),a+1,0).getDate(),u=new Date(e.getFullYear(),s+1,0).getDate();r=t.getDate()===l?30:t.getDate(),e.getDate()===u?r<30?(s++,i=1):i=30:i=e.getDate()}return 360*(e.getFullYear()-t.getFullYear())+30*(s-a)+(i-r)},e.EDATE=function(t,e){return(t=o.parseDate(t))instanceof Error?t:isNaN(e)?r.value:(e=parseInt(e,10),t.setMonth(t.getMonth()+e),f(t))},e.EOMONTH=function(t,e){return(t=o.parseDate(t))instanceof Error?t:isNaN(e)?r.value:(e=parseInt(e,10),f(new Date(t.getFullYear(),t.getMonth()+e+1,0)))},e.HOUR=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getHours()},e.INTERVAL=function(t){if("number"!=typeof t&&"string"!=typeof t)return r.value;t=parseInt(t,10);var e=Math.floor(t/94608e4);t%=94608e4;var n=Math.floor(t/2592e3);t%=2592e3;var o=Math.floor(t/86400);t%=86400;var i=Math.floor(t/3600);t%=3600;var a=Math.floor(t/60),s=t%=60;return"P"+(e=e>0?e+"Y":"")+(n=n>0?n+"M":"")+(o=o>0?o+"D":"")+"T"+(i=i>0?i+"H":"")+(a=a>0?a+"M":"")+(s=s>0?s+"S":"")},e.ISOWEEKNUM=function(t){if((t=o.parseDate(t))instanceof Error)return t;t.setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7));var e=new Date(t.getFullYear(),0,1);return Math.ceil(((t-e)/864e5+1)/7)},e.MINUTE=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getMinutes()},e.MONTH=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getMonth()+1},e.NETWORKDAYS=function(t,e,n){return this.NETWORKDAYS.INTL(t,e,1,n)},e.NETWORKDAYS.INTL=function(t,e,n,i){if((t=o.parseDate(t))instanceof Error)return t;if((e=o.parseDate(e))instanceof Error)return e;if(!((n=void 0===n?l[1]:l[n])instanceof Array))return r.value;void 0===i?i=[]:i instanceof Array||(i=[i]);for(var a=0;a<i.length;a++){var s=o.parseDate(i[a]);if(s instanceof Error)return s;i[a]=s}var u=(e-t)/864e5+1,c=u,f=t;for(a=0;a<u;a++){var h=(new Date).getTimezoneOffset()>0?f.getUTCDay():f.getDay(),d=!1;h!==n[0]&&h!==n[1]||(d=!0);for(var p=0;p<i.length;p++){var g=i[p];if(g.getDate()===f.getDate()&&g.getMonth()===f.getMonth()&&g.getFullYear()===f.getFullYear()){d=!0;break}}d&&c--,f.setDate(f.getDate()+1)}return c},e.NOW=function(){return new Date},e.SECOND=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getSeconds()},e.TIME=function(t,e,n){return t=o.parseNumber(t),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(t,e,n)?r.value:t<0||e<0||n<0?r.num:(3600*t+60*e+n)/86400},e.TIMEVALUE=function(t){return(t=o.parseDate(t))instanceof Error?t:(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},e.TODAY=function(){return new Date},e.WEEKDAY=function(t,e){if((t=o.parseDate(t))instanceof Error)return t;void 0===e&&(e=1);var n=t.getDay();return s[e][n]},e.WEEKNUM=function(t,e){if((t=o.parseDate(t))instanceof Error)return t;if(void 0===e&&(e=1),21===e)return this.ISOWEEKNUM(t);var n=a[e],r=new Date(t.getFullYear(),0,1),i=r.getDay()<n?1:0;return r-=24*Math.abs(r.getDay()-n)*60*60*1e3,Math.floor((t-r)/864e5/7+1)+i},e.WORKDAY=function(t,e,n){return this.WORKDAY.INTL(t,e,1,n)},e.WORKDAY.INTL=function(t,e,n,i){if((t=o.parseDate(t))instanceof Error)return t;if((e=o.parseNumber(e))instanceof Error)return e;if(e<0)return r.num;if(!((n=void 0===n?l[1]:l[n])instanceof Array))return r.value;void 0===i?i=[]:i instanceof Array||(i=[i]);for(var a=0;a<i.length;a++){var s=o.parseDate(i[a]);if(s instanceof Error)return s;i[a]=s}for(var u=0;u<e;){t.setDate(t.getDate()+1);var c=t.getDay();if(c!==n[0]&&c!==n[1]){for(var f=0;f<i.length;f++){var h=i[f];if(h.getDate()===t.getDate()&&h.getMonth()===t.getMonth()&&h.getFullYear()===t.getFullYear()){u--;break}}u++}}return t},e.YEAR=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getFullYear()},e.YEARFRAC=function(t,e,n){if((t=o.parseDate(t))instanceof Error)return t;if((e=o.parseDate(e))instanceof Error)return e;n=n||0;var r=t.getDate(),i=t.getMonth()+1,a=t.getFullYear(),s=e.getDate(),l=e.getMonth()+1,f=e.getFullYear();switch(n){case 0:return 31===r&&31===s?(r=30,s=30):31===r?r=30:30===r&&31===s&&(s=30),(s+30*l+360*f-(r+30*i+360*a))/360;case 1:var h=365;if(a===f||a+1===f&&(i>l||i===l&&r>=s))return(a===f&&u(a)||function(t,e){var n=t.getFullYear(),r=new Date(n,2,1);if(u(n)&&t<r&&e>=r)return!0;var o=e.getFullYear(),i=new Date(o,2,1);return u(o)&&e>=i&&t<i}(t,e)||1===l&&29===s)&&(h=366),c(t,e)/h;var d=f-a+1,p=(new Date(f+1,0,1)-new Date(a,0,1))/1e3/60/60/24/d;return c(t,e)/p;case 2:return c(t,e)/360;case 3:return c(t,e)/365;case 4:return(s+30*l+360*f-(r+30*i+360*a))/360}}},function(t,e,n){var o;"undefined"!=typeof self&&self,t.exports=(function(t,e){var n=t.utils.isFunction;function r(t,e){return t-e}function o(t,n,r){return e.max(n,e.min(t,r))}t.sum=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n];return e},t.sumsqrd=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n]*t[n];return e},t.sumsqerr=function(e){for(var n,r=t.mean(e),o=0,i=e.length;--i>=0;)o+=(n=e[i]-r)*n;return o},t.sumrow=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n];return e},t.product=function(t){for(var e=1,n=t.length;--n>=0;)e*=t[n];return e},t.min=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]<e&&(e=t[n]);return e},t.max=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]>e&&(e=t[n]);return e},t.unique=function(t){for(var e={},n=[],r=0;r<t.length;r++)e[t[r]]||(e[t[r]]=!0,n.push(t[r]));return n},t.mean=function(e){return t.sum(e)/e.length},t.meansqerr=function(e){return t.sumsqerr(e)/e.length},t.geomean=function(n){return e.pow(t.product(n),1/n.length)},t.median=function(t){var e=t.length,n=t.slice().sort(r);return 1&e?n[e/2|0]:(n[e/2-1]+n[e/2])/2},t.cumsum=function(e){return t.cumreduce(e,function(t,e){return t+e})},t.cumprod=function(e){return t.cumreduce(e,function(t,e){return t*e})},t.diff=function(t){for(var e=[],n=t.length,r=1;r<n;r++)e.push(t[r]-t[r-1]);return e},t.rank=function(t){for(var e=t.length,n=t.slice().sort(r),o=new Array(e),i=0;i<e;i++){var a=n.indexOf(t[i]),s=n.lastIndexOf(t[i]);if(a===s)var l=a;else l=(a+s)/2;o[i]=l+1}return o},t.mode=function(t){for(var e=t.length,n=t.slice().sort(r),o=1,i=0,a=0,s=[],l=0;l<e;l++)n[l]===n[l+1]?o++:(o>i?(s=[n[l]],i=o,a=0):o===i&&(s.push(n[l]),a++),o=1);return 0===a?s[0]:s},t.range=function(e){return t.max(e)-t.min(e)},t.variance=function(e,n){return t.sumsqerr(e)/(e.length-(n?1:0))},t.pooledvariance=function(e){return e.reduce(function(e,n){return e+t.sumsqerr(n)},0)/(e.reduce(function(t,e){return t+e.length},0)-e.length)},t.deviation=function(e){for(var n=t.mean(e),r=e.length,o=new Array(r),i=0;i<r;i++)o[i]=e[i]-n;return o},t.stdev=function(n,r){return e.sqrt(t.variance(n,r))},t.pooledstdev=function(n){return e.sqrt(t.pooledvariance(n))},t.meandev=function(n){for(var r=t.mean(n),o=[],i=n.length-1;i>=0;i--)o.push(e.abs(n[i]-r));return t.mean(o)},t.meddev=function(n){for(var r=t.median(n),o=[],i=n.length-1;i>=0;i--)o.push(e.abs(n[i]-r));return t.median(o)},t.coeffvar=function(e){return t.stdev(e)/t.mean(e)},t.quartiles=function(t){var n=t.length,o=t.slice().sort(r);return[o[e.round(n/4)-1],o[e.round(n/2)-1],o[e.round(3*n/4)-1]]},t.quantiles=function(t,n,i,a){var s,l,u,c,f=t.slice().sort(r),h=[n.length],d=t.length;void 0===i&&(i=3/8),void 0===a&&(a=3/8);for(var p=0;p<n.length;p++)l=d*(s=n[p])+(i+s*(1-i-a)),u=e.floor(o(l,1,d-1)),c=o(l-u,0,1),h[p]=(1-c)*f[u-1]+c*f[u];return h},t.percentile=function(t,e){var n=t.slice().sort(r),o=e*(n.length-1),i=parseInt(o),a=o-i;return i+1<n.length?n[i]*(1-a)+n[i+1]*a:n[i]},t.percentileOfScore=function(t,e,n){var r,o=0,i=t.length,a=!1;"strict"===n&&(a=!0);for(var s=0;s<i;s++)r=t[s],(a&&r<e||!a&&r<=e)&&o++;return o/i},t.histogram=function(n,r){for(var o=t.min(n),i=r||4,a=(t.max(n)-o)/i,s=n.length,l=(r=[],0);l<i;l++)r[l]=0;for(l=0;l<s;l++)r[e.min(e.floor((n[l]-o)/a),i-1)]+=1;return r},t.covariance=function(e,n){for(var r=t.mean(e),o=t.mean(n),i=e.length,a=new Array(i),s=0;s<i;s++)a[s]=(e[s]-r)*(n[s]-o);return t.sum(a)/(i-1)},t.corrcoeff=function(e,n){return t.covariance(e,n)/t.stdev(e,1)/t.stdev(n,1)},t.spearmancoeff=function(e,n){return e=t.rank(e),n=t.rank(n),t.corrcoeff(e,n)},t.stanMoment=function(n,r){for(var o=t.mean(n),i=t.stdev(n),a=n.length,s=0,l=0;l<a;l++)s+=e.pow((n[l]-o)/i,r);return s/n.length},t.skewness=function(e){return t.stanMoment(e,3)},t.kurtosis=function(e){return t.stanMoment(e,4)-3};var i=t.prototype;!function(e){for(var r=0;r<e.length;r++)!function(e){i[e]=function(r,o){var a=[],s=0,l=this;if(n(r)&&(o=r,r=!1),o)return setTimeout(function(){o.call(l,i[e].call(l,r))}),this;if(this.length>1){for(l=!0===r?this:this.transpose();s<l.length;s++)a[s]=t[e](l[s]);return a}return t[e](this[0],r)}}(e[r])}("cumsum cumprod".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){i[e]=function(r,o){var a=[],s=0,l=this;if(n(r)&&(o=r,r=!1),o)return setTimeout(function(){o.call(l,i[e].call(l,r))}),this;if(this.length>1){for("sumrow"!==e&&(l=!0===r?this:this.transpose());s<l.length;s++)a[s]=t[e](l[s]);return!0===r?t[e](t.utils.toVector(a)):a}return t[e](this[0],r)}}(e[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){i[e]=function(){var r=[],o=0,a=this,s=Array.prototype.slice.call(arguments);if(n(s[s.length-1])){var l=s[s.length-1],u=s.slice(0,s.length-1);return setTimeout(function(){l.call(a,i[e].apply(a,u))}),this}l=void 0;var c=function(n){return t[e].apply(a,[n].concat(s))};if(this.length>1){for(a=a.transpose();o<a.length;o++)r[o]=c(a[o]);return r}return c(this[0])}}(e[r])}("quantiles percentileOfScore".split(" "))}(o=function(t,e){var n=Array.prototype.concat,r=Array.prototype.slice,o=Object.prototype.toString;function a(e,n){var r=e>n?e:n;return t.pow(10,17-~~(t.log(r>0?r:-r)*t.LOG10E))}var s=Array.isArray||function(t){return"[object Array]"===o.call(t)};function l(t){return"[object Function]"===o.call(t)}function u(t){return"number"==typeof t&&t==t}function c(){return new c._init(arguments)}function f(){return 0}function h(){return 1}function d(t,e){return t===e?1:0}c.fn=c.prototype,c._init=function(t){if(s(t[0]))if(s(t[0][0])){l(t[1])&&(t[0]=c.map(t[0],t[1]));for(var e=0;e<t[0].length;e++)this[e]=t[0][e];this.length=t[0].length}else this[0]=l(t[1])?c.map(t[0],t[1]):t[0],this.length=1;else if(u(t[0]))this[0]=c.seq.apply(null,t),this.length=1;else{if(t[0]instanceof c)return c(t[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:a,isArray:s,isFunction:l,isNumber:u,toVector:function(t){return n.apply([],t)}},c.extend=function(t){var e;if(1===arguments.length){for(e in t)c[e]=t[e];return this}for(var n=1;n<arguments.length;n++)for(e in arguments[n])t[e]=arguments[n][e];return t},c.rows=function(t){return t.length||1},c.cols=function(t){return t[0].length||1},c.dimensions=function(t){return{rows:c.rows(t),cols:c.cols(t)}},c.row=function(t,e){return s(e)?e.map(function(e){return c.row(t,e)}):t[e]},c.rowa=function(t,e){return c.row(t,e)},c.col=function(t,e){if(s(e)){var n=c.arange(t.length).map(function(t){return new Array(e.length)});return e.forEach(function(e,r){c.arange(t.length).forEach(function(o){n[o][r]=t[o][e]})}),n}for(var r=new Array(t.length),o=0;o<t.length;o++)r[o]=[t[o][e]];return r},c.cola=function(t,e){return c.col(t,e).map(function(t){return t[0]})},c.diag=function(t){for(var e=c.rows(t),n=new Array(e),r=0;r<e;r++)n[r]=[t[r][r]];return n},c.antidiag=function(t){for(var e=c.rows(t)-1,n=new Array(e),r=0;e>=0;e--,r++)n[r]=[t[r][e]];return n},c.transpose=function(t){var e,n,r,o,i=[];s(t[0])||(t=[t]),n=t.length,r=t[0].length;for(var a=0;a<r;a++){for(e=new Array(n),o=0;o<n;o++)e[o]=t[o][a];i.push(e)}return 1===i.length?i[0]:i},c.map=function(t,e,n){var r,o,i,a,l;for(s(t[0])||(t=[t]),o=t.length,i=t[0].length,a=n?t:new Array(o),r=0;r<o;r++)for(a[r]||(a[r]=new Array(i)),l=0;l<i;l++)a[r][l]=e(t[r][l],r,l);return 1===a.length?a[0]:a},c.cumreduce=function(t,e,n){var r,o,i,a,l;for(s(t[0])||(t=[t]),o=t.length,i=t[0].length,a=n?t:new Array(o),r=0;r<o;r++)for(a[r]||(a[r]=new Array(i)),i>0&&(a[r][0]=t[r][0]),l=1;l<i;l++)a[r][l]=e(a[r][l-1],t[r][l]);return 1===a.length?a[0]:a},c.alter=function(t,e){return c.map(t,e,!0)},c.create=function(t,e,n){var r,o=new Array(t);l(e)&&(n=e,e=t);for(var i=0;i<t;i++)for(o[i]=new Array(e),r=0;r<e;r++)o[i][r]=n(i,r);return o},c.zeros=function(t,e){return u(e)||(e=t),c.create(t,e,f)},c.ones=function(t,e){return u(e)||(e=t),c.create(t,e,h)},c.rand=function(e,n){return u(n)||(n=e),c.create(e,n,t.random)},c.identity=function(t,e){return u(e)||(e=t),c.create(t,e,d)},c.symmetric=function(t){var e,n,r=t.length;if(t.length!==t[0].length)return!1;for(e=0;e<r;e++)for(n=0;n<r;n++)if(t[n][e]!==t[e][n])return!1;return!0},c.clear=function(t){return c.alter(t,f)},c.seq=function(t,e,n,r){l(r)||(r=!1);var o,i=[],s=a(t,e),u=(e*s-t*s)/((n-1)*s),c=t;for(o=0;c<=e&&o<n;c=(t*s+u*s*++o)/s)i.push(r?r(c,o):c);return i},c.arange=function(t,n,r){var o=[];if(r=r||1,n===e&&(n=t,t=0),t===n||0===r)return[];if(t<n&&r<0)return[];if(t>n&&r>0)return[];if(r>0)for(i=t;i<n;i+=r)o.push(i);else for(i=t;i>n;i+=r)o.push(i);return o},c.slice=function(){function t(t,n,r,o){var i,a=[],s=t.length;if(n===e&&r===e&&o===e)return c.copy(t);if(n=n||0,r=r||t.length,o=o||1,(n=n>=0?n:s+n)===(r=r>=0?r:s+r)||0===o)return[];if(n<r&&o<0)return[];if(n>r&&o>0)return[];if(o>0)for(i=n;i<r;i+=o)a.push(t[i]);else for(i=n;i>r;i+=o)a.push(t[i]);return a}return function(e,n){if(u((n=n||{}).row)){if(u(n.col))return e[n.row][n.col];var r=c.rowa(e,n.row),o=n.col||{};return t(r,o.start,o.end,o.step)}if(u(n.col)){var i=c.cola(e,n.col),a=n.row||{};return t(i,a.start,a.end,a.step)}var a=n.row||{},o=n.col||{};return t(e,a.start,a.end,a.step).map(function(e){return t(e,o.start,o.end,o.step)})}}(),c.sliceAssign=function(n,r,o){if(u(r.row)){if(u(r.col))return n[r.row][r.col]=o;r.col=r.col||{},r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1;var i=c.arange(r.col.start,t.min(n.length,r.col.end),r.col.step),a=r.row;return i.forEach(function(t,e){n[a][t]=o[e]}),n}if(u(r.col)){r.row=r.row||{},r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1;var s=c.arange(r.row.start,t.min(n[0].length,r.row.end),r.row.step),l=r.col;return s.forEach(function(t,e){n[t][l]=o[e]}),n}o[0].length===e&&(o=[o]),r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1;var s=c.arange(r.row.start,t.min(n.length,r.row.end),r.row.step),i=c.arange(r.col.start,t.min(n[0].length,r.col.end),r.col.step);return s.forEach(function(t,e){i.forEach(function(r,i){n[t][r]=o[e][i]})}),n},c.diagonal=function(t){var e=c.zeros(t.length,t.length);return t.forEach(function(t,n){e[n][n]=t}),e},c.copy=function(t){return t.map(function(t){return u(t)?t:t.map(function(t){return t})})};var p=c.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?r.call(this):r.call(this)[0]},p.map=function(t,e){return c(c.map(this,t,e))},p.cumreduce=function(t,e){return c(c.cumreduce(this,t,e))},p.alter=function(t){return c.alter(this,t),this},function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(e){var n,r=this;return e?(setTimeout(function(){e.call(r,p[t].call(r))}),this):(n=c[t](this),s(n)?c(n):n)}}(t[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(e,n){var r=this;return n?(setTimeout(function(){n.call(r,p[t].call(r,e))}),this):c(c[t](this,e))}}(t[e])}("row col".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(){return c(c[t].apply(null,arguments))}}(t[e])}("create zeros ones rand identity".split(" ")),c}(Math),Math),function(t,e){t.gammaln=function(t){var n,r,o,i=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],s=1.000000000190015;for(o=(r=n=t)+5.5,o-=(n+.5)*e.log(o);i<6;i++)s+=a[i]/++r;return e.log(2.5066282746310007*s/n)-o},t.gammafn=function(t){var n,r,o,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,l=0,u=0,c=0,f=t;if(f<=0){if(!(o=f%1+3.6e-16))return 1/0;s=(1&f?-1:1)*e.PI/e.sin(e.PI*o),f=1-f}r=f,n=f<1?f++:(f-=l=(0|f)-1)-1;for(var h=0;h<8;++h)c=(c+i[h])*n,u=u*n+a[h];if(o=c/u+1,r<f)o/=r;else if(r>f)for(h=0;h<l;++h)o*=f,f++;return s&&(o=s/o),o},t.gammap=function(e,n){return t.lowRegGamma(e,n)*t.gammafn(e)},t.lowRegGamma=function(n,r){var o,i=t.gammaln(n),a=n,s=1/n,l=s,u=r+1-n,c=1/1e-30,f=1/u,h=f,d=1,p=-~(8.5*e.log(n>=1?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;d<=p;d++)s+=l*=r/++a;return s*e.exp(-r+n*e.log(r)-i)}for(;d<=p;d++)h*=(f=1/(f=(o=-d*(d-n))*f+(u+=2)))*(c=u+o/c);return 1-h*e.exp(-r+n*e.log(r)-i)},t.factorialln=function(e){return e<0?NaN:t.gammaln(e+1)},t.factorial=function(e){return e<0?NaN:t.gammafn(e+1)},t.combination=function(n,r){return n>170||r>170?e.exp(t.combinationln(n,r)):t.factorial(n)/t.factorial(r)/t.factorial(n-r)},t.combinationln=function(e,n){return t.factorialln(e)-t.factorialln(n)-t.factorialln(e-n)},t.permutation=function(e,n){return t.factorial(e)/t.factorial(e-n)},t.betafn=function(n,r){if(!(n<=0||r<=0))return n+r>170?e.exp(t.betaln(n,r)):t.gammafn(n)*t.gammafn(r)/t.gammafn(n+r)},t.betaln=function(e,n){return t.gammaln(e)+t.gammaln(n)-t.gammaln(e+n)},t.betacf=function(t,n,r){var o,i,a,s,l=1,u=n+r,c=n+1,f=n-1,h=1,d=1-u*t/c;for(e.abs(d)<1e-30&&(d=1e-30),s=d=1/d;l<=100&&(d=1+(i=l*(r-l)*t/((f+(o=2*l))*(n+o)))*d,e.abs(d)<1e-30&&(d=1e-30),h=1+i/h,e.abs(h)<1e-30&&(h=1e-30),s*=(d=1/d)*h,d=1+(i=-(n+l)*(u+l)*t/((n+o)*(c+o)))*d,e.abs(d)<1e-30&&(d=1e-30),h=1+i/h,e.abs(h)<1e-30&&(h=1e-30),s*=a=(d=1/d)*h,!(e.abs(a-1)<3e-7));l++);return s},t.gammapinv=function(n,r){var o,i,a,s,l,u,c=0,f=r-1,h=t.gammaln(r);if(n>=1)return e.max(100,r+100*e.sqrt(r));if(n<=0)return 0;for(r>1?(l=e.log(f),u=e.exp(f*(l-1)-h),s=n<.5?n:1-n,o=(2.30753+.27061*(i=e.sqrt(-2*e.log(s))))/(1+i*(.99229+.04481*i))-i,n<.5&&(o=-o),o=e.max(.001,r*e.pow(1-1/(9*r)-o/(3*e.sqrt(r)),3))):o=n<(i=1-r*(.253+.12*r))?e.pow(n/i,1/r):1-e.log(1-(n-i)/(1-i));c<12;c++){if(o<=0)return 0;if((o-=i=(a=(t.lowRegGamma(r,o)-n)/(i=r>1?u*e.exp(-(o-f)+f*(e.log(o)-l)):e.exp(-o+f*e.log(o)-h)))/(1-.5*e.min(1,a*((r-1)/o-1))))<=0&&(o=.5*(o+i)),e.abs(i)<1e-8*o)break}return o},t.erf=function(t){var n,r,o,i,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],s=a.length-1,l=!1,u=0,c=0;for(t<0&&(t=-t,l=!0),r=4*(n=2/(2+t))-2;s>0;s--)o=u,u=r*u-c+a[s],c=o;return i=n*e.exp(-t*t+.5*(a[0]+r*u)-c),l?i-1:1-i},t.erfc=function(e){return 1-t.erf(e)},t.erfcinv=function(n){var r,o,i,a,s=0;if(n>=2)return-100;if(n<=0)return 100;for(a=n<1?n:2-n,r=-.70711*((2.30753+.27061*(i=e.sqrt(-2*e.log(a/2))))/(1+i*(.99229+.04481*i))-i);s<2;s++)r+=(o=t.erfc(r)-a)/(1.1283791670955126*e.exp(-r*r)-r*o);return n<1?r:-r},t.ibetainv=function(n,r,o){var i,a,s,l,u,c,f,h,d,p,g=r-1,v=o-1,y=0;if(n<=0)return 0;if(n>=1)return 1;for(r>=1&&o>=1?(s=n<.5?n:1-n,c=(2.30753+.27061*(l=e.sqrt(-2*e.log(s))))/(1+l*(.99229+.04481*l))-l,n<.5&&(c=-c),f=(c*c-3)/6,h=2/(1/(2*r-1)+1/(2*o-1)),d=c*e.sqrt(f+h)/h-(1/(2*o-1)-1/(2*r-1))*(f+5/6-2/(3*h)),c=r/(r+o*e.exp(2*d))):(i=e.log(r/(r+o)),a=e.log(o/(r+o)),c=n<(l=e.exp(r*i)/r)/(d=l+(u=e.exp(o*a)/o))?e.pow(r*d*n,1/r):1-e.pow(o*d*(1-n),1/o)),p=-t.gammaln(r)-t.gammaln(o)+t.gammaln(r+o);y<10;y++){if(0===c||1===c)return c;if((c-=l=(u=(t.ibeta(c,r,o)-n)/(l=e.exp(g*e.log(c)+v*e.log(1-c)+p)))/(1-.5*e.min(1,u*(g/c-v/(1-c)))))<=0&&(c=.5*(c+l)),c>=1&&(c=.5*(c+l+1)),e.abs(l)<1e-8*c&&y>0)break}return c},t.ibeta=function(n,r,o){var i=0===n||1===n?0:e.exp(t.gammaln(r+o)-t.gammaln(r)-t.gammaln(o)+r*e.log(n)+o*e.log(1-n));return!(n<0||n>1)&&(n<(r+1)/(r+o+2)?i*t.betacf(n,r,o)/r:1-i*t.betacf(1-n,o,r)/o)},t.randn=function(n,r){var o,i,a,s,l;if(r||(r=n),n)return t.create(n,r,function(){return t.randn()});do{o=e.random(),i=1.7156*(e.random()-.5),l=(a=o-.449871)*a+(s=e.abs(i)+.386595)*(.196*s-.25472*a)}while(l>.27597&&(l>.27846||i*i>-4*e.log(o)*o*o));return i/o},t.randg=function(n,r,o){var i,a,s,l,u,c,f=n;if(o||(o=r),n||(n=1),r)return(c=t.zeros(r,o)).alter(function(){return t.randg(n)}),c;n<1&&(n+=1),i=n-1/3,a=1/e.sqrt(9*i);do{do{l=1+a*(u=t.randn())}while(l<=0);l*=l*l,s=e.random()}while(s>1-.331*e.pow(u,4)&&e.log(s)>.5*u*u+i*(1-l+e.log(l)));if(n==f)return i*l;do{s=e.random()}while(0===s);return e.pow(s,1/f)*i*l},function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(){return t(t.map(this,function(n){return t[e](n)}))}}(e[n])}("gammaln gammafn factorial factorialln".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(){return t(t[e].apply(null,arguments))}}(e[n])}("randn".split(" "))}(o,Math),function(t,e){function n(n,r,o){var i=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],a=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],s=.5*n;if(s>=8)return 1;var l,u=2*t.normal.cdf(s,0,1,1,0)-1;u=u>=e.exp(-50/o)?e.pow(u,o):0;for(var c=s,f=(8-s)/(l=n>3?2:3),h=c+f,d=0,p=o-1,g=1;g<=l;g++){for(var v=0,y=.5*(h+c),m=.5*(h-c),b=1;b<=12;b++){var w,C=y+m*(6<b?i[(w=12-b+1)-1]:-i[(w=b)-1]),O=C*C;if(O>60)break;var E=2*t.normal.cdf(C,0,1,1,0)*.5-2*t.normal.cdf(C,n,1,1,0)*.5;E>=e.exp(-30/p)&&(v+=E=a[w-1]*e.exp(-.5*O)*e.pow(E,p))}d+=v*=2*m*o/e.sqrt(2*e.PI),c=h,h+=f}return(u+=d)<=e.exp(-30/r)?0:(u=e.pow(u,r))>=1?1:u}!function(e){for(var n=0;n<e.length;n++)!function(e){t[e]=function(t,e,n){return this instanceof arguments.callee?(this._a=t,this._b=e,this._c=n,this):new arguments.callee(t,e,n)},t.fn[e]=function(n,r,o){var i=t[e](n,r,o);return i.data=this,i},t[e].prototype.sample=function(n){var r=this._a,o=this._b,i=this._c;return n?t.alter(n,function(){return t[e].sample(r,o,i)}):t[e].sample(r,o,i)},function(n){for(var r=0;r<n.length;r++)!function(n){t[e].prototype[n]=function(r){var o=this._a,i=this._b,a=this._c;return r||0===r||(r=this.data),"number"!=typeof r?t.fn.map.call(r,function(r){return t[e][n](r,o,i,a)}):t[e][n](r,o,i,a)}}(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){t[e].prototype[n]=function(){return t[e][n](this._a,this._b,this._c)}}(n[r])}("mean median mode variance".split(" "))}(e[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(n,r,o){return n>1||n<0?0:1==r&&1==o?1:r<512&&o<512?e.pow(n,r-1)*e.pow(1-n,o-1)/t.betafn(r,o):e.exp((r-1)*e.log(n)+(o-1)*e.log(1-n)-t.betaln(r,o))},cdf:function(e,n,r){return e>1||e<0?1*(e>1):t.ibeta(e,n,r)},inv:function(e,n,r){return t.ibetainv(e,n,r)},mean:function(t,e){return t/(t+e)},median:function(e,n){return t.ibetainv(.5,e,n)},mode:function(t,e){return(t-1)/(t+e-2)},sample:function(e,n){var r=t.randg(e);return r/(r+t.randg(n))},variance:function(t,n){return t*n/(e.pow(t+n,2)*(t+n+1))}}),t.extend(t.centralF,{pdf:function(n,r,o){var i;return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:1/t.betafn(r/2,o/2)*e.pow(r/o,r/2)*e.pow(n,r/2-1)*e.pow(1+r/o*n,-(r+o)/2):(i=r*n/(o+n*r),r*(o/(o+n*r))/2*t.binomial.pdf((r-2)/2,(r+o-2)/2,i))},cdf:function(e,n,r){return e<0?0:t.ibeta(n*e/(n*e+r),n/2,r/2)},inv:function(e,n,r){return r/(n*(1/t.ibetainv(e,n/2,r/2)-1))},mean:function(t,e){return e>2?e/(e-2):void 0},mode:function(t,e){return t>2?e*(t-2)/(t*(e+2)):void 0},sample:function(e,n){return 2*t.randg(e/2)/e/(2*t.randg(n/2)/n)},variance:function(t,e){if(!(e<=4))return 2*e*e*(t+e-2)/(t*(e-2)*(e-2)*(e-4))}}),t.extend(t.cauchy,{pdf:function(t,n,r){return r<0?0:r/(e.pow(t-n,2)+e.pow(r,2))/e.PI},cdf:function(t,n,r){return e.atan((t-n)/r)/e.PI+.5},inv:function(t,n,r){return n+r*e.tan(e.PI*(t-.5))},median:function(t,e){return t},mode:function(t,e){return t},sample:function(n,r){return t.randn()*e.sqrt(1/(2*t.randg(.5)))*r+n}}),t.extend(t.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:e.exp((r/2-1)*e.log(n)-n/2-r/2*e.log(2)-t.gammaln(r/2))},cdf:function(e,n){return e<0?0:t.lowRegGamma(n/2,e/2)},inv:function(e,n){return 2*t.gammapinv(e,.5*n)},mean:function(t){return t},median:function(t){return t*e.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(e){return 2*t.randg(e/2)},variance:function(t){return 2*t}}),t.extend(t.exponential,{pdf:function(t,n){return t<0?0:n*e.exp(-n*t)},cdf:function(t,n){return t<0?0:1-e.exp(-n*t)},inv:function(t,n){return-e.log(1-t)/n},mean:function(t){return 1/t},median:function(t){return 1/t*e.log(2)},mode:function(t){return 0},sample:function(t){return-1/t*e.log(e.random())},variance:function(t){return e.pow(t,-2)}}),t.extend(t.gamma,{pdf:function(n,r,o){return n<0?0:0===n&&1===r?1/o:e.exp((r-1)*e.log(n)-n/o-t.gammaln(r)-r*e.log(o))},cdf:function(e,n,r){return e<0?0:t.lowRegGamma(n,e/r)},inv:function(e,n,r){return t.gammapinv(e,n)*r},mean:function(t,e){return t*e},mode:function(t,e){if(t>1)return(t-1)*e},sample:function(e,n){return t.randg(e)*n},variance:function(t,e){return t*e*e}}),t.extend(t.invgamma,{pdf:function(n,r,o){return n<=0?0:e.exp(-(r+1)*e.log(n)-o/n-t.gammaln(r)+r*e.log(o))},cdf:function(e,n,r){return e<=0?0:1-t.lowRegGamma(n,r/e)},inv:function(e,n,r){return r/t.gammapinv(1-e,n)},mean:function(t,e){return t>1?e/(t-1):void 0},mode:function(t,e){return e/(t+1)},sample:function(e,n){return n/t.randg(e)},variance:function(t,e){if(!(t<=2))return e*e/((t-1)*(t-1)*(t-2))}}),t.extend(t.kumaraswamy,{pdf:function(t,n,r){return 0===t&&1===n?r:1===t&&1===r?n:e.exp(e.log(n)+e.log(r)+(n-1)*e.log(t)+(r-1)*e.log(1-e.pow(t,n)))},cdf:function(t,n,r){return t<0?0:t>1?1:1-e.pow(1-e.pow(t,n),r)},inv:function(t,n,r){return e.pow(1-e.pow(1-t,1/r),1/n)},mean:function(e,n){return n*t.gammafn(1+1/e)*t.gammafn(n)/t.gammafn(1+1/e+n)},median:function(t,n){return e.pow(1-e.pow(2,-1/n),1/t)},mode:function(t,n){if(t>=1&&n>=1&&1!==t&&1!==n)return e.pow((t-1)/(t*n-1),1/t)},variance:function(t,e){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(t,n,r){return t<=0?0:e.exp(-e.log(t)-.5*e.log(2*e.PI)-e.log(r)-e.pow(e.log(t)-n,2)/(2*r*r))},cdf:function(n,r,o){return n<0?0:.5+.5*t.erf((e.log(n)-r)/e.sqrt(2*o*o))},inv:function(n,r,o){return e.exp(-1.4142135623730951*o*t.erfcinv(2*n)+r)},mean:function(t,n){return e.exp(t+n*n/2)},median:function(t,n){return e.exp(t)},mode:function(t,n){return e.exp(t-n*n)},sample:function(n,r){return e.exp(t.randn()*r+n)},variance:function(t,n){return(e.exp(n*n)-1)*e.exp(2*t+n*n)}}),t.extend(t.noncentralt,{pdf:function(n,r,o){return e.abs(o)<1e-14?t.studentt.pdf(n,r):e.abs(n)<1e-14?e.exp(t.gammaln((r+1)/2)-o*o/2-.5*e.log(e.PI*r)-t.gammaln(r/2)):r/n*(t.noncentralt.cdf(n*e.sqrt(1+2/r),r+2,o)-t.noncentralt.cdf(n,r,o))},cdf:function(n,r,o){if(e.abs(o)<1e-14)return t.studentt.cdf(n,r);var i=!1;n<0&&(i=!0,o=-o);for(var a=t.normal.cdf(-o,0,1),s=1e-14+1,l=s,u=n*n/(n*n+r),c=0,f=e.exp(-o*o/2),h=e.exp(-o*o/2-.5*e.log(2)-t.gammaln(1.5))*o;c<200||l>1e-14||s>1e-14;)l=s,c>0&&(f*=o*o/(2*c),h*=o*o/(2*(c+.5))),a+=.5*(s=f*t.beta.cdf(u,c+.5,r/2)+h*t.beta.cdf(u,c+1,r/2)),c++;return i?1-a:a}}),t.extend(t.normal,{pdf:function(t,n,r){return e.exp(-.5*e.log(2*e.PI)-e.log(r)-e.pow(t-n,2)/(2*r*r))},cdf:function(n,r,o){return.5*(1+t.erf((n-r)/e.sqrt(2*o*o)))},inv:function(e,n,r){return-1.4142135623730951*r*t.erfcinv(2*e)+n},mean:function(t,e){return t},median:function(t,e){return t},mode:function(t,e){return t},sample:function(e,n){return t.randn()*n+e},variance:function(t,e){return e*e}}),t.extend(t.pareto,{pdf:function(t,n,r){return t<n?0:r*e.pow(n,r)/e.pow(t,r+1)},cdf:function(t,n,r){return t<n?0:1-e.pow(n/t,r)},inv:function(t,n,r){return n/e.pow(1-t,1/r)},mean:function(t,n){if(!(n<=1))return n*e.pow(t,n)/(n-1)},median:function(t,n){return t*(n*e.SQRT2)},mode:function(t,e){return t},variance:function(t,n){if(!(n<=2))return t*t*n/(e.pow(n-1,2)*(n-2))}}),t.extend(t.studentt,{pdf:function(n,r){return r=r>1e100?1e100:r,1/(e.sqrt(r)*t.betafn(.5,r/2))*e.pow(1+n*n/r,-(r+1)/2)},cdf:function(n,r){var o=r/2;return t.ibeta((n+e.sqrt(n*n+r))/(2*e.sqrt(n*n+r)),o,o)},inv:function(n,r){var o=t.ibetainv(2*e.min(n,1-n),.5*r,.5);return o=e.sqrt(r*(1-o)/o),n>.5?o:-o},mean:function(t){return t>1?0:void 0},median:function(t){return 0},mode:function(t){return 0},sample:function(n){return t.randn()*e.sqrt(n/(2*t.randg(n/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(t,n,r){return t<0||n<0||r<0?0:r/n*e.pow(t/n,r-1)*e.exp(-e.pow(t/n,r))},cdf:function(t,n,r){return t<0?0:1-e.exp(-e.pow(t/n,r))},inv:function(t,n,r){return n*e.pow(-e.log(1-t),1/r)},mean:function(e,n){return e*t.gammafn(1+1/n)},median:function(t,n){return t*e.pow(e.log(2),1/n)},mode:function(t,n){return n<=1?0:t*e.pow((n-1)/n,1/n)},sample:function(t,n){return t*e.pow(-e.log(e.random()),1/n)},variance:function(n,r){return n*n*t.gammafn(1+2/r)-e.pow(t.weibull.mean(n,r),2)}}),t.extend(t.uniform,{pdf:function(t,e,n){return t<e||t>n?0:1/(n-e)},cdf:function(t,e,n){return t<e?0:t<n?(t-e)/(n-e):1},inv:function(t,e,n){return e+t*(n-e)},mean:function(t,e){return.5*(t+e)},median:function(e,n){return t.mean(e,n)},mode:function(t,e){throw new Error("mode is not yet implemented")},sample:function(t,n){return t/2+n/2+(n/2-t/2)*(2*e.random()-1)},variance:function(t,n){return e.pow(n-t,2)/12}}),t.extend(t.binomial,{pdf:function(n,r,o){return 0===o||1===o?r*o===n?1:0:t.combination(r,n)*e.pow(o,n)*e.pow(1-o,r-n)},cdf:function(e,n,r){var o=[],i=0;if(e<0)return 0;if(e<n){for(;i<=e;i++)o[i]=t.binomial.pdf(i,n,r);return t.sum(o)}return 1}}),t.extend(t.negbin,{pdf:function(n,r,o){return n===n>>>0&&(n<0?0:t.combination(n+r-1,r-1)*e.pow(1-o,n)*e.pow(o,r))},cdf:function(e,n,r){var o=0,i=0;if(e<0)return 0;for(;i<=e;i++)o+=t.negbin.pdf(i,n,r);return o}}),t.extend(t.hypgeom,{pdf:function(n,r,o,i){if(n!=n|0)return!1;if(n<0||n<o-(r-i))return 0;if(n>i||n>o)return 0;if(2*o>r)return 2*i>r?t.hypgeom.pdf(r-o-i+n,r,r-o,r-i):t.hypgeom.pdf(i-n,r,r-o,i);if(2*i>r)return t.hypgeom.pdf(o-n,r,o,r-i);if(o<i)return t.hypgeom.pdf(n,r,i,o);for(var a=1,s=0,l=0;l<n;l++){for(;a>1&&s<i;)a*=1-o/(r-s),s++;a*=(i-l)*(o-l)/((l+1)*(r-o-i+l+1))}for(;s<i;s++)a*=1-o/(r-s);return e.min(1,e.max(0,a))},cdf:function(n,r,o,i){if(n<0||n<o-(r-i))return 0;if(n>=i||n>=o)return 1;if(2*o>r)return 2*i>r?t.hypgeom.cdf(r-o-i+n,r,r-o,r-i):1-t.hypgeom.cdf(i-n-1,r,r-o,i);if(2*i>r)return 1-t.hypgeom.cdf(o-n-1,r,o,r-i);if(o<i)return t.hypgeom.cdf(n,r,i,o);for(var a=1,s=1,l=0,u=0;u<n;u++){for(;a>1&&l<i;){var c=1-o/(r-l);s*=c,a*=c,l++}a+=s*=(i-u)*(o-u)/((u+1)*(r-o-i+u+1))}for(;l<i;l++)a*=1-o/(r-l);return e.min(1,e.max(0,a))}}),t.extend(t.poisson,{pdf:function(n,r){return r<0||n%1!=0||n<0?0:e.pow(r,n)*e.exp(-r)/t.factorial(n)},cdf:function(e,n){var r=[],o=0;if(e<0)return 0;for(;o<=e;o++)r.push(t.poisson.pdf(o,n));return t.sum(r)},mean:function(t){return t},variance:function(t){return t},sample:function(t){var n=1,r=0,o=e.exp(-t);do{r++,n*=e.random()}while(n>o);return r-1}}),t.extend(t.triangular,{pdf:function(t,e,n,r){return n<=e||r<e||r>n?NaN:t<e||t>n?0:t<r?2*(t-e)/((n-e)*(r-e)):t===r?2/(n-e):2*(n-t)/((n-e)*(n-r))},cdf:function(t,n,r,o){return r<=n||o<n||o>r?NaN:t<=n?0:t>=r?1:t<=o?e.pow(t-n,2)/((r-n)*(o-n)):1-e.pow(r-t,2)/((r-n)*(r-o))},inv:function(t,n,r,o){return r<=n||o<n||o>r?NaN:t<=(o-n)/(r-n)?n+(r-n)*e.sqrt(t*((o-n)/(r-n))):n+(r-n)*(1-e.sqrt((1-t)*(1-(o-n)/(r-n))))},mean:function(t,e,n){return(t+e+n)/3},median:function(t,n,r){return r<=(t+n)/2?n-e.sqrt((n-t)*(n-r))/e.sqrt(2):r>(t+n)/2?t+e.sqrt((n-t)*(r-t))/e.sqrt(2):void 0},mode:function(t,e,n){return n},sample:function(t,n,r){var o=e.random();return o<(r-t)/(n-t)?t+e.sqrt(o*(n-t)*(r-t)):n-e.sqrt((1-o)*(n-t)*(n-r))},variance:function(t,e,n){return(t*t+e*e+n*n-t*e-t*n-e*n)/18}}),t.extend(t.arcsine,{pdf:function(t,n,r){return r<=n?NaN:t<=n||t>=r?0:2/e.PI*e.pow(e.pow(r-n,2)-e.pow(2*t-n-r,2),-.5)},cdf:function(t,n,r){return t<n?0:t<r?2/e.PI*e.asin(e.sqrt((t-n)/(r-n))):1},inv:function(t,n,r){return n+(.5-.5*e.cos(e.PI*t))*(r-n)},mean:function(t,e){return e<=t?NaN:(t+e)/2},median:function(t,e){return e<=t?NaN:(t+e)/2},mode:function(t,e){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*e.sin(2*e.PI*t.uniform.sample(0,1))},variance:function(t,n){return n<=t?NaN:e.pow(n-t,2)/8}}),t.extend(t.laplace,{pdf:function(t,n,r){return r<=0?0:e.exp(-e.abs(t-n)/r)/(2*r)},cdf:function(t,n,r){return r<=0?0:t<n?.5*e.exp((t-n)/r):1-.5*e.exp(-(t-n)/r)},mean:function(t,e){return t},median:function(t,e){return t},mode:function(t,e){return t},variance:function(t,e){return 2*e*e},sample:function(t,n){var r,o=e.random()-.5;return t-n*((r=o)/e.abs(r))*e.log(1-2*e.abs(o))}}),t.extend(t.tukey,{cdf:function(r,o,i){var a=o,s=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],l=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(i<2||a<2)return NaN;if(!Number.isFinite(r))return 1;if(i>25e3)return n(r,1,a);var u,c=.5*i,f=c*e.log(i)-i*e.log(2)-t.gammaln(c),h=c-1,d=.25*i;u=i<=100?1:i<=800?.5:i<=5e3?.25:.125,f+=e.log(u);for(var p=0,g=1;g<=50;g++){for(var v=0,y=(2*g-1)*u,m=1;m<=16;m++){var b,w;8<m?(b=m-8-1,w=f+h*e.log(y+s[b]*u)-(s[b]*u+y)*d):(b=m-1,w=f+h*e.log(y-s[b]*u)+(s[b]*u-y)*d),w>=-30&&(v+=n(8<m?r*e.sqrt(.5*(s[b]*u+y)):r*e.sqrt(.5*(-s[b]*u+y)),1,a)*l[b]*e.exp(w))}if(g*u>=1&&v<=1e-14)break;p+=v}if(v>1e-14)throw new Error("tukey.cdf failed to converge");return p>1&&(p=1),p},inv:function(n,r,o){if(o<2||r<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var i,a=function(t,n,r){var o=.5-.5*t,i=e.sqrt(e.log(1/(o*o))),a=i+((((-453642210148e-16*i-.204231210125)*i-.342242088547)*i-1)*i+.322232421088)/((((.0038560700634*i+.10353775285)*i+.531103462366)*i+.588581570495)*i+.099348462606);r<120&&(a+=(a*a*a+a)/r/4);var s=.8832-.2368*a;return r<120&&(s+=-1.214/r+1.208*a/r),a*(s*e.log(n-1)+1.4142)}(n,r,o),s=t.tukey.cdf(a,r,o)-n;i=s>0?e.max(0,a-1):a+1;for(var l,u=t.tukey.cdf(i,r,o)-n,c=1;c<50;c++)if(l=i-u*(i-a)/(u-s),s=u,a=i,l<0&&(l=0,u=-n),u=t.tukey.cdf(l,r,o)-n,i=l,e.abs(i-a)<1e-4)return l;throw new Error("tukey.inv failed to converge")}})}(o,Math),function(t,e){var n,o,a=Array.prototype.push,s=t.utils.isArray;function l(e){return s(e)||e instanceof t}t.extend({add:function(e,n){return l(n)?(l(n[0])||(n=[n]),t.map(e,function(t,e,r){return t+n[e][r]})):t.map(e,function(t){return t+n})},subtract:function(e,n){return l(n)?(l(n[0])||(n=[n]),t.map(e,function(t,e,r){return t-n[e][r]||0})):t.map(e,function(t){return t-n})},divide:function(e,n){return l(n)?(l(n[0])||(n=[n]),t.multiply(e,t.inv(n))):t.map(e,function(t){return t/n})},multiply:function(e,n){var r,o,i,a,s,u,c,f;if(void 0===e.length&&void 0===n.length)return e*n;if(s=e.length,u=e[0].length,c=t.zeros(s,i=l(n)?n[0].length:u),f=0,l(n)){for(;f<i;f++)for(r=0;r<s;r++){for(a=0,o=0;o<u;o++)a+=e[r][o]*n[o][f];c[r][f]=a}return 1===s&&1===f?c[0][0]:c}return t.map(e,function(t){return t*n})},outer:function(e,n){return t.multiply(e.map(function(t){return[t]}),[n])},dot:function(e,n){l(e[0])||(e=[e]),l(n[0])||(n=[n]);for(var r,o,i=1===e[0].length&&1!==e.length?t.transpose(e):e,a=1===n[0].length&&1!==n.length?t.transpose(n):n,s=[],u=0,c=i.length,f=i[0].length;u<c;u++){for(s[u]=[],r=0,o=0;o<f;o++)r+=i[u][o]*a[u][o];s[u]=r}return 1===s.length?s[0]:s},pow:function(n,r){return t.map(n,function(t){return e.pow(t,r)})},exp:function(n){return t.map(n,function(t){return e.exp(t)})},log:function(n){return t.map(n,function(t){return e.log(t)})},abs:function(n){return t.map(n,function(t){return e.abs(t)})},norm:function(t,n){var r=0,o=0;for(isNaN(n)&&(n=2),l(t[0])&&(t=t[0]);o<t.length;o++)r+=e.pow(e.abs(t[o]),n);return e.pow(r,1/n)},angle:function(n,r){return e.acos(t.dot(n,r)/(t.norm(n)*t.norm(r)))},aug:function(t,e){for(var n=[],r=0;r<t.length;r++)n.push(t[r].slice());for(r=0;r<n.length;r++)a.apply(n[r],e[r]);return n},inv:function(e){for(var n,r=e.length,o=e[0].length,i=t.identity(r,o),a=t.gauss_jordan(e,i),s=[],l=0;l<r;l++)for(s[l]=[],n=o;n<a[0].length;n++)s[l][n-o]=a[l][n];return s},det:function(t){var e,n=t.length,r=2*n,o=new Array(r),i=n-1,a=r-1,s=i-n+1,l=a,u=0,c=0;if(2===n)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(;u<r;u++)o[u]=1;for(u=0;u<n;u++){for(e=0;e<n;e++)o[s<0?s+n:s]*=t[u][e],o[l<n?l+n:l]*=t[u][e],s++,l--;s=--i-n+1,l=--a}for(u=0;u<n;u++)c+=o[u];for(;u<r;u++)c-=o[u];return c},gauss_elimination:function(n,r){var o,i,a,s,l=0,u=0,c=n.length,f=n[0].length,h=1,d=0,p=[];for(o=(n=t.aug(n,r))[0].length,l=0;l<c;l++){for(i=n[l][l],u=l,s=l+1;s<f;s++)i<e.abs(n[s][l])&&(i=n[s][l],u=s);if(u!=l)for(s=0;s<o;s++)a=n[l][s],n[l][s]=n[u][s],n[u][s]=a;for(u=l+1;u<c;u++)for(h=n[u][l]/n[l][l],s=l;s<o;s++)n[u][s]=n[u][s]-h*n[l][s]}for(l=c-1;l>=0;l--){for(d=0,u=l+1;u<=c-1;u++)d+=p[u]*n[l][u];p[l]=(n[l][o-1]-d)/n[l][l]}return p},gauss_jordan:function(n,r){for(var o=t.aug(n,r),i=o.length,a=o[0].length,s=0,l=0;l<i;l++){for(var u=l,c=l+1;c<i;c++)e.abs(o[c][l])>e.abs(o[u][l])&&(u=c);var f=o[l];for(o[l]=o[u],o[u]=f,c=l+1;c<i;c++){s=o[c][l]/o[l][l];for(var h=l;h<a;h++)o[c][h]-=o[l][h]*s}}for(l=i-1;l>=0;l--){for(s=o[l][l],c=0;c<l;c++)for(h=a-1;h>l-1;h--)o[c][h]-=o[l][h]*o[c][l]/s;for(o[l][l]/=s,h=i;h<a;h++)o[l][h]/=s}return o},triaUpSolve:function(e,n){var r,o=e[0].length,i=t.zeros(1,o)[0],a=!1;return null!=n[0].length&&(n=n.map(function(t){return t[0]}),a=!0),t.arange(o-1,-1,-1).forEach(function(a){r=t.arange(a+1,o).map(function(t){return i[t]*e[a][t]}),i[a]=(n[a]-t.sum(r))/e[a][a]}),a?i.map(function(t){return[t]}):i},triaLowSolve:function(e,n){var r,o=e[0].length,i=t.zeros(1,o)[0],a=!1;return null!=n[0].length&&(n=n.map(function(t){return t[0]}),a=!0),t.arange(o).forEach(function(o){r=t.arange(o).map(function(t){return e[o][t]*i[t]}),i[o]=(n[o]-t.sum(r))/e[o][o]}),a?i.map(function(t){return[t]}):i},lu:function(e){var n,r=e.length,o=t.identity(r),a=t.zeros(e.length,e[0].length);return t.arange(r).forEach(function(t){a[0][t]=e[0][t]}),t.arange(1,r).forEach(function(s){t.arange(s).forEach(function(r){n=t.arange(r).map(function(t){return o[s][t]*a[t][r]}),o[s][r]=(e[s][r]-t.sum(n))/a[r][r]}),t.arange(s,r).forEach(function(r){n=t.arange(s).map(function(t){return o[s][t]*a[t][r]}),a[s][r]=e[i][r]-t.sum(n)})}),[o,a]},cholesky:function(n){var r,o=n.length,i=t.zeros(n.length,n[0].length);return t.arange(o).forEach(function(a){r=t.arange(a).map(function(t){return e.pow(i[a][t],2)}),i[a][a]=e.sqrt(n[a][a]-t.sum(r)),t.arange(a+1,o).forEach(function(e){r=t.arange(a).map(function(t){return i[a][t]*i[e][t]}),i[e][a]=(n[a][e]-t.sum(r))/i[a][a]})}),i},gauss_jacobi:function(n,r,o,i){for(var a,s,l,u,c=0,f=0,h=n.length,d=[],p=[],g=[];c<h;c++)for(d[c]=[],p[c]=[],g[c]=[],f=0;f<h;f++)c>f?(d[c][f]=n[c][f],p[c][f]=g[c][f]=0):c<f?(p[c][f]=n[c][f],d[c][f]=g[c][f]=0):(g[c][f]=n[c][f],d[c][f]=p[c][f]=0);for(l=t.multiply(t.multiply(t.inv(g),t.add(d,p)),-1),s=t.multiply(t.inv(g),r),a=o,u=t.add(t.multiply(l,o),s),c=2;e.abs(t.norm(t.subtract(u,a)))>i;)a=u,u=t.add(t.multiply(l,a),s),c++;return u},gauss_seidel:function(n,r,o,i){for(var a,s,l,u,c,f=0,h=n.length,d=[],p=[],g=[];f<h;f++)for(d[f]=[],p[f]=[],g[f]=[],a=0;a<h;a++)f>a?(d[f][a]=n[f][a],p[f][a]=g[f][a]=0):f<a?(p[f][a]=n[f][a],d[f][a]=g[f][a]=0):(g[f][a]=n[f][a],d[f][a]=p[f][a]=0);for(u=t.multiply(t.multiply(t.inv(t.add(g,d)),p),-1),l=t.multiply(t.inv(t.add(g,d)),r),s=o,c=t.add(t.multiply(u,o),l),f=2;e.abs(t.norm(t.subtract(c,s)))>i;)s=c,c=t.add(t.multiply(u,s),l),f+=1;return c},SOR:function(n,r,o,i,a){for(var s,l,u,c,f,h=0,d=n.length,p=[],g=[],v=[];h<d;h++)for(p[h]=[],g[h]=[],v[h]=[],s=0;s<d;s++)h>s?(p[h][s]=n[h][s],g[h][s]=v[h][s]=0):h<s?(g[h][s]=n[h][s],p[h][s]=v[h][s]=0):(v[h][s]=n[h][s],p[h][s]=g[h][s]=0);for(c=t.multiply(t.inv(t.add(v,t.multiply(p,a))),t.subtract(t.multiply(v,1-a),t.multiply(g,a))),u=t.multiply(t.multiply(t.inv(t.add(v,t.multiply(p,a))),r),a),l=o,f=t.add(t.multiply(c,o),u),h=2;e.abs(t.norm(t.subtract(f,l)))>i;)l=f,f=t.add(t.multiply(c,l),u),h++;return f},householder:function(n){for(var r,o,i,a,s=n.length,l=n[0].length,u=0,c=[],f=[];u<s-1;u++){for(r=0,a=u+1;a<l;a++)r+=n[a][u]*n[a][u];for(r=(n[u+1][u]>0?-1:1)*e.sqrt(r),o=e.sqrt((r*r-n[u+1][u]*r)/2),(c=t.zeros(s,1))[u+1][0]=(n[u+1][u]-r)/(2*o),i=u+2;i<s;i++)c[i][0]=n[i][u]/(2*o);f=t.subtract(t.identity(s,l),t.multiply(t.multiply(c,t.transpose(c)),2)),n=t.multiply(f,t.multiply(n,f))}return n},QR:(n=t.sum,o=t.arange,function(i){var a,s,l,u=i.length,c=i[0].length;for(i=t.copy(i),r=t.zeros(c,c),s=0;s<c;s++){for(r[s][s]=e.sqrt(n(o(u).map(function(t){return i[t][s]*i[t][s]}))),a=0;a<u;a++)i[a][s]=i[a][s]/r[s][s];for(l=s+1;l<c;l++)for(r[s][l]=n(o(u).map(function(t){return i[t][s]*i[t][l]})),a=0;a<u;a++)i[a][l]=i[a][l]-i[a][s]*r[s][l]}return[i,r]}),lstsq:function(e,n){var r=!1;void 0===n[0].length&&(n=n.map(function(t){return[t]}),r=!0);var o=t.QR(e),i=o[0],a=o[1],s=e[0].length,l=t.slice(i,{col:{end:s}}),u=function(e){var n=(e=t.copy(e)).length,r=t.identity(n);return t.arange(n-1,-1,-1).forEach(function(n){t.sliceAssign(r,{row:n},t.divide(t.slice(r,{row:n}),e[n][n])),t.sliceAssign(e,{row:n},t.divide(t.slice(e,{row:n}),e[n][n])),t.arange(n).forEach(function(o){var i=t.multiply(e[o][n],-1),a=t.slice(e,{row:o}),s=t.multiply(t.slice(e,{row:n}),i);t.sliceAssign(e,{row:o},t.add(a,s));var l=t.slice(r,{row:o}),u=t.multiply(t.slice(r,{row:n}),i);t.sliceAssign(r,{row:o},t.add(l,u))})}),r}(t.slice(a,{row:{end:s}})),c=t.transpose(l);void 0===c[0].length&&(c=[c]);var f=t.multiply(t.multiply(u,c),n);return void 0===f.length&&(f=[[f]]),r?f.map(function(t){return t[0]}):f},jacobi:function(n){for(var r,o,i,a,s,l,u=1,c=n.length,f=t.identity(c,c),h=[];1===u;){a=n[0][1],o=0,i=1;for(var d=0;d<c;d++)for(r=0;r<c;r++)d!=r&&a<e.abs(n[d][r])&&(a=e.abs(n[d][r]),o=d,i=r);for(s=n[o][o]===n[i][i]?n[o][i]>0?e.PI/4:-e.PI/4:e.atan(2*n[o][i]/(n[o][o]-n[i][i]))/2,(l=t.identity(c,c))[o][o]=e.cos(s),l[o][i]=-e.sin(s),l[i][o]=e.sin(s),l[i][i]=e.cos(s),f=t.multiply(f,l),n=t.multiply(t.multiply(t.inv(l),n),l),u=0,d=1;d<c;d++)for(r=1;r<c;r++)d!=r&&e.abs(n[d][r])>.001&&(u=1)}for(d=0;d<c;d++)h.push(n[d][d]);return[f,h]},rungekutta:function(t,e,n,r,o,i){var a,s,l;if(2===i)for(;r<=n;)o+=((a=e*t(r,o))+(s=e*t(r+e,o+a)))/2,r+=e;if(4===i)for(;r<=n;)o+=((a=e*t(r,o))+2*(s=e*t(r+e/2,o+a/2))+2*(l=e*t(r+e/2,o+s/2))+e*t(r+e,o+l))/6,r+=e;return o},romberg:function(t,n,r,o){for(var i,a,s,l,u,c=0,f=(r-n)/2,h=[],d=[],p=[];c<o/2;){for(u=t(n),s=n,l=0;s<=r;s+=f,l++)h[l]=s;for(i=h.length,s=1;s<i-1;s++)u+=(s%2!=0?4:2)*t(h[s]);u=f/3*(u+t(r)),p[c]=u,f/=2,c++}for(a=p.length,i=1;1!==a;){for(s=0;s<a-1;s++)d[s]=(e.pow(4,i)*p[s+1]-p[s])/(e.pow(4,i)-1);a=d.length,p=d,d=[],i++}return p},richardson:function(t,n,r,o){function i(t,e){for(var n,r=0,o=t.length;r<o;r++)t[r]===e&&(n=r);return n}t.length;for(var a,s,l,u,c,f=e.abs(r-t[i(t,r)+1]),h=0,d=[],p=[];o>=f;)a=i(t,r+o),s=i(t,r),d[h]=(n[a]-2*n[s]+n[2*s-a])/(o*o),o/=2,h++;for(u=d.length,l=1;1!=u;){for(c=0;c<u-1;c++)p[c]=(e.pow(4,l)*d[c+1]-d[c])/(e.pow(4,l)-1);u=p.length,d=p,p=[],l++}return d},simpson:function(t,e,n,r){for(var o,i=(n-e)/r,a=t(e),s=[],l=e,u=0,c=1;l<=n;l+=i,u++)s[u]=l;for(o=s.length;c<o-1;c++)a+=(c%2!=0?4:2)*t(s[c]);return i/3*(a+t(n))},hermite:function(t,e,n,r){for(var o,i=t.length,a=0,s=0,l=[],u=[],c=[],f=[];s<i;s++){for(l[s]=1,o=0;o<i;o++)s!=o&&(l[s]*=(r-t[o])/(t[s]-t[o]));for(u[s]=0,o=0;o<i;o++)s!=o&&(u[s]+=1/(t[s]-t[o]));c[s]=(1-2*(r-t[s])*u[s])*(l[s]*l[s]),f[s]=(r-t[s])*(l[s]*l[s]),a+=c[s]*e[s]+f[s]*n[s]}return a},lagrange:function(t,e,n){for(var r,o,i=0,a=0,s=t.length;a<s;a++){for(o=e[a],r=0;r<s;r++)a!=r&&(o*=(n-t[r])/(t[a]-t[r]));i+=o}return i},cubic_spline:function(e,n,r){for(var o,i,a=e.length,s=0,l=[],u=[],c=[],f=[],h=[],d=[];s<a-1;s++)f[s]=e[s+1]-e[s];for(c[0]=0,s=1;s<a-1;s++)c[s]=3/f[s]*(n[s+1]-n[s])-3/f[s-1]*(n[s]-n[s-1]);for(s=1;s<a-1;s++)l[s]=[],u[s]=[],l[s][s-1]=f[s-1],l[s][s]=2*(f[s-1]+f[s]),l[s][s+1]=f[s],u[s][0]=c[s];for(i=t.multiply(t.inv(l),u),o=0;o<a-1;o++)h[o]=(n[o+1]-n[o])/f[o]-f[o]*(i[o+1][0]+2*i[o][0])/3,d[o]=(i[o+1][0]-i[o][0])/(3*f[o]);for(o=0;o<a&&!(e[o]>r);o++);return n[o-=1]+(r-e[o])*h[o]+t.sq(r-e[o])*i[o]+(r-e[o])*t.sq(r-e[o])*d[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(e){var n,r,o,i,a,s=e.length,l=e[0].length,u=0,c=[],f=[],h=[],d=[],p=[],g=[],v=[];for(u=0;u<s;u++)c[u]=t.sum(e[u])/l;for(u=0;u<l;u++)for(p[u]=[],n=0;n<s;n++)p[u][n]=e[n][u]-c[n];for(p=t.transpose(p),u=0;u<s;u++)for(g[u]=[],n=0;n<s;n++)g[u][n]=t.dot([p[u]],[p[n]])/(l-1);for(a=(o=t.jacobi(g))[0],f=o[1],v=t.transpose(a),u=0;u<f.length;u++)for(n=u;n<f.length;n++)f[u]<f[n]&&(r=f[u],f[u]=f[n],f[n]=r,h=v[u],v[u]=v[n],v[n]=h);for(i=t.transpose(p),u=0;u<s;u++)for(d[u]=[],n=0;n<i.length;n++)d[u][n]=t.dot([v[u]],[i[n]]);return[e,f,v,d]}}),function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(n,r){var o=this;return r?(setTimeout(function(){r.call(o,t.fn[e].call(o,n))},15),this):"number"==typeof t[e](this,n)?t[e](this,n):t(t[e](this,n))}}(e[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(o,Math),function(t,e){var n=[].slice,r=t.utils.isNumber,o=t.utils.isArray;function i(t,n,r,o){if(t>1||r>1||t<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(t*n+r*o)/(n+o);return(t-r)/e.sqrt(i*(1-i)*(1/n+1/o))}t.extend({zscore:function(){var e=n.call(arguments);return r(e[1])?(e[0]-e[1])/e[2]:(e[0]-t.mean(e[1]))/t.stdev(e[1],e[2])},ztest:function(){var r,i=n.call(arguments);return o(i[1])?(r=t.zscore(i[0],i[1],i[3]),1===i[2]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1)):i.length>2?(r=t.zscore(i[0],i[1],i[2]),1===i[3]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1)):(r=i[0],1===i[1]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1))}}),t.extend(t.fn,{zscore:function(t,e){return(t-this.mean())/this.stdev(e)},ztest:function(n,r,o){var i=e.abs(this.zscore(n,o));return 1===r?t.normal.cdf(-i,0,1):2*t.normal.cdf(-i,0,1)}}),t.extend({tscore:function(){var r=n.call(arguments);return 4===r.length?(r[0]-r[1])/(r[2]/e.sqrt(r[3])):(r[0]-t.mean(r[1]))/(t.stdev(r[1],!0)/e.sqrt(r[1].length))},ttest:function(){var o,i=n.call(arguments);return 5===i.length?(o=e.abs(t.tscore(i[0],i[1],i[2],i[3])),1===i[4]?t.studentt.cdf(-o,i[3]-1):2*t.studentt.cdf(-o,i[3]-1)):r(i[1])?(o=e.abs(i[0]),1==i[2]?t.studentt.cdf(-o,i[1]-1):2*t.studentt.cdf(-o,i[1]-1)):(o=e.abs(t.tscore(i[0],i[1])),1==i[2]?t.studentt.cdf(-o,i[1].length-1):2*t.studentt.cdf(-o,i[1].length-1))}}),t.extend(t.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-t.studentt.cdf(e.abs(this.tscore(n)),this.cols()-1):2*t.studentt.cdf(-e.abs(this.tscore(n)),this.cols()-1)}}),t.extend({anovafscore:function(){var r,o,i,a,s,l,u,c=n.call(arguments);if(1===c.length){s=new Array(c[0].length);for(var f=0;f<c[0].length;f++)s[f]=c[0][f];c=s}if(2===c.length)return t.variance(c[0])/t.variance(c[1]);for(o=new Array,f=0;f<c.length;f++)o=o.concat(c[f]);for(i=t.mean(o),r=0,f=0;f<c.length;f++)r+=c[f].length*e.pow(t.mean(c[f])-i,2);for(r/=c.length-1,l=0,f=0;f<c.length;f++)for(a=t.mean(c[f]),u=0;u<c[f].length;u++)l+=e.pow(c[f][u]-a,2);return r/(l/=o.length-c.length)},anovaftest:function(){var e,o,i,a=n.call(arguments);if(r(a[0]))return 1-t.centralF.cdf(a[0],a[1],a[2]);anovafscore=t.anovafscore(a),e=a.length-1,i=0;for(var s=0;s<a.length;s++)i+=a[s].length;return o=i-e-1,1-t.centralF.cdf(anovafscore,e,o)},ftest:function(e,n,r){return 1-t.centralF.cdf(e,n,r)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){for(var e=0,n=0;n<this.length;n++)e+=this[n].length;return t.ftest(this.anovafscore(),this.length-1,e-this.length)}}),t.extend({qscore:function(){var o,i,a,s,l,u=n.call(arguments);return r(u[0])?(o=u[0],i=u[1],a=u[2],s=u[3],l=u[4]):(o=t.mean(u[0]),i=t.mean(u[1]),a=u[0].length,s=u[1].length,l=u[2]),e.abs(o-i)/(l*e.sqrt((1/a+1/s)/2))},qtest:function(){var e,r=n.call(arguments);3===r.length?(e=r[0],r=r.slice(1)):7===r.length?(e=t.qscore(r[0],r[1],r[2],r[3],r[4]),r=r.slice(5)):(e=t.qscore(r[0],r[1],r[2]),r=r.slice(3));var o=r[0],i=r[1];return 1-t.tukey.cdf(e,i,o-i)},tukeyhsd:function(e){for(var n=t.pooledstdev(e),r=e.map(function(e){return t.mean(e)}),o=e.reduce(function(t,e){return t+e.length},0),i=[],a=0;a<e.length;++a)for(var s=a+1;s<e.length;++s){var l=t.qtest(r[a],r[s],e[a].length,e[s].length,n,o,e.length);i.push([[a,s],l])}return i}}),t.extend({normalci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?e.abs(t.normal.inv(o[1]/2,0,1)*o[2]/e.sqrt(o[3])):e.abs(t.normal.inv(o[1]/2,0,1)*t.stdev(o[2])/e.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},tci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?e.abs(t.studentt.inv(o[1]/2,o[3]-1)*o[2]/e.sqrt(o[3])):e.abs(t.studentt.inv(o[1]/2,o[2].length-1)*t.stdev(o[2],!0)/e.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},significant:function(t,e){return t<e}}),t.extend(t.fn,{normalci:function(e,n){return t.normalci(e,n,this.toArray())},tci:function(e,n){return t.tci(e,n,this.toArray())}}),t.extend(t.fn,{oneSidedDifferenceOfProportions:function(e,n,r,o){var a=i(e,n,r,o);return t.ztest(a,1)},twoSidedDifferenceOfProportions:function(e,n,r,o){var a=i(e,n,r,o);return t.ztest(a,2)}})}(o,Math),o.models=function(){function t(t,e){var n=t.length,r=e[0].length-1,i=n-r-1,a=o.lstsq(e,t),s=o.multiply(e,a.map(function(t){return[t]})).map(function(t){return t[0]}),l=o.subtract(t,s),u=o.mean(t),c=o.sum(s.map(function(t){return Math.pow(t-u,2)})),f=o.sum(t.map(function(t,e){return Math.pow(t-s[e],2)})),h=c+f;return{exog:e,endog:t,nobs:n,df_model:r,df_resid:i,coef:a,predict:s,resid:l,ybar:u,SST:h,SSE:c,SSR:f,R2:c/h}}function e(e){var n,r,i=(n=e.exog,r=n[0].length,o.arange(r).map(function(e){var i=o.arange(r).filter(function(t){return t!==e});return t(o.col(n,e).map(function(t){return t[0]}),o.col(n,i))})),a=Math.sqrt(e.SSR/e.df_resid),s=i.map(function(t){var e=t.SST,n=t.R2;return a/Math.sqrt(e*(1-n))}),l=e.coef.map(function(t,e){return(t-0)/s[e]}),u=l.map(function(t){var n=o.studentt.cdf(t,e.df_resid);return 2*(n>.5?1-n:n)}),c=o.studentt.inv(.975,e.df_resid),f=e.coef.map(function(t,e){var n=c*s[e];return[t-n,t+n]});return{se:s,t:l,p:u,sigmaHat:a,interval95:f}}return{ols:function(n,r){var i=t(n,r),a=e(i),s=function(t){var e,n,r,i=t.R2/t.df_model/((1-t.R2)/t.df_resid);return{F_statistic:i,pvalue:1-(e=i,n=t.df_model,r=t.df_resid,o.beta.cdf(e/(r/n+e),n/2,r/2))}}(i),l=1-(1-i.R2)*((i.nobs-1)/i.df_resid);return i.t=a,i.f=s,i.adjust_R2=l,i}}}(),o)},function(t,e,n){var r=n(1),o=n(0);e.UNIQUE=function(){for(var t=[],e=0;e<arguments.length;++e){for(var n=!1,r=arguments[e],o=0;o<t.length&&!(n=t[o]===r);++o);n||t.push(r)}return t},e.FLATTEN=r.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(t,e){if(!arguments.length)return o.error;try{for(var n=e.split("."),r=t,i=0;i<n.length;++i){var a=n[i];if("]"===a[a.length-1]){var s=a.indexOf("["),l=a.substring(s+1,a.length-1);r=r[a.substring(0,s)][l]}else r=r[a]}return r}catch(t){}},e.JOIN=function(t,e){return t.join(e)},e.NUMBERS=function(){return r.flatten(arguments).filter(function(t){return"number"==typeof t})}},function(t,e,n){var r=n(0),o=n(10),i=n(6),a=n(1),s=n(26);function l(t){return/^[01]{1,10}$/.test(t)}e.BESSELI=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:s.besseli(t,e)},e.BESSELJ=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:s.besselj(t,e)},e.BESSELK=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:s.besselk(t,e)},e.BESSELY=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:s.bessely(t,e)},e.BIN2DEC=function(t){if(!l(t))return r.num;var e=parseInt(t,2),n=t.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:e},e.BIN2HEX=function(t,e){if(!l(t))return r.num;var n=t.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var o=parseInt(t,2).toString(16);return void 0===e?o:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:r.num},e.BIN2OCT=function(t,e){if(!l(t))return r.num;var n=t.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var o=parseInt(t,2).toString(8);return void 0===e?o:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:r.num},e.BITAND=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t<0||e<0?r.num:Math.floor(t)!==t||Math.floor(e)!==e?r.num:t>0xffffffffffff||e>0xffffffffffff?r.num:t&e},e.BITLSHIFT=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t<0?r.num:Math.floor(t)!==t?r.num:t>0xffffffffffff?r.num:Math.abs(e)>53?r.num:e>=0?t<<e:t>>-e},e.BITOR=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t<0||e<0?r.num:Math.floor(t)!==t||Math.floor(e)!==e?r.num:t>0xffffffffffff||e>0xffffffffffff?r.num:t|e},e.BITRSHIFT=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t<0?r.num:Math.floor(t)!==t?r.num:t>0xffffffffffff?r.num:Math.abs(e)>53?r.num:e>=0?t>>e:t<<-e},e.BITXOR=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t<0||e<0?r.num:Math.floor(t)!==t||Math.floor(e)!==e?r.num:t>0xffffffffffff||e>0xffffffffffff?r.num:t^e},e.COMPLEX=function(t,e,n){if(t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e))return t;if("i"!==(n=void 0===n?"i":n)&&"j"!==n)return r.value;if(0===t&&0===e)return 0;if(0===t)return 1===e?n:e.toString()+n;if(0===e)return t.toString();var o=e>0?"+":"";return t.toString()+o+(1===e?n:e.toString()+n)},e.CONVERT=function(t,e,n){if((t=a.parseNumber(t))instanceof Error)return t;for(var o,i=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},u=null,c=null,f=e,h=n,d=1,p=1,g=0;g<i.length;g++)o=null===i[g][2]?[]:i[g][2],(i[g][1]===f||o.indexOf(f)>=0)&&(u=i[g]),(i[g][1]===h||o.indexOf(h)>=0)&&(c=i[g]);if(null===u){var v=s[e.substring(0,2)],y=l[e.substring(0,1)];"da"===e.substring(0,2)&&(y=["dekao",10,"da"]),v?(d=v[2],f=e.substring(2)):y&&(d=y[1],f=e.substring(y[2].length));for(var m=0;m<i.length;m++)o=null===i[m][2]?[]:i[m][2],(i[m][1]===f||o.indexOf(f)>=0)&&(u=i[m])}if(null===c){var b=s[n.substring(0,2)],w=l[n.substring(0,1)];"da"===n.substring(0,2)&&(w=["dekao",10,"da"]),b?(p=b[2],h=n.substring(2)):w&&(p=w[1],h=n.substring(w[2].length));for(var C=0;C<i.length;C++)o=null===i[C][2]?[]:i[C][2],(i[C][1]===h||o.indexOf(h)>=0)&&(c=i[C])}return null===u||null===c?r.na:u[3]!==c[3]?r.na:t*u[6]*d/(c[6]*p)},e.DEC2BIN=function(t,e){if((t=a.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return r.num;if(t<0)return"1"+i.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var n=parseInt(t,10).toString(2);return void 0===e?n:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=n.length?i.REPT("0",e-n.length)+n:r.num},e.DEC2HEX=function(t,e){if((t=a.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return r.num;if(t<0)return(1099511627776+t).toString(16);var n=parseInt(t,10).toString(16);return void 0===e?n:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=n.length?i.REPT("0",e-n.length)+n:r.num},e.DEC2OCT=function(t,e){if((t=a.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return r.num;if(t<0)return(1073741824+t).toString(8);var n=parseInt(t,10).toString(8);return void 0===e?n:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=n.length?i.REPT("0",e-n.length)+n:r.num},e.DELTA=function(t,e){return e=void 0===e?0:e,t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t===e?1:0},e.ERF=function(t,e){return e=void 0===e?0:e,t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:o.erf(t)},e.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},e.ERFC=function(t){return isNaN(t)?r.value:o.erfc(t)},e.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},e.GESTEP=function(t,e){return e=e||0,t=a.parseNumber(t),a.anyIsError(e,t)?t:t>=e?1:0},e.HEX2BIN=function(t,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return r.num;var n=10===t.length&&"f"===t.substring(0,1).toLowerCase(),o=n?parseInt(t,16)-1099511627776:parseInt(t,16);if(o<-512||o>511)return r.num;if(n)return"1"+i.REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var a=o.toString(2);return void 0===e?a:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=a.length?i.REPT("0",e-a.length)+a:r.num},e.HEX2DEC=function(t){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return r.num;var e=parseInt(t,16);return e>=549755813888?e-1099511627776:e},e.HEX2OCT=function(t,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return r.num;var n=parseInt(t,16);if(n>536870911&&n<0xffe0000000)return r.num;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var o=n.toString(8);return void 0===e?o:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:r.num},e.IMABS=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:Math.sqrt(Math.pow(n,2)+Math.pow(o,2))},e.IMAGINARY=function(t){if(void 0===t||!0===t||!1===t)return r.value;if(0===t||"0"===t)return 0;if(["i","j"].indexOf(t)>=0)return 1;var e=(t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=t.indexOf("-");0===e&&(e=t.indexOf("+",1)),0===n&&(n=t.indexOf("-",1));var o=t.substring(t.length-1,t.length),i="i"===o||"j"===o;return e>=0||n>=0?i?e>=0?isNaN(t.substring(0,e))||isNaN(t.substring(e+1,t.length-1))?r.num:Number(t.substring(e+1,t.length-1)):isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?r.num:-Number(t.substring(n+1,t.length-1)):r.num:i?isNaN(t.substring(0,t.length-1))?r.num:t.substring(0,t.length-1):isNaN(t)?r.num:0},e.IMARGUMENT=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:0===n&&0===o?r.div0:0===n&&o>0?Math.PI/2:0===n&&o<0?-Math.PI/2:0===o&&n>0?0:0===o&&n<0?-Math.PI:n>0?Math.atan(o/n):n<0&&o>=0?Math.atan(o/n)+Math.PI:Math.atan(o/n)-Math.PI},e.IMCONJUGATE=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",0!==o?e.COMPLEX(n,-o,i):t},e.IMCOS=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(n)*(Math.exp(o)+Math.exp(-o))/2,-Math.sin(n)*(Math.exp(o)-Math.exp(-o))/2,i)},e.IMCOSH=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(o)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(o)*(Math.exp(n)-Math.exp(-n))/2,i)},e.IMCOT=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:e.IMDIV(e.IMCOS(t),e.IMSIN(t))},e.IMDIV=function(t,n){var o=e.IMREAL(t),i=e.IMAGINARY(t),s=e.IMREAL(n),l=e.IMAGINARY(n);if(a.anyIsError(o,i,s,l))return r.value;var u=t.substring(t.length-1),c=n.substring(n.length-1),f="i";if("j"===u?f="j":"j"===c&&(f="j"),0===s&&0===l)return r.num;var h=s*s+l*l;return e.COMPLEX((o*s+i*l)/h,(i*s-o*l)/h,f)},e.IMEXP=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);i="i"===i||"j"===i?i:"i";var s=Math.exp(n);return e.COMPLEX(s*Math.cos(o),s*Math.sin(o),i)},e.IMLN=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+o*o)),Math.atan(o/n),i)},e.IMLOG10=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+o*o))/Math.log(10),Math.atan(o/n)/Math.log(10),i)},e.IMLOG2=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+o*o))/Math.log(2),Math.atan(o/n)/Math.log(2),i)},e.IMPOWER=function(t,n){n=a.parseNumber(n);var o=e.IMREAL(t),i=e.IMAGINARY(t);if(a.anyIsError(n,o,i))return r.value;var s=t.substring(t.length-1);s="i"===s||"j"===s?s:"i";var l=Math.pow(e.IMABS(t),n),u=e.IMARGUMENT(t);return e.COMPLEX(l*Math.cos(n*u),l*Math.sin(n*u),s)},e.IMPRODUCT=function(){var t=arguments[0];if(!arguments.length)return r.value;for(var n=1;n<arguments.length;n++){var o=e.IMREAL(t),i=e.IMAGINARY(t),s=e.IMREAL(arguments[n]),l=e.IMAGINARY(arguments[n]);if(a.anyIsError(o,i,s,l))return r.value;t=e.COMPLEX(o*s-i*l,o*l+i*s)}return t},e.IMREAL=function(t){if(void 0===t||!0===t||!1===t)return r.value;if(0===t||"0"===t)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;var e=t.indexOf("+"),n=t.indexOf("-");0===e&&(e=t.indexOf("+",1)),0===n&&(n=t.indexOf("-",1));var o=t.substring(t.length-1,t.length),i="i"===o||"j"===o;return e>=0||n>=0?i?e>=0?isNaN(t.substring(0,e))||isNaN(t.substring(e+1,t.length-1))?r.num:Number(t.substring(0,e)):isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?r.num:Number(t.substring(0,n)):r.num:i?isNaN(t.substring(0,t.length-1))?r.num:0:isNaN(t)?r.num:t},e.IMSEC=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:e.IMDIV("1",e.IMCOS(t))},e.IMSECH=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:e.IMDIV("1",e.IMCOSH(t))},e.IMSIN=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.sin(n)*(Math.exp(o)+Math.exp(-o))/2,Math.cos(n)*(Math.exp(o)-Math.exp(-o))/2,i)},e.IMSINH=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(o)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(o)*(Math.exp(n)+Math.exp(-n))/2,i)},e.IMSQRT=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);i="i"===i||"j"===i?i:"i";var s=Math.sqrt(e.IMABS(t)),l=e.IMARGUMENT(t);return e.COMPLEX(s*Math.cos(l/2),s*Math.sin(l/2),i)},e.IMCSC=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.num:e.IMDIV("1",e.IMSIN(t))},e.IMCSCH=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.num:e.IMDIV("1",e.IMSINH(t))},e.IMSUB=function(t,e){var n=this.IMREAL(t),o=this.IMAGINARY(t),i=this.IMREAL(e),s=this.IMAGINARY(e);if(a.anyIsError(n,o,i,s))return r.value;var l=t.substring(t.length-1),u=e.substring(e.length-1),c="i";return"j"===l?c="j":"j"===u&&(c="j"),this.COMPLEX(n-i,o-s,c)},e.IMSUM=function(){if(!arguments.length)return r.value;for(var t=a.flatten(arguments),e=t[0],n=1;n<t.length;n++){var o=this.IMREAL(e),i=this.IMAGINARY(e),s=this.IMREAL(t[n]),l=this.IMAGINARY(t[n]);if(a.anyIsError(o,i,s,l))return r.value;e=this.COMPLEX(o+s,i+l)}return e},e.IMTAN=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:this.IMDIV(this.IMSIN(t),this.IMCOS(t))},e.OCT2BIN=function(t,e){if(!/^[0-7]{1,10}$/.test(t))return r.num;var n=10===t.length&&"7"===t.substring(0,1),o=n?parseInt(t,8)-1073741824:parseInt(t,8);if(o<-512||o>511)return r.num;if(n)return"1"+i.REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var a=o.toString(2);return void 0===e?a:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=a.length?i.REPT("0",e-a.length)+a:r.num},e.OCT2DEC=function(t){if(!/^[0-7]{1,10}$/.test(t))return r.num;var e=parseInt(t,8);return e>=536870912?e-1073741824:e},e.OCT2HEX=function(t,e){if(!/^[0-7]{1,10}$/.test(t))return r.num;var n=parseInt(t,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);var o=n.toString(16);return void 0===e?o:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:r.num}},function(t,e,n){"use strict";e.__esModule=!0;e.default=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"]},function(t,e,n){"use strict";function r(t){var e=parseInt(t,10);return e=isNaN(e)?-1:Math.max(e-1,-1)}function o(t){var e="";return t>=0&&(e=""+(t+1)),e}e.__esModule=!0,e.rowLabelToIndex=r,e.rowIndexToLabel=o,e.columnLabelToIndex=s,e.columnIndexToLabel=l,e.extractLabel=function(t){if("string"!=typeof t||!u.test(t))return[];var e=t.toUpperCase().match(u),n=e[1],o=e[2],i=e[3],a=e[4];return[{index:r(a),label:a,isAbsolute:"$"===i},{index:s(o),label:o,isAbsolute:"$"===n}]},e.toLabel=function(t,e){var n=(t.isAbsolute?"$":"")+o(t.index);return(e.isAbsolute?"$":"")+l(e.index)+n};var i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=i.length;function s(t){var e=0;if("string"==typeof t)for(var n=0,r=(t=t.toUpperCase()).length-1;n<t.length;n+=1,r-=1)e+=Math.pow(a,r)*(i.indexOf(t[n])+1);return--e}function l(t){for(var e="";t>=0;)e=String.fromCharCode(t%a+97)+e,t=Math.floor(t/a)-1;return e.toUpperCase()}var u=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/},function(t,e,n){"use strict";e.__esModule=!0,e.rowLabelToIndex=e.rowIndexToLabel=e.columnLabelToIndex=e.columnIndexToLabel=e.toLabel=e.extractLabel=e.error=e.Parser=e.ERROR_VALUE=e.ERROR_REF=e.ERROR_NUM=e.ERROR_NULL=e.ERROR_NOT_AVAILABLE=e.ERROR_NAME=e.ERROR_DIV_ZERO=e.ERROR=e.SUPPORTED_FORMULAS=void 0;var r=l(n(16)),o=l(n(13)),i=n(2),a=l(i),s=n(14);function l(t){return t&&t.__esModule?t:{default:t}}e.SUPPORTED_FORMULAS=o.default,e.ERROR=i.ERROR,e.ERROR_DIV_ZERO=i.ERROR_DIV_ZERO,e.ERROR_NAME=i.ERROR_NAME,e.ERROR_NOT_AVAILABLE=i.ERROR_NOT_AVAILABLE,e.ERROR_NULL=i.ERROR_NULL,e.ERROR_NUM=i.ERROR_NUM,e.ERROR_REF=i.ERROR_REF,e.ERROR_VALUE=i.ERROR_VALUE,e.Parser=r.default,e.error=a.default,e.extractLabel=s.extractLabel,e.toLabel=s.toLabel,e.columnIndexToLabel=s.columnIndexToLabel,e.columnLabelToIndex=s.columnLabelToIndex,e.rowIndexToLabel=s.rowIndexToLabel,e.rowLabelToIndex=s.rowLabelToIndex},function(t,e,n){"use strict";e.__esModule=!0;var r=f(n(17)),o=f(n(18)),i=n(39),a=n(40),s=n(3),l=n(2),u=f(l),c=n(14);function f(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n.parser=new i.Parser,n.parser.yy={toNumber:s.toNumber,trimEdges:a.trimEdges,invertNumber:s.invertNumber,throwError:function(t){return n._throwError(t)},callVariable:function(t){return n._callVariable(t)},evaluateByOperator:o.default,callFunction:function(t,e){return n._callFunction(t,e)},cellValue:function(t){return n._callCellValue(t)},rangeValue:function(t,e){return n._callRangeValue(t,e)}},n.variables=Object.create(null),n.functions=Object.create(null),n.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.parse=function(t){var e=null,n=null;try{e=""===t?"":this.parser.parse(t)}catch(t){var r=(0,u.default)(t.message);n=r||(0,u.default)(l.ERROR)}return e instanceof Error&&(n=(0,u.default)(e.message)||(0,u.default)(l.ERROR),e=null),{error:n,result:e}},e.prototype.setVariable=function(t,e){return this.variables[t]=e,this},e.prototype.getVariable=function(t){return this.variables[t]},e.prototype._callVariable=function(t){var e=this.getVariable(t);if(this.emit("callVariable",t,function(t){void 0!==t&&(e=t)}),void 0===e)throw Error(l.ERROR_NAME);return e},e.prototype.setFunction=function(t,e){return this.functions[t]=e,this},e.prototype.getFunction=function(t){return this.functions[t]},e.prototype._callFunction=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.getFunction(t),r=void 0;return n&&(r=n(e)),this.emit("callFunction",t,e,function(t){void 0!==t&&(r=t)}),void 0===r?(0,o.default)(t,e):r},e.prototype._callCellValue=function(t){t=t.toUpperCase();var e=(0,c.extractLabel)(t),n=e[0],r=e[1],o=void 0;return this.emit("callCellValue",{label:t,row:n,column:r},function(t){o=t}),o},e.prototype._callRangeValue=function(t,e){t=t.toUpperCase(),e=e.toUpperCase();var n=(0,c.extractLabel)(t),r=n[0],o=n[1],i=(0,c.extractLabel)(e),a=i[0],s=i[1],l={},u={};r.index<=a.index?(l.row=r,u.row=a):(l.row=a,u.row=r),o.index<=s.index?(l.column=o,u.column=s):(l.column=s,u.column=o),l.label=(0,c.toLabel)(l.row,l.column),u.label=(0,c.toLabel)(u.row,u.column);var f=[];return this.emit("callRangeValue",l,u,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];f=t}),f},e.prototype._throwError=function(t){if((0,l.isValidStrict)(t))throw Error(t);throw Error(l.ERROR)},e}(r.default);e.default=h},function(t,e){function n(){}n.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var r=this;function o(){r.off(t,o),e.apply(n,arguments)}return o._=e,this.on(t,o,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],o=[];if(r&&e)for(var i=0,a=r.length;i<a;i++)r[i].fn!==e&&r[i].fn._!==e&&o.push(r[i]);return o.length?n[t]=o:delete n[t],this}},t.exports=n},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t=t.toUpperCase(),!m[t])throw Error(v.ERROR_NAME);return m[t].apply(m,e)},e.registerOperation=b;var r=y(n(19)),o=y(n(20)),i=y(n(21)),a=y(n(22)),s=y(n(23)),l=y(n(31)),u=y(n(32)),c=y(n(33)),f=y(n(34)),h=y(n(35)),d=y(n(36)),p=y(n(37)),g=y(n(38)),v=n(2);function y(t){return t&&t.__esModule?t:{default:t}}var m=Object.create(null);function b(t,e){Array.isArray(t)||(t=[t.toUpperCase()]),t.forEach(function(t){e.isFactory?m[t]=e(t):m[t]=e})}b(r.default.SYMBOL,r.default),b(o.default.SYMBOL,o.default),b(i.default.SYMBOL,i.default),b(a.default.SYMBOL,a.default),b(g.default.SYMBOL,g.default),b(s.default.SYMBOL,s.default),b(l.default.SYMBOL,l.default),b(u.default.SYMBOL,u.default),b(c.default.SYMBOL,c.default),b(f.default.SYMBOL,f.default),b(d.default.SYMBOL,d.default),b(p.default.SYMBOL,p.default),b(h.default.SYMBOL,h.default)},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=a;var r=n(3),o=n(2),i=e.SYMBOL="+";function a(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var a=n.reduce(function(t,e){return t+(0,r.toNumber)(e)},(0,r.toNumber)(t));if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL="&";function o(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e){return t+e.toString()},"")}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=a;var r=n(3),o=n(2),i=e.SYMBOL="/";function a(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var a=n.reduce(function(t,e){return t/(0,r.toNumber)(e)},(0,r.toNumber)(t));if(a===1/0)throw Error(o.ERROR_DIV_ZERO);if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL="=";function o(t,e){return t===e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=u;var r,o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(24)),i=n(13),a=(r=i)&&r.__esModule?r:{default:r},s=n(2);var l=e.SYMBOL=a.default;function u(t){return function(){var e=(t=t.toUpperCase()).split("."),n=!1,r=void 0;if(1===e.length)o[e[0]]&&(n=!0,r=o[e[0]].apply(o,arguments));else{for(var i=e.length,a=0,l=o;a<i;)if(l=l[e[a]],a++,!l){l=null;break}l&&(n=!0,r=l.apply(void 0,arguments))}if(!n)throw Error(s.ERROR_NAME);return r}}u.isFactory=!0,u.SYMBOL=l},function(t,e,n){var r=[n(25),n(27),n(12),n(28),n(4),n(6),n(9),n(29),n(8),n(30),n(5),n(11)];for(var o in r){var i=r[o];for(var a in i)e[a]=e[a]||i[a]}},function(t,e,n){var r=n(4),o=n(5),i=n(12),a=n(9);function s(t,e){if(e)for(var n in e)t[n]=e[n];return t}e.BETADIST=o.BETA.DIST,e.BETAINV=o.BETA.INV,e.BINOMDIST=o.BINOM.DIST,e.CEILING=e.ISOCEILING=s(r.CEILING.MATH,r.CEILING),e.CEILINGMATH=r.CEILING.MATH,e.CEILINGPRECISE=r.CEILING.PRECISE,e.CHIDIST=o.CHISQ.DIST,e.CHIDISTRT=o.CHISQ.DIST.RT,e.CHIINV=o.CHISQ.INV,e.CHIINVRT=o.CHISQ.INV.RT,e.CHITEST=o.CHISQ.TEST,e.CONFIDENCE=s(o.CONFIDENCE.NORM,o.CONFIDENCE),e.COVAR=o.COVARIANCE.P,e.COVARIANCEP=o.COVARIANCE.P,e.COVARIANCES=o.COVARIANCE.S,e.CRITBINOM=o.BINOM.INV,e.EXPONDIST=o.EXPON.DIST,e.ERFCPRECISE=i.ERFC.PRECISE,e.ERFPRECISE=i.ERF.PRECISE,e.FDIST=o.F.DIST,e.FDISTRT=o.F.DIST.RT,e.FINVRT=o.F.INV.RT,e.FINV=o.F.INV,e.FLOOR=s(r.FLOOR.MATH,r.FLOOR),e.FLOORMATH=r.FLOOR.MATH,e.FLOORPRECISE=r.FLOOR.PRECISE,e.FTEST=o.F.TEST,e.GAMMADIST=o.GAMMA.DIST,e.GAMMAINV=o.GAMMA.INV,e.GAMMALNPRECISE=o.GAMMALN.PRECISE,e.HYPGEOMDIST=o.HYPGEOM.DIST,e.LOGINV=o.LOGNORM.INV,e.LOGNORMINV=o.LOGNORM.INV,e.LOGNORMDIST=o.LOGNORM.DIST,e.MODE=s(o.MODE.SNGL,o.MODE),e.MODEMULT=o.MODE.MULT,e.MODESNGL=o.MODE.SNGL,e.NEGBINOMDIST=o.NEGBINOM.DIST,e.NETWORKDAYSINTL=a.NETWORKDAYS.INTL,e.NORMDIST=o.NORM.DIST,e.NORMINV=o.NORM.INV,e.NORMSDIST=o.NORM.S.DIST,e.NORMSINV=o.NORM.S.INV,e.PERCENTILE=s(o.PERCENTILE.EXC,o.PERCENTILE),e.PERCENTILEEXC=o.PERCENTILE.EXC,e.PERCENTILEINC=o.PERCENTILE.INC,e.PERCENTRANK=s(o.PERCENTRANK.INC,o.PERCENTRANK),e.PERCENTRANKEXC=o.PERCENTRANK.EXC,e.PERCENTRANKINC=o.PERCENTRANK.INC,e.POISSON=s(o.POISSON.DIST,o.POISSON),e.POISSONDIST=o.POISSON.DIST,e.QUARTILE=s(o.QUARTILE.INC,o.QUARTILE),e.QUARTILEEXC=o.QUARTILE.EXC,e.QUARTILEINC=o.QUARTILE.INC,e.RANK=s(o.RANK.EQ,o.RANK),e.RANKAVG=o.RANK.AVG,e.RANKEQ=o.RANK.EQ,e.SKEWP=o.SKEW.P,e.STDEV=s(o.STDEV.S,o.STDEV),e.STDEVP=o.STDEV.P,e.STDEVS=o.STDEV.S,e.TDIST=o.T.DIST,e.TDISTRT=o.T.DIST.RT,e.TINV=o.T.INV,e.TTEST=o.T.TEST,e.VAR=s(o.VAR.S,o.VAR),e.VARP=o.VAR.P,e.VARS=o.VAR.S,e.WEIBULL=s(o.WEIBULL.DIST,o.WEIBULL),e.WEIBULLDIST=o.WEIBULL.DIST,e.WORKDAYINTL=a.WORKDAY.INTL,e.ZTEST=o.Z.TEST},function(t,e,n){var r=Math;function o(t,e){return t.reduce(function(t,n){return e*t+n},0)}function i(t,e,n,r,o){o||(o=-1);var i,a=2/t;if(0===e)return n;if(1===e)return r;for(var s=1;s!=e;++s)i=r*s*a+o*n,n=r,r=i;return r}function a(t,e,n,r,o){return function(a,s){if(0===s)return t(a);if(1===s)return e(a);if(s<0)throw n+": Order ("+s+") must be nonnegative";if(1==r&&0===a)throw n+": Undefined when x == 0";if(2==r&&a<=0)throw n+": Undefined when x <= 0";return i(a,s,t(a),e(a),o)}}var s=function(){var t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),e=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),s=.636619772;function l(i){var l,u,c,f=i*i,h=r.abs(i)-.785398164;return r.abs(i)<8?l=(u=o(t,f))/(c=o(e,f)):(u=o(n,f=64/f),c=o(a,f),l=r.sqrt(s/r.abs(i))*(r.cos(h)*u-r.sin(h)*c*8/r.abs(i))),l}var u=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),c=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function d(t){var e,n,i,a=t*t,l=r.abs(t)-2.356194491;return Math.abs(t)<8?e=(n=t*o(u,a))/(i=o(c,a)):(n=o(f,a=64/a),i=o(h,a),e=r.sqrt(s/r.abs(t))*(r.cos(l)*n-r.sin(l)*i*8/r.abs(t)),t<0&&(e=-e)),e}return function(t,e){if(0===(e=Math.round(e)))return l(r.abs(t));if(1===e)return d(r.abs(t));if(e<0)throw"BESSELJ: Order ("+e+") must be nonnegative";if(0===r.abs(t))return 0;var n,o,a,s,u,c,f,h=2/r.abs(t);if(r.abs(t)>e)n=i(t,e,l(r.abs(t)),d(r.abs(t)),-1);else{for(a=0,u=n=s=0,c=1,o=2*r.floor((e+r.floor(r.sqrt(40*e)))/2);o>0;o--)f=o*h*c-u,u=c,c=f,r.abs(c)>1e10&&(c*=1e-10,u*=1e-10,n*=1e-10,s*=1e-10),a&&(s+=c),a=!a,o==e&&(n=u);n/=s=2*s-c}return t<0&&e%2?-n:n}}(),l=function(){var t=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),e=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),i=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),l=.636619772;var u=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),c=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return a(function(a){var u,c,f,h=a*a,d=a-.785398164;return a<8?u=(c=o(t,h))/(f=o(e,h))+l*s(a,0)*r.log(a):(c=o(n,h=64/h),f=o(i,h),u=r.sqrt(l/a)*(r.sin(d)*c+r.cos(d)*f*8/a)),u},function(t){var e,n,i,a=t*t,d=t-2.356194491;return t<8?e=(n=t*o(u,a))/(i=o(c,a))+l*(s(t,1)*r.log(t)-1/t):(n=o(f,a=64/a),i=o(h,a),e=r.sqrt(l/t)*(r.sin(d)*n+r.cos(d)*i*8/t)),e},"BESSELY",1,-1)}(),u=function(){var t=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();var n=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),i=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function a(s,l){if(0===(l=Math.round(l)))return function(n){return n<=3.75?o(t,n*n/14.0625):r.exp(r.abs(n))/r.sqrt(r.abs(n))*o(e,3.75/r.abs(n))}(s);if(1==l)return function(t){return t<3.75?t*o(n,t*t/14.0625):(t<0?-1:1)*r.exp(r.abs(t))/r.sqrt(r.abs(t))*o(i,3.75/r.abs(t))}(s);if(l<0)throw"BESSELI Order ("+l+") must be nonnegative";if(0===r.abs(s))return 0;var u,c,f,h,d,p=2/r.abs(s);for(f=u=0,h=1,c=2*r.round((l+r.round(r.sqrt(40*l)))/2);c>0;c--)d=c*p*h+f,f=h,h=d,r.abs(h)>1e10&&(h*=1e-10,f*=1e-10,u*=1e-10),c==l&&(u=f);return u*=a(s,0)/h,s<0&&l%2?-u:u}}(),c=function(){var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),i=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return a(function(n){return n<=2?-r.log(n/2)*u(n,0)+o(t,n*n/4):r.exp(-n)/r.sqrt(n)*o(e,2/n)},function(t){return t<=2?r.log(t/2)*u(t,1)+1/t*o(n,t*t/4):r.exp(-t)/r.sqrt(t)*o(i,2/t)},"BESSELK",2,1)}();e.besselj=s,e.bessely=l,e.besseli=u,e.besselk=c},function(t,e,n){var r=n(0),o=n(5),i=n(4),a=n(1),s=n(7);function l(t){var e=[];return a.arrayEach(t,function(t){t&&e.push(t)}),e}function u(t,e){for(var n={},r=1;r<t[0].length;++r)n[r]=!0;var o=e[0].length;for(r=1;r<e.length;++r)e[r].length>o&&(o=e[r].length);for(var i=1;i<t.length;++i)for(var a=1;a<t[i].length;++a){for(var l=!1,u=!1,c=0;c<e.length;++c){var f=e[c];if(!(f.length<o)){var h=f[0];if(t[i][0]===h){u=!0;for(var d=1;d<f.length;++d){if(!l)if(void 0===f[d]||"*"===f[d])l=!0;else{var p=s.parse(f[d]+""),g=[s.createToken(t[i][a],s.TOKEN_TYPE_LITERAL)].concat(p);l=s.compute(g)}}}}}u&&(n[a]=n[a]&&l)}for(var v=[],y=0;y<t[0].length;++y)n[y]&&v.push(y-1);return v}e.FINDFIELD=function(t,e){var n=null;return a.arrayEach(t,function(t,r){if(t[0]===e)return n=r,!1}),null==n?r.value:n},e.DAVERAGE=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var i=u(t,o),s=[];if("string"==typeof n){var l=e.FINDFIELD(t,n);s=a.rest(t[l])}else s=a.rest(t[n]);var c=0;return a.arrayEach(i,function(t){c+=s[t]}),0===i.length?r.div0:c/i.length},e.DCOUNT=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),l=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);l=a.rest(t[c])}else l=a.rest(t[n]);var f=[];return a.arrayEach(s,function(t){f.push(l[t])}),o.COUNT(f)},e.DCOUNTA=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),l=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);l=a.rest(t[c])}else l=a.rest(t[n]);var f=[];return a.arrayEach(s,function(t){f.push(l[t])}),o.COUNTA(f)},e.DGET=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var i=u(t,o),s=[];if("string"==typeof n){var l=e.FINDFIELD(t,n);s=a.rest(t[l])}else s=a.rest(t[n]);return 0===i.length?r.value:i.length>1?r.num:s[i[0]]},e.DMAX=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var i=u(t,o),s=[];if("string"==typeof n){var l=e.FINDFIELD(t,n);s=a.rest(t[l])}else s=a.rest(t[n]);var c=s[i[0]];return a.arrayEach(i,function(t){c<s[t]&&(c=s[t])}),c},e.DMIN=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var i=u(t,o),s=[];if("string"==typeof n){var l=e.FINDFIELD(t,n);s=a.rest(t[l])}else s=a.rest(t[n]);var c=s[i[0]];return a.arrayEach(i,function(t){c>s[t]&&(c=s[t])}),c},e.DPRODUCT=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var i=u(t,o),s=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);s=a.rest(t[c])}else s=a.rest(t[n]);var f=[];a.arrayEach(i,function(t){f.push(s[t])}),f=l(f);var h=1;return a.arrayEach(f,function(t){h*=t}),h},e.DSTDEV=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),c=[];if("string"==typeof n){var f=e.FINDFIELD(t,n);c=a.rest(t[f])}else c=a.rest(t[n]);var h=[];return a.arrayEach(s,function(t){h.push(c[t])}),h=l(h),o.STDEV.S(h)},e.DSTDEVP=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),c=[];if("string"==typeof n){var f=e.FINDFIELD(t,n);c=a.rest(t[f])}else c=a.rest(t[n]);var h=[];return a.arrayEach(s,function(t){h.push(c[t])}),h=l(h),o.STDEV.P(h)},e.DSUM=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,o),l=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);l=a.rest(t[c])}else l=a.rest(t[n]);var f=[];return a.arrayEach(s,function(t){f.push(l[t])}),i.SUM(f)},e.DVAR=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),l=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);l=a.rest(t[c])}else l=a.rest(t[n]);var f=[];return a.arrayEach(s,function(t){f.push(l[t])}),o.VAR.S(f)},e.DVARP=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),l=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);l=a.rest(t[c])}else l=a.rest(t[n]);var f=[];return a.arrayEach(s,function(t){f.push(l[t])}),o.VAR.P(f)}},function(t,e,n){var r=n(0),o=n(1),i=n(8);e.AND=function(){for(var t=o.flatten(arguments),e=!0,n=0;n<t.length;n++)t[n]||(e=!1);return e},e.CHOOSE=function(){if(arguments.length<2)return r.na;var t=arguments[0];return t<1||t>254?r.value:arguments.length<t+1?r.value:arguments[t]},e.FALSE=function(){return!1},e.IF=function(t,e,n){return t?e:n},e.IFERROR=function(t,e){return i.ISERROR(t)?e:t},e.IFNA=function(t,e){return t===r.na?e:t},e.NOT=function(t){return!t},e.OR=function(){for(var t=o.flatten(arguments),e=!1,n=0;n<t.length;n++)t[n]&&(e=!0);return e},e.TRUE=function(){return!0},e.XOR=function(){for(var t=o.flatten(arguments),e=0,n=0;n<t.length;n++)t[n]&&e++;return!!(1&Math.floor(Math.abs(e)))},e.SWITCH=function(){var t;if(arguments.length>0){var e=arguments[0],n=arguments.length-1,o=Math.floor(n/2),i=!1,a=n%2!=0,s=n%2==0?null:arguments[arguments.length-1];if(o)for(var l=0;l<o;l++)if(e===arguments[2*l+1]){t=arguments[2*l+2],i=!0;break}i||(t=a?s:r.na)}else t=r.value;return t}},function(t,e,n){var r=n(0),o=n(9),i=n(1);function a(t){return t&&t.getTime&&!isNaN(t.getTime())}function s(t){return t instanceof Date?t:new Date(t)}e.ACCRINT=function(t,e,n,i,l,u,c){return t=s(t),e=s(e),n=s(n),a(t)&&a(e)&&a(n)?i<=0||l<=0?r.num:-1===[1,2,4].indexOf(u)?r.num:-1===[0,1,2,3,4].indexOf(c)?r.num:n<=t?r.num:(c=c||0,(l=l||0)*i*o.YEARFRAC(t,n,c)):r.value},e.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},e.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},e.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},e.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},e.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},e.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},e.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},e.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},e.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},e.CUMIPMT=function(t,n,o,a,s,l){if(t=i.parseNumber(t),n=i.parseNumber(n),o=i.parseNumber(o),i.anyIsError(t,n,o))return r.value;if(t<=0||n<=0||o<=0)return r.num;if(a<1||s<1||a>s)return r.num;if(0!==l&&1!==l)return r.num;var u=e.PMT(t,n,o,0,l),c=0;1===a&&0===l&&(c=-o,a++);for(var f=a;f<=s;f++)c+=1===l?e.FV(t,f-2,u,o,1)-u:e.FV(t,f-1,u,o,0);return c*=t},e.CUMPRINC=function(t,n,o,a,s,l){if(t=i.parseNumber(t),n=i.parseNumber(n),o=i.parseNumber(o),i.anyIsError(t,n,o))return r.value;if(t<=0||n<=0||o<=0)return r.num;if(a<1||s<1||a>s)return r.num;if(0!==l&&1!==l)return r.num;var u=e.PMT(t,n,o,0,l),c=0;1===a&&(c=0===l?u+o*t:u,a++);for(var f=a;f<=s;f++)c+=l>0?u-(e.FV(t,f-2,u,o,1)-u)*t:u-e.FV(t,f-1,u,o,0)*t;return c},e.DB=function(t,e,n,o,a){if(a=void 0===a?12:a,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a))return r.value;if(t<0||e<0||n<0||o<0)return r.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(a))return r.num;if(o>n)return r.num;if(e>=t)return 0;for(var s=(1-Math.pow(e/t,1/n)).toFixed(3),l=t*s*a/12,u=l,c=0,f=o===n?n-1:o,h=2;h<=f;h++)u+=c=(t-u)*s;return 1===o?l:o===n?(t-u)*s:c},e.DDB=function(t,e,n,o,a){if(a=void 0===a?2:a,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a))return r.value;if(t<0||e<0||n<0||o<0||a<=0)return r.num;if(o>n)return r.num;if(e>=t)return 0;for(var s=0,l=0,u=1;u<=o;u++)s+=l=Math.min(a/n*(t-s),t-e-s);return l},e.DISC=function(){throw new Error("DISC is not implemented")},e.DOLLARDE=function(t,e){if(t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e))return r.value;if(e<0)return r.num;if(e>=0&&e<1)return r.div0;e=parseInt(e,10);var n=parseInt(t,10);n+=t%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;var o=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return n=Math.round(n*o)/o},e.DOLLARFR=function(t,e){if(t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e))return r.value;if(e<0)return r.num;if(e>=0&&e<1)return r.div0;e=parseInt(e,10);var n=parseInt(t,10);return n+=t%1*Math.pow(10,-Math.ceil(Math.log(e)/Math.LN10))*e},e.DURATION=function(){throw new Error("DURATION is not implemented")},e.EFFECT=function(t,e){return t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e)?r.value:t<=0||e<1?r.num:(e=parseInt(e,10),Math.pow(1+t/e,e)-1)},e.FV=function(t,e,n,o,a){if(o=o||0,a=a||0,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a))return r.value;var s;if(0===t)s=o+n*e;else{var l=Math.pow(1+t,e);s=1===a?o*l+n*(1+t)*(l-1)/t:o*l+n*(l-1)/t}return-s},e.FVSCHEDULE=function(t,e){if(t=i.parseNumber(t),e=i.parseNumberArray(i.flatten(e)),i.anyIsError(t,e))return r.value;for(var n=e.length,o=t,a=0;a<n;a++)o*=1+e[a];return o},e.INTRATE=function(){throw new Error("INTRATE is not implemented")},e.IPMT=function(t,n,o,a,s,l){if(s=s||0,l=l||0,t=i.parseNumber(t),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),s=i.parseNumber(s),l=i.parseNumber(l),i.anyIsError(t,n,o,a,s,l))return r.value;var u=e.PMT(t,o,a,s,l);return(1===n?1===l?0:-a:1===l?e.FV(t,n-2,u,a,1)-u:e.FV(t,n-1,u,a,0))*t},e.IRR=function(t,e){if(e=e||0,t=i.parseNumberArray(i.flatten(t)),e=i.parseNumber(e),i.anyIsError(t,e))return r.value;for(var n=function(t,e,n){for(var r=n+1,o=t[0],i=1;i<t.length;i++)o+=t[i]/Math.pow(r,(e[i]-e[0])/365);return o},o=function(t,e,n){for(var r=n+1,o=0,i=1;i<t.length;i++){var a=(e[i]-e[0])/365;o-=a*t[i]/Math.pow(r,a+1)}return o},a=[],s=!1,l=!1,u=0;u<t.length;u++)a[u]=0===u?0:a[u-1]+365,t[u]>0&&(s=!0),t[u]<0&&(l=!0);if(!s||!l)return r.num;var c,f,h,d=e=void 0===e?.1:e,p=!0;do{c=d-(h=n(t,a,d))/o(t,a,d),f=Math.abs(c-d),d=c,p=f>1e-10&&Math.abs(h)>1e-10}while(p);return d},e.ISPMT=function(t,e,n,o){return t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),i.anyIsError(t,e,n,o)?r.value:o*t*(e/n-1)},e.MDURATION=function(){throw new Error("MDURATION is not implemented")},e.MIRR=function(t,n,o){if(t=i.parseNumberArray(i.flatten(t)),n=i.parseNumber(n),o=i.parseNumber(o),i.anyIsError(t,n,o))return r.value;for(var a=t.length,s=[],l=[],u=0;u<a;u++)t[u]<0?s.push(t[u]):l.push(t[u]);var c=-e.NPV(o,l)*Math.pow(1+o,a-1),f=e.NPV(n,s)*(1+n);return Math.pow(c/f,1/(a-1))-1},e.NOMINAL=function(t,e){return t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e)?r.value:t<=0||e<1?r.num:(e=parseInt(e,10),(Math.pow(t+1,1/e)-1)*e)},e.NPER=function(t,e,n,o,a){if(a=void 0===a?0:a,o=void 0===o?0:o,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a))return r.value;var s=e*(1+t*a)-o*t,l=n*t+e*(1+t*a);return Math.log(s/l)/Math.log(1+t)},e.NPV=function(){var t=i.parseNumberArray(i.flatten(arguments));if(t instanceof Error)return t;for(var e=t[0],n=0,r=1;r<t.length;r++)n+=t[r]/Math.pow(1+e,r);return n},e.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},e.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},e.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},e.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},e.PDURATION=function(t,e,n){return t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:t<=0?r.num:(Math.log(n)-Math.log(e))/Math.log(1+t)},e.PMT=function(t,e,n,o,a){if(o=o||0,a=a||0,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a))return r.value;var s;if(0===t)s=(n+o)/e;else{var l=Math.pow(1+t,e);s=1===a?(o*t/(l-1)+n*t/(1-1/l))/(1+t):o*t/(l-1)+n*t/(1-1/l)}return-s},e.PPMT=function(t,n,o,a,s,l){return s=s||0,l=l||0,t=i.parseNumber(t),o=i.parseNumber(o),a=i.parseNumber(a),s=i.parseNumber(s),l=i.parseNumber(l),i.anyIsError(t,o,a,s,l)?r.value:e.PMT(t,o,a,s,l)-e.IPMT(t,n,o,a,s,l)},e.PRICE=function(){throw new Error("PRICE is not implemented")},e.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},e.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},e.PV=function(t,e,n,o,a){return o=o||0,a=a||0,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a)?r.value:0===t?-n*e-o:((1-Math.pow(1+t,e))/t*n*(1+t*a)-o)/Math.pow(1+t,e)},e.RATE=function(t,e,n,o,a,s){if(s=void 0===s?.01:s,o=void 0===o?0:o,a=void 0===a?0:a,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),s=i.parseNumber(s),i.anyIsError(t,e,n,o,a,s))return r.value;var l,u,c,f=0,h=0,d=0,p=s;for(Math.abs(p)<1e-10?n*(1+t*p)+e*(1+p*a)*t+o:n*(h=Math.exp(t*Math.log(1+p)))+e*(1/p+a)*(h-1)+o,l=n+e*t+o,u=n*h+e*(1/p+a)*(h-1)+o,d=c=0,f=p;Math.abs(l-u)>1e-10&&d<50;)p=(u*c-l*f)/(u-l),c=f,f=p,l=u,u=Math.abs(p)<1e-10?n*(1+t*p)+e*(1+p*a)*t+o:n*(h=Math.exp(t*Math.log(1+p)))+e*(1/p+a)*(h-1)+o,++d;return p},e.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},e.RRI=function(t,e,n){return t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:0===t||0===e?r.num:Math.pow(n/e,1/t)-1},e.SLN=function(t,e,n){return t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:0===n?r.num:(t-e)/n},e.SYD=function(t,e,n,o){return t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),i.anyIsError(t,e,n,o)?r.value:0===n?r.num:o<1||o>n?r.num:(t-e)*(n-(o=parseInt(o,10))+1)*2/(n*(n+1))},e.TBILLEQ=function(t,e,n){return t=i.parseDate(t),e=i.parseDate(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:n<=0?r.num:t>e?r.num:e-t>31536e6?r.num:365*n/(360-n*o.DAYS360(t,e,!1))},e.TBILLPRICE=function(t,e,n){return t=i.parseDate(t),e=i.parseDate(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:n<=0?r.num:t>e?r.num:e-t>31536e6?r.num:100*(1-n*o.DAYS360(t,e,!1)/360)},e.TBILLYIELD=function(t,e,n){return t=i.parseDate(t),e=i.parseDate(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:n<=0?r.num:t>e?r.num:e-t>31536e6?r.num:360*(100-n)/(n*o.DAYS360(t,e,!1))},e.VDB=function(){throw new Error("VDB is not implemented")},e.XNPV=function(t,e,n){if(t=i.parseNumber(t),e=i.parseNumberArray(i.flatten(e)),n=i.parseDateArray(i.flatten(n)),i.anyIsError(t,e,n))return r.value;for(var a=0,s=0;s<e.length;s++)a+=e[s]/Math.pow(1+t,o.DAYS(n[s],n[0])/365);return a},e.YIELD=function(){throw new Error("YIELD is not implemented")},e.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},e.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(t,e,n){var r=n(0),o=n(1);e.MATCH=function(t,e,n){if(!t&&!e)return r.na;if(2===arguments.length&&(n=1),!(e instanceof Array))return r.na;if(-1!==n&&0!==n&&1!==n)return r.na;for(var o,i,a=0;a<e.length;a++)if(1===n){if(e[a]===t)return a+1;e[a]<t&&(i?e[a]>i&&(o=a+1,i=e[a]):(o=a+1,i=e[a]))}else if(0===n){if("string"==typeof t){if(t=t.replace(/\?/g,"."),e[a].toLowerCase().match(t.toLowerCase()))return a+1}else if(e[a]===t)return a+1}else if(-1===n){if(e[a]===t)return a+1;e[a]>t&&(i?e[a]<i&&(o=a+1,i=e[a]):(o=a+1,i=e[a]))}return o||r.na},e.VLOOKUP=function(t,e,n,o){if(!t||!e||!n)return r.na;o=o||!1;for(var i=0;i<e.length;i++){var a=e[i];if(!o&&a[0]===t||a[0]===t||o&&"string"==typeof a[0]&&-1!==a[0].toLowerCase().indexOf(t.toLowerCase()))return n<a.length+1?a[n-1]:r.ref}return r.na},e.HLOOKUP=function(t,e,n,i){if(!t||!e||!n)return r.na;i=i||!1;for(var a=o.transpose(e),s=0;s<a.length;s++){var l=a[s];if(!i&&l[0]===t||l[0]===t||i&&"string"==typeof l[0]&&-1!==l[0].toLowerCase().indexOf(t.toLowerCase()))return n<l.length+1?l[n-1]:r.ref}return r.na}},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL=">";function o(t,e){return t>e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL=">=";function o(t,e){return t>=e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL="<";function o(t,e){return t<e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL="<=";function o(t,e){return t<=e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=a;var r=n(3),o=n(2),i=e.SYMBOL="-";function a(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var a=n.reduce(function(t,e){return t-(0,r.toNumber)(e)},(0,r.toNumber)(t));if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=a;var r=n(3),o=n(2),i=e.SYMBOL="*";function a(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var a=n.reduce(function(t,e){return t*(0,r.toNumber)(e)},(0,r.toNumber)(t));if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL="<>";function o(t,e){return t!==e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=a;var r=n(3),o=n(2),i=e.SYMBOL="^";function a(t,e){var n=Math.pow((0,r.toNumber)(t),(0,r.toNumber)(e));if(isNaN(n))throw Error(o.ERROR_VALUE);return n}a.SYMBOL=i},function(t,e,n){var r=function(){var t=function(t,e,n,r){for(n=n||{},r=t.length;r--;n[t[r]]=e);return n},e=[1,5],n=[1,8],r=[1,6],o=[1,7],i=[1,9],a=[1,14],s=[1,15],l=[1,16],u=[1,12],c=[1,13],f=[1,17],h=[1,19],d=[1,20],p=[1,21],g=[1,22],v=[1,23],y=[1,24],m=[1,25],b=[1,26],w=[1,27],C=[1,28],O=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],E=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],S=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],k=[5,10,11,13,14,15,16,17,29,30],R=[5,10,13,14,15,16,29,30],T=[5,10,11,13,14,15,16,17,18,19,29,30],M=[13,29,30],_={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function(t,e,n,r,o,i,a){var s=i.length-1;switch(o){case 1:return i[s-1];case 2:this.$=r.callVariable(i[s][0]);break;case 3:this.$=r.toNumber(i[s]);break;case 4:this.$=r.trimEdges(i[s]);break;case 5:this.$=r.evaluateByOperator("&",[i[s-2],i[s]]);break;case 6:this.$=r.evaluateByOperator("=",[i[s-2],i[s]]);break;case 7:this.$=r.evaluateByOperator("+",[i[s-2],i[s]]);break;case 8:this.$=i[s-1];break;case 9:this.$=r.evaluateByOperator("<=",[i[s-3],i[s]]);break;case 10:this.$=r.evaluateByOperator(">=",[i[s-3],i[s]]);break;case 11:this.$=r.evaluateByOperator("<>",[i[s-3],i[s]]);break;case 12:this.$=r.evaluateByOperator("NOT",[i[s-2],i[s]]);break;case 13:this.$=r.evaluateByOperator(">",[i[s-2],i[s]]);break;case 14:this.$=r.evaluateByOperator("<",[i[s-2],i[s]]);break;case 15:this.$=r.evaluateByOperator("-",[i[s-2],i[s]]);break;case 16:this.$=r.evaluateByOperator("*",[i[s-2],i[s]]);break;case 17:this.$=r.evaluateByOperator("/",[i[s-2],i[s]]);break;case 18:this.$=r.evaluateByOperator("^",[i[s-2],i[s]]);break;case 19:var l=r.invertNumber(i[s]);this.$=l,isNaN(this.$)&&(this.$=0);break;case 20:l=r.toNumber(i[s]);this.$=l,isNaN(this.$)&&(this.$=0);break;case 21:this.$=r.callFunction(i[s-2]);break;case 22:this.$=r.callFunction(i[s-3],i[s-1]);break;case 26:case 27:case 28:this.$=r.cellValue(i[s]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=r.rangeValue(i[s-2],i[s]);break;case 38:case 42:this.$=[i[s]];break;case 39:this.$=r.trimEdges(t).split(",");break;case 40:case 41:i[s-2].push(i[s]),this.$=i[s-2];break;case 43:this.$=Array.isArray(i[s-2])?i[s-2]:[i[s-2]],this.$.push(i[s]);break;case 44:this.$=i[s];break;case 45:this.$=1*(i[s-2]+"."+i[s]);break;case 46:this.$=.01*i[s-1];break;case 47:this.$=r.throwError(i[s])}},table:[{2:11,3:1,4:2,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{1:[3]},{5:[1,18],9:h,10:d,11:p,14:g,15:v,16:y,17:m,18:b,19:w,20:C},t(O,[2,2],{32:[1,29]}),t(O,[2,3],{34:[1,30]}),t(O,[2,4]),{2:11,4:31,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:32,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:33,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{12:[1,34]},t(O,[2,23]),t(O,[2,24],{2:35,35:f}),t(E,[2,42]),t(S,[2,44],{32:[1,36]}),t(O,[2,26],{27:[1,37]}),t(O,[2,27],{27:[1,38]}),t(O,[2,28],{27:[1,39]}),t([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:41,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:42,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:45,6:3,7:4,8:e,10:[1,43],11:n,12:r,15:[1,44],17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:47,6:3,7:4,8:e,10:[1,46],11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:48,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:49,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:50,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:51,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:52,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{31:[1,53]},t(S,[2,46]),{9:h,10:d,11:p,13:[1,54],14:g,15:v,16:y,17:m,18:b,19:w,20:C},t(k,[2,19],{9:h,18:b,19:w,20:C}),t(k,[2,20],{9:h,18:b,19:w,20:C}),{2:11,4:57,6:3,7:4,8:e,11:n,12:r,13:[1,55],17:o,21:i,22:56,23:10,24:a,25:s,26:l,28:[1,58],31:u,33:c,35:f},t(O,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},t(O,[2,5]),t([5,10,13,29,30],[2,6],{9:h,11:p,14:g,15:v,16:y,17:m,18:b,19:w,20:C}),t(k,[2,7],{9:h,18:b,19:w,20:C}),{2:11,4:69,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:70,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},t(R,[2,14],{9:h,11:p,17:m,18:b,19:w,20:C}),{2:11,4:71,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},t(R,[2,13],{9:h,11:p,17:m,18:b,19:w,20:C}),t([5,10,13,16,29,30],[2,12],{9:h,11:p,14:g,15:v,17:m,18:b,19:w,20:C}),t(k,[2,15],{9:h,18:b,19:w,20:C}),t(T,[2,16],{9:h,20:C}),t(T,[2,17],{9:h,20:C}),t([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:h}),t(E,[2,43]),t(O,[2,8]),t(O,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},t(M,[2,38],{9:h,10:d,11:p,14:g,15:v,16:y,17:m,18:b,19:w,20:C}),t(M,[2,39]),t(S,[2,45]),t(O,[2,29]),t(O,[2,30]),t(O,[2,31]),t(O,[2,32]),t(O,[2,33]),t(O,[2,34]),t(O,[2,35]),t(O,[2,36]),t(O,[2,37]),t(R,[2,9],{9:h,11:p,17:m,18:b,19:w,20:C}),t(R,[2,11],{9:h,11:p,17:m,18:b,19:w,20:C}),t(R,[2,10],{9:h,11:p,17:m,18:b,19:w,20:C}),t(O,[2,22]),{2:11,4:75,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:76,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},t(M,[2,40],{9:h,10:d,11:p,14:g,15:v,16:y,17:m,18:b,19:w,20:C}),t(M,[2,41],{9:h,10:d,11:p,14:g,15:v,16:y,17:m,18:b,19:w,20:C})],defaultActions:{18:[2,1]},parseError:function(t,e){if(!e.recoverable){var n=new Error(t);throw n.hash=e,n}this.trace(t)},parse:function(t){var e=this,n=[0],r=[null],o=[],i=this.table,a="",s=0,l=0,u=0,c=2,f=o.slice.call(arguments,1),h=Object.create(this.lexer),d={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(d.yy[p]=this.yy[p]);h.setInput(t,d.yy),d.yy.lexer=h,d.yy.parser=this,void 0===h.yylloc&&(h.yylloc={});var g=h.yylloc;o.push(g);var v=h.options&&h.options.ranges;"function"==typeof d.yy.parseError?this.parseError=d.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var y,m,b,w,C,O,E,S,k,R,T=function(){var t;return"number"!=typeof(t=h.lex()||1)&&(t=e.symbols_[t]||t),t},M={};;){if(b=n[n.length-1],this.defaultActions[b]?w=this.defaultActions[b]:(null==y&&(y=T()),w=i[b]&&i[b][y]),void 0===w||!w.length||!w[0]){var _,N="";function A(t){for(var e=n.length-1,r=0;;){if(c.toString()in i[t])return r;if(0===t||e<2)return!1;t=n[e-=2],++r}}if(u)1!==m&&(_=A(b));else{for(O in _=A(b),k=[],i[b])this.terminals_[O]&&O>c&&k.push("'"+this.terminals_[O]+"'");N=h.showPosition?"Parse error on line "+(s+1)+":\n"+h.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(s+1)+": Unexpected "+(1==y?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(N,{text:h.match,token:this.terminals_[y]||y,line:h.yylineno,loc:g,expected:k,recoverable:!1!==_})}if(3==u){if(1===y||1===m)throw new Error(N||"Parsing halted while starting to recover from another error.");l=h.yyleng,a=h.yytext,s=h.yylineno,g=h.yylloc,y=T()}if(!1===_)throw new Error(N||"Parsing halted. No suitable error recovery rule available.");R=_,n.length=n.length-2*R,r.length=r.length-R,o.length=o.length-R,m=y==c?null:y,y=c,b=n[n.length-1],w=i[b]&&i[b][c],u=3}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+y);switch(w[0]){case 1:n.push(y),r.push(h.yytext),o.push(h.yylloc),n.push(w[1]),y=null,m?(y=m,m=null):(l=h.yyleng,a=h.yytext,s=h.yylineno,g=h.yylloc,u>0&&u--);break;case 2:if(E=this.productions_[w[1]][1],M.$=r[r.length-E],M._$={first_line:o[o.length-(E||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(E||1)].first_column,last_column:o[o.length-1].last_column},v&&(M._$.range=[o[o.length-(E||1)].range[0],o[o.length-1].range[1]]),void 0!==(C=this.performAction.apply(M,[a,l,s,d.yy,w[1],r,o].concat(f))))return C;E&&(n=n.slice(0,-1*E*2),r=r.slice(0,-1*E),o=o.slice(0,-1*E)),n.push(this.productions_[w[1]][0]),r.push(M.$),o.push(M._$),S=i[n[n.length-2]][n[n.length-1]],n.push(S);break;case 3:return!0}}return!0}},N={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,r,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(o.yylloc.range=this.yylloc.range.slice(0))),(r=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var i in o)this[i]=o[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),i=0;i<o.length;i++)if((n=this._input.match(this.rules[o[i]]))&&(!e||n[0].length>e[0].length)){if(e=n,r=i,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,o[i])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,o[r]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n,r){switch(n){case 0:break;case 1:case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:case 7:return 26;case 8:return 25;case 9:return 21;case 10:case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}};function A(){this.yy={}}return _.lexer=N,A.prototype=_,_.Parser=A,new A}();e.parser=r,e.Parser=r.Parser,e.parse=function(){return r.parse.apply(r,arguments)}},function(t,e,n){"use strict";e.__esModule=!0,e.trimEdges=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t=t.substring(e,t.length-e)}}])},t.exports=o()},function(t,e,n){"use strict";n.d(e,"b",function(){return l}),n.d(e,"a",function(){return u}),n.d(e,"c",function(){return v}),n.d(e,"e",function(){return y}),n.d(e,"f",function(){return m}),n.d(e,"g",function(){return b}),n.d(e,"d",function(){return w});n(10),n(11),n(12),n(29),n(44),n(7),n(76),n(6),n(81),n(50),n(8),n(9);var r=n(5),o=n(1),i=n(13);function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var l=0,u=1,c=2,f=3,h=[f,c],d=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],p=Symbol("root"),g=Symbol("child");function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p;if(e!==p&&e!==g)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(t),o=e===p,i=l;if(n){var a=t[0];if(0===t.length)i=u;else if(o&&a instanceof r.b)i=f;else if(o&&Array.isArray(a))i=v(a,g);else if(t.length>=2&&t.length<=4){!t.some(function(t,e){return!d[e].includes(s(t))})&&(i=c)}}return i}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.keepDirection,r=void 0!==n&&n,o=e.propToCol;if(!h.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(e){var n=t===f,a=n?e.from.row:e[0],s=n?e.from.col:e[1],l=n?e.to.row:e[2],u=n?e.to.col:e[3];if("function"==typeof o&&("string"==typeof s&&(s=o(s)),"string"==typeof u&&(u=o(u))),Object(i.isUndefined)(l)&&(l=a),Object(i.isUndefined)(u)&&(u=s),!r){var c=a,h=s,d=l,p=u;a=Math.min(c,d),s=Math.min(h,p),l=Math.max(c,d),u=Math.max(h,p)}return[a,s,l,u]}}function m(t){var e=v(t);if(e===l||e===u)return[];var n=y(e),r=new Set;Object(o.arrayEach)(t,function(t){var e=a(n(t),4),i=e[1],s=e[3]-i+1;Object(o.arrayEach)(Array.from(new Array(s),function(t,e){return i+e}),function(t){r.has(t)||r.add(t)})});var i=Array.from(r).sort(function(t,e){return t-e});return Object(o.arrayReduce)(i,function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t},[])}function b(t){var e=v(t);if(e===l||e===u)return[];var n=y(e),r=new Set;Object(o.arrayEach)(t,function(t){var e=a(n(t),3),i=e[0],s=e[2]-i+1;Object(o.arrayEach)(Array.from(new Array(s),function(t,e){return i+e}),function(t){r.has(t)||r.add(t)})});var i=Array.from(r).sort(function(t,e){return t-e});return Object(o.arrayReduce)(i,function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t},[])}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof t&&t>=0&&t<e}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){"use strict";var r=n(151),o=n(152)("includes");n(27)({target:"String",proto:!0,forced:!o},{includes:function(t){return!!~r(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){"use strict";var r=n(54);function o(t,e){var n=t;return function(t){for(var r=!1,o=0,i=t.length;o<i;o++)if(n===t[o]){r=!0;break}e(r)}}n(185);var i=n(25),a=n.n(i),s=n(130),l=n(32);var u=n(4);var c=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];n.d(e,"c",function(){return h}),n.d(e,"b",function(){return v}),n.d(e,"a",function(){return g});var f=Object(r.a)("validators"),h=f.register,d=f.getItem,p=f.hasItem,g=f.getNames;f.getValues;function v(t){if("function"==typeof t)return t;if(!p(t))throw Error('No registered validator found under "'.concat(t,'" name'));return d(t)}h("autocomplete",function(t,e){var n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,o(n,e)):o(n,e)(this.source):e(!0)}),h("date",function(t,e){var n=Object(l.b)("date",this.instance),r=t,o=!0;null==r&&(r="");var i=a()(new Date(r)).isValid()||a()(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),u=a()(r,this.dateFormat||n.defaultDateFormat,!0).isValid();if(this.allowEmpty&&""===r&&(i=!0,u=!0),i||(o=!1),!i&&u&&(o=!0),i&&!u)if(!0===this.correctFormat){var c=function(t,e){var n=a()(Object(s.getNormalizedDate)(t)),r=a()(t,e),o=t.search(/[A-z]/g)>-1;return(n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||o?n:r).format(e)}(r,this.dateFormat),f=this.instance.runHooks("unmodifyRow",this.row),h=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(f,h,c,"dateValidator"),o=!0}else o=!1;e(o)}),h("numeric",function(t,e){var n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):e(""!==n&&Object(u.isNumeric)(t))}),h("time",function(t,e){var n=this.timeFormat||"h:mm:ss a",r=!0,o=t;null===o&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var s=a()(o,c,!0).isValid()?a()(o):a()(o,n),l=s.isValid(),u=a()(o,n,!0).isValid()&&!i;if(this.allowEmpty&&""===o&&(l=!0,u=!0),l||(r=!1),!l&&u&&(r=!0),l&&!u)if(!0===this.correctFormat){var f=s.format(n),h=this.instance.runHooks("unmodifyRow",this.row),d=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(h,d,f,"timeValidator"),r=!0}else r=!1;e(r)})},function(t,e,n){"use strict";var r=n(53),o=n(68),i=n(57),a=n(85),s=n(63),l=n(149),u=n(123),c=Math.max,f=Math.min,h=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;n(124)("replace",2,function(t,e,n){return[function(n,r){var o=s(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,o,r):e.call(String(o),n,r)},function(t,o){var s=n(e,t,this,o);if(s.done)return s.value;var h=r(t),d=String(this),p="function"==typeof o;p||(o=String(o));var v=h.global;if(v){var y=h.unicode;h.lastIndex=0}for(var m=[];;){var b=u(h,d);if(null===b)break;if(m.push(b),!v)break;""===String(b[0])&&(h.lastIndex=l(d,i(h.lastIndex),y))}for(var w,C="",O=0,E=0;E<m.length;E++){b=m[E];for(var S=String(b[0]),k=c(f(a(b.index),d.length),0),R=[],T=1;T<b.length;T++)R.push(void 0===(w=b[T])?w:String(w));var M=b.groups;if(p){var _=[S].concat(R,k,d);void 0!==M&&_.push(M);var N=String(o.apply(void 0,_))}else N=g(S,d,k,R,M,o);k>=O&&(C+=d.slice(O,k)+N,O=k+S.length)}return C+d.slice(O)}];function g(t,n,r,i,a,s){var l=r+t.length,u=i.length,c=p;return void 0!==a&&(a=o(a),c=d),e.call(s,c,function(e,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(l);case"<":s=a[o.slice(1,-1)];break;default:var c=+o;if(0===c)return e;if(c>u){var f=h(c/10);return 0===f?e:f<=u?void 0===i[f-1]?o.charAt(1):i[f-1]+o.charAt(1):e}s=i[c-1]}return void 0===s?"":s})}})},function(t,e,n){var r=n(49);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(10),n(11),n(12),n(29),n(7),n(75),n(6),n(26),n(8),n(9);function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=new Map;function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";o.has(t)||o.set(t,new Map);var e=o.get(t);return{register:function(t,n){e.set(t,n)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return r(e.keys())},getValues:function(){return r(e.values())}}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";var r=n(105)(2),o=n(106)("filter");n(27)({target:"Array",proto:!0,forced:!o},{filter:function(t){return r(this,t,arguments[1])}})},function(t,e,n){var r=n(85),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e,n){t.exports=!n(37)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(58),o=n(159),i=n(53),a=n(99),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(i(t),e=a(e,!0),i(n),o)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){"use strict";n(10),n(11),n(12),n(7),n(18),n(19),n(6),n(8),n(107),n(9);var r=n(5),o=n(13),i=n(2),a=n(1),s={_hooksStorage:Object.create(null),addHook:function(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey:function(t){var e=this;Object(a.arrayEach)(this._hooksStorage[t]||[],function(n){e.hot.removeHook(t,n)})},clearHooks:function(){var t=this;Object(i.objectEach)(this._hooksStorage,function(e,n){return t.removeHooksByKey(n)}),this._hooksStorage={}}};Object(i.defineGetter)(s,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var l=s;function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",function(){return g});var g={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},v=function(){function t(e){d(this,t),this.hot=e,this.instance=e,this.state=g.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}var e,n,i;return e=t,(n=[{key:"_fireCallbacks",value:function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(t,e,n,r,o,i){this.TD=r,this.row=t,this.col=e,this.prop=n,this.originalValue=o,this.cellProperties=i,this.state=g.VIRGIN}},{key:"extend",value:function(){return function(t){function e(){return d(this,e),c(this,f(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(e,t),e}(this.constructor)}},{key:"saveValue",value:function(t,e){var n,r;e?((n=this.hot.getSelectedLast())[0]>n[2]&&(r=n[0],n[0]=n[2],n[2]=r),n[1]>n[3]&&(r=n[1],n[1]=n[3],n[3]=r)):n=[this.row,this.col,null,null],this.hot.populateFromArray(n[0],n[1],t,n[2],n[3],"edit")}},{key:"beginEditing",value:function(t,e){if(this.state===g.VIRGIN){if(this.hot.view.scrollViewport(new r.a(this.row,this.col)),this.state=g.EDITING,this.isInFullEditMode()){var n="string"==typeof t?t:Object(o.stringify)(this.originalValue);this.setValue(n)}this.open(e),this._opened=!0,this.focus(),this.hot.view.render(),this.hot.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(t,e,n){var r,o=this;if(n){var i=this._closeCallback;this._closeCallback=function(t){i&&i(t),n(t),o.hot.view.render()}}if(!this.isWaiting())if(this.state!==g.VIRGIN){if(this.state===g.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();var a=this.getValue();r=this.hot.getSettings().trimWhitespace?[["string"==typeof a?String.prototype.trim.call(a||""):a]]:[[a]],this.state=g.WAITING,this.saveValue(r,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(t){o.state=g.FINISHED,o.discardEditor(t)}):(this.state=g.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout(function(){o._fireCallbacks(!0)})}},{key:"cancelChanges",value:function(){this.state=g.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(t){this.state===g.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=g.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=g.VIRGIN,this._fireCallbacks(!0)))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===g.WAITING}},{key:"checkEditorSection",value:function(){var t=this.hot.countRows(),e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsLeft&&(e="left"),e}}])&&p(e.prototype,n),i&&p(e,i),t}();Object(i.mixin)(v,l);e.b=v},function(t,e,n){"use strict";var r=n(148),o=n(53),i=n(63),a=n(203),s=n(149),l=n(57),u=n(123),c=n(150),f=n(37),h=[].push,d=Math.min,p=!f(function(){return!RegExp(4294967295,"y")});n(124)("split",2,function(t,e,n){var f;return f="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var o=String(i(this)),a=void 0===n?4294967295:n>>>0;if(0===a)return[];if(void 0===t)return[o];if(!r(t))return e.call(o,t,a);for(var s,l,u,f=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,g=new RegExp(t.source,d+"g");(s=c.call(g,o))&&!((l=g.lastIndex)>p&&(f.push(o.slice(p,s.index)),s.length>1&&s.index<o.length&&h.apply(f,s.slice(1)),u=s[0].length,p=l,f.length>=a));)g.lastIndex===s.index&&g.lastIndex++;return p===o.length?!u&&g.test("")||f.push(""):f.push(o.slice(p)),f.length>a?f.slice(0,a):f}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var r=i(this),o=null==e?void 0:e[t];return void 0!==o?o.call(e,r,n):f.call(String(r),e,n)},function(t,r){var i=n(f,t,this,r,f!==e);if(i.done)return i.value;var c=o(t),h=String(this),g=a(c,RegExp),v=c.unicode,y=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(p?"y":"g"),m=new g(p?c:"^(?:"+c.source+")",y),b=void 0===r?4294967295:r>>>0;if(0===b)return[];if(0===h.length)return null===u(m,h)?[h]:[];for(var w=0,C=0,O=[];C<h.length;){m.lastIndex=p?C:0;var E,S=u(m,p?h:h.slice(C));if(null===S||(E=d(l(m.lastIndex+(p?0:C)),h.length))===w)C=s(h,C,v);else{if(O.push(h.slice(w,C)),O.length===b)return O;for(var k=1;k<=S.length-1;k++)if(O.push(S[k]),O.length===b)return O;C=w=E}}return O.push(h.slice(w)),O}]},!p)},function(t,e,n){var r=n(58),o=n(59).f,i=Function.prototype,a=i.toString,s=/^\s*function ([^ (]*)/;!r||"name"in i||o(i,"name",{configurable:!0,get:function(){try{return a.call(this).match(s)[1]}catch(t){return""}}})},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,n){"use strict";var r=n(70),o=[].join,i=n(109)!=Object,a=n(122)("join",",");n(27)({target:"Array",proto:!0,forced:i||a},{join:function(t){return o.call(r(this),void 0===t?",":t)}})},function(t,e,n){"use strict";n.d(e,"a",function(){return u});n(7),n(6),n(8),n(31),n(9);var r=n(87),o=n(2);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e}var e,n,r;return e=t,(n=[{key:"toVisualRow",value:function(t){return this.hot.runHooks("unmodifyRow",t)}},{key:"toVisualColumn",value:function(t){return this.hot.runHooks("unmodifyCol",t)}},{key:"toVisual",value:function(t,e){return Object(o.isObject)(t)?{row:this.toVisualRow(t.row),column:this.toVisualColumn(t.column)}:[this.toVisualRow(t),this.toVisualColumn(e)]}},{key:"toPhysicalRow",value:function(t){return this.hot.runHooks("modifyRow",t)}},{key:"toPhysicalColumn",value:function(t){return this.hot.runHooks("modifyCol",t)}},{key:"toPhysical",value:function(t,e){return Object(o.isObject)(t)?{row:this.toPhysicalRow(t.row),column:this.toPhysicalColumn(t.column)}:[this.toPhysicalRow(t),this.toPhysicalColumn(e)]}}])&&i(e.prototype,n),r&&i(e,r),t}(),s=new WeakMap,l=new WeakMap;function u(t){var e,n=t instanceof r.a?t:function(t){if(!s.has(t))throw Error("Record translator was not registered for this object identity");return s.get(t)}(t);return l.has(n)?e=l.get(n):(e=new a(n),l.set(n,e)),e}},function(t,e,n){"use strict";n.r(e),n.d(e,"spreadsheetColumnLabel",function(){return s}),n.d(e,"spreadsheetColumnIndex",function(){return l}),n.d(e,"createSpreadsheetData",function(){return u}),n.d(e,"createSpreadsheetObjectData",function(){return c}),n.d(e,"createEmptySpreadsheetData",function(){return f}),n.d(e,"translateRowsToColumns",function(){return h}),n.d(e,"cellMethodLookupFactory",function(){return d});n(18);var r=n(77),o=n(2),i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=i.length;function s(t){for(var e,n=t+1,r="";n>0;)e=(n-1)%a,r=String.fromCharCode(65+e)+r,n=parseInt((n-e)/a,10);return r}function l(t){var e=0;if(t)for(var n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Math.pow(a,r)*(i.indexOf(t[n])+1);return e-=1}function u(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;t<n;t++){var i=[];for(e=0;e<r;e++)i.push(s(e)+(t+1));o.push(i)}return o}function c(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;t<n;t++){var i={};for(e=0;e<r;e++)i["prop".concat(e)]=s(e)+(t+1);o.push(i)}return o}function f(t,e){for(var n,r=[],o=0;o<t;o++){n=[];for(var i=0;i<e;i++)n.push("");r.push(n)}return r}function h(t){var e,n,r,o,i=[],a=0;for(e=0,n=t.length;e<n;e++)for(r=0,o=t[e].length;r<o;r++)r===a&&(i.push([]),a+=1),i[r].push(t[e][r]);return i}function d(t,e){var n=void 0===e||e;return function(e,i){return function e(i){if(i){if(Object(o.hasOwnProperty)(i,t)&&void 0!==i[t])return i[t];if(Object(o.hasOwnProperty)(i,"type")&&i.type){if("string"!=typeof i.type)throw new Error("Cell type must be a string ");var a=Object(r.a)(i.type);if(Object(o.hasOwnProperty)(a,t))return a[t];if(n)return}return e(Object.getPrototypeOf(i))}}("number"==typeof e?this.getCellMeta(e,i):e)}}},function(t,e,n){var r=n(59),o=n(98);t.exports=n(58)?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(63);t.exports=function(t){return Object(r(t))}},function(t,e,n){"use strict";var r,o=n(2),i=n(93),a=n(54),s=n(3);function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}
/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */var u=(l(r={languageCode:"en-US"},s.CONTEXTMENU_ITEMS_NO_ITEMS,"No available options"),l(r,s.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),l(r,s.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),l(r,s.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),l(r,s.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),l(r,s.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),l(r,s.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),l(r,s.CONTEXTMENU_ITEMS_UNDO,"Undo"),l(r,s.CONTEXTMENU_ITEMS_REDO,"Redo"),l(r,s.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),l(r,s.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),l(r,s.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),l(r,s.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),l(r,s.CONTEXTMENU_ITEMS_BORDERS,"Borders"),l(r,s.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),l(r,s.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),l(r,s.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),l(r,s.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),l(r,s.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),l(r,s.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),l(r,s.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),l(r,s.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),l(r,s.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),l(r,s.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),l(r,s.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),l(r,s.CONTEXTMENU_ITEMS_COPY,"Copy"),l(r,s.CONTEXTMENU_ITEMS_CUT,"Cut"),l(r,s.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),l(r,s.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),l(r,s.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),l(r,s.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),l(r,s.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),l(r,s.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),l(r,s.FILTERS_CONDITIONS_NONE,"None"),l(r,s.FILTERS_CONDITIONS_EMPTY,"Is empty"),l(r,s.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),l(r,s.FILTERS_CONDITIONS_EQUAL,"Is equal to"),l(r,s.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),l(r,s.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),l(r,s.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),l(r,s.FILTERS_CONDITIONS_CONTAINS,"Contains"),l(r,s.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),l(r,s.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),l(r,s.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),l(r,s.FILTERS_CONDITIONS_LESS_THAN,"Less than"),l(r,s.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),l(r,s.FILTERS_CONDITIONS_BETWEEN,"Is between"),l(r,s.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),l(r,s.FILTERS_CONDITIONS_AFTER,"After"),l(r,s.FILTERS_CONDITIONS_BEFORE,"Before"),l(r,s.FILTERS_CONDITIONS_TODAY,"Today"),l(r,s.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),l(r,s.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),l(r,s.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),l(r,s.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),l(r,s.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),l(r,s.FILTERS_LABELS_CONJUNCTION,"And"),l(r,s.FILTERS_LABELS_DISJUNCTION,"Or"),l(r,s.FILTERS_BUTTONS_SELECT_ALL,"Select all"),l(r,s.FILTERS_BUTTONS_CLEAR,"Clear"),l(r,s.FILTERS_BUTTONS_OK,"OK"),l(r,s.FILTERS_BUTTONS_CANCEL,"Cancel"),l(r,s.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),l(r,s.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),l(r,s.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),r);n.d(e,"e",function(){return v}),n.d(e,"b",function(){return y}),n.d(e,"d",function(){return m}),n.d(e,"c",function(){return b}),n.d(e,"a",function(){return c});var c=u.languageCode,f=Object(a.a)("languagesDictionaries"),h=f.register,d=f.getItem,p=f.hasItem,g=f.getValues;function v(t,e){var n=t,r=e;return Object(o.isObject)(t)&&(n=(r=t).languageCode),function(t,e){t!==c&&Object(i.b)(e,d(c))}(n,r),h(n,Object(o.deepClone)(r)),Object(o.deepClone)(r)}function y(t){return m(t)?Object(o.deepClone)(d(t)):null}function m(t){return p(t)}function b(){return g()}v(u)},function(t,e,n){var r=n(109),o=n(63);t.exports=function(t){return r(o(t))}},function(t,e,n){var r=n(41),o=n(67),i=n(55),a=n(137),s=n(160),l=n(86),u=l.get,c=l.enforce,f=String(s).split("toString");n(100)("inspectSource",function(t){return s.call(t)}),(t.exports=function(t,e,n,s){var l=!!s&&!!s.unsafe,u=!!s&&!!s.enumerable,h=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof e||i(n,"name")||o(n,"name",e),c(n).source=f.join("string"==typeof e?e:"")),t!==r?(l?!h&&t[e]&&(u=!0):delete t[e],u?t[e]=n:o(t,e,n)):u?t[e]=n:a(e,n)})(Function.prototype,"toString",function(){return"function"==typeof this&&u(this).source||s.call(this)})},function(t,e,n){var r=n(49),o=n(103).onFreeze,i=Object.freeze,a=n(168),s=n(37)(function(){i(1)});n(27)({target:"Object",stat:!0,forced:s,sham:!a},{freeze:function(t){return i&&r(t)?i(o(t)):t}})},function(t,e,n){var r=n(68),o=n(91),i=n(37)(function(){o(1)});n(27)({target:"Object",stat:!0,forced:i},{keys:function(t){return o(r(t))}})},function(t,e,n){"use strict";n.d(e,"a",function(){return c}),n.d(e,"b",function(){return l}),n.d(e,"c",function(){return u});n(29),n(7),n(6),n(81),n(8),n(9);var r=n(20),o=n(17),i=new r.a,a=new Set,s=0;function l(t){0===s&&(i.addEventListener(t,"keydown",function(t){a.has(t.keyCode)||a.add(t.keyCode)}),i.addEventListener(t,"keyup",function(t){a.has(t.keyCode)&&a.delete(t.keyCode)}),i.addEventListener(t,"visibilitychange",function(){t.hidden&&a.clear()}),i.addEventListener(t.defaultView,"blur",function(){a.clear()})),s+=1}function u(){s>0&&(s-=1),0===s&&(i.clearEvents(),a.clear(),s=0)}function c(){return Array.from(a.values()).some(function(t){return Object(o.isCtrlMetaKey)(t)})}},function(t,e,n){"use strict";t.exports=n(120)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},n(178),!0)},function(t,e,n){"use strict";var r=n(144),o=n(68),i=n(37),a=[].sort,s=[1,2,3],l=i(function(){s.sort(void 0)}),u=i(function(){s.sort(null)}),c=n(122)("sort"),f=l||!u||c;n(27)({target:"Array",proto:!0,forced:f},{sort:function(t){return void 0===t?a.call(o(this)):a.call(o(this),r(t))}})},function(t,e,n){"use strict";var r=n(54),o=n(32),i=n(38),a=n(51),s={editor:Object(o.a)("autocomplete"),renderer:Object(i.b)("autocomplete"),validator:Object(a.b)("autocomplete")},l={editor:Object(o.a)("checkbox"),renderer:Object(i.b)("checkbox")},u={editor:Object(o.a)("date"),renderer:Object(i.b)("autocomplete"),validator:Object(a.b)("date")},c={editor:Object(o.a)("dropdown"),renderer:Object(i.b)("autocomplete"),validator:Object(a.b)("autocomplete")},f={editor:Object(o.a)("handsontable"),renderer:Object(i.b)("autocomplete")},h={editor:Object(o.a)("numeric"),renderer:Object(i.b)("numeric"),validator:Object(a.b)("numeric"),dataType:"number"},d={editor:Object(o.a)("password"),renderer:Object(i.b)("password"),copyable:!1},p={editor:Object(o.a)("text"),renderer:Object(i.b)("text")},g={editor:Object(o.a)("text"),renderer:Object(i.b)("text"),validator:Object(a.b)("time")};n.d(e,"c",function(){return O}),n.d(e,"a",function(){return C}),n.d(e,"b",function(){return w});var v=Object(r.a)("cellTypes"),y=v.register,m=v.getItem,b=v.hasItem,w=v.getNames;v.getValues;function C(t){if(!b(t))throw Error('You declared cell type "'.concat(t,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method'));return m(t)}function O(t,e){var n=e.editor,r=e.renderer,s=e.validator;n&&Object(o.d)(t,n),r&&Object(i.c)(t,r),s&&Object(a.c)(t,s),y(t,e)}O("autocomplete",s),O("checkbox",l),O("date",u),O("dropdown",c),O("handsontable",f),O("numeric",h),O("password",d),O("text",p),O("time",g)},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){"use strict";var r=n(41),o=n(115),i=n(55),a=n(78),s=n(146),l=n(99),u=n(37),c=n(95).f,f=n(90).f,h=n(59).f,d=n(180),p=r.Number,g=p.prototype,v="Number"==a(n(101)(g)),y="trim"in String.prototype,m=function(t){var e,n,r,o,i,a,s,u,c=l(t,!1);if("string"==typeof c&&c.length>2)if(43===(e=(c=y?c.trim():d(c,3)).charCodeAt(0))||45===e){if(88===(n=c.charCodeAt(2))||120===n)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+c}for(a=(i=c.slice(2)).length,s=0;s<a;s++)if((u=i.charCodeAt(s))<48||u>o)return NaN;return parseInt(i,r)}return+c};if(o("Number",!p(" 0o1")||!p("0b1")||p("+0x1"))){for(var b,w=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof w&&(v?u(function(){g.valueOf.call(n)}):"Number"!=a(n))?s(new p(m(e)),n,w):m(e)},C=n(58)?c(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),O=0;C.length>O;O++)i(p,b=C[O])&&!i(w,b)&&h(w,b,f(p,b));w.prototype=g,g.constructor=w,n(71)(r,"Number",w)}},function(t,e,n){n(27)({target:"Number",stat:!0},{isInteger:n(212)})},function(t,e,n){"use strict";t.exports=n(120)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},n(178))},function(t,e,n){"use strict";n.r(e),n.d(e,"columnFactory",function(){return o});var r=n(2);function o(t,e){function n(){}Object(r.inherit)(n,t);for(var o=0,i=e.length;o<i;o++)n.prototype[e[o]]=void 0;return n}},function(t,e,n){!function(t){"use strict";function n(t){return t.split('"').length-1}var r=function(t){var e,r,o,i,a,s,l,u=[],c=0;for((o=t.replace(/\r\n|\r/g,"\n").split("\n")).length>1&&""===o[o.length-1]&&o.pop(),e=0,r=o.length;e<r;e+=1){for(o[e]=o[e].split("\t"),i=0,a=o[e].length;i<a;i+=1)u[c]||(u[c]=[]),s&&0===i?(l=u[c].length-1,u[c][l]=u[c][l]+"\n"+o[e][0],s&&1&n(o[e][0])&&(s=!1,u[c][l]=u[c][l].substring(0,u[c][l].length-1).replace(/""/g,'"'))):i===a-1&&0===o[e][i].indexOf('"')&&1&n(o[e][i])?(u[c].push(o[e][i].substring(1).replace(/""/g,'"')),s=!0):(u[c].push(o[e][i].replace(/""/g,'"')),s=!1);s||(c+=1)}return u},o=function(t){var e,n,r,o,i,a="";for(e=0,n=t.length;e<n;e+=1){for(o=t[e].length,r=0;r<o;r+=1)r>0&&(a+="\t"),"string"==typeof(i=t[e][r])?i.indexOf("\n")>-1?a+='"'+i.replace(/"/g,'""')+'"':a+=i:a+=null==i?"":i;e!==n-1&&(a+="\n")}return a};e.parse=r,e.stringify=o}(window)},function(t,e,n){var r;t.exports=function t(e,n,o){function i(s,l){if(!n[s]){if(!e[s]){var u="function"==typeof r&&r;if(!l&&u)return r(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[s]={exports:{}};e[s][0].call(f.exports,function(t){var n=e[s][1][t];return i(n||t)},f,f.exports,t,e,n,o)}return n[s].exports}for(var a="function"==typeof r&&r,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(t,e,n){!function(t){"use strict";function n(t){var e=0|t;return t>0||t===e?e:e-1}function r(t){for(var e,n,r=1,o=t.length,i=t[0]+"";r<o;){for(e=t[r++]+"",n=w-e.length;n--;e="0"+e);i+=e}for(o=i.length;48===i.charCodeAt(--o););return i.slice(0,o+1||1)}function o(t,e){var n,r,o=t.c,i=e.c,a=t.s,s=e.s,l=t.e,u=e.e;if(!a||!s)return null;if(n=o&&!o[0],r=i&&!i[0],n||r)return n?r?0:-s:a;if(a!=s)return a;if(n=a<0,r=l==u,!o||!i)return r?0:!o^n?1:-1;if(!r)return l>u^n?1:-1;for(s=(l=o.length)<(u=i.length)?l:u,a=0;a<s;a++)if(o[a]!=i[a])return o[a]>i[a]^n?1:-1;return l==u?0:l>u^n?1:-1}function i(t,e,n){return(t=c(t))>=e&&t<=n}function a(t){return"[object Array]"==Object.prototype.toString.call(t)}function s(t,e,n){for(var r,o,i=[0],a=0,s=t.length;a<s;){for(o=i.length;o--;i[o]*=e);for(i[r=0]+=m.indexOf(t.charAt(a++));r<i.length;r++)i[r]>n-1&&(null==i[r+1]&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function l(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function u(t,e){var n,r;if(e<0){for(r="0.";++e;r+="0");t=r+t}else if(n=t.length,++e>n){for(r="0",e-=n;--e;r+="0");t+=r}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}function c(t){return(t=parseFloat(t))<0?d(t):p(t)}var f,h=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,d=Math.ceil,p=Math.floor,g=" not a boolean or binary digit",v="rounding mode",y="number type has more than 15 significant digits",m="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",b=1e14,w=14,C=9007199254740991,O=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],E=1e7,S=1e9;(f=function t(e){function f(t,e){var n,r,o,i,a,s,l=this;if(!(l instanceof f))return U&&N(26,"constructor call without new",t),new f(t,e);if(null!=e&&Y(e,2,64,I,"base")){if(s=t+"",10==(e|=0))return A(l=new f(t instanceof f?t:s),L+l.e+1,H);if((i="number"==typeof t)&&0*t!=0||!new RegExp("^-?"+(n="["+m.slice(0,e)+"]+")+"(?:\\."+n+")?$",e<37?"i":"").test(s))return j(l,s,i,e);i?(l.s=1/t<0?(s=s.slice(1),-1):1,U&&s.replace(/^0\.0*|\./,"").length>15&&N(I,y,t),i=!1):l.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1,s=k(s,10,e,l.s)}else{if(t instanceof f)return l.s=t.s,l.e=t.e,l.c=(t=t.c)?t.slice():t,void(I=0);if((i="number"==typeof t)&&0*t==0){if(l.s=1/t<0?(t=-t,-1):1,t===~~t){for(r=0,o=t;o>=10;o/=10,r++);return l.e=r,l.c=[t],void(I=0)}s=t+""}else{if(!h.test(s=t+""))return j(l,s,i);l.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1}}for((r=s.indexOf("."))>-1&&(s=s.replace(".","")),(o=s.search(/e/i))>0?(r<0&&(r=o),r+=+s.slice(o+1),s=s.substring(0,o)):r<0&&(r=s.length),o=0;48===s.charCodeAt(o);o++);for(a=s.length;48===s.charCodeAt(--a););if(s=s.slice(o,a+1))if(a=s.length,i&&U&&a>15&&(t>C||t!==p(t))&&N(I,y,l.s*t),(r=r-o-1)>V)l.c=l.e=null;else if(r<W)l.c=[l.e=0];else{if(l.e=r,l.c=[],o=(r+1)%w,r<0&&(o+=w),o<a){for(o&&l.c.push(+s.slice(0,o)),a-=w;o<a;)l.c.push(+s.slice(o,o+=w));s=s.slice(o),o=w-s.length}else o-=a;for(;o--;s+="0");l.c.push(+s)}else l.c=[l.e=0];I=0}function k(t,e,n,o){var i,a,l,c,h,d,p,g=t.indexOf("."),v=L,y=H;for(n<37&&(t=t.toLowerCase()),g>=0&&(l=X,X=0,t=t.replace(".",""),h=(p=new f(n)).pow(t.length-g),X=l,p.c=s(u(r(h.c),h.e),10,e),p.e=p.c.length),a=l=(d=s(t,n,e)).length;0==d[--l];d.pop());if(!d[0])return"0";if(g<0?--a:(h.c=d,h.e=a,h.s=o,d=(h=x(h,p,v,y,e)).c,c=h.r,a=h.e),g=d[i=a+v+1],l=e/2,c=c||i<0||null!=d[i+1],c=y<4?(null!=g||c)&&(0==y||y==(h.s<0?3:2)):g>l||g==l&&(4==y||c||6==y&&1&d[i-1]||y==(h.s<0?8:7)),i<1||!d[0])t=c?u("1",-v):"0";else{if(d.length=i,c)for(--e;++d[--i]>e;)d[i]=0,i||(++a,d=[1].concat(d));for(l=d.length;!d[--l];);for(g=0,t="";g<=l;t+=m.charAt(d[g++]));t=u(t,a)}return t}function R(t,e,n,o){var i,a,s,c,h;if(n=null!=n&&Y(n,0,8,o,v)?0|n:H,!t.c)return t.toString();if(i=t.c[0],s=t.e,null==e)h=r(t.c),h=19==o||24==o&&s<=F?l(h,s):u(h,s);else if(t=A(new f(t),e,n),a=t.e,h=r(t.c),c=h.length,19==o||24==o&&(e<=a||a<=F)){for(;c<e;h+="0",c++);h=l(h,a)}else if(e-=s,h=u(h,a),a+1>c){if(--e>0)for(h+=".";e--;h+="0");}else if((e+=a-c)>0)for(a+1==c&&(h+=".");e--;h+="0");return t.s<0&&i?"-"+h:h}function T(t,e){var n,r,o=0;for(a(t[0])&&(t=t[0]),n=new f(t[0]);++o<t.length;){if(!(r=new f(t[o])).s){n=r;break}e.call(n,r)&&(n=r)}return n}function M(t,e,n,r,o){return(t<e||t>n||t!=c(t))&&N(r,(o||"decimal places")+(t<e||t>n?" out of range":" not an integer"),t),!0}function _(t,e,n){for(var r=1,o=e.length;!e[--o];e.pop());for(o=e[0];o>=10;o/=10,r++);return(n=r+n*w-1)>V?t.c=t.e=null:n<W?t.c=[t.e=0]:(t.e=n,t.c=e),t}function N(t,e,n){var r=new Error(["new BigNumber","cmp","config","div","divToInt","eq","gt","gte","lt","lte","minus","mod","plus","precision","random","round","shift","times","toDigits","toExponential","toFixed","toFormat","toFraction","pow","toPrecision","toString","BigNumber"][t]+"() "+e+": "+n);throw r.name="BigNumber Error",I=0,r}function A(t,e,n,r){var o,i,a,s,l,u,c,f=t.c,h=O;if(f){t:{for(o=1,s=f[0];s>=10;s/=10,o++);if((i=e-o)<0)i+=w,a=e,c=(l=f[u=0])/h[o-a-1]%10|0;else if((u=d((i+1)/w))>=f.length){if(!r)break t;for(;f.length<=u;f.push(0));l=c=0,o=1,a=(i%=w)-w+1}else{for(l=s=f[u],o=1;s>=10;s/=10,o++);c=(a=(i%=w)-w+o)<0?0:l/h[o-a-1]%10|0}if(r=r||e<0||null!=f[u+1]||(a<0?l:l%h[o-a-1]),r=n<4?(c||r)&&(0==n||n==(t.s<0?3:2)):c>5||5==c&&(4==n||r||6==n&&(i>0?a>0?l/h[o-a]:0:f[u-1])%10&1||n==(t.s<0?8:7)),e<1||!f[0])return f.length=0,r?(e-=t.e+1,f[0]=h[(w-e%w)%w],t.e=-e||0):f[0]=t.e=0,t;if(0==i?(f.length=u,s=1,u--):(f.length=u+1,s=h[w-i],f[u]=a>0?p(l/h[o-a]%h[a])*s:0),r)for(;;){if(0==u){for(i=1,a=f[0];a>=10;a/=10,i++);for(a=f[0]+=s,s=1;a>=10;a/=10,s++);i!=s&&(t.e++,f[0]==b&&(f[0]=1));break}if(f[u]+=s,f[u]!=b)break;f[u--]=0,s=1}for(i=f.length;0===f[--i];f.pop());}t.e>V?t.c=t.e=null:t.e<W&&(t.c=[t.e=0])}return t}var x,j,I=0,D=f.prototype,P=new f(1),L=20,H=4,F=-7,B=21,W=-1e7,V=1e7,U=!0,Y=M,z=!1,G=1,X=0,q={decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:"",fractionGroupSize:0};return f.another=t,f.ROUND_UP=0,f.ROUND_DOWN=1,f.ROUND_CEIL=2,f.ROUND_FLOOR=3,f.ROUND_HALF_UP=4,f.ROUND_HALF_DOWN=5,f.ROUND_HALF_EVEN=6,f.ROUND_HALF_CEIL=7,f.ROUND_HALF_FLOOR=8,f.EUCLID=9,f.config=f.set=function(){var t,e,n=0,r={},o=arguments,s=o[0],l=s&&"object"==typeof s?function(){if(s.hasOwnProperty(e))return null!=(t=s[e])}:function(){if(o.length>n)return null!=(t=o[n++])};return l(e="DECIMAL_PLACES")&&Y(t,0,S,2,e)&&(L=0|t),r[e]=L,l(e="ROUNDING_MODE")&&Y(t,0,8,2,e)&&(H=0|t),r[e]=H,l(e="EXPONENTIAL_AT")&&(a(t)?Y(t[0],-S,0,2,e)&&Y(t[1],0,S,2,e)&&(F=0|t[0],B=0|t[1]):Y(t,-S,S,2,e)&&(F=-(B=0|(t<0?-t:t)))),r[e]=[F,B],l(e="RANGE")&&(a(t)?Y(t[0],-S,-1,2,e)&&Y(t[1],1,S,2,e)&&(W=0|t[0],V=0|t[1]):Y(t,-S,S,2,e)&&(0|t?W=-(V=0|(t<0?-t:t)):U&&N(2,e+" cannot be zero",t))),r[e]=[W,V],l(e="ERRORS")&&(t===!!t||1===t||0===t?(I=0,Y=(U=!!t)?M:i):U&&N(2,e+g,t)),r[e]=U,l(e="CRYPTO")&&(!0===t||!1===t||1===t||0===t?t?!(t="undefined"==typeof crypto)&&crypto&&(crypto.getRandomValues||crypto.randomBytes)?z=!0:U?N(2,"crypto unavailable",t?void 0:crypto):z=!1:z=!1:U&&N(2,e+g,t)),r[e]=z,l(e="MODULO_MODE")&&Y(t,0,9,2,e)&&(G=0|t),r[e]=G,l(e="POW_PRECISION")&&Y(t,0,S,2,e)&&(X=0|t),r[e]=X,l(e="FORMAT")&&("object"==typeof t?q=t:U&&N(2,e+" not an object",t)),r[e]=q,r},f.max=function(){return T(arguments,D.lt)},f.min=function(){return T(arguments,D.gt)},f.random=function(){var t=9007199254740992*Math.random()&2097151?function(){return p(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(e){var n,r,o,i,a,s=0,l=[],u=new f(P);if(e=null!=e&&Y(e,0,S,14)?0|e:L,i=d(e/w),z)if(crypto.getRandomValues){for(n=crypto.getRandomValues(new Uint32Array(i*=2));s<i;)(a=131072*n[s]+(n[s+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),n[s]=r[0],n[s+1]=r[1]):(l.push(a%1e14),s+=2);s=i/2}else if(crypto.randomBytes){for(n=crypto.randomBytes(i*=7);s<i;)(a=281474976710656*(31&n[s])+1099511627776*n[s+1]+4294967296*n[s+2]+16777216*n[s+3]+(n[s+4]<<16)+(n[s+5]<<8)+n[s+6])>=9e15?crypto.randomBytes(7).copy(n,s):(l.push(a%1e14),s+=7);s=i/7}else z=!1,U&&N(14,"crypto unavailable",crypto);if(!z)for(;s<i;)(a=t())<9e15&&(l[s++]=a%1e14);for(i=l[--s],e%=w,i&&e&&(a=O[w-e],l[s]=p(i/a)*a);0===l[s];l.pop(),s--);if(s<0)l=[o=0];else{for(o=-1;0===l[0];l.splice(0,1),o-=w);for(s=1,a=l[0];a>=10;a/=10,s++);s<w&&(o-=w-s)}return u.e=o,u.c=l,u}}(),x=function(){function t(t,e,n){var r,o,i,a,s=0,l=t.length,u=e%E,c=e/E|0;for(t=t.slice();l--;)s=((o=u*(i=t[l]%E)+(r=c*i+(a=t[l]/E|0)*u)%E*E+s)/n|0)+(r/E|0)+c*a,t[l]=o%n;return s&&(t=[s].concat(t)),t}function e(t,e,n,r){var o,i;if(n!=r)i=n>r?1:-1;else for(o=i=0;o<n;o++)if(t[o]!=e[o]){i=t[o]>e[o]?1:-1;break}return i}function r(t,e,n,r){for(var o=0;n--;)t[n]-=o,o=t[n]<e[n]?1:0,t[n]=o*r+t[n]-e[n];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(o,i,a,s,l){var u,c,h,d,g,v,y,m,C,O,E,S,k,R,T,M,_,N=o.s==i.s?1:-1,x=o.c,j=i.c;if(!(x&&x[0]&&j&&j[0]))return new f(o.s&&i.s&&(x?!j||x[0]!=j[0]:j)?x&&0==x[0]||!j?0*N:N/0:NaN);for(C=(m=new f(N)).c=[],N=a+(c=o.e-i.e)+1,l||(l=b,c=n(o.e/w)-n(i.e/w),N=N/w|0),h=0;j[h]==(x[h]||0);h++);if(j[h]>(x[h]||0)&&c--,N<0)C.push(1),d=!0;else{for(R=x.length,M=j.length,h=0,N+=2,(g=p(l/(j[0]+1)))>1&&(j=t(j,g,l),x=t(x,g,l),M=j.length,R=x.length),k=M,E=(O=x.slice(0,M)).length;E<M;O[E++]=0);_=j.slice(),_=[0].concat(_),T=j[0],j[1]>=l/2&&T++;do{if(g=0,(u=e(j,O,M,E))<0){if(S=O[0],M!=E&&(S=S*l+(O[1]||0)),(g=p(S/T))>1)for(g>=l&&(g=l-1),y=(v=t(j,g,l)).length,E=O.length;1==e(v,O,y,E);)g--,r(v,M<y?_:j,y,l),y=v.length,u=1;else 0==g&&(u=g=1),y=(v=j.slice()).length;if(y<E&&(v=[0].concat(v)),r(O,v,E,l),E=O.length,-1==u)for(;e(j,O,M,E)<1;)g++,r(O,M<E?_:j,E,l),E=O.length}else 0===u&&(g++,O=[0]);C[h++]=g,O[0]?O[E++]=x[k]||0:(O=[x[k]],E=1)}while((k++<R||null!=O[0])&&N--);d=null!=O[0],C[0]||C.splice(0,1)}if(l==b){for(h=1,N=C[0];N>=10;N/=10,h++);A(m,a+(m.e=h+c*w-1)+1,s,d)}else m.e=c,m.r=+d;return m}}(),j=function(){var t=/^(-?)0([xbo])(?=\w[\w.]*$)/i,e=/^([^.]+)\.$/,n=/^\.([^.]+)$/,r=/^-?(Infinity|NaN)$/,o=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(i,a,s,l){var u,c=s?a:a.replace(o,"");if(r.test(c))i.s=isNaN(c)?null:c<0?-1:1;else{if(!s&&(c=c.replace(t,function(t,e,n){return u="x"==(n=n.toLowerCase())?16:"b"==n?2:8,l&&l!=u?t:e}),l&&(u=l,c=c.replace(e,"$1").replace(n,"0.$1")),a!=c))return new f(c,u);U&&N(I,"not a"+(l?" base "+l:"")+" number",a),i.s=null}i.c=i.e=null,I=0}}(),D.absoluteValue=D.abs=function(){var t=new f(this);return t.s<0&&(t.s=1),t},D.ceil=function(){return A(new f(this),this.e+1,2)},D.comparedTo=D.cmp=function(t,e){return I=1,o(this,new f(t,e))},D.decimalPlaces=D.dp=function(){var t,e,r=this.c;if(!r)return null;if(t=((e=r.length-1)-n(this.e/w))*w,e=r[e])for(;e%10==0;e/=10,t--);return t<0&&(t=0),t},D.dividedBy=D.div=function(t,e){return I=3,x(this,new f(t,e),L,H)},D.dividedToIntegerBy=D.divToInt=function(t,e){return I=4,x(this,new f(t,e),0,1)},D.equals=D.eq=function(t,e){return I=5,0===o(this,new f(t,e))},D.floor=function(){return A(new f(this),this.e+1,3)},D.greaterThan=D.gt=function(t,e){return I=6,o(this,new f(t,e))>0},D.greaterThanOrEqualTo=D.gte=function(t,e){return I=7,1===(e=o(this,new f(t,e)))||0===e},D.isFinite=function(){return!!this.c},D.isInteger=D.isInt=function(){return!!this.c&&n(this.e/w)>this.c.length-2},D.isNaN=function(){return!this.s},D.isNegative=D.isNeg=function(){return this.s<0},D.isZero=function(){return!!this.c&&0==this.c[0]},D.lessThan=D.lt=function(t,e){return I=8,o(this,new f(t,e))<0},D.lessThanOrEqualTo=D.lte=function(t,e){return I=9,-1===(e=o(this,new f(t,e)))||0===e},D.minus=D.sub=function(t,e){var r,o,i,a,s=this,l=s.s;if(I=10,t=new f(t,e),e=t.s,!l||!e)return new f(NaN);if(l!=e)return t.s=-e,s.plus(t);var u=s.e/w,c=t.e/w,h=s.c,d=t.c;if(!u||!c){if(!h||!d)return h?(t.s=-e,t):new f(d?s:NaN);if(!h[0]||!d[0])return d[0]?(t.s=-e,t):new f(h[0]?s:3==H?-0:0)}if(u=n(u),c=n(c),h=h.slice(),l=u-c){for((a=l<0)?(l=-l,i=h):(c=u,i=d),i.reverse(),e=l;e--;i.push(0));i.reverse()}else for(o=(a=(l=h.length)<(e=d.length))?l:e,l=e=0;e<o;e++)if(h[e]!=d[e]){a=h[e]<d[e];break}if(a&&(i=h,h=d,d=i,t.s=-t.s),(e=(o=d.length)-(r=h.length))>0)for(;e--;h[r++]=0);for(e=b-1;o>l;){if(h[--o]<d[o]){for(r=o;r&&!h[--r];h[r]=e);--h[r],h[o]+=b}h[o]-=d[o]}for(;0==h[0];h.splice(0,1),--c);return h[0]?_(t,h,c):(t.s=3==H?-1:1,t.c=[t.e=0],t)},D.modulo=D.mod=function(t,e){var n,r,o=this;return I=11,t=new f(t,e),!o.c||!t.s||t.c&&!t.c[0]?new f(NaN):!t.c||o.c&&!o.c[0]?new f(o):(9==G?(r=t.s,t.s=1,n=x(o,t,0,3),t.s=r,n.s*=r):n=x(o,t,0,G),o.minus(n.times(t)))},D.negated=D.neg=function(){var t=new f(this);return t.s=-t.s||null,t},D.plus=D.add=function(t,e){var r,o=this,i=o.s;if(I=12,t=new f(t,e),e=t.s,!i||!e)return new f(NaN);if(i!=e)return t.s=-e,o.minus(t);var a=o.e/w,s=t.e/w,l=o.c,u=t.c;if(!a||!s){if(!l||!u)return new f(i/0);if(!l[0]||!u[0])return u[0]?t:new f(l[0]?o:0*i)}if(a=n(a),s=n(s),l=l.slice(),i=a-s){for(i>0?(s=a,r=u):(i=-i,r=l),r.reverse();i--;r.push(0));r.reverse()}for((i=l.length)-(e=u.length)<0&&(r=u,u=l,l=r,e=i),i=0;e;)i=(l[--e]=l[e]+u[e]+i)/b|0,l[e]=b===l[e]?0:l[e]%b;return i&&(l=[i].concat(l),++s),_(t,l,s)},D.precision=D.sd=function(t){var e,n,r=this,o=r.c;if(null!=t&&t!==!!t&&1!==t&&0!==t&&(U&&N(13,"argument"+g,t),t!=!!t&&(t=null)),!o)return null;if(n=o.length-1,e=n*w+1,n=o[n]){for(;n%10==0;n/=10,e--);for(n=o[0];n>=10;n/=10,e++);}return t&&r.e+1>e&&(e=r.e+1),e},D.round=function(t,e){var n=new f(this);return(null==t||Y(t,0,S,15))&&A(n,~~t+this.e+1,null!=e&&Y(e,0,8,15,v)?0|e:H),n},D.shift=function(t){var e=this;return Y(t,-C,C,16,"argument")?e.times("1e"+c(t)):new f(e.c&&e.c[0]&&(t<-C||t>C)?e.s*(t<0?0:1/0):e)},D.squareRoot=D.sqrt=function(){var t,e,o,i,a,s=this,l=s.c,u=s.s,c=s.e,h=L+4,d=new f("0.5");if(1!==u||!l||!l[0])return new f(!u||u<0&&(!l||l[0])?NaN:l?s:1/0);if(0==(u=Math.sqrt(+s))||u==1/0?(((e=r(l)).length+c)%2==0&&(e+="0"),u=Math.sqrt(e),c=n((c+1)/2)-(c<0||c%2),o=new f(e=u==1/0?"1e"+c:(e=u.toExponential()).slice(0,e.indexOf("e")+1)+c)):o=new f(u+""),o.c[0])for((u=(c=o.e)+h)<3&&(u=0);;)if(a=o,o=d.times(a.plus(x(s,a,h,1))),r(a.c).slice(0,u)===(e=r(o.c)).slice(0,u)){if(o.e<c&&--u,"9999"!=(e=e.slice(u-3,u+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(A(o,o.e+L+2,1),t=!o.times(o).eq(s));break}if(!i&&(A(a,a.e+L+2,0),a.times(a).eq(s))){o=a;break}h+=4,u+=4,i=1}return A(o,o.e+L+1,H,t)},D.times=D.mul=function(t,e){var r,o,i,a,s,l,u,c,h,d,p,g,v,y,m,C=this,O=C.c,S=(I=17,t=new f(t,e)).c;if(!(O&&S&&O[0]&&S[0]))return!C.s||!t.s||O&&!O[0]&&!S||S&&!S[0]&&!O?t.c=t.e=t.s=null:(t.s*=C.s,O&&S?(t.c=[0],t.e=0):t.c=t.e=null),t;for(o=n(C.e/w)+n(t.e/w),t.s*=C.s,(u=O.length)<(d=S.length)&&(v=O,O=S,S=v,i=u,u=d,d=i),i=u+d,v=[];i--;v.push(0));for(y=b,m=E,i=d;--i>=0;){for(r=0,p=S[i]%m,g=S[i]/m|0,a=i+(s=u);a>i;)r=((c=p*(c=O[--s]%m)+(l=g*c+(h=O[s]/m|0)*p)%m*m+v[a]+r)/y|0)+(l/m|0)+g*h,v[a--]=c%y;v[a]=r}return r?++o:v.splice(0,1),_(t,v,o)},D.toDigits=function(t,e){var n=new f(this);return t=null!=t&&Y(t,1,S,18,"precision")?0|t:null,e=null!=e&&Y(e,0,8,18,v)?0|e:H,t?A(n,t,e):n},D.toExponential=function(t,e){return R(this,null!=t&&Y(t,0,S,19)?1+~~t:null,e,19)},D.toFixed=function(t,e){return R(this,null!=t&&Y(t,0,S,20)?~~t+this.e+1:null,e,20)},D.toFormat=function(t,e){var n=R(this,null!=t&&Y(t,0,S,21)?~~t+this.e+1:null,e,21);if(this.c){var r,o=n.split("."),i=+q.groupSize,a=+q.secondaryGroupSize,s=q.groupSeparator,l=o[0],u=o[1],c=this.s<0,f=c?l.slice(1):l,h=f.length;if(a&&(r=i,i=a,a=r,h-=r),i>0&&h>0){for(r=h%i||i,l=f.substr(0,r);r<h;r+=i)l+=s+f.substr(r,i);a>0&&(l+=s+f.slice(r)),c&&(l="-"+l)}n=u?l+q.decimalSeparator+((a=+q.fractionGroupSize)?u.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+q.fractionGroupSeparator):u):l}return n},D.toFraction=function(t){var e,n,o,i,a,s,l,u,c,h=U,d=this,p=d.c,g=new f(P),v=n=new f(P),y=l=new f(P);if(null!=t&&(U=!1,s=new f(t),U=h,(h=s.isInt())&&!s.lt(P)||(U&&N(22,"max denominator "+(h?"out of range":"not an integer"),t),t=!h&&s.c&&A(s,s.e+1,1).gte(P)?s:null)),!p)return d.toString();for(c=r(p),i=g.e=c.length-d.e-1,g.c[0]=O[(a=i%w)<0?w+a:a],t=!t||s.cmp(g)>0?i>0?g:v:s,a=V,V=1/0,s=new f(c),l.c[0]=0;u=x(s,g,0,1),1!=(o=n.plus(u.times(y))).cmp(t);)n=y,y=o,v=l.plus(u.times(o=v)),l=o,g=s.minus(u.times(o=g)),s=o;return o=x(t.minus(n),y,0,1),l=l.plus(o.times(v)),n=n.plus(o.times(y)),l.s=v.s=d.s,e=x(v,y,i*=2,H).minus(d).abs().cmp(x(l,n,i,H).minus(d).abs())<1?[v.toString(),y.toString()]:[l.toString(),n.toString()],V=a,e},D.toNumber=function(){return+this},D.toPower=D.pow=function(t,e){var n,r,o,i=p(t<0?-t:+t),a=this;if(null!=e&&(I=23,e=new f(e)),!Y(t,-C,C,23,"exponent")&&(!isFinite(t)||i>C&&(t/=0)||parseFloat(t)!=t&&!(t=NaN))||0==t)return n=Math.pow(+a,t),new f(e?n%e:n);for(e?t>1&&a.gt(P)&&a.isInt()&&e.gt(P)&&e.isInt()?a=a.mod(e):(o=e,e=null):X&&(n=d(X/w+2)),r=new f(P);;){if(i%2){if(!(r=r.times(a)).c)break;n?r.c.length>n&&(r.c.length=n):e&&(r=r.mod(e))}if(!(i=p(i/2)))break;a=a.times(a),n?a.c&&a.c.length>n&&(a.c.length=n):e&&(a=a.mod(e))}return e?r:(t<0&&(r=P.div(r)),o?r.mod(o):n?A(r,X,H):r)},D.toPrecision=function(t,e){return R(this,null!=t&&Y(t,1,S,24,"precision")?0|t:null,e,24)},D.toString=function(t){var e,n=this,o=n.s,i=n.e;return null===i?o?(e="Infinity",o<0&&(e="-"+e)):e="NaN":(e=r(n.c),e=null!=t&&Y(t,2,64,25,"base")?k(u(e,i),0|t,10,o):i<=F||i>=B?l(e,i):u(e,i),o<0&&n.c[0]&&(e="-"+e)),e},D.truncated=D.trunc=function(){return A(new f(this),this.e+1,1)},D.valueOf=D.toJSON=function(){var t,e=this,n=e.e;return null===n?e.toString():(t=r(e.c),t=n<=F||n>=B?l(t,n):u(t,n),e.s<0?"-"+t:t)},D.isBigNumber=!0,null!=e&&f.config(e),f}()).default=f.BigNumber=f,void 0!==e&&e.exports?e.exports=f:(t||(t="undefined"!=typeof self?self:Function("return this")()),t.BigNumber=f)}(this)},{}],2:[function(t,e,n){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,n){"use strict";function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];if("string"==typeof e&&(e=g.parseFormat(e)),!p.validateFormat(e))return"ERROR: invalid format";var r=e.prefix||"",i=e.postfix||"",a=function(t,e,n){switch(e.output){case"currency":return e=f(e,d.currentCurrencyDefaultFormat()),function(t,e,n){var r=n.currentCurrency(),o=Object.assign({},m,e),i=void 0,a="",s=!!o.totalLength||!!o.forceAverage||o.average,l=e.currencyPosition||r.position,u=e.currencySymbol||r.symbol;o.spaceSeparated&&(a=" "),"infix"===l&&(i=a+u+a);var f=c({instance:t,providedFormat:e,state:n,decimalSeparator:i});return"prefix"===l&&(f=t._value<0&&"sign"===o.negative?"-"+a+u+f.slice(1):u+a+f),l&&"postfix"!==l||(f=f+(a=s?"":a)+u),f}(t,e,d);case"percent":return e=f(e,d.currentPercentageDefaultFormat()),function(t,e,n,r){var o=e.prefixSymbol,i=c({instance:r(100*t._value),providedFormat:e,state:n}),a=Object.assign({},m,e);return o?"%"+(a.spaceSeparated?" ":"")+i:i+(a.spaceSeparated?" ":"")+"%"}(t,e,d,n);case"byte":return e=f(e,d.currentByteDefaultFormat()),function(t,e,n,r){var i=e.base||"binary",a=y[i],s=o(t._value,a.suffixes,a.scale),l=s.value,u=s.suffix;return c({instance:r(l),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})+(n.currentAbbreviations().spaced?" ":"")+u}(t,e,d,n);case"time":return e=f(e,d.currentTimeDefaultFormat()),function(t){var e=Math.floor(t._value/60/60),n=Math.floor((t._value-60*e*60)/60),r=Math.round(t._value-60*e*60-60*n);return e+":"+(n<10?"0":"")+n+":"+(r<10?"0":"")+r}(t);case"ordinal":return e=f(e,d.currentOrdinalDefaultFormat()),function(t,e,n){var r=n.currentOrdinal(),o=Object.assign({},m,e),i=c({instance:t,providedFormat:e,state:n}),a=r(t._value);return i+(o.spaceSeparated?" ":"")+a}(t,e,d);case"number":default:return c({instance:t,providedFormat:e,numbro:n})}}(t,e,n);return a=function(t,e){return t+e}(a=function(t,e){return e+t}(a,r),i)}function o(t,e,n){var r=e[0],o=Math.abs(t);if(o>=n){for(var i=1;i<e.length;++i){var a=Math.pow(n,i),s=Math.pow(n,i+1);if(o>=a&&o<s){r=e[i],t/=a;break}}r===e[0]&&(t/=Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function i(t){var e=t.value,n=t.characteristicPrecision,r=void 0===n?0:n,o=e.toExponential().split("e"),i=h(o,2),a=i[0],s=i[1],l=+a;return r?(1<r&&(l*=Math.pow(10,r-1),s=(s=+s-(r-1))>=0?"+"+s:s),{value:l,abbreviation:"e"+s}):{value:l,abbreviation:"e"+s}}function a(t){for(var e="",n=0;n<t;n++)e+="0";return e}function s(t,e){return-1!==t.toString().indexOf("e")?function(t,e){var n=t.toString(),r=n.split("e"),o=h(r,2),i=o[0],s=o[1],l=i.split("."),u=h(l,2),c=u[0],f=u[1],d=void 0===f?"":f;if(+s>0)n=c+d+a(s-d.length);else{var p=".";p=+c<0?"-0"+p:"0"+p;var g=(a(-s-1)+Math.abs(c)+d).substr(0,e);g.length<e&&(g+=a(e-g.length)),n=p+g}return+s>0&&e>0&&(n+="."+a(e)),n}(t,e):(Math.round(+(t+"e+"+e))/Math.pow(10,e)).toFixed(e)}function l(t,e,n,r,o){if(-1===r)return t;var i=s(e,r),a=i.toString().split("."),l=h(a,2),u=l[0],c=l[1],f=void 0===c?"":c;if(f.match(/^0+$/)&&(n||o))return u;var d=f.match(/0+$/);return o&&d?u+"."+f.toString().slice(0,d.index):i.toString()}function u(t,e,n,r){var o=t,i=o.toString().split("."),a=h(i,2),s=a[0],l=a[1];if(s.match(/^-?0$/)&&n)return l?s.replace("0","")+"."+l:s.replace("0","");if(s.length<r)for(var u=r-s.length,c=0;c<u;c++)o="0"+o;return o.toString()}function c(t){var e=t.instance,n=t.providedFormat,r=t.state,o=void 0===r?d:r,a=t.decimalSeparator,s=t.defaults,c=void 0===s?o.currentDefaults():s,f=e._value;if(0===f&&o.hasZeroFormat())return o.getZeroFormat();if(!isFinite(f))return f.toString();var h=Object.assign({},m,c,n),p=h.totalLength,g=p?0:h.characteristic,v=h.optionalCharacteristic,y=h.forceAverage,b=!!p||!!y||h.average,w=p?-1:b&&void 0===n.mantissa?0:h.mantissa,C=!p&&(void 0===n.optionalMantissa?-1===w:h.optionalMantissa),O=h.trimMantissa,E=h.thousandSeparated,S=h.spaceSeparated,k=h.negative,R=h.forceSign,T=h.exponential,M="";if(b){var _=function(t){var e=t.value,n=t.forceAverage,r=t.abbreviations,o=t.spaceSeparated,i=void 0!==o&&o,a=t.totalLength,s=void 0===a?0:a,l="",u=Math.abs(e),c=-1;u>=Math.pow(10,12)&&!n||"trillion"===n?(l=r.trillion,e/=Math.pow(10,12)):u<Math.pow(10,12)&&u>=Math.pow(10,9)&&!n||"billion"===n?(l=r.billion,e/=Math.pow(10,9)):u<Math.pow(10,9)&&u>=Math.pow(10,6)&&!n||"million"===n?(l=r.million,e/=Math.pow(10,6)):(u<Math.pow(10,6)&&u>=Math.pow(10,3)&&!n||"thousand"===n)&&(l=r.thousand,e/=Math.pow(10,3));var f=i?" ":"";if(l&&(l=f+l),s){var h=e.toString().split(".")[0];c=Math.max(s-h.length,0)}return{value:e,abbreviation:l,mantissaPrecision:c}}({value:f,forceAverage:y,abbreviations:o.currentAbbreviations(),spaceSeparated:S,totalLength:p});f=_.value,M+=_.abbreviation,p&&(w=_.mantissaPrecision)}if(T){var N=i({value:f,characteristicPrecision:g});f=N.value,M=N.abbreviation+M}var A=l(f.toString(),f,C,w,O);return A=function(t,e,n,r,o){var i=r.currentDelimiters(),a=i.thousands;o=o||i.decimal;var s=i.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];return n&&(e<0&&(u=u.slice(1)),function(t,e){for(var n=[],r=0,o=t;o>0;o--)r===e&&(n.unshift(o),r=0),r++;return n}(u.length,s).forEach(function(t,e){u=u.slice(0,t+e)+a+u.slice(t+e)}),e<0&&(u="-"+u)),c?u+o+c:u}(A=u(A,0,v,g),f,E,o,a),(b||T)&&(A=function(t,e){return t+e}(A,M)),(R||f<0)&&(A=function(t,e,n){return 0===e?t:0==+t?t.replace("-",""):e>0?"+"+t:"sign"===n?t:"("+t.replace("-","")+")"}(A,f,k)),A}function f(t,e){if(!t)return e;var n=Object.keys(t);return 1===n.length&&"output"===n[0]?e:t}var h=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},d=t("./globalState"),p=t("./validating"),g=t("./parsing"),v=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],y={general:{scale:1024,suffixes:v,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:v,marker:"d"}},m={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};e.exports=function(t){return{format:function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return r.apply(void 0,n.concat([t]))},getByteUnit:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(t){var e=y.general;return o(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(t){var e=y.binary;return o(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(t){var e=y.decimal;return o(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},formatOrDefault:f}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,n){"use strict";function r(t){u=t}function o(){return c[u]}var i=t("./en-US"),a=t("./validating"),s=t("./parsing"),l={},u=void 0,c={},f=null,h={};l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return o().currency},l.currentAbbreviations=function(){return o().abbreviations},l.currentDelimiters=function(){return o().delimiters},l.currentOrdinal=function(){return o().ordinal},l.currentDefaults=function(){return Object.assign({},o().defaults,h)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),o().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),o().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),o().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),o().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),o().timeFormat)},l.setDefaults=function(t){t=s.parseFormat(t),a.validateFormat(t)&&(h=t)},l.getZeroFormat=function(){return f},l.setZeroFormat=function(t){return f="string"==typeof t?t:null},l.hasZeroFormat=function(){return null!==f},l.languageData=function(t){if(t){if(c[t])return c[t];throw new Error('Unknown tag "'+t+'"')}return o()},l.registerLanguage=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!a.validateLanguage(t))throw new Error("Invalid language data");c[t.languageTag]=t,e&&r(t.languageTag)},l.setLanguage=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.languageTag;if(!c[t]){var n=t.split("-")[0],o=Object.keys(c).find(function(t){return t.split("-")[0]===n});return c[o]?void r(o):void r(e)}r(t)},l.registerLanguage(i),u=i.languageTag,e.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,n){"use strict";function r(e,n){e.forEach(function(e){var r=void 0;try{r=t("../languages/"+e)}catch(t){console.error('Unable to load "'+e+'". No matching language file found.')}r&&n.registerLanguage(r)})}e.exports=function(t){return{loadLanguagesInNode:function(e){return r(e,t)}}}},{}],6:[function(t,e,n){"use strict";function r(t,e,n){var r=new o(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new o(i),t._value=r.minus(i).toNumber(),t}var o=t("bignumber.js");e.exports=function(t){return{add:function(e,n){return function(t,e,n){var r=new o(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new o(i),t._value=r.add(i).toNumber(),t}(e,n,t)},subtract:function(e,n){return r(e,n,t)},multiply:function(e,n){return function(t,e,n){var r=new o(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new o(i),t._value=r.times(i).toNumber(),t}(e,n,t)},divide:function(e,n){return function(t,e,n){var r=new o(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new o(i),t._value=r.dividedBy(i).toNumber(),t}(e,n,t)},set:function(e,n){return function(t,e,n){var r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}(e,n,t)},difference:function(e,n){return function(t,e,n){var o=n(t._value);return r(o,e,n),Math.abs(o._value)}(e,n,t)}}}},{"bignumber.js":1}],7:[function(t,e,n){"use strict";function r(t){var e=t;return o.isNumbro(t)?e=t._value:"string"==typeof t?e=o.unformat(t):isNaN(t)&&(e=NaN),e}function o(t){return new d(r(t))}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=t("./globalState"),s=t("./validating"),l=t("./loading")(o),u=t("./unformatting"),c=t("./formatting")(o),f=t("./manipulating")(o),h=t("./parsing"),d=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._value=e}return i(t,[{key:"clone",value:function(){return o(this._value)}},{key:"format",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.format(this,t)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=h.parseFormat(t)),(t=c.formatOrDefault(t,a.currentCurrencyDefaultFormat())).output="currency",c.format(this,t)}},{key:"formatTime",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",c.format(this,t)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(t){return f.difference(this,t)}},{key:"add",value:function(t){return f.add(this,t)}},{key:"subtract",value:function(t){return f.subtract(this,t)}},{key:"multiply",value:function(t){return f.multiply(this,t)}},{key:"divide",value:function(t){return f.divide(this,t)}},{key:"set",value:function(t){return f.set(this,r(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}]),t}();o.version="2.1.1",o.isNumbro=function(t){return t instanceof d},o.language=a.currentLanguage,o.registerLanguage=a.registerLanguage,o.setLanguage=a.setLanguage,o.languages=a.languages,o.languageData=a.languageData,o.zeroFormat=a.setZeroFormat,o.defaultFormat=a.currentDefaults,o.setDefaults=a.setDefaults,o.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,o.validate=s.validate,o.loadLanguagesInNode=l.loadLanguagesInNode,o.unformat=u.unformat,e.exports=o},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,n){"use strict";e.exports={parseFormat:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return-1!==t.indexOf("bd")?(e.output="byte",void(e.base="general")):-1!==t.indexOf("b")?(e.output="byte",void(e.base="binary")):-1!==t.indexOf("d")?(e.output="byte",void(e.base="decimal")):void(-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time");e.output="percent"}else e.output="currency"}(t=function(t,e){var n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}(t=function(t,e){var n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}(t,e),e),e),function(t,e){var n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}(t,e),function(t,e){var n=t.split(".")[0].match(/0+/);n&&(e.characteristic=n[0].length)}(t,e),function(t,e){if(-1!==t.indexOf(".")){var n=t.split(".")[0];e.optionalCharacteristic=-1===n.indexOf("0")}}(t,e),function(t,e){-1!==t.indexOf("a")&&(e.average=!0)}(t,e),function(t,e){-1!==t.indexOf("K")?e.forceAverage="thousand":-1!==t.indexOf("M")?e.forceAverage="million":-1!==t.indexOf("B")?e.forceAverage="billion":-1!==t.indexOf("T")&&(e.forceAverage="trillion")}(t,e),function(t,e){var n=t.split(".")[1];if(n){var r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}(t,e),function(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}(t,e),function(t,e){-1!==t.indexOf(",")&&(e.thousandSeparated=!0)}(t,e),function(t,e){-1!==t.indexOf(" ")&&(e.spaceSeparated=!0)}(t,e),function(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}(t,e),function(t,e){t.match(/^\+/)&&(e.forceSign=!0)}(t,e),e)}}},{}],9:[function(t,e,n){"use strict";function r(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments[3],a=arguments[4],l=arguments[5],u=arguments[6];if(!isNaN(+t))return+t;var c="",f=t.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(f!==t)return-1*o(f,e,n,i,a,l,u);for(var h=0;h<s.length;h++){var d=s[h];if((c=t.replace(d.key,""))!==t)return o(c,e,n,i,a,l,u)*d.factor}if((c=t.replace("%",""))!==t)return o(c,e,n,i,a,l,u)/100;var p=parseFloat(t);if(!isNaN(p)){var g=i(p);if(g&&"."!==g&&(c=t.replace(new RegExp(r(g)+"$"),""))!==t)return o(c,e,n,i,a,l,u);var v={};Object.keys(l).forEach(function(t){v[l[t]]=t});for(var y=Object.keys(v).sort().reverse(),m=y.length,b=0;b<m;b++){var w=y[b],C=v[w];if((c=t.replace(w,""))!==t){var O=void 0;switch(C){case"thousand":O=Math.pow(10,3);break;case"million":O=Math.pow(10,6);break;case"billion":O=Math.pow(10,9);break;case"trillion":O=Math.pow(10,12)}return o(c,e,n,i,a,l,u)*O}}}}function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=t.replace(n,"");return o=(o=o.replace(new RegExp("([0-9])"+r(e.thousands)+"([0-9])","g"),"$1$2")).replace(e.decimal,".")}function a(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments[3],a=arguments[4],s=arguments[5],l=arguments[6];if(""!==t)return isNaN(+t)?t===a?0:o(i(t,e,n),e,n,r,a,s,l):+t}var s=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];e.exports={unformat:function(e,n){var r=t("./globalState"),o=r.currentDelimiters(),i=r.currentCurrency().symbol,s=r.currentOrdinal(),l=r.getZeroFormat(),u=r.currentAbbreviations(),c=void 0;if("string"==typeof e)c=function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var n=t.split(":");if(3!==n.length)return!1;var r=+n[0],o=+n[1],i=+n[2];return!isNaN(r)&&!isNaN(o)&&!isNaN(i)}(e,o)?function(t){var e=t.split(":"),n=+e[0],r=+e[1];return+e[2]+60*r+3600*n}(e):a(e,o,i,s,l,u,n);else{if("number"!=typeof e)return;c=e}if(void 0!==c)return c}}},{"./globalState":4}],10:[function(t,e,n){"use strict";function r(t){return!!s.unformat(t)}function o(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Object.keys(t).map(function(r){if(!e[r])return console.error(n+" Invalid key: "+r),!1;var i=t[r],s=e[r];if("string"==typeof s&&(s={type:s}),"format"===s.type){if(!o(i,u,"[Validate "+r+"]",!0))return!1}else if((void 0===i?"undefined":a(i))!==s.type)return console.error(n+" "+r+' type mismatched: "'+s.type+'" expected, "'+(void 0===i?"undefined":a(i))+'" provided'),!1;if(s.restrictions&&s.restrictions.length)for(var l=s.restrictions.length,c=0;c<l;c++){var f=s.restrictions[c],h=f.restriction,d=f.message;if(!h(i,t))return console.error(n+" "+r+" invalid value: "+d),!1}return s.restriction&&!s.restriction(i,t)?(console.error(n+" "+r+" invalid value: "+s.message),!1):s.validValues&&-1===s.validValues.indexOf(i)?(console.error(n+" "+r+" invalid value: must be among "+JSON.stringify(s.validValues)+', "'+i+'" provided'),!1):!(s.children&&!o(i,s.children,"[Validate "+r+"]"))});return r||i.push.apply(i,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(Object.keys(e).map(function(r){var o=e[r];if("string"==typeof o&&(o={type:o}),o.mandatory){var i=o.mandatory;if("function"==typeof i&&(i=i(t)),i&&void 0===t[r])return console.error(n+' Missing mandatory key "'+r+'"'),!1}return!0}))),i.reduce(function(t,e){return t&&e},!0)}function i(t){return o(t,u,"[Validate format]")}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=t("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return t>=0},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return t>=0},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return t>=0},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};e.exports={validate:function(t,e){var n=r(t),o=i(e);return n&&o},validateFormat:i,validateInput:r,validateLanguage:function(t){return o(t,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r,o,i,a=n(161),s=n(49),l=n(67),u=n(55),c=n(112),f=n(96),h=n(41).WeakMap;if(a){var d=new h,p=d.get,g=d.has,v=d.set;r=function(t,e){return v.call(d,t,e),e},o=function(t){return p.call(d,t)||{}},i=function(t){return g.call(d,t)}}else{var y=c("state");f[y]=!0,r=function(t,e){return l(t,y,e),e},o=function(t){return u(t,y)?t[y]:{}},i=function(t){return u(t,y)}}t.exports={set:r,get:o,has:i,enforce:function(t){return i(t)?o(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!s(e)||(n=o(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){"use strict";(function(t,r){n.d(e,"a",function(){return H});n(10),n(11),n(12),n(24),n(29),n(21),n(7),n(76),n(43),n(79),n(80),n(6),n(26),n(8),n(52),n(9),n(213),n(45);var o=n(0),i=n(82),a=n(28),s=n(30),l=n(13),u=n(40),c=n(193),f=n(189),h=n(20),d=n(2),p=n(1),g=n(15),v=n(38),y=n(51),m=n(36),b=n(4),w=n(190),C=n(191),O=n(66),E=n(65),S=n(88),k=n(5),R=n(16),T=n(131),M=n(77),_=n(132),N=n(69),A=n(93),x=n(74),j=n(89);function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function P(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var L=null;function H(e,n){var H,F,B,W,V,U=this,Y=arguments.length>2&&void 0!==arguments[2]&&arguments[2],z=!1,G=this,X=function(){},q=new h.a(G);Object(d.extend)(X.prototype,T.a.prototype),Object(d.extend)(X.prototype,n),Object(d.extend)(X.prototype,et(n)),Object(A.a)(X.prototype,n.language),Object(S.a)(Y)&&Object(S.c)(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Object(x.b)(this.rootDocument),this.isDestroyed=!1,this.isHotTableEnv=Object(o.isChildOfWebComponentTable)(this.rootElement),h.a.isHotTableEnv=this.isHotTableEnv,this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),Object(S.b)(this)&&Object(l._injectProductInfo)(n.licenseKey,e),this.guid="ht_".concat(Object(m.randomString)());var K=Object(E.a)(G);B=new C.a(G),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),H={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width","language"],settings:new X,selRange:null,isPopulated:null,scrollable:null,firstRun:!0};var $=new j.a(H.settings,{countCols:function(){return G.countCols()},countRows:function(){return G.countRows()},propToCol:function(t){return F.propToCol(t)},isEditorOpened:function(){return!!G.getActiveEditor()&&G.getActiveEditor().isOpened()}});function Z(){var t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function Q(t,e,n){if(t.length){var r=G.runHooks("beforeChange",t,e||"edit");if(Object(a.isFunction)(r))Object(s.b)("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed).");else if(!1===r){var i=G.getActiveEditor();return void(i&&i.cancelChanges())}var l,u,c,f=new Z;f.onQueueEmpty=n;for(var h=t.length-1;h>=0;h--)if(null===t[h])t.splice(h,1);else{var d=D(t[h],4),p=d[0],g=d[1],v=d[3],y=F.propToCol(g),m=G.getCellMeta(p,y);"numeric"===m.type&&"string"==typeof v&&((c=v).length>0&&/^\s*[+-.]?\s*(?:(?:\d+(?:(\.|,)\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/.test(c))&&(t[h][3]=(u=void 0,u=(l=v).replace(",","."),!1===isNaN(parseFloat(u))?parseFloat(u):l)),G.getCellValidator(m)&&(f.addValidatorToQueue(),G.validateCell(t[h][3],m,function(e,n){return function(r){if("boolean"!=typeof r)throw new Error("Validation error: result is not boolean");if(!1===r&&!1===n.allowInvalid){t.splice(e,1),n.valid=!0;var i=G.getCell(n.visualRow,n.visualCol);null!==i&&Object(o.removeClass)(i,G.getSettings().invalidCellClassName)}f.removeValidatorFormQueue()}}(h,m),e))}f.checkIfQueueIsEmpty()}}function J(t,e){var n=t.length-1;if(!(n<0)){for(;n>=0;n--){var r=!1;if(null!==t[n]){if(null!==t[n][2]&&void 0!==t[n][2]||null!==t[n][3]&&void 0!==t[n][3]){if(H.settings.allowInsertRow)for(;t[n][0]>G.countRows()-1;){if(0===F.createRow(void 0,void 0,e)){r=!0;break}}if(!r){if("array"===G.dataType&&(!H.settings.columns||0===H.settings.columns.length)&&H.settings.allowInsertColumn)for(;F.propToCol(t[n][1])>G.countCols()-1;)F.createCol(void 0,void 0,e);F.set(t[n][0],t[n][1],t[n][3])}}}else t.splice(n,1)}G.forceFullRender=!0,W.adjustRowsAndCols(),G.runHooks("beforeChangeRender",t,e),V.lockEditor(),G._refreshBorders(null),V.unlockEditor(),G.view.wt.wtOverlays.adjustElementsSize(),G.runHooks("afterChange",t,e||"edit");var o=G.getActiveEditor();o&&Object(l.isDefined)(o.refreshValue)&&o.refreshValue()}}function tt(t,e,n){return"object"===I(t)?t:[[t,e,n]]}function et(t){if(Object(d.hasOwnProperty)(t,"type")){var e,n={};for(var r in"object"===I(t.type)?e=t.type:"string"==typeof t.type&&(e=Object(M.a)(t.type)),e)Object(d.hasOwnProperty)(e,r)&&!Object(d.hasOwnProperty)(t,r)&&(n[r]=e[r]);return n}}this.selection=$,this.selection.addLocalHook("beforeSetRangeStart",function(t){U.runHooks("beforeSetRangeStart",t)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(t){U.runHooks("beforeSetRangeStartOnly",t)}),this.selection.addLocalHook("beforeSetRangeEnd",function(t){U.runHooks("beforeSetRangeEnd",t),t.row<0&&(t.row=U.view.wt.wtTable.getFirstVisibleRow()),t.col<0&&(t.col=U.view.wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(t){var e=Object(d.createObjectPropListener)(!1),n=U.selection.getSelectedRange(),r=n.current(),i=r.from,a=r.to,s=n.size()-1;U.runHooks("afterSelection",i.row,i.col,a.row,a.col,e,s),U.runHooks("afterSelectionByProp",i.row,G.colToProp(i.col),a.row,G.colToProp(a.col),e,s);var l=U.selection.isSelectedByAnyHeader(),u=U.selection.selectedRange.current(),c=!0;z&&(c=!1),e.isTouched()&&(c=!e.value);var f=U.selection.isSelectedByRowHeader(),h=U.selection.isSelectedByColumnHeader();!1!==c&&(l?f?U.view.scrollViewportVertically(t.row):h&&U.view.scrollViewportHorizontally(t.col):u&&!U.selection.isMultiple()?U.view.scrollViewport(u.from):U.view.scrollViewport(t)),f&&h?Object(o.addClass)(U.rootElement,["ht__selection--rows","ht__selection--columns"]):f?(Object(o.removeClass)(U.rootElement,"ht__selection--columns"),Object(o.addClass)(U.rootElement,"ht__selection--rows")):h?(Object(o.removeClass)(U.rootElement,"ht__selection--rows"),Object(o.addClass)(U.rootElement,"ht__selection--columns")):Object(o.removeClass)(U.rootElement,["ht__selection--rows","ht__selection--columns"]),U._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(t){var e=t.length-1,n=t[e],r=n.from,o=n.to;U.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,e),U.runHooks("afterSelectionEndByProp",r.row,G.colToProp(r.col),o.row,G.colToProp(o.col),e)}),this.selection.addLocalHook("afterIsMultipleSelection",function(t){var e=U.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)}),this.selection.addLocalHook("beforeModifyTransformStart",function(t){U.runHooks("modifyTransformStart",t)}),this.selection.addLocalHook("afterModifyTransformStart",function(t,e,n){U.runHooks("afterModifyTransformStart",t,e,n)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(t){U.runHooks("modifyTransformEnd",t)}),this.selection.addLocalHook("afterModifyTransformEnd",function(t,e,n){U.runHooks("afterModifyTransformEnd",t,e,n)}),this.selection.addLocalHook("afterDeselect",function(){V.destroyEditor(),U._refreshBorders(),Object(o.removeClass)(U.rootElement,["ht__selection--rows","ht__selection--columns"]),U.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(t){U.alter("insert_row",t,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(t){U.alter("insert_col",t,1,"auto")}),W={alter:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;function a(t,e,n,r){var o=Object(p.arrayMap)(new Array(n),function(){return"array"===r?t=[]:"object"===r&&(t={}),t;var t});o.unshift(e,0),t.splice.apply(t,P(o))}var s=function(t){if(0===t.length)return[];var e=P(t);return e.sort(function(t,e){var n=D(t,1)[0],r=D(e,1)[0];return n===r?0:n>r?1:-1}),Object(p.arrayReduce)(e,function(t,e){var n=D(e,2),r=n[0],o=n[1],i=t[t.length-1],a=D(i,2),s=a[0]+a[1];if(r<=s){var l=Math.max(o-(s-r),0);i[1]+=l}else t.push([r,o]);return t},[e[0]])};switch(t){case"insert_row":var u=G.countSourceRows();if(G.getSettings().maxRows===u)return;e=Object(l.isDefined)(e)?e:u,n=F.createRow(e,r,o),a(H.cellSettings,e,r,"array"),n&&($.isSelected()&&$.selectedRange.current().from.row>=e?($.selectedRange.current().from.row+=n,$.transformEnd(n,0)):G._refreshBorders());break;case"insert_col":n=F.createCol(e,r,o);for(var c=0,f=G.countSourceRows();c<f;c++)H.cellSettings[c]&&a(H.cellSettings[c],e,r);if(n){if(Array.isArray(G.getSettings().colHeaders)){var h=[e,0];h.length+=n,Array.prototype.splice.apply(G.getSettings().colHeaders,h)}$.isSelected()&&$.selectedRange.current().from.col>=e?($.selectedRange.current().from.col+=n,$.transformEnd(0,n)):G._refreshBorders()}break;case"remove_row":var d=function(t){var e=0;Object(p.arrayEach)(t,function(t){var n=D(t,2),i=n[0],a=n[1],s=Object(l.isEmpty)(i)?G.countRows()-1:Math.max(i-e,0);Number.isInteger(i)&&(i=Math.max(i-e,0)),F.removeRow(i,a,o),H.cellSettings.splice(s,r);var u=G.countRows(),c=G.getSettings().fixedRowsTop;c>=s+1&&(G.getSettings().fixedRowsTop-=Math.min(a,c-s));var f=G.getSettings().fixedRowsBottom;f&&s>=u-f&&(G.getSettings().fixedRowsBottom-=Math.min(a,f)),e+=a})};Array.isArray(e)?d(s(e)):d([[e,r]]),W.adjustRowsAndCols(),G._refreshBorders();break;case"remove_col":var g=function(t){var e=0;Object(p.arrayEach)(t,function(t){var n=D(t,2),r=n[0],i=n[1],a=Object(l.isEmpty)(r)?G.countCols()-1:Math.max(r-e,0),s=K.toPhysicalColumn(a);Number.isInteger(r)&&(r=Math.max(r-e,0)),F.removeCol(r,i,o);for(var u=0,c=G.countSourceRows();u<c;u++)H.cellSettings[u]&&H.cellSettings[u].splice(s,i);var f=G.getSettings().fixedColumnsLeft;f>=a+1&&(G.getSettings().fixedColumnsLeft-=Math.min(i,f-a)),Array.isArray(G.getSettings().colHeaders)&&(void 0===s&&(s=-1),G.getSettings().colHeaders.splice(s,i)),e+=i})};Array.isArray(e)?g(s(e)):g([[e,r]]),W.adjustRowsAndCols(),G._refreshBorders();break;default:throw new Error('There is no such action "'.concat(t,'"'))}i||W.adjustRowsAndCols()},adjustRowsAndCols:function(){if(H.settings.minRows){var t=G.countRows();if(t<H.settings.minRows)for(var e=0,n=H.settings.minRows;e<n-t;e++)F.createRow(G.countRows(),1,"auto")}if(H.settings.minSpareRows){var r=G.countEmptyRows(!0);if(r<H.settings.minSpareRows)for(;r<H.settings.minSpareRows&&G.countSourceRows()<H.settings.maxRows;r++)F.createRow(G.countRows(),1,"auto")}var o;if((H.settings.minCols||H.settings.minSpareCols)&&(o=G.countEmptyCols(!0)),H.settings.minCols&&!H.settings.columns&&G.countCols()<H.settings.minCols)for(;G.countCols()<H.settings.minCols;o++)F.createCol(G.countCols(),1,"auto");if(H.settings.minSpareCols&&!H.settings.columns&&"array"===G.dataType&&o<H.settings.minSpareCols)for(;o<H.settings.minSpareCols&&G.countCols()<H.settings.maxCols;o++)F.createCol(G.countCols(),1,"auto");var i=G.countRows(),a=G.countCols();0!==i&&0!==a||$.deselect(),$.isSelected()&&Object(p.arrayEach)($.selectedRange,function(t){var e=!1,n=t.from.row,r=t.from.col,o=t.to.row,s=t.to.col;n>i-1?(e=!0,o>(n=i-1)&&(o=n)):o>i-1&&(e=!0,n>(o=i-1)&&(n=o)),r>a-1?(e=!0,s>(r=a-1)&&(s=r)):s>a-1&&(e=!0,r>(s=a-1)&&(r=s)),e&&G.selectCell(n,r,o,s)}),G.view&&G.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(t,e,n,r,o,i,a){var s,u,c,f,h,p,g,v,y=[],m={};if(0===(u=e.length))return!1;switch(o){case"shift_down":for(h=n?n.col-t.col+1:0,p=n?n.row-t.row+1:0,c=0,f=(e=Object(O.translateRowsToColumns)(e)).length,g=Math.max(f,h);c<g;c++)if(c<f){var b;for(s=0,u=e[c].length;s<p-u;s++)e[c].push(e[c][s%u]);e[c].unshift(t.col+c,t.row,0),(b=G).spliceCol.apply(b,P(e[c]))}else{var w;e[c%f][0]=t.col+c,(w=G).spliceCol.apply(w,P(e[c%f]))}break;case"shift_right":for(h=n?n.col-t.col+1:0,p=n?n.row-t.row+1:0,s=0,u=e.length,v=Math.max(u,p);s<v;s++)if(s<u){var C;for(c=0,f=e[s].length;c<h-f;c++)e[s].push(e[s][c%f]);e[s].unshift(t.row+s,t.col,0),(C=G).spliceRow.apply(C,P(e[s]))}else{var E;e[s%u][0]=t.row+s,(E=G).spliceRow.apply(E,P(e[s%u]))}break;case"overwrite":default:m.row=t.row,m.col=t.col;var S,k={row:n&&t?n.row-t.row+1:1,col:n&&t?n.col-t.col+1:1},R=0,T=0,M=!0,_=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e[t%e.length];return null!==n?r[n%r.length]:r},N=e.length,A=n?n.row-t.row+1:0;for(u=n?A:Math.max(N,A),s=0;s<u&&!(n&&m.row>n.row&&A>N||!H.settings.allowInsertRow&&m.row>G.countRows()-1||m.row>=H.settings.maxRows);s++){var x=s-R,j=_(x).length,D=n?n.col-t.col+1:0;if(f=n?D:Math.max(j,D),m.col=t.col,S=G.getCellMeta(m.row,m.col),"CopyPaste.paste"!==r&&"Autofill.autofill"!==r||!S.skipRowOnPaste){for(T=0,c=0;c<f&&!(n&&m.col>n.col&&D>j||!H.settings.allowInsertColumn&&m.col>G.countCols()-1||m.col>=H.settings.maxCols);c++)if(S=G.getCellMeta(m.row,m.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!S.skipColumnOnPaste)if(S.readOnly)m.col+=1;else{var L=c-T,F=_(x,L),B=G.getDataAtCell(m.row,m.col),W={row:x,col:L};if("Autofill.fill"===r){var V=G.runHooks("beforeAutofillInsidePopulate",W,i,e,a,{},k);V&&(F=Object(l.isUndefined)(V.value)?F:V.value)}if(null!==F&&"object"===I(F))if(Array.isArray(F)&&null===B&&(B=[]),null===B||"object"!==I(B))M=!1;else{var U=Object(d.duckSchema)(Array.isArray(B)?B:B[0]||B),Y=Object(d.duckSchema)(Array.isArray(F)?F:F[0]||F);Object(d.isObjectEqual)(U,Y)?F=Object(d.deepClone)(F):M=!1}else null!==B&&"object"===I(B)&&(M=!1);M&&y.push([m.row,m.col,F]),M=!0,m.col+=1}else T+=1,m.col+=1,f+=1;m.row+=1}else R+=1,m.row+=1,u+=1}G.setDataAtCell(y,null,null,r||"populateFromArray")}}},this.init=function(){B.setData(H.settings.data),G.runHooks("beforeInit"),Object(u.isMobileBrowser)()&&Object(o.addClass)(G.rootElement,"mobile"),this.updateSettings(H.settings,!0),this.view=new w.a(this),V=f.a.getInstance(G,H,$,F),this.forceFullRender=!0,G.runHooks("init"),this.view.render(),"object"===I(H.firstRun)&&(G.runHooks("afterChange",H.firstRun[0],H.firstRun[1]),H.firstRun=!1),G.runHooks("afterInit")},this.validateCell=function(t,e,n,r){var o,i=G.getCellValidator(e);function s(t){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&!0!==e.hidden){var r=e.visualCol,o=e.visualRow,i=G.getCell(o,r,!0);i&&"TH"!==i.nodeName&&G.view.wt.wtSettings.settings.cellRenderer(o,r,i),n(t)}else n(t)}Object(l.isRegExp)(i)&&(o=i,i=function(t,e){e(o.test(t))}),Object(a.isFunction)(i)?(t=G.runHooks("beforeValidate",t,e.visualRow,e.prop,r),G._registerImmediate(function(){i.call(e,t,function(n){G&&(n=G.runHooks("afterValidate",n,t,e.visualRow,e.prop,r),e.valid=n,s(n),G.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,r))})})):G._registerImmediate(function(){e.valid=!0,s(e.valid,!1)})},this.setDataAtCell=function(t,e,n,r){var o,i,a,s=tt(t,e,n),l=[],u=r;for(o=0,i=s.length;o<i;o++){if("object"!==I(s[o]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof s[o][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");a=F.colToProp(s[o][1]),l.push([s[o][0],a,B.getAtCell(K.toPhysicalRow(s[o][0]),s[o][1]),s[o][2]])}u||"object"!==I(t)||(u=e),G.runHooks("afterSetDataAtCell",l,u),Q(l,u,function(){J(l,u)})},this.setDataAtRowProp=function(t,e,n,r){var o,i,a=tt(t,e,n),s=[],l=r;for(o=0,i=a.length;o<i;o++)s.push([a[o][0],a[o][1],B.getAtCell(K.toPhysicalRow(a[o][0]),a[o][1]),a[o][2]]);l||"object"!==I(t)||(l=e),G.runHooks("afterSetDataAtRowProp",s,l),Q(s,l,function(){J(s,l)})},this.listen=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=G.rootDocument;if(t){var n=!e.activeElement||e.activeElement&&void 0===e.activeElement.nodeName;e.activeElement&&e.activeElement!==e.body&&!n?e.activeElement.blur():n&&e.body.focus()}G&&!G.isListening()&&(L=G.guid,G.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(L=null,G.runHooks("afterUnlisten"))},this.isListening=function(){return L===G.guid},this.destroyEditor=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];G._refreshBorders(t,e)},this.populateFromArray=function(t,e,n,r,o,i,a,s,l){if("object"!==I(n)||"object"!==I(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var u="number"==typeof r?new k.a(r,o):null;return W.populateFromArray(new k.a(t,e),n,u,i,a,s,l)},this.spliceCol=function(t,e,n){for(var r,o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return(r=F).spliceCol.apply(r,[t,e,n].concat(i))},this.spliceRow=function(t,e,n){for(var r,o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return(r=F).spliceRow.apply(r,[t,e,n].concat(i))},this.getSelected=function(){if($.isSelected())return Object(p.arrayMap)($.getSelectedRange(),function(t){var e=t.from,n=t.to;return[e.row,e.col,n.row,n.col]})},this.getSelectedLast=function(){var t,e=this.getSelected();return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if($.isSelected())return Array.from($.getSelectedRange())},this.getSelectedRangeLast=function(){var t,e=this.getSelectedRange();return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(){var t=this;if($.isSelected()){var e=[];Object(p.arrayEach)($.getSelectedRange(),function(n){var r=n.getTopLeftCorner(),o=n.getBottomRightCorner();Object(b.rangeEach)(r.row,o.row,function(n){Object(b.rangeEach)(r.col,o.col,function(r){t.getCellMeta(n,r).readOnly||e.push([n,r,""])})})}),e.length>0&&this.setDataAtCell(e)}},this.render=function(){G.view&&(G.renderCall=!0,G.forceFullRender=!0,V.lockEditor(),G._refreshBorders(null),V.unlockEditor())},this.refreshDimensions=function(){if(G.view){var t=G.view.getLastSize(),e=t.width,n=t.height,r=G.rootElement.getBoundingClientRect(),o=r.width,i=r.height,a=o!==e||i!==n;!1===G.runHooks("beforeRefreshDimensions",{width:e,height:n},{width:o,height:i},a)||((a||G.view.wt.wtOverlays.scrollableElement===G.rootWindow)&&(G.view.setLastSize(o,i),G.render()),G.runHooks("afterRefreshDimensions",{width:e,height:n},{width:o,height:i},a))}},this.loadData=function(t){if(Array.isArray(H.settings.dataSchema)?G.dataType="array":Object(a.isFunction)(H.settings.dataSchema)?G.dataType="function":G.dataType="object",F&&F.destroy(),F=new c.a(G,H,X),"object"===I(t)&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error("loadData only accepts array of objects or array of arrays (".concat(I(t)," given)"));var e,n=F.getSchema();t=[];var r,o=0;for(o=0,r=H.settings.startRows;o<r;o++)if("object"!==G.dataType&&"function"!==G.dataType||!H.settings.dataSchema)if("array"===G.dataType)e=Object(d.deepClone)(n[0]),t.push(e);else{e=[];for(var i=0,s=H.settings.startCols;i<s;i++)e.push(null);t.push(e)}else e=Object(d.deepClone)(n),t.push(e)}H.isPopulated=!1,X.prototype.data=t,Array.isArray(t[0])&&(G.dataType="array"),F.dataSource=t,B.data=t,B.dataType=G.dataType,B.colToProp=F.colToProp.bind(F),B.propToCol=F.propToCol.bind(F),H.cellSettings.length=0,W.adjustRowsAndCols(),G.runHooks("afterLoadData",H.firstRun),H.firstRun?H.firstRun=[null,"loadData"]:(G.runHooks("afterChange",null,"loadData"),G.render()),H.isPopulated=!0},this.getData=function(t,e,n,r){return Object(l.isUndefined)(t)?F.getAll():F.getRange(new k.a(t,e),new k.a(n,r),F.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,r){return F.getCopyableText(new k.a(t,e),new k.a(n,r))},this.getCopyableData=function(t,e){return F.getCopyable(t,F.colToProp(e))},this.getSchema=function(){return F.getSchema()},this.updateSettings=function(t){var e,n,r,s,u,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],f=!1;if(Object(l.isDefined)(t.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(Object(l.isDefined)(t.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(e in t)"data"!==e&&("language"!==e?R.a.getSingleton().getRegistered().indexOf(e)>-1?(Object(a.isFunction)(t[e])||Array.isArray(t[e]))&&(t[e].initialHook=!0,G.addHook(e,t[e])):!c&&Object(d.hasOwnProperty)(t,e)&&(X.prototype[e]=t[e]):(s=t.language,u=void 0,u=Object(A.c)(s),Object(N.d)(u)?(G.runHooks("beforeLanguageChange",u),X.prototype.language=u,G.runHooks("afterLanguageChange",u)):Object(A.d)(s)));void 0===t.data&&void 0===H.settings.data?G.loadData(null):void 0!==t.data?G.loadData(t.data):void 0!==t.columns&&F.createMap(),r=G.countCols();var h,p,g=t.columns||X.prototype.columns;if(g&&Object(a.isFunction)(g)&&(r=G.countSourceCols(),f=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||(H.cellSettings.length=0),r>0)for(e=0,n=0;e<r;e++)f&&!g(e)||(H.columnSettings[n]=Object(i.columnFactory)(X,H.columnsSettingConflicts),h=H.columnSettings[n].prototype,g&&(p=f?g(e):g[n])&&(Object(d.extend)(h,p),Object(d.extend)(h,et(p))),n+=1);Object(l.isDefined)(t.cell)&&Object(d.objectEach)(t.cell,function(t){G.setCellMetaObject(t.row,t.col,t)}),G.runHooks("afterCellMetaReset"),Object(l.isDefined)(t.className)&&(X.prototype.className&&Object(o.removeClass)(G.rootElement,X.prototype.className),t.className&&Object(o.addClass)(G.rootElement,t.className));var v=G.rootElement.style.height;""!==v&&(v=parseInt(G.rootElement.style.height,10));var y=t.height;(Object(a.isFunction)(y)&&(y=y()),c)&&(G.rootElement.getAttribute("style")&&G.rootElement.setAttribute("data-initialstyle",G.rootElement.getAttribute("style")));if(null===y){var m=G.rootElement.getAttribute("data-initialstyle");m&&(m.indexOf("height")>-1||m.indexOf("overflow")>-1)?G.rootElement.setAttribute("style",m):(G.rootElement.style.height="",G.rootElement.style.overflow="")}else void 0!==y&&(G.rootElement.style.height=isNaN(y)?"".concat(y):"".concat(y,"px"),G.rootElement.style.overflow="hidden");if(void 0!==t.width){var b=t.width;Object(a.isFunction)(b)&&(b=b()),G.rootElement.style.width=isNaN(b)?"".concat(b):"".concat(b,"px")}c||(F.clearLengthCache(),G.view&&G.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),G.runHooks("afterUpdateSettings",t)),W.adjustRowsAndCols(),G.view&&!H.firstRun&&(G.forceFullRender=!0,V.lockEditor(),G._refreshBorders(null),V.unlockEditor()),c||!G.view||""!==v&&""!==y&&void 0!==y||v===y||G.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var t=G.getSelectedLast();if(X.prototype.getValue){if(Object(a.isFunction)(X.prototype.getValue))return X.prototype.getValue.call(G);if(t)return G.getData()[t[0][0]][X.prototype.getValue]}else if(t)return G.getDataAtCell(t[0],t[1])},this.getSettings=function(){return H.settings},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,r,o){W.alter(t,e,n,r,o)},this.getCell=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return G.view.getCellAtCoords(new k.a(t,e),n)},this.getCoords=function(t){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,t)},this.colToProp=function(t){return F.colToProp(t)},this.propToCol=function(t){return F.propToCol(t)},this.toVisualRow=function(t){return K.toVisualRow(t)},this.toVisualColumn=function(t){return K.toVisualColumn(t)},this.toPhysicalRow=function(t){return K.toPhysicalRow(t)},this.toPhysicalColumn=function(t){return K.toPhysicalColumn(t)},this.getDataAtCell=function(t,e){return F.get(t,F.colToProp(e))},this.getDataAtRowProp=function(t,e){return F.get(t,e)},this.getDataAtCol=function(t){var e;return(e=[]).concat.apply(e,P(F.getRange(new k.a(0,t),new k.a(H.settings.data.length-1,t),F.DESTINATION_RENDERER)))},this.getDataAtProp=function(t){var e,n=F.getRange(new k.a(0,F.propToCol(t)),new k.a(H.settings.data.length-1,F.propToCol(t)),F.DESTINATION_RENDERER);return(e=[]).concat.apply(e,P(n))},this.getSourceData=function(t,e,n,r){return void 0===t?B.getData():B.getByRange(new k.a(t,e),new k.a(n,r))},this.getSourceDataArray=function(t,e,n,r){return void 0===t?B.getData(!0):B.getByRange(new k.a(t,e),new k.a(n,r),!0)},this.getSourceDataAtCol=function(t){return B.getAtColumn(t)},this.getSourceDataAtRow=function(t){return B.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return B.getAtCell(t,e)},this.getDataAtRow=function(t){return F.getRange(new k.a(t,0),new k.a(t,this.countCols()-1),F.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,n,r){var o=this,i=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,n,r],a=i[0],s=i[1],l=i[2],u=i[3],c=null,f=null;void 0===l&&(l=a),void 0===u&&(u=s);var h="mixed";return Object(b.rangeEach)(Math.min(a,l),Math.max(a,l),function(t){var e=!0;return Object(b.rangeEach)(Math.min(s,u),Math.max(s,u),function(n){var r=o.getCellMeta(t,n);return f=r.type,c?e=c===f:c=f,e}),h=e?f:"mixed",e}),h},this.removeCellMeta=function(t,e,n){var r=D(K.toPhysical(t,e),2),o=r[0],i=r[1],a=H.cellSettings[o][i][n];!1!==G.runHooks("beforeRemoveCellMeta",t,e,n,a)&&(delete H.cellSettings[o][i][n],G.runHooks("afterRemoveCellMeta",t,e,n,a)),a=null},this.spliceCellsMeta=function(t,e){for(var n,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];(n=H.cellSettings).splice.apply(n,[t,e].concat(o))},this.setCellMetaObject=function(t,e,n){var r=this;"object"===I(n)&&Object(d.objectEach)(n,function(n,o){r.setCellMeta(t,e,o,n)})},this.setCellMeta=function(t,e,n,r){var o=D(K.toPhysical(t,e),2),a=o[0],s=o[1];H.columnSettings[s]||(H.columnSettings[s]=Object(i.columnFactory)(X,H.columnsSettingConflicts)),H.cellSettings[a]||(H.cellSettings[a]=[]),H.cellSettings[a][s]||(H.cellSettings[a][s]=new H.columnSettings[s]),H.cellSettings[a][s][n]=r,G.runHooks("afterSetCellMeta",t,e,n,r)},this.getCellsMeta=function(){return Object(p.arrayFlatten)(H.cellSettings)},this.getCellMeta=function(t,e){var n=F.colToProp(e),r=D(K.toPhysical(t,e),2),o=r[0],a=r[1],s=o;null===s&&(s=t),H.columnSettings[a]||(H.columnSettings[a]=Object(i.columnFactory)(X,H.columnsSettingConflicts)),H.cellSettings[s]||(H.cellSettings[s]=[]),H.cellSettings[s][a]||(H.cellSettings[s][a]=new H.columnSettings[a]);var l=H.cellSettings[s][a];if(l.row=s,l.col=a,l.visualRow=t,l.visualCol=e,l.prop=n,l.instance=G,G.runHooks("beforeGetCellMeta",t,e,l),Object(d.extend)(l,et(l)),l.cells){var u=l.cells.call(l,s,a,n);u&&(Object(d.extend)(l,u),Object(d.extend)(l,et(u)))}return G.runHooks("afterGetCellMeta",t,e,l),l},this.getCellMetaAtRow=function(t){return H.cellSettings[t]},this.isColumnModificationAllowed=function(){return!("object"===G.dataType||G.getSettings().columns)};var nt=Object(O.cellMethodLookupFactory)("renderer");this.getCellRenderer=function(t,e){return Object(v.b)(nt.call(this,t,e))},this.getCellEditor=Object(O.cellMethodLookupFactory)("editor");var rt=Object(O.cellMethodLookupFactory)("validator");this.getCellValidator=function(t,e){var n=rt.call(this,t,e);return"string"==typeof n&&(n=Object(y.b)(n)),n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){var r=new Z;t&&(r.onQueueEmpty=t);for(var o=G.countRows()-1;o>=0;)if(void 0===e||-1!==e.indexOf(o)){for(var i=G.countCols()-1;i>=0;)void 0===n||-1!==n.indexOf(i)?(r.addValidatorToQueue(),G.validateCell(G.getDataAtCell(o,i),G.getCellMeta(o,i),function(t){if("boolean"!=typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells"),i-=1):i-=1;o-=1}else o-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(t){var e=H.settings.rowHeaders,n=t;return void 0!==n&&(n=G.runHooks("modifyRowHeader",n)),void 0===n?(e=[],Object(b.rangeEach)(G.countRows()-1,function(t){e.push(G.getRowHeader(t))})):Array.isArray(e)&&void 0!==e[n]?e=e[n]:Object(a.isFunction)(e)?e=e(n):e&&"string"!=typeof e&&"number"!=typeof e&&(e=n+1),e},this.hasRowHeaders=function(){return!!H.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==H.settings.colHeaders&&null!==H.settings.colHeaders)return!!H.settings.colHeaders;for(var t=0,e=G.countCols();t<e;t++)if(G.getColHeader(t))return!0;return!1},this.getColHeader=function(t){var e=H.settings.columns&&Object(a.isFunction)(H.settings.columns),n=G.runHooks("modifyColHeader",t),r=H.settings.colHeaders;if(void 0===n){for(var o=[],i=e?G.countSourceCols():G.countCols(),s=0;s<i;s++)o.push(G.getColHeader(s));r=o}else{var l=n,u=G.runHooks("modifyCol",l),c=function(t){for(var e=[],n=G.countSourceCols(),r=0;r<n;r++)Object(a.isFunction)(G.getSettings().columns)&&G.getSettings().columns(r)&&e.push(r);return e[t]}(u);!1===H.settings.colHeaders?r=null:H.settings.columns&&Object(a.isFunction)(H.settings.columns)&&H.settings.columns(c)&&H.settings.columns(c).title?r=H.settings.columns(c).title:H.settings.columns&&H.settings.columns[u]&&H.settings.columns[u].title?r=H.settings.columns[u].title:Array.isArray(H.settings.colHeaders)&&void 0!==H.settings.colHeaders[u]?r=H.settings.colHeaders[u]:Object(a.isFunction)(H.settings.colHeaders)?r=H.settings.colHeaders(u):H.settings.colHeaders&&"string"!=typeof H.settings.colHeaders&&"number"!=typeof H.settings.colHeaders&&(r=Object(O.spreadsheetColumnLabel)(l))}return r},this._getColWidthFromSettings=function(t){var e=G.getCellMeta(0,t),n=e.width;if(void 0!==n&&n!==H.settings.width||(n=e.colWidths),null!=n){switch(I(n)){case"object":n=n[t];break;case"function":n=n(t)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(t){var e=G._getColWidthFromSettings(t);return void 0===(e=G.runHooks("modifyColWidth",e,t))&&(e=k.d.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){var e=H.settings.rowHeights;if(null!=e){switch(I(e)){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){var e=G._getRowHeightFromSettings(t);return e=G.runHooks("modifyRowHeight",e,t)},this.countSourceRows=function(){return G.runHooks("modifySourceLength")||(G.getSourceData()?G.getSourceData().length:0)},this.countSourceCols=function(){var t=G.getSourceData()&&G.getSourceData()[0]?G.getSourceData()[0]:[];return Object(d.isObject)(t)?Object(d.deepObjectSize)(t):t.length||0},this.countRows=function(){return F.getLength()},this.countCols=function(){var t=this.getSettings().maxCols,e=!1,n=0;if("array"===G.dataType&&(e=H.settings.data&&H.settings.data[0]&&H.settings.data[0].length),e&&(n=H.settings.data[0].length),H.settings.columns)if(Object(a.isFunction)(H.settings.columns))if("array"===G.dataType){for(var r=0,o=0;o<n;o++)H.settings.columns(o)&&(r+=1);n=r}else"object"!==G.dataType&&"function"!==G.dataType||(n=F.colToPropCache.length);else n=H.settings.columns.length;else"object"!==G.dataType&&"function"!==G.dataType||(n=F.colToPropCache.length);return Math.min(t,n)},this.rowOffset=function(){return G.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return G.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return G.view.wt.drawn?G.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return G.view.wt.drawn?G.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return G.view.wt.drawn?G.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return G.view.wt.drawn?G.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Object(b.rangeEachReverse)(G.countRows()-1,function(n){if(G.isEmptyRow(n))e+=1;else if(!0===t)return!1}),e},this.countEmptyCols=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(G.countRows()<1)return 0;var e=0;return Object(b.rangeEachReverse)(G.countCols()-1,function(n){if(G.isEmptyCol(n))e+=1;else if(!0===t)return!1}),e},this.isEmptyRow=function(t){return H.settings.isEmptyRow.call(G,t)},this.isEmptyCol=function(t){return H.settings.isEmptyCol.call(G,t)},this.selectCell=function(t,e,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Object(l.isUndefined)(t)&&!Object(l.isUndefined)(e)&&this.selectCells([[t,e,n,r]],o,i)},this.selectCells=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===e&&(z=!0);var r=$.selectCells(t);return r&&n&&G.listen(),z=!1,r},this.selectColumns=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return $.selectColumns(t,e)},this.selectRows=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return $.selectRows(t,e)},this.deselectCell=function(){$.deselect()},this.selectAll=function(){z=!0,$.selectAll(),z=!1},this.scrollViewportTo=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!n,i=!r,a=!1;return void 0!==t&&void 0!==e&&(a=G.view.scrollViewport(new k.a(t,e),o,r,n,i)),"number"==typeof t&&"number"!=typeof e&&(a=G.view.scrollViewportVertically(t,o,n)),"number"==typeof e&&"number"!=typeof t&&(a=G.view.scrollViewportHorizontally(e,r,i)),a},this.destroy=function(){if(G._clearTimeouts(),G._clearImmediates(),G.view&&G.view.destroy(),B&&B.destroy(),B=null,Object(x.c)(),Object(S.b)(G)){var t=this.rootDocument.querySelector("#hot-display-license-info");t&&t.parentNode.removeChild(t)}Object(o.empty)(G.rootElement),q.destroy(),V&&V.destroy(),G.runHooks("afterDestroy"),R.a.getSingleton().destroy(G),Object(d.objectEach)(G,function(t,e,n){var r;Object(a.isFunction)(t)?n[e]=(r=e,function(){throw new Error('The "'.concat(r,'" method cannot be called because this Handsontable instance has been destroyed'))}):"guid"!==e&&(n[e]=null)}),G.isDestroyed=!0,F&&F.destroy(),F=null,H=null,W=null,$=null,V=null,G=null,X=null},this.getActiveEditor=function(){return V.getActiveEditor()},this.getPlugin=function(t){return Object(g.a)(this,t)},this.getInstance=function(){return G},this.addHook=function(t,e){R.a.getSingleton().add(t,e,G)},this.hasHook=function(t){return R.a.getSingleton().has(t,G)},this.addHookOnce=function(t,e){R.a.getSingleton().once(t,e,G)},this.removeHook=function(t,e){R.a.getSingleton().remove(t,e,G)},this.runHooks=function(t,e,n,r,o,i,a){return R.a.getSingleton().run(G,t,e,n,r,o,i,a)},this.getTranslatedPhrase=function(t,e){return Object(_.a)(H.settings.language,t,e)},this.timeouts=[],this._registerTimeout=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;"function"==typeof n&&(n=setTimeout(n,e)),this.timeouts.push(n)},this._clearTimeouts=function(){Object(p.arrayEach)(this.timeouts,function(t){clearTimeout(t)})},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(t(e))},this._clearImmediates=function(){Object(p.arrayEach)(this.immediates,function(t){r(t)})},this._refreshBorders=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];V.destroyEditor(t),G.view.render(),e&&$.isSelected()&&V.prepareEditor()},R.a.getSingleton().run(G,"construct")}}).call(this,n(127).setImmediate,n(127).clearImmediate)},function(t,e,n){"use strict";n.d(e,"d",function(){return o}),n.d(e,"c",function(){return i}),n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s});n(10),n(11),n(7),n(6),n(8),n(31),n(9);var r=new WeakMap,o=Symbol("rootInstance");function i(t){r.set(t,!0)}function a(t){return t===o}function s(t){return r.has(t)}},function(t,e,n){"use strict";n(10),n(11),n(12),n(24),n(215),n(56),n(29),n(44),n(7),n(75),n(22),n(73),n(6),n(26),n(50),n(8),n(128),n(9);var r=n(54),o=n(5);var i=function(t){var e=t.activeHeaderClassName;return new o.c({highlightHeaderClassName:e})};var a=function(t){var e=t.layerLevel,n=t.areaCornerVisible;return new o.c({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:n}})};var s=function(t){var e=t.cellCornerVisible;return new o.c({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}})};var l=function(t){var e=t.border,n=t.cellRange;return new o.c(e,n)};var u=function(){return new o.c({className:"fill",border:{width:1,color:"#ff0000"}})};var c=function(t){var e=t.headerClassName,n=t.rowClassName,r=t.columnClassName;return new o.c({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:n,highlightColumnClassName:r})},f=Object(r.a)("highlight/types"),h=f.register,d=f.getItem;function p(t,e){return d(t)(e)}h("active-header",i),h("area",a),h("cell",s),h("custom-selection",l),h("fill",u),h("header",c);var g=n(1);function v(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){m(t,e,n[e])})}return t}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var w="cell",C="fill",O=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,this.layerLevel=0,this.cell=p(w,e),this.fill=p(C,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}var e,n,r;return e=t,(n=[{key:"isEnabledFor",value:function(t){var e="current"===t?w:t,n=this.options.disableHighlight;return"string"==typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(e)}},{key:"useLayerLevel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var t,e=this.layerLevel;return this.areas.has(e)?t=this.areas.get(e):(t=p("area",y({layerLevel:e},this.options)),this.areas.set(e,t)),t}},{key:"getAreas",value:function(){return v(this.areas.values())}},{key:"createOrGetHeader",value:function(){var t,e=this.layerLevel;return this.headers.has(e)?t=this.headers.get(e):(t=p("header",y({},this.options)),this.headers.set(e,t)),t}},{key:"getHeaders",value:function(){return v(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var t,e=this.layerLevel;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=p("active-header",y({},this.options)),this.activeHeaders.set(e,t)),t}},{key:"getActiveHeaders",value:function(){return v(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return v(this.customSelections.values())}},{key:"addCustomSelection",value:function(t){this.customSelections.push(p("custom-selection",y({},t)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Object(g.arrayEach)(this.areas.values(),function(t){t.clear()}),Object(g.arrayEach)(this.headers.values(),function(t){t.clear()}),Object(g.arrayEach)(this.activeHeaders.values(),function(t){t.clear()})}},{key:Symbol.iterator,value:function(){return[this.cell,this.fill].concat(v(this.areas.values()),v(this.headers.values()),v(this.activeHeaders.values()),v(this.customSelections))[Symbol.iterator]()}}])&&b(e.prototype,n),r&&b(e,r),t}();n(35),n(79),n(80),n(72),n(81);function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var S=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ranges=[]}var e,n,r;return e=t,(n=[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(t){return this.clear(),this.ranges.push(new o.b(t)),this}},{key:"add",value:function(t){return this.ranges.push(new o.b(t)),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(t){return this.ranges.some(function(e){return e.includes(t)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+e-1;return n>=0&&(t=this.ranges[n]),t}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}])&&E(e.prototype,n),r&&E(e,r),t}(),k=n(74),R=n(2),T=n(13),M=n(39);function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var N=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=e,this.options=n}var e,n,r;return e=t,(n=[{key:"transformStart",value:function(t,e,n){var r=new o.a(t,e);this.runLocalHooks("beforeTransformStart",r);var i=this.options.countRows(),a=this.options.countCols(),s=this.options.fixedRowsBottom(),l=this.options.minSpareRows(),u=this.options.minSpareCols(),c=this.options.autoWrapRow(),f=this.options.autoWrapCol(),h=this.range.current().highlight;h.row+t>i-1?n&&l>0&&!(s&&h.row>=i-s-1)?(this.runLocalHooks("insertRowRequire",i),i=this.options.countRows()):f&&(r.row=1-i,r.col=h.col+r.col===a-1?1-a:1):f&&h.row+r.row<0&&h.col+r.col>=0&&(r.row=i-1,r.col=h.col+r.col===0?a-1:-1),h.col+r.col>a-1?n&&u>0?(this.runLocalHooks("insertColRequire",a),a=this.options.countCols()):c&&(r.row=h.row+r.row===i-1?1-i:1,r.col=1-a):c&&h.col+r.col<0&&h.row+r.row>=0&&(r.row=h.row+r.row===0?i-1:-1,r.col=a-1);var d=new o.a(h.row+r.row,h.col+r.col),p=0,g=0;return d.row<0?(p=-1,d.row=0):d.row>0&&d.row>=i&&(p=1,d.row=i-1),d.col<0?(g=-1,d.col=0):d.col>0&&d.col>=a&&(g=1,d.col=a-1),this.runLocalHooks("afterTransformStart",d,p,g),d}},{key:"transformEnd",value:function(t,e){var n=new o.a(t,e);this.runLocalHooks("beforeTransformEnd",n);var r=this.options.countRows(),i=this.options.countCols(),a=this.range.current(),s=new o.a(a.to.row+n.row,a.to.col+n.col),l=0,u=0;return s.row<0?(l=-1,s.row=0):s.row>0&&s.row>=r&&(l=1,s.row=r-1),s.col<0?(u=-1,s.col=0):s.col>0&&s.col>=i&&(u=1,s.col=i-1),this.runLocalHooks("afterTransformEnd",s,l,u),s}}])&&_(e.prototype,n),r&&_(e,r),t}();Object(R.mixin)(N,M.a);var A=N,x=n(48),j=n(33);function I(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function D(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) \n        or as an array of CellRange objects."]);return D=function(){return t},t}function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var L=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new S,this.highlight=new O({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disableHighlight:this.settings.disableVisualSelection,cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)}}),this.transformation=new A(this.selectedRange,{countRows:function(){return r.tableProps.countRows()},countCols:function(){return r.tableProps.countCols()},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(e))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(e))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(e))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(e))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(e))}),this.transformation.addLocalHook("insertColRequire",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(e))})}var e,n,r;return e=t,(n=[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=Object(T.isUndefined)(e)?Object(k.a)():e,i=t.row<0,a=t.col<0,s=i&&a;i&&(t.row=0),a&&(t.col=0),this.selectedByCorner=s,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),t),(!r||r&&!o&&Object(T.isUndefined)(e))&&this.selectedRange.clear(),this.selectedRange.add(t),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!s&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!s&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(t)}},{key:"setRangeStartOnly",value:function(t,e){this.setRangeStart(t,e,!0)}},{key:"setRangeEnd",value:function(t){if(!this.selectedRange.isEmpty()){this.runLocalHooks("beforeSetRangeEnd",t),this.begin();var e=this.selectedRange.current();"single"!==this.settings.selectionMode&&e.setTo(new o.a(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(w)&&this.highlight.getCell().add(this.selectedRange.current().highlight);var n=this.getLayerLevel();n<this.highlight.layerLevel&&(Object(g.arrayEach)(this.highlight.getAreas(),function(t){t.clear()}),Object(g.arrayEach)(this.highlight.getHeaders(),function(t){t.clear()}),Object(g.arrayEach)(this.highlight.getActiveHeaders(),function(t){t.clear()})),this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();if(r.clear(),i.clear(),a.clear(),this.highlight.isEnabledFor("area")&&(this.isMultiple()||n>=1)&&(r.add(e.from).add(e.to),1===n&&(this.highlight.useLayerLevel(n-1).createOrGetArea().add(this.selectedRange.previous().from),this.highlight.useLayerLevel(n))),this.highlight.isEnabledFor("header")&&("single"===this.settings.selectionMode?i.add(e.highlight):i.add(e.from).add(e.to)),this.isSelectedByRowHeader())this.tableProps.countCols()===e.getWidth()&&a.add(new o.a(e.from.row,-1)).add(new o.a(e.to.row,-1));if(this.isSelectedByColumnHeader())this.tableProps.countRows()===e.getHeight()&&a.add(new o.a(-1,e.from.col)).add(new o.a(-1,e.to.col));this.runLocalHooks("afterSetRangeEnd",t)}}},{key:"isMultiple",value:function(){var t=Object(R.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}},{key:"transformStart",value:function(t,e,n){this.setRangeStart(this.transformation.transformStart(t,e,n))}},{key:"transformEnd",value:function(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t)}},{key:"isSelectedByColumnHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){this.clear(),this.setRangeStart(new o.a(-1,-1)),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new o.a(this.tableProps.countRows()-1,this.tableProps.countCols()-1))}},{key:"selectCells",value:function(t){var e=this,n=Object(x.c)(t);if(n===x.a)return!1;if(n===x.b)throw new Error(Object(j.a)(D()));var r=Object(x.e)(n,{propToCol:function(t){return e.tableProps.propToCol(t)},keepDirection:!0}),i=this.tableProps.countRows(),a=this.tableProps.countCols(),s=!t.some(function(t){var e=I(r(t),4),n=e[0],o=e[1],s=e[2],l=e[3];return!(Object(x.d)(n,i)&&Object(x.d)(o,a)&&Object(x.d)(s,i)&&Object(x.d)(l,a))});return s&&(this.clear(),Object(g.arrayEach)(t,function(t){var n=I(r(t),4),i=n[0],a=n[1],s=n[2],l=n[3];e.setRangeStartOnly(new o.a(i,a),!1),e.setRangeEnd(new o.a(s,l)),e.finish()})),s}},{key:"selectColumns",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n="string"==typeof t?this.tableProps.propToCol(t):t,r="string"==typeof e?this.tableProps.propToCol(e):e,i=this.tableProps.countCols(),a=Object(x.d)(n,i)&&Object(x.d)(r,i);return a&&(this.setRangeStartOnly(new o.a(-1,n)),this.setRangeEnd(new o.a(this.tableProps.countRows()-1,r)),this.finish()),a}},{key:"selectRows",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this.tableProps.countRows(),r=Object(x.d)(t,n)&&Object(x.d)(e,n);return r&&(this.setRangeStartOnly(new o.a(t,-1)),this.setRangeEnd(new o.a(e,this.tableProps.countCols()-1)),this.finish()),r}}])&&P(e.prototype,n),r&&P(e,r),t}();Object(R.mixin)(L,M.a);var H=L;n(108);n.d(e,"a",function(){return H}),n.d(e,"b",function(){return x.c}),n.d(e,"c",function(){return x.e})},function(t,e,n){var r=n(58),o=n(97),i=n(98),a=n(70),s=n(99),l=n(55),u=n(159),c=Object.getOwnPropertyDescriptor;e.f=r?c:function(t,e){if(t=a(t),e=s(e,!0),u)try{return c(t,e)}catch(t){}if(l(t,e))return i(!o.f.call(t,e),t[e])}},function(t,e,n){var r=n(158),o=n(135);t.exports=Object.keys||function(t){return r(t,o)}},,function(t,e,n){"use strict";n.d(e,"b",function(){return u}),n.d(e,"c",function(){return c}),n.d(e,"a",function(){return f}),n.d(e,"d",function(){return h});n(24),n(35),n(72);var r=n(13),o=n(2),i=n(30),a=n(33),s=n(69);function l(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.']);return l=function(){return t},t}function u(t,e){return Object(o.objectEach)(e,function(e,n){Object(r.isUndefined)(t[n])&&(t[n]=e)}),t}function c(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?"".concat(e[1].toLowerCase(),"-").concat(e[2].toUpperCase()):t}function f(t,e){var n=c(e);Object(s.d)(n)?t.language=n:(t.language=s.a,h(e))}function h(t){Object(r.isDefined)(t)&&Object(i.a)(Object(a.a)(l(),t))}},function(t,e,n){(function(e,n){t.exports=function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="swal-button";e.CLASS_NAMES={MODAL:"swal-modal",OVERLAY:"swal-overlay",SHOW_MODAL:"swal-overlay--show-modal",MODAL_TITLE:"swal-title",MODAL_TEXT:"swal-text",ICON:"swal-icon",ICON_CUSTOM:"swal-icon--custom",CONTENT:"swal-content",FOOTER:"swal-footer",BUTTON_CONTAINER:"swal-button-container",BUTTON:r,CONFIRM_BUTTON:r+"--confirm",CANCEL_BUTTON:r+"--cancel",DANGER_BUTTON:r+"--danger",BUTTON_LOADING:r+"--loading",BUTTON_LOADER:r+"__loader"},e.default=e.CLASS_NAMES},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getNode=function(t){var e="."+t;return document.querySelector(e)},e.stringToNode=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},e.insertAfter=function(t,e){var n=e.nextSibling;e.parentNode.insertBefore(t,n)},e.removeNode=function(t){t.parentElement.removeChild(t)},e.throwErr=function(t){throw"SweetAlert: "+(t=(t=t.replace(/ +(?= )/g,"")).trim())},e.isPlainObject=function(t){if("[object Object]"!==Object.prototype.toString.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype},e.ordinalSuffixOf=function(t){var e=t%10,n=t%100;return 1===e&&11!==n?t+"st":2===e&&12!==n?t+"nd":3===e&&13!==n?t+"rd":t+"th"}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(25));var o=n(26);e.overlayMarkup=o.default,r(n(27)),r(n(28)),r(n(29));var i=n(0),a=i.default.MODAL_TITLE,s=i.default.MODAL_TEXT,l=i.default.ICON,u=i.default.FOOTER;e.iconMarkup='\n  <div class="'+l+'"></div>',e.titleMarkup='\n  <div class="'+a+'"></div>\n',e.textMarkup='\n  <div class="'+s+'"></div>',e.footerMarkup='\n  <div class="'+u+'"></div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);e.CONFIRM_KEY="confirm",e.CANCEL_KEY="cancel";var o={visible:!0,text:null,value:null,className:"",closeModal:!0},i=Object.assign({},o,{visible:!1,text:"Cancel",value:null}),a=Object.assign({},o,{text:"OK",value:!0});e.defaultButtonList={cancel:i,confirm:a};var s=function(t){switch(t){case e.CONFIRM_KEY:return a;case e.CANCEL_KEY:return i;default:var n=t.charAt(0).toUpperCase()+t.slice(1);return Object.assign({},o,{text:n,value:t})}},l=function(t,e){var n=s(t);return!0===e?Object.assign({},n,{visible:!0}):"string"==typeof e?Object.assign({},n,{visible:!0,text:e}):r.isPlainObject(e)?Object.assign({visible:!0},n,e):Object.assign({},n,{visible:!1})},u=function(t){var n={};switch(t.length){case 1:n[e.CANCEL_KEY]=Object.assign({},i,{visible:!1});break;case 2:n[e.CANCEL_KEY]=l(e.CANCEL_KEY,t[0]),n[e.CONFIRM_KEY]=l(e.CONFIRM_KEY,t[1]);break;default:r.throwErr("Invalid number of 'buttons' in array ("+t.length+").\n      If you want more than 2 buttons, you need to use an object!")}return n};e.getButtonListOpts=function(t){var n=e.defaultButtonList;return"string"==typeof t?n[e.CONFIRM_KEY]=l(e.CONFIRM_KEY,t):Array.isArray(t)?n=u(t):r.isPlainObject(t)?n=function(t){for(var e={},n=0,r=Object.keys(t);n<r.length;n++){var o=r[n],a=t[o],s=l(o,a);e[o]=s}return e.cancel||(e.cancel=i),e}(t):!0===t?n=u([!0,!0]):!1===t?n=u([!1,!1]):void 0===t&&(n=e.defaultButtonList),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(2),i=n(0),a=i.default.MODAL,s=i.default.OVERLAY,l=n(30),u=n(31),c=n(32),f=n(33);e.injectElIntoModal=function(t){var e=r.getNode(a),n=r.stringToNode(t);return e.appendChild(n),n};var h=function(t,e){!function(t){t.className=a,t.textContent=""}(t);var n=e.className;n&&t.classList.add(n)};e.initModalContent=function(t){var e=r.getNode(a);h(e,t),l.default(t.icon),u.initTitle(t.title),u.initText(t.text),f.default(t.content),c.default(t.buttons,t.dangerMode)},e.default=function(){var t=r.getNode(s),e=r.stringToNode(o.modalMarkup);t.appendChild(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),o={isOpen:!1,promise:null,actions:{},timer:null},i=Object.assign({},o);e.resetState=function(){i=Object.assign({},o)},e.setActionValue=function(t){if("string"==typeof t)return a(r.CONFIRM_KEY,t);for(var e in t)a(e,t[e])};var a=function(t,e){i.actions[t]||(i.actions[t]={}),Object.assign(i.actions[t],{value:e})};e.setActionOptionsFor=function(t,e){var n=(void 0===e?{}:e).closeModal,r=void 0===n||n;Object.assign(i.actions[t],{closeModal:r})},e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(3),i=n(0),a=i.default.OVERLAY,s=i.default.SHOW_MODAL,l=i.default.BUTTON,u=i.default.BUTTON_LOADING,c=n(5);e.openModal=function(){r.getNode(a).classList.add(s),c.default.isOpen=!0},e.onAction=function(t){void 0===t&&(t=o.CANCEL_KEY);var e=c.default.actions[t],n=e.value;if(!1===e.closeModal){var i=l+"--"+t;r.getNode(i).classList.add(u)}else r.getNode(a).classList.remove(s),c.default.isOpen=!1;c.default.promise.resolve(n)},e.getState=function(){var t=Object.assign({},c.default);return delete t.promise,delete t.timer,t},e.stopLoading=function(){for(var t=document.querySelectorAll("."+l),e=0;e<t.length;e++)t[e].classList.remove(u)}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(e){t.exports=e.sweetAlert=n(9)}).call(e,n(7))},function(t,e,n){(function(e){t.exports=e.swal=n(10)}).call(e,n(7))},function(t,e,n){"undefined"!=typeof window&&n(11),n(16);var r=n(23).default;t.exports=r},function(t,e,n){var r=n(12);"string"==typeof r&&(r=[[t.i,r,""]]);var o={insertAt:"top",transform:void 0};n(14)(r,o),r.locals&&(t.exports=r.locals)},function(t,e,n){(t.exports=n(13)(void 0)).push([t.i,'.swal-icon--error{border-color:#f27474;-webkit-animation:animateErrorIcon .5s;animation:animateErrorIcon .5s}.swal-icon--error__x-mark{position:relative;display:block;-webkit-animation:animateXMark .5s;animation:animateXMark .5s}.swal-icon--error__line{position:absolute;height:5px;width:47px;background-color:#f27474;display:block;top:37px;border-radius:2px}.swal-icon--error__line--left{-webkit-transform:rotate(45deg);transform:rotate(45deg);left:17px}.swal-icon--error__line--right{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);right:16px}@-webkit-keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@-webkit-keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}@keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}.swal-icon--warning{border-color:#f8bb86;-webkit-animation:pulseWarning .75s infinite alternate;animation:pulseWarning .75s infinite alternate}.swal-icon--warning__body{width:5px;height:47px;top:10px;border-radius:2px;margin-left:-2px}.swal-icon--warning__body,.swal-icon--warning__dot{position:absolute;left:50%;background-color:#f8bb86}.swal-icon--warning__dot{width:7px;height:7px;border-radius:50%;margin-left:-4px;bottom:-11px}@-webkit-keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}@keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}.swal-icon--success{border-color:#a5dc86}.swal-icon--success:after,.swal-icon--success:before{content:"";border-radius:50%;position:absolute;width:60px;height:120px;background:#fff;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.swal-icon--success:before{border-radius:120px 0 0 120px;top:-7px;left:-33px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:60px 60px;transform-origin:60px 60px}.swal-icon--success:after{border-radius:0 120px 120px 0;top:-11px;left:30px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:0 60px;transform-origin:0 60px;-webkit-animation:rotatePlaceholder 4.25s ease-in;animation:rotatePlaceholder 4.25s ease-in}.swal-icon--success__ring{width:80px;height:80px;border:4px solid hsla(98,55%,69%,.2);border-radius:50%;box-sizing:content-box;position:absolute;left:-4px;top:-4px;z-index:2}.swal-icon--success__hide-corners{width:5px;height:90px;background-color:#fff;padding:1px;position:absolute;left:28px;top:8px;z-index:1;-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.swal-icon--success__line{height:5px;background-color:#a5dc86;display:block;border-radius:2px;position:absolute;z-index:2}.swal-icon--success__line--tip{width:25px;left:14px;top:46px;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-animation:animateSuccessTip .75s;animation:animateSuccessTip .75s}.swal-icon--success__line--long{width:47px;right:8px;top:38px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-animation:animateSuccessLong .75s;animation:animateSuccessLong .75s}@-webkit-keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@-webkit-keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@-webkit-keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}@keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}.swal-icon--info{border-color:#c9dae1}.swal-icon--info:before{width:5px;height:29px;bottom:17px;border-radius:2px;margin-left:-2px}.swal-icon--info:after,.swal-icon--info:before{content:"";position:absolute;left:50%;background-color:#c9dae1}.swal-icon--info:after{width:7px;height:7px;border-radius:50%;margin-left:-3px;top:19px}.swal-icon{width:80px;height:80px;border-width:4px;border-style:solid;border-radius:50%;padding:0;position:relative;box-sizing:content-box;margin:20px auto}.swal-icon:first-child{margin-top:32px}.swal-icon--custom{width:auto;height:auto;max-width:100%;border:none;border-radius:0}.swal-icon img{max-width:100%;max-height:100%}.swal-title{color:rgba(0,0,0,.65);font-weight:600;text-transform:none;position:relative;display:block;padding:13px 16px;font-size:27px;line-height:normal;text-align:center;margin-bottom:0}.swal-title:first-child{margin-top:26px}.swal-title:not(:first-child){padding-bottom:0}.swal-title:not(:last-child){margin-bottom:13px}.swal-text{font-size:16px;position:relative;float:none;line-height:normal;vertical-align:top;text-align:left;display:inline-block;margin:0;padding:0 10px;font-weight:400;color:rgba(0,0,0,.64);max-width:calc(100% - 20px);overflow-wrap:break-word;box-sizing:border-box}.swal-text:first-child{margin-top:45px}.swal-text:last-child{margin-bottom:45px}.swal-footer{text-align:right;padding-top:13px;margin-top:13px;padding:13px 16px;border-radius:inherit;border-top-left-radius:0;border-top-right-radius:0}.swal-button-container{margin:5px;display:inline-block;position:relative}.swal-button{background-color:#7cd1f9;color:#fff;border:none;box-shadow:none;border-radius:5px;font-weight:600;font-size:14px;padding:10px 24px;margin:0;cursor:pointer}.swal-button:not([disabled]):hover{background-color:#78cbf2}.swal-button:active{background-color:#70bce0}.swal-button:focus{outline:none;box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(43,114,165,.29)}.swal-button[disabled]{opacity:.5;cursor:default}.swal-button::-moz-focus-inner{border:0}.swal-button--cancel{color:#555;background-color:#efefef}.swal-button--cancel:not([disabled]):hover{background-color:#e8e8e8}.swal-button--cancel:active{background-color:#d7d7d7}.swal-button--cancel:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(116,136,150,.29)}.swal-button--danger{background-color:#e64942}.swal-button--danger:not([disabled]):hover{background-color:#df4740}.swal-button--danger:active{background-color:#cf423b}.swal-button--danger:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(165,43,43,.29)}.swal-content{padding:0 20px;margin-top:20px;font-size:medium}.swal-content:last-child{margin-bottom:20px}.swal-content__input,.swal-content__textarea{-webkit-appearance:none;background-color:#fff;border:none;font-size:14px;display:block;box-sizing:border-box;width:100%;border:1px solid rgba(0,0,0,.14);padding:10px 13px;border-radius:2px;transition:border-color .2s}.swal-content__input:focus,.swal-content__textarea:focus{outline:none;border-color:#6db8ff}.swal-content__textarea{resize:vertical}.swal-button--loading{color:transparent}.swal-button--loading~.swal-button__loader{opacity:1}.swal-button__loader{position:absolute;height:auto;width:43px;z-index:2;left:50%;top:50%;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);text-align:center;pointer-events:none;opacity:0}.swal-button__loader div{display:inline-block;float:none;vertical-align:baseline;width:9px;height:9px;padding:0;border:none;margin:2px;opacity:.4;border-radius:7px;background-color:hsla(0,0%,100%,.9);transition:background .2s;-webkit-animation:swal-loading-anim 1s infinite;animation:swal-loading-anim 1s infinite}.swal-button__loader div:nth-child(3n+2){-webkit-animation-delay:.15s;animation-delay:.15s}.swal-button__loader div:nth-child(3n+3){-webkit-animation-delay:.3s;animation-delay:.3s}@-webkit-keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}@keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}.swal-overlay{position:fixed;top:0;bottom:0;left:0;right:0;text-align:center;font-size:0;overflow-y:auto;background-color:rgba(0,0,0,.4);z-index:10000;pointer-events:none;opacity:0;transition:opacity .3s}.swal-overlay:before{content:" ";display:inline-block;vertical-align:middle;height:100%}.swal-overlay--show-modal{opacity:1;pointer-events:auto}.swal-overlay--show-modal .swal-modal{opacity:1;pointer-events:auto;box-sizing:border-box;-webkit-animation:showSweetAlert .3s;animation:showSweetAlert .3s;will-change:transform}.swal-modal{width:478px;opacity:0;pointer-events:none;background-color:#fff;text-align:center;border-radius:5px;position:static;margin:20px auto;display:inline-block;vertical-align:middle;-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;z-index:10001;transition:opacity .2s,-webkit-transform .3s;transition:transform .3s,opacity .2s;transition:transform .3s,opacity .2s,-webkit-transform .3s}@media (max-width:500px){.swal-modal{width:calc(100% - 20px)}}@-webkit-keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}',""])},function(t,e){function n(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var o=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(r);return[n].concat(r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"})).concat([o]).join("\n")}return[n].join("\n")}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var r=n(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(t,e,n){function r(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=h[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(c(r.parts[i],e))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(c(r.parts[i],e));h[r.id]={id:r.id,refs:1,parts:a}}}}function o(t,e){for(var n=[],r={},o=0;o<t.length;o++){var i=t[o],a=e.base?i[0]+e.base:i[0],s=i[1],l=i[2],u=i[3],c={css:s,media:l,sourceMap:u};r[a]?r[a].parts.push(c):n.push(r[a]={id:a,parts:[c]})}return n}function i(t,e){var n=p(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=y[y.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function a(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function s(t){var e=document.createElement("style");return t.attrs.type="text/css",u(e,t.attrs),i(t,e),e}function l(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",u(e,t.attrs),i(t,e),e}function u(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function c(t,e){var n,r,o,i;if(e.transform&&t.css){if(!(i=e.transform(t.css)))return function(){};t.css=i}if(e.singleton){var u=v++;n=g||(g=s(e)),r=f.bind(null,n,u,!1),o=f.bind(null,n,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=l(e),r=function(t,e,n){var r=n.css,o=n.sourceMap,i=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||i)&&(r=m(r)),o&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([r],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n,e),o=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(e),r=function(t,e){var n=e.css,r=e.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),o=function(){a(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}function f(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=b(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}var h={},d=function(t){var e;return function(){return void 0===e&&(e=function(){return window&&document&&document.all&&!window.atob}.apply(this,arguments)),e}}(),p=function(t){var e={};return function(t){return void 0===e[t]&&(e[t]=function(t){return document.querySelector(t)}.call(this,t)),e[t]}}(),g=null,v=0,y=[],m=n(15);t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=d()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=o(t,e);return r(n,e),function(t){for(var i=[],a=0;a<n.length;a++){var s=n[a],l=h[s.id];l.refs--,i.push(l)}t&&r(o(t,e),e);for(var a=0;a<i.length;a++){var l=i[a];if(0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete h[l.id]}}}};var b=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,r=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var o,i=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(i)?t:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:r+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},function(t,e,n){var r=n(17);"undefined"==typeof window||window.Promise||(window.Promise=r),n(21),String.prototype.includes||(String.prototype.includes=function(t,e){"use strict";return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;for(var o=0|e,i=Math.max(o>=0?o:r-Math.abs(o),0);i<r;){if(function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}(n[i],t))return!0;i++}return!1}}),"undefined"!=typeof window&&function(t){t.forEach(function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype])},function(t,e,n){(function(e){!function(n){function r(){}function o(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(t,this)}function i(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void s(e.promise,t)}a(e.promise,r)}else(1===t._state?a:s)(e.promise,t._value)})):t._deferreds.push(e)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void l(t);if("function"==typeof n)return void c(function(t,e){return function(){t.apply(e,arguments)}}(n,e),t)}t._state=1,t._value=e,l(t)}catch(e){s(t,e)}}function s(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&o._immediateFn(function(){t._handled||o._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)i(t,t._deferreds[e]);t._deferreds=null}function u(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function c(t,e){var n=!1;try{t(function(t){n||(n=!0,a(e,t))},function(t){n||(n=!0,s(e,t))})}catch(t){if(n)return;n=!0,s(e,t)}}var f=setTimeout;o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=new this.constructor(r);return i(this,new u(t,e,n)),n},o.all=function(t){var e=Array.prototype.slice.call(t);return new o(function(t,n){function r(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(t){r(i,t)},n)}e[i]=a,0==--o&&t(e)}catch(t){n(t)}}if(0===e.length)return t([]);for(var o=e.length,i=0;i<e.length;i++)r(i,e[i])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)})},o._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){f(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},o._setImmediateFn=function(t){o._immediateFn=t},o._setUnhandledRejectionFn=function(t){o._unhandledRejectionFn=t},void 0!==t&&t.exports?t.exports=o:n.Promise||(n.Promise=o)}(this)}).call(e,n(18).setImmediate)},function(t,r,o){function i(t,e){this._id=t,this._clearFn=e}var a=Function.prototype.apply;r.setTimeout=function(){return new i(a.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new i(a.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},r.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},r._unrefActive=r.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},o(19),r.setImmediate=e,r.clearImmediate=n},function(t,e,n){(function(t,e){!function(t,n){"use strict";function r(t){delete s[t]}function o(t){if(l)setTimeout(o,0,t);else{var e=s[t];if(e){l=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{r(t),l=!1}}}}if(!t.setImmediate){var i,a=1,s={},l=!1,u=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick(function(){o(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&o(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),i=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){o(t.data)},i=function(e){t.port2.postMessage(e)}}():u&&"onreadystatechange"in u.createElement("script")?function(){var t=u.documentElement;i=function(e){var n=u.createElement("script");n.onreadystatechange=function(){o(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():i=function(t){setTimeout(o,0,t)},c.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return s[a]=r,i(a),a++},c.clearImmediate=r}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n(7),n(20))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(u===setTimeout)return setTimeout(t,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function i(){p&&h&&(p=!1,h.length?d=h.concat(d):g=-1,d.length&&a())}function a(){if(!p){var t=o(i);p=!0;for(var e=d.length;e;){for(h=d,d=[];++g<e;)h&&h[g].run();g=-1,e=d.length}h=null,p=!1,function(t){if(c===clearTimeout)return clearTimeout(t);if((c===r||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}(t)}}function s(t,e){this.fun=t,this.array=e}function l(){}var u,c,f=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(t){u=n}try{c="function"==typeof clearTimeout?clearTimeout:r}catch(t){c=r}}();var h,d=[],p=!1,g=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new s(t,e)),1!==d.length||p||o(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){"use strict";n(22).polyfill()},function(t,e,n){"use strict";function r(t,e){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var i=Object.keys(Object(o)),a=0,s=i.length;a<s;a++){var l=i[a],u=Object.getOwnPropertyDescriptor(o,l);void 0!==u&&u.enumerable&&(n[l]=o[l])}}return n}t.exports={assign:r,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:r})}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(24),o=n(6),i=n(5),a=n(36),s=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof window){var n=a.getOpts.apply(void 0,t);return new Promise(function(t,e){i.default.promise={resolve:t,reject:e},r.default(n),setTimeout(function(){o.openModal()})})}};s.close=o.onAction,s.getState=o.getState,s.setActionValue=i.setActionValue,s.stopLoading=o.stopLoading,s.setDefaults=a.setDefaults,e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(0),i=o.default.MODAL,a=n(4),s=n(34),l=n(35),u=n(1);e.init=function(t){r.getNode(i)||(document.body||u.throwErr("You can only use SweetAlert AFTER the DOM has loaded!"),s.default(),a.default()),a.initModalContent(t),l.default(t)},e.default=e.init},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=r.default.MODAL;e.modalMarkup='\n  <div class="'+o+'" role="dialog" aria-modal="true"></div>',e.default=e.modalMarkup},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=r.default.OVERLAY,i='<div \n    class="'+o+'"\n    tabIndex="-1">\n  </div>';e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=r.default.ICON;e.errorIconMarkup=function(){var t=o+"--error",e=t+"__line";return'\n    <div class="'+t+'__x-mark">\n      <span class="'+e+" "+e+'--left"></span>\n      <span class="'+e+" "+e+'--right"></span>\n    </div>\n  '},e.warningIconMarkup=function(){var t=o+"--warning";return'\n    <span class="'+t+'__body">\n      <span class="'+t+'__dot"></span>\n    </span>\n  '},e.successIconMarkup=function(){var t=o+"--success";return'\n    <span class="'+t+"__line "+t+'__line--long"></span>\n    <span class="'+t+"__line "+t+'__line--tip"></span>\n\n    <div class="'+t+'__ring"></div>\n    <div class="'+t+'__hide-corners"></div>\n  '}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=r.default.CONTENT;e.contentMarkup='\n  <div class="'+o+'">\n\n  </div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=r.default.BUTTON_CONTAINER,i=r.default.BUTTON,a=r.default.BUTTON_LOADER;e.buttonMarkup='\n  <div class="'+o+'">\n\n    <button\n      class="'+i+'"\n    ></button>\n\n    <div class="'+a+'">\n      <div></div>\n      <div></div>\n      <div></div>\n    </div>\n\n  </div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),o=n(2),i=n(0),a=i.default.ICON,s=i.default.ICON_CUSTOM,l=["error","warning","success","info"],u={error:o.errorIconMarkup(),warning:o.warningIconMarkup(),success:o.successIconMarkup()};e.default=function(t){if(t){var e=r.injectElIntoModal(o.iconMarkup);l.includes(t)?function(t,e){var n=a+"--"+t;e.classList.add(n);var r=u[t];r&&(e.innerHTML=r)}(t,e):function(t,e){e.classList.add(s);var n=document.createElement("img");n.src=t,e.appendChild(n)}(t,e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(4),i=function(t){navigator.userAgent.includes("AppleWebKit")&&(t.style.display="none",t.offsetHeight,t.style.display="")};e.initTitle=function(t){if(t){var e=o.injectElIntoModal(r.titleMarkup);e.textContent=t,i(e)}},e.initText=function(t){if(t){var e=document.createDocumentFragment();t.split("\n").forEach(function(t,n,r){e.appendChild(document.createTextNode(t)),n<r.length-1&&e.appendChild(document.createElement("br"))});var n=o.injectElIntoModal(r.textMarkup);n.appendChild(e),i(n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(4),i=n(0),a=i.default.BUTTON,s=i.default.DANGER_BUTTON,l=n(3),u=n(2),c=n(6),f=n(5),h=function(t,e,n){var o=e.text,i=e.value,h=e.className,d=e.closeModal,p=r.stringToNode(u.buttonMarkup),g=p.querySelector("."+a),v=a+"--"+t;g.classList.add(v),h&&(Array.isArray(h)?h:h.split(" ")).filter(function(t){return t.length>0}).forEach(function(t){g.classList.add(t)}),n&&t===l.CONFIRM_KEY&&g.classList.add(s),g.textContent=o;var y={};return y[t]=i,f.setActionValue(y),f.setActionOptionsFor(t,{closeModal:d}),g.addEventListener("click",function(){return c.onAction(t)}),p};e.default=function(t,e){var n=o.injectElIntoModal(u.footerMarkup);for(var r in t){var i=t[r],a=h(r,i,e);i.visible&&n.appendChild(a)}0===n.children.length&&n.remove()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),o=n(4),i=n(2),a=n(5),s=n(6),l=n(0),u=l.default.CONTENT,c=function(t){t.addEventListener("input",function(t){var e=t.target,n=e.value;a.setActionValue(n)}),t.addEventListener("keyup",function(t){if("Enter"===t.key)return s.onAction(r.CONFIRM_KEY)}),setTimeout(function(){t.focus(),a.setActionValue("")},0)};e.default=function(t){if(t){var e=o.injectElIntoModal(i.contentMarkup),n=t.element,r=t.attributes;"string"==typeof n?function(t,e,n){var r=document.createElement(e),o=u+"__"+e;for(var i in r.classList.add(o),n){var a=n[i];r[i]=a}"input"===e&&c(r),t.appendChild(r)}(e,n,r):e.appendChild(n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(2);e.default=function(){var t=r.stringToNode(o.overlayMarkup);document.body.appendChild(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(6),i=n(1),a=n(3),s=n(0),l=s.default.MODAL,u=s.default.BUTTON,c=s.default.OVERLAY,f=function(t){if(r.default.isOpen)switch(t.key){case"Escape":return o.onAction(a.CANCEL_KEY)}},h=function(t){if(r.default.isOpen)switch(t.key){case"Tab":return function(t){t.preventDefault(),p()}(t)}},d=function(t){if(r.default.isOpen)return"Tab"===t.key&&t.shiftKey?function(t){t.preventDefault(),g()}(t):void 0},p=function(){var t=i.getNode(u);t&&(t.tabIndex=0,t.focus())},g=function(){var t=i.getNode(l),e=t.querySelectorAll("."+u),n=e.length-1,r=e[n];r&&r.focus()},v=function(){var t=i.getNode(l),e=t.querySelectorAll("."+u);e.length&&(function(t){t[t.length-1].addEventListener("keydown",h)}(e),function(t){t[0].addEventListener("keydown",d)}(e))},y=function(t){if(i.getNode(c)===t.target)return o.onAction(a.CANCEL_KEY)};e.default=function(t){t.closeOnEsc?document.addEventListener("keyup",f):document.removeEventListener("keyup",f),t.dangerMode?p():g(),v(),function(t){var e=i.getNode(c);e.removeEventListener("click",y),t&&e.addEventListener("click",y)}(t.closeOnClickOutside),function(t){r.default.timer&&clearTimeout(r.default.timer),t&&(r.default.timer=window.setTimeout(function(){return o.onAction(a.CANCEL_KEY)},t))}(t.timer)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(3),i=n(37),a=n(38),s={title:null,text:null,icon:null,buttons:o.defaultButtonList,content:null,className:null,closeOnClickOutside:!0,closeOnEsc:!0,dangerMode:!1,timer:null},l=Object.assign({},s);e.setDefaults=function(t){l=Object.assign({},s,t)};var u=function(t){var e=t&&t.button,n=t&&t.buttons;return void 0!==e&&void 0!==n&&r.throwErr("Cannot set both 'button' and 'buttons' options!"),void 0!==e?{confirm:e}:n},c=function(t){return r.ordinalSuffixOf(t+1)},f=function(t,e){r.throwErr(c(e)+" argument ('"+t+"') is invalid")},h=function(t,e){var n=t+1,o=e[n];r.isPlainObject(o)||void 0===o||r.throwErr("Expected "+c(n)+" argument ('"+o+"') to be a plain object")},d=function(t,e,n,o){var i=typeof e,a="string"===i,s=e instanceof Element;if(a){if(0===n)return{text:e};if(1===n)return{text:e,title:o[0]};if(2===n)return h(n,o),{icon:e};f(e,n)}else{if(s&&0===n)return h(n,o),{content:e};if(r.isPlainObject(e))return function(t,e){var n=t+1,o=e[n];void 0!==o&&r.throwErr("Unexpected "+c(n)+" argument ("+o+")")}(n,o),e;f(e,n)}};e.getOpts=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n={};t.forEach(function(e,r){var o=d(0,e,r,t);Object.assign(n,o)});var r=u(n);n.buttons=o.getButtonListOpts(r),delete n.button,n.content=i.getContentOpts(n.content);var c=Object.assign({},s,l,n);return Object.keys(c).forEach(function(t){a.DEPRECATED_OPTS[t]&&a.logDeprecation(t)}),c}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o={element:"input",attributes:{placeholder:""}};e.getContentOpts=function(t){return r.isPlainObject(t)?Object.assign({},t):t instanceof Element?{element:t}:"input"===t?o:null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.logDeprecation=function(t){var n=e.DEPRECATED_OPTS[t],r=n.onlyRename,o=n.replacement,i=n.subOption,a=n.link,s=r?"renamed":"deprecated",l='SweetAlert warning: "'+t+'" option has been '+s+".";o&&(l+=" Please use"+(i?' "'+i+'" in ':" ")+'"'+o+'" instead.');var u="https://sweetalert.js.org";l+=a?" More details: "+u+a:" More details: "+u+"/guides/#upgrading-from-1x",console.warn(l)},e.DEPRECATED_OPTS={type:{replacement:"icon",link:"/docs/#icon"},imageUrl:{replacement:"icon",link:"/docs/#icon"},customClass:{replacement:"className",onlyRename:!0,link:"/docs/#classname"},imageSize:{},showCancelButton:{replacement:"buttons",link:"/docs/#buttons"},showConfirmButton:{replacement:"button",link:"/docs/#button"},confirmButtonText:{replacement:"button",link:"/docs/#button"},confirmButtonColor:{},cancelButtonText:{replacement:"buttons",link:"/docs/#buttons"},closeOnConfirm:{replacement:"button",subOption:"closeModal",link:"/docs/#button"},closeOnCancel:{replacement:"buttons",subOption:"closeModal",link:"/docs/#buttons"},showLoaderOnConfirm:{replacement:"buttons"},animation:{},inputType:{replacement:"content",link:"/docs/#content"},inputValue:{replacement:"content",link:"/docs/#content"},inputPlaceholder:{replacement:"content",link:"/docs/#content"},html:{replacement:"content",link:"/docs/#content"},allowEscapeKey:{replacement:"closeOnEsc",onlyRename:!0,link:"/docs/#closeonesc"},allowClickOutside:{replacement:"closeOnClickOutside",onlyRename:!0,link:"/docs/#closeonclickoutside"}}}])}).call(this,n(127).setImmediate,n(127).clearImmediate)},function(t,e,n){var r=n(158),o=n(135).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,e){t.exports={}},function(t,e,n){"use strict";var r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!r.call({1:2},1);e.f=i?function(t){var e=o(this,t);return!!e&&e.enumerable}:r},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(49);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(41),o=n(137),i=r["__core-js_shared__"]||o("__core-js_shared__",{});(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.0.1",mode:n(111)?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var r=n(53),o=n(196),i=n(135),a=n(164),s=n(136),l=n(112)("IE_PROTO"),u=function(){},c=function(){var t,e=s("iframe"),n=i.length;for(e.style.display="none",a.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),c=t.F;n--;)delete c.prototype[i[n]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(u.prototype=r(t),n=new u,u.prototype=null,n[l]=t):n=c(),void 0===e?n:o(n,e)},n(96)[l]=!0},function(t,e){t.exports={}},function(t,e,n){var r=n(113)("meta"),o=n(168),i=n(49),a=n(55),s=n(59).f,l=0,u=Object.isExtensible||function(){return!0},c=function(t){s(t,r,{value:{objectID:"O"+ ++l,weakData:{}}})},f=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,r)){if(!u(t))return"F";if(!e)return"E";c(t)}return t[r].objectID},getWeakData:function(t,e){if(!a(t,r)){if(!u(t))return!0;if(!e)return!1;c(t)}return t[r].weakData},onFreeze:function(t){return o&&f.REQUIRED&&u(t)&&!a(t,r)&&c(t),t}};n(96)[r]=!0},function(t,e,n){var r=n(144);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var r=n(104),o=n(109),i=n(68),a=n(57),s=n(145);t.exports=function(t,e){var n=1==t,l=2==t,u=3==t,c=4==t,f=6==t,h=5==t||f,d=e||s;return function(e,s,p){for(var g,v,y=i(e),m=o(y),b=r(s,p,3),w=a(m.length),C=0,O=n?d(e,w):l?d(e,0):void 0;w>C;C++)if((h||C in m)&&(v=b(g=m[C],C,y),t))if(n)O[C]=v;else if(v)switch(t){case 3:return!0;case 5:return g;case 6:return C;case 2:O.push(g)}else if(c)return!1;return f?-1:u||c?c:O}}},function(t,e,n){var r=n(37),o=n(46)("species");t.exports=function(t){return!r(function(){var e=[];return(e.constructor={})[o]=function(){return{foo:1}},1!==e[t](Boolean).foo})}},function(t,e,n){"use strict";var r=n(180),o=n(204)("trim");n(27)({target:"String",proto:!0,forced:o},{trim:function(){return r(this,3)}})},function(t,e,n){"use strict";n.d(e,"a",function(){return s});n(7),n(75),n(6),n(8),n(9);var r=n(14),o=n(5);function i(t){var e=t.isShiftKey,n=t.isLeftClick,r=t.isRightClick,i=t.coords,a=t.selection,s=t.controller,l=a.isSelected()?a.getSelectedRange().current():null,u=a.isSelectedByCorner(),c=a.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cells?a.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cells?a.setRangeEnd(new o.a(i.row,i.col)):u&&i.row<0&&!s.column?a.setRangeEnd(new o.a(l.to.row,i.col)):c&&i.col<0&&!s.row?a.setRangeEnd(new o.a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?a.selectRows(l.from.row,i.row):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&a.selectColumns(l.from.col,i.col);else{var f=new o.a(i.row,i.col);f.row<0&&(f.row=0),f.col<0&&(f.col=0);var h=!a.inInSelection(f),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&a.selectColumns(i.col):i.col<0&&i.row>=0&&!s.row?d&&a.selectRows(i.row):i.col>=0&&i.row>=0&&!s.cells?d&&a.setRangeStart(i):i.col<0&&i.row<0&&a.setRangeStart(i)}}var a=new Map([["mousedown",i],["mouseover",function(t){var e=t.isLeftClick,n=t.coords,r=t.selection,i=t.controller;if(e){var a=r.isSelectedByRowHeader(),s=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();s&&!i.column?r.setRangeEnd(new o.a(u-1,n.col)):a&&!i.row?r.setRangeEnd(new o.a(n.row,l-1)):i.cell||r.setRangeEnd(n)}}],["touchstart",i]]);function s(t,e){var n=e.coords,o=e.selection,i=e.controller;a.get(t.type)({coords:n,selection:o,controller:i,isShiftKey:t.shiftKey,isLeftClick:Object(r.isLeftClick)(t)||"touchstart"===t.type,isRightClick:Object(r.isRightClick)(t)})}},function(t,e,n){var r=n(37),o=n(78),i="".split;t.exports=r(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==o(t)?i.call(t,""):Object(t)}:Object},function(t,e,n){var r=n(85),o=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?o(n+e,0):i(n,e)}},function(t,e){t.exports=!1},function(t,e,n){var r=n(100)("keys"),o=n(113);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(37),o=/#|\.prototype\./,i=function(t,e){var n=s[a(t)];return n==u||n!=l&&("function"==typeof e?r(e):!!e)},a=i.normalize=function(t){return String(t).replace(o,".").toLowerCase()},s=i.data={},l=i.NATIVE="N",u=i.POLYFILL="P";t.exports=i},function(t,e,n){var r=n(46)("unscopables"),o=n(101),i=n(67),a=Array.prototype;null==a[r]&&i(a,r,o(null)),t.exports=function(t){a[r][t]=!0}},function(t,e,n){var r=n(55),o=n(68),i=n(112)("IE_PROTO"),a=n(166),s=Object.prototype;t.exports=a?Object.getPrototypeOf:function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){var r=n(59).f,o=n(55),i=n(46)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,i)&&r(t,i,{configurable:!0,value:e})}},function(t,e,n){var r=n(78);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){"use strict";var r=n(41),o=n(115),i=n(27),a=n(71),s=n(103),l=n(143),u=n(142),c=n(49),f=n(37),h=n(173),d=n(118),p=n(146);t.exports=function(t,e,n,g,v){var y=r[t],m=y&&y.prototype,b=y,w=g?"set":"add",C={},O=function(t){var e=m[t];a(m,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!c(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:function(t,n){return e.call(this,0===t?0:t,n),this})};if(o(t,"function"!=typeof y||!(v||m.forEach&&!f(function(){(new y).entries().next()}))))b=n.getConstructor(e,t,g,w),s.REQUIRED=!0;else if(o(t,!0)){var E=new b,S=E[w](v?{}:-0,1)!=E,k=f(function(){E.has(1)}),R=h(function(t){new y(t)}),T=!v&&f(function(){for(var t=new y,e=5;e--;)t[w](e,e);return!t.has(-0)});R||((b=e(function(e,n){u(e,b,t);var r=p(new y,e,b);return null!=n&&l(n,r[w],r,g),r})).prototype=m,m.constructor=b),(k||T)&&(O("delete"),O("has"),g&&O("get")),(T||S)&&O(w),v&&m.clear&&delete m.clear}return C[t]=b,i({global:!0,forced:b!=y},C),d(b,t),v||n.setStrong(b,t,g),b}},function(t,e,n){"use strict";var r=n(99),o=n(59),i=n(98);t.exports=function(t,e,n){var a=r(e);a in t?o.f(t,a,i(0,n)):t[a]=n}},function(t,e,n){"use strict";var r=n(37);t.exports=function(t,e){var n=[][t];return!n||!r(function(){n.call(null,e||function(){throw 1},1)})}},function(t,e,n){var r=n(78),o=n(150);t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var i=n.call(t,e);if("object"!=typeof i)throw TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(t))throw TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},function(t,e,n){"use strict";var r=n(67),o=n(71),i=n(37),a=n(46),s=n(150),l=a("species"),u=!i(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),c=!i(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]});t.exports=function(t,e,n,f){var h=a(t),d=!i(function(){var e={};return e[h]=function(){return 7},7!=""[t](e)}),p=d&&!i(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[l]=function(){return n}),n[h](""),!e});if(!d||!p||"replace"===t&&!u||"split"===t&&!c){var g=/./[h],v=n(h,""[t],function(t,e,n,r,o){return e.exec===s?d&&!o?{done:!0,value:g.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),y=v[0],m=v[1];o(String.prototype,t,y),o(RegExp.prototype,h,2==e?function(t,e){return m.call(t,this,e)}:function(t){return m.call(t,this)}),f&&r(RegExp.prototype[h],"sham",!0)}}},function(t,e,n){var r=n(58),o=n(46)("match"),i=n(41),a=n(115),s=n(146),l=n(59).f,u=n(95).f,c=n(148),f=n(147),h=n(71),d=n(37),p=i.RegExp,g=p.prototype,v=/a/g,y=/a/g,m=new p(v)!==v;if(a("RegExp",r&&(!m||d(function(){return y[o]=!1,p(v)!=v||p(y)==y||"/a/i"!=p(v,"i")})))){for(var b=function(t,e){var n=this instanceof b,r=c(t),o=void 0===e;return!n&&r&&t.constructor===b&&o?t:s(m?new p(r&&!o?t.source:t,e):p((r=t instanceof b)?t.source:t,r&&o?f.call(t):e),n?this:g,b)},w=function(t){t in b||l(b,t,{configurable:!0,get:function(){return p[t]},set:function(e){p[t]=e}})},C=u(p),O=0;O<C.length;)w(C[O++]);g.constructor=b,b.prototype=g,h(i,"RegExp",b)}n(179)("RegExp")},function(t,e,n){"use strict";var r=n(53),o=n(57),i=n(63),a=n(149),s=n(123);n(124)("match",1,function(t,e,n){return[function(e){var n=i(this),r=null==e?void 0:e[t];return void 0!==r?r.call(e,n):new RegExp(e)[t](String(n))},function(t){var i=n(e,t,this);if(i.done)return i.value;var l=r(t),u=String(this);if(!l.global)return s(l,u);var c=l.unicode;l.lastIndex=0;for(var f,h=[],d=0;null!==(f=s(l,u));){var p=String(f[0]);h[d]=p,""===p&&(l.lastIndex=a(u,o(l.lastIndex),c)),d++}return 0===d?null:h}]})},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(210),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(186))},function(t,e,n){var r=n(174),o=n(217),i=n(67),a=n(41);for(var s in r){var l=a[s],u=l&&l.prototype;if(u&&u.forEach!==o)try{i(u,"forEach",o)}catch(t){u.forEach=o}}},function(t,e,n){"use strict";var r=n(57),o=n(151),i=n(152)("startsWith"),a="".startsWith;n(27)({target:"String",proto:!0,forced:!i},{startsWith:function(t){var e=o(this,t,"startsWith"),n=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return a?a.call(e,i,n):e.slice(n,n+i.length)===i}})},function(t,e,n){"use strict";function r(t){var e=new Date(t);return isNaN(new Date("".concat(t,"T00:00")).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}n.r(e),n.d(e,"getNormalizedDate",function(){return r})},function(t,e,n){"use strict";n(10),n(11),n(12),n(7),n(6),n(8),n(9);var r=n(13),o=n(2);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(){}a.prototype={licenseKey:void 0,data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:{autoInsertRow:!1},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!0,autoWrapCol:!0,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(t){var e,n,a,s;for(e=0,n=this.countCols();e<n;e++)if(""!==(a=this.getDataAtCell(t,e))&&null!==a&&Object(r.isDefined)(a))return"object"===i(a)&&(s=this.getCellMeta(t,e),Object(o.isObjectEqual)(this.getSchema()[s.prop],a));return!0},isEmptyCol:function(t){var e,n,o;for(e=0,n=this.countRows();e<n;e++)if(""!==(o=this.getDataAtCell(e,t))&&null!==o&&Object(r.isDefined)(o))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,manualColumnFreeze:void 0,trimWhitespace:!0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0,nestedRows:void 0},e.a=a},function(t,e,n){"use strict";var r=n(1),o=n(69),i=n(54);n(79),n(80);var a=Object(i.a)("phraseFormatters"),s=a.register,l=a.getValues;s("pluralize",function(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t});var u=n(13);function c(t,e,n){var i=Object(o.b)(t);if(null===i)return null;var a=i[e];if(Object(u.isUndefined)(a))return null;var s=function(t,e){var n=t;return Object(r.arrayEach)(l(),function(r){n=r(t,e)}),n}(a,n);return Array.isArray(s)?s[0]:s}n.d(e,"a",function(){return c})},function(t,e,n){
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * json-patch-duplex.js version: 0.5.7
 * (c) 2013 Joachim Wester
 * MIT license
 */
var r,o=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=Error;!function(t){var e=function(t){if(l(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e};var n={add:function(t,e){return t[e]=this.value,!0},remove:function(t,e){return delete t[e],!0},replace:function(t,e){return t[e]=this.value,!0},move:function(t,e,n){var r={op:"_get",path:this.from};return v(n,[r]),v(n,[{op:"remove",path:this.from}]),v(n,[{op:"add",path:this.path,value:r.value}]),!0},copy:function(t,e,n){var r={op:"_get",path:this.from};return v(n,[r]),v(n,[{op:"add",path:this.path,value:r.value}]),!0},test:function(t,n){return function t(n,r){switch(typeof n){case"undefined":case"boolean":case"string":case"number":return n===r;case"object":if(null===n)return null===r;if(l(n)){if(!l(r)||n.length!==r.length)return!1;for(var o=0,i=n.length;o<i;o++)if(!t(n[o],r[o]))return!1;return!0}var a=e(r).length;if(e(n).length!==a)return!1;for(o=0;o<a;o++)if(!t(n[o],r[o]))return!1;return!0;default:return!1}}(t[n],this.value)},_get:function(t,e){this.value=t[e]}},r={add:function(t,e){return t.splice(e,0,this.value),!0},remove:function(t,e){return t.splice(e,1),!0},replace:function(t,e){return t[e]=this.value,!0},move:n.move,copy:n.copy,test:n.test,_get:n._get},a={add:function(t){for(var e in a.remove.call(this,t),this.value)this.value.hasOwnProperty(e)&&(t[e]=this.value[e]);return!0},remove:function(t){for(var e in t)t.hasOwnProperty(e)&&n.remove.call(this,t,e);return!0},replace:function(t){return v(t,[{op:"remove",path:this.path}]),v(t,[{op:"add",path:this.path,value:this.value}]),!0},move:n.move,copy:n.copy,test:function(t){return JSON.stringify(t)===JSON.stringify(this.value)},_get:function(t){this.value=t}};function s(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}var l,u=[],c=function(){return function(t){this.observers=[],this.obj=t}}(),f=function(){return function(t,e){this.callback=t,this.observer=e}}();function h(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function d(t){for(var e,n=0,r=u.length;n<r;n++)if(u[n].obj===t.object){e=u[n];break}p(e.value,t.object,t.patches,""),t.patches.length&&v(e.value,t.patches);var o=t.patches;return o.length>0&&(t.patches=[],t.callback&&t.callback(o)),o}function p(t,n,r,o){for(var i=e(n),a=e(t),l=!1,u=a.length-1;u>=0;u--){var c=t[d=a[u]];if(n.hasOwnProperty(d)){var f=n[d];"object"==typeof c&&null!=c&&"object"==typeof f&&null!=f?p(c,f,r,o+"/"+s(d)):c!=f&&(!0,r.push({op:"replace",path:o+"/"+s(d),value:h(f)}))}else r.push({op:"remove",path:o+"/"+s(d)}),l=!0}if(l||i.length!=a.length)for(u=0;u<i.length;u++){var d=i[u];t.hasOwnProperty(d)||r.push({op:"add",path:o+"/"+s(d),value:h(n[d])})}}function g(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function v(t,e,o){for(var i,s,u=!1,c=0,f=e.length;c<f;){i=e[c],c++;for(var h=(i.path||"").split("/"),d=t,p=1,v=h.length,m=void 0;;){if(s=h[p],o&&void 0===m&&(void 0===d[s]?m=h.slice(0,p).join("/"):p==v-1&&(m=i.path),void 0!==m&&this.validator(i,c-1,t,m)),p++,void 0===s&&p>=v){u=a[i.op].call(i,d,s,t);break}if(l(d)){if("-"===s)s=d.length;else{if(o&&!g(s))throw new y("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",c-1,i.path,i);s=parseInt(s,10)}if(p>=v){if(o&&"add"===i.op&&s>d.length)throw new y("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",c-1,i.path,i);u=r[i.op].call(i,d,s,t);break}}else if(s&&-1!=s.indexOf("~")&&(s=s.replace(/~1/g,"/").replace(/~0/g,"~")),p>=v){u=n[i.op].call(i,d,s,t);break}d=d[s]}}return u}t.unobserve=function(t,e){e.unobserve()},t.observe=function(t,e){var n,r=function(t){for(var e=0,n=u.length;e<n;e++)if(u[e].obj===t)return u[e]}(t);if(r?n=function(t,e){for(var n=0,r=t.observers.length;n<r;n++)if(t.observers[n].callback===e)return t.observers[n].observer}(r,e):(r=new c(t),u.push(r)),n)return n;if(n={},r.value=h(t),e){n.callback=e,n.next=null;var o=this.intervals||[100,1e3,1e4,6e4];if(void 0===o.push)throw new i("jsonpatch.intervals must be an array");var a=0,s=function(){d(n)},l=function(){clearTimeout(n.next),n.next=setTimeout(function(){s(),a=0,n.next=setTimeout(p,o[a++])},0)},p=function(){s(),a==o.length&&(a=o.length-1),n.next=setTimeout(p,o[a++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",l),window.addEventListener("mouseup",l),window.addEventListener("keydown",l)):(document.documentElement.attachEvent("onmousedown",l),document.documentElement.attachEvent("onmouseup",l),document.documentElement.attachEvent("onkeydown",l))),n.next=setTimeout(p,o[a++])}return n.patches=[],n.object=t,n.unobserve=function(){d(n),clearTimeout(n.next),function(t,e){for(var n=0,r=t.observers.length;n<r;n++)if(t.observers[n].observer===e)return void t.observers.splice(n,1)}(r,n),0===r.observers.length&&u.splice(u.indexOf(r),1),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",l),window.removeEventListener("mouseup",l),window.removeEventListener("keydown",l)):(document.documentElement.detachEvent("onmousedown",l),document.documentElement.detachEvent("onmouseup",l),document.documentElement.detachEvent("onkeydown",l)))},r.observers.push(new f(e,n)),n},t.generate=d,l=Array.isArray?Array.isArray:function(t){return t.push&&"number"==typeof t.length},t.apply=v,t.compare=function(t,e){var n=[];return p(t,e,n,""),n};var y=function(t){function e(e,n,r,o,i){t.call(this,e),this.message=e,this.name=n,this.index=r,this.operation=o,this.tree=i}return o(e,t),e}(i);t.JsonPatchError=y,t.Error=y,t.validator=function(e,r,o,i){if("object"!=typeof e||null===e||l(e))throw new y("Operation is not an object","OPERATION_NOT_AN_OBJECT",r,e,o);if(!n[e.op])throw new y("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",r,e,o);if("string"!=typeof e.path)throw new y("Operation `path` property is not a string","OPERATION_PATH_INVALID",r,e,o);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new y("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",r,e,o);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new y("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",r,e,o);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&function t(e){if(void 0===e)return!0;if("array"==typeof e||"object"==typeof e)for(var n in e)if(t(e[n]))return!0;return!1}(e.value))throw new y("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",r,e,o);if(o)if("add"==e.op){var a=e.path.split("/").length,s=i.split("/").length;if(a!==s+1&&a!==s)throw new y("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",r,e,o)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==i)throw new y("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",r,e,o)}else if("move"===e.op||"copy"===e.op){var u={op:"_get",path:e.from,value:void 0},c=t.validate([u],o);if(c&&"OPERATION_PATH_UNRESOLVABLE"===c.name)throw new y("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",r,e,o)}},t.validate=function(t,e){try{if(!l(t))throw new y("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)e=JSON.parse(JSON.stringify(e)),v.call(this,e,t,!0);else for(var n=0;n<t.length;n++)this.validator(t[n],n)}catch(t){if(t instanceof y)return t;throw t}}}(r||(r={})),e.apply=r.apply,e.observe=r.observe,e.unobserve=r.unobserve,e.generate=r.generate,e.compare=r.compare,e.validate=r.validate,e.validator=r.validator,e.JsonPatchError=r.JsonPatchError,e.Error=r.Error},function(t,e,n){var r=n(70),o=n(57),i=n(110);t.exports=function(t){return function(e,n,a){var s,l=r(e),u=o(l.length),c=i(a,u);if(t&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e,n){var r=n(49),o=n(41).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,e,n){var r=n(41),o=n(67);t.exports=function(t,e){try{o(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){"use strict";var r=n(27),o=n(197),i=n(117),a=n(139),s=n(118),l=n(67),u=n(71),c=n(111),f=n(46)("iterator"),h=n(102),d=n(165),p=d.IteratorPrototype,g=d.BUGGY_SAFARI_ITERATORS,v=function(){return this};t.exports=function(t,e,n,d,y,m,b){o(n,e,d);var w,C,O,E=function(t){if(t===y&&M)return M;if(!g&&t in R)return R[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},S=e+" Iterator",k=!1,R=t.prototype,T=R[f]||R["@@iterator"]||y&&R[y],M=!g&&T||E(y),_="Array"==e&&R.entries||T;if(_&&(w=i(_.call(new t)),p!==Object.prototype&&w.next&&(c||i(w)===p||(a?a(w,p):"function"!=typeof w[f]&&l(w,f,v)),s(w,S,!0,!0),c&&(h[S]=v))),"values"==y&&T&&"values"!==T.name&&(k=!0,M=function(){return T.call(this)}),c&&!b||R[f]===M||l(R,f,M),h[e]=M,y)if(C={values:E("values"),keys:m?M:E("keys"),entries:E("entries")},b)for(O in C)!g&&!k&&O in R||u(R,O,C[O]);else r({target:e,proto:!0,forced:g||k},C);return C}},function(t,e,n){var r=n(198);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,o){return r(n,o),e?t.call(n,o):n.__proto__=o,n}}():void 0)},function(t,e,n){var r=n(85),o=n(63);t.exports=function(t,e,n){var i,a,s=String(o(t)),l=r(e),u=s.length;return l<0||l>=u?n?"":void 0:(i=s.charCodeAt(l))<55296||i>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?n?s.charAt(l):i:n?s.slice(l,l+2):a-56320+(i-55296<<10)+65536}},function(t,e,n){var r=n(71);t.exports=function(t,e,n){for(var o in e)r(t,o,e[o],n);return t}},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}},function(t,e,n){var r=n(53),o=n(170),i=n(57),a=n(104),s=n(171),l=n(172),u={};(t.exports=function(t,e,n,c,f){var h,d,p,g,v,y=a(e,n,c?2:1);if(f)h=t;else{if("function"!=typeof(d=s(t)))throw TypeError("Target is not iterable");if(o(d)){for(p=0,g=i(t.length);g>p;p++)if((c?y(r(v=t[p])[0],v[1]):y(t[p]))===u)return u;return}h=d.call(t)}for(;!(v=h.next()).done;)if(l(h,y,v.value,c)===u)return u}).BREAK=u},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,n){var r=n(49),o=n(119),i=n(46)("species");t.exports=function(t,e){var n;return o(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!o(n.prototype)?r(n)&&null===(n=n[i])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},function(t,e,n){var r=n(49),o=n(139);t.exports=function(t,e,n){var i,a=e.constructor;return a!==n&&"function"==typeof a&&(i=a.prototype)!==n.prototype&&r(i)&&o&&o(t,i),t}},function(t,e,n){"use strict";var r=n(53);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var r=n(49),o=n(78),i=n(46)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==o(t))}},function(t,e,n){"use strict";var r=n(140);t.exports=function(t,e,n){return e+(n?r(t,e,!0).length:1)}},function(t,e,n){"use strict";var r,o,i=n(147),a=RegExp.prototype.exec,s=String.prototype.replace,l=a,u=(r=/a/,o=/b*/g,a.call(r,"a"),a.call(o,"a"),0!==r.lastIndex||0!==o.lastIndex),c=void 0!==/()??/.exec("")[1];(u||c)&&(l=function(t){var e,n,r,o,l=this;return c&&(n=new RegExp("^"+l.source+"$(?!\\s)",i.call(l))),u&&(e=l.lastIndex),r=a.call(l,t),u&&r&&(l.lastIndex=l.global?r.index+r[0].length:e),c&&r&&r.length>1&&s.call(r[0],n,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)}),r}),t.exports=l},function(t,e,n){var r=n(148),o=n(63);t.exports=function(t,e,n){if(r(e))throw TypeError("String.prototype."+n+" doesn't accept regex");return String(o(t))}},function(t,e,n){var r=n(46)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,"/./"[t](e)}catch(t){}}return!1}},function(t,e,n){"use strict";var r=n(105)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),n(27)({target:"Array",proto:!0,forced:o},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(116)("find")},function(t,e,n){"use strict";var r=n(105)(1),o=n(106)("map");n(27)({target:"Array",proto:!0,forced:!o},{map:function(t){return r(this,t,arguments[1])}})},function(t,e){(function(){var t,e,n,r,o,i;o=void 0,d3.ternary={},n=Math.sqrt(3)/2,tickValues=[.2,.4,.6,.8,1],i=function(){var t,e,n,r;for(r="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",t=0;t<=3;++t)e=Math.floor(Math.random()*n.length),r+=n.charAt(e);return r},r=function(t){return t||(t="linear"),o=d3.svg.line().x(function(t){return t[0]}).y(function(t){return t[1]}).interpolate(t)},e=[0,120,240],d3.ternary.graticule=function(){var t,e,n,r,o;return e=.1,r=null,n=function(){var t,n,r;for(r=[],n=t=e;n<1;)r.push(n),n+=t;return r},o=function(){var t,n;if(n=[],null==r)return n;for(t=r;t<1;)t%e!=0&&n.push(t),t+=r;return n},(t=function(t){var e,r;return r=[0,1,2].map(function(){return d3.svg.axis().tickValues(n())}),e=function(e,r){var a,s,l,u;return a=d3.select(this),(l=a.selectAll("path.minor").data(o())).enter().append("path").attr("class",`minor axis-${r}`),(u=a.selectAll("path.major").data(n())).enter().append("path").attr("class",`major axis-${r}`),s=function(){return e.scale(t.scales[r]),l.attr("d",t.rule(r)),u.attr("d",t.rule(r))},t.on("resize."+i(),s),s()},t.axes().selectAll(".graticule").data(r).enter().append("g").attr("class","graticule").each(e)}).axes=function(){return gratAxes},t.majorInterval=function(n){return n?(e=n,t):e},t.minorInterval=function(e){return e?(r=e,t):r},t},d3.ternary.scalebars=function(t){var n,r,o,a,s,l;return null==t&&(t={}),s=null,a=t.labels||null,r=[0,1,2].map(function(t){return d3.svg.axis().tickSize(10).tickFormat(d3.format("%")).tickValues(tickValues).orient("top")}),n=function(t,e){return 0===e?d3.select(this).selectAll("text").attr("transform",function(t){const e=d3.select(this).attr("y");return"translate(22 "+-e+") rotate(60 0 "+4.5*e+")"})&&d3.select(this).selectAll("line").attr("transform",function(t){const e=d3.select(this).attr("y");return"translate(0 "+-e+") rotate(-30 0 "+1*e+")"}):d3.select(this).selectAll("text").attr("transform",function(t){const e=d3.select(this).attr("y");return"translate(-27 "+-e+") rotate(-120 0 "+2.5*e+")"})&&d3.select(this).selectAll("line").attr("transform",function(t){const e=d3.select(this).attr("y");return"translate(0 "+-e+") rotate(-30 0 "+1*e+")"})},o=function(t,e){var n,r,o;return n=-30,r="translate("+(o=s.width())/2+")",2===e&&(n=42,r=" rotate(-180 0 0) translate("+-o/2+")"),d3.select(this).attr("class","label").attr("transform",r).attr("y",n).attr("text-anchor","middle").text(t)},(l=function(t){var l,u;return(l=(s=t).axes().selectAll(".bary-axis").data(e).enter().append("g").attr("class",function(t,e){return t="bary-axis",2===e&&(t+=" bottom"),t})).each(function(){return d3.select(this).append("text").attr("class","label")}),u=function(){var t,e,i;if(r.forEach(function(t,e){var n;return n=s.scales[e].copy(),t.scale(n)}),i=s.radius(),e=s.center(),l.each(function(t,e){var n;return n=d3.select(this),r[e](n)}).attr("transform",function(t,n){return"rotate("+(120*n-60)+" "+e[0]+" "+e[1]+") translate(0 "+i/2+")"}).each(n),t)return s.axes().selectAll(".bary-axis .label").data(a).each(o)},s.on("resize."+i(),u),u()}).labels=function(t){return null==t?a:(a=t,l)},l.axes=r,l},d3.ternary.vertexLabels=function(t){var e=null,n=[0,60,-60];return function(r){var o,a,s;return s=r.vertices(20),o=t.map(function(t,e){return{label:t,vertex:s[e]}}),(e=r.axes().selectAll(".vertex-label").data(o)).enter().append("text").text(function(t){return t.label}).attr("dy",".35em").attr("text-anchor","middle").attr("class",function(t){return"vertex-label "+t.label.toLowerCase()}),a=function(){return e.attr({transform:function(t,e){var r;return"translate("+(r=t.vertex)[0]+","+r[1]+")rotate("+n[e]+")"}})},r.on("resize."+i(),a),a(),e}},d3.ternary.neatline=function(){return function(t){return t.node().append("use").attr("class","neatline").attr("xlink:href","#bounds")}},t=function(t){var e,n,r,o,a,s,l,u,c;for(r=t.scales.map(function(t){return t.domain()}),u=[],s=l=0;l<=2;s=++l)-1===(c=s-1)&&(c=2),(n=r.map(function(t){return t[0]}))[c]=r[c][1],u.push(n),(n=r.map(function(t){return t[0]}))[s]=r[s][1],u.push(n);return e=d3.select(this),null==(a=e.select("#bounds")).node()&&(a=e.append("polygon")),a.datum(u).attr({id:"bounds"}),o=function(){return a.attr({points:function(e){return e.map(function(e){return(s=t.rawPoint(e)).join(",")}).join(" ")}})},t.on("resize."+i(),o),o()},d3.ternary.plot=function(){var e,i,a,s,l,u,c,f,h,d,p,g,v,y,m,b,w,C;return p=500,d=500,h={top:50,bottom:50,left:50,right:50},v=null,u=null,C=null,w=null,i=null,g=null,s=null,b=!1,a=[],m=[0,1,2].map(function(){return d3.scale.linear().domain([0,1]).range([0,1])}),l=d3.dispatch("resize"),f=function(t){return t-h.left-h.right},c=function(t){return t-h.top-h.bottom},y=function(){var n,r;if(null==C&&(C=f(p)),null==u&&(u=c(d)),null==v&&(v=C/Math.sqrt(3)),[C/2,v],null!=w){for(w.attr({transform:"translate("+h.left+","+h.top+")",width:C,height:u}),d3.select(w.node().parentElement).attr({width:p,height:d}),n=0,r=m.length;n<r;n++)m[n].range([0,C]);return t.call(s.node(),e),b&&g.attr({"clip-path":"url(#axesClip)"}),l.resize()}},(e=function(t){return w=t.append("g"),s=w.append("defs"),i=w.append("g").attr("id","axes"),g=w.append("g").attr("id","plot").attr("clip-path","url(#axesClip)"),y(),s.append("clipPath").attr({id:"axesClip"}).append("use").attr({"xlink:href":"#bounds"}),a&&a.forEach(function(t){return t(e)}),a=[]}).on=function(t,e){return l.on(t,e)},e.fit=function(t,r){var o,i,a;return 2===arguments.length?(i=f(t),a=(o=c(r))<=n*i?2*o/3:i/Math.sqrt(3)):a=i/Math.sqrt(3),e.radius(a),e},e.node=function(){return w},e.axes=function(){return i},e.plot=function(){return g},e.call=function(t){return null!=w?t(e):a.push(t),e},e.scales=m,e.margin=function(t){return null==t?h:(h=null!=t.left?t:{left:t,right:t,top:t,bottom:t},y(),e)},e.point=function(t){var n;return 0!==(n=d3.sum(t))&&(t=t.map(function(t){return t/n})),e.rawPoint(t)},e.rawPoint=function(t){var e,r,o,i;return 0===d3.sum(t)?[0,0]:(e=m[0],r=m[1],m[2],o=t[0],i=t[1],t[2],[e(o)/2+r(i),r((1-o)*n)])},e.value=function(t){var e,r,o,i,a,s;return a=t[0],s=t[1],e=m[0],r=m[1],m[2],[o=1-r.invert(s)/n,i=r.invert(a-e(o)/2),1-o-i]},e.path=function(t,n,i){var a;return r(i),n||(n=function(t){return t}),a=t.map(function(t){return e.point(n(t))}),o(a)},e.area=function(t,n,i){var a;return r(i),n||(n=function(t){return t}),a=t.map(function(t){return e.point(n(t))}),o(a)+"Z"},e.rule=function(t){return function(n){var r;return r=[],0===t?r=[[0,1-n,n],[1-n,0,n]]:1===t?r=[[0,n,1-n],[1-n,n,0]]:2===t&&(r=[[n,0,1-n],[n,1-n,0]]),e.path(r)}},e.vertices=function(t){return null==t&&(t=0),[0,-120,120].map(function(e){var n;return n=e*Math.PI/180,[C/2+Math.sin(n)*(v+t),v-Math.cos(n)*(v+t)]})},e.range=function(t){return e},e.radius=function(t){return null==t?v:(v=t,u=3*t/2,C=t*Math.sqrt(3),d=u+h.top+h.bottom,p=C+h.left+h.right,y(),e)},e.center=function(){return[C/2,v]},e.height=function(){return u},e.width=function(){return C},e.clip=function(t){return null==t?b:(b=t,e)},e}}).call(this),t.exports=d3.ternary},function(t,e,n){
/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
!function(e,r){"use strict";var o;try{o=n(25)}catch(t){}t.exports=function(t){var e="function"==typeof t,n=!!window.addEventListener,r=window.document,o=window.setTimeout,i=function(t,e,r,o){n?t.addEventListener(e,r,!!o):t.attachEvent("on"+e,r)},a=function(t,e,r,o){n?t.removeEventListener(e,r,!!o):t.detachEvent("on"+e,r)},s=function(t,e,n){var o;r.createEvent?((o=r.createEvent("HTMLEvents")).initEvent(e,!0,!1),o=v(o,n),t.dispatchEvent(o)):r.createEventObject&&(o=r.createEventObject(),o=v(o,n),t.fireEvent("on"+e,o))},l=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},u=function(t){return/Array/.test(Object.prototype.toString.call(t))},c=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},f=function(t){var e=t.getDay();return 0===e||6===e},h=function(t){return t%4==0&&t%100!=0||t%400==0},d=function(t,e){return[31,h(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},p=function(t){c(t)&&t.setHours(0,0,0,0)},g=function(t,e){return t.getTime()===e.getTime()},v=function(t,e,n){var r,o;for(r in e)(o=void 0!==t[r])&&"object"==typeof e[r]&&null!==e[r]&&void 0===e[r].nodeName?c(e[r])?n&&(t[r]=new Date(e[r].getTime())):u(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=v({},e[r],n):!n&&o||(t[r]=e[r]);return t},y=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},m={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},b=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},w=function(t){var e=[],n="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},C=function(t,e){return"<tr>"+(e?t.reverse():t).join("")+"</tr>"},O=function(t,e,n,r,o,i){var a,s,l,c,f,h=t._o,d=n===h.minYear,p=n===h.maxYear,g='<div id="'+i+'" class="pika-title" role="heading" aria-live="assertive">',v=!0,y=!0;for(l=[],a=0;a<12;a++)l.push('<option value="'+(n===o?a-e:12+a-e)+'"'+(a===r?' selected="selected"':"")+(d&&a<h.minMonth||p&&a>h.maxMonth?'disabled="disabled"':"")+">"+h.i18n.months[a]+"</option>");for(c='<div class="pika-label">'+h.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",u(h.yearRange)?(a=h.yearRange[0],s=h.yearRange[1]+1):(a=n-h.yearRange,s=1+n+h.yearRange),l=[];a<s&&a<=h.maxYear;a++)a>=h.minYear&&l.push('<option value="'+a+'"'+(a===n?' selected="selected"':"")+">"+a+"</option>");return f='<div class="pika-label">'+n+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",h.showMonthAfterYear?g+=f+c:g+=c+f,d&&(0===r||h.minMonth>=r)&&(v=!1),p&&(11===r||h.maxMonth<=r)&&(y=!1),0===e&&(g+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(g+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),g+="</div>"},E=function(a){var s=this,u=s.config(a);s._onMouseDown=function(t){if(s._v){var e=(t=t||window.event).target||t.srcElement;if(e)if(l(e,"is-disabled")||(!l(e,"pika-button")||l(e,"is-empty")||l(e.parentNode,"is-disabled")?l(e,"pika-prev")?s.prevMonth():l(e,"pika-next")&&s.nextMonth():(s.setDate(new Date(e.getAttribute("data-pika-year"),e.getAttribute("data-pika-month"),e.getAttribute("data-pika-day"))),u.bound&&o(function(){s.hide(),u.field&&u.field.blur()},100))),l(e,"pika-select"))s._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}}},s._onChange=function(t){var e=(t=t||window.event).target||t.srcElement;e&&(l(e,"pika-select-month")?s.gotoMonth(e.value):l(e,"pika-select-year")&&s.gotoYear(e.value))},s._onKeyChange=function(t){if(t=t||window.event,s.isVisible())switch(t.keyCode){case 13:case 27:u.field.blur();break;case 37:t.preventDefault(),s.adjustDate("subtract",1);break;case 38:s.adjustDate("subtract",7);break;case 39:s.adjustDate("add",1);break;case 40:s.adjustDate("add",7)}},s._onInputChange=function(n){var r;n.firedBy!==s&&(r=e?(r=t(u.field.value,u.format,u.formatStrict))&&r.isValid()?r.toDate():null:new Date(Date.parse(u.field.value)),c(r)&&s.setDate(r),s._v||s.show())},s._onInputFocus=function(){s.show()},s._onInputClick=function(){s.show()},s._onInputBlur=function(){var t=r.activeElement;do{if(l(t,"pika-single"))return}while(t=t.parentNode);s._c||(s._b=o(function(){s.hide()},50)),s._c=!1},s._onClick=function(t){var e=(t=t||window.event).target||t.srcElement,r=e;if(e){!n&&l(e,"pika-select")&&(e.onchange||(e.setAttribute("onchange","return;"),i(e,"change",s._onChange)));do{if(l(r,"pika-single")||r===u.trigger)return}while(r=r.parentNode);s._v&&e!==u.trigger&&r!==u.trigger&&s.hide()}},s.el=r.createElement("div"),s.el.className="pika-single"+(u.isRTL?" is-rtl":"")+(u.theme?" "+u.theme:""),i(s.el,"mousedown",s._onMouseDown,!0),i(s.el,"touchend",s._onMouseDown,!0),i(s.el,"change",s._onChange),i(r,"keydown",s._onKeyChange),u.field&&(u.container?u.container.appendChild(s.el):u.bound?r.body.appendChild(s.el):u.field.parentNode.insertBefore(s.el,u.field.nextSibling),i(u.field,"change",s._onInputChange),u.defaultDate||(e&&u.field.value?u.defaultDate=t(u.field.value,u.format).toDate():u.defaultDate=new Date(Date.parse(u.field.value)),u.setDefaultDate=!0));var f=u.defaultDate;c(f)?u.setDefaultDate?s.setDate(f,!0):s.gotoDate(f):s.gotoDate(new Date),u.bound?(this.hide(),s.el.className+=" is-bound",i(u.trigger,"click",s._onInputClick),i(u.trigger,"focus",s._onInputFocus),i(u.trigger,"blur",s._onInputBlur)):this.show()};return E.prototype={config:function(t){this._o||(this._o=v({},m,!0));var e=v(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;var n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,c(e.minDate)||(e.minDate=!1),c(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),u(e.yearRange)){var r=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||m.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return c(this._d)?e?t(this._d).format(n||this._o.format):this._d.toDateString():""},getMoment:function(){return e?t(this._d):null},setMoment:function(n,r){e&&t.isMoment(n)&&this.setDate(n.toDate(),r)},getDate:function(){return c(this._d)?new Date(this._d.getTime()):new Date},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",s(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),c(t)){var n=this._o.minDate,r=this._o.maxDate;c(n)&&t<n?t=n:c(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),p(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),s(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(t){var e=!0;if(c(t)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=o<n.getTime()||r.getTime()<o}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,r){var o,i=this.getDate(),a=24*parseInt(r)*60*60*1e3;"add"===n?o=new Date(i.valueOf()+a):"subtract"===n&&(o=new Date(i.valueOf()-a)),e&&("add"===n?o=t(i).add(r,"days").toDate():"subtract"===n&&(o=t(i).subtract(r,"days").toDate())),this.setDate(o)},adjustCalendars:function(){this.calendars[0]=y(this.calendars[0]);for(var t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=y({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(p(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=m.minDate,this._o.minYear=m.minYear,this._o.minMonth=m.minMonth,this._o.startRange=m.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(p(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=m.maxDate,this._o.maxYear=m.maxYear,this._o.maxMonth=m.maxMonth,this._o.endRange=m.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(this._v||t){var e,n=this._o,r=n.minYear,i=n.maxYear,a=n.minMonth,s=n.maxMonth,l="";this._y<=r&&(this._y=r,!isNaN(a)&&this._m<a&&(this._m=a)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s)),e="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var u=0;u<n.numberOfMonths;u++)l+='<div class="pika-lendar">'+O(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,e)+this.render(this.calendars[u].year,this.calendars[u].month,e)+"</div>";this.el.innerHTML=l,n.bound&&"hidden"!==n.field.type&&o(function(){n.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var t,e,n,o,i,a,s,l,u,c;if(!this._o.container){if(this.el.style.position="absolute",e=t=this._o.trigger,n=this.el.offsetWidth,o=this.el.offsetHeight,i=window.innerWidth||r.documentElement.clientWidth,a=window.innerHeight||r.documentElement.clientHeight,s=window.pageYOffset||r.body.scrollTop||r.documentElement.scrollTop,"function"==typeof t.getBoundingClientRect)l=(c=t.getBoundingClientRect()).left+window.pageXOffset,u=c.bottom+window.pageYOffset;else for(l=e.offsetLeft,u=e.offsetTop+e.offsetHeight;e=e.offsetParent;)l+=e.offsetLeft,u+=e.offsetTop;(this._o.reposition&&l+n>i||this._o.position.indexOf("right")>-1&&l-n+t.offsetWidth>0)&&(l=l-n+t.offsetWidth),(this._o.reposition&&u+o>a+s||this._o.position.indexOf("top")>-1&&u-o-t.offsetHeight>0)&&(u=u-o-t.offsetHeight),this.el.style.left=l+"px",this.el.style.top=u+"px"}},render:function(t,e,n){var r=this._o,o=new Date,i=d(t,e),a=new Date(t,e,1).getDay(),s=[],l=[];p(o),r.firstDay>0&&(a-=r.firstDay)<0&&(a+=7);for(var u,h,v,y,m=0===e?11:e-1,O=11===e?0:e+1,E=0===e?t-1:t,S=11===e?t+1:t,k=d(E,m),R=i+a,T=R;T>7;)T-=7;R+=7-T;for(var M=0,_=0;M<R;M++){var N=new Date(t,e,M-a+1),A=!!c(this._d)&&g(N,this._d),x=g(N,o),j=M<a||M>=i+a,I=M-a+1,D=e,P=t,L=r.startRange&&g(r.startRange,N),H=r.endRange&&g(r.endRange,N),F=r.startRange&&r.endRange&&r.startRange<N&&N<r.endRange;j&&(M<a?(I=k+I,D=m,P=E):(I-=i,D=O,P=S));var B={day:I,month:D,year:P,isSelected:A,isToday:x,isDisabled:r.minDate&&N<r.minDate||r.maxDate&&N>r.maxDate||r.disableWeekends&&f(N)||r.disableDayFn&&r.disableDayFn(N),isEmpty:j,isStartRange:L,isEndRange:H,isInRange:F,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths};l.push(w(B)),7==++_&&(r.showWeekNumber&&l.unshift((u=M-a,h=e,v=t,y=void 0,y=new Date(v,0,1),'<td class="pika-week">'+Math.ceil(((new Date(v,h,u)-y)/864e5+y.getDay()+1)/7)+"</td>")),s.push(C(l,r.isRTL)),l=[],_=0)}return function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(t){var e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+b(t,e)+'">'+b(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"}(t)+("<tbody>"+e.join("")+"</tbody>")+"</table>"}(r,s,n)},isVisible:function(){return this._v},show:function(){var t,e,n;this.isVisible()||(t=this.el,e="is-hidden",t.className=(n=(" "+t.className+" ").replace(" "+e+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,""),this._v=!0,this.draw(),this._o.bound&&(i(r,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var t,e,n=this._v;!1!==n&&(this._o.bound&&a(r,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",t=this.el,l(t,e="is-hidden")||(t.className=""===t.className?e:t.className+" "+e),this._v=!1,void 0!==n&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),this._o.field&&(a(this._o.field,"change",this._onInputChange),this._o.bound&&(a(this._o.trigger,"click",this._onInputClick),a(this._o.trigger,"focus",this._onInputFocus),a(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},E}(o)}()},function(t,e,n){var r=n(70),o=n(95).f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==i.call(t)?function(t){try{return o(t)}catch(t){return a.slice()}}(t):o(r(t))}},function(t,e,n){var r=n(55),o=n(70),i=n(134)(!1),a=n(96);t.exports=function(t,e){var n,s=o(t),l=0,u=[];for(n in s)!r(a,n)&&r(s,n)&&u.push(n);for(;e.length>l;)r(s,n=e[l++])&&(~i(u,n)||u.push(n));return u}},function(t,e,n){t.exports=!n(58)&&!n(37)(function(){return 7!=Object.defineProperty(n(136)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){t.exports=n(100)("native-function-to-string",Function.toString)},function(t,e,n){var r=n(160),o=n(41).WeakMap;t.exports="function"==typeof o&&/native code/.test(r.call(o))},function(t,e,n){var r=n(55),o=n(195),i=n(90),a=n(59);t.exports=function(t,e){for(var n=o(e),s=a.f,l=i.f,u=0;u<n.length;u++){var c=n[u];r(t,c)||s(t,c,l(e,c))}}},function(t,e,n){t.exports=!n(37)(function(){return!String(Symbol())})},function(t,e,n){var r=n(41).document;t.exports=r&&r.documentElement},function(t,e,n){"use strict";var r,o,i,a=n(117),s=n(67),l=n(55),u=n(111),c=n(46)("iterator"),f=!1;[].keys&&("next"in(i=[].keys())?(o=a(a(i)))!==Object.prototype&&(r=o):f=!0),null==r&&(r={}),u||l(r,c)||s(r,c,function(){return this}),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},function(t,e,n){t.exports=!n(37)(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})},function(t,e,n){var r=n(78),o=n(46)("toStringTag"),i="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:i?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){t.exports=!n(37)(function(){return Object.isExtensible(Object.preventExtensions({}))})},function(t,e,n){"use strict";var r=n(141),o=n(103).getWeakData,i=n(53),a=n(49),s=n(142),l=n(143),u=n(105),c=n(55),f=n(86),h=f.set,d=f.getterFor,p=u(5),g=u(6),v=0,y=function(t){return t.frozen||(t.frozen=new m)},m=function(){this.entries=[]},b=function(t,e){return p(t.entries,function(t){return t[0]===e})};m.prototype={get:function(t){var e=b(this,t);if(e)return e[1]},has:function(t){return!!b(this,t)},set:function(t,e){var n=b(this,t);n?n[1]=e:this.entries.push([t,e])},delete:function(t){var e=g(this.entries,function(e){return e[0]===t});return~e&&this.entries.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,u){var f=t(function(t,r){s(t,f,e),h(t,{type:e,id:v++,frozen:void 0}),null!=r&&l(r,t[u],t,n)}),p=d(e),g=function(t,e,n){var r=p(t),a=o(i(e),!0);return!0===a?y(r).set(e,n):a[r.id]=n,t};return r(f.prototype,{delete:function(t){var e=p(this);if(!a(t))return!1;var n=o(t);return!0===n?y(e).delete(t):n&&c(n,e.id)&&delete n[e.id]},has:function(t){var e=p(this);if(!a(t))return!1;var n=o(t);return!0===n?y(e).has(t):n&&c(n,e.id)}}),r(f.prototype,n?{get:function(t){var e=p(this);if(a(t)){var n=o(t);return!0===n?y(e).get(t):n?n[e.id]:void 0}},set:function(t,e){return g(this,t,e)}}:{add:function(t){return g(this,t,!0)}}),f}}},function(t,e,n){var r=n(102),o=n(46)("iterator"),i=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||i[o]===t)}},function(t,e,n){var r=n(167),o=n(46)("iterator"),i=n(102);t.exports=function(t){if(null!=t)return t[o]||t["@@iterator"]||i[r(t)]}},function(t,e,n){var r=n(53);t.exports=function(t,e,n,o){try{return o?e(r(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&r(i.call(t)),e}}},function(t,e,n){var r=n(46)("iterator"),o=!1;try{var i=0,a={next:function(){return{done:!!i++}},return:function(){o=!0}};a[r]=function(){return this},Array.from(a,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var i={};i[r]=function(){return{next:function(){return{done:n=!0}}}},t(i)}catch(t){}return n}},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,e,n){e.f=n(46)},function(t,e,n){var r=n(177),o=n(55),i=n(175),a=n(59).f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});o(e,t)||a(e,t,{value:i.f(t)})}},function(t,e,n){t.exports=n(41)},function(t,e,n){"use strict";var r=n(59).f,o=n(101),i=n(141),a=n(104),s=n(142),l=n(143),u=n(138),c=n(179),f=n(58),h=n(103).fastKey,d=n(86),p=d.set,g=d.getterFor;t.exports={getConstructor:function(t,e,n,u){var c=t(function(t,r){s(t,c,e),p(t,{type:e,index:o(null),first:void 0,last:void 0,size:0}),f||(t.size=0),null!=r&&l(r,t[u],t,n)}),d=g(e),v=function(t,e,n){var r,o,i=d(t),a=y(t,e);return a?a.value=n:(i.last=a={index:o=h(e,!0),key:e,value:n,previous:r=i.last,next:void 0,removed:!1},i.first||(i.first=a),r&&(r.next=a),f?i.size++:t.size++,"F"!==o&&(i.index[o]=a)),t},y=function(t,e){var n,r=d(t),o=h(e);if("F"!==o)return r.index[o];for(n=r.first;n;n=n.next)if(n.key==e)return n};return i(c.prototype,{clear:function(){for(var t=d(this),e=t.index,n=t.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete e[n.index],n=n.next;t.first=t.last=void 0,f?t.size=0:this.size=0},delete:function(t){var e=d(this),n=y(this,t);if(n){var r=n.next,o=n.previous;delete e.index[n.index],n.removed=!0,o&&(o.next=r),r&&(r.previous=o),e.first==n&&(e.first=r),e.last==n&&(e.last=o),f?e.size--:this.size--}return!!n},forEach:function(t){for(var e,n=d(this),r=a(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:n.first;)for(r(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!y(this,t)}}),i(c.prototype,n?{get:function(t){var e=y(this,t);return e&&e.value},set:function(t,e){return v(this,0===t?0:t,e)}}:{add:function(t){return v(this,t=0===t?0:t,t)}}),f&&r(c.prototype,"size",{get:function(){return d(this).size}}),c},setStrong:function(t,e,n){var r=e+" Iterator",o=g(e),i=g(r);u(t,e,function(t,e){p(this,{type:r,target:t,state:o(t),kind:e,last:void 0})},function(){for(var t=i(this),e=t.kind,n=t.last;n&&n.removed;)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})},n?"entries":"values",!n,!0),c(e)}}},function(t,e,n){"use strict";var r=n(202),o=n(59),i=n(58),a=n(46)("species");t.exports=function(t){var e=r(t),n=o.f;i&&e&&!e[a]&&n(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var r=n(63),o="["+n(181)+"]",i=RegExp("^"+o+o+"*"),a=RegExp(o+o+"*$");t.exports=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(i,"")),2&e&&(t=t.replace(a,"")),t}},function(t,e){t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},function(t,e,n){var r=n(41).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){"use strict";var r=n(206),o=n(207);n(27)({target:"String",proto:!0,forced:o},{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";var r=n(85),o=n(63);t.exports="".repeat||function(t){var e=String(o(this)),n="",i=r(t);if(i<0||i==1/0)throw RangeError("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(e+=e))1&i&&(n+=e);return n}},function(t,e,n){"use strict";var r=n(53),o=n(63),i=n(209),a=n(123);n(124)("search",1,function(t,e,n){return[function(e){var n=o(this),r=null==e?void 0:e[t];return void 0!==r?r.call(e,n):new RegExp(e)[t](String(n))},function(t){var o=n(e,t,this);if(o.done)return o.value;var s=r(t),l=String(this),u=s.lastIndex;i(u,0)||(s.lastIndex=0);var c=a(s,l);return i(s.lastIndex,u)||(s.lastIndex=u),null===c?-1:c.index}]})},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(218);n(27)({target:"Object",stat:!0,forced:Object.assign!==r},{assign:r})},function(t,e,n){t.exports=function(){var t,e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=document.body,r=document.createTextNode(""),o=document.createElement("SPAN"),i=function(t,e,n){t.addEventListener(e,n,!1)},a=function(t,e,n){t.removeEventListener(e,n,!1)},s=function(i){var a,s;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==r.textContent?r.textContent=t.value+i:r.data=t.value+i,o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",n.appendChild(o),a=o.clientWidth+2,n.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>a?t.style.width=e.minWidth+"px":a>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=a+"px",s=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>s?t.style.height=e.minHeight+"px":e.maxHeight<s?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=s+"px"},l=function(){window.setTimeout(s,0)},u=function(n,a,u){t=n,function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)e.minHeight=t.clientHeight;else{var i=parseInt(n.minHeight);isNaN(i)||(e.minHeight=i)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)e.maxHeight=t.clientHeight;else{var a=parseInt(n.maxHeight);isNaN(a)||(e.maxHeight=a)}if(n&&n.minWidth)if("inherit"==n.minWidth)e.minWidth=t.clientWidth;else{var s=parseInt(n.minWidth);isNaN(s)||(e.minWidth=s)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)e.maxWidth=t.clientWidth;else{var l=parseInt(n.maxWidth);isNaN(l)||(e.maxWidth=l)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))}(a),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),u&&(i(t,"change",s),i(t,"cut",l),i(t,"paste",l),i(t,"drop",l),i(t,"keydown",l),i(t,"focus",s),i(t,"compositionstart",l),i(t,"compositionupdate",l),i(t,"compositionend",l)),s()};function c(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}return{init:function(t,e,n){u(t,e,n)},unObserve:function(){a(t,"change",s),a(t,"cut",l),a(t,"paste",l),a(t,"drop",l),a(t,"keydown",l),a(t,"focus",s),a(t,"compositionstart",l),a(t,"compositionupdate",l),a(t,"compositionend",l)},resize:s}}},function(t,e,n){"use strict";n(7),n(6),n(8),n(31),n(9);var r=n(5),o=n(17),i=n(14),a=n(32),s=n(20),l=n(60);function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(e,n,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.priv=n,this.selection=r,this.eventManager=new s.a(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.instance.addHook("afterDocumentKeyDown",function(t){return o.onAfterDocumentKeyDown(t)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"keydown",function(t){o.destroyed||o.instance.runHooks("afterDocumentKeyDown",t)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(t){!o.destroyed&&o.activeEditor&&!o.activeEditor.isOpened()&&o.instance.isListening()&&o.openEditor("",t)}),this.instance.view.wt.update("onCellDblClick",function(t,e,n){return o.onCellDblClick(t,e,n)})}var e,n,c;return e=t,(n=[{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(t){this.lock||this.closeEditor(t)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var t=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,function(e){e&&t.prepareEditor()});else{var e=this.instance.selection.selectedRange.current().highlight,n=e.row,r=e.col,o=this.instance.colToProp(r),i=this.instance.getCell(n,r),s=this.instance.getSourceDataAtCell(this.instance.runHooks("modifyRow",n),r),l=this.instance.getCellMeta(n,r),u=this.instance.getCellEditor(l);u?(this.activeEditor=Object(a.b)(u,this.instance),this.activeEditor.prepare(n,r,o,i,s,l)):this.activeEditor=void 0}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(t,e){this.activeEditor&&(this.activeEditor.cellProperties.readOnly?e&&e.keyCode===o.KEY_CODES.ENTER&&this.moveSelectionAfterEnter():this.activeEditor.beginEditing(t,e))}},{key:"closeEditor",value:function(t,e,n){this.activeEditor?this.activeEditor.finishEditing(t,e,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(t){this.closeEditor(!1,t)}},{key:"closeEditorAndRestoreOriginalValue",value:function(t){return this.closeEditor(!0,t)}},{key:"moveSelectionAfterEnter",value:function(t){var e="function"==typeof this.priv.settings.enterMoves?this.priv.settings.enterMoves(event):this.priv.settings.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}},{key:"moveSelectionUp",value:function(t){t?this.selection.transformEnd(-1,0):this.selection.transformStart(-1,0)}},{key:"moveSelectionDown",value:function(t){t?this.selection.transformEnd(1,0):this.selection.transformStart(1,0)}},{key:"moveSelectionRight",value:function(t){t?this.selection.transformEnd(0,1):this.selection.transformStart(0,1)}},{key:"moveSelectionLeft",value:function(t){t?this.selection.transformEnd(0,-1):this.selection.transformStart(0,-1)}},{key:"onAfterDocumentKeyDown",value:function(t){if(this.instance.isListening()&&(this.instance.runHooks("beforeKeyDown",t),!this.destroyed&&229!==t.keyCode&&!Object(i.isImmediatePropagationStopped)(t)&&(this.priv.lastKeyCode=t.keyCode,this.selection.isSelected()))){var e=(t.ctrlKey||t.metaKey)&&!t.altKey;if(!this.activeEditor||this.activeEditor.isWaiting()||Object(o.isMetaKey)(t.keyCode)||Object(o.isCtrlMetaKey)(t.keyCode)||e||this.isEditorOpened()){var n,a=t.shiftKey,s=a?this.selection.setRangeEnd:this.selection.setRangeStart;switch(t.keyCode){case o.KEY_CODES.A:!this.isEditorOpened()&&e&&(this.instance.selectAll(),t.preventDefault(),Object(i.stopPropagation)(t));break;case o.KEY_CODES.ARROW_UP:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(e),this.moveSelectionUp(a),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.ARROW_DOWN:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(e),this.moveSelectionDown(a),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.ARROW_RIGHT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(e),this.moveSelectionRight(a),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.ARROW_LEFT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(e),this.moveSelectionLeft(a),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.TAB:n="function"==typeof this.priv.settings.tabMoves?this.priv.settings.tabMoves(t):this.priv.settings.tabMoves,a?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.BACKSPACE:case o.KEY_CODES.DELETE:this.instance.emptySelectedCells(),this.prepareEditor(),t.preventDefault();break;case o.KEY_CODES.F2:this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,t),t.preventDefault();break;case o.KEY_CODES.ENTER:this.isEditorOpened()?(this.activeEditor&&this.activeEditor.state!==l.a.WAITING&&this.closeEditorAndSaveChanges(e),this.moveSelectionAfterEnter(a)):this.instance.getSettings().enterBeginsEditing?(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,t)):this.moveSelectionAfterEnter(a),t.preventDefault(),Object(i.stopImmediatePropagation)(t);break;case o.KEY_CODES.ESCAPE:this.isEditorOpened()&&(this.closeEditorAndRestoreOriginalValue(e),this.activeEditor.focus()),t.preventDefault();break;case o.KEY_CODES.HOME:t.ctrlKey||t.metaKey?s.call(this.selection,new r.a(0,this.selection.selectedRange.current().from.col)):s.call(this.selection,new r.a(this.selection.selectedRange.current().from.row,0)),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.END:t.ctrlKey||t.metaKey?s.call(this.selection,new r.a(this.instance.countRows()-1,this.selection.selectedRange.current().from.col)):s.call(this.selection,new r.a(this.selection.selectedRange.current().from.row,this.instance.countCols()-1)),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0),t.preventDefault(),Object(i.stopPropagation)(t)}}else this.openEditor("",t)}}},{key:"onCellDblClick",value:function(t,e,n){"TD"===n.nodeName&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,t))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}])&&u(e.prototype,n),c&&u(e,c),t}(),f=new WeakMap;c.getInstance=function(t,e,n,r){var o=f.get(t);return o||(o=new c(t,e,n,r),f.set(t,o)),o},e.a=c},function(t,e,n){"use strict";n(10),n(11),n(12),n(7),n(6),n(8),n(31),n(9);var r=n(0),o=n(20),i=n(14),a=n(5),s=n(108);function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=new WeakMap,f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.eventManager=new o.a(e),this.settings=e.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this.wt=void 0,this.activeWt=void 0,c.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}var e,n,f;return e=t,(n=[{key:"render",value:function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1}},{key:"getCellAtCoords",value:function(t,e){var n=this.wt.getCell(t,e);return n<0?null:n}},{key:"scrollViewport",value:function(t,e,n,r,o){return this.wt.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this.wt.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this.wt.scrollViewportVertically(t,e,n)}},{key:"updateCellHeader",value:function(t,e,n){var o=e,i=this.wt.wtOverlays.getParentOverlay(t)||this.wt;t.parentNode&&(Object(r.hasClass)(t,"colHeader")?o=i.wtTable.columnFilter.sourceToRendered(e):Object(r.hasClass)(t,"rowHeader")&&(o=i.wtTable.rowFilter.sourceToRendered(e))),o>-1?Object(r.fastInnerHTML)(t,n(e)):(Object(r.fastInnerText)(t,String.fromCharCode(160)),Object(r.addClass)(t,"cornerHeader"))}},{key:"createElements",value:function(){var t=c.get(this),e=this.instance,n=e.rootElement,o=e.rootDocument,i=n.getAttribute("style");i&&n.setAttribute("data-originalstyle",i),Object(r.addClass)(n,"handsontable"),t.table=o.createElement("TABLE"),Object(r.addClass)(t.table,"htCore"),this.instance.getSettings().tableClassName&&Object(r.addClass)(t.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),t.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),t.table.appendChild(this.TBODY),this.instance.table=t.table,this.instance.container.insertBefore(t.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var t=this,e=c.get(this),n=this.instance,o=n.rootElement,a=n.rootDocument,s=a.documentElement;this.eventManager.addEventListener(o,"mousedown",function(n){if(e.selectionMouseDown=!0,!t.isTextSelectionAllowed(n.target)){var o=t.instance.rootWindow;Object(r.clearTextSelection)(o),n.preventDefault(),o.focus()}}),this.eventManager.addEventListener(o,"mouseup",function(){e.selectionMouseDown=!1}),this.eventManager.addEventListener(o,"mousemove",function(n){e.selectionMouseDown&&!t.isTextSelectionAllowed(n.target)&&(t.settings.fragmentSelection&&Object(r.clearTextSelection)(t.instance.rootWindow),n.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(e){t.instance.selection.isInProgress()&&!e.shiftKey&&t.instance.selection.finish()}),this.eventManager.addEventListener(s,"mouseup",function(n){t.instance.selection.isInProgress()&&Object(i.isLeftClick)(n)&&t.instance.selection.finish(),e.mouseDown=!1,(Object(r.isOutsideInput)(a.activeElement)||!t.instance.selection.isSelected()&&!Object(i.isRightClick)(n))&&t.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(n){t.instance.selection.isInProgress()&&Object(i.isRightClick)(n)&&(t.instance.selection.finish(),e.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){t.instance.selection.isInProgress()&&t.instance.selection.finish(),e.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(n){var i=n.target,l=n.x||n.clientX,u=n.y||n.clientY,c=n.target;if(!e.mouseDown&&o&&t.instance.view){var f=t.instance.view.wt.wtTable.holder;if(c===f){var h=Object(r.getScrollbarWidth)(a);if(a.elementFromPoint(l+h,u)!==f||a.elementFromPoint(l,u+h)!==f)return}else for(;c!==s;){if(null===c){if(n.isTargetWebComponent)break;return}if(c===o)return;c=c.parentNode}("function"==typeof t.settings.outsideClickDeselects?t.settings.outsideClickDeselects(i):t.settings.outsideClickDeselects)?t.instance.deselectCell():t.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(e.table,"selectstart",function(e){t.settings.fragmentSelection||Object(r.isInput)(e.target)||e.preventDefault()})}},{key:"initializeWalkontable",value:function(){var t=this,e=c.get(this),n={debug:function(){return t.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,preventOverflow:function(){return t.settings.preventOverflow},stretchH:function(){return t.settings.stretchH},data:this.instance.getDataAtCell,totalRows:function(){return t.instance.countRows()},totalColumns:function(){return t.instance.countCols()},fixedColumnsLeft:function(){return t.settings.fixedColumnsLeft},fixedRowsTop:function(){return t.settings.fixedRowsTop},fixedRowsBottom:function(){return t.settings.fixedRowsBottom},minSpareRows:function(){return t.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var e=[];return t.instance.hasRowHeaders()&&e.push(function(e,n){return t.appendRowHeader(e,n)}),t.instance.runHooks("afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return t.instance.hasColHeaders()&&e.push(function(e,n){t.appendColHeader(e,n)}),t.instance.runHooks("afterGetColumnHeaderRenderers",e),e},columnWidth:this.instance.getColWidth,rowHeight:this.instance.getRowHeight,cellRenderer:function(e,n,r){var o=t.instance.getCellMeta(e,n),i=t.instance.colToProp(n),a=t.instance.getDataAtRowProp(e,i);t.instance.hasHook("beforeValueRender")&&(a=t.instance.runHooks("beforeValueRender",a,o)),t.instance.runHooks("beforeRenderer",r,e,n,i,a,o),t.instance.getCellRenderer(o)(t.instance,r,e,n,i,a,o),t.instance.runHooks("afterRenderer",r,e,n,i,a,o)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onWindowResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,a){var l={row:!1,column:!1,cell:!1};t.instance.listen(),t.activeWt=a,e.mouseDown=!0,t.instance.runHooks("beforeOnCellMouseDown",n,r,o,l),Object(i.isImmediatePropagationStopped)(n)||(Object(s.a)(n,{coords:r,selection:t.instance.selection,controller:l}),t.instance.runHooks("afterOnCellMouseDown",n,r,o),t.activeWt=t.wt)},onCellContextMenu:function(n,r,o,a){t.activeWt=a,e.mouseDown=!1,t.instance.selection.isInProgress()&&t.instance.selection.finish(),t.instance.runHooks("beforeOnCellContextMenu",n,r,o),Object(i.isImmediatePropagationStopped)(n)||(t.instance.runHooks("afterOnCellContextMenu",n,r,o),t.activeWt=t.wt)},onCellMouseOut:function(e,n,r,o){t.activeWt=o,t.instance.runHooks("beforeOnCellMouseOut",e,n,r),Object(i.isImmediatePropagationStopped)(e)||(t.instance.runHooks("afterOnCellMouseOut",e,n,r),t.activeWt=t.wt)},onCellMouseOver:function(n,r,o,a){var l={row:!1,column:!1,cell:!1};t.activeWt=a,t.instance.runHooks("beforeOnCellMouseOver",n,r,o,l),Object(i.isImmediatePropagationStopped)(n)||(e.mouseDown&&Object(s.a)(n,{coords:r,selection:t.instance.selection,controller:l}),t.instance.runHooks("afterOnCellMouseOver",n,r,o),t.activeWt=t.wt)},onCellMouseUp:function(e,n,r,o){t.activeWt=o,t.instance.runHooks("beforeOnCellMouseUp",e,n,r),t.instance.runHooks("afterOnCellMouseUp",e,n,r),t.activeWt=t.wt},onCellCornerMouseDown:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:function(e,n){return t.beforeRender(e,n)},onDraw:function(e){return t.onDraw(e)},onScrollVertically:function(){return t.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return t.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return t.instance.runHooks("beforeRemoveCellClassNames")},onAfterDrawSelection:function(e,n,r,o){return t.instance.runHooks("afterDrawSelection",e,n,r,o)},onBeforeDrawBorders:function(e,n){return t.instance.runHooks("beforeDrawBorders",e,n)},onBeforeTouchScroll:function(){return t.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return t.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(e,n){return t.instance.runHooks("beforeStretchingColumnWidth",e,n)},onModifyRowHeaderWidth:function(e){return t.instance.runHooks("modifyRowHeaderWidth",e)},onModifyGetCellCoords:function(e,n,r){return t.instance.runHooks("modifyGetCellCoords",e,n,r)},viewportRowCalculatorOverride:function(e){var n=t.instance.countRows(),r=t.settings.viewportRowRenderingOffset;if("auto"===r&&t.settings.fixedRowsTop&&(r=10),"number"==typeof r&&(e.startRow=Math.max(e.startRow-r,0),e.endRow=Math.min(e.endRow+r,n-1)),"auto"===r){var o=e.startRow+e.endRow-e.startRow,i=Math.ceil(o/n*12);e.startRow=Math.max(e.startRow-i,0),e.endRow=Math.min(e.endRow+i,n-1)}t.instance.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){var n=t.instance.countCols(),r=t.settings.viewportColumnRenderingOffset;if("auto"===r&&t.settings.fixedColumnsLeft&&(r=10),"number"==typeof r&&(e.startColumn=Math.max(e.startColumn-r,0),e.endColumn=Math.min(e.endColumn+r,n-1)),"auto"===r){var o=e.startColumn+e.endColumn-e.startColumn,i=Math.ceil(o/n*12);e.startRow=Math.max(e.startColumn-i,0),e.endColumn=Math.min(e.endColumn+i,n-1)}t.instance.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:function(){return t.settings.rowHeaderWidth},columnHeaderHeight:function(){var e=t.instance.runHooks("modifyColumnHeaderHeight");return t.settings.columnHeaderHeight||e}};this.instance.runHooks("beforeInitWalkontable",n),this.wt=new a.e(n),this.activeWt=this.wt;var r=this.wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),l=o.width,u=o.height;this.setLastSize(l,u),this.eventManager.addEventListener(r,"mousedown",function(t){t.target===r&&3===t.which&&Object(i.stopPropagation)(t)}),this.eventManager.addEventListener(r,"contextmenu",function(t){t.target===r&&3===t.which&&Object(i.stopPropagation)(t)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){t.settings.observeDOMVisibility&&t.wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())})}},{key:"isTextSelectionAllowed",value:function(t){if(Object(r.isInput)(t))return!0;var e=Object(r.isChildOf)(t,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}},{key:"isMouseDown",value:function(){return c.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var t=l(this.instance.getSelectedLast()||[],4),e=t[0],n=t[1],r=t[2],o=t[3];return void 0!==e&&e===r&&n===o}},{key:"isCellEdited",value:function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()}},{key:"beforeRender",value:function(t,e){t&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,e)}},{key:"onDraw",value:function(t){t&&this.instance.runHooks("afterRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(t,e){if(e.firstChild){var n=e.firstChild;if(!Object(r.hasClass)(n,"relative"))return Object(r.empty)(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var o=this.instance,i=o.rootDocument,a=o.getRowHeader,s=i.createElement("div"),l=i.createElement("span");s.className="relative",l.className="rowHeader",this.updateCellHeader(l,t,a),s.appendChild(l),e.appendChild(s)}this.instance.runHooks("afterGetRowHeader",t,e)}},{key:"appendColHeader",value:function(t,e){if(e.firstChild){var n=e.firstChild;Object(r.hasClass)(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),t,this.instance.getColHeader):(Object(r.empty)(e),this.appendColHeader(t,e))}else{var o=this.instance.rootDocument,i=o.createElement("div"),a=o.createElement("span");i.className="relative",a.className="colHeader",this.updateCellHeader(a,t,this.instance.getColHeader),i.appendChild(a),e.appendChild(i)}this.instance.runHooks("afterGetColHeader",t,e)}},{key:"maximumVisibleElementWidth",value:function(t){var e=this.wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0}},{key:"maximumVisibleElementHeight",value:function(t){var e=this.wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0}},{key:"setLastSize",value:function(t,e){var n=c.get(this),r=[t,e];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var t=c.get(this);return{width:t.lastWidth,height:t.lastHeight}}},{key:"mainViewIsActive",value:function(){return this.wt===this.activeWt}},{key:"destroy",value:function(){this.wt.destroy(),this.eventManager.destroy()}}])&&u(e.prototype,n),f&&u(e,f),t}();e.a=f},function(t,e,n){"use strict";n(35),n(73);var r=n(2),o=n(1),i=n(4);function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}var e,n,s;return e=t,(n=[{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.data;return t&&(e=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),e}},{key:"setData",value:function(t){this.data=t}},{key:"getAtColumn",value:function(t){var e=this,n=[];return Object(o.arrayEach)(this.data,function(o){var i,a=e.colToProp(t);i="string"==typeof a?Object(r.getProperty)(o,a):"function"==typeof a?a(o):o[a],n.push(i)}),n}},{key:"getAtRow",value:function(t){return this.data[t]}},{key:"getAtCell",value:function(t,e){var n=null,o=this.hot.runHooks("modifyRowData",t),i=isNaN(o)?o:this.data[t];if(i){var a=this.colToProp(e);n="string"==typeof a?Object(r.getProperty)(i,a):"function"==typeof a?a(this.data.slice(t,t+1)[0]):i[a]}return n}},{key:"getByRange",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Math.min(t.row,e.row),a=Math.min(t.col,e.col),s=Math.max(t.row,e.row),l=Math.max(t.col,e.col),u=[];return Object(i.rangeEach)(o,s,function(t){var e,o=n.getAtRow(t);"array"===n.dataType?e=o.slice(a,l+1):"object"===n.dataType&&(e=r?[]:{},Object(i.rangeEach)(a,l,function(t){var i=n.colToProp(t);r?e.push(o[i]):e[i]=o[i]})),u.push(e)}),u}},{key:"countRows",value:function(){return Array.isArray(this.data)?this.data.length:0}},{key:"countColumns",value:function(){var t=0;return Array.isArray(this.data)&&("array"===this.dataType?t=this.data[0].length:"object"===this.dataType&&(t=Object.keys(this.data[0]).length)),t}},{key:"destroy",value:function(){this.data=null,this.hot=null}}])&&a(e.prototype,n),s&&a(e,s),t}();e.a=s},,function(t,e,n){"use strict";n(10),n(11),n(12),n(56),n(21),n(7),n(35),n(76),n(43),n(75),n(6),n(8),n(61),n(9),n(45);var r=n(83),o=n.n(r),i=n(66),a=n(82),s=n(2),l=n(1),u=(n(52),n(34));function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}var h=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.timer=null,this.func=e,this.delay=function(t){var e=t;"string"==typeof e&&/fps$/.test(e)&&(e=1e3/parseInt(e.replace("fps","")||0,10));return e}(n),this.stopped=!0,this._then=null,this._callback=function(){return r.__callback()}}return f(t,null,[{key:"create",value:function(e,n){return new t(e,n)}}]),f(t,[{key:"start",value:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=Object(u.requestAnimationFrame)(this._callback)),this}},{key:"stop",value:function(){return this.stopped||(this.stopped=!0,Object(u.cancelAnimationFrame)(this.timer),this.timer=null),this}},{key:"__callback",value:function(){if(this.timer=Object(u.requestAnimationFrame)(this._callback),this.delay){var t=Date.now(),e=t-this._then;e>this.delay&&(this._then=t-e%this.delay,this.func())}else this.func()}}]),t}();var d=n(4);function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e,n){return e&&g(t.prototype,e),n&&g(t,n),t}var y=Object(i.cellMethodLookupFactory)("copyable",!1),m=function(){function t(e,n,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.priv=n,this.GridSettings=r,this.dataSource=this.instance.getSettings().data,this.cachedLength=null,this.skipCache=!1,this.latestSourceRowsCount=0,this.duckSchema=this.dataSource&&this.dataSource[0]?Object(s.duckSchema)(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap(),this.interval=h.create(function(){return o.clearLengthCache()},"15fps"),this.instance.addHook("skipLengthCache",function(t){return o.onSkipLengthCache(t)}),this.onSkipLengthCache(500)}return v(t,null,[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),v(t,[{key:"createMap",value:function(){var t,e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new Map;var n=this.instance.getSettings().columns;if(n){var r=this.instance.getSettings().maxCols,o=Math.min(r,n.length),i=0,a=!1,l=Object(s.deepObjectSize)(e);for("function"==typeof n&&(o=l>0?l:this.instance.countSourceCols(),a=!0),t=0;t<o;t++){var u=a?n(t):n[t];if(Object(s.isObject)(u)){if(void 0!==u.data){var c=a?i:t;this.colToPropCache[c]=u.data,this.propToColCache.set(u.data,c)}i+=1}}}else this.recursiveDuckColumns(e)}},{key:"recursiveDuckColumns",value:function(t,e,n){var r,o=this,i=e,a=n;return void 0===i&&(i=0,a=""),"object"!==p(t)||Array.isArray(t)||Object(s.objectEach)(t,function(t,e){null===t?(r=a+e,o.colToPropCache.push(r),o.propToColCache.set(r,i),i+=1):i=o.recursiveDuckColumns(t,i,"".concat(e,"."))}),i}},{key:"colToProp",value:function(t){var e=this.instance.toPhysicalColumn(t);return!isNaN(e)&&this.colToPropCache&&void 0!==this.colToPropCache[e]?this.colToPropCache[e]:e}},{key:"propToCol",value:function(t){var e;return e=void 0===this.propToColCache.get(t)?t:this.propToColCache.get(t),e=this.instance.toVisualColumn(e)}},{key:"getSchema",value:function(){var t=this.instance.getSettings().dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}},{key:"createRow",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=0,i=t;if(("number"!=typeof i||i>=this.instance.countSourceRows())&&(i=this.instance.countSourceRows()),!1===this.instance.runHooks("beforeCreateRow",i,n,r))return 0;for(var a=this.instance.getSettings().maxRows,l=this.instance.countCols(),u=function(){var t=null;"array"===e.instance.dataType?e.instance.getSettings().dataSchema?t=Object(s.deepClone)(e.getSchema()):(t=[],Object(d.rangeEach)(l-1,function(){return t.push(null)})):"function"===e.instance.dataType?t=e.instance.getSettings().dataSchema(i):(t={},Object(s.deepExtend)(t,e.getSchema())),i===e.instance.countSourceRows()?e.dataSource.push(t):e.spliceData(i,0,t),o+=1};o<n&&this.instance.countSourceRows()<a;)u();return this.instance.runHooks("afterCreateRow",i,o,r),this.instance.forceFullRender=!0,o}},{key:"createCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var r,o=this.instance.countSourceRows(),i=this.dataSource,s=this.instance.countCols(),l="number"!=typeof t||t>=s?s:t,u=0;this.instance.runHooks("beforeCreateCol",l,e,n),r=l;for(var c=this.instance.getSettings().maxCols;u<e&&this.instance.countCols()<c;){var f=Object(a.columnFactory)(this.GridSettings,this.priv.columnsSettingConflicts);if("number"!=typeof l||l>=this.instance.countCols()){if(o>0)for(var h=0;h<o;h++)void 0===i[h]&&(i[h]=[]),i[h].push(null);else i.push([null]);this.priv.columnSettings.push(f)}else{for(var d=0;d<o;d++)i[d].splice(r,0,null);this.priv.columnSettings.splice(r,0,f)}u+=1,r+=1}return this.instance.runHooks("afterCreateCol",l,u,n),this.instance.forceFullRender=!0,u}},{key:"removeRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r="number"!=typeof t?-e:t,o=this.instance.runHooks("modifyRemovedAmount",e,r),i=this.instance.countSourceRows();r=(i+r)%i;var a=this.visualRowsToPhysical(r,o);if(!1!==this.instance.runHooks("beforeRemoveRow",r,o,a,n)){var s=this.dataSource,l=this.filterData(r,o);l&&(s.length=0,Array.prototype.push.apply(s,l)),this.instance.runHooks("afterRemoveRow",r,o,a,n),this.instance.forceFullRender=!0}}},{key:"removeCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");var r="number"!=typeof t?-e:t;r=(this.instance.countCols()+r)%this.instance.countCols();var o=this.visualColumnsToPhysical(r,e),i=o.slice(0).sort(function(t,e){return e-t});if(!1!==this.instance.runHooks("beforeRemoveCol",r,e,o,n)){for(var a=!0,s=i.length,l=this.dataSource,u=0;u<s;u++)a&&o[0]!==o[u]-u&&(a=!1);if(a)for(var c=0,f=this.instance.countSourceRows();c<f;c++)l[c].splice(o[0],e);else{for(var h=0,d=this.instance.countSourceRows();h<d;h++)for(var p=0;p<s;p++)l[h].splice(i[p],1);for(var g=0;g<s;g++)this.priv.columnSettings.splice(o[g],1)}this.instance.runHooks("afterRemoveCol",r,e,o,n),this.instance.forceFullRender=!0}}},{key:"spliceCol",value:function(t,e,n){for(var r=this.instance.getDataAtCol(t),o=r.slice(e,e+n),i=r.slice(e+n),a=arguments.length,s=new Array(a>3?a-3:0),u=3;u<a;u++)s[u-3]=arguments[u];Object(l.extendArray)(s,i);for(var c=0;c<n;)s.push(null),c+=1;return Object(l.to2dArray)(s),this.instance.populateFromArray(e,t,s,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(t,e,n){for(var r=this.instance.getSourceDataAtRow(t),o=r.slice(e,e+n),i=r.slice(e+n),a=arguments.length,s=new Array(a>3?a-3:0),u=3;u<a;u++)s[u-3]=arguments[u];Object(l.extendArray)(s,i);for(var c=0;c<n;)s.push(null),c+=1;return this.instance.populateFromArray(t,e,[s],null,null,"spliceRow"),o}},{key:"spliceData",value:function(t,e,n){!1!==this.instance.runHooks("beforeDataSplice",t,e,n)&&this.dataSource.splice(t,e,n)}},{key:"filterData",value:function(t,e){var n=this.visualRowsToPhysical(t,e);if(!1!==this.instance.runHooks("beforeDataFilter",t,e,n))return this.dataSource.filter(function(t,e){return-1===n.indexOf(e)})}},{key:"get",value:function(t,e){var n=this.instance.toPhysicalRow(t),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n),i=null;if((r=isNaN(o)?o:r)&&r.hasOwnProperty&&Object(s.hasOwnProperty)(r,e))i=r[e];else if("string"==typeof e&&e.indexOf(".")>-1){var a=e.split("."),l=r;if(!l)return null;for(var u=0,c=a.length;u<c;u++)if(void 0===(l=l[a[u]]))return null;i=l}else"function"==typeof e&&(i=e(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var f=Object(s.createObjectPropListener)(i);this.instance.runHooks("modifyData",n,this.propToCol(e),f,"get"),f.isTouched()&&(i=f.value)}return i}},{key:"getCopyable",value:function(t,e){return y.call(this.instance,t,this.propToCol(e))?this.get(t,e):""}},{key:"set",value:function(t,e,n,r){var o=this.instance.runHooks("modifyRow",t,r||"datamapGet"),i=n,a=this.dataSource[o],l=this.instance.runHooks("modifyRowData",o);if(a=isNaN(l)?l:a,this.instance.hasHook("modifyData")){var u=Object(s.createObjectPropListener)(i);this.instance.runHooks("modifyData",o,this.propToCol(e),u,"set"),u.isTouched()&&(i=u.value)}if(a&&a.hasOwnProperty&&Object(s.hasOwnProperty)(a,e))a[e]=i;else if("string"==typeof e&&e.indexOf(".")>-1){var c,f=e.split("."),h=a,d=0;for(d=0,c=f.length-1;d<c;d++)void 0===h[f[d]]&&(h[f[d]]={}),h=h[f[d]];h[f[d]]=i}else"function"==typeof e?e(this.dataSource.slice(o,o+1)[0],i):a[e]=i}},{key:"visualRowsToPhysical",value:function(t,e){for(var n,r=this.instance.countSourceRows(),o=[],i=(r+t)%r,a=e;i<r&&a;)n=this.instance.toPhysicalRow(i),o.push(n),a-=1,i+=1;return o}},{key:"visualColumnsToPhysical",value:function(t,e){for(var n=this.instance.countCols(),r=[],o=(n+t)%n,i=e;o<n&&i;){var a=this.instance.toPhysicalColumn(o);r.push(a),i-=1,o+=1}return r}},{key:"clear",value:function(){for(var t=0;t<this.instance.countSourceRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")}},{key:"clearLengthCache",value:function(){this.cachedLength=null}},{key:"getLength",value:function(){var t,e=this,n=this.instance.getSettings().maxRows;t=n<0||0===n?0:n||1/0;var r=this.instance.countSourceRows();if(this.instance.hasHook("modifyRow")){var o=this.skipCache;this.interval.start(),r!==this.latestSourceRowsCount&&(o=!0),this.latestSourceRowsCount=r,null===this.cachedLength||o?(Object(d.rangeEach)(r-1,function(t){null===e.instance.toPhysicalRow(t)&&(r-=1)}),this.cachedLength=r):r=this.cachedLength}else this.interval.stop();return Math.min(r,t)}},{key:"getAll",value:function(){var e={row:0,col:0},n={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-n.row!=0||this.instance.countSourceRows()?this.getRange(e,n,t.DESTINATION_RENDERER):[]}},{key:"getRange",value:function(e,n,r){var o,i,a,s=[],l=this.instance.getSettings().maxRows,u=this.instance.getSettings().maxCols;if(0===l||0===u)return[];var c=r===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),h=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=f;o++){a=[];var d=this.instance.toPhysicalRow(o);for(i=Math.min(e.col,n.col);i<=h&&null!==d;i++)a.push(c.call(this,o,this.colToProp(i)));null!==d&&s.push(a)}return s}},{key:"getText",value:function(e,n){return o.a.stringify(this.getRange(e,n,t.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(e,n){return o.a.stringify(this.getRange(e,n,t.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"onSkipLengthCache",value:function(t){var e=this;this.skipCache=!0,setTimeout(function(){e.skipCache=!1},t)}},{key:"destroy",value:function(){this.interval.stop(),this.interval=null,this.instance=null,this.priv=null,this.GridSettings=null,this.dataSource=null,this.cachedLength=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}]),t}();e.a=m},function(t,e,n){var r=n(157).f,o=n(37)(function(){Object.getOwnPropertyNames(1)});n(27)({target:"Object",stat:!0,forced:o},{getOwnPropertyNames:r})},function(t,e,n){var r=n(95),o=n(114),i=n(53),a=n(41).Reflect;t.exports=a&&a.ownKeys||function(t){var e=r.f(i(t)),n=o.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(58),o=n(59),i=n(53),a=n(91);t.exports=r?Object.defineProperties:function(t,e){i(t);for(var n,r=a(e),s=r.length,l=0;s>l;)o.f(t,n=r[l++],e[n]);return t}},function(t,e,n){"use strict";var r=n(165).IteratorPrototype,o=n(101),i=n(98),a=n(118),s=n(102),l=function(){return this};t.exports=function(t,e,n){var u=e+" Iterator";return t.prototype=o(r,{next:i(1,n)}),a(t,u,!1,!0),s[u]=l,t}},function(t,e,n){var r=n(49),o=n(53);t.exports=function(t,e){if(o(t),!r(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}},function(t,e,n){"use strict";var r=n(167),o={};o[n(46)("toStringTag")]="z",t.exports="[object z]"!==String(o)?function(){return"[object "+r(this)+"]"}:o.toString},function(t,e,n){var r=n(91),o=n(114),i=n(97);t.exports=function(t){var e=r(t),n=o.f;if(n)for(var a,s=n(t),l=i.f,u=0;s.length>u;)l.call(t,a=s[u++])&&e.push(a);return e}},function(t,e,n){"use strict";var r=n(104),o=n(68),i=n(172),a=n(170),s=n(57),l=n(121),u=n(171);t.exports=function(t){var e,n,c,f,h=o(t),d="function"==typeof this?this:Array,p=arguments.length,g=p>1?arguments[1]:void 0,v=void 0!==g,y=0,m=u(h);if(v&&(g=r(g,p>2?arguments[2]:void 0,2)),null==m||d==Array&&a(m))for(n=new d(e=s(h.length));e>y;y++)l(n,y,v?g(h[y],y):h[y]);else for(f=m.call(h),n=new d;!(c=f.next()).done;y++)l(n,y,v?i(f,g,[c.value,y],!0):c.value);return n.length=y,n}},function(t,e,n){var r=n(177),o=n(41),i=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?i(r[t])||i(o[t]):r[t]&&r[t][e]||o[t]&&o[t][e]}},function(t,e,n){var r=n(53),o=n(144),i=n(46)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||null==(n=r(a)[i])?e:o(n)}},function(t,e,n){var r=n(37),o=n(181);t.exports=function(t){return r(function(){return!!o[t]()||""!=""[t]()||o[t].name!==t})}},function(t,e,n){"use strict";var r=n(140);n(27)({target:"String",proto:!0},{codePointAt:function(t){return r(this,t)}})},function(t,e,n){var r=n(57),o=n(184),i=n(63);t.exports=function(t,e,n,a){var s,l,u=String(i(t)),c=u.length,f=void 0===n?" ":String(n),h=r(e);return h<=c||""==f?u:(s=h-c,(l=o.call(f,Math.ceil(s/f.length))).length>s&&(l=l.slice(0,s)),a?l+u:u+l)}},function(t,e,n){var r=n(182);t.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r)},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,o,i,a,s,l=1,u={},c=!1,f=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){p(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((i=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){i.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(o=f.documentElement,r=function(t){var e=f.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)}):r=function(t){setTimeout(p,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}),h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var o={callback:t,args:e};return u[l]=o,r(l),l++},h.clearImmediate=d}function d(t){delete u[t]}function p(t){if(c)setTimeout(p,0,t);else{var e=u[t];if(e){c=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{d(t),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(186),n(211))},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var l,u=[],c=!1,f=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):f=-1,u.length&&d())}function d(){if(!c){var t=s(h);c=!0;for(var e=u.length;e;){for(l=u,u=[];++f<e;)l&&l[f].run();f=-1,e=u.length}l=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new p(t,e)),1!==u.length||c||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){var r=n(49),o=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&o(t)===t}},function(t,e,n){var r=n(41),o=n(214),i=!r.setImmediate||!r.clearImmediate;n(27)({global:!0,bind:!0,enumerable:!0,forced:i},{setImmediate:o.set,clearImmediate:o.clear})},function(t,e,n){var r,o,i,a=n(41),s=n(78),l=n(104),u=n(164),c=n(136),f=a.setImmediate,h=a.clearImmediate,d=a.process,p=a.MessageChannel,g=a.Dispatch,v=0,y={},m=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},b=function(t){m.call(t.data)};f&&h||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return y[++v]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},r(v),v},h=function(t){delete y[t]},"process"==s(d)?r=function(t){d.nextTick(l(m,t,1))}:g&&g.now?r=function(t){g.now(l(m,t,1))}:p?(i=(o=new p).port2,o.port1.onmessage=b,r=l(i.postMessage,i,1)):a.addEventListener&&"function"==typeof postMessage&&!a.importScripts?(r=function(t){a.postMessage(t+"","*")},a.addEventListener("message",b,!1)):r="onreadystatechange"in c("script")?function(t){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),m.call(t)}}:function(t){setTimeout(l(m,t,1),0)}),t.exports={set:f,clear:h}},function(t,e,n){n(27)({target:"Array",proto:!0},{fill:n(216)}),n(116)("fill")},function(t,e,n){"use strict";var r=n(68),o=n(110),i=n(57);t.exports=function(t){for(var e=r(this),n=i(e.length),a=arguments.length,s=o(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:o(l,n);u>s;)e[s++]=t;return e}},function(t,e,n){"use strict";var r=[].forEach,o=n(105)(0),i=n(122)("forEach");t.exports=i?function(t){return o(this,t,arguments[1])}:r},function(t,e,n){"use strict";var r=n(91),o=n(114),i=n(97),a=n(68),s=n(109),l=Object.assign;t.exports=!l||n(37)(function(){var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){e[t]=t}),7!=l({},t)[n]||"abcdefghijklmnopqrst"!=r(l({},e)).join("")})?function(t,e){for(var n=a(t),l=arguments.length,u=1,c=o.f,f=i.f;l>u;)for(var h,d=s(arguments[u++]),p=c?r(d).concat(c(d)):r(d),g=p.length,v=0;g>v;)f.call(d,h=p[v++])&&(n[h]=d[h]);return n}:l},function(t,e,n){"use strict";n(120)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},n(169),!1,!0)},function(t,e,n){var r=n(221);n(27)({target:"Object",stat:!0},{values:function(t){return r(t)}})},function(t,e,n){var r=n(91),o=n(70),i=n(97).f;t.exports=function(t,e){for(var n,a=o(t),s=r(a),l=s.length,u=0,c=[];l>u;)i.call(a,n=s[u++])&&c.push(e?[n,a[n]]:a[n]);return c}},function(t,e,n){"use strict";var r=n(85),o=n(223),i=n(184),a=1..toFixed,s=Math.floor,l=[0,0,0,0,0,0],u=function(t,e){for(var n=-1,r=e;++n<6;)r+=t*l[n],l[n]=r%1e7,r=s(r/1e7)},c=function(t){for(var e=6,n=0;--e>=0;)n+=l[e],l[e]=s(n/t),n=n%t*1e7},f=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==l[t]){var n=String(l[t]);e=""===e?n:e+i.call("0",7-n.length)+n}return e},h=function(t,e,n){return 0===e?n:e%2==1?h(t,e-1,n*t):h(t*t,e/2,n)};n(27)({target:"Number",proto:!0,forced:a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(37)(function(){a.call({})})},{toFixed:function(t){var e,n,a,s,l=o(this),d=r(t),p="",g="0";if(d<0||d>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(p="-",l=-l),l>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(l*h(2,69,1))-69)<0?l*h(2,-e,1):l/h(2,e,1),n*=4503599627370496,(e=52-e)>0){for(u(0,n),a=d;a>=7;)u(1e7,0),a-=7;for(u(h(10,a,1),0),a=e-1;a>=23;)c(1<<23),a-=23;c(1<<a),u(1,1),c(2),g=f()}else u(0,n),u(1<<-e,0),g=f()+i.call("0",d);return g=d>0?p+((s=g.length)<=d?"0."+i.call("0",d-s)+g:g.slice(0,s-d)+"."+g.slice(s-d)):p+g}})},function(t,e,n){var r=n(78);t.exports=function(t){if("number"!=typeof t&&"Number"!=r(t))throw TypeError("Incorrect invocation");return+t}},function(t,e,n){"use strict";var r=n(57),o=n(151),i="".endsWith,a=Math.min,s=n(152)("endsWith");n(27)({target:"String",proto:!0,forced:!s},{endsWith:function(t){var e=o(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,s=r(e.length),l=void 0===n?s:a(r(n),s),u=String(t);return i?i.call(e,u,l):e.slice(l-u.length,l)===u}})},function(t,e,n){"use strict";var r=n(226),o=n(227)("link");n(27)({target:"String",proto:!0,forced:o},{link:function(t){return r(this,"a","href",t)}})},function(t,e,n){var r=n(63),o=/"/g;t.exports=function(t,e,n,i){var a=String(r(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(i).replace(o,"&quot;")+'"'),s+">"+a+"</"+e+">"}},function(t,e,n){var r=n(37);t.exports=function(t){return r(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})}},,,function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"Loose",function(){return ms}),n.d(r,"Strict",function(){return Cs});var o={};n.r(o),n.d(o,"OPERATION_NAME",function(){return sh}),n.d(o,"prepare",function(){return lh}),n.d(o,"operate",function(){return uh});var i={};n.r(i),n.d(i,"OPERATION_NAME",function(){return ch}),n.d(i,"operate",function(){return fh});var a={};n.r(a),n.d(a,"OPERATION_NAME",function(){return dh}),n.d(a,"operate",function(){return ph});var s={};n.r(s),n.d(s,"OPERATION_NAME",function(){return vh}),n.d(s,"operate",function(){return yh});var l={};n.r(l),n.d(l,"OPERATION_NAME",function(){return bh}),n.d(l,"operate",function(){return wh});var u={};n.r(u),n.d(u,"AutoColumnSize",function(){return ft}),n.d(u,"AutoFill",function(){return Ct}),n.d(u,"AutoRowSize",function(){return At}),n.d(u,"Base",function(){return B}),n.d(u,"BindRowsWithHeaders",function(){return xs}),n.d(u,"CollapsibleColumns",function(){return Bs}),n.d(u,"ColumnSorting",function(){return Le}),n.d(u,"ColumnSummary",function(){return Zs}),n.d(u,"Comments",function(){return pn}),n.d(u,"ContextMenu",function(){return nr}),n.d(u,"CopyPaste",function(){return Tr}),n.d(u,"CustomBorders",function(){return zr}),n.d(u,"DragToScroll",function(){return Jr}),n.d(u,"DropdownMenu",function(){return al}),n.d(u,"ExportFile",function(){return xl}),n.d(u,"Filters",function(){return Tf}),n.d(u,"Formulas",function(){return Kh}),n.d(u,"GanttChart",function(){return gd}),n.d(u,"HeaderTooltips",function(){return Ed}),n.d(u,"HiddenColumns",function(){return Tp}),n.d(u,"HiddenRows",function(){return Lp}),n.d(u,"ManualColumnFreeze",function(){return co}),n.d(u,"ManualColumnMove",function(){return Wo}),n.d(u,"ManualColumnResize",function(){return Ko}),n.d(u,"ManualRowMove",function(){return ki}),n.d(u,"ManualRowResize",function(){return ji}),n.d(u,"MergeCells",function(){return ca}),n.d(u,"MultiColumnSorting",function(){return zl}),n.d(u,"MultipleSelectionHandles",function(){return ma}),n.d(u,"NestedHeaders",function(){return Pd}),n.d(u,"NestedRows",function(){return vp}),n.d(u,"ObserveChanges",function(){return ja}),n.d(u,"PersistentState",function(){return $}),n.d(u,"Search",function(){return za}),n.d(u,"TouchScroll",function(){return Ja}),n.d(u,"TrimRows",function(){return qp}),n.d(u,"UndoRedo",function(){return gs});var c=n(42),f=n.n(c),h=(n(194),n(32)),d=n(38),p=n(51),g=n(77),v=n(87);n(24);var y=n(20),m=n(16),b=(n(107),n(128),n(0)),w=n(1);function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var O=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}var e,n,r;return e=t,(n=[{key:"addRow",value:function(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(t){var e=this.hot.getColHeader(0);if(null!=e){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(t){this.injected||this.injectTable(),Object(w.arrayEach)(this.rows,function(e){t(e.row,Object(b.outerHeight)(e.table)-1)})}},{key:"getWidths",value:function(t){this.injected||this.injectTable(),Object(w.arrayEach)(this.columns,function(e){t(e.col,Object(b.outerWidth)(e.table))})}},{key:"setSettings",value:function(t){this.settings=t}},{key:"setSetting",value:function(t,e){this.settings||(this.settings={}),this.settings[t]=e}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(t){return this.settings?this.settings[t]:null}},{key:"createColGroupsCol",value:function(){var t=this,e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach(function(n){Object(w.arrayEach)(n.strings,function(n){e.appendChild(t.createColElement(n.col))})}),e}},{key:"createRow",value:function(t){var e=this,n=this.hot.rootDocument,r=n.createDocumentFragment(),o=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,o),r.appendChild(o)),this.samples.forEach(function(o){Object(w.arrayEach)(o.strings,function(o){var i=o.col,a=e.hot.getCellMeta(t,i);a.col=i,a.row=t;var s=e.hot.getCellRenderer(a),l=n.createElement("td");l.setAttribute("ghost-table",1),s(e.hot,l,t,i,e.hot.colToProp(i),o.value,a),r.appendChild(l)})}),r}},{key:"createColumnHeadersRow",value:function(){var t=this,e=this.hot.rootDocument,n=e.createDocumentFragment();if(this.hot.hasRowHeaders()){var r=e.createElement("th");this.hot.view.appendColHeader(-1,r),n.appendChild(r)}return this.samples.forEach(function(r){Object(w.arrayEach)(r.strings,function(r){var o=r.col,i=e.createElement("th");t.hot.view.appendColHeader(o,i),n.appendChild(i)})}),n}},{key:"createCol",value:function(t){var e=this,n=this.hot.rootDocument,r=n.createDocumentFragment();return this.samples.forEach(function(o){Object(w.arrayEach)(o.strings,function(o){var i=o.row,a=e.hot.getCellMeta(i,t);a.col=t,a.row=i;var s=e.hot.getCellRenderer(a),l=n.createElement("td"),u=n.createElement("tr");l.setAttribute("ghost-table",1),s(e.hot,l,i,t,e.hot.colToProp(t),o.value,a),u.appendChild(l),r.appendChild(u)})}),r}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(t){var e=this.hot.rootDocument.createElement("col");return e.style.width="".concat(this.hot.view.wt.wtTable.getStretchedColumnWidth(t),"px"),e}},{key:"createTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.hot.rootDocument,n=e.createDocumentFragment(),r=e.createElement("table"),o=e.createElement("thead"),i=e.createElement("tbody"),a=e.createElement("colgroup"),s=e.createElement("tr"),l=e.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(s.appendChild(l),o.appendChild(s),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&i.appendChild(s),r.appendChild(i),Object(b.addClass)(r,t),n.appendChild(r),{fragment:n,table:r,tHead:o,tBody:i,colGroup:a,tr:s,th:l}}},{key:"createContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.hot.rootDocument,n=e.createDocumentFragment(),r=e.createElement("div"),o="htGhostTable htAutoSize ".concat(t.trim());return Object(b.addClass)(r,o),n.appendChild(r),{fragment:n,container:r}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}])&&C(e.prototype,n),r&&C(e,r),t}(),E=n(40),S=n(66),k=n(130),R=n(34),T=n(28),M=n(13),_=n(4),N=n(2),A=n(82),x=n(36),j=n(17),I=n(14),D=(n(10),n(11),n(12),n(7),n(22),n(18),n(19),n(6),n(23),n(8),n(9),n(21),n(43),n(31),n(65)),P=n(15);function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var H=new WeakMap,F=null,B=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object(N.defineGetter)(this,"hot",e,{writable:!1}),Object(N.defineGetter)(this,"t",Object(D.a)(e),{writable:!1}),H.set(this,{hooks:{}}),F=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return n.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(t){return n.onUpdateSettings(t)}),this.hot.addHook("beforeInit",function(){return n.init()})}var e,n,r;return e=t,(n=[{key:"init",value:function(){this.pluginName=Object(P.b)(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),F||(F=Object(P.c)(this.hot)),F.indexOf(this.pluginName)>=0&&F.splice(F.indexOf(this.pluginName),1),F.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(t,e){H.get(this).hooks[t]=H.get(this).hooks[t]||[];var n=H.get(this).hooks[t];this.hot.addHook(t,e),n.push(e),H.get(this).hooks[t]=n}},{key:"removeHooks",value:function(t){var e=this;Object(w.arrayEach)(H.get(this).hooks[t]||[],function(n){e.hot.removeHook(t,n)})}},{key:"clearHooks",value:function(){var t=this,e=H.get(this).hooks;Object(N.objectEach)(e,function(e,n){return t.removeHooks(n)}),e.length=0}},{key:"callOnPluginsReady",value:function(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}},{key:"onAfterPluginsInitialized",value:function(){Object(w.arrayEach)(this.pluginsInitializedCallbacks,function(t){return t()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var t=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Object(N.objectEach)(this,function(e,n){"hot"!==n&&"t"!==n&&(t[n]=null)}),delete this.t,delete this.hot}}])&&L(e.prototype,n),r&&L(e,r),t}();function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var V=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootWindow=n,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}var e,n,r;return e=t,(n=[{key:"saveValue",value:function(t,e){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(t),JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}},{key:"loadValue",value:function(t,e){var n=void 0===t?e:t,r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return null===r?void 0:JSON.parse(r)}},{key:"reset",value:function(t){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(t))}},{key:"resetAll",value:function(){var t=this;Object(w.arrayEach)(this.savedKeys,function(e,n){t.rootWindow.localStorage.removeItem("".concat(t.prefix,"_").concat(t.savedKeys[n]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var t=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}])&&W(e.prototype,n),r&&W(e,r),t}();function U(t){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function z(t,e){return!e||"object"!==U(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function G(t,e,n){return(G="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=X(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function q(t,e){return(q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}m.a.getSingleton().register("persistentStateSave"),m.a.getSingleton().register("persistentStateLoad"),m.a.getSingleton().register("persistentStateReset");var K=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=z(this,X(e).call(this,t))).storage=void 0,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&q(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.storage||(this.storage=new V(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(e,n){return t.saveValue(e,n)}),this.addHook("persistentStateLoad",function(e,n){return t.loadValue(e,n)}),this.addHook("persistentStateReset",function(){return t.resetValue()}),G(X(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,G(X(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),G(X(e.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(t,e){e.value=this.storage.loadValue(t)}},{key:"saveValue",value:function(t,e){this.storage.saveValue(t,e)}},{key:"resetValue",value:function(t){void 0===t?this.storage.resetAll():this.storage.reset(t)}},{key:"destroy",value:function(){G(X(e.prototype),"destroy",this).call(this)}}])&&Y(n.prototype,r),o&&Y(n,o),e}();Object(P.d)("persistentState",K);var $=K;n(45),n(75),n(73);function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Q(t,e,n){return e&&Z(t.prototype,e),n&&Z(t,n),t}var J=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}return Q(t,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]),Q(t,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(t){this.customSampleCount=t}},{key:"setAllowDuplicates",value:function(t){this.allowDuplicates=t}},{key:"generateRowSamples",value:function(t,e){return this.generateSamples("row",e,t)}},{key:"generateColumnSamples",value:function(t,e){return this.generateSamples("col",e,t)}},{key:"generateSamples",value:function(t,e,n){var r=this,o=new Map,i="number"==typeof n?{from:n,to:n}:n,a=i.from,s=i.to;return Object(_.rangeEach)(a,s,function(n){var i=r.generateSample(t,e,n);o.set(n,i)}),o}},{key:"generateSample",value:function(t,e,n){var r=this;if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");var o=new Map,i="row"===t?"col":"row",a=[];return Object(_.rangeEach)(e.from,e.to,function(e){var s,l="row"===t?r.dataFactory(n,e):r.dataFactory(e,n),u=l.value,c=l.bundleCountSeed,f=c>0;s=Object(N.isObject)(u)?Object.keys(u).length:Array.isArray(u)?u.length:Object(M.stringify)(u).length,f&&(s+=c),o.has(s)||o.set(s,{needed:r.getSampleCount(),strings:[]});var h=o.get(s);h.needed&&((!(a.indexOf(u)>-1)||r.allowDuplicates||f)&&(h.strings.push(function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({value:u},i,e)),a.push(u),h.needed-=1))}),o}}]),t}(),tt=n(5);function et(t){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function rt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ot(t,e,n){return(ot="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=it(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function it(t){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function st(t,e,n){return e&&at(t.prototype,e),n&&at(t,n),t}function lt(t,e){return(lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ut=new WeakMap,ct=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,o=it(e).call(this,t),n=!o||"object"!==et(o)&&"function"!=typeof o?rt(r):o,ut.set(rt(n),{cachedColumnHeaders:[]}),n.widths=[],n.ghostTable=new O(n.hot),n.samplesGenerator=new J(function(t,e){var r=n.hot.getCellMeta(t,e),o="";r.spanned||(o=n.hot.getDataAtCell(t,e));var i=0;if(r.label){var a=r.label,s=a.value,l=a.property,u="";s?u="function"==typeof s?s(t,e,n.hot.colToProp(e),o):s:l&&(u=n.hot.getDataAtRowProp(t,l)),i=u.length}return{value:o,bundleCountSeed:i}}),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeColumnResize",function(t,e,r){return n.onBeforeColumnResize(t,e,r)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lt(t,e)}(e,B),st(e,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),st(e,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().autoColumnSize;n&&null!==n.useHeaders&&void 0!==n.useHeaders&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("beforeChange",function(e){return t.onBeforeChange(e)}),this.addHook("beforeRender",function(e){return t.onBeforeRender(e)}),this.addHook("modifyColWidth",function(e,n){return t.getColumnWidth(n,e)}),this.addHook("afterInit",function(){return t.onAfterInit()}),ot(it(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.findColumnsWhereHeaderWasChanged();t.length&&this.clearCache(t),ot(it(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ot(it(e.prototype),"disablePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof e?{from:e,to:e}:e,i="number"==typeof n?{from:n,to:n}:n;Object(_.rangeEach)(o.from,o.to,function(e){if(r||void 0===t.widths[e]&&!t.hot._getColWidthFromSettings(e)){var n=t.samplesGenerator.generateColumnSamples(e,i);Object(w.arrayEach)(n,function(e){var n=nt(e,2),r=n[0],o=n[1];return t.ghostTable.addColumn(r,o)})}}),this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(e,n){t.widths[e]=n}),this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},r=0,o=this.hot.countCols()-1,i=null;this.inProgress=!0;var a=this.getSyncCalculationLimit();this.firstCalculation&&a>=0&&(this.calculateColumnsWidth({from:0,to:a},n),this.firstCalculation=!1,r=a+1),r<o?function a(){if(!t.hot)return Object(R.cancelAnimationFrame)(i),void(t.inProgress=!1);t.calculateColumnsWidth({from:r,to:Math.min(r+e.CALCULATION_STEP,o)},n),(r=r+e.CALCULATION_STEP+1)<o?i=Object(R.requestAnimationFrame)(a):(Object(R.cancelAnimationFrame)(i),t.inProgress=!1,t.hot.view.wt.wtOverlays.adjustElementsSize())}():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings().autoColumnSize,e=t&&Object(N.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,n=t&&Object(N.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&Object(b.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var t=e.SYNC_CALCULATION_LIMIT,n=this.hot.countCols()-1;return Object(N.isObject)(this.hot.getSettings().autoColumnSize)&&(t=this.hot.getSettings().autoColumnSize.syncLimit,Object(x.isPercentValue)(t)?t=Object(_.valueAccordingPercent)(n,t):t>>=0),Math.min(t,n)}},{key:"getColumnWidth",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e;return void 0===r&&(r=this.widths[t],n&&"number"==typeof r&&(r=Math.max(r,tt.d.DEFAULT_WIDTH))),r}},{key:"getFirstVisibleColumn",value:function(){var t=this.hot.view.wt;return t.wtViewport.columnsVisibleCalculator?t.wtTable.getFirstVisibleColumn():t.wtViewport.columnsRenderCalculator?t.wtTable.getFirstRenderedColumn():-1}},{key:"getLastVisibleColumn",value:function(){var t=this.hot.view.wt;return t.wtViewport.columnsVisibleCalculator?t.wtTable.getLastVisibleColumn():t.wtViewport.columnsRenderCalculator?t.wtTable.getLastRenderedColumn():-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var t=this.hot.getColHeader(),e=ut.get(this).cachedColumnHeaders;return Object(w.arrayReduce)(t,function(t,n,r){var o=e.length;return(o-1<r||e[r]!==n)&&t.push(r),o-1<r?e.push(n):e[r]=n,t},[])}},{key:"clearCache",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length?Object(w.arrayEach)(e,function(e){t.widths[e]=void 0}):this.widths.length=0}},{key:"isNeedRecalculate",value:function(){return!!Object(w.arrayFilter)(this.widths,function(t){return void 0===t}).length}},{key:"onBeforeRender",value:function(){var t=this.hot.renderCall,e=this.hot.countRows(),n=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();null!==n&&null!==r&&e&&(this.calculateColumnsWidth({from:n,to:r},void 0,t),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){t.hot&&t.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(t){var e=this,n=Object(w.arrayMap)(t,function(t){var n=nt(t,2)[1];return e.hot.propToCol(n)});this.clearCache(n)}},{key:"onBeforeColumnResize",value:function(t,e,n){var r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}},{key:"onAfterInit",value:function(){ut.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"destroy",value:function(){this.ghostTable.clean(),ot(it(e.prototype),"destroy",this).call(this)}}]),e}();Object(P.d)("autoColumnSize",ct);var ft=ct,ht=(n(29),n(44),n(26),n(50),{horizontal:"horizontal",vertical:"vertical"});function dt(t){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yt(t,e,n){return(yt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=mt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bt(t,e){return(bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}m.a.getSingleton().register("modifyAutofillRange"),m.a.getSingleton().register("beforeAutofill");var wt=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=mt(e).call(this,t))||"object"!==dt(o)&&"function"!=typeof o?vt(r):o).eventManager=new y.a(vt(n)),n.addingStarted=!1,n.mouseDownOnCellCorner=!1,n.mouseDragOutside=!1,n.handleDraggedCells=0,n.directions=[],n.autoInsertRow=!1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bt(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(e){return t.onAfterCellCornerMouseDown(e)}),this.addHook("afterOnCellCornerDblClick",function(e){return t.onCellCornerDblClick(e)}),this.addHook("beforeOnCellMouseOver",function(e,n){return t.onBeforeCellMouseOver(n)}),yt(mt(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),yt(mt(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),yt(mt(e.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var t={from:this.hot.getSelectedRangeLast().from,to:this.hot.getSelectedRangeLast().to};return this.hot.getData(t.from.row,t.from.col,t.to.row,t.to.col)}},{key:"fillIn",value:function(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var t=this.hot.selection.highlight.getFill().getCorners();this.resetSelectionOfDraggedArea();var e=this.getCornersOfSelectedCells(),n=function(t,e){var n,r,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",n=new tt.a(e[0],e[1]),r=new tt.a(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",n=new tt.a(e[0],t[3]+1),r=new tt.a(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",n=new tt.a(e[0],e[1]),r=new tt.a(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",n=new tt.a(t[2]+1,e[1]),r=new tt.a(e[2],e[3])),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:r}}(e,t=this.hot.runHooks("modifyAutofillRange",t,e)),r=n.directionOfDrag,o=n.startOfDragCoords,i=n.endOfDragCoords;if(o&&o.row>-1&&o.col>-1){var a=this.getSelectionData();this.hot.runHooks("beforeAutofill",o,i,a);var s=function(t,e,n,r){var o=n.length,i=n?n[0].length:0,a=[],s=e.row-t.row,l=e.col-t.col;if(-1!==["down","up"].indexOf(r)){for(var u=[],c=0;c<=l;c++){var f=parseInt(n[0][c],10),h=parseInt(n[o-1][c],10),d=("down"===r?h-f:f-h)/(o-1)||0;u.push(d)}a.push(u)}if(-1!==["right","left"].indexOf(r))for(var p=0;p<=s;p++){var g=parseInt(n[p][0],10),v=parseInt(n[p][i-1],10),y=("right"===r?v-g:g-v)/(i-1)||0;a.push([y])}return a}(o,i,a,r),l=a;if(["up","left"].indexOf(r)>-1){l=[];var u=null,c=null;if("up"===r){c=(u=i.row-o.row+1)%a.length;for(var f=0;f<u;f++)l.push(a[(f+(a.length-c))%a.length])}else{c=(u=i.col-o.col+1)%a[0].length;for(var h=0;h<a.length;h++){l.push([]);for(var d=0;d<u;d++)l[h].push(a[h][(d+(a[h].length-c))%a[h].length])}}}this.hot.populateFromArray(o.row,o.col,l,i.row,i.col,"".concat(this.pluginName,".fill"),null,r,s),this.setSelection(t)}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}},{key:"getCoordsOfDragAndDropBorders",value:function(t){var e,n=this.hot.getSelectedRangeLast().getTopLeftCorner(),r=this.hot.getSelectedRangeLast().getBottomRightCorner();if(this.directions.includes(ht.vertical)&&(r.row<t.row||n.row>t.row))e=new tt.a(t.row,r.col);else{if(!this.directions.includes(ht.horizontal))return;e=new tt.a(r.row,t.col)}return this.reduceSelectionAreaIfNeeded(e)}},{key:"showBorder",value:function(t){var e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}},{key:"addRow",value:function(){var t=this;this.hot._registerTimeout(setTimeout(function(){t.hot.alter("insert_row",void 0,1,"".concat(t.pluginName,".fill")),t.addingStarted=!1},200))}},{key:"addNewRowIfNeeded",value:function(){if(this.hot.selection.highlight.getFill().cellRange&&!1===this.addingStarted&&this.autoInsertRow){var t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getCorners(),n=this.hot.countRows();t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getCornersOfSelectedCells",value:function(){return this.hot.selection.isMultiple()?this.hot.selection.highlight.createOrGetArea().getCorners():this.hot.selection.highlight.getCell().getCorners()}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(t){for(var e,n=this.hot.getData(),r=this.hot.countRows(),o=t[2]+1;o<r;o++){for(var i=t[1];i<=t[3];i++){if(n[o][i])return-1}var a=n[o][t[1]-1],s=n[o][t[3]+1];(a||s)&&(e=o)}return e}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(t,e){this.hot.selection.highlight.getFill().clear().add(new tt.a(t[0],t[1])).add(new tt.a(e,t[3]))}},{key:"setSelection",value:function(t){var e;(e=this.hot).selectCell.apply(e,pt(t).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var t=this.getCornersOfSelectedCells(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(t){var e=this.hot.rootDocument.documentElement,n=Object(b.offset)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+Object(b.outerHeight)(this.hot.table),r=Object(b.offset)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+Object(b.outerWidth)(this.hot.table);return t.clientY>n&&t.clientX<=r}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mouseup",function(){return t.onMouseUp()}),this.eventManager.addEventListener(e,"mousemove",function(e){return t.onMouseMove(e)})}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(t){var e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var t=function(t){var e={};return!0===t?(e.directions=Object.keys(ht),e.autoInsertRow=!0):Object(N.isObject)(t)?(Object(M.isDefined)(t.autoInsertRow)?t.direction===ht.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Object(M.isDefined)(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(ht)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}},{key:"destroy",value:function(){yt(mt(e.prototype),"destroy",this).call(this)}}])&&gt(n.prototype,r),o&&gt(n,o),e}();Object(P.d)("autofill",wt);var Ct=wt;function Ot(t){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Et(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function St(t,e){return!e||"object"!==Ot(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kt(t,e,n){return(kt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Rt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Rt(t){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mt(t,e,n){return e&&Tt(t.prototype,e),n&&Tt(t,n),t}function _t(t,e){return(_t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=St(this,Rt(e).call(this,t))).heights=[],n.ghostTable=new O(n.hot),n.samplesGenerator=new J(function(t,e){var r;return t>=0?r=n.hot.getDataAtCell(t,e):-1===t&&(r=n.hot.getColHeader(e)),{value:r}}),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeRowResize",function(t,e,r){return n.onBeforeRowResize(t,e,r)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_t(t,e)}(e,B),Mt(e,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),Mt(e,[{key:"isEnabled",value:function(){return!0===this.hot.getSettings().autoRowSize||Object(N.isObject)(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("beforeChange",function(e){return t.onBeforeChange(e)}),this.addHook("beforeColumnMove",function(){return t.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return t.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return t.clearCache()}),this.addHook("beforeRender",function(e){return t.onBeforeRender(e)}),this.addHook("beforeRowMove",function(e,n){return t.onBeforeRowMove(e,n)}),this.addHook("modifyRowHeight",function(e,n){return t.getRowHeight(n,e)}),this.addHook("modifyColumnHeaderHeight",function(){return t.getColumnHeaderHeight()}),kt(Rt(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){kt(Rt(e.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof e?{from:e,to:e}:e,i="number"==typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){var a=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(a.get(-1))}Object(_.rangeEach)(o.from,o.to,function(e){if(r||void 0===t.heights[e]){var n=t.samplesGenerator.generateRowSamples(e,i);Object(w.arrayEach)(n,function(e){var n=Et(e,2),r=n[0],o=n[1];return t.ghostTable.addRow(r,o)})}}),this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(e,n){t.heights[e]=n}),this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},r=0,o=this.hot.countRows()-1,i=null;this.inProgress=!0;var a=this.getSyncCalculationLimit();this.firstCalculation&&a>=0&&(this.calculateRowsHeight({from:0,to:a},n),this.firstCalculation=!1,r=a+1),r<o?function a(){if(!t.hot)return Object(R.cancelAnimationFrame)(i),void(t.inProgress=!1);t.calculateRowsHeight({from:r,to:Math.min(r+e.CALCULATION_STEP,o)},n),(r=r+e.CALCULATION_STEP+1)<o?i=Object(R.requestAnimationFrame)(a):(Object(R.cancelAnimationFrame)(i),t.inProgress=!1,t.hot.view.wt.wtOverlays.adjustElementsSize(!0),t.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&t.hot.view.wt.wtOverlays.leftOverlay.clone.draw())}():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings().autoRowSize,e=t&&Object(N.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,n=t&&Object(N.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){Object(b.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var t=e.SYNC_CALCULATION_LIMIT,n=this.hot.countRows()-1;return Object(N.isObject)(this.hot.getSettings().autoRowSize)&&(t=this.hot.getSettings().autoRowSize.syncLimit,Object(x.isPercentValue)(t)?t=Object(_.valueAccordingPercent)(n,t):t>>=0),Math.min(t,n)}},{key:"getRowHeight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=e;return void 0!==this.heights[t]&&this.heights[t]>(e||0)&&(n=this.heights[t]),n}},{key:"getColumnHeaderHeight",value:function(){return this.heights[-1]}},{key:"getFirstVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.heights.length=0,this.heights[-1]=void 0}},{key:"clearCacheByRange",value:function(t){var e=this,n="number"==typeof t?{from:t,to:t}:t,r=n.from,o=n.to;Object(_.rangeEach)(Math.min(r,o),Math.max(r,o),function(t){e.heights[t]=void 0})}},{key:"isNeedRecalculate",value:function(){return!!Object(w.arrayFilter)(this.heights,function(t){return void 0===t}).length}},{key:"onBeforeRender",value:function(){var t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(null!==n&&null!==r){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){var o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-e,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(t,e){this.clearCacheByRange({from:t,to:e}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(t,e,n){var r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){t.hot&&t.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(t){var e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}},{key:"destroy",value:function(){this.ghostTable.clean(),kt(Rt(e.prototype),"destroy",this).call(this)}}]),e}();Object(P.d)("autoRowSize",Nt);var At=Nt,xt=(n(56),n(154),n(35),n(76),n(79),n(80),n(187),n(74));n(153);function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var It=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Dt=!1,Pt=!0,Lt=!0,Ht=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sortedColumnsStates=[],this.sortEmptyCells=Dt,this.indicator=Pt,this.headerAction=Lt,this.compareFunctionFactory=void 0}var e,n,r;return e=t,(n=[{key:"updateAllColumnsProperties",value:function(t){var e=this;Object(N.isObject)(t)&&Object(N.objectEach)(t,function(t,n){It.includes(n)&&(e[n]=t)})}},{key:"getAllColumnsProperties",value:function(){var t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}},{key:"getFirstSortedColumn",value:function(){var t;return this.getNumberOfSortedColumns()>0&&(t=this.sortedColumnsStates[0].column),t}},{key:"getSortOrderOfColumn",value:function(t){var e,n=this.sortedColumnsStates.find(function(e){var n=e.column;return t===n});return Object(N.isObject)(n)&&(e=n.sortOrder),e}},{key:"getSortedColumns",value:function(){return Object(w.arrayMap)(this.sortedColumnsStates,function(t){return t.column})}},{key:"getIndexOfColumnInSortQueue",value:function(t){return this.getSortedColumns().indexOf(t)}},{key:"getNumberOfSortedColumns",value:function(){return this.sortedColumnsStates.length}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(t){return this.getSortedColumns().includes(t)}},{key:"getSortStates",value:function(){return Object(N.deepClone)(this.sortedColumnsStates)}},{key:"getColumnSortState",value:function(t){if(this.isColumnSorted(t))return Object(N.deepClone)(this.sortedColumnsStates[this.getIndexOfColumnInSortQueue(t)])}},{key:"setSortStates",value:function(t){this.sortedColumnsStates=t}},{key:"destroy",value:function(){this.sortedColumnsStates.length=0,this.sortedColumnsStates=null}}])&&jt(e.prototype,n),r&&jt(e,r),t}(),Ft=(n(81),"asc"),Bt="desc",Wt="colHeader";function Vt(t){if(Object(M.isUndefined)(t))return!1;var e=t.column,n=t.sortOrder;return Number.isInteger(e)&&[Ft,Bt].includes(n)}function Ut(t){if(t!==Bt)return t===Ft?Bt:Ft}function Yt(t){return t.querySelector(".".concat(Wt))}function zt(t,e){if(t<0||!e.parentNode)return!1;var n=e.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(e.parentNode)-n.length}function Gt(t,e,n){return-1===t&&e>=0&&!1===Object(I.isRightClick)(n)}var Xt="indicatorDisabled",qt="columnSorting",Kt="sortAction",$t=new Map([[Ft,"ascending"],[Bt,"descending"]]);function Zt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Qt={_arrayMap:[],getValueByIndex:function(t){var e=null;return t<this._arrayMap.length&&(e=this._arrayMap[t]),e},getIndexByValue:function(t){var e;return-1===(e=this._arrayMap.indexOf(t))?null:e},insertItems:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=Object(w.arrayMax)(this._arrayMap)+1,o=[];return Object(_.rangeEach)(n-1,function(n){o.push(e._arrayMap.splice(t+n,0,r+n))}),o},removeItems:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[];if(Array.isArray(t)){var r=[].concat(this._arrayMap);t.sort(function(t,e){return e-t});for(var o=0,i=t.length;o<i;o++){var a=t[o];this._arrayMap.splice(a,1),n.push(r[a])}}else n=this._arrayMap.splice(t,e);return n},unshiftItems:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.removeItems(t,e);this._arrayMap=Object(w.arrayMap)(this._arrayMap,function(t){var e=t,r=function(t){return Object(w.arrayReduce)(n,function(e,n){var r=e;return t>n&&(r+=1),r},0)}(e);return r&&(e-=r),e})},shiftItems:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._arrayMap=Object(w.arrayMap)(this._arrayMap,function(e){var r=e;return r>=t&&(r+=n),r}),Object(_.rangeEach)(n-1,function(n){e._arrayMap.splice(t+n,0,t+n)})},swapIndexes:function(t,e){var n;(n=this._arrayMap).splice.apply(n,[e,0].concat(Zt(this._arrayMap.splice(t,1))))},clearMap:function(){this._arrayMap.length=0}};Object(N.defineGetter)(Qt,"MIXIN_NAME","arrayMapper",{writable:!1,enumerable:!1});var Jt=Qt;function te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ee=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(_.rangeEach)(n-1,function(t){e._arrayMap[t]=t})}},{key:"destroy",value:function(){this._arrayMap=null}}])&&te(e.prototype,n),r&&te(e,r),t}();Object(N.mixin)(ee,Jt);var ne=ee;var re="default";var oe=n(25),ie=n.n(oe);var ae=n(54),se=Object(ae.a)("sorting.compareFunctionFactory"),le=se.register,ue=se.getItem,ce=se.hasItem,fe=Object(ae.a)("sorting.mainSortComparator"),he=fe.register,de=fe.getItem;function pe(t){return ce(t)?ue(t):ue(re)}function ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}le("numeric",function(t,e,n){return function(e,r){var o=parseFloat(e),i=parseFloat(r),a=n.sortEmptyCells;if(o===i||isNaN(o)&&isNaN(i))return Ce;if(a){if(Object(M.isEmpty)(e))return"asc"===t?Oe:Ee;if(Object(M.isEmpty)(r))return"asc"===t?Ee:Oe}return isNaN(o)?Ee:isNaN(i)?Oe:o<i?"asc"===t?Oe:Ee:o>i?"asc"===t?Ee:Oe:Ce}}),le("date",function(t,e,n){return function(r,o){var i=n.sortEmptyCells;if(r===o)return Ce;if(Object(M.isEmpty)(r))return Object(M.isEmpty)(o)?Ce:i&&"asc"===t?Oe:Ee;if(Object(M.isEmpty)(o))return i&&"asc"===t?Ee:Oe;var a=e.dateFormat,s=ie()(r,a),l=ie()(o,a);return s.isValid()?l.isValid()?l.isAfter(s)?"asc"===t?Oe:Ee:l.isBefore(s)?"asc"===t?Ee:Oe:Ce:Oe:Ee}}),le(re,function(t,e,n){return function(e,r){var o=n.sortEmptyCells;return"string"==typeof e&&(e=e.toLowerCase()),"string"==typeof r&&(r=r.toLowerCase()),e===r?Ce:Object(M.isEmpty)(e)?Object(M.isEmpty)(r)?Ce:o&&"asc"===t?Oe:Ee:Object(M.isEmpty)(r)?o&&"asc"===t?Ee:Oe:isNaN(e)&&!isNaN(r)?"asc"===t?Ee:Oe:!isNaN(e)&&isNaN(r)?"asc"===t?Oe:Ee:(isNaN(e)||isNaN(r)||(e=parseFloat(e),r=parseFloat(r)),e<r?"asc"===t?Oe:Ee:e>r?"asc"===t?Ee:Oe:Ce)}});var ye=function t(e){ve(this,t),this.data=e,this.next=null,this.prev=null},me=function(){function t(){ve(this,t),this.first=null,this.last=null}var e,n,r;return e=t,(n=[{key:"push",value:function(t){var e=new ye(t);if(null===this.first)this.first=e,this.last=e;else{var n=this.last;this.last=e,e.prev=n,n.next=e}}},{key:"unshift",value:function(t){var e=new ye(t);if(null===this.first)this.first=e,this.last=e;else{var n=this.first;this.first=e,e.next=n,n.prev=e}}},{key:"inorder",value:function(t){for(var e=this.first;e;)t(e),e=e.next}},{key:"remove",value:function(t){if(null===this.first)return!1;for(var e,n,r=this.first;r;){if(r.data===t)return e=r.next,n=r.prev,e&&(e.prev=n),n&&(n.next=e),r===this.first&&(this.first=e),r===this.last&&(this.last=n),!0;r=r.next}return!1}},{key:"hasCycle",value:function(){for(var t=this.first,e=this.first;;){if(null===t)return!1;if(null===(t=t.next))return!1;if((t=t.next)===(e=e.next))return!0}}},{key:"pop",value:function(){if(null===this.last)return null;var t=this.last;return this.last=this.last.prev,t}},{key:"shift",value:function(){if(null===this.first)return null;var t=this.first;return this.first=this.first.next,t}},{key:"recursiveReverse",value:function(){if(this.first){!function t(e,n){n&&(t(n,n.next),n.next=e)}(this.first,this.first.next),this.first.next=null;var t=this.first;this.first=this.last,this.last=t}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var t,e=this.first.next,n=this.first;e;)t=e.next,e.next=n,n.prev=e,n=e,e=t;this.first.next=null,this.last.prev=null,t=this.first,this.first=n,this.last=t}}}])&&ge(e.prototype,n),r&&ge(e,r),t}(),be=function(t,e){var n=t.toString(),r=e.toString();return n===r?0:n<r?-1:1};function we(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(Math.abs(r-n)<=1)return[];var o=Math.ceil((n+r)/2);return we(t,e,n,o),we(t,e,o,r),function(t,e,n,r,o){for(var i=new me,a=new me,s=r-n,l=o-r,u=Math.max(s,l),c=o-n,f=0;f<u;f+=1)f<s&&i.push(t[n+f]),f<l&&a.push(t[r+f]);var h=0;for(;h<c;)i.first&&a.first?e(i.first.data,a.first.data)>0?t[n+h]=a.shift().data:t[n+h]=i.shift().data:i.first?t[n+h]=i.shift().data:t[n+h]=a.shift().data,h+=1;return t}(t,e,n,o,r)}var Ce=0,Oe=-1,Ee=1;function Se(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ke(t){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Re(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Te(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){Me(t,e,n[e])})}return t}function Me(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _e(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function Ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ae(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xe(t,e,n){return(xe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=je(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function je(t){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ie(t,e){return(Ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var De="columnSorting";he(De,function(t,e){return function(n,r){var o,i,a,s,l,u,c=Se(n).slice(1),f=Se(r).slice(1);return i=t[o=0],a=e[o],s=c[o],l=f[o],((u=a.columnSorting).compareFunctionFactory?u.compareFunctionFactory:pe(a.type))(i,a,u)(s,l)}}),m.a.getSingleton().register("beforeColumnSort"),m.a.getSingleton().register("afterColumnSort");var Pe=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=je(e).call(this,t))||"object"!==ke(o)&&"function"!=typeof o?Ae(r):o).columnStatesManager=new Ht,n.rowsMapper=new ne(Ae(n)),n.blockPluginTranslation=!0,n.columnMetaCache=new Map,n.pluginKey=De,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ie(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(Object(M.isUndefined)(this.hot.getSettings().observeChanges)&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",function(){return t.sortByPresetSortStates()}),this.addHook("afterUntrimRow",function(){return t.sortByPresetSortStates()}),this.addHook("modifyRow",function(e,n){return t.onModifyRow(e,n)}),this.addHook("unmodifyRow",function(e,n){return t.onUnmodifyRow(e,n)}),this.addHook("afterGetColHeader",function(e,n){return t.onAfterGetColHeader(e,n)}),this.addHook("beforeOnCellMouseDown",function(e,n,r,o){return t.onBeforeOnCellMouseDown(e,n,r,o)}),this.addHook("afterOnCellMouseDown",function(e,n){return t.onAfterOnCellMouseDown(e,n)}),this.addHook("afterCreateRow",function(e,n){return t.onAfterCreateRow(e,n)}),this.addHook("afterRemoveRow",function(e,n){return t.onAfterRemoveRow(e,n)}),this.addHook("afterInit",function(){return t.loadOrSortBySettings()}),this.addHook("afterLoadData",function(e){return t.onAfterLoadData(e)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol()}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol()}),this.hot.view&&this.loadOrSortBySettings(),xe(je(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=this,n=function(e,n){var r=Yt(n);!1!==zt(e,n)&&null!==r&&t.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",n),this.hot.addHookOnce("afterRender",function(){t.hot.removeHook("afterGetColHeader",n)}),this.rowsMapper.clearMap(),xe(je(e.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){var e=this,n=this.getSortConfig(),r=this.getNormalizedSortConfigs(t),o=this.areValidSortConfigs(r);if(!1!==this.hot.runHooks("beforeColumnSort",n,r,o)){if(o){var i=Object(w.arrayMap)(r,function(t){return r=(n=t).column,o=_e(n,["column"]),Te({column:e.hot.toPhysicalColumn(r)},o);var n,r,o});this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(),this.saveAllSortSettings(),this.hot.render(),this.hot.view.wt.draw(!0)}this.hot.runHooks("afterColumnSort",n,this.getSortConfig(),o)}}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(t){var e=this,n=function(t){var n=t.column,r=_e(t,["column"]);return Te({column:e.hot.toVisualColumn(n)},r)};if(Object(M.isDefined)(t)){var r=this.hot.toPhysicalColumn(t),o=this.columnStatesManager.getColumnSortState(r);return Object(M.isDefined)(o)?n(o):void 0}var i=this.columnStatesManager.getSortStates();return Object(w.arrayMap)(i,function(t){return n(t)})}},{key:"setSortConfig",value:function(t){var e=this,n=this.getNormalizedSortConfigs(t);if(this.areValidSortConfigs(n)){var r=Object(w.arrayMap)(n,function(t){return r=(n=t).column,o=_e(n,["column"]),Te({column:e.hot.toPhysicalColumn(r)},o);var n,r,o});this.columnStatesManager.setSortStates(r)}}},{key:"getNormalizedSortConfigs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t].slice(0,1)}},{key:"areValidSortConfigs",value:function(t){if(!1===Array.isArray(t))return!1;var e=t.map(function(t){return t.column}),n=this.hot.countCols(),r=e.every(function(t){return t<=n&&t>=0});return function(t){if(!1===Array.isArray(t)||!1===t.every(function(t){return Object(N.isObject)(t)}))return!1;var e=t.map(function(t){return t.column});return new Set(e).size===e.length&&t.every(Vt)}(t)&&r}},{key:"saveAllSortSettings",value:function(){var t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=this.columnStatesManager.getSortStates(),this.hot.runHooks("persistentStateSave","columnSorting",t)}},{key:"getAllSavedSortSettings",value:function(){var t=this,e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);var n=e.value;return Object(M.isDefined)(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Object(w.arrayMap)(n.initialConfig,function(e){var n=e.column,r=_e(e,["column"]);return Te({column:t.hot.toVisualColumn(n)},r)})),n}},{key:"getColumnNextConfig",value:function(t){var e=this.hot.toPhysicalColumn(t);if(this.columnStatesManager.isColumnSorted(e)){var n=this.getSortConfig(t),r=Ut(n.sortOrder);return Object(M.isDefined)(r)?(n.sortOrder=r,n):void 0}var o=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<o)return{column:t,sortOrder:Ut()}}},{key:"getNextSortConfig",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append",n=this.hot.toPhysicalColumn(t),r=this.columnStatesManager.getIndexOfColumnInSortQueue(n),o=this.columnStatesManager.isColumnSorted(n),i=this.getSortConfig(),a=this.getColumnNextConfig(t);if(o){if(Object(M.isUndefined)(a))return[].concat(Re(i.slice(0,r)),Re(i.slice(r+1)));if("append"===e)return[].concat(Re(i.slice(0,r)),Re(i.slice(r+1)),[a]);if("replace"===e)return[].concat(Re(i.slice(0,r)),[a],Re(i.slice(r+1)))}return Object(M.isDefined)(a)?i.concat(a):i}},{key:"setMergedPluginSettings",value:function(t){var e=this.hot.toPhysicalColumn(t),n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,t),i=Object.getPrototypeOf(o),a=Object.hasOwnProperty.call(i,this.pluginKey)?i[this.pluginKey]:{};this.columnMetaCache.set(e,Object.assign(r,n,a))}},{key:"getFirstCellSettings",value:function(t){var e=this.blockPluginTranslation;this.blockPluginTranslation=!0,(0===this.columnMetaCache.size||this.columnMetaCache.size<this.hot.countCols())&&this.rebuildColumnMetaCache();var n=this.hot.getCellMeta(0,t);this.blockPluginTranslation=e;var r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.get(this.hot.toPhysicalColumn(t)),r}},{key:"rebuildColumnMetaCache",value:function(){var t=this,e=this.hot.countCols();0===e?this.columnMetaCache.clear():Object(_.rangeEach)(e-1,function(e){return t.setMergedPluginSettings(e)})}},{key:"getNumberOfRowsToSort",value:function(t){var e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}},{key:"sortByPresetSortStates",value:function(){var t=this;if(this.columnStatesManager.isListOfSortedColumnsEmpty())this.rowsMapper.clearMap();else{var e=[],n=this.columnStatesManager.getSortedColumns(),r=this.hot.countRows();this.blockPluginTranslation=!0;for(var o=function(e){return Object(w.arrayMap)(n,function(n){return t.hot.getDataAtCell(e,t.hot.toVisualColumn(n))})},i=0;i<this.getNumberOfRowsToSort(r);i+=1)e.push([i].concat(o(i)));!function(t,e){for(var n=de(e),r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];we(t,n.apply(void 0,o))}(e,this.pluginKey,Object(w.arrayMap)(n,function(e){return t.columnStatesManager.getSortOrderOfColumn(e)}),Object(w.arrayMap)(n,function(e){return t.getFirstCellSettings(t.hot.toVisualColumn(e))}));for(var a=e.length;a<r;a+=1)e.push([a].concat(o(a)));this.blockPluginTranslation=!1,this.rowsMapper._arrayMap=Object(w.arrayMap)(e,function(t){return t[0]})}}},{key:"loadOrSortBySettings",value:function(){this.columnMetaCache.clear();var t=this.getAllSavedSortSettings();if(Object(N.isObject)(t))this.sortBySettings(t);else{var e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}},{key:"sortBySettings",value:function(t){if(Object(N.isObject)(t)){this.columnStatesManager.updateAllColumnsProperties(t);var e=t.initialConfig;(Array.isArray(e)||Object(N.isObject)(e))&&this.sort(e)}else this.hot.render()}},{key:"enableObserveChangesPlugin",value:function(){var t=this;this.hot._registerTimeout(setTimeout(function(){t.hot.updateSettings({observeChanges:!0})},0))}},{key:"onModifyRow",value:function(t,e){if(!1===this.blockPluginTranslation&&e!==this.pluginName&&this.isSorted()){var n=this.rowsMapper.getValueByIndex(t);t=null===n?t:n}return t}},{key:"onUnmodifyRow",value:function(t,e){return!1===this.blockPluginTranslation&&e!==this.pluginName&&this.isSorted()&&(t=this.rowsMapper.getIndexByValue(t)),t}},{key:"onAfterGetColHeader",value:function(t,e){var n=Yt(e);if(!1!==zt(t,e)&&null!==n){var r=this.hot.toPhysicalColumn(t),o=this.getFirstCellSettings(t)[this.pluginKey],i=o.indicator,a=o.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,r,i,a)}}},{key:"updateHeaderClasses",value:function(t){if(Object(b.removeClass)(t,Array.from($t.values()).concat(Kt,Xt,qt)),!1!==this.enabled){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];Object(b.addClass)(t,function(t,e,n,r){var o=[qt];if(r&&o.push(Kt),!1===n)o.push(Xt);else if(t.isColumnSorted(e)){var i=t.getSortOrderOfColumn(e);o.push($t.get(i))}return o}.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(t){xe(je(e.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache.clear(),Object(M.isDefined)(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}},{key:"onAfterLoadData",value:function(t){this.rowsMapper.clearMap(),this.columnMetaCache.clear(),!0===t&&this.hot.view&&this.loadOrSortBySettings()}},{key:"onAfterCreateRow",value:function(t,e){this.rowsMapper.shiftItems(t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.rowsMapper.unshiftItems(t,e)}},{key:"onAfterCreateCol",value:function(){this.columnMetaCache.clear()}},{key:"onAfterRemoveCol",value:function(){this.columnMetaCache.clear()}},{key:"wasClickableHeaderClicked",value:function(t,e){return this.getFirstCellSettings(e)[this.pluginKey].headerAction&&"SPAN"===t.realTarget.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){!1!==Gt(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&Object(xt.a)()&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==Gt(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(Object(xt.a)()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}},{key:"destroy",value:function(){this.rowsMapper.destroy(),this.columnStatesManager.destroy(),xe(je(e.prototype),"destroy",this).call(this)}}])&&Ne(n.prototype,r),o&&Ne(n,o),e}();Object(P.d)(De,Pe);var Le=Pe;function He(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Fe(t,e,n){return e&&He(t.prototype,e),n&&He(t,n),t}var Be=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootDocument=e,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return Fe(t,null,[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),Fe(t,[{key:"setPosition",value:function(t,e){this.editorStyle.left="".concat(t,"px"),this.editorStyle.top="".concat(e,"px")}},{key:"setSize",value:function(t,e){if(t&&e){var n=this.getInputElement();n.style.width="".concat(t,"px"),n.style.height="".concat(e,"px")}}},{key:"resetSize",value:function(){var t=this.getInputElement();t.style.width="",t.style.height=""}},{key:"setReadOnlyState",value:function(t){this.getInputElement().readOnly=t}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=t}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea"),r=this.rootDocument.querySelector(".".concat(t.CLASS_EDITOR_CONTAINER));return r||(r=this.rootDocument.createElement("div"),Object(b.addClass)(r,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(r)),Object(b.addClass)(e,t.CLASS_EDITOR),Object(b.addClass)(n,t.CLASS_INPUT),e.appendChild(n),r.appendChild(e),e}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(t.CLASS_INPUT))}},{key:"destroy",value:function(){this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null}}]),t}(),We=(n(62),n(52),"---------");function Ve(t){return Object(b.hasClass)(t,"htSeparator")}function Ue(t){return Object(b.hasClass)(t,"htDisabled")}function Ye(t){return Object(b.hasClass)(t,"htSelectionDisabled")}function ze(t){var e=t.getSelected();return e?e[0]<0?null:e:null}function Ge(t,e){var n={};return Object(w.arrayEach)(t,function(t){for(var r=t.from,o=t.to,i=r.row;i<=o.row;i++)for(var a=r.col;a<=o.col;a++)n[i]||(n[i]=[]),n[i][a]=e(i,a)}),n}function Xe(t,e,n,r,o){Object(w.arrayEach)(t,function(t){var i=t.from,a=t.to;if(i.row===a.row&&i.col===a.col)qe(i.row,i.col,e,n,r,o);else for(var s=i.row;s<=a.row;s++)for(var l=i.col;l<=a.col;l++)qe(s,l,e,n,r,o)})}function qe(t,e,n,r,o,i){var a=o(t,e),s=r;a.className&&(s="vertical"===n?function(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(e)}(a.className,r):function(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(e)}(a.className,r)),i(t,e,"className",s)}function Ke(t,e){var n=!1;return Array.isArray(t)&&Object(w.arrayEach)(t,function(t){return t.forAll(function(t,r){if(e(t,r))return n=!0,!1}),n}),n}function $e(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function Ze(t,e){for(var n=t.slice(0);0<n.length&&n[0].name===e;)n.shift();return n}function Qe(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:We,n=t.slice(0);return n=function(t){var e=[];return Object(w.arrayEach)(t,function(t,n){n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}(n=function(t,e){var n=t.slice(0);return n.reverse(),(n=Ze(n,e)).reverse(),n}(n=Ze(n,e),e))}var Je=n(39);function tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var en=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}var e,n,r;return e=t,(n=[{key:"hide",value:function(){var t=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){!1===t.wasLastActionShow&&t.runLocalHooks("hide")},250)}},{key:"show",value:function(t){this.wasLastActionShow=!0,this.showDebounced(t)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Object(T.debounce)(function(e){t.wasLastActionShow&&t.runLocalHooks("show",e.from.row,e.from.col)},e)}},{key:"destroy",value:function(){this.clearLocalHooks()}}])&&tn(e.prototype,n),r&&tn(e,r),t}();Object(N.mixin)(en,Je.a);var nn=en,rn=n(3);function on(t){return(on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function an(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ln(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function un(t,e,n){return(un="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cn(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function cn(t){return(cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fn(t,e){return(fn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hn=new WeakMap,dn=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=cn(e).call(this,t))||"object"!==on(o)&&"function"!=typeof o?ln(r):o).editor=null,n.displaySwitch=null,n.eventManager=null,n.range={},n.mouseDown=!1,n.contextMenuEvent=!1,n.timer=null,hn.set(ln(n),{tempEditorDimensions:{},cellBelowCursor:null}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fn(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.editor||(this.editor=new Be(this.hot.rootDocument)),this.eventManager||(this.eventManager=new y.a(this)),this.displaySwitch||(this.displaySwitch=new nn(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(e){return t.addToContextMenu(e)}),this.addHook("afterRenderer",function(e,n,r,o,i,a){return t.onAfterRenderer(e,a)}),this.addHook("afterScrollHorizontally",function(){return t.hide()}),this.addHook("afterScrollVertically",function(){return t.hide()}),this.addHook("afterBeginEditing",function(){return t.onAfterBeginEditing()}),this.displaySwitch.addLocalHook("hide",function(){return t.hide()}),this.displaySwitch.addLocalHook("show",function(e,n){return t.showAtCell(e,n)}),this.registerListeners(),un(cn(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),un(cn(e.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){un(cn(e.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var t=this,e=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(e,"mousedown",function(e){return t.onMouseDown(e)}),this.eventManager.addEventListener(e,"mouseup",function(){return t.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return t.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(e){return t.onEditorMouseDown(e)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(e){return t.onEditorMouseUp(e)})}},{key:"setRange",value:function(t){this.range=t}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(t){var e=Object(b.closest)(t.target,"TD","TBODY");return!!(e&&Object(b.hasClass)(e,"htCommentCell")&&Object(b.closest)(e,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(t){return this.editor.getInputElement()===t.target}},{key:"setComment",value:function(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.editor.getValue(),n="";null!=t?n=t:null!=e&&(n=e);var r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,an({},"value",n)),this.hot.render()}},{key:"setCommentAtCell",value:function(t,e,n){this.setRange({from:new tt.a(t,e)}),this.setComment(n)}},{key:"removeComment",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,"comment",void 0),t&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:new tt.a(t,e)}),this.removeComment(n)}},{key:"getComment",value:function(){var t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,"value")}},{key:"getCommentAtCell",value:function(t,e){return this.getCommentMeta(t,e,"value")}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(t.comment?t.comment.value:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(t,e){return this.setRange({from:new tt.a(t,e)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&this.editor.isVisible()){var t=this.hot.rootWindow,e=this.hot.view.wt,n=e.wtTable,r=e.wtOverlays,o=e.wtViewport,i=r.scrollableElement,a=n.getCell(this.range.from),s=this.range.from.row,l=this.range.from.col,u=Object(b.offset)(a),c=n.getStretchedColumnWidth(l),f=u.top<0?0:u.top,h=u.left;o.hasVerticalScroll()&&i!==t&&(f-=r.topOverlay.getScrollPosition()),o.hasHorizontalScroll()&&i!==t&&(h-=r.leftOverlay.getScrollPosition());var d=h+c,p=f,g=this.getCommentMeta(s,l,"style"),v=this.getCommentMeta(s,l,"readOnly");g?this.editor.setSize(g.width,g.height):this.editor.resetSize(),this.editor.setReadOnlyState(v),this.editor.setPosition(d,p)}}},{key:"checkSelectionCommentsConsistency",value:function(){var t=this.hot.getSelectedRangeLast();if(!t)return!1;var e=!1,n=t.from;return this.getCommentMeta(n.row,n.col,"value")&&(e=!0),e}},{key:"updateCommentMeta",value:function(t,e,n){var r,o=this.hot.getCellMeta(t,e).comment;o?(r=Object(N.deepClone)(o),Object(N.deepExtend)(r,n)):r=n,this.hot.setCellMeta(t,e,"comment",r)}},{key:"getCommentMeta",value:function(t,e,n){var r=this.hot.getCellMeta(t,e);if(r.comment)return r.comment[n]}},{key:"onMouseDown",value:function(t){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(t)){var e=Object(b.closest)(t.target,"TD","TBODY"),n=null;e&&(n=this.hot.view.wt.wtTable.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(t){var e=hn.get(this),n=this.hot.rootDocument;if(e.cellBelowCursor=n.elementFromPoint(t.clientX,t.clientY),!(this.mouseDown||this.editor.isFocused()||Object(b.hasClass)(t.target,"wtBorder")||e.cellBelowCursor!==t.target)&&this.editor)if(this.targetIsCellWithComment(t)){var r=this.hot.view.wt.wtTable.getCoords(t.target),o={from:new tt.a(r.row,r.col)};this.displaySwitch.show(o)}else Object(b.isChildOf)(t.target,n)&&!this.targetIsCommentTextArea(t)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(t,e){e.comment&&e.comment.value&&Object(b.addClass)(t,e.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(t){hn.get(this).tempEditorDimensions={width:Object(b.outerWidth)(t.target),height:Object(b.outerHeight)(t.target)}}},{key:"onEditorMouseUp",value:function(t){var e=hn.get(this),n=Object(b.outerWidth)(t.target),r=Object(b.outerHeight)(t.target);n===e.tempEditorDimensions.width+1&&r===e.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,an({},"style",{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var t=this;this.displaySwitch.cancelHiding();var e=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,this.setRange({from:e.from}),this.show(),setTimeout(function(){t.hot&&(t.hot.deselectCell(),t.editor.focus())},10)}},{key:"onContextMenuRemoveComment",value:function(){var t=this.hot.getSelectedRangeLast(),e=t.from,n=t.to;this.contextMenuEvent=!0;for(var r=e.row;r<=n.row;r++)for(var o=e.col;o<=n.col;o++)this.removeCommentAtCell(r,o,!1);this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var t=this.hot.getSelectedRangeLast(),e=t.from,n=t.to;this.contextMenuEvent=!0;for(var r=e.row;r<=n.row;r++)for(var o=e.col;o<=n.col;o++){var i=!!this.getCommentMeta(r,o,"readOnly");this.updateCommentMeta(r,o,an({},"readOnly",!i))}}},{key:"addToContextMenu",value:function(t){var e=this;t.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return e.checkSelectionCommentsConsistency()?e.hot.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_EDIT_COMMENT):e.hot.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return e.onContextMenuAddComment()},disabled:function(){return!(this.getSelectedLast()&&!this.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(){return e.onContextMenuRemoveComment()},disabled:function(){return e.hot.selection.isSelectedByCorner()}},{key:"commentsReadOnly",name:function(){var t=this,e=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return Ke(this.getSelectedRangeLast(),function(e,n){var r=t.getCellMeta(e,n).comment;if(r&&(r=r.readOnly),r)return!0})&&(e=$e(e)),e},callback:function(){return e.onContextMenuMakeReadOnly()},disabled:function(){return e.hot.selection.isSelectedByCorner()||!e.checkSelectionCommentsConsistency()}})}},{key:"getDisplayDelaySetting",value:function(){var t=this.hot.getSettings().comments;if(Object(N.isObject)(t))return t.displayDelay}},{key:"onAfterBeginEditing",value:function(){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),un(cn(e.prototype),"destroy",this).call(this)}}])&&sn(n.prototype,r),o&&sn(n,o),e}();Object(P.d)("comments",dn);var pn=dn;n(64),n(61);function gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var vn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.commands={},this.commonCallback=null}var e,n,r;return e=t,(n=[{key:"registerCommand",value:function(t,e){this.commands[t]=e}},{key:"setCommonCallback",value:function(t){this.commonCallback=t}},{key:"execute",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=t.split(":"),a=i[0],s=2===i.length?i[1]:null,l=this.commands[a];if(!l)throw new Error("Menu command '".concat(a,"' not exists."));if(s&&l.submenu&&(l=function(t,e){var n;return Object(w.arrayEach)(e,function(e){var r=e.key?e.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=e,!1}),n}(s,l.submenu.items)),!0!==l.disabled&&("function"!=typeof l.disabled||!0!==l.disabled.call(this.hot))&&!Object(N.hasOwnProperty)(l,"submenu")){var u=[];"function"==typeof l.callback&&u.push(l.callback),"function"==typeof this.commonCallback&&u.push(this.commonCallback),r.unshift(i.join(":")),Object(w.arrayEach)(u,function(t){return t.apply(e.hot,r)})}}}])&&gn(e.prototype,n),r&&gn(e,r),t}(),yn="alignment";function mn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var bn="clear_column";function wn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Cn="col_left";function On(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var En="col_right";var Sn="make_read_only";var kn="redo";var Rn=n(48);function Tn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Mn="remove_col";function _n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Nn="remove_row";var An="row_above";var xn="row_below";var jn="no_items";var In,Dn="undo";function Pn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ln=[An,xn,Cn,En,bn,Nn,Mn,Dn,kn,Sn,yn,We,jn],Hn=(Pn(In={},We,function(){return{name:We}}),Pn(In,jn,function(){return{key:jn,name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}),Pn(In,An,function(){return{key:An,name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_row",n.start.row,1,"ContextMenu.rowAbove")},disabled:function(){return!ze(this)||this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}),Pn(In,xn,function(){return{key:xn,name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_row",n.end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){return!ze(this)||this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}),Pn(In,Cn,function(){return{key:Cn,name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_col",n.start.col,1,"ContextMenu.columnLeft")},disabled:function(){var t=ze(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=wn(t[0],3),n=e[0],r=e[1],o=[n,0,e[2],this.countCols()-1].join(",")===t.join(","),i=1===this.countCols();return r<0||this.countCols()>=this.getSettings().maxCols||!i&&o},hidden:function(){return!this.getSettings().allowInsertColumn}}}),Pn(In,En,function(){return{key:En,name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_col",n.end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var t=ze(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=On(t[0],3),n=e[0],r=e[1],o=[n,0,e[2],this.countCols()-1].join(",")===t.join(","),i=1===this.countCols();return r<0||this.countCols()>=this.getSettings().maxCols||!i&&o},hidden:function(){return!this.getSettings().allowInsertColumn}}}),Pn(In,bn,function(){return{key:bn,name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(t,e){var n=e[0].start.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled:function(){var t=ze(this);if(!t)return!0;var e=mn(t[0],3),n=e[0],r=e[1],o=[n,0,e[2],this.countCols()-1].join(",")===t.join(",");return r<0||this.countCols()>=this.getSettings().maxCols||o}}}),Pn(In,Nn,function(){return{key:Nn,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=_n(t[0],3);n[0]-n[2]!=0&&(e=1)}return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback:function(){this.alter("remove_row",Object(Rn.g)(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=ze(this),e=this.countRows();return!t||this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner()||!e},hidden:function(){return!this.getSettings().allowRemoveRow}}}),Pn(In,Mn,function(){return{key:Mn,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=Tn(t[0],4);n[1]-n[3]!=0&&(e=1)}return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback:function(){this.alter("remove_col",Object(Rn.f)(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){var t=ze(this),e=this.countCols();return!t||this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner()||!this.isColumnModificationAllowed()||!e},hidden:function(){return!this.getSettings().allowRemoveColumn}}}),Pn(In,Dn,function(){return{key:Dn,name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}),Pn(In,kn,function(){return{key:kn,name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}),Pn(In,Sn,function(){return{key:Sn,name:function(){var t=this,e=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_READ_ONLY);return Ke(this.getSelectedRange(),function(e,n){return t.getCellMeta(e,n).readOnly})&&(e=$e(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ke(e,function(e,n){return t.getCellMeta(e,n).readOnly});Object(w.arrayEach)(e,function(e){e.forAll(function(e,r){t.setCellMeta(e,r,"readOnly",!n)})}),this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())}}}),Pn(In,yn,function(){return{key:yn,name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(yn,":left"),name:function(){var t=this,e=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return Ke(this.getSelectedRange(),function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htLeft"))return!0})&&(e=$e(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ge(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"horizontal","htLeft"),Xe(e,"horizontal","htLeft",function(e,n){return t.getCellMeta(e,n)},function(e,n,r,o){return t.setCellMeta(e,n,r,o)}),this.render()},disabled:!1},{key:"".concat(yn,":center"),name:function(){var t=this,e=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return Ke(this.getSelectedRange(),function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htCenter"))return!0})&&(e=$e(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ge(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"horizontal","htCenter"),Xe(e,"horizontal","htCenter",function(e,n){return t.getCellMeta(e,n)},function(e,n,r,o){return t.setCellMeta(e,n,r,o)}),this.render()},disabled:!1},{key:"".concat(yn,":right"),name:function(){var t=this,e=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return Ke(this.getSelectedRange(),function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htRight"))return!0})&&(e=$e(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ge(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"horizontal","htRight"),Xe(e,"horizontal","htRight",function(e,n){return t.getCellMeta(e,n)},function(e,n,r,o){return t.setCellMeta(e,n,r,o)}),this.render()},disabled:!1},{key:"".concat(yn,":justify"),name:function(){var t=this,e=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return Ke(this.getSelectedRange(),function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htJustify"))return!0})&&(e=$e(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ge(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"horizontal","htJustify"),Xe(e,"horizontal","htJustify",function(e,n){return t.getCellMeta(e,n)},function(e,n,r,o){return t.setCellMeta(e,n,r,o)}),this.render()},disabled:!1},{name:We},{key:"".concat(yn,":top"),name:function(){var t=this,e=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return Ke(this.getSelectedRange(),function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htTop"))return!0})&&(e=$e(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ge(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"vertical","htTop"),Xe(e,"vertical","htTop",function(e,n){return t.getCellMeta(e,n)},function(e,n,r,o){return t.setCellMeta(e,n,r,o)}),this.render()},disabled:!1},{key:"".concat(yn,":middle"),name:function(){var t=this,e=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return Ke(this.getSelectedRange(),function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htMiddle"))return!0})&&(e=$e(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ge(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"vertical","htMiddle"),Xe(e,"vertical","htMiddle",function(e,n){return t.getCellMeta(e,n)},function(e,n,r,o){return t.setCellMeta(e,n,r,o)}),this.render()},disabled:!1},{key:"".concat(yn,":bottom"),name:function(){var t=this,e=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return Ke(this.getSelectedRange(),function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htBottom"))return!0})&&(e=$e(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ge(e,function(e,n){return t.getCellMeta(e,n).className});this.runHooks("beforeCellAlignment",n,e,"vertical","htBottom"),Xe(e,"vertical","htBottom",function(e,n){return t.getCellMeta(e,n)},function(e,n,r,o){return t.setCellMeta(e,n,r,o)}),this.render()},disabled:!1}]}}}),In);function Fn(){var t={};return Object(N.objectEach)(Hn,function(e,n){t[n]=e()}),t}function Bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.predefinedItems=Fn(),this.defaultOrderPattern=n}var e,n,r;return e=t,(n=[{key:"setPredefinedItems",value:function(t){var e=this,n={};this.defaultOrderPattern.length=0,Object(N.objectEach)(t,function(t,r){var o="";t.name===We?(n[We]=t,o=We):isNaN(parseInt(r,10))?(t.key=void 0===t.key?r:t.key,n[r]=t,o=t.key):(n[t.key]=t,o=t.key),e.defaultOrderPattern.push(o)}),this.predefinedItems=n}},{key:"getItems",value:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o=t;o&&o.items?o=o.items:Array.isArray(o)||(o=e);Object(N.isObject)(o)?Object(N.objectEach)(o,function(t,e){var o=n["string"==typeof t?t:e];o||(o=t),Object(N.isObject)(t)?Object(N.extend)(o,t):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=e),r.push(o)}):Object(w.arrayEach)(o,function(t,e){var o=n[t];!o&&Ln.indexOf(t)>=0||(o||(o={name:t,key:"".concat(e)}),Object(N.isObject)(t)&&Object(N.extend)(o,t),void 0===o.key&&(o.key=e),r.push(o))});return r}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}])&&Bn(e.prototype,n),r&&Bn(e,r),t}();n(125);function Vn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Un=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r,o,i,a,s,l,u=Object(b.getWindowScrollTop)(n),c=Object(b.getWindowScrollLeft)(n);this.rootWindow=n,this.type=this.getSourceType(e),"literal"===this.type?(r=parseInt(e.top,10),i=parseInt(e.left,10),s=e.height||0,l=e.width||0,o=r,a=i,r+=u,i+=c):"event"===this.type&&(r=parseInt(Object(I.pageY)(e),10),i=parseInt(Object(I.pageX)(e),10),s=e.target.clientHeight,l=e.target.clientWidth,o=r-u,a=i-c),this.top=r,this.topRelative=o,this.left=i,this.leftRelative=a,this.scrollTop=u,this.scrollLeft=c,this.cellHeight=s,this.cellWidth=l}var e,n,r;return e=t,(n=[{key:"getSourceType",value:function(t){var e="literal";return t instanceof Event&&(e="event"),e}},{key:"fitsAbove",value:function(t){return this.topRelative>=t.offsetHeight}},{key:"fitsBelow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}},{key:"fitsOnRight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}},{key:"fitsOnLeft",value:function(t){return this.leftRelative>=t.offsetWidth}}])&&Vn(e.prototype,n),r&&Vn(e,r),t}();function Yn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var zn=215,Gn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:zn},this.eventManager=new y.a(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}var e,n,r;return e=t,(n=[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"mousedown",function(e){return t.onDocumentMouseDown(e)})}},{key:"setMenuItems",value:function(t){this.menuItems=t}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[t]=e}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var t=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var e=Object(T.debounce)(function(e){return t.openSubMenu(e)},300),n=this.options.minWidth||zn,r=!1,o=Object(w.arrayFilter)(this.menuItems,function(e){return e.key===jn&&(r=!0),function(t,e){return!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))}(e,t.hot)});if(o.length<1&&!r)o.push(Fn()[jn]);else if(0===o.length)return;var i={data:o=Qe(o,We),colHeaders:!1,autoColumnSize:!0,modifyColWidth:function(t){return Object(M.isDefined)(t)&&t<n?n:t},autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(e,n,r,o,i,a){return t.menuItemRenderer(e,n,r,o,i,a)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(e){return t.onBeforeKeyDown(e)},afterOnCellMouseOver:function(n,r){t.isAllSubMenusClosed()?e(r.row):t.openSubMenu(r.row)},rowHeights:function(t){return o[t].name===We?1:23}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new v.a(this.container,i),this.hotMenu.addHook("afterInit",function(){return t.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return t.onAfterSelection.apply(t,arguments)}),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(t&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(e){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!function(t){return Object(b.hasClass)(t,"htSubmenu")}(n))return!1;var r=this.hotMenu.getSourceDataAtRow(e),o=new t(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=o,o}},{key:"closeSubMenu",value:function(t){var e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];n&&(n.destroy(),delete this.hotSubMenus[e.key])}},{key:"closeAllSubMenus",value:function(){var t=this;Object(w.arrayEach)(this.hotMenu.getData(),function(e,n){return t.closeSubMenu(n)})}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy()}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(t){if(this.isOpened()&&this.hotMenu.getSelectedLast()){var e=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]);if(this.runLocalHooks("select",e,t),!1!==e.isCommand&&e.name!==We){var n=this.hot.getSelectedRange(),r=n?function(t){return Object(w.arrayMap)(t,function(t){return{start:t.getTopLeftCorner(),end:t.getBottomRightCorner()}})}(n):[],o=!0;(!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(this.hot)||e.submenu)&&(o=!1),this.runLocalHooks("executeCommand",e.key,r,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,r,t),o&&this.close(!0)}}}},{key:"setPosition",value:function(t){var e=new Un(t,this.hot.rootWindow);this.options.keepInViewport?(e.fitsBelow(this.container)?this.setPositionBelowCursor(e):e.fitsAbove(this.container)?this.setPositionAboveCursor(e):this.setPositionBelowCursor(e),e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)):(this.setPositionBelowCursor(e),this.setPositionOnRightOfCursor(e))}},{key:"setPositionAboveCursor",value:function(t){var e=this.offset.above+t.top-this.container.offsetHeight;this.isSubMenu()&&(e=t.top+t.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(e,"px")}},{key:"setPositionBelowCursor",value:function(t){var e=this.offset.below+t.top;this.isSubMenu()&&(e=t.top-1),this.container.style.top="".concat(e,"px")}},{key:"setPositionOnRightOfCursor",value:function(t){var e;e=this.isSubMenu()?1+t.left+t.cellWidth:this.offset.right+1+t.left,this.container.style.left="".concat(e,"px")}},{key:"setPositionOnLeftOfCursor",value:function(t){var e=this.offset.left+t.left-this.container.offsetWidth+Object(b.getScrollbarWidth)(this.hot.rootDocument)+4;this.container.style.left="".concat(e,"px")}},{key:"selectFirstCell",value:function(){var t=this.hotMenu.getCell(0,0);Ve(t)||Ue(t)||Ye(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var t=this.hotMenu.countRows()-1,e=this.hotMenu.getCell(t,0);Ve(e)||Ue(e)||Ye(e)?this.selectPrevCell(t,0):this.hotMenu.selectCell(t,0)}},{key:"selectNextCell",value:function(t,e){var n=t+1,r=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,e):null;r&&(Ve(r)||Ue(r)||Ye(r)?this.selectNextCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"selectPrevCell",value:function(t,e){var n=t-1,r=n>=0?this.hotMenu.getCell(n,e):null;r&&(Ve(r)||Ue(r)||Ye(r)?this.selectPrevCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"menuItemRenderer",value:function(t,e,n,r,o,i){var a,s=this,l=t.getSourceDataAtRow(n),u=this.hot.rootDocument.createElement("div"),c=function(t){return t.disableSelection},f=i;"function"==typeof f&&(f=f.call(this.hot)),Object(b.empty)(e),Object(b.addClass)(u,"htItemWrapper"),e.appendChild(u),a=l,new RegExp(We,"i").test(a.name)?Object(b.addClass)(e,"htSeparator"):"function"==typeof l.renderer?(Object(b.addClass)(e,"htCustomMenuRenderer"),e.appendChild(l.renderer(t,u,n,r,o,f))):Object(b.fastInnerHTML)(u,f),!function(t){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(s.hot)}(l)?c(l)?(Object(b.addClass)(e,"htSelectionDisabled"),this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()})):!function(t){return Object(N.hasOwnProperty)(t,"submenu")}(l)?(Object(b.removeClass)(e,"htSubmenu"),Object(b.removeClass)(e,"htDisabled"),c(l)?this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()}):this.eventManager.addEventListener(e,"mouseenter",function(){return t.selectCell(n,r,void 0,void 0,!1,!1)})):(Object(b.addClass)(e,"htSubmenu"),c(l)?this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()}):this.eventManager.addEventListener(e,"mouseenter",function(){return t.selectCell(n,r,void 0,void 0,!1,!1)})):(Object(b.addClass)(e,"htDisabled"),this.eventManager.addEventListener(e,"mouseenter",function(){return t.deselectCell()}))}},{key:"createContainer",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.hot.rootDocument,r=e;return r?(Object(T.isFunction)(r)&&(r=null===(r=r.call(this.hot))||Object(M.isUndefined)(r)?"":r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r="".concat(this.options.className,"Sub_").concat(r),t=n.querySelector(".".concat(this.options.className,".").concat(r))):t=n.querySelector(".".concat(this.options.className)),t||(t=n.createElement("div"),Object(b.addClass)(t,"htMenu ".concat(this.options.className)),r&&Object(b.addClass)(t,r),n.getElementsByTagName("body")[0].appendChild(t)),t}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(t){var e=this.hotMenu.getSelectedLast(),n=!1;switch(this.keyEvent=!0,t.keyCode){case j.KEY_CODES.ESCAPE:this.close(),n=!0;break;case j.KEY_CODES.ENTER:e&&(this.hotMenu.getSourceDataAtRow(e[0]).submenu?n=!0:(this.executeCommand(t),this.close(!0)));break;case j.KEY_CODES.ARROW_DOWN:e?this.selectNextCell(e[0],e[1]):this.selectFirstCell(),n=!0;break;case j.KEY_CODES.ARROW_UP:e?this.selectPrevCell(e[0],e[1]):this.selectLastCell(),n=!0;break;case j.KEY_CODES.ARROW_RIGHT:if(e){var r=this.openSubMenu(e[0]);r&&r.selectFirstCell()}n=!0;break;case j.KEY_CODES.ARROW_LEFT:e&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),n=!0)}n&&(t.preventDefault(),Object(I.stopImmediatePropagation)(t)),this.keyEvent=!1}},{key:"onAfterInit",value:function(){var t=this.hotMenu.view.wt.wtTable,e=this.hotMenu.getSettings().data,n=t.hider.style,r=t.holder.style,o=parseInt(n.width,10),i=Object(w.arrayReduce)(e,function(t,e){return t+(e.name===We?1:26)},0);r.width="".concat(o+22,"px"),r.height="".concat(i+4,"px"),n.height=r.height}},{key:"onAfterSelection",value:function(t,e,n,r,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(t){this.isOpened()&&(this.container&&Object(b.isChildOf)(t.target,this.container)&&this.executeCommand(t),this.options.standalone&&this.hotMenu&&!Object(b.isChildOf)(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Object(b.isChildOf)(t.target,".htMenu")&&Object(b.isChildOf)(t.target,this.hot.rootDocument)&&this.close(!0))}}])&&Yn(e.prototype,n),r&&Yn(e,r),t}();Object(N.mixin)(Gn,Je.a);var Xn=Gn;function qn(t){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $n(t,e,n){return($n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zn(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Zn(t){return(Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jn(t,e,n){return e&&Qn(t.prototype,e),n&&Qn(t,n),t}function tr(t,e){return(tr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}m.a.getSingleton().register("afterContextMenuDefaultOptions"),m.a.getSingleton().register("beforeContextMenuShow"),m.a.getSingleton().register("afterContextMenuShow"),m.a.getSingleton().register("afterContextMenuHide"),m.a.getSingleton().register("afterContextMenuExecute");var er=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=Zn(e).call(this,t))||"object"!==qn(o)&&"function"!=typeof o?Kn(r):o).eventManager=new y.a(Kn(n)),n.commandExecutor=new vn(n.hot),n.itemsFactory=null,n.menu=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tr(t,e)}(e,B),Jn(e,null,[{key:"DEFAULT_ITEMS",get:function(){return[An,xn,We,Cn,En,We,Nn,Mn,We,Dn,kn,We,Sn,We,yn]}}]),Jn(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().contextMenu;"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Xn(this.hot,{className:"htContextMenu",keepInViewport:!0}),this.menu.addLocalHook("beforeOpen",function(){return t.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return t.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return t.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.executeCommand).call.apply(e,[t].concat(r))}),this.addHook("afterOnCellContextMenu",function(e){return t.onAfterOnCellContextMenu(e)}),$n(Zn(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),$n(Zn(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),$n(Zn(e.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(t){this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened()&&(this.menu.setPosition({top:parseInt(Object(I.pageY)(t),10)-Object(b.getWindowScrollTop)(this.hot.rootWindow),left:parseInt(Object(I.pageX)(t),10)-Object(b.getWindowScrollLeft)(this.hot.rootWindow)}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv))}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(t){var e;null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"prepareMenuItems",value:function(){var t=this;this.itemsFactory=new Wn(this.hot,e.DEFAULT_ITEMS);var n=this.hot.getSettings().contextMenu,r={items:this.itemsFactory.getItems(n)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);var o=this.itemsFactory.getItems(n);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),Object(w.arrayEach)(o,function(e){return t.commandExecutor.registerCommand(e.key,e)})}},{key:"onAfterOnCellContextMenu",value:function(t){var e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;var o=t.realTarget;this.close(),Object(b.hasClass)(o,"handsontableInput")||(t.preventDefault(),Object(I.stopPropagation)(t),(n||r||function(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}(o)||Object(b.hasClass)(o,"current")&&Object(b.hasClass)(o,"wtBorder"))&&this.open(t))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),$n(Zn(e.prototype),"destroy",this).call(this)}}]),e}();er.SEPARATOR={name:We},Object(P.d)("contextMenu",er);var nr=er,rr=n(83),or=n.n(rr);function ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ar=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data={}}var e,n,r;return e=t,(n=[{key:"setData",value:function(t,e){this.data[t]=e}},{key:"getData",value:function(t){return this.data[t]||void 0}}])&&ir(e.prototype,n),r&&ir(e,r),t}();var sr=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.clipboardData=new ar};n(219);function lr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ur=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootDocument=e,this.mainElement=null,this.eventManager=new y.a(this),this.listenersCount=new WeakSet}var e,n,r;return e=t,(n=[{key:"useSecondaryElement",value:function(){var t=function(t){var e=dr.get(t);if(e)return e.parentElement||this.rootDocument.body.appendChild(e),e;var n=t.createElement("textarea");return dr.set(t,n),n.id="HandsontableCopyPaste",n.className="copyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",t.body.appendChild(n),n}(this.rootDocument);this.listenersCount.has(t)||(this.listenersCount.add(t),hr(this.eventManager,t,this)),this.mainElement=t}},{key:"setFocusableElement",value:function(t){this.listenersCount.has(t)||(this.listenersCount.add(t),hr(this.eventManager,t,this)),this.mainElement=t}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Object(E.isMobileBrowser)()||Object(b.selectElementIfAllowed)(this.mainElement)}}])&&lr(e.prototype,n),r&&lr(e,r),t}();Object(N.mixin)(ur,Je.a);var cr=0;var fr=function(t,e){return function(n){return e.runLocalHooks(t,n)}};function hr(t,e,n){t.addEventListener(e,"copy",fr("copy",n)),t.addEventListener(e,"cut",fr("cut",n)),t.addEventListener(e,"paste",fr("paste",n))}var dr=new WeakMap;function pr(t){if(t instanceof ur&&(cr>0&&(cr-=1),function(t){t.eventManager.clear()}(t),cr<=0)){cr=0;var e=dr.get(t.rootDocument);e&&e.parentNode&&(e.parentNode.removeChild(e),dr.delete(t.rootDocument)),t.mainElement=null}}function gr(t,e){var n=t.length,r=["<table>"],o=e.createElement("div");e.documentElement.appendChild(o);for(var i=0;i<n;i+=1){var a=t[i],s=a.length,l=[];0===i&&r.push("<tbody>");for(var u=0;u<s;u+=1)o.innerText="".concat(Object(M.isEmpty)(a[u])?"":a[u]),l.push("<td>".concat(o.innerHTML,"</td>"));r.push.apply(r,["<tr>"].concat(l,["</tr>"])),i+1===n&&r.push("</tbody>")}return e.documentElement.removeChild(o),r.push("</table>"),r.join("")}function vr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function yr(t){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function br(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wr(t,e,n){return(wr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Cr(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Cr(t){return(Cr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Or(t,e){return(Or=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}m.a.getSingleton().register("afterCopyLimit"),m.a.getSingleton().register("modifyCopyableRange"),m.a.getSingleton().register("beforeCut"),m.a.getSingleton().register("afterCut"),m.a.getSingleton().register("beforePaste"),m.a.getSingleton().register("afterPaste"),m.a.getSingleton().register("beforeCopy"),m.a.getSingleton().register("afterCopy");var Er=1e3,Sr=1e3,kr=new WeakMap,Rr=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=Cr(e).call(this,t))||"object"!==yr(o)&&"function"!=typeof o?br(r):o).columnsLimit=Sr,n.copyableRanges=[],n.pasteMode="overwrite",n.rowsLimit=Er,kr.set(br(n),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Or(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n,r,o=this.hot.getSettings();kr.get(this).isFragmentSelectionEnabled=o.fragmentSelection,"object"===yr(o.copyPaste)&&(this.pasteMode=o.copyPaste.pasteMode||this.pasteMode,this.rowsLimit=o.copyPaste.rowsLimit||this.rowsLimit,this.columnsLimit=o.copyPaste.columnsLimit||this.columnsLimit),this.addHook("afterContextMenuDefaultOptions",function(e){return t.onAfterContextMenuDefaultOptions(e)}),this.addHook("afterOnCellMouseUp",function(){return t.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return t.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return t.onBeforeKeyDown()}),this.focusableElement=(n=this.hot.rootDocument,r=new ur(n),cr+=1,r),this.focusableElement.addLocalHook("copy",function(e){return t.onCopy(e)}).addLocalHook("cut",function(e){return t.onCut(e)}).addLocalHook("paste",function(e){return t.onPaste(e)}),wr(Cr(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),wr(Cr(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&pr(this.focusableElement),wr(Cr(e.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){kr.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){kr.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(t){var e=this,n=[],r=[],o=[];return Object(w.arrayEach)(t,function(t){Object(_.rangeEach)(t.startRow,t.endRow,function(t){-1===r.indexOf(t)&&r.push(t)}),Object(_.rangeEach)(t.startCol,t.endCol,function(t){-1===o.indexOf(t)&&o.push(t)})}),Object(w.arrayEach)(r,function(t){var r=[];Object(w.arrayEach)(o,function(n){r.push(e.hot.getCopyableData(t,n))}),n.push(r)}),or.a.stringify(n)}},{key:"getRangedData",value:function(t){var e=this,n=[],r=[],o=[];return Object(w.arrayEach)(t,function(t){Object(_.rangeEach)(t.startRow,t.endRow,function(t){-1===r.indexOf(t)&&r.push(t)}),Object(_.rangeEach)(t.startCol,t.endCol,function(t){-1===o.indexOf(t)&&o.push(t)})}),Object(w.arrayEach)(r,function(t){var r=[];Object(w.arrayEach)(o,function(n){r.push(e.hot.getCopyableData(t,n))}),n.push(r)}),n}},{key:"paste",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(t||e){var n=new sr;t&&n.clipboardData.setData("text/plain",t),e&&n.clipboardData.setData("text/html",e),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var t=this.hot.getSelectedRangeLast();if(t){var e=t.getTopLeftCorner(),n=t.getBottomRightCorner(),r=e.row,o=e.col,i=n.row,a=n.col,s=Math.min(i,r+this.rowsLimit-1),l=Math.min(a,o+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:r,startCol:o,endRow:s,endCol:l}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),i===s&&a===l||this.hot.runHooks("afterCopyLimit",i-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var t=this.hot.getActiveEditor(),e=t?t.TEXTAREA:void 0;e?this.focusableElement.setFocusableElement(e):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var t=this.hot.getActiveEditor();return t&&t.isOpened()}},{key:"populateValues",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedLast();if(t.length){for(var n=t.length-1,r=t[0].length-1,o=Math.min(e[0],e[2]),i=Math.max(e[0],e[2],n+o),a=Math.min(e[1],e[3]),s=Math.max(e[1],e[3],r+a),l=[],u=o,c=0;u<=i;u+=1){for(var f=[],h=a,d=0;h<=s;h+=1)f.push(t[c][d]),d=d===r?0:d+=1;l.push(f),c=c===n?0:c+=1}return this.hot.populateFromArray(o,a,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,i,s]}}},{key:"onCopy",value:function(t){var e=kr.get(this);if((this.hot.isListening()||e.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),e.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges)){var r=or.a.stringify(n);if(t&&t.clipboardData){var o=gr(n,this.hot.rootDocument);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",o)}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",n,this.copyableRanges)}t.preventDefault()}}},{key:"onCut",value:function(t){var e=kr.get(this);if((this.hot.isListening()||e.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),e.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){var r=or.a.stringify(n);if(t&&t.clipboardData){var o=gr(n,this.hot.rootDocument);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",o)}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells(),this.hot.runHooks("afterCut",n,this.copyableRanges)}t.preventDefault()}}},{key:"onPaste",value:function(t){if(this.hot.isListening()&&!this.isEditorOpened()){var e;if(t&&t.preventDefault&&t.preventDefault(),t&&void 0!==t.clipboardData){var n=t.clipboardData.getData("text/html");e=n&&/(<table)|(<TABLE)/.test(n)?function(t,e){var n=[],r=t;if("string"==typeof r){var o=e.createElement("div");o.innerHTML=r.replace(/\n/g,""),r=o.querySelector("table")}if(r&&function(t){return"table"===(t&&t.nodeName||"").toLowerCase()}(r)){for(var i=r.rows,a=i&&i.length,s=[],l=0;l<a;l+=1){for(var u=i[l].cells,c=u.length,f=[],h=0;h<c;h+=1){var d=u[h];d.innerHTML=d.innerHTML.trim().replace(/<br(.|)>(\n?)/,"\n");var p=d.innerText;f.push(p)}s.push(f)}n.push.apply(n,s)}return n}(n,this.hot.rootDocument):t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));var r="string"!=typeof e?e:or.a.parse(e);if(0!==r.length&&!1!==this.hot.runHooks("beforePaste",r,this.copyableRanges)){var o=vr(this.populateValues(r),4),i=o[0],a=o[1],s=o[2],l=o[3];this.hot.selectCell(i,a,Math.min(this.hot.countRows()-1,s),Math.min(this.hot.countCols()-1,l)),this.hot.runHooks("afterPaste",r,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;t.items.push({name:"---------"},(e=this,{key:"copy",name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_COPY)},callback:function(){e.copy()},disabled:function(){var t=this.getSelected();return!t||t.length>1},hidden:!1}),function(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_CUT)},callback:function(){t.cut()},disabled:function(){var t=this.getSelected();return!t||t.length>1},hidden:!1}}(this))}},{key:"onAfterOnCellMouseUp",value:function(){this.hot.isListening()&&!this.isEditorOpened()&&(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var t=kr.get(this).isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),t&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Object(b.getSelectionText)()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var t=this.hot.rootDocument.activeElement,e=this.hot.getActiveEditor();!e||t!==this.focusableElement.getFocusableElement()&&t!==e.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(pr(this.focusableElement),this.focusableElement=null),wr(Cr(e.prototype),"destroy",this).call(this)}}])&&mr(n.prototype,r),o&&mr(n,o),e}();Object(P.d)("CopyPaste",Rr);var Tr=Rr;n(220);function Mr(t,e){return"border_row".concat(t,"col").concat(e)}function _r(t,e){return{id:Mr(t,e),border:{width:1,color:"#000",cornerVisible:!1},row:t,col:e,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}}function Nr(t,e){var n=!1;return Object(w.arrayEach)(t.getSelectedRange(),function(r){r.forAll(function(r,o){var i=t.getCellMeta(r,o).borders;if(i){if(!e)return n=!0,!1;if(!Object(N.hasOwnProperty)(i[e],"hide")||!1===i[e].hide)return n=!0,!1}})}),n}function Ar(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function xr(t){return{key:"borders:bottom",name:function(){var t=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return Nr(this,"bottom")&&(t=Ar(t)),t},callback:function(e,n){var r=Nr(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function jr(t){return{key:"borders:left",name:function(){var t=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_BORDERS_LEFT);return Nr(this,"left")&&(t=Ar(t)),t},callback:function(e,n){var r=Nr(this,"left");t.prepareBorder(n,"left",r)}}}function Ir(t){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(e,n){t.prepareBorder(n,"noBorders")},disabled:function(){return!Nr(this)}}}function Dr(t){return{key:"borders:right",name:function(){var t=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return Nr(this,"right")&&(t=Ar(t)),t},callback:function(e,n){var r=Nr(this,"right");t.prepareBorder(n,"right",r)}}}var Pr=n(89);function Lr(t){return(Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Br(t,e){return!e||"object"!==Lr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wr(t,e,n){return(Wr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Vr(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Vr(t){return(Vr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ur(t,e){return(Ur=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Br(this,Vr(e).call(this,t))).savedBorders=[],n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ur(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().customBorders}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(e){return t.onAfterContextMenuDefaultOptions(e)}),this.addHook("afterInit",function(){return t.onAfterInit()}),Wr(Vr(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Wr(Vr(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Wr(Vr(e.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(t,e){var n=this,r=e?Object.keys(e):["top","right","bottom","left"],o=Object(Pr.b)(t),i=Object(Pr.c)(o);Object(w.arrayEach)(t,function(t){for(var o=Hr(i(t),4),a=o[0],s=o[1],l=o[2],u=o[3],c=function(t){for(var o=function(o){Object(w.arrayEach)(r,function(r){n.prepareBorderFromCustomAdded(t,o,e,r)})},i=s;i<=u;i+=1)o(i)},f=a;f<=l;f+=1)c(f)})}},{key:"getBorders",value:function(t){var e=this;if(!Array.isArray(t))return this.savedBorders;var n=Object(Pr.b)(t),r=Object(Pr.c)(n),o=[];return Object(w.arrayEach)(t,function(t){for(var n=Hr(r(t),4),i=n[0],a=n[1],s=n[2],l=n[3],u=function(t){for(var n=function(n){Object(w.arrayEach)(e.savedBorders,function(e){e.row===t&&e.col===n&&o.push(e)})},r=a;r<=l;r+=1)n(r)},c=i;c<=s;c+=1)u(c)}),o}},{key:"clearBorders",value:function(t){var e=this;t?this.setBorders(t):(Object(w.arrayEach)(this.savedBorders,function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange(),e.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(t,e){this.checkSavedBorders(t)||this.savedBorders.push(t);var n={row:t.row,col:t.col},r=new tt.b(n,n,n);this.checkCustomSelections(t,r,e)||(this.hot.selection.highlight.addCustomSelection({border:t,cellRange:r}),this.hot.view.wt.draw(!0))}},{key:"prepareBorderFromCustomAdded",value:function(t,e,n,r){var o,i,a=_r(t,e);n&&(o=a,i=n,Object(N.hasOwnProperty)(i,"border")&&(o.border=i.border),Object(N.hasOwnProperty)(i,"top")&&(i.top?(Object(N.isObject)(i.top)||(i.top={width:1,color:"#000"}),o.top=i.top):(i.top={hide:!0},o.top=i.top)),Object(N.hasOwnProperty)(i,"right")&&(i.right?(Object(N.isObject)(i.right)||(i.right={width:1,color:"#000"}),o.right=i.right):(i.right={hide:!0},o.right=i.right)),Object(N.hasOwnProperty)(i,"bottom")&&(i.bottom?(Object(N.isObject)(i.bottom)||(i.bottom={width:1,color:"#000"}),o.bottom=i.bottom):(i.bottom={hide:!0},o.bottom=i.bottom)),Object(N.hasOwnProperty)(i,"left")&&(i.left?(Object(N.isObject)(i.left)||(i.left={width:1,color:"#000"}),o.left=i.left):(i.left={hide:!0},o.left=i.left)),a=o,Object(w.arrayEach)(this.hot.selection.highlight.customSelections,function(t){if(a.id===t.settings.id)return Object.assign(t.settings,n),a=t.settings,!1})),this.hot.setCellMeta(t,e,"borders",a),this.insertBorderIntoSettings(a,r)}},{key:"prepareBorderFromCustomAddedRange",value:function(t){var e=this,n=t.range;Object(_.rangeEach)(n.from.row,n.to.row,function(r){Object(_.rangeEach)(n.from.col,n.to.col,function(o){var i=_r(r,o),a=0;r===n.from.row&&(a+=1,Object(N.hasOwnProperty)(t,"top")&&(i.top=t.top)),r===n.to.row&&(a+=1,Object(N.hasOwnProperty)(t,"bottom")&&(i.bottom=t.bottom)),o===n.from.col&&(a+=1,Object(N.hasOwnProperty)(t,"left")&&(i.left=t.left)),o===n.to.col&&(a+=1,Object(N.hasOwnProperty)(t,"right")&&(i.right=t.right)),a>0&&(e.hot.setCellMeta(r,o,"borders",i),e.insertBorderIntoSettings(i))})})}},{key:"removeAllBorders",value:function(t,e){var n=Mr(t,e);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}},{key:"setBorder",value:function(t,e,n,r){var o=this.hot.getCellMeta(t,e).borders;(o&&void 0!==o.border||(o=_r(t,e)),r)?(o[n]={hide:!0},4===this.countHide(o)?this.removeAllBorders(t,e):(this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",o))):(o[n]={width:1,color:"#000"},this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",o))}},{key:"prepareBorder",value:function(t,e,n){var r=this;Object(w.arrayEach)(t,function(t){var o=t.start,i=t.end;if(o.row===i.row&&o.col===i.col)"noBorders"===e?r.removeAllBorders(o.row,o.col):r.setBorder(o.row,o.col,e,n);else switch(e){case"noBorders":Object(_.rangeEach)(o.col,i.col,function(t){Object(_.rangeEach)(o.row,i.row,function(e){r.removeAllBorders(e,t)})});break;case"top":Object(_.rangeEach)(o.col,i.col,function(t){r.setBorder(o.row,t,e,n)});break;case"right":Object(_.rangeEach)(o.row,i.row,function(t){r.setBorder(t,i.col,e,n)});break;case"bottom":Object(_.rangeEach)(o.col,i.col,function(t){r.setBorder(i.row,t,e,n)});break;case"left":Object(_.rangeEach)(o.row,i.row,function(t){r.setBorder(t,o.col,e,n)})}})}},{key:"createCustomBorders",value:function(t){var e=this;Object(w.arrayEach)(t,function(t){t.range?e.prepareBorderFromCustomAddedRange(t):e.prepareBorderFromCustomAdded(t.row,t.col,t)})}},{key:"countHide",value:function(t){var e=Object.values(t);return Object(w.arrayReduce)(e,function(t,e){var n=t;return e.hide&&(n+=1),n},0)}},{key:"clearBordersFromSelectionSettings",value:function(t){var e=Object(w.arrayMap)(this.hot.selection.highlight.customSelections,function(t){return t.settings.id}).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear(),this.hot.view.wt.draw(!0)}},{key:"clearNullCellRange",value:function(){var t=this;Object(w.arrayEach)(this.hot.selection.highlight.customSelections,function(e,n){if(null===e.cellRange)return t.hot.selection.highlight.customSelections.splice(n,1),!1})}},{key:"hideBorders",value:function(){var t=this;Object(w.arrayEach)(this.savedBorders,function(e){t.clearBordersFromSelectionSettings(e.id)})}},{key:"spliceBorder",value:function(t){var e=Object(w.arrayMap)(this.savedBorders,function(t){return t.id}).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}},{key:"checkSavedBorders",value:function(t){var e=this,n=!1;return 4===this.countHide(t)?(this.spliceBorder(t.id),n=!0):Object(w.arrayEach)(this.savedBorders,function(r,o){if(t.id===r.id)return e.savedBorders[o]=t,n=!0,!1}),n}},{key:"checkCustomSelectionsFromContextMenu",value:function(t,e,n){var r=!1;return Object(w.arrayEach)(this.hot.selection.highlight.customSelections,function(o){if(t.id===o.settings.id)return Object(N.objectEach)(o.instanceBorders,function(t){t.toggleHiddenClass(e,n)}),r=!0,!1}),r}},{key:"checkCustomSelections",value:function(t,e,n){var r=this.countHide(t),o=!1;return 4===r?(this.removeAllBorders(t.row,t.col),this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),o=!0):Object(w.arrayEach)(this.hot.selection.highlight.customSelections,function(r){if(t.id===r.settings.id)return r.cellRange=e,n&&Object(N.objectEach)(r.instanceBorders,function(e){e.changeBorderStyle(n,t)}),o=!0,!1}),o}},{key:"changeBorderSettings",value:function(){var t=this.hot.getSettings().customBorders;Array.isArray(t)?(t.length||(this.savedBorders=t),this.createCustomBorders(t)):void 0!==t&&this.createCustomBorders(this.savedBorders)}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;this.hot.getSettings().customBorders&&t.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[(e=this,{key:"borders:top",name:function(){var t=this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_BORDERS_TOP);return Nr(this,"top")&&(t=Ar(t)),t},callback:function(t,n){var r=Nr(this,"top");e.prepareBorder(n,"top",r)}}),Dr(this),xr(this),jr(this),Ir(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Wr(Vr(e.prototype),"destroy",this).call(this)}}])&&Fr(n.prototype,r),o&&Fr(n,o),e}();Object(P.d)("customBorders",Yr);var zr=Yr;function Gr(t){return(Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kr(t,e,n){return(Kr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$r(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function $r(t){return($r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zr(t,e){return(Zr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qr=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=$r(e).call(this,t))||"object"!==Gr(o)&&"function"!=typeof o?qr(r):o).eventManager=new y.a(qr(n)),n.boundaries=null,n.callback=null,n.listening=!1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zr(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(){return t.setupListening()}),this.addHook("afterOnCellCornerMouseDown",function(){return t.setupListening()}),this.registerEvents(),Kr($r(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Kr($r(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),Kr($r(e.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(t){this.boundaries=t}},{key:"setCallback",value:function(t){this.callback=t}},{key:"check",value:function(t,e){var n=0,r=0;e<this.boundaries.top?r=e-this.boundaries.top:e>this.boundaries.bottom&&(r=e-this.boundaries.bottom),t<this.boundaries.left?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,r)}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",function(){return t.onMouseUp()}),this.eventManager.addEventListener(e,"mousemove",function(e){return t.onMouseMove(e)})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(){var t=this.hot.view.wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback(function(e,n){e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),n<0?t.scrollTop-=20:n>0&&(t.scrollTop+=20)}),this.listening=!0)}},{key:"onMouseMove",value:function(t){this.listening&&this.check(t.clientX,t.clientY)}},{key:"onMouseUp",value:function(){this.listening=!1}},{key:"destroy",value:function(){Kr($r(e.prototype),"destroy",this).call(this)}}])&&Xr(n.prototype,r),o&&Xr(n,o),e}();Object(P.d)("dragToScroll",Qr);var Jr=Qr;function to(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function eo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function no(t){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ro(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function io(t,e,n){return(io="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ao(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ao(t){return(ao=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function so(t,e){return(so=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lo=new WeakMap,uo=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(o=ao(e).call(this,t))||"object"!==no(o)&&"function"!=typeof o?oo(r):o,lo.set(oo(n),{moveByFreeze:!1,afterFirstUse:!1}),n.frozenColumnsBasePositions=[],n.manualColumnMovePlugin=void 0,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&so(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(e){return t.addContextMenuEntry(e)}),this.addHook("afterInit",function(){return t.onAfterInit()}),this.addHook("beforeColumnMove",function(e,n){return t.onBeforeColumnMove(e,n)}),io(ao(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=lo.get(this);t.afterFirstUse=!1,t.moveByFreeze=!1,io(ao(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),io(ao(e.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(t){var e=lo.get(this),n=this.hot.getSettings();e.afterFirstUse||(e.afterFirstUse=!0),n.fixedColumnsLeft===this.hot.countCols()||t<=n.fixedColumnsLeft-1||(e.moveByFreeze=!0,t!==this.getMovePlugin().columnsMapper.getValueByIndex(t)&&(this.frozenColumnsBasePositions[n.fixedColumnsLeft]=t),this.getMovePlugin().moveColumn(t,n.fixedColumnsLeft),n.fixedColumnsLeft+=1)}},{key:"unfreezeColumn",value:function(t){var e=lo.get(this),n=this.hot.getSettings();if(e.afterFirstUse||(e.afterFirstUse=!0),!(n.fixedColumnsLeft<=0||t>n.fixedColumnsLeft-1)){var r=this.getBestColumnReturnPosition(t);e.moveByFreeze=!0,n.fixedColumnsLeft-=1,this.getMovePlugin().moveColumn(t,r+1)}}},{key:"getMovePlugin",value:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin}},{key:"getBestColumnReturnPosition",value:function(t){var e,n=this.getMovePlugin(),r=this.hot.getSettings().fixedColumnsLeft,o=n.columnsMapper.getValueByIndex(r);if(null===this.frozenColumnsBasePositions[t]||void 0===this.frozenColumnsBasePositions[t])for(e=n.columnsMapper.getValueByIndex(t);null!==o&&o<=e;)r+=1,o=n.columnsMapper.getValueByIndex(r);else{for(e=this.frozenColumnsBasePositions[t],this.frozenColumnsBasePositions[t]=void 0;null!==o&&o<=e;)r+=1,o=n.columnsMapper.getValueByIndex(r);r=o}return r-1}},{key:"addContextMenuEntry",value:function(t){var e;t.items.push({name:"---------"},(e=this,{key:"freeze_column",name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function(t,n){var r=to(n,1)[0].start.col;e.freezeColumn(r),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(e=!0),e}}),function(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function(e,n){var r=eo(n,1)[0].start.col;t.unfreezeColumn(r),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsLeft)&&(e=!0),e}}}(this))}},{key:"onAfterInit",value:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()}},{key:"onBeforeColumnMove",value:function(t,e){var n=lo.get(this);if(n.afterFirstUse&&!n.moveByFreeze){var r=this.hot.getSettings().fixedColumnsLeft,o=e<r;if(o||Object(w.arrayEach)(t,function(t){if(t<r)return o=!0,!1}),o)return!1}n.moveByFreeze&&(n.moveByFreeze=!1)}},{key:"destroy",value:function(){io(ao(e.prototype),"destroy",this).call(this)}}])&&ro(n.prototype,r),o&&ro(n,o),e}();Object(P.d)("manualColumnFreeze",uo);var co=uo;function fo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ho=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.manualColumnMove=e}var e,n,r;return e=t,(n=[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(_.rangeEach)(n-1,function(t){e._arrayMap[t]=t})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveColumn",value:function(t,e){var n=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(e,0,n)}},{key:"clearNull",value:function(){this._arrayMap=Object(w.arrayFilter)(this._arrayMap,function(t){return null!==t})}}])&&fo(e.prototype,n),r&&fo(e,r),t}();Object(N.mixin)(ho,Jt);var po=ho;function go(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var vo=0,yo=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this._element=null,this.state=vo}var e,n,r;return e=t,(n=[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=this.hot.rootDocument.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=vo}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(t,e){Object(_.isNumeric)(t)&&(this._element.style.top=t+"px"),Object(_.isNumeric)(e)&&(this._element.style.left=e+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){Object(_.isNumeric)(t)&&(this._element.style.width=t+"px"),Object(_.isNumeric)(e)&&(this._element.style.height=e+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){Object(_.isNumeric)(t)&&(this._element.style.marginTop=t+"px"),Object(_.isNumeric)(e)&&(this._element.style.marginLeft=e+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}])&&go(e.prototype,n),r&&go(e,r),t}();function mo(t){return(mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wo(t,e){return!e||"object"!==mo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Co(t,e,n){return(Co="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Oo(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Oo(t){return(Oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Eo(t,e){return(Eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var So=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),wo(this,Oo(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Eo(t,e)}(e,yo),n=e,(r=[{key:"build",value:function(){Co(Oo(e.prototype),"build",this).call(this),Object(b.addClass)(this._element,"ht__manualColumnMove--backlight")}}])&&bo(n.prototype,r),o&&bo(n,o),e}();function ko(t){return(ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ro(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function To(t,e){return!e||"object"!==ko(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mo(t,e,n){return(Mo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_o(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _o(t){return(_o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function No(t,e){return(No=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ao=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),To(this,_o(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&No(t,e)}(e,yo),n=e,(r=[{key:"build",value:function(){Mo(_o(e.prototype),"build",this).call(this),Object(b.addClass)(this._element,"ht__manualColumnMove--guideline")}}])&&Ro(n.prototype,r),o&&Ro(n,o),e}();function xo(t){return(xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jo(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Io(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Do(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Po(t,e,n){return(Po="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Lo(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Lo(t){return(Lo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ho(t,e){return(Ho=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}m.a.getSingleton().register("beforeColumnMove"),m.a.getSingleton().register("afterColumnMove"),m.a.getSingleton().register("unmodifyCol");var Fo=new WeakMap,Bo=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(o=Lo(e).call(this,t))||"object"!==xo(o)&&"function"!=typeof o?Do(r):o,Fo.set(Do(n),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}}),n.removedColumns=[],n.columnsMapper=new po(Do(n)),n.eventManager=new y.a(Do(n)),n.backlight=new So(t),n.guideline=new Ao(t),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ho(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(e,n,r,o){return t.onBeforeOnCellMouseDown(e,n,r,o)}),this.addHook("beforeOnCellMouseOver",function(e,n,r,o){return t.onBeforeOnCellMouseOver(e,n,r,o)}),this.addHook("afterScrollVertically",function(){return t.onAfterScrollVertically()}),this.addHook("modifyCol",function(e,n){return t.onModifyCol(e,n)}),this.addHook("beforeRemoveCol",function(e,n){return t.onBeforeRemoveCol(e,n)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol()}),this.addHook("afterCreateCol",function(e,n){return t.onAfterCreateCol(e,n)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("unmodifyCol",function(e){return t.onUnmodifyCol(e)}),this.registerEvents(),Object(b.addClass)(this.hot.rootElement,"ht__manualColumnMove"),Po(Lo(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),Po(Lo(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this.hot.getSettings().manualColumnMove;Array.isArray(t)&&this.columnsMapper.clearMap(),Object(b.removeClass)(this.hot.rootElement,"ht__manualColumnMove"),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Po(Lo(e.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(t,e){this.moveColumns([t],e)}},{key:"moveColumns",value:function(t,e){var n=this,r=jo(t),o=Fo.get(this),i=this.hot.runHooks("beforeColumnMove",r,e);o.disallowMoving=!i,!1!==i&&(Object(w.arrayEach)(t,function(t,e,r){r[e]=n.columnsMapper.getValueByIndex(t)}),Object(w.arrayEach)(t,function(t,r){var o=n.columnsMapper.getIndexByValue(t);o!==e&&n.columnsMapper.moveColumn(o,e+r)}),this.columnsMapper.clearNull()),this.hot.runHooks("afterColumnMove",r,e)}},{key:"changeSelection",value:function(t,e){this.hot.selectColumns(t,e)}},{key:"getColumnsWidth",value:function(t,e){for(var n=0,r=t;r<e;r++){n+=r<0?this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:this.hot.view.wt.wtTable.getStretchedColumnWidth(r)||0}return n}},{key:"initialSettings",value:function(){var t=this.hot.getSettings().manualColumnMove;Array.isArray(t)?this.moveColumns(t,0):void 0!==t&&this.persistentStateLoad()}},{key:"isFixedColumnsLeft",value:function(t){return t<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var t={};this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value&&(this.columnsMapper._arrayMap=t.value)}},{key:"prepareColumnsToMoving",value:function(t,e){var n=[];return Object(_.rangeEach)(t,e,function(t){n.push(t)}),n}},{key:"refreshPositions",value:function(){var t=Fo.get(this),e=this.hot.view.wt.wtTable.getFirstVisibleColumn(),n=this.hot.view.wt.wtTable.getLastVisibleColumn(),r=this.hot.view.wt.wtTable,o=this.hot.view.wt.wtOverlays.scrollableElement,i="number"==typeof o.scrollX?o.scrollX:o.scrollLeft,a=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,t.coordsColumn),s=t.target.eventPageX-(t.rootElementOffset-(void 0===o.scrollX?i:0)),l=r.hider.offsetWidth,u=r.TBODY.offsetLeft,c=this.backlight.getOffset().left,f=this.backlight.getSize().width,h=0;if(t.rootElementOffset+r.holder.offsetWidth+i<t.target.eventPageX&&t.coordsColumn<t.countCols&&(t.coordsColumn+=1),t.hasRowHeaders&&(h=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(t.coordsColumn)&&(a+=i),a+=h,t.coordsColumn<0)t.fixedColumns>0?t.target.col=0:t.target.col=e>0?e-1:e;else if(t.target.TD.offsetWidth/2+a<=s){var d=t.coordsColumn>=t.countCols?t.countCols-1:t.coordsColumn;t.target.col=d+1,a+=t.target.TD.offsetWidth,t.target.col>n&&n<t.countCols&&this.hot.scrollViewportTo(void 0,n+1,void 0,!0)}else t.target.col=t.coordsColumn,t.target.col<=e&&t.target.col>=t.fixedColumns&&e>0&&this.hot.scrollViewportTo(void 0,e-1);t.target.col<=e&&t.target.col>=t.fixedColumns&&e>0&&this.hot.scrollViewportTo(void 0,e-1);var p=s,g=a;s+f+c>=l?p=l-f-c:s+c<u+h&&(p=u+h+Math.abs(c)),a>=l-1?g=l-1:0===g?g=1:void 0!==o.scrollX&&t.coordsColumn<t.fixedColumns&&(g-=t.rootElementOffset<=o.scrollX?t.rootElementOffset:0),this.backlight.setPosition(null,p),this.guideline.setPosition(null,g)}},{key:"updateColumnsMapper",value:function(){var t=this.hot.countSourceCols(),e=this.columnsMapper._arrayMap.length;if(0===e)this.columnsMapper.createMap(t||this.hot.getSettings().startCols);else if(e<t){var n=t-e;this.columnsMapper.insertItems(e,n)}else if(e>t){var r=t-1,o=[];Object(w.arrayEach)(this.columnsMapper._arrayMap,function(t,e){t>r&&o.push(e)}),this.columnsMapper.removeItems(o)}}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(e,"mouseup",function(){return t.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var o=this.hot.view.wt.wtTable,i=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),s=Fo.get(this),l=t.realTarget.className.indexOf("sortAction")>-1;if(!a||!i||s.pressed||0!==t.button||l)return s.pressed=!1,s.columnsToMove.length=0,void Object(b.removeClass)(this.hot.rootElement,["on-moving--columns","show-ui"]);var u=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&c&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var f=a.from,h=a.to,d=Math.min(f.col,h.col),p=Math.max(f.col,h.col);if(e.row<0&&e.col>=d&&e.col<=p){r.column=!0,s.pressed=!0,s.target.eventPageX=t.pageX,s.coordsColumn=e.col,s.target.TD=n,s.target.col=e.col,s.columnsToMove=this.prepareColumnsToMoving(d,p),s.hasRowHeaders=!!this.hot.getSettings().rowHeaders,s.countCols=this.hot.countCols(),s.fixedColumns=this.hot.getSettings().fixedColumnsLeft,s.rootElementOffset=Object(b.offset)(this.hot.rootElement).left;var g=s.hasRowHeaders?-1:0,v=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,y=e.col<s.fixedColumns,m=this.hot.view.wt.wtOverlays.scrollableElement,w=m.scrollX?m.scrollX-s.rootElementOffset:0,C=t.layerX-(y?w:0),O=Math.abs(this.getColumnsWidth(d,e.col)+C);this.backlight.setPosition(v,this.getColumnsWidth(g,d)+O),this.backlight.setSize(this.getColumnsWidth(d,p+1),o.hider.offsetHeight-v),this.backlight.setOffset(null,-1*O),Object(b.addClass)(this.hot.rootElement,"on-moving--columns")}else Object(b.removeClass)(this.hot.rootElement,"after-selection--columns"),s.pressed=!1,s.columnsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=Fo.get(this);if(e.pressed){if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(n)})}e.target.eventPageX=t.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var o=this.hot.getSelectedRangeLast(),i=Fo.get(this);o&&i.pressed&&(i.columnsToMove.indexOf(e.col)>-1?Object(b.removeClass)(this.hot.rootElement,"show-ui"):Object(b.addClass)(this.hot.rootElement,"show-ui"),r.row=!0,r.column=!0,r.cell=!0,i.coordsColumn=e.col,i.target.TD=n)}},{key:"onMouseUp",value:function(){var t=Fo.get(this);if(t.coordsColumn=void 0,t.pressed=!1,t.backlightWidth=0,Object(b.removeClass)(this.hot.rootElement,["on-moving--columns","show-ui","after-selection--columns"]),this.hot.selection.isSelectedByColumnHeader()&&Object(b.addClass)(this.hot.rootElement,"after-selection--columns"),!(t.columnsToMove.length<1||void 0===t.target.col||t.columnsToMove.indexOf(t.target.col)>-1)){if(this.moveColumns(t.columnsToMove,t.target.col),this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),!t.disallowMoving){var e=this.columnsMapper.getIndexByValue(t.columnsToMove[0]),n=this.columnsMapper.getIndexByValue(t.columnsToMove[t.columnsToMove.length-1]);this.changeSelection(e,n)}t.columnsToMove.length=0}}},{key:"onAfterScrollVertically",value:function(){var t=this.hot.view.wt.wtTable,e=t.getColumnHeaderHeight(0)+1+t.holder.scrollTop;this.backlight.setPosition(e),this.backlight.setSize(null,t.hider.offsetHeight-e)}},{key:"onAfterCreateCol",value:function(t,e){this.columnsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveCol",value:function(t,e){var n=this;this.removedColumns.length=0,!1!==t&&Object(_.rangeEach)(t,t+e-1,function(t){n.removedColumns.push(n.hot.runHooks("modifyCol",t,n.pluginName))})}},{key:"onAfterRemoveCol",value:function(){this.columnsMapper.unshiftItems(this.removedColumns)}},{key:"onAfterLoadData",value:function(){this.updateColumnsMapper()}},{key:"onModifyCol",value:function(t,e){var n=t;if(e!==this.pluginName){var r=this.columnsMapper.getValueByIndex(n);n=null===r?n:r}return n}},{key:"onUnmodifyCol",value:function(t){var e=this.columnsMapper.getIndexByValue(t);return null===e?t:e}},{key:"onAfterPluginsInitialized",value:function(){this.updateColumnsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Po(Lo(e.prototype),"destroy",this).call(this)}}])&&Io(n.prototype,r),o&&Io(n,o),e}();Object(P.d)("ManualColumnMove",Bo);var Wo=Bo;function Vo(t){return(Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zo(t,e,n){return(zo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Go(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Go(t){return(Go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xo(t,e){return(Xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qo=function(t){function e(t){var n,r,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this;var i=(n=!(o=Go(e).call(this,t))||"object"!==Vo(o)&&"function"!=typeof o?Yo(r):o).hot.rootDocument;return n.currentTH=null,n.currentCol=null,n.selectedCols=[],n.currentWidth=null,n.newSize=null,n.startY=null,n.startWidth=null,n.startOffset=null,n.handle=i.createElement("DIV"),n.guide=i.createElement("DIV"),n.eventManager=new y.a(Yo(n)),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualColumnWidths=[],Object(b.addClass)(n.handle,"manualColumnResizer"),Object(b.addClass)(n.guide,"manualColumnResizerGuide"),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xo(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.manualColumnWidths=[];var n=this.hot.getSettings().manualColumnResize,r=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(e,n){return t.onModifyColWidth(e,n)}),this.addHook("beforeStretchingColumnWidth",function(e,n){return t.onBeforeStretchingColumnWidth(e,n)}),this.addHook("beforeColumnResize",function(e,n,r){return t.onBeforeColumnResize(e,n,r)}),void 0!==r?this.manualColumnWidths=r:Array.isArray(n)?this.manualColumnWidths=n:this.manualColumnWidths=[],this.bindEvents(),zo(Go(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().manualColumnResize;Array.isArray(t)?this.manualColumnWidths=t:t||(this.manualColumnWidths=[])}},{key:"disablePlugin",value:function(){zo(Go(e.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)}},{key:"loadManualColumnWidths",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",t),t.value}},{key:"setupHandlePosition",value:function(t){var e=this;if(!t.parentNode)return!1;this.currentTH=t;var n=this.hot.view.wt.wtTable.getCoords(this.currentTH),r=n.col,o=Object(b.outerHeight)(this.currentTH);if(r>=0){var i=this.currentTH.getBoundingClientRect(),a=r<this.hot.getSettings().fixedColumnsLeft?this.hot.view.wt.wtOverlays.topLeftCornerOverlay:this.hot.view.wt.wtOverlays.topOverlay,s=a.getRelativeCellPosition(this.currentTH,n.row,n.col);if(!s){var l=a.clone.wtTable.THEAD.lastChild.children[+!!this.hot.getSettings().rowHeaders+r];s=a.getRelativeCellPosition(l,n.row,n.col)}if(this.currentCol=r,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.isSelectedByColumnHeader()){var u=this.hot.getSelectedRangeLast(),c=u.from,f=u.to,h=c.col,d=f.col;h>=d&&(h=f.col,d=c.col),this.currentCol>=h&&this.currentCol<=d?Object(_.rangeEach)(h,d,function(t){return e.selectedCols.push(t)}):this.selectedCols.push(this.currentCol)}else this.selectedCols.push(this.currentCol);this.startOffset=s.left-6,this.startWidth=parseInt(i.width,10),this.handle.style.top="".concat(s.top,"px"),this.handle.style.left="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(o,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var t=parseInt(Object(b.outerHeight)(this.handle),10),e=parseInt(this.handle.style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Object(b.addClass)(this.handle,"active"),Object(b.addClass)(this.guide,"active"),this.guide.style.top="".concat(e,"px"),this.guide.style.left=this.handle.style.left,this.guide.style.height="".concat(n-t,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){Object(b.removeClass)(this.handle,"active"),Object(b.removeClass)(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(t){if(t!==this.hot.rootElement){var e=t.parentNode;return"THEAD"===e.tagName||this.checkIfColumnHeader(e)}return!1}},{key:"getTHFromTargetElement",value:function(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getTHFromTargetElement(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(this.checkIfColumnHeader(t.target)){var e=this.getTHFromTargetElement(t.target);if(!e)return;var n=e.getAttribute("colspan");!e||null!==n&&1!==n||this.pressed||this.setupHandlePosition(e)}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){var o=t.hot.runHooks("beforeColumnResize",n,t.newSize,!0);void 0!==o&&(t.newSize=o),"all"===t.hot.getSettings().stretchH?t.clearManualSize(n):t.setManualSize(n,t.newSize),r&&e(),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",n,t.newSize,!0)};this.dblclick>=2&&(this.selectedCols.length>1?(Object(w.arrayEach)(this.selectedCols,function(t){n(t)}),e()):Object(w.arrayEach)(this.selectedCols,function(t){n(t,!0)}));this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;Object(b.hasClass)(t.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return e.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=Object(I.pageX)(t),this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentWidth=this.startWidth+(Object(I.pageX)(t)-this.startX),Object(w.arrayEach)(this.selectedCols,function(t){e.newSize=e.setManualSize(t,e.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){t.hot.runHooks("beforeColumnResize",n,t.newSize,!1),r&&e(),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",n,t.newSize)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth)this.selectedCols.length>1?(Object(w.arrayEach)(this.selectedCols,function(t){n(t)}),e()):Object(w.arrayEach)(this.selectedCols,function(t){n(t,!0)});this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var t=this,e=this.hot,n=e.rootWindow,r=e.rootElement;this.eventManager.addEventListener(r,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(r,"mousedown",function(e){return t.onMouseDown(e)}),this.eventManager.addEventListener(n,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(n,"mouseup",function(){return t.onMouseUp()})}},{key:"setManualSize",value:function(t,e){var n=Math.max(e,20),r=this.hot.runHooks("modifyCol",t);return this.manualColumnWidths[r]=n,n}},{key:"clearManualSize",value:function(t){var e=this.hot.runHooks("modifyCol",t);this.manualColumnWidths[e]=void 0}},{key:"onModifyColWidth",value:function(t,e){var n=t;if(this.enabled){var r=this.hot.runHooks("modifyCol",e),o=this.manualColumnWidths[r];this.hot.getSettings().manualColumnResize&&o&&(n=o)}return n}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){var n=this.manualColumnWidths[e];return void 0===n&&(n=t),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}}])&&Uo(n.prototype,r),o&&Uo(n,o),e}();Object(P.d)("manualColumnResize",qo);var Ko=qo;function $o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Zo=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.manualRowMove=e}var e,n,r;return e=t,(n=[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(_.rangeEach)(n-1,function(t){e._arrayMap[t]=t})}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveRow",value:function(t,e){var n=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(e,0,n)}},{key:"clearNull",value:function(){this._arrayMap=Object(w.arrayFilter)(this._arrayMap,function(t){return null!==t})}}])&&$o(e.prototype,n),r&&$o(e,r),t}();Object(N.mixin)(Zo,Jt);var Qo=Zo;function Jo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ti=0,ei=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this._element=null,this.state=ti}var e,n,r;return e=t,(n=[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=this.hot.rootDocument.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=ti}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(t,e){void 0!==t&&(this._element.style.top=t+"px"),void 0!==e&&(this._element.style.left=e+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){t&&(this._element.style.width=t+"px"),e&&(this._element.style.height=e+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){t&&(this._element.style.marginTop=t+"px"),e&&(this._element.style.marginLeft=e+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}])&&Jo(e.prototype,n),r&&Jo(e,r),t}();function ni(t){return(ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ri(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oi(t,e){return!e||"object"!==ni(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ii(t,e,n){return(ii="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ai(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ai(t){return(ai=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function si(t,e){return(si=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var li=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),oi(this,ai(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&si(t,e)}(e,ei),n=e,(r=[{key:"build",value:function(){ii(ai(e.prototype),"build",this).call(this),Object(b.addClass)(this._element,"ht__manualRowMove--backlight")}}])&&ri(n.prototype,r),o&&ri(n,o),e}();function ui(t){return(ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ci(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fi(t,e){return!e||"object"!==ui(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hi(t,e,n){return(hi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=di(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function di(t){return(di=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pi(t,e){return(pi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),fi(this,di(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pi(t,e)}(e,ei),n=e,(r=[{key:"build",value:function(){hi(di(e.prototype),"build",this).call(this),Object(b.addClass)(this._element,"ht__manualRowMove--guideline")}}])&&ci(n.prototype,r),o&&ci(n,o),e}();function vi(t){return(vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function mi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wi(t,e,n){return(wi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ci(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ci(t){return(Ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oi(t,e){return(Oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}m.a.getSingleton().register("beforeRowMove"),m.a.getSingleton().register("afterRowMove"),m.a.getSingleton().register("unmodifyRow");var Ei=new WeakMap,Si=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(o=Ci(e).call(this,t))||"object"!==vi(o)&&"function"!=typeof o?bi(r):o,Ei.set(bi(n),{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}}),n.removedRows=[],n.rowsMapper=new Qo(bi(n)),n.eventManager=new y.a(bi(n)),n.backlight=new li(t),n.guideline=new gi(t),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oi(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(e,n,r,o){return t.onBeforeOnCellMouseDown(e,n,r,o)}),this.addHook("beforeOnCellMouseOver",function(e,n,r,o){return t.onBeforeOnCellMouseOver(e,n,r,o)}),this.addHook("afterScrollHorizontally",function(){return t.onAfterScrollHorizontally()}),this.addHook("modifyRow",function(e,n){return t.onModifyRow(e,n)}),this.addHook("beforeRemoveRow",function(e,n){return t.onBeforeRemoveRow(e,n)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow()}),this.addHook("afterCreateRow",function(e,n){return t.onAfterCreateRow(e,n)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("beforeColumnSort",function(e,n){return t.onBeforeColumnSort(e,n)}),this.addHook("unmodifyRow",function(e){return t.onUnmodifyRow(e)}),this.registerEvents(),Object(b.addClass)(this.hot.rootElement,"ht__manualRowMove"),wi(Ci(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),wi(Ci(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this.hot.getSettings().manualRowMove;Array.isArray(t)&&this.rowsMapper.clearMap(),Object(b.removeClass)(this.hot.rootElement,"ht__manualRowMove"),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),wi(Ci(e.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(t,e){this.moveRows([t],e)}},{key:"moveRows",value:function(t,e){var n=this,r=yi(t),o=Ei.get(this),i=this.hot.runHooks("beforeRowMove",r,e);o.disallowMoving=!1===i,o.disallowMoving||(Object(w.arrayEach)(t,function(t,e,r){r[e]=n.rowsMapper.getValueByIndex(t)}),Object(w.arrayEach)(t,function(t,r){var o=n.rowsMapper.getIndexByValue(t);o!==e&&n.rowsMapper.moveRow(o,e+r)}),this.rowsMapper.clearNull()),this.hot.runHooks("afterRowMove",r,e)}},{key:"changeSelection",value:function(t,e){this.hot.selectRows(t,e)}},{key:"getRowsHeight",value:function(t,e){for(var n=0,r=t;r<e;r++){n+=this.hot.view.wt.wtTable.getRowHeight(r)||23}return n}},{key:"initialSettings",value:function(){var t=this.hot.getSettings().manualRowMove;if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){var e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}},{key:"isFixedRowTop",value:function(t){return t<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(t){return t>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}},{key:"prepareRowsToMoving",value:function(){var t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;var n=t.from,r=t.to,o=Math.min(n.row,r.row),i=Math.max(n.row,r.row);return Object(_.rangeEach)(o,i,function(t){e.push(t)}),e}},{key:"refreshPositions",value:function(){var t=Ei.get(this),e=t.target.coords,n=this.hot.view.wt.wtTable.getFirstVisibleRow(),r=this.hot.view.wt.wtTable.getLastVisibleRow(),o=this.hot.getSettings().fixedRowsTop,i=this.hot.countRows();e.row<o&&n>0&&this.hot.scrollViewportTo(n-1),e.row>=r&&r<i&&this.hot.scrollViewportTo(r+1,void 0,!0);var a=this.hot.view.wt.wtTable,s=t.target.TD,l=Object(b.offset)(this.hot.rootElement),u=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row),c=t.target.eventPageY-l.top+a.holder.scrollTop,f=a.hider.offsetHeight,h=a.TBODY.offsetTop,d=this.backlight.getOffset().top,p=this.backlight.getSize().height;this.isFixedRowTop(e.row)&&(u+=a.holder.scrollTop),e.row<0?t.target.row=n>0?n-1:n:s.offsetHeight/2+u<=c?(t.target.row=e.row+1,u+=0===e.row?s.offsetHeight-1:s.offsetHeight):t.target.row=e.row;var g=c,v=u;c+p+d>=f?g=f-p-d:c+d<h&&(g=h+Math.abs(d)),u>=f-1&&(v=f-1);var y=0;this.hot.view.wt.wtOverlays.topOverlay&&(y=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),e.row>=o&&v-a.holder.scrollTop<y&&this.hot.scrollViewportTo(e.row),this.backlight.setPosition(g),this.guideline.setPosition(v)}},{key:"updateRowsMapper",value:function(){var t=this.hot.countSourceRows(),e=this.rowsMapper._arrayMap.length;if(0===e)this.rowsMapper.createMap(t||this.hot.getSettings().startRows);else if(e<t){var n=t-e;this.rowsMapper.insertItems(e,n)}else if(e>t){var r=t-1,o=[];Object(w.arrayEach)(this.rowsMapper._arrayMap,function(t,e){t>r&&o.push(e)}),this.rowsMapper.removeItems(o)}}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(e,"mouseup",function(){return t.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeColumnSort",value:function(t,e){Ei.get(this).disallowMoving=void 0!==e}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var o=this.hot.view.wt,i=o.wtTable,a=o.wtViewport,s=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),u=Ei.get(this);if(!l||!s||u.pressed||0!==t.button)return u.pressed=!1,u.rowsToMove.length=0,void Object(b.removeClass)(this.hot.rootElement,["on-moving--rows","show-ui"]);var c=this.guideline.isBuilt()&&!this.guideline.isAppended(),f=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&f&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));var h=l.from,d=l.to,p=Math.min(h.row,d.row),g=Math.max(h.row,d.row);if(e.col<0&&e.row>=p&&e.row<=g){r.row=!0,u.pressed=!0,u.target.eventPageY=t.pageY,u.target.coords=e,u.target.TD=n,u.rowsToMove=this.prepareRowsToMoving();var v=i.holder.scrollLeft+a.getRowHeaderWidth();this.backlight.setPosition(null,v),this.backlight.setSize(i.hider.offsetWidth-v,this.getRowsHeight(p,g+1)),this.backlight.setOffset(-1*(this.getRowsHeight(p,e.row)+t.layerY),null),Object(b.addClass)(this.hot.rootElement,"on-moving--rows"),this.refreshPositions()}else Object(b.removeClass)(this.hot.rootElement,"after-selection--rows"),u.pressed=!1,u.rowsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=Ei.get(this);if(e.pressed){if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,n)})}e.target.eventPageY=t.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var o=this.hot.getSelectedRangeLast(),i=Ei.get(this);o&&i.pressed&&(i.rowsToMove.indexOf(e.row)>-1?Object(b.removeClass)(this.hot.rootElement,"show-ui"):Object(b.addClass)(this.hot.rootElement,"show-ui"),r.row=!0,r.column=!0,r.cell=!0,i.target.coords=e,i.target.TD=n)}},{key:"onMouseUp",value:function(){var t=Ei.get(this),e=t.target.row,n=t.rowsToMove.length;if(t.pressed=!1,t.backlightHeight=0,Object(b.removeClass)(this.hot.rootElement,["on-moving--rows","show-ui","after-selection--rows"]),this.hot.selection.isSelectedByRowHeader()&&Object(b.addClass)(this.hot.rootElement,"after-selection--rows"),!(n<1||void 0===e||t.rowsToMove.indexOf(e)>-1||t.rowsToMove[n-1]===e-1)){if(this.moveRows(t.rowsToMove,e),this.persistentStateSave(),this.hot.render(),!t.disallowMoving){var r=this.rowsMapper.getIndexByValue(t.rowsToMove[0]),o=this.rowsMapper.getIndexByValue(t.rowsToMove[n-1]);this.changeSelection(r,o)}t.rowsToMove.length=0}}},{key:"onAfterScrollHorizontally",value:function(){var t=this.hot.view.wt.wtTable,e=this.hot.view.wt.wtViewport.getRowHeaderWidth()+t.holder.scrollLeft;this.backlight.setPosition(null,e),this.backlight.setSize(t.hider.offsetWidth-e)}},{key:"onAfterCreateRow",value:function(t,e){this.rowsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&Object(_.rangeEach)(t,t+e-1,function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t,n.pluginName))})}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(){this.updateRowsMapper()}},{key:"onModifyRow",value:function(t,e){var n=t;if(e!==this.pluginName){var r=this.rowsMapper.getValueByIndex(n);n=null===r?n:r}return n}},{key:"onUnmodifyRow",value:function(t){var e=this.rowsMapper.getIndexByValue(t);return null===e?t:e}},{key:"onAfterPluginsInitialized",value:function(){this.updateRowsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),this.rowsMapper.destroy(),wi(Ci(e.prototype),"destroy",this).call(this)}}])&&mi(n.prototype,r),o&&mi(n,o),e}();Object(P.d)("ManualRowMove",Si);var ki=Si;function Ri(t){return(Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ti(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _i(t,e,n){return(_i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ni(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ni(t){return(Ni=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ai(t,e){return(Ai=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xi=function(t){function e(t){var n,r,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this;var i=(n=!(o=Ni(e).call(this,t))||"object"!==Ri(o)&&"function"!=typeof o?Mi(r):o).hot.rootDocument;return n.currentTH=null,n.currentRow=null,n.selectedRows=[],n.currentHeight=null,n.newSize=null,n.startY=null,n.startHeight=null,n.startOffset=null,n.handle=i.createElement("DIV"),n.guide=i.createElement("DIV"),n.eventManager=new y.a(Mi(n)),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualRowHeights=[],Object(b.addClass)(n.handle,"manualRowResizer"),Object(b.addClass)(n.guide,"manualRowResizerGuide"),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ai(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.manualRowHeights=[];var n=this.hot.getSettings().manualRowResize,r=this.loadManualRowHeights();void 0!==r?this.manualRowHeights=r:Array.isArray(n)?this.manualRowHeights=n:this.manualRowHeights=[],this.addHook("modifyRowHeight",function(e,n){return t.onModifyRowHeight(e,n)}),this.bindEvents(),_i(Ni(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().manualRowResize;Array.isArray(t)?this.manualRowHeights=t:t||(this.manualRowHeights=[])}},{key:"disablePlugin",value:function(){_i(Ni(e.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)}},{key:"loadManualRowHeights",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",t),t.value}},{key:"setupHandlePosition",value:function(t){var e=this;this.currentTH=t;var n=this.hot.getCoords(this.currentTH),r=n.row,o=Object(b.outerWidth)(this.currentTH);if(r>=0){var i=this.currentTH.getBoundingClientRect(),a=r<this.hot.getSettings().fixedRowsTop,s=r>=this.hot.countRows()-this.hot.getSettings().fixedRowsBottom,l=this.hot.view.wt.wtOverlays.leftOverlay;a?l=this.hot.view.wt.wtOverlays.topLeftCornerOverlay:s&&(l=this.hot.view.wt.wtOverlays.bottomLeftCornerOverlay);var u=l.getRelativeCellPosition(this.currentTH,n.row,n.col);if(!u){var c=l.clone.wtTable.TBODY.children[+!!this.hot.getSettings().colHeaders+r].firstChild;u=l.getRelativeCellPosition(c,n.row,n.col)}if(this.currentRow=r,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.isSelectedByRowHeader()){var f=this.hot.getSelectedRangeLast(),h=f.from,d=f.to,p=h.row,g=d.row;p>=g&&(p=d.row,g=h.row),this.currentRow>=p&&this.currentRow<=g?Object(_.rangeEach)(p,g,function(t){return e.selectedRows.push(t)}):this.selectedRows.push(this.currentRow)}else this.selectedRows.push(this.currentRow);this.startOffset=u.top-6,this.startHeight=parseInt(i.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style.left="".concat(u.left,"px"),this.handle.style.width="".concat(o,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var t=parseInt(Object(b.outerWidth)(this.handle),10),e=parseInt(this.handle.style.left,10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Object(b.addClass)(this.handle,"active"),Object(b.addClass)(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left="".concat(e,"px"),this.guide.style.width="".concat(n-t,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Object(b.removeClass)(this.handle,"active"),Object(b.removeClass)(this.guide,"active")}},{key:"checkIfRowHeader",value:function(t){if(t!==this.hot.rootElement){var e=t.parentNode;return"TBODY"===e.tagName||this.checkIfRowHeader(e)}return!1}},{key:"getTHFromTargetElement",value:function(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getTHFromTargetElement(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(this.checkIfRowHeader(t.target)){var e=this.getTHFromTargetElement(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){var o=t.hot.runHooks("beforeRowResize",n,t.newSize,!0);void 0!==o&&(t.newSize=o),t.setManualSize(n,t.newSize),r&&e(),t.hot.runHooks("afterRowResize",n,t.newSize,!0)};this.dblclick>=2&&(this.selectedRows.length>1?(Object(w.arrayEach)(this.selectedRows,function(t){n(t)}),e()):Object(w.arrayEach)(this.selectedRows,function(t){n(t,!0)}));this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;Object(b.hasClass)(t.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return e.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=Object(I.pageY)(t),this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentHeight=this.startHeight+(Object(I.pageY)(t)-this.startY),Object(w.arrayEach)(this.selectedRows,function(t){e.newSize=e.setManualSize(t,e.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){t.hot.runHooks("beforeRowResize",n,t.newSize),r&&e(),t.saveManualRowHeights(),t.hot.runHooks("afterRowResize",n,t.newSize,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight)this.selectedRows.length>1?(Object(w.arrayEach)(this.selectedRows,function(t){n(t)}),e()):Object(w.arrayEach)(this.selectedRows,function(t){n(t,!0)});this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var t=this,e=this.hot,n=e.rootElement,r=e.rootWindow;this.eventManager.addEventListener(n,"mouseover",function(e){return t.onMouseOver(e)}),this.eventManager.addEventListener(n,"mousedown",function(e){return t.onMouseDown(e)}),this.eventManager.addEventListener(r,"mousemove",function(e){return t.onMouseMove(e)}),this.eventManager.addEventListener(r,"mouseup",function(){return t.onMouseUp()})}},{key:"setManualSize",value:function(t,e){var n=this.hot.runHooks("modifyRow",t);return this.manualRowHeights[n]=e,e}},{key:"onModifyRowHeight",value:function(t,e){if(this.enabled){var n=this.hot.getPlugin("autoRowSize"),r=n?n.heights[e]:null,o=this.hot.runHooks("modifyRow",e),i=this.manualRowHeights[o];if(void 0!==i&&(i===r||i>(t||0)))return i}return t}}])&&Ti(n.prototype,r),o&&Ti(n,o),e}();Object(P.d)("manualRowResize",xi);var ji=xi,Ii=(n(72),n(33));function Di(){var t=Fi(["The merged cell declared at [",", ",'] has "rowspan" or "colspan" declared as \n      "0", which is not supported. It cannot be added to the collection.']);return Di=function(){return t},t}function Pi(){var t=Fi(["The merged cell declared at [",", ",'] has both "rowspan" \n     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.']);return Pi=function(){return t},t}function Li(){var t=Fi(["The merged cell declared at [",", ","] is positioned (or positioned partially) \n       outside of the table range. It was not added to the table, please fix your setup."]);return Li=function(){return t},t}function Hi(){var t=Fi(["The merged cell declared with {row: ",", col: ",", rowspan: \n    ",", colspan: ","} contains negative values, which is not supported. It \n    will not be added to the collection."]);return Hi=function(){return t},t}function Fi(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Bi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wi=function(){function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.row=e,this.col=n,this.rowspan=r,this.colspan=o,this.removed=!1}var e,n,r;return e=t,r=[{key:"NEGATIVE_VALUES_WARNING",value:function(t){return Object(Ii.a)(Hi(),t.row,t.col,t.rowspan,t.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(t){return Object(Ii.a)(Li(),t.row,t.col)}},{key:"IS_SINGLE_CELL",value:function(t){return Object(Ii.a)(Pi(),t.row,t.col)}},{key:"ZERO_SPAN_WARNING",value:function(t){return Object(Ii.a)(Di(),t.row,t.col)}},{key:"containsNegativeValues",value:function(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}},{key:"isSingleCell",value:function(t){return 1===t.colspan&&1===t.rowspan}},{key:"containsZeroSpan",value:function(t){return 0===t.colspan||0===t.rowspan}},{key:"isOutOfBounds",value:function(t,e,n){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=n||t.col+t.colspan-1>=n}}],(n=[{key:"normalize",value:function(t){var e=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}},{key:"includesHorizontally",value:function(t){return this.col<=t&&this.col+this.colspan-1>=t}},{key:"includesVertically",value:function(t){return this.row<=t&&this.row+this.rowspan-1>=t}},{key:"shift",value:function(t,e){var n=t[0]||t[1],r=e+Math.abs(t[0]||t[1])-1,o=t[0]?"colspan":"rowspan",i=t[0]?"col":"row",a=Math.min(e,r),s=Math.max(e,r),l=this[i],u=this[i]+this[o]-1;if(l>=e&&(this[i]+=n),n>0)e<=u&&e>l&&(this[o]+=n);else if(n<0){if(a<=l&&s>=u)return this.removed=!0,!1;if(l>=a&&l<=s){var c=s-l+1,f=Math.abs(n)-c;this[i]-=f+n,this[o]-=c}else if(l<=a&&u>=s)this[o]+=n;else if(l<=a&&u>=a&&u<s){var h=u-a+1;this[o]-=h}}return!0}},{key:"isFarther",value:function(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new tt.b(new tt.a(this.row,this.col),new tt.a(this.row,this.col),new tt.a(this.getLastRow(),this.getLastColumn()))}}])&&Bi(e.prototype,n),r&&Bi(e,r),t}(),Vi=n(30);function Ui(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function Yi(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["The merged cell declared at [",", ","], overlaps with the other declared merged \n    cell. The overlapping merged cell was not added to the table, please fix your setup."]);return Yi=function(){return t},t}function zi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Gi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Xi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.mergedCells=[],this.hot=e.hot}var e,n,r;return e=t,r=[{key:"IS_OVERLAPPING_WARNING",value:function(t){return Object(Ii.a)(Yi(),t.row,t.col)}}],(n=[{key:"get",value:function(t,e){var n=this.mergedCells,r=!1;return Object(w.arrayEach)(n,function(n){return!(n.row<=t&&n.row+n.rowspan-1>=t&&n.col<=e&&n.col+n.colspan-1>=e)||(r=n,!1)}),r}},{key:"getByRange",value:function(t){var e=this.mergedCells,n=!1;return Object(w.arrayEach)(e,function(e){return!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(n=e)}),n}},{key:"getWithinRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.mergedCells,r=[],o=t;if(!o.includesRange){var i=new tt.a(o.from.row,o.from.col),a=new tt.a(o.to.row,o.to.col);o=new tt.b(i,i,a)}return Object(w.arrayEach)(n,function(t){var n=new tt.a(t.row,t.col),i=new tt.a(t.row+t.rowspan-1,t.col+t.colspan-1),a=new tt.b(n,n,i);e?o.overlaps(a)&&r.push(t):o.includesRange(a)&&r.push(t)}),!!r.length&&r}},{key:"add",value:function(e){var n=this.mergedCells,r=e.row,o=e.col,i=e.rowspan,a=e.colspan,s=new Wi(r,o,i,a),l=this.get(r,o),u=this.isOverlapping(s);return l||u?(Object(Vi.b)(t.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),n.push(s),s)}},{key:"remove",value:function(t,e){var n=this.mergedCells,r=this.get(t,e),o=r?this.mergedCells.indexOf(r):null;return!(!r||!1===o)&&(n.splice(o,1),r)}},{key:"clear",value:function(){var t=this,e=this.mergedCells,n=[],r=[];Object(w.arrayEach)(e,function(e){var r=t.hot.getCell(e.row,e.col);r&&n.push([r,t.get(e.row,e.col),e.row,e.col])}),this.mergedCells.length=0,Object(w.arrayEach)(n,function(e,o){Object(_.rangeEach)(0,e.rowspan-1,function(n){Object(_.rangeEach)(0,e.colspan-1,function(o){if(0!==o||0!==n){var i=t.hot.getCell(e.row+n,e.col+o);i&&r.push([i,null,null,null])}})}),n[o][1]=null}),Object(w.arrayEach)(n,function(t){Ui.apply(void 0,zi(t))}),Object(w.arrayEach)(r,function(t){Ui.apply(void 0,zi(t))})}},{key:"isOverlapping",value:function(t){var e=new tt.b(null,new tt.a(t.row,t.col),new tt.a(t.row+t.rowspan-1,t.col+t.colspan-1)),n=!1;return Object(w.arrayEach)(this.mergedCells,function(t){return!new tt.b(null,new tt.a(t.row,t.col),new tt.a(t.row+t.rowspan-1,t.col+t.colspan-1)).overlaps(e)||(n=!0,!1)}),n}},{key:"isMergedParent",value:function(t,e){var n=this.mergedCells,r=!1;return Object(w.arrayEach)(n,function(n){return n.row!==t||n.col!==e||(r=!0,!1)}),r}},{key:"shiftCollections",value:function(t,e,n){var r=this,o=[0,0];switch(t){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n}Object(w.arrayEach)(this.mergedCells,function(t){t.shift(o,e)}),Object(_.rangeEachReverse)(this.mergedCells.length-1,0,function(t){var e=r.mergedCells[t];e&&e.removed&&r.mergedCells.splice(r.mergedCells.indexOf(e),1)})}}])&&Gi(e.prototype,n),r&&Gi(e,r),t}();function qi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ki(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}var e,n,r;return e=t,(n=[{key:"correctSelectionAreaSize",value:function(t){if(t[0]===t[2]&&t[1]===t[3]){var e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}},{key:"getDirection",value:function(t,e){return e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left"}},{key:"snapDragArea",value:function(t,e,n,r){var o=e.slice(0),i=this.getAutofillSize(t,e,n),a=qi(t,4),s=a[0],l=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(n)>-1?u-s+1:c-l+1,h=i-Math.floor(i/f)*f,d=this.getFarthestCollection(t,e,n,r);if(d)if("down"===n){var p=d.row+d.rowspan-s-h;o[2]+p>=this.plugin.hot.countRows()?o[2]-=h:o[2]+=h?p:0}else if("right"===n){var g=d.col+d.colspan-l-h;o[3]+g>=this.plugin.hot.countCols()?o[3]-=h:o[3]+=h?g:0}else if("up"===n){var v=u-h-d.row+1;o[0]+v<0?o[0]+=h:o[0]-=h?v:0}else if("left"===n){var y=c-h-d.col+1;o[1]+y<0?o[1]+=h:o[1]-=h?y:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:r,fillSize:i,dragArea:o,cycleLength:f}),o}},{key:"updateCurrentFillCache",value:function(t){this.currentFillData||(this.currentFillData={}),Object(N.extend)(this.currentFillData,t)}},{key:"getAutofillSize",value:function(t,e,n){var r=qi(t,4),o=r[0],i=r[1],a=r[2],s=r[3],l=qi(e,4),u=l[0],c=l[1],f=l[2],h=l[3];switch(n){case"up":return o-u;case"down":return f-a;case"left":return i-c;case"right":return h-s;default:return null}}},{key:"getDragArea",value:function(t,e,n){var r=qi(t,4),o=r[0],i=r[1],a=r[2],s=r[3],l=qi(e,4),u=l[0],c=l[1],f=l[2],h=l[3];switch(n){case"up":return[u,c,o-1,s];case"down":return[a+1,i,f,s];case"left":return[u,c,a,i-1];case"right":return[o,s+1,f,h];default:return null}}},{key:"getFarthestCollection",value:function(t,e,n,r){var o=qi(t,4),i=o[0],a=o[1],s=o[2],l=o[3],u=["up","down"].indexOf(n)>-1,c=u?s:l,f=u?i:a,h=this.getAutofillSize(t,e,n),d=u?s-i+1:l-a+1,p=h-Math.floor(h/d)*d,g=null,v=null,y=null;switch(n){case"up":g="includesVertically",y=c-p+1;break;case"left":g="includesHorizontally",y=c-p+1;break;case"down":g="includesVertically",y=f+p-1;break;case"right":g="includesHorizontally",y=f+p-1}return Object(w.arrayEach)(r,function(t){t[g](y)&&t.isFarther(v,n)&&(v=t)}),v}},{key:"recreateAfterDataPopulation",value:function(t){if(this.currentFillData){var e=this.getRangeFromChanges(t),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=function(t,n){switch(r){case"up":return t.row-n>=e.from.row;case"down":return t.row+t.rowspan-1+n<=e.to.row;case"left":return t.col-n>=e.from.column;case"right":return t.col+t.colspan-1+n<=e.to.column;default:return null}},i=0,a=null,s=1;do{for(var l=0;l<n.length;l+=1){if(o(a=n[l],i=s*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-i,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+i,colspan:a.colspan})}l===n.length-1&&(s+=1)}}while(o(a,i));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(t){var e=this,n={min:null,max:null},r={min:null,max:null};return Object(w.arrayEach)(t,function(t){var o=t[0],i=e.plugin.hot.propToCol(t[1]);(null===n.min||o<n.min)&&(n.min=o),(null===n.max||o>n.max)&&(n.max=o),(null===r.min||i<r.min)&&(r.min=i),(null===r.max||i>r.max)&&(r.max=i)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}},{key:"dragAreaOverlapsCollections",value:function(t,e,n){var r=qi(this.getDragArea(t,e,n),4),o=r[0],i=r[1],a=r[2],s=r[3],l=new tt.a(o,i),u=new tt.a(a,s),c=new tt.b(l,l,u);return!!this.mergedCellsCollection.getWithinRange(c,!0)}}])&&Ki(e.prototype,n),r&&Ki(e,r),t}();function Zi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Qi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ji=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}var e,n,r;return e=t,(n=[{key:"snapDelta",value:function(t,e,n){var r=e.to,o=r.row+t.row,i=r.col+t.col;t.row?this.jumpOverMergedCell(t,n,o):t.col&&this.jumpOverMergedCell(t,n,i)}},{key:"jumpOverMergedCell",value:function(t,e,n){var r=t.row||t.col,o=null,i=null,a=null;t.row?(o=e.includesVertically(n),i=e.row,a=e.getLastRow()):t.col&&(o=e.includesHorizontally(n),i=e.col,a=e.getLastColumn()),0!==r&&(r>0?o&&n!==i&&(r+=a-n+1):o&&n!==a&&(r-=n-i+1),t.row?t.row=r:t.col&&(t.col=r))}},{key:"getUpdatedSelectionRange",value:function(t,e){return new tt.b(t.highlight,t.from,new tt.a(t.to.row+e.row,t.to.col+e.col))}},{key:"getSelectedMergedCellClassName",value:function(t,e,n,r){var o=Zi(n,4),i=o[0],a=o[1],s=o[2],l=o[3];if(void 0!==r&&t>=i&&t<=s&&e>=a&&e<=l){if(!this.plugin.mergedCellsCollection.isMergedParent(t,e))return;var u=this.plugin.mergedCellsCollection.get(t,e);if(!u)return;if(u.row+u.rowspan-1<=s&&u.col+u.colspan-1<=l)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(r);if(this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}},{key:"isMergeCellFullySelected",value:function(t,e){var n=[];if(!e||!t)return!1;for(var r=0;r<t.rowspan;r+=1)for(var o=0;o<t.colspan;o+=1)n.push(new tt.a(t.row+r,t.col+o));for(var i=0;i<n.length;i+=1){for(var a=[],s=0;s<e.length;s+=1)a[s]=e[s].includes(n[i]);if(!a.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var t=[],e=0;e<=7;e+=1)t.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(e));return t.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),t}}])&&Qi(e.prototype,n),r&&Qi(e,r),t}();function ta(t){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ea(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function na(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ra(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oa(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ia(t,e,n){return(ia="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=aa(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function aa(t){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sa(t,e){return(sa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}m.a.getSingleton().register("beforeMergeCells"),m.a.getSingleton().register("afterMergeCells"),m.a.getSingleton().register("beforeUnmergeCells"),m.a.getSingleton().register("afterUnmergeCells");var la=new WeakMap,ua=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(o=aa(e).call(this,t))||"object"!==ta(o)&&"function"!=typeof o?oa(r):o,la.set(oa(n),{lastDesiredCoords:null}),n.mergedCellsCollection=null,n.autofillCalculations=null,n.selectionCalculations=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sa(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mergedCellsCollection=new Xi(this),this.autofillCalculations=new $i(this),this.selectionCalculations=new Ji(this),this.addHook("afterInit",function(){return t.onAfterInit.apply(t,arguments)}),this.addHook("beforeKeyDown",function(){return t.onBeforeKeyDown.apply(t,arguments)}),this.addHook("modifyTransformStart",function(){return t.onModifyTransformStart.apply(t,arguments)}),this.addHook("afterModifyTransformStart",function(){return t.onAfterModifyTransformStart.apply(t,arguments)}),this.addHook("modifyTransformEnd",function(){return t.onModifyTransformEnd.apply(t,arguments)}),this.addHook("modifyGetCellCoords",function(){return t.onModifyGetCellCoords.apply(t,arguments)}),this.addHook("beforeSetRangeEnd",function(){return t.onBeforeSetRangeEnd.apply(t,arguments)}),this.addHook("afterIsMultipleSelection",function(){return t.onAfterIsMultipleSelection.apply(t,arguments)}),this.addHook("afterRenderer",function(){return t.onAfterRenderer.apply(t,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return t.addMergeActionsToContextMenu.apply(t,arguments)}),this.addHook("afterGetCellMeta",function(){return t.onAfterGetCellMeta.apply(t,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return t.onAfterViewportRowCalculatorOverride.apply(t,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return t.onAfterViewportColumnCalculatorOverride.apply(t,arguments)}),this.addHook("modifyAutofillRange",function(){return t.onModifyAutofillRange.apply(t,arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol.apply(t,arguments)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol.apply(t,arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow.apply(t,arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow.apply(t,arguments)}),this.addHook("afterChange",function(){return t.onAfterChange.apply(t,arguments)}),this.addHook("beforeDrawBorders",function(){return t.onBeforeDrawAreaBorders.apply(t,arguments)}),this.addHook("afterDrawSelection",function(){return t.onAfterDrawSelection.apply(t,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return t.onBeforeRemoveCellClassNames.apply(t,arguments)}),ia(aa(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),ia(aa(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),ia(aa(e.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(t){var e=!0;return!!t&&(Wi.containsNegativeValues(t)?(Object(Vi.b)(Wi.NEGATIVE_VALUES_WARNING(t)),e=!1):Wi.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(Object(Vi.b)(Wi.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):Wi.isSingleCell(t)?(Object(Vi.b)(Wi.IS_SINGLE_CELL(t)),e=!1):Wi.containsZeroSpan(t)&&(Object(Vi.b)(Wi.ZERO_SPAN_WARNING(t)),e=!1),e)}},{key:"generateFromSettings",value:function(t){var e=this;if(Array.isArray(t)){var n,r=[];Object(w.arrayEach)(t,function(t){if(e.validateSetting(t)){var n=new tt.a(t.row,t.col),o=new tt.a(t.row+t.rowspan-1,t.col+t.colspan-1),i=new tt.b(n,n,o);r.push(e.mergeRange(i,!0,!0))}}),r=r.filter(function(t){return!0!==t});var o=this.getBulkCollectionData(r);(n=this.hot).populateFromArray.apply(n,na(o))}}},{key:"getBulkCollectionData",value:function(t){var e,n=this.getBulkCollectionDataRange(t),r=(e=this.hot).getData.apply(e,na(n)).splice(0);return Object(w.arrayEach)(t,function(t){var e=ea(t,3),o=e[0],i=e[1],a=e[2];Object(w.arrayEach)(a,function(t,e){Object(w.arrayEach)(t,function(t,a){r[o-n[0]+e][i-n[1]+a]=t})})}),[n[0],n[1],r]}},{key:"getBulkCollectionDataRange",value:function(t){var e=[0,0],n=[0,0],r=null,o=null,i=null;return Object(w.arrayEach)(t,function(t){r=t[0],o=t[1],i=t[2],e[0]=Math.min(r,e[0]),e[1]=Math.min(o,e[1]),n[0]=Math.max(r+i.length-1,n[0]),n[1]=Math.max(o+i[0].length-1,n[1])}),[].concat(e,n)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(t){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(t)}},{key:"toggleMergeOnSelection",value:function(){var t=this.hot.getSelectedRangeLast();if(t){t.setDirection("NW-SE");var e=t.from,n=t.to;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(t){t.setDirection("NW-SE");var e=t.from,n=t.to;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"unmergeSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(t){var e=t.from,n=t.to;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"mergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.getTopLeftCorner(),i=t.getBottomRightCorner(),a={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},s=[],l=null;return!!this.canMergeRange(a,n)&&(this.hot.runHooks("beforeMergeCells",t,n),Object(_.rangeEach)(0,a.rowspan-1,function(t){Object(_.rangeEach)(0,a.colspan-1,function(n){var r=null;s[t]||(s[t]=[]),0===t&&0===n?r=e.hot.getDataAtCell(a.row,a.col):e.hot.setCellMeta(a.row+t,a.col+n,"hidden",!0),s[t][n]=r})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),!this.mergedCellsCollection.add(a)||(r?l=[a.row,a.col,s]:this.hot.populateFromArray(a.row,a.col,s,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",t,a,n),l))}},{key:"unmergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(t);r&&(this.hot.runHooks("beforeUnmergeCells",t,n),Object(w.arrayEach)(r,function(t){e.mergedCellsCollection.remove(t.row,t.col),Object(_.rangeEach)(0,t.rowspan-1,function(n){Object(_.rangeEach)(0,t.colspan-1,function(r){e.hot.removeCellMeta(t.row+n,t.col+r,"hidden")})}),e.hot.removeCellMeta(t.row,t.col,"spanned")}),this.hot.render(),this.hot.runHooks("afterUnmergeCells",t,n))}},{key:"toggleMerge",value:function(t){var e=this.mergedCellsCollection.get(t.from.row,t.from.col);e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col?this.unmergeRange(t):this.mergeSelection(t)}},{key:"merge",value:function(t,e,n,r){var o=new tt.a(t,e),i=new tt.a(n,r);this.mergeRange(new tt.b(o,o,i))}},{key:"unmerge",value:function(t,e,n,r){var o=new tt.a(t,e),i=new tt.a(n,r);this.unmergeRange(new tt.b(o,o,i))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"onBeforeKeyDown",value:function(t){(t.ctrlKey||t.metaKey)&&!t.altKey&&77===t.keyCode&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),Object(I.stopImmediatePropagation)(t))}},{key:"onAfterIsMultipleSelection",value:function(t){if(t)for(var e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=0;r<e.length;r+=1)if(n.highlight.row===e[r].row&&n.highlight.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1;return t}},{key:"onModifyTransformStart",value:function(t){var e,n=la.get(this),r=this.hot.getSelectedRangeLast(),o={row:t.row,col:t.col},i=new tt.a(r.highlight.row,r.highlight.col),a=this.mergedCellsCollection.get(i.row,i.col);if(n.lastDesiredCoords||(n.lastDesiredCoords=new tt.a(null,null)),a){var s=new tt.a(a.row,a.col),l=new tt.a(a.row+a.rowspan-1,a.col+a.colspan-1);new tt.b(s,s,l).includes(n.lastDesiredCoords)||(n.lastDesiredCoords=new tt.a(null,null)),o.row=n.lastDesiredCoords.row?n.lastDesiredCoords.row-i.row:o.row,o.col=n.lastDesiredCoords.col?n.lastDesiredCoords.col-i.col:o.col,t.row>0?o.row=a.row+a.rowspan-1-i.row+t.row:t.row<0&&(o.row=i.row-a.row+t.row),t.col>0?o.col=a.col+a.colspan-1-i.col+t.col:t.col<0&&(o.col=i.col-a.col+t.col)}e=new tt.a(r.highlight.row+o.row,r.highlight.col+o.col);var u=this.mergedCellsCollection.get(e.row,e.col);u&&(n.lastDesiredCoords=e,o={row:u.row-i.row,col:u.col-i.col}),0!==o.row&&(t.row=o.row),0!==o.col&&(t.col=o.col)}},{key:"onModifyTransformEnd",value:function(t){var e=this,n=this.hot.getSelectedRangeLast(),r=Object(N.clone)(t),o=this.selectionCalculations.getUpdatedSelectionRange(n,t),i=Object(N.clone)(r),a=this.mergedCellsCollection.getWithinRange(o,!0);do{i=Object(N.clone)(r),this.selectionCalculations.getUpdatedSelectionRange(n,r),Object(w.arrayEach)(a,function(t){e.selectionCalculations.snapDelta(r,n,t)})}while(r.row!==i.row||r.col!==i.col);t.row=r.row,t.col=r.col}},{key:"onModifyGetCellCoords",value:function(t,e){var n=this.mergedCellsCollection.get(t,e);return n?[n.row,n.col,n.row+n.rowspan-1,n.col+n.colspan-1]:void 0}},{key:"addMergeActionsToContextMenu",value:function(t){var e;t.items.push({name:"---------"},(e=this,{key:"mergeCells",name:function(){var t=this.getSelectedLast();if(t){var n=e.mergedCellsCollection.get(t[0],t[1]);if(n.row===t[0]&&n.col===t[1]&&n.row+n.rowspan-1===t[2]&&n.col+n.colspan-1===t[3])return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var t=this.getSelectedLast();return!t||Wi.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}},{key:"onAfterRenderer",value:function(t,e,n){Ui(t,this.mergedCellsCollection.get(e,n),e,n)}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this.hot.getSelectedRangeLast();e.highlight=new tt.a(e.highlight.row,e.highlight.col),e.to=t;var n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(var r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){var o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(t,e,n){var r=this.mergedCellsCollection.get(t,e);!r||r.row===t&&r.col===e||(n.copyable=!1)}},{key:"onAfterViewportRowCalculatorOverride",value:function(t){var e,n=this,r=this.hot.countCols();Object(_.rangeEach)(0,r-1,function(r){if((e=n.mergedCellsCollection.get(t.startRow,r))&&e.row<t.startRow)return t.startRow=e.row,n.onAfterViewportRowCalculatorOverride.call(n,t);if(e=n.mergedCellsCollection.get(t.endRow,r)){var o=e.row+e.rowspan-1;if(o>t.endRow)return t.endRow=o,n.onAfterViewportRowCalculatorOverride.call(n,t)}return!0})}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){var e,n=this,r=this.hot.countRows();Object(_.rangeEach)(0,r-1,function(r){if((e=n.mergedCellsCollection.get(r,t.startColumn))&&e.col<t.startColumn)return t.startColumn=e.col,n.onAfterViewportColumnCalculatorOverride.call(n,t);if(e=n.mergedCellsCollection.get(r,t.endColumn)){var o=e.col+e.colspan-1;if(o>t.endColumn)return t.endColumn=o,n.onAfterViewportColumnCalculatorOverride.call(n,t)}return!0})}},{key:"onModifyAutofillRange",value:function(t,e){this.autofillCalculations.correctSelectionAreaSize(e);var n=this.autofillCalculations.getDirection(e,t),r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e;var o=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return o?r=this.autofillCalculations.snapDragArea(e,r,n,o):r}},{key:"onAfterCreateCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}},{key:"onAfterRemoveCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}},{key:"onAfterCreateRow",value:function(t,e,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}},{key:"onAfterChange",value:function(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}},{key:"onBeforeDrawAreaBorders",value:function(t,e){if(e&&"area"===e){var n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);Object(w.arrayEach)(r,function(e){n.getBottomRightCorner().row===e.getLastRow()&&n.getBottomRightCorner().col===e.getLastColumn()&&(t[2]=e.row,t[3]=e.col)})}}},{key:"onAfterModifyTransformStart",value:function(t,e,n){if(this.enabled){var r=this.mergedCellsCollection.get(t.row,t.col);if(r){var o=e>0,i=e<0,a=n<0,s=n>0,l=r.row+r.rowspan-1==this.hot.countRows()-1,u=0===r.row,c=r.col+r.colspan-1==this.hot.countCols()-1,f=0===r.col;(o&&l||i&&u||s&&c||a&&f)&&(t.row=r.row,t.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(t,e,n,r){return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}])&&ra(n.prototype,r),o&&ra(n,o),e}();Object(P.d)("mergeCells",ua);var ca=ua;function fa(t){return(fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ha(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function da(t,e){return!e||"object"!==fa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pa(t,e,n){return(pa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ga(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ga(t){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function va(t,e){return(va=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ya=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=da(this,ga(e).call(this,t))).dragged=[],n.eventManager=null,n.lastSetCell=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&va(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return Object(E.isMobileBrowser)()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new y.a(this)),this.registerListeners(),pa(ga(e.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var t=this,e=this,n=this.hot.rootElement;function r(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;var n=e.dragged.indexOf(t);if(-1===n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1===n&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",function(t){var n;return Object(b.hasClass)(t.target,"topLeftSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("topLeft"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):Object(b.hasClass)(t.target,"bottomRightSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("bottomRight"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0}),this.eventManager.addEventListener(n,"touchend",function(t){return Object(b.hasClass)(t.target,"topLeftSelectionHandle-HitArea")?(r.call(e,"topLeft"),e.touchStartRange=void 0,t.preventDefault(),!1):Object(b.hasClass)(t.target,"bottomRightSelectionHandle-HitArea")?(r.call(e,"bottomRight"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0}),this.eventManager.addEventListener(n,"touchmove",function(n){var r,o,i,a,s,l,u=t.hot,c=u.rootWindow,f=u.rootDocument,h=Object(b.getWindowScrollTop)(c),d=Object(b.getWindowScrollLeft)(c);if(0!==e.dragged.length){var p=f.elementFromPoint(n.touches[0].screenX-d,n.touches[0].screenY-h);p&&p!==e.lastSetCell&&("TD"!==p.nodeName&&"TH"!==p.nodeName||(-1===(r=e.hot.getCoords(p)).col&&(r.col=0),i=(o=e.hot.getSelectedRangeLast()).getWidth(),a=o.getHeight(),s=o.getDirection(),1===i&&1===a&&e.hot.selection.setRangeEnd(r),null!==(l=e.getCurrentRangeCoords(o,r,e.touchStartRange.direction,s,e.dragged[0])).start&&e.hot.selection.setRangeStart(l.start),e.hot.selection.setRangeEnd(l.end),e.lastSetCell=p),n.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(t,e,n,r,o){var i=t.getTopLeftCorner(),a=t.getBottomRightCorner(),s=t.getBottomLeftCorner(),l=t.getTopRightCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":u="topLeft"===o?{start:new tt.a(e.row,t.highlight.col),end:new tt.a(s.row,e.col)}:{start:new tt.a(t.highlight.row,e.col),end:new tt.a(e.row,i.col)};break;case"SE-NW":"bottomRight"===o&&(u={start:new tt.a(a.row,e.col),end:new tt.a(e.row,i.col)})}break;case"NW-SE":switch(r){case"NE-SW":"topLeft"===o?u={start:e,end:s}:u.end=e;break;case"NW-SE":"topLeft"===o?u={start:e,end:a}:u.end=e;break;case"SE-NW":"topLeft"===o?u={start:e,end:i}:u.end=e;break;case"SW-NE":"topLeft"===o?u={start:e,end:l}:u.end=e}break;case"SW-NE":switch(r){case"NW-SE":u="bottomRight"===o?{start:new tt.a(e.row,i.col),end:new tt.a(s.row,e.col)}:{start:new tt.a(i.row,e.col),end:new tt.a(e.row,a.col)};break;case"SW-NE":u="topLeft"===o?{start:new tt.a(t.highlight.row,e.col),end:new tt.a(e.row,a.col)}:{start:new tt.a(e.row,i.col),end:new tt.a(i.row,e.col)};break;case"SE-NW":"bottomRight"===o?u={start:new tt.a(e.row,l.col),end:new tt.a(i.row,e.col)}:"topLeft"===o&&(u={start:s,end:e})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"===o&&(u.end=e);break;case"SE-NW":"topLeft"===o?u.end=e:u={start:e,end:i}}}return u}},{key:"isDragged",value:function(){return this.dragged.length>0}}])&&ha(n.prototype,r),o&&ha(n,o),e}();Object(P.d)("multipleSelectionHandles",ya);var ma=ya,ba=n(133),wa=n.n(ba);n(126);function Ca(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Oa(t){var e=t.match(/^\/(\d+)\/?(.*)?$/);if(!e)return null;var n=Ca(e,3),r=n[1],o=n[2];return{row:parseInt(r,10),col:/^\d*$/.test(o)?parseInt(o,10):o}}function Ea(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Sa=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.observedData=null,this.observer=null,this.paused=!1,this.setObservedData(e)}var e,n,r;return e=t,(n=[{key:"setObservedData",value:function(t){var e=this;this.observer&&wa.a.unobserve(this.observedData,this.observer),this.observedData=t,this.observer=wa.a.observe(this.observedData,function(t){return e.onChange(t)})}},{key:"isPaused",value:function(){return this.paused}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"onChange",value:function(t){this.runLocalHooks("change",function(t){var e=[],n=Object(w.arrayFilter)(t,function(t){return!/[\/]length/gi.test(t.path)&&!!Oa(t.path)});return n=Object(w.arrayMap)(n,function(t){var e=Oa(t.path);return t.row=e.row,t.col=e.col,t}),n=Object(w.arrayFilter)(n,function(t){if(-1!==["add","remove"].indexOf(t.op)&&!isNaN(t.col)){if(-1!==e.indexOf(t.col))return!1;e.push(t.col)}return!0}),e.length=0,n}(t))}},{key:"destroy",value:function(){wa.a.unobserve(this.observedData,this.observer),this.observedData=null,this.observer=null}}])&&Ea(e.prototype,n),r&&Ea(e,r),t}();Object(N.mixin)(Sa,Je.a);var ka=Sa;function Ra(t){return(Ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ta(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ma(t,e){return!e||"object"!==Ra(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _a(t,e,n){return(_a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Na(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Na(t){return(Na=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Aa(t,e){return(Aa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xa=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ma(this,Na(e).call(this,t))).observer=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Aa(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return this.hot.getSettings().observeChanges}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.observer||(this.observer=new ka(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(e){return t.onDataChange(e)}),this.addHook("afterCreateRow",function(){return t.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return t.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return t.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return t.onAfterTableAlter()}),this.addHook("afterChange",function(e,n){return t.onAfterTableAlter(n)}),this.addHook("afterLoadData",function(e){return t.onAfterLoadData(e)}),_a(Na(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi()),_a(Na(e.prototype),"disablePlugin",this).call(this)}},{key:"onDataChange",value:function(t){var e=this;if(!this.observer.isPaused()){var n="".concat(this.pluginName,".change"),r={add:function(t){isNaN(t.col)?e.hot.runHooks("afterCreateRow",t.row,1,n):e.hot.runHooks("afterCreateCol",t.col,1,n)},remove:function(t){isNaN(t.col)?e.hot.runHooks("afterRemoveRow",t.row,1,n):e.hot.runHooks("afterRemoveCol",t.col,1,n)},replace:function(t){e.hot.runHooks("afterChange",[[t.row,t.col,null,t.value]],n)}};Object(w.arrayEach)(t,function(t){r[t.op]&&r[t.op](t)}),this.hot.render()}this.hot.runHooks("afterChangesObserved")}},{key:"onAfterTableAlter",value:function(t){var e=this;"loadData"!==t&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return e.observer.resume()}))}},{key:"onAfterLoadData",value:function(t){t||this.observer.setObservedData(this.hot.getSourceData())}},{key:"destroy",value:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi()),_a(Na(e.prototype),"destroy",this).call(this)}},{key:"_exposePublicApi",value:function(){var t=this,e=this.hot;e.pauseObservingChanges=function(){return t.observer.pause()},e.resumeObservingChanges=function(){return t.observer.resume()},e.isPausedObservingChanges=function(){return t.observer.isPaused()}}},{key:"_deletePublicApi",value:function(){var t=this.hot;delete t.pauseObservingChanges,delete t.resumeObservingChanges,delete t.isPausedObservingChanges}}])&&Ta(n.prototype,r),o&&Ta(n,o),e}(),ja=xa;Object(P.d)("observeChanges",xa);n(185);function Ia(t){return(Ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Da(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Pa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function La(t,e){return!e||"object"!==Ia(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ha(t,e,n){return(Ha="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Fa(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Fa(t){return(Fa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ba(t,e){return(Ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wa="htSearchResult",Va=function(t,e,n,r,o){t.getCellMeta(e,n).isSearchResult=o},Ua=function(t,e){return!(Object(M.isUndefined)(t)||null===t||!t.toLowerCase||0===t.length)&&(!Object(M.isUndefined)(e)&&null!==e&&-1!==e.toString().toLowerCase().indexOf(t.toLowerCase()))},Ya=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=La(this,Fa(e).call(this,t))).callback=Va,n.queryMethod=Ua,n.searchResultClass=Wa,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ba(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return this.hot.getSettings().search}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().search;this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){return t.onBeforeRenderer.apply(t,arguments)}),Ha(Fa(e.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var t=this,n=function(){return t.onBeforeRenderer.apply(t,arguments)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterRender",function(){t.hot.removeHook("beforeRenderer",n)}),Ha(Fa(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ha(Fa(e.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),o=this.hot.countRows(),i=this.hot.countCols(),a=[],s=this.hot;return Object(_.rangeEach)(0,o-1,function(o){Object(_.rangeEach)(0,i-1,function(i){var l=e.hot.getDataAtCell(o,i),u=e.hot.getCellMeta(o,i),c=u.search.callback||n,f=(u.search.queryMethod||r)(t,l);if(f){var h={row:o,col:i,data:l};a.push(h)}c&&c(s,o,i,l,f)})}),a}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(t){this.callback=t}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(t){this.queryMethod=t}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(t){this.searchResultClass=t}},{key:"updatePluginSettings",value:function(t){Object(N.isObject)(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}},{key:"onBeforeRenderer",value:function(t,e,n,r,o,i){var a,s=i.className||[],l=[];"string"==typeof s?l=s.split(" "):(a=l).push.apply(a,Da(s));this.isEnabled()&&i.isSearchResult?l.includes(this.searchResultClass)||l.push("".concat(this.searchResultClass)):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),i.className=l.join(" ")}},{key:"destroy",value:function(){Ha(Fa(e.prototype),"destroy",this).call(this)}}])&&Pa(n.prototype,r),o&&Pa(n,o),e}();Object(P.d)("search",Ya);var za=Ya;function Ga(t){return(Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qa(t,e){return!e||"object"!==Ga(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ka(t,e,n){return(Ka="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$a(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function $a(t){return($a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Za(t,e){return(Za=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qa=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=qa(this,$a(e).call(this,t))).scrollbars=[],n.clones=[],n.lockedCollection=!1,n.freezeOverlays=!1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Za(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return Object(R.isTouchSupported)()}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterRender",function(){return t.onAfterRender()}),this.registerEvents(),Ka($a(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Ka($a(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ka($a(e.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.addHook("beforeTouchScroll",function(){return t.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return t.onAfterMomentumScroll()})}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var t=this.hot.view.wt.wtOverlays,e=t.topOverlay,n=t.bottomOverlay,r=t.leftOverlay,o=t.topLeftCornerOverlay,i=t.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones.length=0,e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,Object(w.arrayEach)(this.clones,function(t){Object(b.addClass)(t,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var t=this;this.freezeOverlays=!1,Object(w.arrayEach)(this.clones,function(t){Object(b.removeClass)(t,"hide-tween"),Object(b.addClass)(t,"show-tween")}),setTimeout(function(){Object(w.arrayEach)(t.clones,function(t){Object(b.removeClass)(t,"show-tween")})},400),Object(w.arrayEach)(this.scrollbars,function(t){t.refresh(),t.resetFixedPosition()}),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}])&&Xa(n.prototype,r),o&&Xa(n,o),e}();Object(P.d)("touchScroll",Qa);var Ja=Qa;function ts(t){return(ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function es(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ns(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rs(t,e,n){return e&&ns(t.prototype,e),n&&ns(t,n),t}function os(t,e){return!e||"object"!==ts(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function is(t){return(is=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function as(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ss(t,e)}function ss(t,e){return(ss=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ls(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",function(t,n){t&&"UndoRedo.undo"!==n&&"UndoRedo.redo"!==n&&"MergeCells"!==n&&e.done(new ls.ChangeAction(t))}),t.addHook("afterCreateRow",function(t,n,r){if("UndoRedo.undo"!==r&&"UndoRedo.undo"!==r&&"auto"!==r){var o=new ls.CreateRowAction(t,n);e.done(o)}}),t.addHook("beforeRemoveRow",function(n,r,o,i){if("UndoRedo.undo"!==i&&"UndoRedo.redo"!==i&&"auto"!==i){var a=e.instance.getSourceDataArray(),s=(a.length+n)%a.length,l=t.toPhysicalRow(s),u=Object(N.deepClone)(a.slice(l,l+r));e.done(new ls.RemoveRowAction(s,u))}}),t.addHook("afterCreateCol",function(t,n,r){"UndoRedo.undo"!==r&&"UndoRedo.redo"!==r&&"auto"!==r&&e.done(new ls.CreateColumnAction(t,n))}),t.addHook("beforeRemoveCol",function(n,r,o,i){if("UndoRedo.undo"!==i&&"UndoRedo.redo"!==i&&"auto"!==i){var a=e.instance.getSourceDataArray(),s=(e.instance.countCols()+n)%e.instance.countCols(),l=[],u=[],c=[];Object(_.rangeEach)(a.length-1,function(e){var n=[],o=a[e];Object(_.rangeEach)(s,s+(r-1),function(e){n.push(o[t.runHooks("modifyCol",e)])}),l.push(n)}),Object(_.rangeEach)(r-1,function(e){c.push(t.runHooks("modifyCol",s+e))}),Array.isArray(t.getSettings().colHeaders)&&Object(_.rangeEach)(r-1,function(e){u.push(t.getSettings().colHeaders[t.runHooks("modifyCol",s+e)]||null)});var f=e.instance.getPlugin("manualColumnMove"),h=f.isEnabled()?f.columnsMapper.__arrayMap:[],d=new ls.RemoveColumnAction(s,c,l,u,h);e.done(d)}}),t.addHook("beforeCellAlignment",function(t,n,r,o){var i=new ls.CellAlignmentAction(t,n,r,o);e.done(i)}),t.addHook("beforeFilter",function(t){e.done(new ls.FiltersAction(t))}),t.addHook("beforeRowMove",function(t,n){!1!==t&&e.done(new ls.RowMoveAction(t,n))}),t.addHook("beforeMergeCells",function(n,r){r||e.done(new ls.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",function(n,r){r||e.done(new ls.UnmergeCellsAction(t,n))})}ls.prototype.done=function(t){this.ignoreNewActions||(this.doneActions.push(t),this.undoneActions.length=0)},ls.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.pop(),e=Object(N.deepClone)(t),n=this.instance;if(!1===n.runHooks("beforeUndo",e))return;this.ignoreNewActions=!0;var r=this;t.undo(this.instance,function(){r.ignoreNewActions=!1,r.undoneActions.push(t)}),n.runHooks("afterUndo",e)}},ls.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.pop(),e=Object(N.deepClone)(t),n=this.instance;if(!1===n.runHooks("beforeRedo",e))return;this.ignoreNewActions=!0;var r=this;t.redo(this.instance,function(){r.ignoreNewActions=!1,r.doneActions.push(t)}),n.runHooks("afterRedo",e)}},ls.prototype.isUndoAvailable=function(){return this.doneActions.length>0},ls.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},ls.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},ls.Action=function(){},ls.Action.prototype.undo=function(){},ls.Action.prototype.redo=function(){},ls.ChangeAction=function(t){this.changes=t,this.actionType="change"},Object(N.inherit)(ls.ChangeAction,ls.Action),ls.ChangeAction.prototype.undo=function(t,e){for(var n=Object(N.deepClone)(this.changes),r=t.countEmptyRows(!0),o=t.countEmptyCols(!0),i=0,a=n.length;i<a;i++)n[i].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtRowProp(n,null,null,"UndoRedo.undo");for(var s=0,l=n.length;s<l;s++)t.getSettings().minSpareRows&&n[s][0]+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(n[s][0]+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&n[s][1]+1+t.getSettings().minSpareCols===t.countCols()&&o===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(n[s][1]+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())},ls.ChangeAction.prototype.redo=function(t,e){for(var n=Object(N.deepClone)(this.changes),r=0,o=n.length;r<o;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtRowProp(n,null,null,"UndoRedo.redo")},ls.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},Object(N.inherit)(ls.CreateRowAction,ls.Action),ls.CreateRowAction.prototype.undo=function(t,e){var n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},ls.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},ls.RemoveRowAction=function(t,e){this.index=t,this.data=e,this.actionType="remove_row"},Object(N.inherit)(ls.RemoveRowAction,ls.Action),ls.RemoveRowAction.prototype.undo=function(t,e){t.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterRender",e),t.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},ls.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},ls.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},Object(N.inherit)(ls.CreateColumnAction,ls.Action),ls.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},ls.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},ls.RemoveColumnAction=function(t,e,n,r,o){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.actionType="remove_col"},Object(N.inherit)(ls.RemoveColumnAction,ls.Action),ls.RemoveColumnAction.prototype.undo=function(t,e){var n,r=this,o=this.indexes.slice(0).sort(),i=function(t,e,n){return n[r.indexes.indexOf(o[e])]},a=[];Object(_.rangeEach)(this.data.length-1,function(t){a[t]=Object(w.arrayMap)(r.data[t],i)});var s;s=Object(w.arrayMap)(this.headers,i);var l=[];t.runHooks("beforeCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Object(_.rangeEach)(this.data.length-1,function(e){n=t.getSourceDataAtRow(e),Object(_.rangeEach)(o.length-1,function(t){n.splice(o[t],0,a[e][t]),l.push([e,o[t],null,a[e][t]])})}),t.getPlugin("formulas")&&t.getPlugin("formulas").onAfterSetDataAtCell(l),void 0!==this.headers&&Object(_.rangeEach)(s.length-1,function(e){t.getSettings().colHeaders.splice(o[e],0,s[e])}),t.getPlugin("manualColumnMove")&&(t.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions),t.addHookOnce("afterRender",e),t.runHooks("afterCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo"),t.getPlugin("formulas")&&t.getPlugin("formulas").recalculateFull(),t.render()},ls.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},ls.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r},ls.CellAlignmentAction.prototype.undo=function(t,e){var n=this;Object(w.arrayEach)(this.range,function(e){for(var r=e.from,o=e.to,i=r.row;i<=o.row;i+=1)for(var a=r.col;a<=o.col;a+=1)t.setCellMeta(i,a,"className",n.stateBefore[i][a]||" htLeft")}),t.addHookOnce("afterRender",e),t.render()},ls.CellAlignmentAction.prototype.redo=function(t,e){Xe(this.range,this.type,this.alignment,function(e,n){return t.getCellMeta(e,n)},function(e,n,r,o){return t.setCellMeta(e,n,r,o)}),t.addHookOnce("afterRender",e),t.render()},ls.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},Object(N.inherit)(ls.FiltersAction,ls.Action),ls.FiltersAction.prototype.undo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},ls.FiltersAction.prototype.redo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var us=function(t){function e(t,n){var r;return es(this,e),(r=os(this,is(e).call(this))).cellRange=n,r.rangeData=t.getData(n.from.row,n.from.col,n.to.row,n.to.col),r}return as(e,ls.Action),rs(e,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.unmergeRange(this.cellRange,!0),t.populateFromArray(this.cellRange.from.row,this.cellRange.from.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.mergeRange(this.cellRange)}}]),e}();ls.MergeCellsAction=us;var cs=function(t){function e(t,n){var r;return es(this,e),(r=os(this,is(e).call(this))).cellRange=n,r}return as(e,ls.Action),rs(e,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.unmergeRange(this.cellRange,!0),t.render()}}]),e}();function fs(){void 0===this.getSettings().undo||this.getSettings().undo?this.undoRedo||(this.undoRedo=new ls(this),function(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}(this),this.addHook("beforeKeyDown",hs),this.addHook("afterChange",ds)):this.undoRedo&&(delete this.undoRedo,function(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}(this),this.removeHook("beforeKeyDown",hs),this.removeHook("afterChange",ds))}function hs(t){(t.ctrlKey||t.metaKey)&&!t.altKey&&(89===t.keyCode||t.shiftKey&&90===t.keyCode?(this.undoRedo.redo(),Object(I.stopImmediatePropagation)(t)):90===t.keyCode&&(this.undoRedo.undo(),Object(I.stopImmediatePropagation)(t)))}function ds(t,e){if("loadData"===e)return this.undoRedo.clear()}ls.UnmergeCellsAction=cs,ls.RowMoveAction=function(t,e){this.rows=t.slice(),this.target=e},Object(N.inherit)(ls.RowMoveAction,ls.Action),ls.RowMoveAction.prototype.undo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterRender",e);for(var r=this.rows[0]<this.target?-1*this.rows.length:0,o=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],i=[],a=this.rows.length+r,s=r;s<a;s+=1)i.push(this.target+s);n.moveRows(i.slice(),o),t.render(),t.selectCell(this.rows[0],0,this.rows[this.rows.length-1],t.countCols()-1,!1,!1)},ls.RowMoveAction.prototype.redo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterRender",e),n.moveRows(this.rows.slice(),this.target),t.render();var r=this.rows[0]<this.target?this.target-this.rows.length:this.target;t.selectCell(r,0,r+this.rows.length-1,t.countCols()-1,!1,!1)};var ps=m.a.getSingleton();ps.add("afterInit",fs),ps.add("afterUpdateSettings",fs),ps.register("beforeUndo"),ps.register("afterUndo"),ps.register("beforeRedo"),ps.register("afterRedo");var gs=ls;function vs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ys=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"STRATEGY_NAME",get:function(){return"loose"}}],(n=[{key:"createRow",value:function(t,e){this.shiftItems(t,e)}},{key:"removeRow",value:function(t,e){this.unshiftItems(t,e)}},{key:"destroy",value:function(){this._arrayMap=null}}])&&vs(e.prototype,n),r&&vs(e,r),t}();Object(N.mixin)(ys,Jt);var ms=ys;function bs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ws=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"STRATEGY_NAME",get:function(){return"strict"}}],(n=[{key:"createRow",value:function(t,e){this.insertItems(t,e)}},{key:"removeRow",value:function(t,e){this.removeItems(t,e)}},{key:"destroy",value:function(){this._arrayMap=null}}])&&bs(e.prototype,n),r&&bs(e,r),t}();Object(N.mixin)(ws,Jt);var Cs=ws;function Os(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Es(t,e,n){return e&&Os(t.prototype,e),n&&Os(t,n),t}var Ss=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.strategy=null}return Es(t,null,[{key:"DEFAULT_STRATEGY",get:function(){return"loose"}}]),Es(t,[{key:"setStrategy",value:function(t){var e=r[Object(x.toUpperCaseFirst)(t)];if(!e)throw new Error('Bind strategy "'.concat(t,'" does not exist.'));this.strategy=new e}},{key:"createMap",value:function(t){var e=this.strategy,n=void 0===t?e._arrayMap.length:t;e._arrayMap.length=0,Object(_.rangeEach)(n-1,function(t){e._arrayMap.push(t)})}},{key:"createRow",value:function(){var t;(t=this.strategy).createRow.apply(t,arguments)}},{key:"removeRow",value:function(){var t;(t=this.strategy).removeRow.apply(t,arguments)}},{key:"translate",value:function(){var t;return(t=this.strategy).getValueByIndex.apply(t,arguments)}},{key:"clearMap",value:function(){this.strategy.clearMap()}},{key:"destroy",value:function(){this.strategy&&this.strategy.destroy(),this.strategy=null}}]),t}();function ks(t){return(ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ts(t,e){return!e||"object"!==ks(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ms(t,e,n){return(Ms="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_s(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _s(t){return(_s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ns(t,e){return(Ns=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var As=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ts(this,_s(e).call(this,t))).bindStrategy=new Ss,n.removedRows=[],n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ns(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof n&&(n=Ss.DEFAULT_STRATEGY),this.bindStrategy.setStrategy(n),this.bindStrategy.createMap(this.hot.countSourceRows()),this.addHook("modifyRowHeader",function(e){return t.onModifyRowHeader(e)}),this.addHook("afterCreateRow",function(e,n){return t.onAfterCreateRow(e,n)}),this.addHook("beforeRemoveRow",function(e,n){return t.onBeforeRemoveRow(e,n)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow()}),this.addHook("afterLoadData",function(e){return t.onAfterLoadData(e)}),Ms(_s(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){Ms(_s(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.removedRows.length=0,this.bindStrategy.clearMap(),Ms(_s(e.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(t){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",t))}},{key:"onAfterCreateRow",value:function(t,e){this.bindStrategy.createRow(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&Object(_.rangeEach)(t,t+e-1,function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t))})}},{key:"onAfterRemoveRow",value:function(){this.bindStrategy.removeRow(this.removedRows)}},{key:"onAfterLoadData",value:function(t){t||this.bindStrategy.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.bindStrategy.destroy(),Ms(_s(e.prototype),"destroy",this).call(this)}}])&&Rs(n.prototype,r),o&&Rs(n,o),e}();Object(P.d)("bindRowsWithHeaders",As);var xs=As;function js(t){return(js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Is(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ds(t,e){return!e||"object"!==js(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ps(t,e,n){return(Ps="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ls(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ls(t){return(Ls=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hs(t,e){return(Hs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fs=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ds(this,Ls(e).call(this,t))).settings=null,n.buttonEnabledList={},n.hiddenColumnsPlugin=null,n.nestedHeadersPlugin=null,n.collapsedSections={},n.columnHeaderLevelCount=null,n.eventManager=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hs(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().collapsibleColumns,"boolean"!=typeof this.settings&&this.parseSettings(),this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns"),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.checkDependencies(),this.addHook("afterRender",function(){return t.onAfterRender()}),this.addHook("afterInit",function(){return t.onAfterInit()}),this.addHook("afterGetColHeader",function(e,n){return t.onAfterGetColHeader(e,n)}),this.addHook("beforeOnCellMouseDown",function(e,n,r){return t.onBeforeOnCellMouseDown(e,n,r)}),this.eventManager=new y.a(this.hot),Ps(Ls(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.buttonEnabledList={},this.hiddenColumnsPlugin=null,this.collapsedSections={},this.clearButtons(),Ps(Ls(e.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,o=function(t){t&&t.parentNode.removeChild(t)};Object(_.rangeEach)(0,t-1,function(t){var i=e.childNodes[t],a=n.childNodes[t],s=r?r.childNodes[t]:null;Object(_.rangeEach)(0,i.childNodes.length-1,function(t){var e=i.childNodes[t].querySelector(".collapsibleIndicator");o(e),a&&a.childNodes[t]&&(e=a.childNodes[t].querySelector(".collapsibleIndicator"),o(e)),r&&s&&s.childNodes[t]&&(e=s.childNodes[t].querySelector(".collapsibleIndicator"),o(e))})},!0)}}},{key:"parseSettings",value:function(){var t=this;Object(N.objectEach)(this.settings,function(e){t.buttonEnabledList[e.row]||(t.buttonEnabledList[e.row]={}),t.buttonEnabledList[e.row][e.col]=e.collapsible})}},{key:"meetsDependencies",value:function(){var t=this.hot.getSettings();return t.nestedHeaders&&t.hiddenColumns}},{key:"checkDependencies",value:function(){var t=this.hot.getSettings();this.meetsDependencies()||(t.nestedHeaders||Object(Vi.b)("You need to configure the Nested Headers plugin in order to use collapsible headers."),t.hiddenColumns||Object(Vi.b)("You need to configure the Hidden Columns plugin in order to use collapsible headers."))}},{key:"generateIndicator",value:function(t,e){var n=e.parentNode,r=n.parentNode,o=-1*r.childNodes.length+Array.prototype.indexOf.call(r.childNodes,n);if(Object.keys(this.buttonEnabledList).length>0&&(!this.buttonEnabledList[o]||!this.buttonEnabledList[o][t]))return null;var i=this.hot.rootDocument.createElement("DIV");return Object(b.addClass)(i,"collapsibleIndicator"),this.collapsedSections[o]&&!0===this.collapsedSections[o][t]?(Object(b.addClass)(i,"collapsed"),Object(b.fastInnerText)(i,"+")):(Object(b.addClass)(i,"expanded"),Object(b.fastInnerText)(i,"-")),i}},{key:"markSectionAs",value:function(t,e,n,r){switch(this.collapsedSections[e]||(this.collapsedSections[e]={}),t){case"collapsed":this.collapsedSections[e][n]=!0;break;case"expanded":this.collapsedSections[e][n]=void 0}if(r)for(var o=this.nestedHeadersPlugin.colspanArray,i=this.nestedHeadersPlugin.rowCoordsToLevel(e),a=this.nestedHeadersPlugin.getChildHeaders(e,n),s=o[i+1],l=1;l<a.length;l++)s&&s[a[l]].colspan>1&&this.markSectionAs(t,e+1,a[l],!0)}},{key:"expandSection",value:function(t){this.markSectionAs("expanded",t.row,t.col,!0),this.toggleCollapsibleSection(t,"expand")}},{key:"collapseSection",value:function(t){this.markSectionAs("collapsed",t.row,t.col,!0),this.toggleCollapsibleSection(t,"collapse")}},{key:"toggleAllCollapsibleSections",value:function(t){var e=this,n=this.nestedHeadersPlugin.colspanArray;!0===this.settings?Object(w.arrayEach)(n,function(n,r){Object(w.arrayEach)(n,function(n,o){if(n.colspan>1){var i=e.nestedHeadersPlugin.levelToRowCoords(parseInt(r,10)),a=parseInt(o,10);e.markSectionAs("collapse"===t?"collapsed":"expanded",i,a,!0),e.toggleCollapsibleSection({row:i,col:a},t)}})}):Object(N.objectEach)(this.buttonEnabledList,function(n,r){Object(N.objectEach)(n,function(n,o){var i=parseInt(r,10),a=parseInt(o,10);e.markSectionAs("collapse"===t?"collapsed":"expanded",i,a,!0),e.toggleCollapsibleSection({row:i,col:a},t)})})}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(t,e){var n=this;t.row&&(t.row=parseInt(t.row,10)),t.col&&(t.col=parseInt(t.col,10));for(var r=this.hiddenColumnsPlugin.hiddenColumns,o=this.nestedHeadersPlugin.colspanArray,i=this.nestedHeadersPlugin.rowCoordsToLevel(t.row),a=o[i][t.col].colspan,s=this.nestedHeadersPlugin.getChildHeaders(t.row,t.col),l=i+1,u=o[l],c=u&&u[s[0]].colspan||1;c===a&&l<this.columnHeaderLevelCount;)c=(u=o[l+=1])&&u[s[0]].colspan||1;Object(_.rangeEach)(c,a-1,function(o){var i=t.col+o;switch(e){case"collapse":n.hiddenColumnsPlugin.isHidden(i)||r.push(i);break;case"expand":n.hiddenColumnsPlugin.isHidden(i)&&r.splice(r.indexOf(i),1)}}),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0)}},{key:"onAfterGetColHeader",value:function(t,e){if(e.hasAttribute("colspan")&&e.getAttribute("colspan")>1&&t>=this.hot.getSettings().fixedColumnsLeft){var n=this.generateIndicator(t,e);null!==n&&e.querySelector("div:first-child").appendChild(n)}}},{key:"onBeforeOnCellMouseDown",value:function(t,e){if(Object(b.hasClass)(t.target,"collapsibleIndicator"))return Object(b.hasClass)(t.target,"expanded")?(this.collapsedSections[e.row]||(this.collapsedSections[e.row]=[]),this.markSectionAs("collapsed",e.row,e.col,!0),this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection(e,"collapse")):Object(b.hasClass)(t.target,"collapsed")&&(this.markSectionAs("expanded",e.row,e.col,!0),this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection(e,"expand")),Object(I.stopImmediatePropagation)(t),!1}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length}},{key:"onAfterRender",value:function(){this.nestedHeadersPlugin.enabled&&this.hiddenColumnsPlugin.enabled||this.disablePlugin()}},{key:"destroy",value:function(){this.settings=null,this.buttonEnabledList=null,this.hiddenColumnsPlugin=null,this.nestedHeadersPlugin=null,this.collapsedSections=null,this.columnHeaderLevelCount=null,Ps(Ls(e.prototype),"destroy",this).call(this)}}])&&Is(n.prototype,r),o&&Is(n,o),e}();Object(P.d)("collapsibleColumns",Fs);var Bs=Fs;n(222);function Ws(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Vs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Us=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[],this.recordTranslator=Object(D.a)(this.hot)}var e,n,r;return e=t,(n=[{key:"getEndpoint",value:function(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(t){return this.parseSettings(t.call(this))}},{key:"parseSettings",value:function(t){var e=this,n=[],r=t;if(r||"function"!=typeof this.settings)return r||(r=this.settings),Object(w.arrayEach)(r,function(t){var r={};e.assignSetting(t,r,"ranges",[[0,e.hot.countRows()-1]]),e.assignSetting(t,r,"reversedRowCoords",!1),e.assignSetting(t,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,r,"sourceColumn",t.destinationColumn),e.assignSetting(t,r,"type","sum"),e.assignSetting(t,r,"forceNumeric",!1),e.assignSetting(t,r,"suppressDataTypeErrors",!0),e.assignSetting(t,r,"suppressDataTypeErrors",!0),e.assignSetting(t,r,"customFunction",null),e.assignSetting(t,r,"readOnly",!0),e.assignSetting(t,r,"roundFloat",!1),n.push(r)}),n;this.settingsType="function"}},{key:"assignSetting",value:function(t,e,n,r){if("ranges"!==n||void 0!==t[n]){if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(r instanceof Error)throw r;e[n]=r}else"destinationRow"===n&&e.reversedRowCoords?e[n]=this.hot.countRows()-t[n]-1:e[n]=t[n]}else e[n]=r}},{key:"resetSetupBeforeStructureAlteration",value:function(t,e,n){if("function"===this.settingsType){var r=t.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();Object(w.arrayEach)(o,function(o){"row"===r&&o.destinationRow>=e&&("insert_row"===t?o.alterRowOffset=n:"remove_row"===t&&(o.alterRowOffset=-1*n)),"col"===r&&o.destinationColumn>=e&&("insert_col"===t?o.alterColumnOffset=n:"remove_col"===t&&(o.alterColumnOffset=-1*n))}),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(t,e,n,r,o){var i=this,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var s=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=0===t.indexOf("move_row"),f=e;Object(w.arrayEach)(u,function(t){"row"===s&&t.destinationRow>=f&&(t.alterRowOffset=l*n),"col"===s&&t.destinationColumn>=f&&(t.alterColumnOffset=l*n)}),this.resetAllEndpoints(u,!c),c?Object(w.arrayEach)(u,function(t){i.extendEndpointRanges(t,f,r[0],r.length),i.recreatePhysicalRanges(t),i.clearOffsetInformation(t)}):Object(w.arrayEach)(u,function(t){i.shiftEndpointCoordinates(t,f)}),a&&this.refreshAllEndpoints()}else{this.hot.addHookOnce("beforeRender",function t(){return i.hot.removeHook("beforeRender",t),i.refreshAllEndpoints()})}}},{key:"clearOffsetInformation",value:function(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(t,e,n,r){Object(w.arrayEach)(t.ranges,function(t){t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=r:n<t[0]&&(t[0]-=r):n>=t[0]&&n<=t[1]&&(t[1]-=r,e<=t[0]&&(t[0]+=1,t[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(t){var e=this,n=t.ranges,r=[],o=[];Object(w.arrayEach)(n,function(t){var n=[];if(t[1])for(var r=t[0];r<=t[1];r++)n.push(e.recordTranslator.toPhysicalRow(r));else n.push(e.recordTranslator.toPhysicalRow(t[0]));o.push(n)}),Object(w.arrayEach)(o,function(t){var e=[];Object(w.arrayEach)(t,function(n,o){0===o?e.push(n):t[o]!==t[o-1]+1&&(e.push(t[o-1]),r.push(e),(e=[]).push(n)),o===t.length-1&&(e.push(n),r.push(e))})}),t.ranges=r}},{key:"shiftEndpointCoordinates",value:function(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,Object(w.arrayEach)(t.ranges,function(n){Object(w.arrayEach)(n,function(r,o){r>=e&&(n[o]+=t.alterRowOffset||0)})})):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t;this.cellsToSetCache=[],r||(r=this.getAllEndpoints()),Object(w.arrayEach)(r,function(t){e.resetEndpointValue(t,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshAllEndpoints",value:function(){var t=this;this.cellsToSetCache=[],Object(w.arrayEach)(this.getAllEndpoints(),function(e){t.currentEndpoint=e,t.plugin.calculate(e),t.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(t){var e=this,n=[];this.cellsToSetCache=[],Object(w.arrayEach)(t,function(t,r,o){"".concat(t[2]||"")!=="".concat(t[3])&&Object(w.arrayEach)(e.getAllEndpoints(),function(t,i){e.hot.propToCol(o[r][1])===t.sourceColumn&&-1===n.indexOf(i)&&n.push(i)})}),Object(w.arrayEach)(n,function(t){e.refreshEndpoint(e.getEndpoint(t))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.alterRowOffset||0,r=t.alterColumnOffset||0,o=Ws(this.recordTranslator.toVisual(t.destinationRow,t.destinationColumn),2),i=o[0],a=o[1],s=this.hot.getCellMeta(i,a);s.readOnly=!1,s.className="",this.cellsToSetCache.push([this.recordTranslator.toVisualRow(t.destinationRow+(e?n:0)),this.recordTranslator.toVisualColumn(t.destinationColumn+(e?r:0)),""])}},{key:"setEndpointValue",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=-1*t.alterRowOffset||0,o=-1*t.alterColumnOffset||0,i=this.getVisualRowIndex(t.destinationRow),a=this.hot.getCellMeta(this.getVisualRowIndex(t.destinationRow+r),t.destinationColumn+o);i>this.hot.countRows()||t.destinationColumn>this.hot.countCols()?this.throwOutOfBoundsWarning():("init"!==e&&a.readOnly===t.readOnly||(a.readOnly=t.readOnly,a.className="columnSummaryResult"),t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),n?this.hot.setDataAtCell(i,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0)}},{key:"getVisualRowIndex",value:function(t){return this.hot.runHooks("unmodifyRow",t,"columnSummary")}},{key:"getVisualColumnIndex",value:function(t){return this.hot.runHooks("unmodifyCol",t,"columnSummary")}},{key:"throwOutOfBoundsWarning",value:function(){Object(Vi.b)("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}}])&&Vs(e.prototype,n),r&&Vs(e,r),t}();function Ys(t){return(Ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gs(t,e){return!e||"object"!==Ys(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xs(t,e,n){return(Xs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qs(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function qs(t){return(qs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ks(t,e){return(Ks=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $s=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Gs(this,qs(e).call(this,t))).endpoints=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ks(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new Us(this,this.settings),this.addHook("afterInit",function(){return t.onAfterInit.apply(t,arguments)}),this.addHook("afterChange",function(){return t.onAfterChange.apply(t,arguments)}),this.addHook("beforeCreateRow",function(e,n,r){return t.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,n,null,r)}),this.addHook("beforeCreateCol",function(e,n,r){return t.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,n,null,r)}),this.addHook("beforeRemoveRow",function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_row"].concat(r))}),this.addHook("beforeRemoveCol",function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_col"].concat(r))}),this.addHook("beforeRowMove",function(){return t.onBeforeRowMove.apply(t,arguments)}),this.addHook("afterCreateRow",function(e,n,r){return t.endpoints.resetSetupAfterStructureAlteration("insert_row",e,n,null,r)}),this.addHook("afterCreateCol",function(e,n,r){return t.endpoints.resetSetupAfterStructureAlteration("insert_col",e,n,null,r)}),this.addHook("afterRemoveRow",function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_row"].concat(r))}),this.addHook("afterRemoveCol",function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_col"].concat(r))}),this.addHook("afterRowMove",function(){return t.onAfterRowMove.apply(t,arguments)}),Xs(qs(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}},{key:"calculateSum",value:function(t){var e=this,n=0;return Object(N.objectEach)(t.ranges,function(r){n+=e.getPartialSum(r,t.sourceColumn)}),n}},{key:"getPartialSum",value:function(t,e){var n=0,r=t[1]||t[0],o=null,i=0;do{o=this.getCellValue(r,e)||0;var a=("".concat(o).split(".")[1]||[]).length||1;a>i&&(i=a),n+=o||0,r-=1}while(r>=t[0]);return Math.round(n*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(t,e){var n=this,r=null;return Object(N.objectEach)(t.ranges,function(o){var i=n.getPartialMinMax(o,t.sourceColumn,e);if(null===r&&null!==i&&(r=i),null!==i)switch(e){case"min":r=Math.min(r,i);break;case"max":r=Math.max(r,i)}}),null===r?"Not enough data":r}},{key:"getPartialMinMax",value:function(t,e,n){var r,o=null,i=t[1]||t[0];do{if(r=this.getCellValue(i,e)||null,null===o)o=r;else if(null!==r)switch(n){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r)}i-=1}while(i>=t[0]);return o}},{key:"countEmpty",value:function(t,e){var n=0,r=t[1]||t[0];do{this.getCellValue(r,e)||(n+=1),r-=1}while(r>=t[0]);return n}},{key:"countEntries",value:function(t){var e=this,n=0,r=t.ranges;return Object(N.objectEach)(r,function(r){var o=void 0===r[1]?1:r[1]-r[0]+1,i=e.countEmpty(r,t.sourceColumn);n+=o,n-=i}),n}},{key:"calculateAverage",value:function(t){return this.calculateSum(t)/this.countEntries(t)}},{key:"getCellValue",value:function(t,e){var n=this.endpoints.getVisualRowIndex(t),r=this.endpoints.getVisualColumnIndex(e),o=this.hot.getSourceDataAtCell(t,e);if((this.hot.getCellMeta(n,r).className||"").indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error("ColumnSummary plugin: cell at (".concat(t,", ").concat(e,") is not in a numeric format. Cannot do the calculation."));return o}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}},{key:"onBeforeRowMove",value:function(t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName)}},{key:"onAfterRowMove",value:function(t,e){this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}}])&&zs(n.prototype,r),o&&zs(n,o),e}();Object(P.d)("columnSummary",$s);var Zs=$s;function Qs(t){return(Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Js(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tl(t,e,n){return(tl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=el(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function el(t){return(el=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rl(t,e,n){return e&&nl(t.prototype,e),n&&nl(t,n),t}function ol(t,e){return(ol=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}m.a.getSingleton().register("afterDropdownMenuDefaultOptions"),m.a.getSingleton().register("beforeDropdownMenuShow"),m.a.getSingleton().register("afterDropdownMenuShow"),m.a.getSingleton().register("afterDropdownMenuHide"),m.a.getSingleton().register("afterDropdownMenuExecute");var il=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,o=el(e).call(this,t),(n=!o||"object"!==Qs(o)&&"function"!=typeof o?Js(r):o).eventManager=new y.a(Js(n)),n.commandExecutor=new vn(n.hot),n.itemsFactory=null,n.menu=null,n.hot.addHook("afterGetColHeader",function(t,e){return n.onAfterGetColHeader(t,e)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ol(t,e)}(e,B),rl(e,null,[{key:"DEFAULT_ITEMS",get:function(){return[Cn,En,We,Mn,We,bn,We,Sn,We,yn]}}]),rl(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.itemsFactory=new Wn(this.hot,e.DEFAULT_ITEMS);var n=this.hot.getSettings().dropdownMenu,r={items:this.itemsFactory.getItems(n)};this.registerEvents(),"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),tl(el(e.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){t.hot.runHooks("afterDropdownMenuDefaultOptions",r),t.itemsFactory.setPredefinedItems(r.items);var e=t.itemsFactory.getItems(n);t.menu&&t.menu.destroy(),t.menu=new Xn(t.hot,{className:"htDropdownMenu",keepInViewport:!0}),t.hot.runHooks("beforeDropdownMenuSetItems",e),t.menu.setMenuItems(e),t.menu.addLocalHook("beforeOpen",function(){return t.onMenuBeforeOpen()}),t.menu.addLocalHook("afterOpen",function(){return t.onMenuAfterOpen()}),t.menu.addLocalHook("afterClose",function(){return t.onMenuAfterClose()}),t.menu.addLocalHook("executeCommand",function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.executeCommand).call.apply(e,[t].concat(r))}),Object(w.arrayEach)(e,function(e){return t.commandExecutor.registerCommand(e.key,e)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),tl(el(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),tl(el(e.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(e){return t.onTableClick(e)})}},{key:"open",value:function(t){this.menu&&(this.menu.open(),t.width&&this.menu.setOffset("left",t.width),this.menu.setPosition(t),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"setListening",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(t){if(Object(I.stopPropagation)(t),Object(b.hasClass)(t.target,"changeType")&&!this.menu.isOpened()){var e=t.target.getBoundingClientRect();this.open({left:e.left,top:e.top+t.target.offsetHeight+3,width:e.width,height:e.height})}}},{key:"onAfterGetColHeader",value:function(t,e){var n=e.parentNode;if(n){var r=n.parentNode.childNodes,o=Array.prototype.indexOf.call(r,n);if(!(t<0||o!==r.length-1)){var i=e.querySelector(".".concat("changeType"));if(!this.enabled||!i)if(this.enabled){var a=this.hot.rootDocument.createElement("button");a.className="changeType",a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}else i&&i.parentNode.removeChild(i)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),tl(el(e.prototype),"destroy",this).call(this)}}]),e}();il.SEPARATOR={name:We},Object(P.d)("dropdownMenu",il);var al=il;function sl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ll(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ul=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.options={}}var e,n,r;return e=t,(n=[{key:"setOptions",value:function(t){this.options=t}},{key:"getData",value:function(){var t=this,e=this._getDataRange(),n=e.startRow,r=e.startCol,o=e.endRow,i=e.endCol,a=this.options,s=[];return Object(_.rangeEach)(n,o,function(e){var n=[];!a.exportHiddenRows&&t._isHiddenRow(e)||(Object(_.rangeEach)(r,i,function(r){!a.exportHiddenColumns&&t._isHiddenColumn(r)||n.push(t.hot.getDataAtCell(e,r))}),s.push(n))}),s}},{key:"getRowHeaders",value:function(){var t=this,e=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,o=n.endRow,i=this.hot.getRowHeader();Object(_.rangeEach)(r,o,function(n){!t.options.exportHiddenRows&&t._isHiddenRow(n)||e.push(i[n])})}return e}},{key:"getColumnHeaders",value:function(){var t=this,e=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,o=n.endCol,i=this.hot.getColHeader();Object(_.rangeEach)(r,o,function(n){!t.options.exportHiddenColumns&&t._isHiddenColumn(n)||e.push(i[n])})}return e}},{key:"_getDataRange",value:function(){var t=this.hot.countCols()-1,e=this.hot.countRows()-1,n=sl(this.options.range,4),r=n[0],o=void 0===r?0:r,i=n[1],a=void 0===i?0:i,s=n[2],l=void 0===s?e:s,u=n[3],c=void 0===u?t:u;return{startRow:o=Math.max(o,0),startCol:a=Math.max(a,0),endRow:l=Math.min(l,e),endCol:c=Math.min(c,t)}}},{key:"_isHiddenRow",value:function(t){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",t)}},{key:"_isHiddenColumn",value:function(t){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",t)}}])&&ll(e.prototype,n),r&&ll(e,r),t}();n(183);function cl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fl(t,e,n){return e&&cl(t.prototype,e),n&&cl(t,n),t}var hl=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}return fl(t,null,[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),fl(t,[{key:"_mergeOptions",value:function(e){var n=Object(N.clone)(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=Object(N.extend)(Object(N.clone)(t.DEFAULT_OPTIONS),n),(n=Object(N.extend)(n,e)).filename=Object(x.substitute)(n.filename,{YYYY:r.getFullYear(),MM:"".concat(r.getMonth()+1).padStart(2,"0"),DD:"".concat(r.getDate()).padStart(2,"0")}),n}}]),t}();function dl(t){return(dl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gl(t,e){return!e||"object"!==dl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vl(t){return(vl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yl(t,e){return(yl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ml=String.fromCharCode(13),bl=String.fromCharCode(34),wl=String.fromCharCode(10),Cl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),gl(this,vl(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yl(t,e)}(e,hl),n=e,o=[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}],(r=[{key:"export",value:function(){var t=this,e=this.options,n=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),o=r.length>0,i=this.dataProvider.getRowHeaders(),a=i.length>0,s=e.bom?String.fromCharCode(65279):"";return o&&(r=Object(w.arrayMap)(r,function(e){return t._escapeCell(e,!0)}),a&&(s+=e.columnDelimiter),s+=r.join(e.columnDelimiter),s+=e.rowDelimiter),Object(w.arrayEach)(n,function(n,r){r>0&&(s+=e.rowDelimiter),a&&(s+=t._escapeCell(i[r])+e.columnDelimiter),s+=n.map(function(e){return t._escapeCell(e)}).join(e.columnDelimiter)}),s}},{key:"_escapeCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(M.stringify)(t);return""!==n&&(e||n.indexOf(ml)>=0||n.indexOf(bl)>=0||n.indexOf(wl)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'.concat(n,'"')),n}}])&&pl(n.prototype,r),o&&pl(n,o),e}();var Ol,El,Sl,kl=(Sl=Cl,(El="csv")in(Ol={})?Object.defineProperty(Ol,El,{value:Sl,enumerable:!0,configurable:!0,writable:!0}):Ol[El]=Sl,Ol);function Rl(t){return(Rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ml(t,e){return!e||"object"!==Rl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _l(t){return(_l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nl(t,e){return(Nl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Al=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ml(this,_l(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nl(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}},{key:"exportAsBlob",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}},{key:"downloadFile",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.hot,r=n.rootDocument,o=n.rootWindow,i=this._createTypeFormatter(t,e),a=this._createBlob(i),s=o.URL||o.webkitURL,l=r.createElement("a"),u="".concat(i.options.filename,".").concat(i.options.fileExtension);if(void 0!==l.download){var c=s.createObjectURL(a);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(function(){s.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,u)}},{key:"_createTypeFormatter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!kl[t])throw new Error('Export format type "'.concat(t,'" is not supported.'));return function(t,e,n){return"function"==typeof kl[t]?new kl[t](e,n):null}(t,new ul(this.hot),e)}},{key:"_createBlob",value:function(t){var e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:"".concat(t.options.mimeType,";charset=").concat(t.options.encoding)})),e}}])&&Tl(n.prototype,r),o&&Tl(n,o),e}();Object(P.d)("exportFile",Al);var xl=Al;function jl(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Il(){Object(Vi.b)("Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously.")}var Dl="sort";function Pl(t){return(Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ll(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hl(t,e){return!e||"object"!==Pl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fl(t,e,n){return(Fl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bl(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Bl(t){return(Bl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wl(t,e){return(Wl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vl="multiColumnSorting";he(Vl,function(t,e){return function(n,r){var o=jl(n).slice(1),i=jl(r).slice(1);return function n(r){var a=t[r],s=e[r],l=o[r],u=i[r],c=s.multiColumnSorting,f=(c.compareFunctionFactory?c.compareFunctionFactory:pe(s.type))(a,s,c)(l,u);if(f===Ce){var h=r+1;if(void 0!==e[h])return n(h)}return f}(0)}});var Ul=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Hl(this,Bl(e).call(this,t))).pluginKey=Vl,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wl(t,e)}(e,Le),n=e,(r=[{key:"isEnabled",value:function(){return Fl(Bl(e.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){return!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings().columnSorting&&Il(),Fl(Bl(e.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){return Fl(Bl(e.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){return Fl(Bl(e.prototype),"sort",this).call(this,t)}},{key:"clearSort",value:function(){return Fl(Bl(e.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Fl(Bl(e.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(t){return Fl(Bl(e.prototype),"getSortConfig",this).call(this,t)}},{key:"setSortConfig",value:function(t){return Fl(Bl(e.prototype),"setSortConfig",this).call(this,t)}},{key:"getNormalizedSortConfigs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}},{key:"updateHeaderClasses",value:function(t){for(var n,r,o,i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];(n=Fl(Bl(e.prototype),"updateHeaderClasses",this)).call.apply(n,[this,t].concat(a)),Object(b.removeClass)(t,(r=t.className.split(" "),o=new RegExp("^".concat(Dl,"-[0-9]{1,2}$")),r.filter(function(t){return o.test(t)}))),!1!==this.enabled&&Object(b.addClass)(t,function(t,e,n){var r=[];return!1===n?r:(t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push("".concat(Dl,"-").concat(t.getIndexOfColumnInSortQueue(e)+1)),r)}.apply(void 0,a))}},{key:"onUpdateSettings",value:function(t){return this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings().columnSorting&&Il(),Fl(Bl(e.prototype),"onUpdateSettings",this).call(this,t)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==Gt(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(Object(xt.a)()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,"append"))):this.sort(this.getColumnNextConfig(e.col)))}}])&&Ll(n.prototype,r),o&&Ll(n,o),e}();Object(P.d)(Vl,Ul);var Yl,zl=Ul;n(129);function Gl(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Xl=function(t,e){return t._states["state_"+e]},ql=function(t,e,n){t._states["state_"+e]=n},Kl=(Gl(Yl={},"_states",{}),Gl(Yl,"getCachedState",function(t){return Xl(this,t)}),Gl(Yl,"setCachedState",function(t,e){ql(this,t,e)}),Gl(Yl,"saveState",function(t){ql(this,t,this.getState())}),Gl(Yl,"restoreState",function(t){this.setState(Xl(this,t))}),Gl(Yl,"hasSavedState",function(t){return void 0!==Xl(this,t)}),Gl(Yl,"clearState",function(t){ql(this,t)}),Gl(Yl,"clearStates",function(){this._states={}}),Yl);Object(N.defineGetter)(Kl,"MIXIN_NAME","stateSaver",{writable:!1,enumerable:!1});var $l=Kl;function Zl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ql=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.elements=[],this.hidden=!1}var e,n,r;return e=t,(n=[{key:"reset",value:function(){Object(w.arrayEach)(this.elements,function(t){return t.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hidden}},{key:"destroy",value:function(){this.clearLocalHooks(),Object(w.arrayEach)(this.elements,function(t){return t.destroy()}),this.elements=null,this.hot=null}}])&&Zl(e.prototype,n),r&&Zl(e,r),t}();Object(N.mixin)(Ql,Je.a),Object(N.mixin)(Ql,$l);var Jl=Ql,tu={};function eu(t,e){if(!tu[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));var n=tu[t],r=n.condition,o=n.descriptor,i=e;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(t){return r.apply(t.meta.instance,[].concat([t],[i]))}}function nu(t){if(!tu[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));return tu[t].descriptor}function ru(t,e,n){n.key=t,tu[t]={condition:e,descriptor:n}}ru("none",function(){return!0},{name:rn.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});var ou="empty";ru(ou,function(t){return""===t.value||null===t.value||void 0===t.value},{name:rn.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});function iu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ru("not_empty",function(t,e){return!eu(ou,e)(t)},{name:rn.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});var au="eq";ru(au,function(t,e){var n=iu(e,1)[0];return Object(M.stringify)(t.value).toLowerCase()===Object(M.stringify)(n)},{name:rn.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});function su(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ru("neq",function(t,e){return!eu(au,e)(t)},{name:rn.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});function lu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ru("gt",function(t,e){var n=su(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>n},{name:rn.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});function uu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ru("gte",function(t,e){var n=lu(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>=n},{name:rn.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});function cu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ru("lt",function(t,e){var n=uu(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<n},{name:rn.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});function fu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ru("lte",function(t,e){var n=cu(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<=n},{name:rn.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});var hu="date_after";function du(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ru(hu,function(t,e){var n=fu(e,1)[0],r=ie()(t.value,t.meta.dateFormat),o=ie()(n,t.meta.dateFormat);return!(!r.isValid()||!o.isValid())&&r.diff(o)>=0},{name:rn.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});var pu="date_before";function gu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ru(pu,function(t,e){var n=du(e,1)[0],r=ie()(t.value,t.meta.dateFormat),o=ie()(n,t.meta.dateFormat);return!(!r.isValid()||!o.isValid())&&r.diff(o)<=0},{name:rn.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});var vu="between";ru(vu,function(t,e){var n=gu(e,2),r=n[0],o=n[1];if("numeric"===t.meta.type){var i=parseFloat(r,10),a=parseFloat(o,10);r=Math.min(i,a),o=Math.max(i,a)}else if("date"===t.meta.type){var s=eu(pu,[o]),l=eu(hu,[r]);return s(t)&&l(t)}return t.value>=r&&t.value<=o},{name:rn.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});function yu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ru("not_between",function(t,e){return!eu(vu,e)(t)},{name:rn.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});ru("begins_with",function(t,e){var n=yu(e,1)[0];return Object(M.stringify)(t.value).toLowerCase().startsWith(Object(M.stringify)(n))},{name:rn.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});n(224);function mu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function bu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ru("ends_with",function(t,e){var n=mu(e,1)[0];return Object(M.stringify)(t.value).toLowerCase().endsWith(Object(M.stringify)(n))},{name:rn.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});var wu="contains";ru(wu,function(t,e){var n=bu(e,1)[0];return Object(M.stringify)(t.value).toLowerCase().indexOf(Object(M.stringify)(n))>=0},{name:rn.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});ru("not_contains",function(t,e){return!eu(wu,e)(t)},{name:rn.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});ru("date_tomorrow",function(t){var e=ie()(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(ie()().subtract(-1,"days").startOf("day"),"d")},{name:rn.FILTERS_CONDITIONS_TOMORROW,inputsCount:0});ru("date_today",function(t){var e=ie()(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(ie()().startOf("day"),"d")},{name:rn.FILTERS_CONDITIONS_TODAY,inputsCount:0});ru("date_yesterday",function(t){var e=ie()(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(ie()().subtract(1,"days").startOf("day"),"d")},{name:rn.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});Object(R.getComparisonFunction)();function Cu(t,e){var n=t;return""===n&&(n="(".concat(e,")")),n}var Ou=new Set([1]).has(1),Eu=Ou&&"function"==typeof Array.from;function Su(t){var e=t;return Ou&&(e=new Set(e)),function(t){return Ou?e.has(t):!!~e.indexOf(t)}}function ku(t){return null==t?"":t}function Ru(t){var e=t;return e=(e=Eu?Array.from(new Set(e)):Object(w.arrayUnique)(e)).sort(function(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1})}function Tu(t,e,n,r){var o,i=[],a=t===e;return a||(o=Su(e)),Object(w.arrayEach)(t,function(t){var e=!1;(a||o(t))&&(e=!0);var s={checked:e,value:t,visualValue:Cu(t,n)};r&&r(s),i.push(s)}),i}function Mu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ru("by_value",function(t,e){return(0,Mu(e,1)[0])(t.value)},{name:"By value",inputsCount:0,inputValuesDecorator:function(t){return[Su(Mu(t,1)[0])]},showOperators:!1});ru("true",function(){return!0},{name:"True"});ru("false",function(){return!1},{name:"False"});var _u={};function Nu(t,e,n){_u[t]={name:e,func:n}}Nu("conjunction",rn.FILTERS_LABELS_CONJUNCTION,function(t,e){return t.every(function(t){return t.func(e)})});Nu("disjunction",rn.FILTERS_LABELS_DISJUNCTION,function(t,e){return t.some(function(t){return t.func(e)})});var Au;function xu(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Nu("disjunctionWithExtraCondition",rn.FILTERS_LABELS_DISJUNCTION,function(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(function(t){return t.func(e)})&&t[t.length-1].func(e)});var ju="text",Iu=(xu(Au={},"numeric",["none",We,ou,"not_empty",We,au,"neq",We,"gt","gte","lt","lte",vu,"not_between"]),xu(Au,ju,["none",We,ou,"not_empty",We,au,"neq",We,"begins_with","ends_with",We,wu,"not_contains"]),xu(Au,"date",["none",We,ou,"not_empty",We,au,"neq",We,pu,hu,vu,We,"date_tomorrow","date_today","date_yesterday"]),Au);function Du(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pu(t,e,n){return e&&Du(t.prototype,e),n&&Du(t,n),t}var Lu=["click","input","keydown","keypress","keyup","focus","blur","change"],Hu=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.eventManager=new y.a(this),this.options=Object(N.extend)(t.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=!1}return Pu(t,null,[{key:"DEFAULTS",get:function(){return Object(N.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),Pu(t,[{key:"setValue",value:function(t){this.options.value=t,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"isBuilt",value:function(){return"built"===this.buildState}},{key:"translateIfPossible",value:function(t){return"string"==typeof t&&t.startsWith(rn.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(t):t}},{key:"build",value:function(){var t=this,e=function(e,n){t.eventManager.addEventListener(e,n,function(e){return t.runLocalHooks(n,e,t)})};if(this.buildState||(this.buildState="building"),this.options.className&&Object(b.addClass)(this._element,this.options.className),this.options.children.length)Object(w.arrayEach)(this.options.children,function(e){return t._element.appendChild(e.element)});else if(this.options.wrapIt){var n=this.hot.rootDocument.createElement(this.options.tagName);Object(N.objectEach)(this.options,function(e,r){void 0!==n[r]&&"className"!==r&&"tagName"!==r&&"children"!==r&&(n[r]=t.translateIfPossible(e))}),this._element.appendChild(n),Object(w.arrayEach)(Lu,function(t){return e(n,t)})}else Object(w.arrayEach)(Lu,function(n){return e(t._element,n)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}},{key:"element",get:function(){return"building"===this.buildState?this._element:"built"===this.buildState?(this.update(),this._element):(this.buildState="building",this.build(),this.buildState="built",this._element)}}]),t}();Object(N.mixin)(Hu,Je.a);var Fu=Hu;function Bu(t){return(Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Vu(t,e,n){return(Vu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Uu(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Uu(t){return(Uu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zu(t,e,n){return e&&Yu(t.prototype,e),n&&Yu(t,n),t}function Gu(t,e){return(Gu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xu=new WeakMap,qu=function(t){function e(t,n){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,r=!(i=Uu(e).call(this,t,Object(N.extend)(e.DEFAULTS,n)))||"object"!==Bu(i)&&"function"!=typeof i?Wu(o):i,Xu.set(Wu(r),{}),r.registerHooks(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gu(t,e)}(e,Fu),zu(e,null,[{key:"DEFAULTS",get:function(){return Object(N.clone)({placeholder:"",type:"text",tagName:"input"})}}]),zu(e,[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",function(){return t.onClick()}),this.addLocalHook("keyup",function(e){return t.onKeyup(e)})}},{key:"build",value:function(){Vu(Uu(e.prototype),"build",this).call(this);var t=Xu.get(this),n=this.hot.rootDocument.createElement("div");t.input=this._element.firstChild,Object(b.addClass)(this._element,"htUIInput"),Object(b.addClass)(n,"htUIInputIcon"),this._element.appendChild(n),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=Xu.get(this).input;t.type=this.options.type,t.placeholder=this.translateIfPossible(this.options.placeholder),t.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&Xu.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(t){this.options.value=t.target.value}}]),e}();function Ku(t){return(Ku="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zu(t,e,n){return(Zu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qu(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Qu(t){return(Qu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ju(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tc(t,e,n){return e&&Ju(t.prototype,e),n&&Ju(t,n),t}function ec(t,e){return(ec=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nc=new WeakMap,rc=function(t){function e(t,n){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,r=!(i=Qu(e).call(this,t,Object(N.extend)(e.DEFAULTS,n)))||"object"!==Ku(i)&&"function"!=typeof i?$u(o):i,nc.set($u(r),{}),r.menu=null,r.items=[],r.registerHooks(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ec(t,e)}(e,Fu),tc(e,null,[{key:"DEFAULTS",get:function(){return Object(N.clone)({className:"htUISelect",wrapIt:!1})}}]),tc(e,[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",function(){return t.onClick()})}},{key:"setItems",value:function(t){this.items=this.translateNames(t),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(t){var e=this;return Object(w.arrayEach)(t,function(t){t.name=e.translateIfPossible(t.name)}),t}},{key:"build",value:function(){var t=this;Zu(Qu(e.prototype),"build",this).call(this),this.menu=new Xn(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0}),this.menu.setMenuItems(this.items);var n=new Fu(this.hot,{className:"htUISelectCaption"}),r=new Fu(this.hot,{className:"htUISelectDropdown"}),o=nc.get(this);o.caption=n,o.captionElement=n.element,o.dropdown=r,Object(w.arrayEach)([n,r],function(e){return t._element.appendChild(e.element)}),this.menu.addLocalHook("select",function(e){return t.onMenuSelect(e)}),this.menu.addLocalHook("afterClose",function(){return t.onMenuClosed()}),this.update()}},{key:"update",value:function(){var t;this.isBuilt()&&(t=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(rn.FILTERS_CONDITIONS_NONE),nc.get(this).captionElement.textContent=t,Zu(Qu(e.prototype),"update",this).call(this))}},{key:"openOptions",value:function(){var t=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:t.left-5,top:t.top,width:t.width,height:t.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(t){t.name!==We&&(this.options.value=t,this.closeOptions(),this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var t=nc.get(this),n=t.caption,r=t.dropdown;n&&n.destroy(),r&&r.destroy(),Zu(Qu(e.prototype),"destroy",this).call(this)}}]),e}();function oc(t){return(oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ic(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ac(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sc(t,e){return!e||"object"!==oc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lc(t,e,n){return(lc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=uc(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function uc(t){return(uc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cc(t,e){return(cc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fc=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=sc(this,uc(e).call(this,t))).id=n.id,r.name=n.name,r.addSeparator=n.addSeparator,r.elements.push(new rc(r.hot)),r.elements.push(new qu(r.hot,{placeholder:rn.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),r.elements.push(new qu(r.hot,{placeholder:rn.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),r.registerHooks(),r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cc(t,e)}(e,Jl),n=e,(r=[{key:"registerHooks",value:function(){var t=this;this.getSelectElement().addLocalHook("select",function(e){return t.onConditionSelect(e)}),this.getSelectElement().addLocalHook("afterClose",function(){return t.onSelectUIClosed()}),Object(w.arrayEach)(this.getInputElements(),function(e){e.addLocalHook("keydown",function(e){return t.onInputKeyDown(e)})})}},{key:"setState",value:function(t){var e=this;if(this.reset(),t){var n=Object(N.clone)(t.command);n.name.startsWith(rn.FILTERS_CONDITIONS_NAMESPACE)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),Object(w.arrayEach)(t.args,function(t,r){if(r>n.inputsCount-1)return!1;var o=e.getInputElement(r);o.setValue(t),o[n.inputsCount>r?"show":"hide"](),r||setTimeout(function(){return o.focus()},10)})}}},{key:"getState",value:function(){var t=this.getSelectElement().getValue()||nu("none"),e=[];return Object(w.arrayEach)(this.getInputElements(),function(n,r){t.inputsCount>r&&e.push(n.getValue())}),{command:t,args:e}}},{key:"updateState",value:function(t,e){var n=nu(t?t.name:"none");this.setCachedState(e,{command:n,args:t?t.args:[]}),t||Object(w.arrayEach)(this.getInputElements(),function(t){return t.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(t){return t instanceof rc})[0]}},{key:"getInputElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}},{key:"getInputElements",value:function(){return this.elements.filter(function(t){return t instanceof qu})}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,r,o,i,a){Object(b.addClass)(n.parentNode,"htFiltersMenuCondition"),t.addSeparator&&Object(b.addClass)(n.parentNode,"border");var s=t.hot.rootDocument.createElement("div");return Object(b.addClass)(s,"htFiltersMenuLabel"),s.textContent=a,n.appendChild(s),n.parentNode.hasAttribute("ghost-table")||Object(w.arrayEach)(t.elements,function(t){return n.appendChild(t.element)}),n}}}},{key:"reset",value:function(){var t,n=this.hot.getPlugin("filters").getSelectedColumn(),r=n&&n.visualIndex,o=function(t){var e=[],n=t;return Iu[n]||(n=ju),Object(w.arrayEach)(Iu[n],function(t){var n;n=t===We?{name:We}:Object(N.clone)(nu(t)),e.push(n)}),e}((t=this.hot).getDataType.apply(t,ic(this.hot.getSelectedLast()||[0,r])));Object(w.arrayEach)(this.getInputElements(),function(t){return t.hide()}),this.getSelectElement().setItems(o),lc(uc(e.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(t){Object(w.arrayEach)(this.getInputElements(),function(e,n){e[t.inputsCount>n?"show":"hide"](),n||setTimeout(function(){return e.focus()},10)}),this.runLocalHooks("change",t)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(t){Object(j.isKey)(t.keyCode,"ENTER")?(this.runLocalHooks("accept"),Object(I.stopImmediatePropagation)(t)):Object(j.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(I.stopImmediatePropagation)(t))}}])&&ac(n.prototype,r),o&&ac(n,o),e}();function hc(t){return(hc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pc(t,e,n){return(pc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=gc(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function gc(t){return(gc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yc(t,e,n){return e&&vc(t.prototype,e),n&&vc(t,n),t}function mc(t,e){return(mc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bc=new WeakMap,wc=function(t){function e(t,n){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,r=!(i=gc(e).call(this,t,Object(N.extend)(e.DEFAULTS,n)))||"object"!==hc(i)&&"function"!=typeof i?dc(o):i,bc.set(dc(r),{}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mc(t,e)}(e,Fu),yc(e,null,[{key:"DEFAULTS",get:function(){return Object(N.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),yc(e,[{key:"build",value:function(){pc(gc(e.prototype),"build",this).call(this);var t=bc.get(this);t.input=this._element.firstChild;var n=this.hot.rootDocument.createElement("label");n.textContent=this.translateIfPossible(this.options.label.textContent),n.htmlFor=this.translateIfPossible(this.options.label.htmlFor),t.label=n,this._element.appendChild(n),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=bc.get(this);t.input.checked=this.options.checked,t.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=t,this.update()}},{key:"focus",value:function(){this.isBuilt()&&bc.get(this).input.focus()}}]),e}();function Cc(t){return(Cc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oc(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["Radio button with index "," doesn't exist."]);return Oc=function(){return t},t}function Ec(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Sc(t,e){return!e||"object"!==Cc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kc(t){return(kc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rc(t,e){return(Rc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tc=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Sc(this,kc(e).call(this,t))).id=n.id,r.name=n.name,r.buildOperatorsElement(),r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rc(t,e)}(e,Jl),n=e,(r=[{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n){return Object(b.addClass)(n.parentNode,"htFiltersMenuOperators"),n.parentNode.hasAttribute("ghost-table")||Object(w.arrayEach)(t.elements,function(t){return n.appendChild(t.element)}),n}}}},{key:"buildOperatorsElement",value:function(){var t=this,e=["conjunction","disjunction"];Object(w.arrayEach)(e,function(n){var r,o=new wc(t.hot,{name:"operator",label:{htmlFor:n,textContent:(r=n,_u[r].name)},value:n,checked:n===e[0],id:n});o.addLocalHook("change",function(e){return t.onRadioInputChange(e)}),t.elements.push(o)})}},{key:"setChecked",value:function(t){if(this.elements.length<t)throw Error(Object(Ii.a)(Oc(),t));Object(w.arrayEach)(this.elements,function(e,n){e.setChecked(n===t)})}},{key:"getActiveOperationId",value:function(){var t=this.elements.find(function(t){return t instanceof wc&&t.isChecked()});return t?t.getValue():"conjunction"}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(t){this.reset(),t&&this.getActiveOperationId()!==t&&Object(w.arrayEach)(this.elements,function(e){e.setChecked(e.getValue()===t)})}},{key:"updateState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"conjunction",e=arguments.length>1?arguments[1]:void 0,n=t;"disjunctionWithExtraCondition"===n&&(n="disjunction"),this.setCachedState(e,n)}},{key:"reset",value:function(){this.setChecked(0)}},{key:"onRadioInputChange",value:function(t){this.setState(t.realTarget.value)}}])&&Ec(n.prototype,r),o&&Ec(n,o),e}();n(225);function Mc(t){return(Mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Nc(t,e,n){return(Nc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ac(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ac(t){return(Ac=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jc(t,e,n){return e&&xc(t.prototype,e),n&&xc(t,n),t}function Ic(t,e){return(Ic=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Dc=new WeakMap,Pc=function(t){function e(t,n){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,r=!(i=Ac(e).call(this,t,Object(N.extend)(e.DEFAULTS,n)))||"object"!==Mc(i)&&"function"!=typeof i?_c(o):i,Dc.set(_c(r),{}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ic(t,e)}(e,Fu),jc(e,null,[{key:"DEFAULTS",get:function(){return Object(N.clone)({href:"#",tagName:"a"})}}]),jc(e,[{key:"build",value:function(){Nc(Ac(e.prototype),"build",this).call(this),Dc.get(this).link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(Dc.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}]),e}();function Lc(t){return(Lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hc(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Fc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bc(t,e,n){return(Bc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Wc(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Wc(t){return(Wc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Uc(t,e,n){return e&&Vc(t.prototype,e),n&&Vc(t,n),t}function Yc(t,e){return(Yc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zc=new WeakMap,Gc=function(t){function e(t,n){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,r=!(i=Wc(e).call(this,t,Object(N.extend)(e.DEFAULTS,n)))||"object"!==Lc(i)&&"function"!=typeof i?Fc(o):i,zc.set(Fc(r),{}),r.searchInput=new qu(r.hot,{placeholder:rn.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"}),r.selectAllUI=new Pc(r.hot,{textContent:rn.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"}),r.clearAllUI=new Pc(r.hot,{textContent:rn.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"}),r.items=[],r.itemsBox=null,r.registerHooks(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yc(t,e)}(e,Fu),Uc(e,null,[{key:"DEFAULTS",get:function(){return Object(N.clone)({className:"htUIMultipleSelect",value:[]})}}]),Uc(e,[{key:"registerHooks",value:function(){var t=this;this.searchInput.addLocalHook("keydown",function(e){return t.onInputKeyDown(e)}),this.searchInput.addLocalHook("input",function(e){return t.onInput(e)}),this.selectAllUI.addLocalHook("click",function(e){return t.onSelectAllClick(e)}),this.clearAllUI.addLocalHook("click",function(e){return t.onClearAllClick(e)})}},{key:"setItems",value:function(t){this.items=t,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"getItems",value:function(){return Hc(this.items)}},{key:"getValue",value:function(){return t=this.items,e=[],Object(w.arrayEach)(t,function(t){t.checked&&e.push(t.value)}),e;var t,e}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var t=this;Bc(Wc(e.prototype),"build",this).call(this);var n=this.hot.rootDocument,r=n.createElement("div"),o=new Fu(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(o.element),this._element.appendChild(r);var i=function(e){t._element&&(t.itemsBox&&t.itemsBox.destroy(),Object(b.addClass)(e,"htUIMultipleSelectHot"),t.itemsBox=new t.hot.constructor(e,{data:t.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(t,e,n,r,o,i){t.title=i.instance.getDataAtRowProp(e,i.label.property)},autoWrapCol:!0,height:110,colWidths:function(){return t.itemsBox.container.scrollWidth-Object(b.getScrollbarWidth)(n)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(e){return t.onItemsBoxBeforeKeyDown(e)}}),t.itemsBox.init())};i(r),setTimeout(function(){return i(r)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){var t,n,r;this.isBuilt()&&(this.itemsBox.loadData((t=this.items,n=this.options.value,r=Su(n),Object(w.arrayMap)(t,function(t){return t.checked=r(t.value),t}))),Bc(Wc(e.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Bc(Wc(e.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(t){var e,n=t.target.value.toLowerCase();e=""===n?Hc(this.items):Object(w.arrayFilter)(this.items,function(t){return"".concat(t.value).toLowerCase().indexOf(n)>=0}),this.itemsBox.loadData(e)}},{key:"onInputKeyDown",value:function(t){this.runLocalHooks("keydown",t,this),Object(T.partial)(j.isKey,t.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Object(I.stopImmediatePropagation)(t),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(t){var e=Object(T.partial)(j.isKey,t.keyCode);e("ESCAPE")&&this.runLocalHooks("keydown",t,this),e("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(Object(I.stopImmediatePropagation)(t),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(t){t.preventDefault(),Object(w.arrayEach)(this.itemsBox.getSourceData(),function(t){t.checked=!0}),this.itemsBox.render()}},{key:"onClearAllClick",value:function(t){t.preventDefault(),Object(w.arrayEach)(this.itemsBox.getSourceData(),function(t){t.checked=!1}),this.itemsBox.render()}}]),e}();function Xc(t){return(Xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Kc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $c(t,e){return!e||"object"!==Xc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zc(t,e,n){return(Zc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qc(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Qc(t){return(Qc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jc(t,e){return(Jc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tf=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=$c(this,Qc(e).call(this,t))).id=n.id,r.name=n.name,r.elements.push(new Gc(r.hot)),r.registerHooks(),r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jc(t,e)}(e,Jl),n=e,(r=[{key:"registerHooks",value:function(){var t=this;this.getMultipleSelectElement().addLocalHook("keydown",function(e){return t.onInputKeyDown(e)})}},{key:"setState",value:function(t){if(this.reset(),t&&"by_value"===t.command.key){var e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0])}}},{key:"getState",value:function(){var t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?"none":"by_value"},args:[t.getValue()],itemsSnapshot:e}}},{key:"updateState",value:function(t){var e=this,n=function(t,n,r,o,i){var a=qc(Object(w.arrayFilter)(n,function(t){return"by_value"===t.name}),1)[0],s={},l=e.hot.getTranslatedPhrase(rn.FILTERS_VALUES_BLANK_CELLS);if(a){var u=Object(w.arrayMap)(o(t,i),function(t){return t.value});u=Ru(u),r&&(a.args[0]=r);var c=[],f=Tu(u,a.args[0],l,function(t){t.checked&&c.push(t.value)});s.args=[c],s.command=nu("by_value"),s.itemsSnapshot=f}else s.args=[],s.command=nu("none");e.setCachedState(t,s)};n(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&n(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(t){return t instanceof Gc})[0]}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,r,o,i,a){Object(b.addClass)(n.parentNode,"htFiltersMenuValue");var s=t.hot.rootDocument.createElement("div");return Object(b.addClass)(s,"htFiltersMenuLabel"),s.textContent=a,n.appendChild(s),n.parentNode.hasAttribute("ghost-table")||Object(w.arrayEach)(t.elements,function(t){return n.appendChild(t.element)}),n}}}},{key:"reset",value:function(){var t=this.hot.getTranslatedPhrase(rn.FILTERS_VALUES_BLANK_CELLS),n=Ru(this._getColumnVisibleValues()),r=Tu(n,n,t);this.getMultipleSelectElement().setItems(r),Zc(Qc(e.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(n)}},{key:"onInputKeyDown",value:function(t){Object(j.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(I.stopImmediatePropagation)(t))}},{key:"_getColumnVisibleValues",value:function(){var t=this.hot.getPlugin("filters").getSelectedColumn(),e=t&&t.visualIndex;return Object(w.arrayMap)(this.hot.getDataAtCol(e),function(t){return ku(t)})}}])&&Kc(n.prototype,r),o&&Kc(n,o),e}();function ef(t){return(ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nf(t,e){return!e||"object"!==ef(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rf(t){return(rf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function of(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function af(t,e,n){return e&&of(t.prototype,e),n&&of(t,n),t}function sf(t,e){return(sf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lf=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=nf(this,rf(e).call(this,t))).id=n.id,r.name=n.name,r.elements.push(new qu(r.hot,{type:"button",value:rn.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:e.BUTTON_OK})),r.elements.push(new qu(r.hot,{type:"button",value:rn.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:e.BUTTON_CANCEL})),r.registerHooks(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sf(t,e)}(e,Jl),af(e,null,[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),af(e,[{key:"registerHooks",value:function(){var t=this;Object(w.arrayEach)(this.elements,function(e){e.addLocalHook("click",function(e,n){return t.onButtonClick(e,n)})})}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n){return Object(b.addClass)(n.parentNode,"htFiltersMenuActionBar"),n.parentNode.hasAttribute("ghost-table")||Object(w.arrayEach)(t.elements,function(t){return n.appendChild(t.element)}),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(t,n){n.options.identifier===e.BUTTON_OK?this.accept():this.cancel()}}]),e}();function uf(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["The column of index "," has been already applied with a `","`\n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones.\n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`,\n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\n        use it consequently for a particular column)."]);return uf=function(){return t},t}function cf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ff=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.conditions=this.initConditionsCollection(),this.columnTypes={},this.orderStack=[]}var e,n,r;return e=t,(n=[{key:"isEmpty",value:function(){return!this.orderStack.length}},{key:"isMatch",value:function(t,e){var n=this,r=!0;if(void 0===e)Object(N.objectEach)(this.columnTypes,function(e,o){return r=n.isMatchInConditions(n.conditions[e][o],t,e)});else{var o=this.columnTypes[e];r=this.isMatchInConditions(this.getConditions(e),t,o)}return r}},{key:"isMatchInConditions",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"conjunction";return!t.length||function(t){if(!_u[t])throw Error('Operation with id "'.concat(t,'" does not exist.'));var e=_u[t].func;return function(t,n){return e(t,n)}}(n)(t,e)}},{key:"addCondition",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"conjunction",r=Object(w.arrayMap)(e.args,function(t){return"string"==typeof t?t.toLowerCase():t}),o=e.name||e.command.key;this.runLocalHooks("beforeAdd",t),-1===this.orderStack.indexOf(t)&&this.orderStack.push(t);var i=this.columnTypes[t];if(i){if(i!==n)throw Error(Object(Ii.a)(uf(),t,i))}else{if(!this.conditions[n])throw new Error("Unexpected operation named `".concat(n,"`. Possible ones are `disjunction` and `conjunction`."));this.columnTypes[t]=n}this.getConditions(t).push({name:o,args:r,func:eu(o,r)}),this.runLocalHooks("afterAdd",t)}},{key:"getConditions",value:function(t){var e=this.columnTypes[t];return e?(this.conditions[e][t]||(this.conditions[e][t]=[]),this.conditions[e][t]):[]}},{key:"exportAllConditions",value:function(){var t=this,e=[];return Object(w.arrayEach)(this.orderStack,function(n){var r=Object(w.arrayMap)(t.getConditions(n),function(t){return{name:t.name,args:t.args}}),o=t.columnTypes[n];e.push({column:n,operation:o,conditions:r})}),e}},{key:"importAllConditions",value:function(t){var e=this;this.clean(),Object(w.arrayEach)(t,function(t){e.orderStack.push(t.column),Object(w.arrayEach)(t.conditions,function(n){return e.addCondition(t.column,n)})})}},{key:"removeConditions",value:function(t){this.runLocalHooks("beforeRemove",t),this.orderStack.indexOf(t)>=0&&this.orderStack.splice(this.orderStack.indexOf(t),1),this.clearConditions(t),this.runLocalHooks("afterRemove",t)}},{key:"clearConditions",value:function(t){this.runLocalHooks("beforeClear",t),this.getConditions(t).length=0,delete this.columnTypes[t],this.runLocalHooks("afterClear",t)}},{key:"hasConditions",value:function(t,e){if(!this.columnTypes[t])return!1;var n=this.getConditions(t);return e?Object(w.arrayFilter)(n,function(t){return t.name===e}).length>0:n.length>0}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.columnTypes=Object.create(null),this.orderStack.length=0,this.conditions=this.initConditionsCollection(),this.runLocalHooks("afterClean")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.conditions=null,this.orderStack=null,this.columnTypes=null}},{key:"initConditionsCollection",value:function(){var t=Object.create(null);return Object(N.objectEach)(_u,function(e,n){t[n]=Object.create(null)}),t}}])&&cf(e.prototype,n),r&&cf(e,r),t}();Object(N.mixin)(ff,Je.a);var hf=ff;function df(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var pf=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.conditionCollection=e,this.columnDataFactory=n}var e,n,r;return e=t,(n=[{key:"filter",value:function(){var t=this,e=[];return this.conditionCollection.isEmpty()||Object(w.arrayEach)(this.conditionCollection.orderStack,function(n,r){var o=t.columnDataFactory(n);r&&(o=t._getIntersectData(o,e)),e=t.filterByColumn(n,o)}),e}},{key:"filterByColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return Object(w.arrayEach)(n,function(n){void 0!==n&&e.conditionCollection.isMatch(n,t)&&r.push(n)}),r}},{key:"_getIntersectData",value:function(t,e){var n=[];return Object(w.arrayEach)(e,function(e){var r=e.meta.visualRow;void 0!==t[r]&&(n[r]=t[r])}),n}}])&&df(e.prototype,n),r&&df(e,r),t}();function gf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var vf=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.conditionCollection=e,this.columnDataFactory=r,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(t){return n._onConditionBeforeModify(t)}),this.conditionCollection.addLocalHook("afterAdd",function(t){return n.updateStatesAtColumn(t)}),this.conditionCollection.addLocalHook("afterClear",function(t){return n.updateStatesAtColumn(t)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}var e,n,r;return e=t,(n=[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var t=this;this.grouping=!1,Object(w.arrayEach)(this.changes,function(e){t.updateStatesAtColumn(e)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(t){this.latestEditedColumnPosition=this.conditionCollection.orderStack.indexOf(t)}},{key:"updateStatesAtColumn",value:function(t,e){var n=this;if(this.grouping)-1===this.changes.indexOf(t)&&this.changes.push(t);else{var r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.orderStack.indexOf(t);-1===o&&(o=this.latestEditedColumnPosition);var i=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===t&&a.shift();var s=Object(T.curry)(function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new hf,i=[].concat(t,r);o.importAllConditions(i);var a,s=n.columnDataFactory(e);a=o.isEmpty()?s:new pf(o,function(t){return n.columnDataFactory(t)}).filter();var l=Su(a=Object(w.arrayMap)(a,function(t){return t.meta.visualRow}));return Object(w.arrayFilter)(s,function(t){return l(t.meta.visualRow)})})(i),l=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:l},dependentConditionStacks:a,filteredRowsFactory:s,conditionArgsChange:e})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=[].concat(this.conditionCollection.orderStack)}},{key:"_onConditionAfterClean",value:function(){var t=this;Object(w.arrayEach)(this.latestOrderStack,function(e){t.updateStatesAtColumn(e)})}},{key:"destroy",value:function(){var t=this;this.clearLocalHooks(),Object(N.objectEach)(this,function(e,n){t[n]=null})}}])&&gf(e.prototype,n),r&&gf(e,r),t}();Object(N.mixin)(vf,Je.a);var yf=vf;function mf(t){return(mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bf(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["The filter conditions have been applied properly, but couldnt be displayed visually.\n        The overall amount of conditions exceed the capability of the dropdown menu.\n        For more details see the documentation."]);return bf=function(){return t},t}function wf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Cf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Of(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ef(t,e,n){return(Ef="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sf(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Sf(t){return(Sf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kf(t,e){return(kf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rf=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,o=Sf(e).call(this,t),(n=!o||"object"!==mf(o)&&"function"!=typeof o?Of(r):o).eventManager=new y.a(Of(n)),n.trimRowsPlugin=null,n.dropdownMenuPlugin=null,n.conditionCollection=null,n.conditionUpdateObserver=null,n.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),n.lastSelectedColumn=null,n.hiddenRowsCache=new Map,n.hot.addHook("afterGetColHeader",function(t,e){return n.onAfterGetColHeader(t,e)}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kf(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().filters}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var n=function(e){return e.addLocalHook("accept",function(){return t.onActionBarSubmit("accept")}),e.addLocalHook("cancel",function(){return t.onActionBarSubmit("cancel")}),e.addLocalHook("change",function(n){return t.onComponentChange(e,n)}),e};if(!this.components.get("filter_by_condition")){var r=new fc(this.hot,{id:"filter_by_condition",name:function(){return"".concat(t.hot.getTranslatedPhrase(rn.FILTERS_DIVS_FILTER_BY_CONDITION),":")},addSeparator:!1});r.addLocalHook("afterClose",function(){return t.onSelectUIClosed()}),this.components.set("filter_by_condition",n(r))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Tc(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var o=new fc(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0});o.addLocalHook("afterClose",function(){return t.onSelectUIClosed()}),this.components.set("filter_by_condition2",n(o))}this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new tf(this.hot,{id:"filter_by_value",name:function(){return"".concat(t.hot.getTranslatedPhrase(rn.FILTERS_DIVS_FILTER_BY_VALUE),":")}}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new lf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new hf),this.conditionUpdateObserver||(this.conditionUpdateObserver=new yf(this.conditionCollection,function(e){return t.getDataMapAtColumn(e)}),this.conditionUpdateObserver.addLocalHook("update",function(e){return t.updateComponents(e)})),this.components.forEach(function(t){t.show()}),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",function(e){return t.onBeforeDropdownMenuSetItems(e)}),this.addHook("afterDropdownMenuDefaultOptions",function(e){return t.onAfterDropdownMenuDefaultOptions(e)}),this.addHook("afterDropdownMenuShow",function(){return t.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return t.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(e){return t.onAfterChange(e)}),this.hot.getSettings().trimRows=!0,this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().dropdownMenu&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),Ef(Sf(e.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(e){return t.onTableClick(e)})}},{key:"disablePlugin",value:function(){this.enabled&&(this.dropdownMenuPlugin.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(t){t.hide()}),this.conditionCollection.clean(),this.trimRowsPlugin.untrimAll()),Ef(Sf(e.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"conjunction",o=this.t.toPhysicalColumn(t);this.conditionCollection.addCondition(o,{command:{key:e},args:n},r)}},{key:"removeConditions",value:function(t){var e=this.t.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}},{key:"clearConditions",value:function(t){if(void 0===t)this.conditionCollection.clean();else{var e=this.t.toPhysicalColumn(t);this.conditionCollection.clearConditions(e)}}},{key:"filter",value:function(){var t=this._createDataFilter(),e=!this.conditionCollection.isEmpty(),n=[],r=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",r))if(e){var o=[];this.trimRowsPlugin.trimmedRows.length=0;var i=Su(n=Object(w.arrayMap)(t.filter(),function(t){return t.meta.visualRow}));Object(_.rangeEach)(this.hot.countSourceRows()-1,function(t){i(t)||o.push(t)}),this.trimRowsPlugin.trimRows(o),n.length||this.hot.deselectCell()}else this.trimRowsPlugin.untrimAll();this.hot.view.wt.wtOverlays.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection(),this.hot.runHooks("afterFilter",r)}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var t=wf(this.hot.getSelectedLast()||[],2),e=t[0],n=t[1];void 0!==e&&void 0!==n&&this.hot.selectCell(e,n)}},{key:"getDataMapAtColumn",value:function(t){var e=this,n=this.t.toVisualColumn(t),r=[];return Object(w.arrayEach)(this.hot.getSourceDataAtCol(n),function(t,o){var i=e.hot.getCellMeta(o,n),a=i.row,s=i.col,l=i.visualCol,u=i.visualRow,c=i.type,f=i.instance,h=i.dateFormat;r.push({meta:{row:a,col:s,visualCol:l,visualRow:u,type:c,instance:f,dateFormat:h},value:ku(t)})}),r}},{key:"onAfterChange",value:function(t){var e=this;t&&Object(w.arrayEach)(t,function(t){var n=wf(t,2)[1],r=e.hot.propToCol(n);e.conditionCollection.hasConditions(r)&&e.updateValueComponentCondition(r)})}},{key:"updateValueComponentCondition",value:function(t){var e=Ru(this.hot.getDataAtCol(t));this.conditionUpdateObserver.updateStatesAtColumn(t,e)}},{key:"restoreComponents",value:function(t){var e=this.getSelectedColumn(),n=e&&e.physicalIndex;t.forEach(function(t){!1===t.isHidden()&&t.restoreState(n)})}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents([this.components.get("filter_by_condition"),this.components.get("filter_operators"),this.components.get("filter_by_condition2"),this.components.get("filter_by_value")])}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(t){var e=Object(w.arrayMap)(t,function(t){return t.key});this.components.forEach(function(t){t[-1===e.indexOf(t.getMenuItemDescriptor().key)?"hide":"show"]()}),this.initHiddenRowsCache()}},{key:"onAfterDropdownMenuDefaultOptions",value:function(t){t.items.push({name:We}),this.components.forEach(function(e){t.items.push(e.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(t,e,n,r){var o=t;return"disjunction"===o&&"none"!==e.command.key&&"none"!==n.command.key&&"none"!==r.command.key?o="disjunctionWithExtraCondition":"none"!==r.command.key&&("none"!==e.command.key&&"none"!==n.command.key||(o="conjunction")),o}},{key:"onActionBarSubmit",value:function(t){if("accept"===t){var e=this.getSelectedColumn(),n=e&&e.physicalIndex,r=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),i=this.components.get("filter_by_value").getState(),a=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,o,i);this.conditionUpdateObserver.groupChanges(),this.conditionCollection.clearConditions(n),"none"===r.command.key&&"none"===o.command.key&&"none"===i.command.key?this.conditionCollection.removeConditions(n):("none"!==r.command.key&&(this.conditionCollection.addCondition(n,r,a),"none"!==o.command.key&&this.conditionCollection.addCondition(n,o,a)),"none"!==i.command.key&&this.conditionCollection.addCondition(n,i,a)),this.conditionUpdateObserver.flush(),this.components.get("filter_operators").saveState(n),this.components.get("filter_by_value").saveState(n),this.saveHiddenRowsCache(n),this.trimRowsPlugin.trimmedRows.length=0,this.filter()}this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(t,e){t===this.components.get("filter_by_condition")&&(e.showOperators?this.showComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators")):this.hideComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators"))),t.constructor!==fc||e.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin.setListening()}},{key:"onAfterGetColHeader",value:function(t,e){var n=this.t.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?Object(b.addClass)(e,"htFiltersActive"):Object(b.removeClass)(e,"htFiltersActive")}},{key:"onTableClick",value:function(t){var e=Object(b.closest)(t.target,"TH");if(e){var n=this.hot.getCoords(e).col,r=this.t.toPhysicalColumn(n);this.lastSelectedColumn={visualIndex:n,physicalIndex:r}}}},{key:"destroy",value:function(){this.enabled&&(this.components.forEach(function(t){t.destroy()}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hiddenRowsCache.clear(),this.trimRowsPlugin.disablePlugin()),Ef(Sf(e.prototype),"destroy",this).call(this)}},{key:"_createDataFilter",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new pf(e,function(e){return t.getDataMapAtColumn(e)})}},{key:"updateComponents",value:function(t){if(this.dropdownMenuPlugin.enabled){var e=t.editedConditionStack.conditions,n=t.editedConditionStack.column,r=e.filter(function(t){return"by_value"===t.name}),o=e.filter(function(t){return"by_value"!==t.name}),i=this.conditionCollection.columnTypes[n];2===r.length||3===o.length?Object(Vi.b)(Object(Ii.a)(bf())):(o.length>0&&this.showComponentForParticularColumn(this.components.get("filter_operators"),n),this.components.get("filter_by_condition").updateState(o[0],n),this.components.get("filter_by_condition2").updateState(o[1],n),this.components.get("filter_by_value").updateState(t),this.components.get("filter_operators").updateState(i,n))}}},{key:"showComponentForParticularColumn",value:function(t,e){if(this.hiddenRowsCache.has(e)){var n=this.getIndexesOfComponents(t);this.removeIndexesFromHiddenRowsCache(e,n)}else this.hiddenRowsCache.set(e,[])}},{key:"removeIndexesFromHiddenRowsCache",value:function(t,e){var n=this.hiddenRowsCache.get(t);Object(w.arrayEach)(e,function(t){n.includes(t)&&n.splice(n.indexOf(t),1)})}},{key:"getIndexesOfComponents",value:function(){for(var t=this.dropdownMenuPlugin.menu,e=[],n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Object(w.arrayEach)(r,function(n){Object(w.arrayEach)(t.menuItems,function(t,r){t.key===n.getMenuItemDescriptor().key&&e.push(r)})}),e}},{key:"changeComponentsVisibility",value:function(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.dropdownMenuPlugin.menu.hotMenu,n=e.getPlugin("hiddenRows"),r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var a=this.getIndexesOfComponents.apply(this,o);t?n.showRows(a):n.hideRows(a),e.render()}},{key:"initHiddenRowsCache",value:function(){var t=this;this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){var e=t.lastSelectedColumn.physicalIndex;t.hiddenRowsCache.has(e)||t.hiddenRowsCache.set(e,t.getIndexesOfComponents(t.components.get("filter_operators"),t.components.get("filter_by_condition2"))),t.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:{rows:t.hiddenRowsCache.get(e)}})})}},{key:"saveHiddenRowsCache",value:function(t){this.hiddenRowsCache.set(t,this.dropdownMenuPlugin.menu.hotMenu.getPlugin("hiddenRows").hiddenRows)}},{key:"hideComponents",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(e))}},{key:"showComponents",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(e))}}])&&Cf(n.prototype,r),o&&Cf(n,o),e}();Object(P.d)("filters",Rf);var Tf=Rf;function Mf(t){return"string"==typeof t&&t.length>=2&&"="===t.charAt(0)}function _f(t){return"string"==typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function Nf(t){var e=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,n=t.match(e)||[],r=-1;return t.toUpperCase().replace(e,function(){return n[r+=1]})}function Af(t,e){return function(n){return{row:"row"===t?e:n.row,column:"column"===t?e:n.column}}}var xf=n(47);function jf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var If=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=Object(N.isObject)(e),o=Object(N.isObject)(n);this._row=r?e.index:e,this.rowAbsolute=!r||e.isAbsolute,this._column=o?n.index:n,this.columnAbsolute=!o||n.isAbsolute,this.rowOffset=0,this.columnOffset=0,Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(t){this._row=t},enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(t){this._column=t},enumerable:!0,configurable:!0})}var e,n,r;return e=t,(n=[{key:"translateTo",value:function(t,e){this.row=this.row+t,this.column=this.column+e}},{key:"isEqual",value:function(t){return t.row===this.row&&t.column===this.column}},{key:"toString",value:function(){return Object(xf.toLabel)({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}}])&&jf(e.prototype,n),r&&jf(e,r),t}();function Df(t){return(Df="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pf(t,e){return!e||"object"!==Df(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lf(t){return(Lf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ff(t,e,n){return e&&Hf(t.prototype,e),n&&Hf(t,n),t}function Bf(t,e){return(Bf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wf=[1,2,3],Vf=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Pf(this,Lf(e).call(this,t,n))).precedents=[],r.value=null,r.error=null,r.state=e.STATE_UP_TO_DATE,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bf(t,e)}(e,If),Ff(e,null,[{key:"STATE_OUT_OFF_DATE",get:function(){return 1}},{key:"STATE_COMPUTING",get:function(){return 2}},{key:"STATE_UP_TO_DATE",get:function(){return 3}}]),Ff(e,[{key:"setValue",value:function(t){this.value=t}},{key:"getValue",value:function(){return this.value}},{key:"setError",value:function(t){this.error=t}},{key:"getError",value:function(){return this.error}},{key:"hasError",value:function(){return null!==this.error}},{key:"setState",value:function(t){if(-1===Wf.indexOf(t))throw Error("Unrecognized state: ".concat(t));this.state=t}},{key:"isState",value:function(t){return this.state===t}},{key:"addPrecedent",value:function(t){if(this.isEqual(t))throw Error(xf.ERROR_REF);this.hasPrecedent(t)||this.precedents.push(t)}},{key:"removePrecedent",value:function(t){if(this.isEqual(t))throw Error(xf.ERROR_REF);this.precedents=Object(w.arrayFilter)(this.precedents,function(e){return!e.isEqual(t)})}},{key:"clearPrecedents",value:function(){this.precedents.length=0}},{key:"getPrecedents",value:function(){return this.precedents}},{key:"hasPrecedents",value:function(){return this.precedents.length>0}},{key:"hasPrecedent",value:function(t){return Object(w.arrayFilter)(this.precedents,function(e){return e.isEqual(t)}).length>0}}]),e}();function Uf(t){return(Uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zf(t,e){return!e||"object"!==Uf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gf(t){return(Gf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xf(t,e){return(Xf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qf=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),zf(this,Gf(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xf(t,e)}(e,If),n=e,(r=[{key:"toString",value:function(){return Object(xf.toLabel)({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}}])&&Yf(n.prototype,r),o&&Yf(n,o),e}();function Kf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.t=e,this.data=[],this.cellReferences=[]}var e,n,r;return e=t,(n=[{key:"getCellAt",value:function(t,e){var n=null;return Object(w.arrayEach)(this.data,function(r){if(r.row===t&&r.column===e)return n=r,!1}),n}},{key:"getOutOfDateCells",value:function(){return Object(w.arrayFilter)(this.data,function(t){return t.isState(Vf.STATE_OUT_OFF_DATE)})}},{key:"add",value:function(t){Object(w.arrayFilter)(this.data,function(e){return e.isEqual(t)}).length||this.data.push(t)}},{key:"remove",value:function(t){var e=Array.isArray(t);this.data=Object(w.arrayFilter)(this.data,function(n){return!function(t,n){var r=!1;return e?Object(w.arrayEach)(n,function(e){if(t.isEqual(e))return r=!0,!1}):r=t.isEqual(n),r}(n,t)})}},{key:"getDependencies",value:function(t){var e=this,n=function(t){return Object(w.arrayReduce)(e.data,function(e,n){return n.hasPrecedent(t)&&-1===e.indexOf(n)&&e.push(n),e},[])};return function t(r){var o=n(r);return o.length&&Object(w.arrayEach)(o,function(n){n.hasPrecedents()&&(o=o.concat(t(e.t.toVisual(n))))}),o}(t)}},{key:"registerCellRef",value:function(t){Object(w.arrayFilter)(this.cellReferences,function(e){return e.isEqual(t)}).length||this.cellReferences.push(t)}},{key:"removeCellRefsAtRange",value:function(t,e){var n=t.row,r=t.column,o=e.row,i=e.column,a=[];return this.cellReferences=Object(w.arrayFilter)(this.cellReferences,function(t){return!function(t){return void 0===n||t.row>=n&&t.row<=o}(t)||!function(t){return void 0===r||t.column>=r&&t.column<=i}(t)||(a.push(t),!1)}),a}},{key:"reset",value:function(){this.data.length=0,this.cellReferences.length=0}}])&&Kf(e.prototype,n),r&&Kf(e,r),t}();function Zf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Qf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Jf=/^\$?[A-Z]+\$?\d+$/,th=/\$?[A-Z]+\$?\d+/,eh=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,nh=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,rh=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,oh=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.expression="",this.cells=[],this.customModifier=null,"string"==typeof e&&this.setExpression(e)}var e,n,r;return e=t,(n=[{key:"setExpression",value:function(t){return this.cells.length=0,this.expression=Nf(t),this._extractCells(),this._extractCellsRange(),this}},{key:"useCustomModifier",value:function(t){this.customModifier=t}},{key:"translate",value:function(t){var e=this,n=t.row,r=t.column,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(w.arrayEach)(this.cells,function(t){null!=n&&e._translateCell(t,"row",n,o.row),null!=r&&e._translateCell(t,"column",r,o.column)}),this}},{key:"toString",value:function(){var t=this,e=this.expression.replace(rh,function(e,n,r){var o=-1===e.indexOf(":"),i=e,a=e,s=null;o&&(a=Jf.test(n)?n:r);var l=t._searchCell(a);return l&&(s=l.refError?Object(xf.error)(xf.ERROR_REF):l.toLabel(),i=o?e.replace(a,s):s),i});return e.startsWith("=")||(e="=".concat(e)),e}},{key:"_translateCell",value:function(t,e,n,r){var o=t.start,i=t.end,a=o[e].index,s=i[e].index,l=n,u=n,c=!1;if(this.customModifier){var f=Zf(this.customModifier(t,e,n,r),3);l=f[0],u=f[1],c=f[2]}else o[e].isAbsolute&&(l=0),i[e].isAbsolute&&(u=0);l&&!c&&(a+l<0&&(c=!0),o[e].index=Math.max(a+l,0)),u&&!c&&(s+u<0&&(c=!0),i[e].index=Math.max(s+u,0)),c&&(t.refError=!0)}},{key:"_extractCells",value:function(){var t=this,e=this.expression.match(eh);e&&Object(w.arrayEach)(e,function(e){var n=e.match(th);if(n){var r=Zf(Object(xf.extractLabel)(n[0]),2),o=r[0],i=r[1];t.cells.push(t._createCell({row:o,column:i},{row:o,column:i},n[0]))}})}},{key:"_extractCellsRange",value:function(){var t=this,e=this.expression.match(nh);e&&Object(w.arrayEach)(e,function(e){var n=Zf(e.split(":"),2),r=n[0],o=n[1],i=Zf(Object(xf.extractLabel)(r),2),a=i[0],s=i[1],l=Zf(Object(xf.extractLabel)(o),2),u={row:a,column:s},c={row:l[0],column:l[1]};t.cells.push(t._createCell(u,c,e))})}},{key:"_searchCell",value:function(t){return Zf(Object(w.arrayFilter)(this.cells,function(e){return e.origLabel===t}),1)[0]||null}},{key:"_createCell",value:function(t,e,n){return{start:t,end:e,origLabel:n,type:-1===n.indexOf(":")?"cell":"range",refError:!1,toLabel:function(){var t=Object(xf.toLabel)(this.start.row,this.start.column);return"range"===this.type&&(t+=":".concat(Object(xf.toLabel)(this.end.row,this.end.column))),t}}}}])&&Qf(e.prototype,n),r&&Qf(e,r),t}();Object(N.mixin)(oh,Je.a);var ih,ah=oh,sh="column_sorting";function lh(){var t=this.matrix,e=this.dataProvider;ih=new WeakMap,Object(w.arrayEach)(t.data,function(t){ih.set(t,e.t.toVisualRow(t.row))})}function uh(){var t=this.matrix,e=this.dataProvider;t.cellReferences.length=0,Object(w.arrayEach)(t.data,function(t){t.setState(Vf.STATE_OUT_OFF_DATE),t.clearPrecedents();var n=t.row,r=t.column,o=e.getSourceDataAtCell(n,r);if(Mf(o)){var i=ih.get(t),a=new ah(o);a.translate({row:e.t.toVisualRow(n)-i}),e.updateSourceData(n,r,a.toString())}}),ih=null}var ch="insert_column";function fh(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.matrix,o=this.dataProvider,i=[0,e];Object(w.arrayEach)(r.cellReferences,function(e){e.column>=t&&e.translateTo.apply(e,i)}),Object(w.arrayEach)(r.data,function(r){var a=r.row,s=r.column;if(r.column>=t&&(r.translateTo.apply(r,i),r.setState(Vf.STATE_OUT_OFF_DATE)),n){var l=r.row,u=r.column,c=o.getSourceDataAtCell(l,u);if(Mf(c)){var f=Af("column",t),h=new ah(c);h.useCustomModifier(hh),h.translate({column:e},f({row:a,column:s})),o.updateSourceData(l,u,h.toString())}}})}function hh(t,e,n,r){var o=t.start,i=t.end,a=n,s=n;return r>o[e].index&&(a=0),r>i[e].index&&(s=0),[a,s,!1]}var dh="insert_row";function ph(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.matrix,o=this.dataProvider,i=[e,0];Object(w.arrayEach)(r.cellReferences,function(e){e.row>=t&&e.translateTo.apply(e,i)}),Object(w.arrayEach)(r.data,function(r){var a=r.row,s=r.column;if(r.row>=t&&(r.translateTo.apply(r,i),r.setState(Vf.STATE_OUT_OFF_DATE)),n){var l=r.row,u=r.column,c=o.getSourceDataAtCell(l,u);if(Mf(c)){var f=Af("row",t),h=new ah(c);h.useCustomModifier(gh),h.translate({row:e},f({row:a,column:s})),o.updateSourceData(l,u,h.toString())}}})}function gh(t,e,n,r){var o=t.start,i=t.end,a=n,s=n;return r>o[e].index&&(a=0),r>i[e].index&&(s=0),[a,s,!1]}var vh="remove_column";function yh(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=-e,o=this.matrix,i=this.dataProvider,a=this.sheet,s=[0,r],l=Math.abs(r)-1,u=o.removeCellRefsAtRange({column:t},{column:t+l}),c=[];Object(w.arrayEach)(o.data,function(e){Object(w.arrayEach)(u,function(t){e.hasPrecedent(t)&&(e.removePrecedent(t),e.setState(Vf.STATE_OUT_OFF_DATE),Object(w.arrayEach)(a.getCellDependencies(e.row,e.column),function(t){t.setState(Vf.STATE_OUT_OFF_DATE)}))}),e.column>=t&&e.column<=t+l&&c.push(e)}),o.remove(c),Object(w.arrayEach)(o.cellReferences,function(e){e.column>=t&&e.translateTo.apply(e,s)}),Object(w.arrayEach)(o.data,function(e){var o=e.row,a=e.column;if(e.column>=t&&(e.translateTo.apply(e,s),e.setState(Vf.STATE_OUT_OFF_DATE)),n){var l=e.row,u=e.column,c=i.getSourceDataAtCell(l,u);if(Mf(c)){var f=Af("column",t),h=new ah(c);h.useCustomModifier(mh),h.translate({column:r},f({row:o,column:a})),i.updateSourceData(l,u,h.toString())}}})}function mh(t,e,n,r){var o=t.start,i=t.end,a=t.type,s=o[e].index,l=i[e].index,u=Math.abs(n)-1,c=n,f=n,h=!1;return s>=r&&l<=r+u&&(h=!0),h||"cell"!==a||r>=s&&(c=0,f=0),h||"range"!==a||(r>=s&&(c=0),r>l?f=0:l<=r+u&&(f-=Math.min(l-(r+u),0))),s+c<0&&(c-=s+c),[c,f,h]}var bh="remove_row";function wh(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=-e,o=this.matrix,i=this.dataProvider,a=this.sheet,s=[r,0],l=Math.abs(r)-1,u=o.removeCellRefsAtRange({row:t},{row:t+l}),c=[];Object(w.arrayEach)(o.data,function(e){Object(w.arrayEach)(u,function(t){e.hasPrecedent(t)&&(e.removePrecedent(t),e.setState(Vf.STATE_OUT_OFF_DATE),Object(w.arrayEach)(a.getCellDependencies(e.row,e.column),function(t){t.setState(Vf.STATE_OUT_OFF_DATE)}))}),e.row>=t&&e.row<=t+l&&c.push(e)}),o.remove(c),Object(w.arrayEach)(o.cellReferences,function(e){e.row>=t&&e.translateTo.apply(e,s)}),Object(w.arrayEach)(o.data,function(e){var o=e.row,a=e.column;if(e.row>=t&&(e.translateTo.apply(e,s),e.setState(Vf.STATE_OUT_OFF_DATE)),n){var l=e.row,u=e.column,c=i.getSourceDataAtCell(l,u);if(Mf(c)){var f=Af("row",t),h=new ah(c);h.useCustomModifier(Ch),h.translate({row:r},f({row:o,column:a})),i.updateSourceData(l,u,h.toString())}}})}function Ch(t,e,n,r){var o=t.start,i=t.end,a=t.type,s=o[e].index,l=i[e].index,u=Math.abs(n)-1,c=n,f=n,h=!1;return s>=r&&l<=r+u&&(h=!0),h||"cell"!==a||r>=s&&(c=0,f=0),h||"range"!==a||(r>=s&&(c=0),r>l?f=0:l<=r+u&&(f-=Math.min(l-(r+u),0))),s+c<0&&(c-=s+c),[c,f,h]}function Oh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Eh=new Map;Th(sh,o),Th(ch,i),Th(dh,a),Th(vh,s),Th(bh,l);var Sh=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sheet=e,this.hot=e.hot,this.dataProvider=e.dataProvider,this.matrix=e.matrix}var e,n,r;return e=t,(n=[{key:"prepareAlter",value:function(t){if(!Eh.has(t))throw Error('Alter operation "'.concat(t,'" not exist.'));for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];Eh.get(t).prepare.apply(this,n)}},{key:"triggerAlter",value:function(t){if(!Eh.has(t))throw Error('Alter operation "'.concat(t,'" not exist.'));for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];Eh.get(t).operate.apply(this,n),this.runLocalHooks.apply(this,["afterAlter"].concat(n))}},{key:"destroy",value:function(){this.sheet=null,this.hot=null,this.dataProvider=null,this.matrix=null}}])&&Oh(e.prototype,n),r&&Oh(e,r),t}();Object(N.mixin)(Sh,Je.a);var kh=Sh,Rh=function(){};function Th(t,e){Eh.has(t)||Eh.set(t,{prepare:e.prepare||Rh,operate:e.operate||Rh})}function Mh(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Nh=3,Ah=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.t=Object(D.a)(this.hot),this.dataProvider=n,this.parser=new xf.Parser,this.matrix=new $f(this.t),this.alterManager=new kh(this),this._processingCell=null,this._state=Nh,this.parser.on("callCellValue",function(){return r._onCallCellValue.apply(r,arguments)}),this.parser.on("callRangeValue",function(){return r._onCallRangeValue.apply(r,arguments)}),this.alterManager.addLocalHook("afterAlter",function(){return r._onAfterAlter.apply(r,arguments)})}var e,n,r;return e=t,(n=[{key:"recalculate",value:function(){switch(this._state){case Nh:this.recalculateFull();break;case 2:this.recalculateOptimized()}}},{key:"recalculateOptimized",value:function(){var t=this,e=this.matrix.getOutOfDateCells();Object(w.arrayEach)(e,function(e){var n=t.dataProvider.getSourceDataAtCell(e.row,e.column);Mf(n)&&t.parseExpression(e,n.substr(1))}),this._state=1,this.runLocalHooks("afterRecalculate",e,"optimized")}},{key:"recalculateFull",value:function(){var t=this,e=this.dataProvider.getSourceDataByRange();this.matrix.reset(),Object(w.arrayEach)(e,function(e,n){Object(w.arrayEach)(e,function(e,r){Mf(e)&&t.parseExpression(new Vf(n,r),e.substr(1))})}),this._state=1,this.runLocalHooks("afterRecalculate",e,"full")}},{key:"setVariable",value:function(t,e){this.parser.setVariable(t,e)}},{key:"getVariable",value:function(t){return this.parser.getVariable(t)}},{key:"applyChanges",value:function(t,e,n){this.matrix.remove({row:t,column:e}),Mf(n)&&this.parseExpression(new Vf(t,e),n.substr(1));var r=this.getCellDependencies.apply(this,Mh(this.t.toVisual(t,e)));Object(w.arrayEach)(r,function(t){t.setState(Vf.STATE_OUT_OFF_DATE)}),this._state=2}},{key:"parseExpression",value:function(t,e){t.setState(Vf.STATE_COMPUTING),this._processingCell=t;var n=this.parser.parse(Nf(e)),r=n.error,o=n.result;Mf(o)?this.parseExpression(t,o.substr(1)):(t.setValue(o),t.setError(r),t.setState(Vf.STATE_UP_TO_DATE)),this.matrix.add(t),this._processingCell=null}},{key:"getCellAt",value:function(t,e){return this.matrix.getCellAt(t,e)}},{key:"getCellDependencies",value:function(t,e){return this.matrix.getDependencies({row:t,column:e})}},{key:"_onCallCellValue",value:function(t,e){var n=t.row,r=t.column,o=new qf(n,r);if(!this.dataProvider.isInDataRange(o.row,o.column))throw Error(xf.ERROR_REF);this.matrix.registerCellRef(o),this._processingCell.addPrecedent(o);var i=this.dataProvider.getRawDataAtCell(n.index,r.index);if(Object(xf.error)(i)){var a=this.matrix.getCellAt(n.index,r.index);if(a&&a.hasError())throw Error(i)}if(Mf(i)){var s=this.parser.parse(i.substr(1)),l=s.error,u=s.result;if(l)throw Error(l);e(u)}else e(i)}},{key:"_onCallRangeValue",value:function(t,e,n){var r=this,o=t.row,i=t.column,a=e.row,s=e.column,l=this.dataProvider.getRawDataByRange(o.index,i.index,a.index,s.index);n(Object(w.arrayMap)(l,function(t,e){return function(t,e){return Object(w.arrayMap)(t,function(t,n){var a=o.index+e,s=i.index+n,l=new qf(a,s);if(!r.dataProvider.isInDataRange(l.row,l.column))throw Error(xf.ERROR_REF);r.matrix.registerCellRef(l),r._processingCell.addPrecedent(l);var u=t;if(Object(xf.error)(u)){var c=r.matrix.getCellAt(l.row,l.column);if(c&&c.hasError())throw Error(u)}if(Mf(u)){var f=r.parser.parse(u.substr(1)),h=f.error,d=f.result;if(h)throw Error(h);u=d}return u})}(t,e)}))}},{key:"_onAfterAlter",value:function(){this.recalculateOptimized()}},{key:"destroy",value:function(){this.hot=null,this.t=null,this.dataProvider.destroy(),this.dataProvider=null,this.alterManager.destroy(),this.alterManager=null,this.parser=null,this.matrix.reset(),this.matrix=null}}])&&_h(e.prototype,n),r&&_h(e,r),t}();Object(N.mixin)(Ah,Je.a);var xh=Ah;function jh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ih(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Dh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ph=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.changes={},this.t=Object(D.a)(this.hot)}var e,n,r;return e=t,(n=[{key:"collectChanges",value:function(t,e,n){this.changes[this._coordId(t,e)]=n}},{key:"clearChanges",value:function(){this.changes={}}},{key:"isInDataRange",value:function(t,e){return t>=0&&t<this.hot.countRows()&&e>=0&&e<this.hot.countCols()}},{key:"getDataAtCell",value:function(t,e){var n=this._coordId.apply(this,Ih(this.t.toPhysical(t,e)));return Object(N.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getDataAtCell(t,e)}},{key:"getDataByRange",value:function(t,e,n,r){var o=this,i=this.hot.getData(t,e,n,r);return Object(w.arrayEach)(i,function(n,r){Object(w.arrayEach)(n,function(n,a){var s=o._coordId.apply(o,Ih(o.t.toPhysical(r+t,a+e)));Object(N.hasOwnProperty)(o.changes,s)&&(i[r][a]=o.changes[s])})}),i}},{key:"getSourceDataAtCell",value:function(t,e){var n=this._coordId(t,e);return Object(N.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getSourceDataAtCell(t,e)}},{key:"getSourceDataByRange",value:function(t,e,n,r){return this.hot.getSourceDataArray(t,e,n,r)}},{key:"getRawDataAtCell",value:function(t,e){return this.getSourceDataAtCell.apply(this,Ih(this.t.toPhysical(t,e)))}},{key:"getRawDataByRange",value:function(t,e,n,r){var o=this,i=[];return Object(_.rangeEach)(t,n,function(t){var n=[];Object(_.rangeEach)(e,r,function(e){var r=jh(o.t.toPhysical(t,e),2),i=r[0],a=r[1],s=o._coordId(i,a);Object(N.hasOwnProperty)(o.changes,s)?n.push(o.changes[s]):n.push(o.getSourceDataAtCell(i,a))}),i.push(n)}),i}},{key:"updateSourceData",value:function(t,e,n){this.hot.getSourceData()[t][this.hot.colToProp(e)]=n}},{key:"_coordId",value:function(t,e){return"".concat(t,":").concat(e)}},{key:"destroy",value:function(){this.hot=null,this.changes=null,this.t=null}}])&&Dh(e.prototype,n),r&&Dh(e,r),t}();function Lh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Hh=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.items=e}var e,n,r;return e=t,(n=[{key:"push",value:function(){var t;(t=this.items).push.apply(t,arguments)}},{key:"pop",value:function(){return this.items.pop()}},{key:"peek",value:function(){return this.isEmpty()?void 0:this.items[this.items.length-1]}},{key:"isEmpty",value:function(){return!this.size()}},{key:"size",value:function(){return this.items.length}}])&&Lh(e.prototype,n),r&&Lh(e,r),t}();function Fh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Bh=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sheet=e,this.stack=new Hh}var e,n,r;return e=t,(n=[{key:"save",value:function(t,e,n){var r=this.sheet,o=r.matrix,i=r.dataProvider,a=[];Object(w.arrayEach)(o.data,function(r){var o=r.row,s=r.column;if(r[t]<e||r[t]>e+(n-1)){var l=i.getSourceDataAtCell(o,s);a.push({row:o,column:s,value:l})}}),this.stack.push({axis:t,index:e,amount:n,changes:a})}},{key:"restore",value:function(){var t=this.sheet,e=t.matrix,n=t.dataProvider,r=this.stack.pop(),o=r.axis,i=r.index,a=r.amount,s=r.changes;s&&Object(w.arrayEach)(s,function(t){t[o]>i+(a-1)&&(t[o]-=a);var r=t.row,s=t.column,l=t.value;n.getSourceDataAtCell(r,s)!==l&&(n.updateSourceData(r,s,l),e.getCellAt(r,s).setState(Vf.STATE_OUT_OFF_DATE))})}},{key:"destroy",value:function(){this.sheet=null,this.stack=null}}])&&Fh(e.prototype,n),r&&Fh(e,r),t}();function Wh(t){return(Wh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Uh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zh(t,e,n){return(zh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gh(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Gh(t){return(Gh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xh(t,e){return(Xh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qh=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=Gh(e).call(this,t))||"object"!==Wh(o)&&"function"!=typeof o?Yh(r):o).eventManager=new y.a(Yh(n)),n.dataProvider=new Ph(n.hot),n.sheet=new xh(n.hot,n.dataProvider),n.undoRedoSnapshot=new Bh(n.sheet),n._skipRendering=!1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xh(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().formulas}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().formulas;Object(N.isObject)(n)&&Object(N.isObject)(n.variables)&&Object(N.objectEach)(n.variables,function(e,n){return t.setVariable(n,e)}),this.addHook("afterColumnSort",function(){return t.onAfterColumnSort.apply(t,arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol.apply(t,arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow.apply(t,arguments)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData()}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol.apply(t,arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow.apply(t,arguments)}),this.addHook("afterSetDataAtCell",function(){return t.onAfterSetDataAtCell.apply(t,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return t.onAfterSetDataAtCell.apply(t,arguments)}),this.addHook("beforeColumnSort",function(){return t.onBeforeColumnSort.apply(t,arguments)}),this.addHook("beforeCreateCol",function(){return t.onBeforeCreateCol.apply(t,arguments)}),this.addHook("beforeCreateRow",function(){return t.onBeforeCreateRow.apply(t,arguments)}),this.addHook("beforeRemoveCol",function(){return t.onBeforeRemoveCol.apply(t,arguments)}),this.addHook("beforeRemoveRow",function(){return t.onBeforeRemoveRow.apply(t,arguments)}),this.addHook("beforeValidate",function(){return t.onBeforeValidate.apply(t,arguments)}),this.addHook("beforeValueRender",function(){return t.onBeforeValueRender.apply(t,arguments)}),this.addHook("modifyData",function(){return t.onModifyData.apply(t,arguments)}),this.sheet.addLocalHook("afterRecalculate",function(){return t.onSheetAfterRecalculate.apply(t,arguments)}),zh(Gh(e.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){zh(Gh(e.prototype),"disablePlugin",this).call(this)}},{key:"getCellValue",value:function(t,e){var n=this.sheet.getCellAt(t,e);return n?n.getError()||n.getValue():void 0}},{key:"hasComputedCellValue",value:function(t,e){return null!==this.sheet.getCellAt(t,e)}},{key:"recalculate",value:function(){this.sheet.recalculate()}},{key:"recalculateFull",value:function(){this.sheet.recalculateFull()}},{key:"recalculateOptimized",value:function(){this.sheet.recalculateOptimized()}},{key:"setVariable",value:function(t,e){this.sheet.setVariable(t,e)}},{key:"getVariable",value:function(t){return this.sheet.getVariable(t)}},{key:"onSheetAfterRecalculate",value:function(t){if(this._skipRendering)this._skipRendering=!1;else{var e=this.hot;Object(w.arrayEach)(t,function(t){var n=t.row,r=t.column;e.validateCell(e.getDataAtCell(n,r),e.getCellMeta(n,r),function(){})}),e.render()}}},{key:"onModifyData",value:function(t,e,n,r){"get"===r&&this.hasComputedCellValue(t,e)?n.value=this.getCellValue(t,e):"set"===r&&Mf(n.value)&&(n.value=Nf(n.value))}},{key:"onBeforeValueRender",value:function(t){var e,n=t;return _f(n)&&(n=_f(e=n)?e.substr(1):e),n}},{key:"onBeforeValidate",value:function(t,e,n){var r=this.hot.propToCol(n),o=t;return this.hasComputedCellValue(e,r)&&(o=this.getCellValue(e,r)),o}},{key:"onAfterSetDataAtCell",value:function(t,e){var n=this;"loadData"!==e&&(this.dataProvider.clearChanges(),Object(w.arrayEach)(t,function(t){var e=Vh(t,4),r=e[0],o=e[1],i=e[2],a=e[3],s=n.hot.propToCol(o),l=n.t.toPhysicalRow(r),u=a;Mf(u)&&(u=Nf(u)),n.dataProvider.collectChanges(l,s,u),i!==u&&n.sheet.applyChanges(l,s,u)}),this.recalculate())}},{key:"onBeforeCreateRow",value:function(t,e,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateRow",value:function(t,e,n){this.sheet.alterManager.triggerAlter("insert_row",t,e,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveRow",value:function(t,e){this.undoRedoSnapshot.save("row",t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.sheet.alterManager.triggerAlter("remove_row",t,e)}},{key:"onBeforeCreateCol",value:function(t,e,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateCol",value:function(t,e,n){this.sheet.alterManager.triggerAlter("insert_column",t,e,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveCol",value:function(t,e){this.undoRedoSnapshot.save("column",t,e)}},{key:"onAfterRemoveCol",value:function(t,e){this.sheet.alterManager.triggerAlter("remove_column",t,e)}},{key:"onBeforeColumnSort",value:function(t,e){this.sheet.alterManager.prepareAlter("column_sorting",t,e)}},{key:"onAfterColumnSort",value:function(t,e){this.sheet.alterManager.triggerAlter("column_sorting",t,e)}},{key:"onAfterLoadData",value:function(){this._skipRendering=!0,this.recalculateFull()}},{key:"destroy",value:function(){this.dataProvider.destroy(),this.dataProvider=null,this.sheet.destroy(),this.sheet=null,zh(Gh(e.prototype),"destroy",this).call(this)}}])&&Uh(n.prototype,r),o&&Uh(n,o),e}();Object(P.d)("formulas",qh);var Kh=qh,$h=7;function Zh(t,e){return{name:t,days:$h,daysBeforeFullWeeks:0,daysAfterFullWeeks:0,fullWeeks:1,index:e}}function Qh(t,e){var n=Jh(e[t].name),r=t>0?Jh(e[t-1].name):null,o=Jh(e[0].name),i=Jh(e[e.length-1].name);return t>0?"".concat(r,"/").concat(n):t===e.length-1?"".concat(n,"/").concat(o):"".concat(i,"/").concat(n)}function Jh(t){return t.substring(0,3)}function td(t){return nd(Array.isArray(t)?t[1]:t.startDate)}function ed(t){return nd(Array.isArray(t)?t[2]:t.endDate)}function nd(t){var e=t;return null===e?null:e instanceof Date||"Invalid Date"!==(e=new Date(e)).toString()?e:null}function rd(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function od(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var id=function(){function t(e){var n=e.year,r=e.allowSplitWeeks,o=void 0===r||r,i=e.hideDaysBeforeFullWeeks,a=void 0!==i&&i,s=e.hideDaysAfterFullWeeks,l=void 0!==s&&s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.year=n,this.firstWeekDay="monday",this.allowSplitWeeks=o,this.hideDaysBeforeFullWeeks=a,this.hideDaysAfterFullWeeks=l,this.weekSectionCount=0,this.monthListCache={},this.daysInColumns={},this.calculateWeekStructure()}var e,n,r;return e=t,(n=[{key:"setYear",value:function(t){this.year=t,this.monthListCache[t]=this.calculateMonthData(t),this.calculateWeekStructure(t)}},{key:"setFirstWeekDay",value:function(t){var e=t.toLowerCase();"monday"!==e&&"sunday"!==e&&Object(Vi.b)("First day of the week must be set to either Monday or Sunday"),this.firstWeekDay=e,this.calculateWeekStructure()}},{key:"countWeekSections",value:function(){return this.weekSectionCount}},{key:"getFirstWeekDay",value:function(){return this.firstWeekDay}},{key:"getYear",value:function(){return this.year}},{key:"getMonthList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.year;return this.monthListCache[t]||(this.monthListCache[t]=this.calculateMonthData(t)),this.monthListCache[t]}},{key:"getFullMonthList",value:function(){return this.monthListCache}},{key:"dateToColumn",value:function(t){var e=nd(t);if(!e)return!1;var n=e.getMonth(),r=e.getDate()-1,o=e.getFullYear();return this.getWeekColumn(r,n,o)}},{key:"getWeekColumn",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getYear(),r=null,o=this.getMonthCacheArray(e,n);return Object(w.arrayEach)(o,function(e){if(Object(N.objectEach)(e,function(e,n){if(e.indexOf(t+1)>-1)return r=parseInt(n,10),!1}),r)return!1}),r}},{key:"getMonthCacheArray",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear(),r=this.getMonthList(n),o=[];if(this.allowSplitWeeks)o.push(this.daysInColumns[n][t]);else{var i=-1;Object(N.objectEach)(this.daysInColumns[n],function(a,s){var l=r[s];if(Object.keys(a).length>1&&(i+=1),i===t)return l.daysBeforeFullWeeks>0&&o.push(e.daysInColumns[n][parseInt(s,10)-1]),o.push(a),l.daysAfterFullWeeks>0&&o.push(e.daysInColumns[n][parseInt(s,10)+1]),!1})}return o}},{key:"columnToDate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear(),n=null;Object(N.objectEach)(this.daysInColumns[e],function(e,r){if(e[t])return n=r,!1});var r=this.daysInColumns[e][n][t];if(1===r.length){var o=new Date(e,n,r[0]);return{start:o,end:o}}return{start:new Date(e,n,r[0]),end:new Date(e,n,r[r.length-1])}}},{key:"isOnTheEdgeOfWeek",value:function(t){var e=this,n=nd(t);if(!n)return null;var r=n.getMonth(),o=n.getDate()-1,i=n.getFullYear(),a=this.getMonthCacheArray(r,i),s=!1;return Object(w.arrayEach)(a,function(t){if(Object(N.objectEach)(t,function(t){if(!e.allowSplitWeeks&&7!==t.length&&(0===o||o===new Date(n.getYear(),n.getMonth()+1,0).getDate()-1))return!0;var r=t.indexOf(o+1);return 0===r?(s=[1,0],!1):r===t.length-1?(s=[0,1],!1):void 0}),s)return!1}),s}},{key:"generateHeaderSet",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.year,o=this.getMonthList(r),i=[];return Object(N.objectEach)(o,function(o,a){var s=o.daysBeforeFullWeeks>0?1:0,l=o.daysAfterFullWeeks>0?1:0,u=n.hideDaysBeforeFullWeeks?0:s,c=n.hideDaysAfterFullWeeks?0:l,f=o.fullWeeks+(n.allowSplitWeeks?u+c:0),h=parseInt(a,10),d="";if("months"===t)i.push({label:o.name,colspan:f});else if("weeks"===t)for(var p=0;p<f;p++){var g=null,v=null;if(n.allowSplitWeeks||1!==o.fullWeeks){var y=rd(n.getWeekColumnRange({monthObject:o,monthNumber:h,headerIndex:p,areDaysBeforeFullWeeksVisible:u,areDaysAfterFullWeeksVisible:c,headerCount:f,year:r}),2);g=y[0],v=y[1]}else{var m=rd(n.getWeekColumnRange({monthObject:o,monthNumber:h,headerIndex:p,headerCount:f,areDaysBeforeFullWeeksVisible:u,areDaysAfterFullWeeksVisible:c,mixedMonth:!0,year:r}),2);g=m[0],v=m[1]}d=g===v?"".concat(g):"".concat(g," -  ").concat(v),i.push(e?e.call(n,g,v):d),n.addDaysToCache(h,i.length-1,g,v,r)}}),i}},{key:"getWeekColumnRange",value:function(t){var e=t.monthObject,n=t.monthNumber,r=t.headerIndex,o=t.headerCount,i=t.areDaysBeforeFullWeeksVisible,a=t.areDaysAfterFullWeeksVisible,s=t.mixedMonth,l=void 0!==s&&s,u=t.year,c=void 0===u?this.year:u,f=this.getMonthList(c),h=this.allowSplitWeeks,d=null,p=null;return l?0===n?(p=f[n+1].daysBeforeFullWeeks,d=31-($h-p)+1):n===f.length-1?(p=$h-f[n-1].daysAfterFullWeeks,d=f[n-1].days-f[n-1].daysAfterFullWeeks+1):(p=f[n+1].daysBeforeFullWeeks,d=f[n-1].days-($h-p)+1):h&&i&&0===r?(d=r+1,p=e.daysBeforeFullWeeks):h&&a&&r===o-1?(d=e.days-e.daysAfterFullWeeks+1,p=e.days):(d=null,p=(d=h?e.daysBeforeFullWeeks+(r-i)*$h+1:e.daysBeforeFullWeeks+r*$h+1)+$h-1),[d,p]}},{key:"addDaysToCache",value:function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getYear();if(this.daysInColumns[o]||(this.daysInColumns[o]={}),this.daysInColumns[o][t]||(this.daysInColumns[o][t]={}),this.daysInColumns[o][t][e]||(this.daysInColumns[o][t][e]=[]),n<=r)for(var i=n;i<=r;i++)this.daysInColumns[o][t][e].push(i);else{for(var a=t-1>=0?this.countMonthDays(t):31,s=n;s<=a;s++)this.daysInColumns[o][t][e].push(s);for(var l=1;l<=r;l++)this.daysInColumns[o][t][e].push(l)}}},{key:"isValidRangeBarData",value:function(t,e){var n=nd(t),r=nd(e);return n&&r&&n.getTime()<=r.getTime()}},{key:"calculateMonthData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.year;return[{name:"January",days:31},{name:"February",days:new Date(t,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}].slice(0)}},{key:"countMonths",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getYear();return this.monthListCache[t].length}},{key:"countMonthDays",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear();return this.monthListCache[e][t-1].days}},{key:"countMonthFullWeeks",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear();return this.monthListCache[e][t-1].fullWeeks}},{key:"calculateWeekStructure",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getYear();this.monthListCache[e]=this.calculateMonthData(e);var n=this.getFirstWeekDay(),r=this.getMonthList(e),o=[],i=this.hideDaysBeforeFullWeeks?0:1,a=this.hideDaysAfterFullWeeks?0:1,s=0,l=0;"monday"===n&&(s=1),Object(w.arrayEach)(r,function(n,u){var c=new Date(e,u,1).getDay(),f=0;if(n.daysBeforeFullWeeks=(7-c+s)%7,!t.allowSplitWeeks&&n.daysBeforeFullWeeks&&(o.push(Zh(Qh(u,r),u)),f+=1),n.fullWeeks=Math.floor((n.days-n.daysBeforeFullWeeks)/7),n.daysAfterFullWeeks=n.days-n.daysBeforeFullWeeks-7*n.fullWeeks,t.allowSplitWeeks){var h=i*(n.daysBeforeFullWeeks?1:0),d=a*(n.daysAfterFullWeeks?1:0);l+=n.fullWeeks+h+d}else u===r.length-1&&n.daysAfterFullWeeks&&(o.push(Zh(Qh(u,r),null)),f+=1),l+=n.fullWeeks+f}),Object(w.arrayEach)(o,function(n,r){var o=n.index;delete n.index,t.addMixedMonth(null===o?o:r+o,n,e)}),e===this.getYear()&&(this.weekSectionCount=l)}},{key:"addMixedMonth",value:function(t,e,n){null===t?this.monthListCache[n].push(e):this.monthListCache[n].splice(t,0,e)}}])&&od(e.prototype,n),r&&od(e,r),t}();function ad(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var sd=function(){function t(e,n,r,o,i,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=n,this.chartInstance=e,this.chartPlugin=this.chartInstance.getPlugin("ganttChart"),this.hotSource=null,this.sourceHooks={},this.ongoingAsync=!1,this.applyData(n,r,o,i,a||!1)}var e,n,r;return e=t,(n=[{key:"applyData",value:function(t,e,n,r,o){if("[object Array]"===Object.prototype.toString.call(t))t.length>1&&this.chartInstance.alter("insert_row",0,t.length-1,"".concat(this.pluginName,".loadData")),this.loadData(t);else if(t instanceof this.chartInstance.constructor){var i=t.countRows();i>1&&this.chartInstance.alter("insert_row",0,i-1,"".concat(this.pluginName,".loadData")),this.bindWithHotInstance(t,e,n,r,o)}}},{key:"bindWithHotInstance",value:function(t,e,n,r,o){this.hotSource={instance:t,startColumn:e,endColumn:n,additionalData:r,asyncUpdates:o},this.addSourceHotHooks(),this.asyncCall(this.updateFromSource)}},{key:"asyncCall",value:function(t){var e=this;this.hotSource.asyncUpdates?(this.asyncStart(),setTimeout(function(){t.call(e),e.asyncEnd()},0)):t.call(this)}},{key:"asyncStart",value:function(){this.ongoingAsync=!0}},{key:"asyncEnd",value:function(){this.ongoingAsync=!1}},{key:"addSourceHotHooks",value:function(){var t=this;this.sourceHooks={afterLoadData:function(){return t.onAfterSourceLoadData()},afterChange:function(e){return t.onAfterSourceChange(e)},afterColumnSort:function(){return t.onAfterColumnSort()}},this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData),this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange),this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"removeSourceHotHooks",value:function(t){this.sourceHooks.afterLoadData&&t.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData),this.sourceHooks.afterChange&&t.instance.removeHook("afterChange",this.sourceHooks.afterChange),this.sourceHooks.afterColumnSort&&t.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"getDataFromSource",value:function(t){var e,n={},r=this.hotSource,o=[];void 0===t?e=r.instance.getData(0,0,r.instance.countRows()-1,r.instance.countCols()-1):(e=[])[t]=r.instance.getDataAtRow(t);for(var i=function(t,i){n={};var a=e[t];if(null===a[r.startColumn]||""===a[r.startColumn])return"continue";Object(N.objectEach)(r.additionalData,function(t,e){n[e]=a[t]}),o.push([t,a[r.startColumn],a[r.endColumn],n,t])},a=t||0,s=e.length;a<(t?t+1:s);a++)i(a);return o}},{key:"updateFromSource",value:function(t){var e=this.getDataFromSource(t);!t&&isNaN(t)&&(this.chartPlugin.clearRangeBars(),this.chartPlugin.clearRangeList()),this.loadData(e),this.chartInstance.render()}},{key:"loadData",value:function(t){var e=this,n=[];Object(w.arrayEach)(t,function(t,r){t.row=r;var o=e.splitRangeIfNeeded(t);n=n.concat(o)}),Object(w.arrayEach)(n,function(t){var n;e.chartPlugin.addRangeBar(t.row,td(t),ed(t),(n=t,Array.isArray(n)?n[3]:n.additionalData)),delete t.row})}},{key:"splitRangeIfNeeded",value:function(t){var e=[],n=new Date(td(t)),r=new Date(ed(t));if("string"==typeof n||"string"==typeof r)return!1;var o=n.getFullYear(),i=r.getFullYear();return o===i?[t]:(Object(_.rangeEach)(o,i,function(n){var r,a,s=Object(N.clone)(t);n!==o&&(r=s,a="01/01/".concat(n),Array.isArray(r)?r[1]=a:r.startDate=a),n!==i&&function(t,e){Array.isArray(t)?t[2]=e:t.endDate=e}(s,"12/31/".concat(n)),e.push(s)}),e)}},{key:"onAfterSourceChange",value:function(t){var e=this;this.asyncCall(function(){if(t){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r],a=parseInt(i[0],10),s=parseInt(i[1],10);n[a]||(n[a]={}),n[a][s]=[i[2],i[3]]}Object(N.objectEach)(n,function(t,n){var r=parseInt(n,10);e.chartPlugin.getRangeBarCoordinates(r)&&e.chartPlugin.removeRangeBarByColumn(r,e.chartPlugin.rangeList[r][1]),e.updateFromSource(n)})}})}},{key:"onAfterSourceLoadData",value:function(){var t=this;this.asyncCall(function(){t.chartPlugin.removeAllRangeBars(),t.updateFromSource()})}},{key:"onAfterColumnSort",value:function(){var t=this;this.asyncCall(function(){t.chartPlugin.removeAllRangeBars(),t.updateFromSource()})}}])&&ad(e.prototype,n),r&&ad(e,r),t}();function ld(t){return(ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ud(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cd(t,e){return!e||"object"!==ld(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fd(t,e,n){return(fd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=hd(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function hd(t){return(hd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dd(t,e){return(dd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pd=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=cd(this,hd(e).call(this,t))).settings={},n.dateCalculator=null,n.currentYear=null,n.monthList=[],n.monthHeadersArray=[],n.weekHeadersArray=[],n.rangeBars={},n.rangeList={},n.nestedHeadersPlugin=null,n.hotSource=null,n.overallWeekSectionCount=null,n.initialSettings=null,n.dataFeed=null,n.colorData={},n.rangeBarMeta=Object.create(null),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dd(t,e)}(e,B),n=e,(r=[{key:"checkDependencies",value:function(){this.hot.getSettings().colHeaders||Object(Vi.b)("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")}},{key:"isEnabled",value:function(){return!!this.hot.getSettings().ganttChart}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.checkDependencies(),this.parseSettings(),this.currentYear=this.settings.startYear||(new Date).getFullYear(),this.dateCalculator=new id({year:this.currentYear,allowSplitWeeks:this.settings.allowSplitWeeks,hideDaysBeforeFullWeeks:this.settings.hideDaysBeforeFullWeeks,hideDaysAfterFullWeeks:this.settings.hideDaysAfterFullWeeks}),this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay),this.monthList=this.dateCalculator.getMonthList(),this.monthHeadersArray=this.generateMonthHeaders(),this.weekHeadersArray=this.generateWeekHeaders(),this.overallWeekSectionCount=this.dateCalculator.countWeekSections(),this.assignGanttSettings(),this.nestedHeadersPlugin&&(this.applyDataSource(),this.colorData&&this.setRangeBarColors(this.colorData)),this.addHook("afterInit",function(){return t.onAfterInit()}),Object(b.addClass)(this.hot.rootElement,"ganttChart"),fd(hd(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.internalUpdateSettings||(this.dataFeed&&this.dataFeed.hotSource&&this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource),this.settings={},this.dataFeed={},this.currentYear=null,this.monthList=[],this.rangeBars={},this.rangeList={},this.rangeBarMeta={},this.hotSource=null,this.deassignGanttSettings(),Object(b.removeClass)(this.hot.rootElement,"ganttChart"),fd(hd(e.prototype),"disablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fd(hd(e.prototype),"updatePlugin",this).call(this)}},{key:"parseSettings",value:function(){this.settings=this.hot.getSettings().ganttChart,"boolean"==typeof this.settings&&(this.settings={}),this.settings.firstWeekDay||(this.settings.firstWeekDay="monday"),void 0===this.settings.allowSplitWeeks&&(this.settings.allowSplitWeeks=!0),"function"!=typeof this.settings.weekHeaderGenerator&&(this.settings.weekHeaderGenerator=null)}},{key:"applyDataSource",value:function(){if(this.settings.dataSource){var t=this.settings.dataSource;t.instance?this.loadData(t.instance,t.startDateColumn,t.endDateColumn,t.additionalData,t.asyncUpdates):this.loadData(t)}}},{key:"loadData",value:function(t,e,n,r,o){this.dataFeed=new sd(this.hot,t,e,n,r,o),this.hot.render()}},{key:"clearRangeBars",value:function(){this.rangeBars={}}},{key:"clearRangeList",value:function(){this.rangeList={}}},{key:"getRangeBarCoordinates",value:function(t){return this.rangeList[t]}},{key:"generateMonthHeaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentYear;return this.dateCalculator.generateHeaderSet("months",this.settings.weekHeaderGenerator,t)}},{key:"generateWeekHeaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentYear;return this.dateCalculator.generateHeaderSet("weeks",this.settings.weekHeaderGenerator,t)}},{key:"assignGanttSettings",value:function(){var t=this;this.initialSettings=Object(N.deepClone)(this.hot.getSettings());var e={data:Object(S.createEmptySpreadsheetData)(1,this.overallWeekSectionCount),readOnly:!0,renderer:function(e,n,r,o,i,a,s){return t.uniformBackgroundRenderer(e,n,r,o,i,a,s)},colWidths:60,hiddenColumns:!this.hot.getSettings().hiddenColumns||this.hot.getSettings().hiddenColumns,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:!this.hot.getSettings().collapsibleColumns||this.hot.getSettings().collapsibleColumns,columnSorting:!1,copyPaste:!1};this.internalUpdateSettings=!0,this.hot.updateSettings(e),this.internalUpdateSettings=void 0}},{key:"deassignGanttSettings",value:function(){this.internalUpdateSettings=!0,this.initialSettings&&this.hot.updateSettings(this.initialSettings),this.internalUpdateSettings=void 0}},{key:"cacheRangeBarMeta",value:function(t,e,n,r){this.rangeBarMeta[t]||(this.rangeBarMeta[t]={}),this.rangeBarMeta[t][e]||(this.rangeBarMeta[t][e]={}),this.rangeBarMeta[t][e][n]=r}},{key:"applyRangeBarMetaCache",value:function(){var t=this;Object(N.objectEach)(this.rangeBarMeta,function(e,n){Object(N.objectEach)(e,function(e,r){Object(N.objectEach)(e,function(e,o){t.hot.setCellMeta(n,r,o,e)})})})}},{key:"getAdjacentWeekColumn",value:function(t,e,n){var r=nd(t),o=!0===n?-7:7,i=r.setDate(r.getDate()+o);return this.dateCalculator.dateToColumn(i)}},{key:"addRangeBar",value:function(t,e,n,r){var o=this;null!==e&&null!==n&&this.prepareDaysInColumnsInfo(nd(e),nd(n));var i,a=this.dateCalculator.dateToColumn(e),s=this.dateCalculator.dateToColumn(n),l=(i=nd(e))?i.getFullYear():null,u=!1,c=!1;return null===a&&this.settings.hideDaysBeforeFullWeeks&&!1!==(a=this.getAdjacentWeekColumn(e,!0,!1))&&(u=!0),null===s&&this.settings.hideDaysAfterFullWeeks&&!1!==(s=this.getAdjacentWeekColumn(n,!1,!0))&&(c=!0),!(!this.dateCalculator.isValidRangeBarData(e,n)||!1===a||!1===s)&&(this.rangeBars[l]||(this.rangeBars[l]={}),this.rangeBars[l][t]||(this.rangeBars[l][t]={}),this.rangeBars[l][t][a]={barLength:s-a+1,partialStart:!u&&!this.dateCalculator.isOnTheEdgeOfWeek(e)[0],partialEnd:!c&&!this.dateCalculator.isOnTheEdgeOfWeek(n)[1],additionalData:{}},Object(N.objectEach)(r,function(e,n){o.rangeBars[l][t][a].additionalData[n]=e}),l===this.dateCalculator.getYear()&&(this.colorData[t]&&(this.rangeBars[l][t][a].colors=this.colorData[t]),this.rangeList[t]=[t,a],this.renderRangeBar(t,a,s,r)),[t,a])}},{key:"prepareDaysInColumnsInfo",value:function(t,e){for(var n=t.getFullYear();n<=e.getFullYear();n++)void 0===this.dateCalculator.daysInColumns[n]&&(this.dateCalculator.calculateWeekStructure(n),this.dateCalculator.generateHeaderSet("weeks",null,n))}},{key:"getRangeBarData",value:function(t,e){var n=this.dateCalculator.getYear(),r=this.getRangeBarCoordinates(t);if(!r)return!1;var o=this.rangeBars[n][r[0]][r[1]];return!(!o||t!==r[0]||!(e===r[1]||e>r[1]&&e<r[1]+o.barLength))&&o}},{key:"updateRangeBarData",value:function(t,e,n){var r=this.getRangeBarData(t,e);Object(N.objectEach)(n,function(t,e){r[e]!==t&&(r[e]=t)})}},{key:"renderRangeBar",value:function(t,e,n){for(var r=this.dateCalculator.getYear(),o=this.rangeBars[r][t][e],i=e;i<=n;i++){var a=this.hot.getCellMeta(t,i),s="".concat(a.className||""," rangeBar");(i===e&&o.partialStart||i===n&&o.partialEnd)&&(s+=" partial"),i===n&&(s+=" last"),this.hot.setCellMeta(t,i,"originalClassName",a.className),this.hot.setCellMeta(t,i,"className",s),this.hot.setCellMeta(t,i,"additionalData",o.additionalData),this.cacheRangeBarMeta(t,i,"originalClassName",a.className),this.cacheRangeBarMeta(t,i,"className",s),this.cacheRangeBarMeta(t,i,"additionalData",o.additionalData)}}},{key:"removeRangeBarByDate",value:function(t,e){var n=this.dateCalculator.dateToColumn(e);this.removeRangeBarByColumn(t,n)}},{key:"removeRangeBarByColumn",value:function(t,e){var n=this,r=this.dateCalculator.getYear(),o=this.rangeBars[r][t][e];o&&(this.unrenderRangeBar(t,e,e+o.barLength-1),this.rangeBars[r][t][e]=null,Object(N.objectEach)(this.rangeList,function(r,o){var i=parseInt(o,10);JSON.stringify(r)===JSON.stringify([t,e])&&(n.rangeList[i]=null)}))}},{key:"removeAllRangeBars",value:function(){var t=this;Object(N.objectEach)(this.rangeBars,function(e,n){Object(N.objectEach)(e,function(e,r){t.removeRangeBarByColumn(n,r)})})}},{key:"unrenderRangeBar",value:function(t,e,n){for(var r=e;r<=n;r++){var o=this.hot.getCellMeta(t,r);this.hot.setCellMeta(t,r,"className",o.originalClassName),this.hot.setCellMeta(t,r,"originalClassName",void 0),this.cacheRangeBarMeta(t,r,"className",o.originalClassName),this.cacheRangeBarMeta(t,r,"originalClassName",void 0)}this.hot.render()}},{key:"uniformBackgroundRenderer",value:function(t,e,n,r,o,i,a){var s=this.getRangeBarData(n,r),l=this.getRangeBarCoordinates(n);e.innerHTML="",a.className&&(e.className=a.className);var u="";Object(N.objectEach)(a.additionalData,function(t,e){u+="".concat(e,": ").concat(t,"\n")}),u=u.replace(/\n$/,""),e.title=u,s&&s.colors?r===l[1]&&s.partialStart||r===l[1]+s.barLength-1&&s.partialEnd?e.style.background=s.colors[1]:e.style.background=s.colors[0]:e.style.background=""}},{key:"setRangeBarColors",value:function(t){var e=this;this.colorData=t,Object(N.objectEach)(t,function(t,n){var r=e.getRangeBarCoordinates(n);r&&e.updateRangeBarData(r[0],r[1],{colors:t})}),this.hot.render()}},{key:"setYear",value:function(t){var e=Object(N.extend)(this.hot.getSettings().ganttChart,{startYear:t});this.hot.updateSettings({ganttChart:e})}},{key:"onAfterInit",value:function(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.applyDataSource()}},{key:"onUpdateSettings",value:function(){this.internalUpdateSettings?this.applyRangeBarMetaCache():fd(hd(e.prototype),"onUpdateSettings",this).call(this)}},{key:"destroy",value:function(){this.hotSource&&this.dataFeed.removeSourceHotHooks(this.hotSource),fd(hd(e.prototype),"destroy",this).call(this)}}])&&ud(n.prototype,r),o&&ud(n,o),e}();Object(P.d)("ganttChart",pd);var gd=pd;function vd(t){return(vd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function md(t,e){return!e||"object"!==vd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bd(t,e,n){return(bd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wd(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function wd(t){return(wd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cd(t,e){return(Cd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Od=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=md(this,wd(e).call(this,t))).settings=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cd(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().headerTooltips}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().headerTooltips,this.parseSettings(),this.addHook("afterGetColHeader",function(e,n){return t.onAfterGetHeader(e,n)}),this.addHook("afterGetRowHeader",function(e,n){return t.onAfterGetHeader(e,n)}),bd(wd(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.clearTitleAttributes(),bd(wd(e.prototype),"disablePlugin",this).call(this)}},{key:"parseSettings",value:function(){"boolean"==typeof this.settings&&(this.settings={rows:!0,columns:!0,onlyTrimmed:!1})}},{key:"clearTitleAttributes",value:function(){var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay,o=r?r.clone.wtTable.THEAD:null;Object(_.rangeEach)(0,t-1,function(t){var r=e.childNodes[t],i=n.childNodes[t],a=o?o.childNodes[t]:null;Object(_.rangeEach)(0,r.childNodes.length-1,function(t){r.childNodes[t].removeAttribute("title"),i&&i.childNodes[t]&&i.childNodes[t].removeAttribute("title"),o&&a&&a.childNodes[t]&&a.childNodes[t].removeAttribute("title")})},!0)}},{key:"onAfterGetHeader",value:function(t,e){var n=e.querySelector("span"),r="THEAD"===e.parentNode.parentNode.nodeName;(r&&this.settings.columns||!r&&this.settings.rows)&&(this.settings.onlyTrimmed?Object(b.outerWidth)(n)>=Object(b.outerWidth)(e)&&0!==Object(b.outerWidth)(n)&&e.setAttribute("title",n.textContent):e.setAttribute("title",n.textContent))}},{key:"destroy",value:function(){this.settings=null,bd(wd(e.prototype),"destroy",this).call(this)}}])&&yd(n.prototype,r),o&&yd(n,o),e}();Object(P.d)("headerTooltips",Od);var Ed=Od;function Sd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var kd=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nestedHeaders=e,this.container=void 0,this.widthsCache=[]}var e,n,r;return e=t,(n=[{key:"buildWidthsMapper",value:function(){this.container=this.nestedHeaders.hot.rootDocument.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);for(var t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length,n=0;n<e;n++)this.widthsCache.push(t[n].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(t){for(var e=this.nestedHeaders.hot.rootDocument,n=e.createDocumentFragment(),r=e.createElement("table"),o=!1,i=!!this.nestedHeaders.hot.getSettings().dropdownMenu,a=this.nestedHeaders.colspanArray.length,s=this.nestedHeaders.hot.countCols(),l=a-1,u=0;u<a;u++){var c=e.createElement("tr");o=!1;for(var f=0;f<s;f++){var h=e.createElement("th"),d=Object(N.clone)(this.nestedHeaders.colspanArray[u][f]);d&&!d.hidden&&(u===l&&(d.colspan>1&&(o=!0),i&&(d.label+='<button class="changeType"></button>')),Object(b.fastInnerHTML)(h,d.label),h.colSpan=d.colspan,c.appendChild(h))}r.appendChild(c)}if(o){for(var p=e.createElement("tr"),g=0;g<s;g++){var v=e.createElement("th");p.appendChild(v)}r.appendChild(p)}n.appendChild(r),t.appendChild(n)}},{key:"clear",value:function(){this.container=null,this.widthsCache.length=0}}])&&Sd(e.prototype,n),r&&Sd(e,r),t}();function Rd(t){return(Rd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Td(){var t=_d(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\n                is currently not supported and might result in glitches."]);return Td=function(){return t},t}function Md(){var t=_d(["You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual\n          glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns."]);return Md=function(){return t},t}function _d(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Nd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ad(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xd(t,e,n){return(xd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jd(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function jd(t){return(jd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Id(t,e){return(Id=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Dd=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=jd(e).call(this,t))||"object"!==Rd(o)&&"function"!=typeof o?Ad(r):o).settings=[],n.columnHeaderLevelCount=0,n.colspanArray=[],n.ghostTable=new kd(Ad(n)),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Id(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().nestedHeaders,this.addHook("afterGetColumnHeaderRenderers",function(e){return t.onAfterGetColumnHeaderRenderers(e)}),this.addHook("afterInit",function(){return t.onAfterInit()}),this.addHook("afterOnCellMouseDown",function(e,n){return t.onAfterOnCellMouseDown(e,n)}),this.addHook("beforeOnCellMouseOver",function(e,n,r,o){return t.onBeforeOnCellMouseOver(e,n,r,o)}),this.addHook("afterViewportColumnCalculatorOverride",function(e){return t.onAfterViewportColumnCalculatorOverride(e)}),this.addHook("modifyColWidth",function(e,n){return t.onModifyColWidth(e,n)}),this.setupColspanArray(),this.checkForFixedColumnsCollision(),this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0,xd(jd(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearColspans(),this.settings=[],this.columnHeaderLevelCount=0,this.colspanArray=[],this.ghostTable.clear(),xd(jd(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),xd(jd(e.prototype),"updatePlugin",this).call(this),this.ghostTable.buildWidthsMapper()}},{key:"clearColspans",value:function(){if(this.hot.view)for(var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,o=0;o<t;o++){var i=e.childNodes[o];if(!i)break;for(var a=n.childNodes[o],s=r?r.childNodes[o]:null,l=0,u=i.childNodes.length;l<u;l++)i.childNodes[l].removeAttribute("colspan"),a&&a.childNodes[l]&&a.childNodes[l].removeAttribute("colspan"),r&&s&&s.childNodes[l]&&s.childNodes[l].removeAttribute("colspan")}}},{key:"checkForFixedColumnsCollision",value:function(){var t=this,e=this.hot.getSettings().fixedColumnsLeft;Object(w.arrayEach)(this.colspanArray,function(n,r){t.getNestedParent(r,e)!==e&&Object(Vi.b)(Object(Ii.a)(Md()))})}},{key:"checkForOverlappingHeaders",value:function(){var t=this;Object(w.arrayEach)(this.colspanArray,function(e,n){Object(w.arrayEach)(t.colspanArray[n],function(e,r){if(e.colspan>1){var o=t.levelToRowCoords(n),i=t.getChildHeaders(o,r);if(i.length>0){var a=0;return Object(w.arrayEach)(i,function(e){a+=t.getColspan(o+1,e)}),a>e.colspan&&Object(Vi.b)(Object(Ii.a)(Td())),!1}}})})}},{key:"setupColspanArray",value:function(){var t=this;Object(N.objectEach)(this.settings,function(e,n){Object(N.objectEach)(e,function(e,r,o){var i,a;if((i=t.colspanArray)[a=n]||(i[a]=[]),void 0===o[r].colspan)t.colspanArray[n].push({label:o[r]||"",colspan:1,hidden:!1});else{var s=o[r].colspan||1;t.colspanArray[n].push({label:o[r].label||"",colspan:s,hidden:!1}),t.fillColspanArrayWithDummies(s,n)}})})}},{key:"fillColspanArrayWithDummies",value:function(t,e){var n=this;Object(_.rangeEach)(0,t-2,function(){n.colspanArray[e].push({label:"",colspan:1,hidden:!0})})}},{key:"headerRendererFactory",value:function(t){var e=this;return function(n,r){var o=e.hot.rootDocument;if(r.removeAttribute("colspan"),Object(b.removeClass)(r,"hiddenHeader"),e.colspanArray[t][n]&&e.colspanArray[t][n].colspan){var i=e.colspanArray[t][n].colspan,a=e.hot.getSettings().fixedColumnsLeft||0,s=e.hot.view.wt.wtOverlays,l=s.leftOverlay,u=s.topLeftCornerOverlay,c=!!u&&u.clone.wtTable.THEAD.contains(r),f=!!l&&l.clone.wtTable.THEAD.contains(r);i>1&&r.setAttribute("colspan",c||f?Math.min(i,a-n):i),(c||f&&n===a-1)&&Object(b.addClass)(r,"overlayEdge")}e.colspanArray[t][n]&&e.colspanArray[t][n].hidden&&Object(b.addClass)(r,"hiddenHeader"),Object(b.empty)(r);var h=o.createElement("DIV");Object(b.addClass)(h,"relative");var d=o.createElement("SPAN");Object(b.addClass)(d,"colHeader"),Object(b.fastInnerHTML)(d,e.colspanArray[t][n]&&e.colspanArray[t][n].label||""),h.appendChild(d),r.appendChild(h),e.hot.runHooks("afterGetColHeader",n,r)}}},{key:"getColspan",value:function(t,e){var n=this.colspanArray[this.rowCoordsToLevel(t)][e];return n?n.colspan:1}},{key:"levelToRowCoords",value:function(t){return t-this.columnHeaderLevelCount}},{key:"rowCoordsToLevel",value:function(t){return t+this.columnHeaderLevelCount}},{key:"getNestedParent",value:function(t,e){if(t<0)return!1;var n=this.colspanArray[t][e]?this.colspanArray[t][e].colspan:1,r=!!this.colspanArray[t][e]&&this.colspanArray[t][e].hidden;if(n>1||1===n&&!1===r)return e;var o=e-1;do{if(this.colspanArray[t][o].colspan>1)break;o-=1}while(e>=0);return o}},{key:"getChildHeaders",value:function(t,e){var n=this.rowCoordsToLevel(t),r=this.colspanArray[n+1],o=this.getNestedParent(n,e),i=this.colspanArray[n][e].colspan,a=[];return r?(Object(_.rangeEach)(o,o+i-1,function(t){r[t]&&r[t].colspan>1&&(i-=r[t].colspan-1),r[t]&&!r[t].hidden&&-1===a.indexOf(t)&&a.push(t)}),a):a}},{key:"fillTheRemainingColspans",value:function(){var t=this;Object(N.objectEach)(this.settings,function(e,n){Object(_.rangeEach)(t.colspanArray[n].length-1,t.hot.countCols()-1,function(r){t.colspanArray[n].push({label:e[r]||"",colspan:1,hidden:!1})},!0)})}},{key:"updateHeadersHighlight",value:function(){var t=this,e=this.hot.getSelectedLast();if(void 0!==e){var n=this.hot.view.wt.wtOverlays,r=this.hot.selection.isSelectedByColumnHeader(),o=Math.min(e[1],e[3]),i=Math.max(e[1],e[3]),a=r?-1:this.columnHeaderLevelCount-1,s=[],l=function(t){return function(e,n){return function(){return n(e,t)}}},u=l("ht__highlight"),c=l("ht__active_highlight");Object(_.rangeEach)(o,i,function(e){for(var l=function(l){var f=t.getNestedParent(l,e),h=[n.topOverlay?n.topOverlay.clone.wtTable.getColumnHeader(f,l):void 0,n.topLeftCornerOverlay?n.topLeftCornerOverlay.clone.wtTable.getColumnHeader(f,l):void 0],d=t.getColspan(l-t.columnHeaderLevelCount,f),p=f>=o&&f+d-1<=i;Object(w.arrayEach)(h,function(t){if(void 0===t)return!1;!r&&l<a||r&&!p?(s.push(u(t,b.removeClass)),r&&s.push(c(t,b.removeClass))):(s.push(u(t,b.addClass)),r&&s.push(c(t,b.addClass)))})},f=t.columnHeaderLevelCount-1;f>-1;f--)l(f)}),Object(w.arrayEach)(s,function(t){t()}),s.length=0}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){var e=this,n=t.startColumn;Object(_.rangeEach)(0,Math.max(this.columnHeaderLevelCount-1,0),function(r){var o=e.getNestedParent(r,t.startColumn);o<t.startColumn&&(n=Math.min(n,o))}),t.startColumn=n}},{key:"onAfterOnCellMouseDown",value:function(t,e){if(e.row<0){var n=this.getColspan(e.row,e.col),r=e.col+n-1;if(n>1){var o=this.hot.countRows()-1;this.hot.selection.setRangeEnd(new tt.a(o,r))}}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){if(!(e.row>=0||e.col<0)&&this.hot.view.isMouseDown()){var o=this.hot.getSelectedRangeLast(),i=o.from,a=o.to,s=this.getColspan(e.row,e.col),l=e.col+s-1,u=!1;if(i.col<=a.col?(e.col<i.col&&l===a.col||e.col<i.col&&l<i.col||e.col<i.col&&l>=i.col&&l<a.col)&&(u=!0):(e.col<a.col&&l>i.col||e.col>i.col||e.col<=a.col&&l>i.col||e.col>a.col&&l>i.col)&&(u=!0),u){var c=[a.col,i.col];i.col=c[0],a.col=c[1]}if(s>1){var f;r.column=!0,r.cell=!0;var h=[];i.col===a.col&&(l<=i.col&&e.col<i.col?h.push(a.col,e.col):h.push(e.col<i.col?e.col:i.col,l>a.col?l:a.col)),i.col<a.col&&h.push(e.col<i.col?e.col:i.col,l),i.col>a.col&&h.push(i.col,e.col),(f=this.hot).selectColumns.apply(f,h)}}}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length,this.fillTheRemainingColspans(),this.checkForOverlappingHeaders(),this.ghostTable.buildWidthsMapper()}},{key:"onAfterGetColumnHeaderRenderers",value:function(t){if(t){t.length=0;for(var e=this.colspanArray.length-1;e>=0;e--)t.push(this.headerRendererFactory(e));t.reverse()}this.updateHeadersHighlight()}},{key:"onModifyColWidth",value:function(t,e){var n=this.ghostTable.widthsCache[e];return t>n?t:n}},{key:"destroy",value:function(){this.settings=null,this.columnHeaderLevelCount=null,this.colspanArray=null,xd(jd(e.prototype),"destroy",this).call(this)}}])&&Nd(n.prototype,r),o&&Nd(n,o),e}();Object(P.d)("nestedHeaders",Dd);var Pd=Dd;function Ld(t){return(Ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Fd=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=n,this.data=r,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},this.recordTranslator=Object(D.a)(this.hot)}var e,n,r;return e=t,(n=[{key:"rewriteCache",value:function(){var t=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Object(_.rangeEach)(0,this.data.length-1,function(e){t.cacheNode(t.data[e],0,null)})}},{key:"cacheNode",value:function(t,e,n){var r=this;this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&Object(w.arrayEach)(t.__children,function(n){r.cacheNode(n,e+1,t)})}},{key:"getDataObject",value:function(t){return null==t?null:this.cache.rows[t]}},{key:"readTreeNodes",value:function(t,e,n,r){var o=this,i=!1,a=e;if(isNaN(a)&&a.end)return a;var s=t;return s||(s={__children:this.data},i=!0,a-=1),null!=n&&a===n?{result:s,end:!0}:null!=r&&s===r?{result:a,end:!0}:(a+=1,s.__children&&Object(w.arrayEach)(s.__children,function(t){if(o.parentReference.set(t,i?null:s),a=o.readTreeNodes(t,a,n,r),isNaN(a)&&a.end)return!1}),a)}},{key:"updateParentReference",value:function(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())}},{key:"mockParent",value:function(){var t=this.mockNode();return t.__children=this.data,t}},{key:"mockNode",value:function(){var t={};return Object(N.objectEach)(this.data[0],function(e,n){t[n]=null}),t}},{key:"getRowIndex",value:function(t){return null==t?null:this.cache.nodeInfo.get(t).row}},{key:"getRowIndexWithinParent",value:function(t){var e=null;e=isNaN(t)?t:this.getDataObject(t);var n=this.getRowParent(t);return null==n?this.data.indexOf(e):n.__children.indexOf(e)}},{key:"countAllRows",value:function(){var t={__children:this.data};return this.countChildren(t)}},{key:"countChildren",value:function(t){var e=this,n=0,r=t;return isNaN(r)||(r=this.getDataObject(r)),r&&r.__children?(Object(w.arrayEach)(r.__children,function(t){n+=1,t.__children&&(n+=e.countChildren(t))}),n):0}},{key:"getRowParent",value:function(t){var e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}},{key:"getRowObjectParent",value:function(t){return"object"!==Ld(t)?null:this.cache.nodeInfo.get(t).parent}},{key:"getRowLevel",value:function(t){var e=null;return(e=isNaN(t)?t:this.getDataObject(t))?this.getRowObjectLevel(e):null}},{key:"getRowObjectLevel",value:function(t){return null==t?null:this.cache.nodeInfo.get(t).level}},{key:"hasChildren",value:function(t){var e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}},{key:"isParent",value:function(t){var e=t;return isNaN(e)||(e=this.getDataObject(e)),!!Object(N.hasOwnProperty)(e,"__children")}},{key:"addChild",value:function(t,e){var n=e;this.hot.runHooks("beforeAddChild",t,n);var r=null;t&&(r=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(t)+1,1);var o=t;t||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.push(n),this.rewriteCache();var i=this.getRowIndex(n);this.hot.runHooks("afterCreateRow",i,1),this.hot.runHooks("afterAddChild",t,n)}},{key:"addChildAtIndex",value:function(t,e,n,r){var o=n;this.hot.runHooks("beforeAddChild",t,o,e),this.hot.runHooks("beforeCreateRow",r+1,1);var i=t;t||(i=this.mockParent()),i.__children||(i.__children=[]),o||(o=this.mockNode()),i.__children.splice(e,null,o),this.rewriteCache(),this.hot.runHooks("afterCreateRow",r+1,1),this.hot.runHooks("afterAddChild",t,o,e)}},{key:"addSibling",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(t),r=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(e){case"below":this.addChildAtIndex(r,o+1,null,t);break;case"above":this.addChildAtIndex(r,o,null,t)}}},{key:"detachFromParent",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=null,o=[];Array.isArray(t)?(Object(_.rangeEach)(t[0],t[2],function(t){var n=e.translateTrimmedRow(t);o.push(e.getDataObject(n))}),Object(_.rangeEach)(0,o.length-2,function(t){e.detachFromParent(o[t],!1)}),r=o[o.length-1]):r=t;var i=this.getRowIndex(r),a=this.getRowIndexWithinParent(r),s=this.getRowParent(r),l=this.getRowParent(s),u=this.getRowIndex(l),c=null;this.hot.runHooks("beforeDetachChild",s,r),null!=a&&(this.hot.runHooks("beforeRemoveRow",i,1,[i],this.plugin.pluginName),s.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,1,[i],this.plugin.pluginName),l?(c=u+this.countChildren(l),this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName),l.__children.push(r)):(c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName),this.data.push(r))),this.rewriteCache(),this.hot.runHooks("afterCreateRow",c,1,this.plugin.pluginName),n&&this.hot.render(),this.hot.runHooks("afterDetachChild",s,r)}},{key:"filterData",value:function(t,e,n){var r=this,o=[];Object(w.arrayEach)(n,function(t){o.push(r.getDataObject(t))}),Object(w.arrayEach)(o,function(t){var e=r.getRowIndexWithinParent(t),n=r.getRowParent(t);null===n?r.data.splice(e,1):n.__children.splice(e,1)}),this.rewriteCache()}},{key:"spliceData",value:function(t,e,n){var r=this.translateTrimmedRow(t);if(null!=r){var o=this.getDataObject(r-1),i=null,a=null;o&&o.__children&&0===o.__children.length?(i=o,a=0):(i=this.getRowParent(r),a=this.getRowIndexWithinParent(r)),i?n?i.__children.splice(a,e,n):i.__children.splice(a,e):n?this.data.splice(a,e,n):this.data.splice(a,e),this.rewriteCache()}}},{key:"moveRow",value:function(t,e){var n=this.isParent(e),r=this.getRowParent(t),o=this.getRowIndexWithinParent(t),i=this.getRowParent(e);null==i&&(i=this.getRowParent(e-1)),null==i&&(i=this.getDataObject(e-1)),i?i.__children||(i.__children=[]):(i=this.getDataObject(e)).__children=[];var a=this.getRowParent(e-1),s=n?this.countChildren(a):this.getRowIndexWithinParent(e),l=r.__children.slice(o,o+1);r.__children.splice(o,1),i.__children.splice(s,0,l[0])}},{key:"moveCellMeta",value:function(t,e){var n=this.hot.getCellMetaAtRow(t);this.hot.spliceCellsMeta(e,0,n),this.hot.spliceCellsMeta(t+(t<e?0:1),1)}},{key:"translateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}}])&&Hd(e.prototype,n),r&&Hd(e,r),t}();var Bd=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=n,this.plugin=e};function Wd(t){return(Wd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vd(t,e){return!e||"object"!==Wd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ud(t){return(Ud=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zd(t,e,n){return e&&Yd(t.prototype,e),n&&Yd(t,n),t}function Gd(t,e){return(Gd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xd=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Vd(this,Ud(e).call(this,t,n))).dataManager=r.plugin.dataManager,r.collapsingUI=r.plugin.collapsingUI,r.rowHeaderWidthCache=null,r.trimRowsPlugin=t.trimRowsPlugin,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gd(t,e)}(e,Bd),zd(e,null,[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),zd(e,[{key:"appendLevelIndicators",value:function(t,n){var r=this.trimRowsPlugin.rowsMapper.getValueByIndex(t),o=this.dataManager.getRowLevel(r),i=this.dataManager.getDataObject(r),a=n.getElementsByTagName("DIV")[0],s=a.querySelector("span.rowHeader"),l=a.querySelectorAll('[class^="ht_nesting"]');if(Object(w.arrayEach)(l,function(t){t&&a.removeChild(t)}),Object(b.addClass)(n,e.CSS_CLASSES.indicatorContainer),o){var u=this.hot.rootDocument,c=s.cloneNode(!0);a.innerHTML="",Object(_.rangeEach)(0,o-1,function(){var t=u.createElement("SPAN");Object(b.addClass)(t,e.CSS_CLASSES.emptyIndicator),a.appendChild(t)}),a.appendChild(c)}if(this.dataManager.hasChildren(i)){var f=this.hot.rootDocument.createElement("DIV");Object(b.addClass)(n,e.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?Object(b.addClass)(f,"".concat(e.CSS_CLASSES.button," ").concat(e.CSS_CLASSES.expandButton)):Object(b.addClass)(f,"".concat(e.CSS_CLASSES.button," ").concat(e.CSS_CLASSES.collapseButton)),a.appendChild(f)}}},{key:"updateRowHeaderWidth",value:function(t){var e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}]),e}();function qd(t){return(qd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $d(t,e){return!e||"object"!==qd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zd(t){return(Zd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qd(t,e){return(Qd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jd=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=$d(this,Zd(e).call(this,t,n))).trimRowsPlugin=t.trimRowsPlugin,r.dataManager=r.plugin.dataManager,r.collapsedRows=[],r.collapsedRowsStash={stash:function(){r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,!1)},shiftStash:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=r.translateTrimmedRow(t);Object(w.arrayEach)(r.lastCollapsedRows,function(t,o){t>n-1&&(r.lastCollapsedRows[o]=t+e)})},applyStash:function(){r.hot.runHooks("skipLengthCache",100),r.collapseMultipleChildren(r.lastCollapsedRows,!0),r.lastCollapsedRows=void 0},trimStash:function(t,e){Object(_.rangeEach)(t,t+e-1,function(t){var e=r.lastCollapsedRows.indexOf(t);e>-1&&r.lastCollapsedRows.splice(e,1)})}},r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qd(t,e)}(e,Bd),n=e,(r=[{key:"collapseChildren",value:function(t){var e,n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=[],a=null,s=null;return isNaN(t)?(a=t,s=this.dataManager.getRowIndex(a)):(a=this.dataManager.getDataObject(t),s=t),this.dataManager.hasChildren(a)&&Object(w.arrayEach)(a.__children,function(t){i.push(n.dataManager.getRowIndex(t))}),e=this.collapseRows(i,!0,!1),o&&this.trimRowsPlugin.trimRows(e),r&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(s)&&this.collapsedRows.push(s),e}},{key:"collapseMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];Object(w.arrayEach)(t,function(t){o=o.concat(e.collapseChildren(t,!1,!1))}),r&&this.trimRowsPlugin.trimRows(o),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}},{key:"collapseRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return Object(w.arrayEach)(t,function(t){o.push(t),n&&e.collapseChildRows(t,o)}),r&&this.trimRowsPlugin.trimRows(o),o}},{key:"collapseChildRows",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=(arguments.length>2&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3]);if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);Object(w.arrayEach)(o.__children,function(t){var r=e.dataManager.getRowIndex(t);n.push(r),e.collapseChildRows(r,n)})}r&&this.trimRowsPlugin.trimRows(n)}},{key:"expandRow",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}},{key:"expandRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return Object(w.arrayEach)(t,function(t){o.push(t),n&&e.expandChildRows(t,o)}),r&&this.trimRowsPlugin.untrimRows(o),o}},{key:"expandChildRows",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=(arguments.length>2&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3]);if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);Object(w.arrayEach)(o.__children,function(t){if(!e.isAnyParentCollapsed(t)){var r=e.dataManager.getRowIndex(t);n.push(r),e.expandChildRows(r,n)}})}r&&this.trimRowsPlugin.untrimRows(n)}},{key:"expandChildren",value:function(t){var e,n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=[],a=null,s=null;return isNaN(t)?(a=t,s=this.dataManager.getRowIndex(t)):(a=this.dataManager.getDataObject(t),s=t),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(a)&&Object(w.arrayEach)(a.__children,function(t){var e=n.dataManager.getRowIndex(t);i.push(e)}),e=this.expandRows(i,!0,!1),o&&this.trimRowsPlugin.untrimRows(e),r&&this.renderAndAdjust(),e}},{key:"expandMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];Object(w.arrayEach)(t,function(t){o=o.concat(e.expandChildren(t,!1,!1))}),r&&this.trimRowsPlugin.untrimRows(o),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var t=this,e=this.hot.getSourceData(),n=[];Object(w.arrayEach)(e,function(e){t.dataManager.hasChildren(e)&&n.push(e)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}},{key:"expandAll",value:function(){var t=this,e=this.hot.getSourceData(),n=[];Object(w.arrayEach)(e,function(e){t.dataManager.hasChildren(e)&&n.push(e)}),this.expandMultipleChildren(n),this.renderAndAdjust()}},{key:"areChildrenCollapsed",value:function(t){var e=this,n=null,r=!0;return n=isNaN(t)?t:this.dataManager.getDataObject(t),this.dataManager.hasChildren(n)&&Object(w.arrayEach)(n.__children,function(t){var n=e.dataManager.getRowIndex(t);if(!e.trimRowsPlugin.isTrimmed(n))return r=!1,!1}),r}},{key:"isAnyParentCollapsed",value:function(t){for(var e=t;null!==e;){e=this.dataManager.getRowParent(e);var n=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}},{key:"toggleState",value:function(t,e){if(!(e.col>=0)){var n=this.translateTrimmedRow(e.row);Object(b.hasClass)(t.target,Xd.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Object(I.stopImmediatePropagation)(t))}}},{key:"translateTrimmedRow",value:function(t){return this.trimRowsPlugin.rowsMapper.getValueByIndex(t)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize()}}])&&Kd(n.prototype,r),o&&Kd(n,o),e}();function tp(t){return(tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ep(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function np(t){return(np=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function op(t,e){return(op=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ip=new WeakMap,ap=function(t){function e(t,n){var r,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=this,i=np(e).call(this,t,n),r=!i||"object"!==tp(i)&&"function"!=typeof i?rp(o):i,ip.set(rp(r),{row_above:function(t,e){r.dataManager.addSibling(e.start.row,"above")},row_below:function(t,e){r.dataManager.addSibling(e.start.row,"below")}}),r.dataManager=r.plugin.dataManager,r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&op(t,e)}(e,Bd),n=e,(r=[{key:"appendOptions",value:function(t){var e=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:function(){var t=e.dataManager.translateTrimmedRow(e.hot.getSelectedLast()[0]),n=e.dataManager.getDataObject(t);e.dataManager.addChild(n)},disabled:function(){var t=e.hot.getSelectedLast();return!t||t[0]<0||e.hot.selection.isSelectedByColumnHeader()||e.hot.countRows()>=e.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:function(){e.dataManager.detachFromParent(e.hot.getSelectedLast())},disabled:function(){var t=e.hot.getSelectedLast(),n=e.dataManager.translateTrimmedRow(t[0]);return!e.dataManager.getRowParent(n)||!t||t[0]<0||e.hot.selection.isSelectedByColumnHeader()||e.hot.countRows()>=e.hot.getSettings().maxRows}},{name:"---------"}];return Object(_.rangeEach)(0,t.items.length-1,function(e){if(0===e)return Object(w.arrayEach)(n,function(n,r){t.items.splice(e+r,0,n)}),!1}),this.modifyRowInsertingOptions(t)}},{key:"modifyRowInsertingOptions",value:function(t){var e=ip.get(this);return Object(_.rangeEach)(0,t.items.length-1,function(n){var r=e[t.items[n].key];null!=r&&(t.items[n].callback=r)}),t}}])&&ep(n.prototype,r),o&&ep(n,o),e}();function sp(t){return(sp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lp(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function up(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fp(t,e,n){return(fp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=hp(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function hp(t){return(hp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dp(t,e){return(dp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pp=new WeakMap,gp=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=hp(e).call(this,t))||"object"!==sp(o)&&"function"!=typeof o?cp(r):o).sourceData=null,n.trimRowsPlugin=null,n.bindRowsWithHeadersPlugin=null,n.dataManager=null,n.headersUI=null,pp.set(cp(n),{changeSelection:!1,movedToFirstChild:!1,movedToCollapsed:!1,skipRender:null}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dp(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function(){var t=this;this.sourceData=this.hot.getSourceData(),this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove"),this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders"),this.dataManager=new Fd(this,this.hot,this.sourceData),this.collapsingUI=new Jd(this,this.hot,this.trimRowsPlugin),this.headersUI=new Xd(this,this.hot),this.contextMenuUI=new ap(this,this.hot),this.dataManager.rewriteCache(),this.addHook("afterInit",function(){return t.onAfterInit.apply(t,arguments)}),this.addHook("beforeRender",function(){return t.onBeforeRender.apply(t,arguments)}),this.addHook("modifyRowData",function(){return t.onModifyRowData.apply(t,arguments)}),this.addHook("modifySourceLength",function(){return t.onModifySourceLength.apply(t,arguments)}),this.addHook("beforeDataSplice",function(){return t.onBeforeDataSplice.apply(t,arguments)}),this.addHook("beforeDataFilter",function(){return t.onBeforeDataFilter.apply(t,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)}),this.addHook("afterGetRowHeader",function(){return t.onAfterGetRowHeader.apply(t,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow.apply(t,arguments)}),this.addHook("modifyRemovedAmount",function(){return t.onModifyRemovedAmount.apply(t,arguments)}),this.addHook("beforeAddChild",function(){return t.onBeforeAddChild.apply(t,arguments)}),this.addHook("afterAddChild",function(){return t.onAfterAddChild.apply(t,arguments)}),this.addHook("beforeDetachChild",function(){return t.onBeforeDetachChild.apply(t,arguments)}),this.addHook("afterDetachChild",function(){return t.onAfterDetachChild.apply(t,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return t.onModifyRowHeaderWidth.apply(t,arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow.apply(t,arguments)}),this.addHook("beforeRowMove",function(){return t.onBeforeRowMove.apply(t,arguments)}),this.addHook("afterRowMove",function(){return t.onAfterRowMove.apply(t,arguments)}),this.trimRowsPlugin.isEnabled()||(this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().trimRows=!0),fp(hp(e.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){fp(hp(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fp(hp(e.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(t,e){var n,r,o,i=pp.get(this),a=t.length,s=[],l=this.dataManager.translateTrimmedRow(e),u=!0,c=null;for(n=0;n<a;n++)s.push(this.dataManager.translateTrimmedRow(t[n])),this.dataManager.isParent(s[n])&&(u=!1);if(s.indexOf(l)>-1||!u)return!1;if(r=this.dataManager.getRowParent(s[0]),null==(c=this.dataManager.getRowParent(l))&&(c=this.dataManager.getRowParent(l-1)),null==c&&(c=this.dataManager.getDataObject(l-1),i.movedToFirstChild=!0),!c)return!1;for(o=r===c,i.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(c),this.collapsingUI.collapsedRowsStash.stash(),o||(Math.max.apply(Math,s)<=l?this.collapsingUI.collapsedRowsStash.shiftStash(s[0],-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(l,t.length)),i.changeSelection=!0,(s[a-1]<=l&&o||!0===i.movedToFirstChild)&&(t.reverse(),s.reverse(),!0!==i.movedToFirstChild&&(l-=1)),n=0;n<a;n++)this.dataManager.moveRow(s[n],l);if(s[s.length-1]<l)for(n=a-1;n>=0;n--)this.dataManager.moveCellMeta(s[n],l);else for(n=0;n<a;n++)this.dataManager.moveCellMeta(s[n],l);return(s[a-1]<=l&&o||this.dataManager.isParent(l))&&t.reverse(),this.dataManager.rewriteCache(),!1}},{key:"onAfterRowMove",value:function(t,e){var n=pp.get(this);if(n.changeSelection){var r,o,i=t.length,a=0,s=0,l=null;if(this.collapsingUI.collapsedRowsStash.applyStash(),r=this.dataManager.translateTrimmedRow(e),n.movedToFirstChild)n.movedToFirstChild=!1,a=e,s=e+i-1,e>=Math.max.apply(Math,lp(t))&&(a-=i,s-=i);else if(n.movedToCollapsed){var u=this.dataManager.getRowParent(r-1);null==u&&(u=this.dataManager.getDataObject(r-1)),s=a=this.dataManager.getRowIndex(u)}else t[i-1]<e?a=(s=e-1)-i+1:s=(a=e)+i-1;l=this.hot.selection,o=this.hot.countCols()-1,l.setRangeStart(new tt.a(a,0)),l.setRangeEnd(new tt.a(s,o),!0),n.changeSelection=!1}}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n){this.collapsingUI.toggleState(t,e,n)}},{key:"onModifyRowData",value:function(t){return this.dataManager.getDataObject(t)}},{key:"onModifySourceLength",value:function(){return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(t,e,n){return this.dataManager.spliceData(t,e,n),!1}},{key:"onBeforeDataFilter",value:function(t,e){var n=[],r=this.dataManager.translateTrimmedRow(t),o=pp.get(this);return Object(_.rangeEach)(r,r+e-1,function(t){n.push(t)}),this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r,e),this.collapsingUI.collapsedRowsStash.shiftStash(r,-1*e),this.dataManager.filterData(t,e,n),o.skipRender=!0,!1}},{key:"onAfterContextMenuDefaultOptions",value:function(t){return this.contextMenuUI.appendOptions(t)}},{key:"onAfterGetRowHeader",value:function(t,e){this.headersUI.appendLevelIndicators(t,e)}},{key:"onModifyRowHeaderWidth",value:function(t){return this.headersUI.rowHeaderWidthCache||t}},{key:"onAfterRemoveRow",value:function(t,e,n,r){var o=this;if(r!==this.pluginName){var i=pp.get(this);setTimeout(function(){i.skipRender=null,o.headersUI.updateRowHeaderWidth(),o.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onModifyRemovedAmount",value:function(t,e){var n=this,r=[],o=0;return Object(_.rangeEach)(e,e+t-1,function(t){var e=!1,i=n.collapsingUI.translateTrimmedRow(t),a=n.dataManager.getDataObject(i);n.dataManager.hasChildren(a)&&(r.push(a),Object(w.arrayEach)(r,function(t){if(t.__children.indexOf(a)>-1)return e=!0,!1}),e||(o+=n.dataManager.countChildren(a))),e=!1,Object(w.arrayEach)(r,function(t){if(t.__children.indexOf(a)>-1)return e=!0,!1}),e&&(o-=1)}),t+o}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(t,e,n){n!==this.pluginName&&this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){this.bindRowsWithHeadersPlugin.bindStrategy.strategy&&this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows());var t=Math.max.apply(Math,lp(this.dataManager.cache.levels));t>0&&this.headersUI.updateRowHeaderWidth(t)}},{key:"onBeforeRender",value:function(t,e){pp.get(this).skipRender&&(e.skipRender=!0)}}])&&up(n.prototype,r),o&&up(n,o),e}();Object(P.d)("nestedRows",gp);var vp=gp;function yp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function mp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function bp(t){return(bp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cp(t,e){return!e||"object"!==bp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Op(t,e,n){return(Op="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ep(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ep(t){return(Ep=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sp(t,e){return(Sp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}m.a.getSingleton().register("beforeHideColumns"),m.a.getSingleton().register("afterHideColumns"),m.a.getSingleton().register("beforeUnhideColumns"),m.a.getSingleton().register("afterUnhideColumns");var kp=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Cp(this,Ep(e).call(this,t))).settings={},n.hiddenColumns=[],n.lastSelectedColumn=-1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sp(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.hot.hasColHeaders()?this.addHook("afterGetColHeader",function(e,n){return t.onAfterGetColHeader(e,n)}):this.addHook("afterRenderer",function(e,n,r){return t.onAfterGetColHeader(r,e)}),this.addHook("afterContextMenuDefaultOptions",function(e){return t.onAfterContextMenuDefaultOptions(e)}),this.addHook("afterGetCellMeta",function(e,n,r){return t.onAfterGetCellMeta(e,n,r)}),this.addHook("modifyColWidth",function(e,n){return t.onModifyColWidth(e,n)}),this.addHook("beforeSetRangeStartOnly",function(e){return t.onBeforeSetRangeStart(e)}),this.addHook("beforeSetRangeEnd",function(e){return t.onBeforeSetRangeEnd(e)}),this.addHook("hiddenColumn",function(e){return t.isHidden(e)}),this.addHook("beforeStretchingColumnWidth",function(e,n){return t.onBeforeStretchingColumnWidth(e,n)}),this.addHook("afterCreateCol",function(e,n){return t.onAfterCreateCol(e,n)}),this.addHook("afterRemoveCol",function(e,n){return t.onAfterRemoveCol(e,n)}),this.addHook("init",function(){return t.onInit()}),this.hot.view&&this.onInit(),Op(Ep(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Op(Ep(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={},this.hiddenColumns=[],this.lastSelectedColumn=-1,this.hot.render(),Op(Ep(e.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(t){var e=this.hiddenColumns,n=this.isColumnDataValid(t),r=e;n&&(r=this.hiddenColumns.filter(function(e){return!1===t.includes(e)})),!1!==this.hot.runHooks("beforeUnhideColumns",e,r,n)&&(n&&(this.hiddenColumns=r),this.hot.runHooks("afterUnhideColumns",e,r,n,n&&r.length<e.length))}},{key:"showColumn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showColumns(e)}},{key:"hideColumns",value:function(t){var e=this.hiddenColumns,n=this.isColumnDataValid(t),r=e;n&&(r=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeHideColumns",e,r,n)&&(n&&(this.hiddenColumns=r),this.hot.runHooks("afterHideColumns",e,r,n,n&&r.length>e.length))}},{key:"hideColumn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideColumns(e)}},{key:"isHidden",value:function(t){var e=t;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(e=this.hot.toPhysicalColumn(t)),this.hiddenColumns.includes(e)}},{key:"isColumnDataValid",value:function(t){var e=this;return t.every(function(t){return Number.isInteger(t)&&t>=0&&t<e.hot.countCols()})}},{key:"resetCellsMeta",value:function(){Object(w.arrayEach)(this.hot.getCellsMeta(),function(t){t&&(t.skipColumnOnPaste=!1,null!==t.baseRenderer&&(t.renderer=t.baseRenderer,t.baseRenderer=null))})}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){var n=t;return this.isHidden(e)&&(n=0),n}},{key:"onModifyColWidth",value:function(t,e){return this.isHidden(e)?.1:this.settings.indicators&&(this.isHidden(e+1)||this.isHidden(e-1))?t+(this.hot.hasColHeaders()?15:0):void 0}},{key:"onAfterGetCellMeta",value:function(t,e,n){var r=this.hot.runHooks("unmodifyCol",e);if(!1===this.settings.copyPasteEnabled&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(r)?(n.renderer!==Rp&&(n.baseRenderer=n.renderer),n.renderer=Rp):null!==n.baseRenderer&&(n.renderer=n.baseRenderer,n.baseRenderer=null),this.isHidden(n.visualCol-1)){var o=!0,i=n.visualCol-1;n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");do{if(!this.isHidden(i)){o=!1;break}i-=1}while(i>=0);o&&-1===n.className.indexOf("firstVisibleColumn")&&(n.className+=" firstVisibleColumn")}else if(n.className){var a=n.className.split(" ");if(a.length){var s=a.indexOf("afterHiddenColumn");s>-1&&a.splice(s,1);var l=a.indexOf("firstVisibleColumn");l>-1&&a.splice(l,1),n.className=a.join(" ")}}}},{key:"onModifyCopyableRange",value:function(t){var e=this,n=[],r=function(t,e,r,o){n.push({startRow:t,endRow:e,startCol:r,endCol:o})};return Object(w.arrayEach)(t,function(t){var n=!0,o=0;Object(_.rangeEach)(t.startCol,t.endCol,function(i){e.isHidden(i)?(n||r(t.startRow,t.endRow,o,i-1),n=!0):(n&&(o=i),i===t.endCol&&r(t.startRow,t.endRow,o,i),n=!1)})}),n}},{key:"onAfterGetColHeader",value:function(t,e){if(!this.isHidden(t)){var n=!0,r=t-1;do{if(!this.isHidden(r)){n=!1;break}r-=1}while(r>=0);n&&Object(b.addClass)(e,"firstVisibleColumn"),this.settings.indicators&&(this.isHidden(t-1)&&Object(b.addClass)(e,"afterHiddenColumn"),this.isHidden(t+1)&&t>-1&&Object(b.addClass)(e,"beforeHiddenColumn"))}}},{key:"onBeforeSetRangeStart",value:function(t){var e=this;if(!(t.col>0)){t.col=0;t.col=function t(n){var r=n,o=e.hot.toPhysicalColumn(r);return e.isHidden(o,!0)&&(r=t(r+=1)),r}(t.col)}}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this,n=this.hot.countCols();t.col=function r(o){var i=o,a=e.hot.toPhysicalColumn(i);return e.isHidden(a,!0)&&(e.lastSelectedColumn>i||t.col===n-1?i>0?i=r(i-=1):Object(_.rangeEach)(0,e.lastSelectedColumn,function(t){if(!e.isHidden(t))return i=t,!1}):i=r(i+=1)),i}(t.col),this.lastSelectedColumn=t.col}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;t.items.push({name:We},(e=this,{key:"hidden_columns_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=yp(t,4);n[1]-n[3]!=0&&(e=1)}return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_HIDE_COLUMN,e)},callback:function(){var t=this.getSelectedRangeLast(),n=t.from,r=t.to,o=Math.min(n.col,r.col),i=Math.max(n.col,r.col);Object(_.rangeEach)(o,i,function(t){return e.hideColumn(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.isSelectedByColumnHeader()}}),function(t){var e=[],n=[];return{key:"hidden_columns_show",name:function(){var r=this.getSelectedLast(),o=0;if(Array.isArray(r)){var i=mp(r,4),a=i[1],s=i[3];if(a>s){var l=[s,a];a=l[0],s=l[1]}var u=0;a===s?u=e.length+n.length:Object(_.rangeEach)(a,s,function(e){t.isHidden(e)&&(u+=1)}),o=u<=1?0:1}return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_SHOW_COLUMN,o)},callback:function(){var r=this.getSelectedRangeLast(),o=r.from,i=r.to,a=Math.min(o.col,i.col),s=Math.max(o.col,i.col);a===s?(e.length===a&&(t.showColumns(e),e.length=0),n.length===this.countSourceCols()-(a+1)&&(t.showColumns(n),n.length=0)):Object(_.rangeEach)(a,s,function(e){return t.showColumn(e)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!t.hiddenColumns.length||!this.selection.isSelectedByColumnHeader())return!0;e.length=0,n.length=0;var r=this.getSelectedRangeLast(),o=r.from,i=r.to,a=Math.min(o.col,i.col),s=Math.max(o.col,i.col),l=!1;if(a===s){var u=this.countSourceCols();Object(_.rangeEach)(0,u,function(r){if(e.length+n.length===t.hiddenColumns.length)return!1;r<a&&t.isHidden(r)?e.push(r):t.isHidden(r)&&n.push(r)}),u-=1,(e.length===a&&a>0||n.length===u-a&&a<u)&&(l=!0)}else Object(_.rangeEach)(a,s,function(e){if(t.isHidden(e))return l=!0,!1});return!l}}}(this))}},{key:"onAfterCreateCol",value:function(t,e){var n=[];Object(w.arrayEach)(this.hiddenColumns,function(r){var o=r;o>=t&&(o+=e),n.push(o)}),this.hiddenColumns=n}},{key:"onAfterRemoveCol",value:function(t,e){var n=[];Object(w.arrayEach)(this.hiddenColumns,function(r){var o=r;o>=t&&(o-=e),n.push(o)}),this.hiddenColumns=n}},{key:"onInit",value:function(){var t=this,e=this.hot.getSettings().hiddenColumns;"object"===bp(e)&&(this.settings=e,void 0===e.copyPasteEnabled&&(e.copyPasteEnabled=!0),Array.isArray(e.columns)&&this.hideColumns(e.columns),e.copyPasteEnabled||this.addHook("modifyCopyableRange",function(e){return t.onModifyCopyableRange(e)}))}},{key:"destroy",value:function(){Op(Ep(e.prototype),"destroy",this).call(this)}}])&&wp(n.prototype,r),o&&wp(n,o),e}();function Rp(t,e){e.textContent=""}Object(P.d)("hiddenColumns",kp);var Tp=kp;function Mp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Np(t){return(Np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ap(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xp(t,e){return!e||"object"!==Np(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jp(t,e,n){return(jp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ip(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ip(t){return(Ip=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dp(t,e){return(Dp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}m.a.getSingleton().register("beforeHideRows"),m.a.getSingleton().register("afterHideRows"),m.a.getSingleton().register("beforeUnhideRows"),m.a.getSingleton().register("afterUnhideRows");var Pp=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=xp(this,Ip(e).call(this,t))).settings={},n.hiddenRows=[],n.lastSelectedRow=-1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dp(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.hot.hasRowHeaders()?this.addHook("afterGetRowHeader",function(e,n){return t.onAfterGetRowHeader(e,n)}):this.addHook("afterRenderer",function(e,n){return t.onAfterGetRowHeader(n,e)}),this.addHook("afterContextMenuDefaultOptions",function(e){return t.onAfterContextMenuDefaultOptions(e)}),this.addHook("afterGetCellMeta",function(e,n,r){return t.onAfterGetCellMeta(e,n,r)}),this.addHook("modifyRowHeight",function(e,n){return t.onModifyRowHeight(e,n)}),this.addHook("beforeSetRangeStartOnly",function(e){return t.onBeforeSetRangeStartOnly(e)}),this.addHook("beforeSetRangeStart",function(e){return t.onBeforeSetRangeStart(e)}),this.addHook("beforeSetRangeEnd",function(e){return t.onBeforeSetRangeEnd(e)}),this.addHook("hiddenRow",function(e){return t.isHidden(e)}),this.addHook("afterCreateRow",function(e,n){return t.onAfterCreateRow(e,n)}),this.addHook("afterRemoveRow",function(e,n){return t.onAfterRemoveRow(e,n)}),this.addHook("init",function(){return t.onInit()}),this.hot.view&&this.onInit(),jp(Ip(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onInit(),jp(Ip(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={},this.hiddenRows=[],this.lastSelectedRow=-1,jp(Ip(e.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(t){var e=this,n=this.hiddenRows,r=this.isRowDataValid(t),o=Object(w.arrayMap)(t,function(t){return e.hot.toPhysicalRow(t)}),i=n;r&&(i=this.hiddenRows.filter(function(t){return!1===o.includes(t)})),!1!==this.hot.runHooks("beforeUnhideRows",n,i,r)&&(r&&(this.hiddenRows=i),this.hot.runHooks("afterUnhideRows",n,i,r,r&&i.length<n.length))}},{key:"showRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showRows(e)}},{key:"hideRows",value:function(t){var e=this,n=this.hiddenRows,r=this.isRowDataValid(t),o=Object(w.arrayMap)(t,function(t){return e.hot.toPhysicalRow(t)}),i=n;r&&(i=Array.from(new Set(n.concat(o)))),!1!==this.hot.runHooks("beforeHideRows",n,i,r)&&(r&&(this.hiddenRows=i),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}},{key:"hideRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideRows(e)}},{key:"isHidden",value:function(t){var e=t;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(e=this.hot.toPhysicalRow(t)),this.hiddenRows.includes(e)}},{key:"isRowDataValid",value:function(t){var e=this;return t.every(function(t){return Number.isInteger(t)&&t>=0&&t<e.hot.countRows()})}},{key:"resetCellsMeta",value:function(){Object(w.arrayEach)(this.hot.getCellsMeta(),function(t){t&&(t.skipRowOnPaste=!1)})}},{key:"onAfterGetCellMeta",value:function(t,e,n){var r=this.hot.runHooks("unmodifyRow",t);if(!1===this.settings.copyPasteEnabled&&this.isHidden(r)?n.skipRowOnPaste=!0:n.skipRowOnPaste=!1,this.isHidden(r-1)){var o=!0,i=r-1;n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");do{if(!this.isHidden(i)){o=!1;break}i-=1}while(i>=0);o&&-1===n.className.indexOf("firstVisibleRow")&&(n.className+=" firstVisibleRow")}else if(n.className){var a=n.className.split(" ");if(a.length){var s=a.indexOf("afterHiddenRow");s>-1&&a.splice(s,1);var l=a.indexOf("firstVisibleRow");l>-1&&a.splice(l,1),n.className=a.join(" ")}}}},{key:"onAfterGetRowHeader",value:function(t,e){var n=e.parentNode;n&&(this.isHidden(t)?Object(b.addClass)(n,"hide"):Object(b.removeClass)(n,"hide"));var r=!0,o=t-1;do{if(!this.isHidden(o)){r=!1;break}o-=1}while(o>=0);r&&Object(b.addClass)(e,"firstVisibleRow"),this.settings.indicators&&this.hot.hasRowHeaders()&&(this.isHidden(t-1)&&Object(b.addClass)(e,"afterHiddenRow"),this.isHidden(t+1)&&Object(b.addClass)(e,"beforeHiddenRow"))}},{key:"onModifyRowHeight",value:function(t,e){return this.isHidden(e)?.1:t}},{key:"onModifyCopyableRange",value:function(t){var e=this,n=[],r=function(t,e,r,o){n.push({startRow:t,endRow:e,startCol:r,endCol:o})};return Object(w.arrayEach)(t,function(t){var n=!0,o=0;Object(_.rangeEach)(t.startRow,t.endRow,function(i){e.isHidden(i)?(n||r(o,i-1,t.startCol,t.endCol),n=!0):(n&&(o=i),i===t.endRow&&r(o,i,t.startCol,t.endCol),n=!1)})}),n}},{key:"onBeforeSetRangeStart",value:function(t){var e=this,n=this.hot.getSelectedLast()||!1,r=this.hot.countRows()-1;t.row=function t(o){var i=0,a=o;return n&&(i=a>n[0]?1:-1,e.lastSelectedRow=n[0]),r<a||a<0?e.lastSelectedRow:(e.isHidden(a)&&(a=t(a+i)),a)}(t.row)}},{key:"onBeforeSetRangeStartOnly",value:function(t){var e=this;if(!(t.row>0)){t.row=0;t.row=function t(n){var r=n;return e.isHidden(r)&&(r=t(r+=1)),r}(t.row)}}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this,n=this.hot.countRows();t.row=function r(o){var i=o;return e.isHidden(i)&&(e.lastSelectedRow>i||t.row===n-1?i>0?i=r(i-=1):Object(_.rangeEach)(0,e.lastSelectedRow,function(t){if(!e.isHidden(t))return i=t,!1}):i=r(i+=1)),i}(t.row),this.lastSelectedRow=t.row}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;t.items.push({name:"---------"},(e=this,{key:"hidden_rows_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=Mp(t,3);n[0]-n[2]!=0&&(e=1)}return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_HIDE_ROW,e)},callback:function(){var t=this.getSelectedRangeLast(),n=t.from,r=t.to,o=Math.min(n.row,r.row),i=Math.max(n.row,r.row);Object(_.rangeEach)(o,i,function(t){return e.hideRow(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.isSelectedByRowHeader()}}),function(t){var e=[],n=[];return{key:"hidden_rows_show",name:function(){var r=this.getSelectedLast(),o=0;if(Array.isArray(r)){var i=_p(r,3),a=i[0],s=i[2];if(a>s){var l=[s,a];a=l[0],s=l[1]}var u=0;a===s?u=e.length+n.length:Object(_.rangeEach)(a,s,function(e){t.isHidden(e)&&(u+=1)}),o=u<=1?0:1}return this.getTranslatedPhrase(rn.CONTEXTMENU_ITEMS_SHOW_ROW,o)},callback:function(){var r=this.getSelectedRangeLast(),o=r.from,i=r.to,a=Math.min(o.row,i.row),s=Math.max(o.row,i.row);a===s?(e.length===a&&(t.showRows(e),e.length=0),n.length===this.countSourceRows()-(a+1)&&(t.showRows(n),n.length=0)):Object(_.rangeEach)(a,s,function(e){return t.showRow(e)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!t.hiddenRows.length||!this.selection.isSelectedByRowHeader())return!0;e.length=0,n.length=0;var r=this.getSelectedRangeLast(),o=r.from,i=r.to,a=Math.min(o.row,i.row),s=Math.max(o.row,i.row),l=!1;if(a===s){var u=this.countSourceRows();Object(_.rangeEach)(0,u,function(r){if(e.length+n.length===t.hiddenRows.length)return!1;r<a?t.isHidden(r)&&e.push(r):t.isHidden(r)&&n.push(r)}),u-=1,(e.length===a&&a>0||n.length===u-a&&a<u)&&(l=!0)}else Object(_.rangeEach)(a,s,function(e){if(t.isHidden(e))return l=!0,!1});return!l}}}(this))}},{key:"onAfterCreateRow",value:function(t,e){var n=[];Object(w.arrayEach)(this.hiddenRows,function(r){var o=r;o>=t&&(o+=e),n.push(o)}),this.hiddenRows=n}},{key:"onAfterRemoveRow",value:function(t,e){var n=[];Object(w.arrayEach)(this.hiddenRows,function(r){var o=r;o>=t&&(o-=e),n.push(o)}),this.hiddenRows=n}},{key:"onInit",value:function(){var t=this,e=this.hot.getSettings().hiddenRows;"object"===Np(e)&&(this.settings=e,void 0===e.copyPasteEnabled&&(e.copyPasteEnabled=!0),Array.isArray(e.rows)&&this.hideRows(e.rows),e.copyPasteEnabled||this.addHook("modifyCopyableRange",function(e){return t.onModifyCopyableRange(e)}))}},{key:"destroy",value:function(){jp(Ip(e.prototype),"destroy",this).call(this)}}])&&Ap(n.prototype,r),o&&Ap(n,o),e}();Object(P.d)("hiddenRows",Pp);var Lp=Pp;function Hp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Fp=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.trimRows=e}var e,n,r;return e=t,(n=[{key:"createMap",value:function(t){var e=this,n=0,r=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(_.rangeEach)(r-1,function(t){e.trimRows.isTrimmed(t)?n+=1:e._arrayMap[t-n]=t})}},{key:"destroy",value:function(){this._arrayMap=null}}])&&Hp(e.prototype,n),r&&Hp(e,r),t}();Object(N.mixin)(Fp,Jt);var Bp=Fp;function Wp(t){return(Wp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Up(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yp(t,e,n){return(Yp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zp(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function zp(t){return(zp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gp(t,e){return(Gp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xp=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,(n=!(o=zp(e).call(this,t))||"object"!==Wp(o)&&"function"!=typeof o?Up(r):o).trimmedRows=[],n.removedRows=[],n.rowsMapper=new Bp(Up(n)),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gp(t,e)}(e,B),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().trimRows;Array.isArray(n)&&(this.trimmedRows=n),this.rowsMapper.createMap(this.hot.countSourceRows()),this.addHook("modifyRow",function(e,n){return t.onModifyRow(e,n)}),this.addHook("unmodifyRow",function(e,n){return t.onUnmodifyRow(e,n)}),this.addHook("beforeCreateRow",function(e,n,r){return t.onBeforeCreateRow(e,n,r)}),this.addHook("afterCreateRow",function(e,n){return t.onAfterCreateRow(e,n)}),this.addHook("beforeRemoveRow",function(e,n){return t.onBeforeRemoveRow(e,n)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow()}),this.addHook("afterLoadData",function(e){return t.onAfterLoadData(e)}),Yp(zp(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().trimRows;Array.isArray(t)&&(this.disablePlugin(),this.enablePlugin()),Yp(zp(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.trimmedRows=[],this.removedRows.length=0,this.rowsMapper.clearMap(),Yp(zp(e.prototype),"disablePlugin",this).call(this)}},{key:"trimRows",value:function(t){var e=this.trimmedRows,n=this.isValidConfig(t),r=e;n&&(r=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeTrimRow",e,r,n)&&(n&&(this.trimmedRows=r,this.hot.runHooks("skipLengthCache",100),this.rowsMapper.createMap(this.hot.countSourceRows())),this.hot.runHooks("afterTrimRow",e,r,n,n&&r.length>e.length))}},{key:"trimRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.trimRows(e)}},{key:"untrimRows",value:function(t){var e=this.trimmedRows,n=this.isValidConfig(t),r=e;n&&(r=this.trimmedRows.filter(function(e){return!1===t.includes(e)})),!1!==this.hot.runHooks("beforeUntrimRow",e,r,n)&&(n&&(this.trimmedRows=r,this.hot.runHooks("skipLengthCache",100),this.rowsMapper.createMap(this.hot.countSourceRows())),this.hot.runHooks("afterUntrimRow",e,r,n,n&&r.length<e.length))}},{key:"untrimRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.untrimRows(e)}},{key:"isTrimmed",value:function(t){return this.trimmedRows.includes(t)}},{key:"untrimAll",value:function(){this.untrimRows([].concat(this.trimmedRows))}},{key:"isValidConfig",value:function(t){var e=this;return t.every(function(t){return Number.isInteger(t)&&t>=0&&t<e.hot.countSourceRows()})}},{key:"onModifyRow",value:function(t,e){var n=t;return e!==this.pluginName&&(n=this.rowsMapper.getValueByIndex(n)),n}},{key:"onUnmodifyRow",value:function(t,e){var n=t;return e!==this.pluginName&&(n=this.rowsMapper.getIndexByValue(n)),n}},{key:"onBeforeCreateRow",value:function(t,e,n){if(this.isEnabled()&&this.trimmedRows.length>0&&"auto"===n)return!1}},{key:"onAfterCreateRow",value:function(t,e){var n=this;this.rowsMapper.shiftItems(t,e),this.trimmedRows=Object(w.arrayMap)(this.trimmedRows,function(r){return r>=n.rowsMapper.getValueByIndex(t)?r+e:r})}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&Object(_.rangeEach)(t,t+e-1,function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t,n.pluginName))})}},{key:"onAfterRemoveRow",value:function(){var t=this;this.rowsMapper.unshiftItems(this.removedRows),this.trimmedRows=Object(w.arrayMap)(this.trimmedRows,function(e){return e-t.removedRows.filter(function(t){return t<e}).length})}},{key:"onAfterLoadData",value:function(t){t||this.rowsMapper.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.rowsMapper.destroy(),Yp(zp(e.prototype),"destroy",this).call(this)}}])&&Vp(n.prototype,r),o&&Vp(n,o),e}();Object(P.d)("trimRows",Xp);var qp=Xp,Kp=n(131),$p=n(88),Zp=n(132),Qp=n(69);function Jp(t,e){var n=new v.a(t,e||{},$p.d);return n.init(),n}!function(t){var e="undefined"!=typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){var n,r=this.first(),o=r.data("handsontable");if("string"!=typeof e){var i=e||{};return o?o.updateSettings(i):(o=new t.Core(r[0],i),r.data("handsontable",o),o.init()),r}if(o){if(void 0===o[e])throw new Error("Handsontable do not provide action: ".concat(e));for(var a,s=arguments.length,l=new Array(s>1?s-1:0),u=1;u<s;u++)l[u-1]=arguments[u];n=(a=o[e]).call.apply(a,[o].concat(l)),"destroy"===e&&r.removeData()}return n})}(Jp),Jp.Core=v.a,Jp.DefaultSettings=Kp.a,Jp.EventManager=y.a,Jp._getListenersCounter=y.b,Jp.packageName="handsontable",Jp.buildDate="09/04/2019 12:56:59",Jp.version="7.0.2",Jp.hooks=m.a.getSingleton(),Jp.__GhostTable=O;var tg=[w,E,S,k,R,T,M,_,N,A,x,j],eg=[b,I];Jp.helper={},Jp.dom={},w.arrayEach(tg,function(t){w.arrayEach(Object.getOwnPropertyNames(t),function(e){"_"!==e.charAt(0)&&(Jp.helper[e]=t[e])})}),w.arrayEach(eg,function(t){w.arrayEach(Object.getOwnPropertyNames(t),function(e){"_"!==e.charAt(0)&&(Jp.dom[e]=t[e])})}),Jp.cellTypes={},w.arrayEach(Object(g.b)(),function(t){Jp.cellTypes[t]=Object(g.a)(t)}),Jp.cellTypes.registerCellType=g.c,Jp.cellTypes.getCellType=g.a,Jp.editors={},w.arrayEach(Object(h.c)(),function(t){Jp.editors["".concat(x.toUpperCaseFirst(t),"Editor")]=Object(h.a)(t)}),Jp.editors.registerEditor=h.d,Jp.editors.getEditor=h.a,Jp.renderers={},w.arrayEach(Object(d.a)(),function(t){var e=Object(d.b)(t);"base"===t&&(Jp.renderers.cellDecorator=e),Jp.renderers["".concat(x.toUpperCaseFirst(t),"Renderer")]=e}),Jp.renderers.registerRenderer=d.c,Jp.renderers.getRenderer=d.b,Jp.validators={},w.arrayEach(Object(p.a)(),function(t){Jp.validators["".concat(x.toUpperCaseFirst(t),"Validator")]=Object(p.b)(t)}),Jp.validators.registerValidator=p.c,Jp.validators.getValidator=p.b,Jp.plugins={},w.arrayEach(Object.getOwnPropertyNames(u),function(t){var e=u[t];"Base"===t?Jp.plugins["".concat(t,"Plugin")]=e:Jp.plugins[t]=e}),Jp.plugins.registerPlugin=P.d,Jp.languages={},Jp.languages.dictionaryKeys=rn,Jp.languages.getLanguageDictionary=Qp.b,Jp.languages.getLanguagesDictionaries=Qp.c,Jp.languages.registerLanguageDictionary=Qp.e,Jp.languages.getTranslatedPhrase=function(){return Zp.a.apply(void 0,arguments)};var ng=Jp,rg=n(94),og=n.n(rg);n(155);function ig(t){return t.toLowerCase().replace(/\b[a-z]/g,t=>t.toUpperCase())}function ag(t){window.innerWidth>600?t.fit(500,500):t.fit(window.innerWidth,window.innerHeight)}const sg=f.a.ternary.graticule().majorInterval(.2).minorInterval(.05),lg=f.a.ternary.plot().call(ag,[500,500]).call(f.a.ternary.scalebars()).call(f.a.ternary.neatline()).call(sg);let ug,cg=!1;const fg=["colour","color","shape","linestyle","title","opacity"];function hg(){f.a.selectAll(".vertex-label").remove(),cg=!1,ug=void 0}function dg(t){ug?JSON.stringify(t.slice(0,3))!==JSON.stringify(ug)&&og()("Your columns in Points, Lines and areas don't seem to match",`Your columns you entered first are '${ug}' and for your columns now are '${t.slice(0,3)}'. Your data will still be plotted, but it might not appear the way you intended.`,"warning"):(ug=t.slice(0,3),cg||(!function(t){const e=t.columns.slice(0,3);lg.call(f.a.ternary.vertexLabels(e))}({columns:t}),cg=!0)),t.some(t=>{if(fg.includes(t))return og()("Reserved column name",`You can't use any of the following names as your columns names: ${fg.join(", ")}`,"error")})}function pg(t){let e=Object.values(t);const n=[[e=[e[0],e[2],e[1]],[0,parseFloat(e[0])+parseFloat(e[1]),parseFloat(e[2])]],[e,[parseFloat(e[0]),0,parseFloat(e[1])+parseFloat(e[2])]],[e,[parseFloat(e[0])+parseFloat(e[2]),parseFloat(e[1]),0]]];lg.plot().selectAll(".line").data(n).enter().append("path").attr("class","help-line").attr("d",t=>lg.path(t)).attr("stroke-dasharray","3, 3, 3").attr("stroke","black").attr("stroke-width","1px").attr("z-index","-1")}const gg={Points(t){let e=t;const n=e.shift();for(dg(n),e.map(t=>{for(;null===t[t.length-1]||""===t[t.length-1];)t.pop();return t});null===n[n.length-1]||""===n[n.length-1];)n.pop();return(e=e.filter(t=>0!==t.length)).map(t=>{return n.reduce((e,n,r)=>{const o=e;return o[n.toLowerCase()]=t[r],o},{})})},LinesAreas(t){const e=t,n=e.shift();for(dg(n),e.map(t=>{for(;null===t[t.length-1]||""===t[t.length-1];)t.pop();return t});null===n[n.length-1]||""===n[n.length-1];)n.pop();const r=[];let o=[];for(const t of e)0!==t.length?o.push(t):0===t.length&&(0!==o.length&&r.push(o),o=[]);return r.map(t=>{return t.map(t=>{return n.reduce((e,n,r)=>{const o=e;return o[n.toLowerCase()]=t[r],o},{})})})}},vg={defaults:{pointColor:"black",pointShape:"circle",pointSize:70,lineStyle:"none",lineColor:"black",lineStrokewidth:"4px",areaColor:"gold",areaOpacity:.2},setListeners(){document.querySelector("#defaultColorPoints").onchange=(t=>{vg.defaults.pointColor=t.target.value}),document.querySelector("select[name='defaultShape']").onchange=(t=>{vg.defaults.pointShape=t.target.value}),document.querySelector("#defaultColorLines").onchange=(t=>{vg.defaults.lineColor=t.target.value}),document.querySelector("select[name='defaultLineStyle']").onchange=(t=>{vg.defaults.lineStyle=t.target.value}),document.querySelector("#defaultColorAreas").onchange=(t=>{vg.defaults.areaColor=t.target.value}),document.querySelector("select[name='defaultAreaOpacity']").onchange=(t=>{vg.defaults.areaOpacity=t.target.value})},Points(t){const e=t.slice([0,3]),n=f.a.svg.symbol();lg.plot().selectAll(".point").data(e).enter().append("path").attr("class","point").attr("fill",t=>t.color?t.color.trim():t.colour?t.colour.trim():vg.defaults.pointColor).attr("fill-opacity",t=>t.opacity?t.opacity:1).attr("d",n.type(t=>t.shape?t.shape.trim():vg.defaults.pointShape).size(t=>t.size?t.size:vg.defaults.pointSize)).attr("transform",t=>{const e=Object.values(t),n=[e[0],e[2],e[1]],r=lg.point(n);return`translate(${r[0]},${r[1]})`}).on("mouseover",pg).on("mouseout",()=>{f.a.selectAll(".help-line").remove()}).append("title").text(t=>{const e=Object.entries(t);if(e){const n=`${e[0].join(": ")}\n${e[2].join(": ")}\n${e[1].join(": ")}`;return t.title?`${ig(t.title.trim())} \n ${n}`:n}})},Lines(t){const e=lg.plot().selectAll(".line").data(t),n={dotted:"3 2","dot-dash":"10 3 4 3","dot-dot-dash":"10 3 4 3 4 3","short-dashed":4,"medium-dashed":17,"long-dashed":26};e.enter().append("path").attr("class","ternary-line").attr("d",t=>{const e=[];return t.forEach(t=>{const n=Object.values(t);e.push([n[0],n[2],n[1]])}),lg.path(e)}).attr("stroke-dasharray",t=>t[0].linestyle?n[t[0].linestyle]:vg.defaults.lineStyle).attr("stroke",t=>t[0].color?t[0].color.trim():t[0].colour?t[0].colour.trim():vg.defaults.lineColor).attr("stroke-opacity",t=>t[0].opacity?t[0].opacity.trim():1).attr("fill-opacity","0").attr("stroke-width",t=>t[0].strokewidth?t[0].strokewidth:vg.defaults.lineStrokewidth).append("title").text(t=>t[0].title?ig(t[0].title.trim()):void 0)},Areas(t){lg.plot().selectAll(".area").data(t).enter().append("path").attr("class","ternary-area").attr("d",t=>{const e=[];return t.forEach(t=>{const n=Object.values(t);e.push([n[0],n[2],n[1]])}),lg.area(e)}).attr("z-index",-1).attr("fill",t=>t[0].color?t[0].color.trim():vg.defaults.areaColor).attr("fill-opacity",t=>t[0].opacity?t[0].opacity:.5).append("title").text(t=>t[0].title?ig(t[0].title.trim()):void 0)}};f.a.select("#ternary-plot").call(lg),window.addEventListener("resize",ag(lg));n(231),n(236);if(document.cookie.split(";").filter(t=>t.includes("visited=true")).length)document.querySelector("#intro").remove();else{const t=new Date;t.setDate(t.getDate()+3),document.cookie=`visited=true;expires=${t}`}function yg(t){f.a.selectAll(t).remove()}function mg(t,e,n){return new ng(document.getElementById(t),{colHeaders:e,columns:n,fixedRowsTop:1,manualRowMove:!0,rowHeaders:!0,minRows:60,height:330,width:500,dropdownMenu:!0,manualColumnResize:!0,licenseKey:"non-commercial-and-evaluation",cells(){const t={renderer:"emptyCellRenderer"};return t},afterChange(){const e=t;this.getData()[0][0]&&(localStorage[e]=JSON.stringify(this.getData()))}})}ng.renderers.registerRenderer("emptyCellRenderer",function(t,e,n,r,o,i){ng.renderers.TextRenderer.apply(this,arguments),null!==i&&""!==i||(e.style.background="#efefef")});const bg=["Variable 1","Variable 2","Variable 3","Color","Shape","Size","Opacity","Title"],wg=mg("pointsTable",bg,[{type:"numeric"},{type:"numeric"},{type:"numeric"},{},{type:"dropdown",source:["circle","cross","diamond","triangle-down","triangle-up"]},{type:"numeric"},{type:"numeric"},{}]),Cg=document.enterPoints;ng.dom.addEvent(Cg,"submit",t=>{t.preventDefault(),yg(".point");const e=gg.Points(wg.getData());vg.Points(e)});const Og=["Variable 1","Variable 2","Variable 3","Color","Linestyle","Strokewidth","Title"],Eg=mg("linesTable",Og,[{type:"numeric"},{type:"numeric"},{type:"numeric"},{},{type:"dropdown",source:["dotted","dot-dash","dot-dot-dash","short-dashed","medium-dashed","long-dashed"]},{type:"numeric"},{}]),Sg=document.enterLines;ng.dom.addEvent(Sg,"submit",t=>{t.preventDefault(),yg(".ternary-line");const e=gg.LinesAreas(Eg.getData());vg.Lines(e)});const kg=["Variable 1","Variable 2","Variable 3","Color","Opacity","Title"],Rg=mg("areasTable",kg,[{type:"numeric"},{type:"numeric"},{type:"numeric"},{},{type:"numeric"},{}]),Tg=document.enterAreas;ng.dom.addEvent(Tg,"submit",t=>{t.preventDefault(),yg(".ternary-area");const e=gg.LinesAreas(Rg.getData());vg.Areas(e)});let Mg=[["1. Sand","2. Silt","3. Clay","Color","Shape","Size","Opacity","Title"],[.3,.3,.4,"limegreen",,,1,"Sample Nr 1"],[1,0,0],[0,1,0],[0,0,1],[.2,.5,.3,"coral",,800,.5,"Half opacity big point"],[.3,.1,.6,"magenta","cross"],[.5,.5,0,"#d1b621","diamond"],[.6,.2,.2,"peru","triangle-up"]],_g=[["1. Sand","2. Silt","3. Clay","Color","Linestyle","Strokewidth","Title"],[.2,.8,0,"orangered","dot-dash",2,"Dotted line #1"],[.8,0,.2],[],[.1,.1,.8,"slateblue"],[.4,.1,.5],[0,0,1]],Ng=[["1. Sand","2. Silt","3. Clay","Color","Opacity","Title"],[0,.5,.5,"palegreen",.1,"More than 50% silt"],[.5,.5,0],[0,1,0],[],[.5,0,.5,"moccasin",.4,"More than 50% sand"],[.5,.5,0],[1,0,0],[],[0,.5,.5,"coral",.3,"More than 50% clay"],[.5,0,.5],[0,0,1]];if(localStorage.getItem("pointsTable")){og()("You've been here before!","Do you wan't to load your previously entered data into the tables?",{buttons:{sample:{text:"No, show sample data",value:null,visible:!0,className:"show-sample",closeModal:!0},empty:{text:"No, empty the tables",value:"empty",visible:!0,className:"show-empty",closeModal:!0},load:{text:"Yes, load previous data",value:"ok",visible:!0,className:"load-old",closeModal:!0}}}).then(t=>{"ok"===t?(Mg=JSON.parse(localStorage.getItem("pointsTable")),_g=JSON.parse(localStorage.getItem("linesTable")),Ng=JSON.parse(localStorage.getItem("areasTable"))):"empty"===t&&(Mg=[bg],_g=[Og],Ng=[kg]),wg.loadData(Mg),Eg.loadData(_g),Rg.loadData(Ng)})}else wg.loadData(Mg),Eg.loadData(_g),Rg.loadData(Ng);vg.setListeners();const Ag=document.getElementById("clearPoints");Ag.addEventListener("click",()=>yg(".point")),Ag.addEventListener("mouseover",()=>{f.a.selectAll(".point").attr("opacity","0.4"),setTimeout(()=>{f.a.selectAll(".point").attr("opacity","1")},600)});const xg=document.getElementById("clearLines");xg.addEventListener("click",()=>yg(".ternary-line")),xg.addEventListener("mouseover",()=>{f.a.selectAll(".ternary-line").attr("stroke-opacity","0.3"),setTimeout(()=>{f.a.selectAll(".ternary-line").attr("stroke-opacity","1")},600)});const jg=document.getElementById("clearAreas");jg.addEventListener("click",()=>yg(".ternary-area")),jg.addEventListener("mouseover",()=>{f.a.selectAll(".ternary-area").attr("opacity","0.1"),setTimeout(()=>{f.a.selectAll(".ternary-area").attr("opacity","1")},600)});const Ig=document.getElementById("clearLabels");Ig.addEventListener("click",hg),Ig.addEventListener("mouseover",()=>{f.a.selectAll(".vertex-label").attr("text-decoration","line-through"),setTimeout(()=>{f.a.selectAll(".vertex-label").attr("text-decoration","none")},600)});const Dg=document.getElementById("clearAll");function Pg(t,e){og()(`This will remove all values you have entered into ${e}`,"There's no going back once you click OK!",{buttons:["Cancel","OK, remove values"],icon:"warning"}).then(e=>{e&&t.forEach(t=>{let e;switch(t){case wg:e=bg;break;case Eg:e=Og;break;case Rg:e=kg;break;default:e=[]}t.loadData([e])})})}Dg.addEventListener("click",function(){yg(".ternary-line,.ternary-area,.point"),hg()}),Dg.addEventListener("mouseover",()=>{f.a.selectAll(".ternary-line,.vertex-label,.ternary-area,.point").attr("opacity","0.3").attr("text-decoration","line-through").attr("stroke-opacity","0.3"),setTimeout(()=>{f.a.selectAll(".ternary-line,.vertex-label,.ternary-area,.point").attr("opacity","1").attr("text-decoration","none").attr("stroke-opacity","1")},600)}),document.getElementById("clearAllTables").addEventListener("click",()=>{Pg([wg,Eg,Rg],"all tables.")}),document.getElementById("clearPointsTable").addEventListener("click",()=>{Pg([wg],"the points table.")}),document.getElementById("clearLinesTable").addEventListener("click",()=>{Pg([Eg],"the lines table.")}),document.getElementById("clearAreasTable").addEventListener("click",()=>{Pg([Rg],"the areas table.")})},function(t,e){},,,,,function(t,e){}]);