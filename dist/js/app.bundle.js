!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/js",n(n.s=266)}([function(t,e,n){"use strict";n.r(e),n.d(e,"getParent",(function(){return u})),n.d(e,"getFrameElement",(function(){return c})),n.d(e,"getParentWindow",(function(){return f})),n.d(e,"hasAccessToParentWindow",(function(){return h})),n.d(e,"closest",(function(){return d})),n.d(e,"closestDown",(function(){return p})),n.d(e,"isChildOf",(function(){return g})),n.d(e,"isChildOfWebComponentTable",(function(){return v})),n.d(e,"polymerWrap",(function(){return y})),n.d(e,"polymerUnwrap",(function(){return m})),n.d(e,"index",(function(){return b})),n.d(e,"overlayContainsElement",(function(){return w})),n.d(e,"hasClass",(function(){return S})),n.d(e,"addClass",(function(){return k})),n.d(e,"removeClass",(function(){return R})),n.d(e,"removeTextNodes",(function(){return _})),n.d(e,"empty",(function(){return T})),n.d(e,"HTML_CHARACTERS",(function(){return A})),n.d(e,"fastInnerHTML",(function(){return N})),n.d(e,"fastInnerText",(function(){return j})),n.d(e,"isVisible",(function(){return x})),n.d(e,"offset",(function(){return I})),n.d(e,"getWindowScrollTop",(function(){return D})),n.d(e,"getWindowScrollLeft",(function(){return P})),n.d(e,"getScrollTop",(function(){return L})),n.d(e,"getScrollLeft",(function(){return H})),n.d(e,"getScrollableElement",(function(){return F})),n.d(e,"getTrimmingContainer",(function(){return B})),n.d(e,"getStyle",(function(){return U})),n.d(e,"matchesCSSRules",(function(){return W})),n.d(e,"getComputedStyle",(function(){return V})),n.d(e,"outerWidth",(function(){return Y})),n.d(e,"outerHeight",(function(){return z})),n.d(e,"innerHeight",(function(){return G})),n.d(e,"innerWidth",(function(){return X})),n.d(e,"addEvent",(function(){return q})),n.d(e,"removeEvent",(function(){return K})),n.d(e,"getCaretPosition",(function(){return $})),n.d(e,"getSelectionEndPosition",(function(){return Q})),n.d(e,"getSelectionText",(function(){return Z})),n.d(e,"clearTextSelection",(function(){return J})),n.d(e,"setCaretPosition",(function(){return tt})),n.d(e,"getScrollbarWidth",(function(){return nt})),n.d(e,"hasVerticalScrollbar",(function(){return rt})),n.d(e,"hasHorizontalScrollbar",(function(){return ot})),n.d(e,"setOverlayPosition",(function(){return it})),n.d(e,"getCssTransform",(function(){return at})),n.d(e,"resetCssTransform",(function(){return st})),n.d(e,"isInput",(function(){return lt})),n.d(e,"isOutsideInput",(function(){return ut})),n.d(e,"selectElementIfAllowed",(function(){return ct}));n(10),n(11),n(12),n(27),n(30),n(43),n(23),n(7),n(70),n(38),n(17),n(5),n(129),n(33),n(15),n(54),n(8),n(58),n(69),n(147),n(9);var r,o,i,a=n(39),s=n(37);function l(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,o=t;null!==o;){if(n===e){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(n+=1,o=o.parentNode)}return r}function c(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function f(t){return c(t)&&t.parent}function h(t){return!!Object.getPrototypeOf(t.parent)}function d(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=Node,o=r.ELEMENT_NODE,i=r.DOCUMENT_FRAGMENT_NODE,a=t;null!=a&&a!==n;){var s=a,l=s.nodeType,u=s.nodeName;if(l===o&&(e.includes(u)||e.includes(a)))return a;var c=a,f=c.host;a=f&&l===i?f:a.parentNode}return null}function p(t,e,n){for(var r=[],o=t;o&&(o=d(o,e,n))&&(!n||n.contains(o));)r.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode;var i=r.length;return i?r[i-1]:null}function g(t,e){var n=t.parentNode,r=[];for("string"==typeof e?r=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function v(t){var e=!1,n=y(t);function r(t){return t.nodeType===Node.ELEMENT_NODE&&t.nodeName==="hot-table".toUpperCase()}for(;null!==n;){if(r(n)){e=!0;break}if(n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(e=r(n.host))break;n=n.host}n=n.parentNode}return e}function y(t){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(t):t}function m(t){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(t):t}function b(t){var e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function w(t,e,n){var r=n.parentElement.querySelector(".ht_clone_".concat(t));return r?r.contains(e):null}function O(t){var e=[];if(!t||!t.length)return e;for(var n=0;t[n];)e.push(t[n]),n+=1;return e}if(Object(s.isClassListSupported)()){var C=function(t){var e=t.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")};r=function(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)},o=function(t,e){var n,r=t.ownerDocument,o=e;if("string"==typeof o&&(o=o.split(" ")),(o=O(o)).length>0)if(C(r))(n=t.classList).add.apply(n,l(o));else for(var i=0;o&&o[i];)t.classList.add(o[i]),i+=1},i=function(t,e){var n,r=e;if("string"==typeof r&&(r=r.split(" ")),(r=O(r)).length>0)if(C)(n=t.classList).remove.apply(n,l(r));else for(var o=0;r&&r[o];)t.classList.remove(r[o]),o+=1}}else{var E=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};r=function(t,e){return void 0!==t.className&&E(e).test(t.className)},o=function(t,e){var n=0,r=t.className,o=e;if("string"==typeof o&&(o=o.split(" ")),""===r)r=o.join(" ");else for(;o&&o[n];)E(o[n]).test(r)||(r+=" ".concat(o[n])),n+=1;t.className=r},i=function(t,e){var n=0,r=t.className,o=e;for("string"==typeof o&&(o=o.split(" "));o&&o[n];)r=r.replace(E(o[n])," ").trim(),n+=1;t.className!==r&&(t.className=r)}}function S(t,e){return r(t,e)}function k(t,e){return o(t,e)}function R(t,e){return i(t,e)}function _(t,e){if(3===t.nodeType)e.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var n=t.childNodes,r=n.length-1;r>=0;r--)_(n[r],t)}function T(t){for(var e;e=t.lastChild;)t.removeChild(e)}var M,A=/(<(.*)>|&(.*);)/;function N(t,e){A.test(e)?t.innerHTML=e:j(t,e)}function j(t,e){var n=t.firstChild;n&&3===n.nodeType&&null===n.nextSibling?s.isTextContentSupported?n.textContent=e:n.data=e:(T(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function x(t){for(var e=t.ownerDocument.documentElement,n=t;m(n)!==e;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return x(n.host.impl);if(n.host)return x(n.host);throw new Error("Lost in Web Components world")}return!1}if(n.style&&"none"===n.style.display)return!1;n=n.parentNode}return!0}function I(t){var e,n,r,o,i=t.ownerDocument,a=i.defaultView,l=i.documentElement,u=t;if(Object(s.hasCaptionProblem)()&&u.firstChild&&"CAPTION"===u.firstChild.nodeName)return{top:(o=u.getBoundingClientRect()).top+(a.pageYOffset||l.scrollTop)-(l.clientTop||0),left:o.left+(a.pageXOffset||l.scrollLeft)-(l.clientLeft||0)};for(e=u.offsetLeft,n=u.offsetTop,r=u;(u=u.offsetParent)&&u!==i.body;)e+=u.offsetLeft,n+=u.offsetTop,r=u;return r&&"fixed"===r.style.position&&(e+=a.pageXOffset||l.scrollLeft,n+=a.pageYOffset||l.scrollTop),{left:e,top:n}}function D(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollY;return void 0===e&&(e=t.document.documentElement.scrollTop),e}function P(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollX;return void 0===e&&(e=t.document.documentElement.scrollLeft),e}function L(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?D(e):t.scrollTop}function H(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?P(e):t.scrollLeft}function F(t){var e=t.ownerDocument,n=e?e.defaultView:void 0;e||(n=(e=t.document?t.document:t).defaultView);for(var r=["auto","scroll"],o=Object(s.isGetComputedStyleSupported)(),i=t.parentNode;i&&i.style&&e.body!==i;){var a=i.style,l=a.overflow,u=a.overflowX,c=a.overflowY;if([l,u,c].includes("scroll"))return i;if(o){var f=n.getComputedStyle(i);if(l=f.overflow,u=f.overflowX,c=f.overflowY,r.includes(l)||r.includes(u)||r.includes(c))return i}if(i.clientHeight<=i.scrollHeight+1&&(r.includes(c)||r.includes(l)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(u)||r.includes(l)))return i;i=i.parentNode}return n}function B(t){for(var e=t.ownerDocument,n=e.defaultView,r=t.parentNode;r&&r.style&&e.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;var o=V(r,n),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),s=o.getPropertyValue("overflow-y"),l=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(s)||i.includes(l))return r;r=r.parentNode}return n}function U(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(t){if(t===n)return"width"===e?"".concat(n.innerWidth,"px"):"height"===e?"".concat(n.innerHeight,"px"):void 0;var r=t.style[e];if(""!==r&&void 0!==r)return r;var o=V(t,n);return""!==o[e]&&void 0!==o[e]?o[e]:void 0}}function W(t,e){var n=e.selectorText,r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function V(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function Y(t){return t.offsetWidth}function z(t){return Object(s.hasCaptionProblem)()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight}function G(t){return t.clientHeight||t.innerHeight}function X(t){return t.clientWidth||t.innerWidth}function q(t,e,n){var r=t.defaultView;r||(r=t.document?t:t.ownerDocument.defaultView),r.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on".concat(e),n)}function K(t,e,n){var r=t.defaultView;r||(r=t.document?t:t.ownerDocument.defaultView),r.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on".concat(e),n)}function $(t){var e=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(e.selection){t.focus();var n=e.selection.createRange();if(null===n)return 0;var r=t.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function Q(t){var e=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(e.selection){var n=e.selection.createRange();return null===n?0:t.createTextRange().text.indexOf(n.text)+n.text.length}return 0}function Z(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document,n="";return t.getSelection?n=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(n=e.selection.createRange().text),n}function J(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():e.selection&&e.selection.empty()}function tt(t,e,n){if(void 0===n&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch(i){var r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=o}}else if(t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",e),i.select()}}function et(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";var n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);var r=e.offsetWidth;n.style.overflow="scroll";var o=e.offsetWidth;return r===o&&(o=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-o}function nt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===M&&(M=et(t)),M}function rt(t){return t.offsetWidth!==t.clientWidth}function ot(t){return t.offsetHeight!==t.clientHeight}function it(t,e,n){Object(a.isIE8)()||Object(a.isIE9)()?(t.style.top=n,t.style.left=e):Object(a.isSafari)()?(t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(n,",0)"),t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(n,",0)")):t.style.transform="translate3d(".concat(e,",").concat(n,",0)")}function at(t){var e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:t.style["-webkit-transform"]&&""!==(e=t.style["-webkit-transform"])?["-webkit-transform",e]:-1}function st(t){t.style.transform&&""!==t.style.transform?t.style.transform="":t.style["-webkit-transform"]&&""!==t.style["-webkit-transform"]&&(t.style["-webkit-transform"]="")}function lt(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function ut(t){return lt(t)&&-1===t.className.indexOf("handsontableInput")&&-1===t.className.indexOf("HandsontableCopyPaste")}function ct(t){ut(t.ownerDocument.activeElement)||t.select()}},function(t,e,n){"use strict";n.r(e),n.d(e,"to2dArray",(function(){return r})),n.d(e,"extendArray",(function(){return o})),n.d(e,"pivot",(function(){return i})),n.d(e,"arrayReduce",(function(){return a})),n.d(e,"arrayFilter",(function(){return s})),n.d(e,"arrayMap",(function(){return l})),n.d(e,"arrayEach",(function(){return u})),n.d(e,"arraySum",(function(){return c})),n.d(e,"arrayMax",(function(){return f})),n.d(e,"arrayMin",(function(){return h})),n.d(e,"arrayAvg",(function(){return d})),n.d(e,"arrayFlatten",(function(){return p})),n.d(e,"arrayUnique",(function(){return g}));n(27),n(30),n(23),n(8);function r(t){for(var e=t.length,n=0;n<e;)t[n]=[t[n]],n+=1}function o(t,e){for(var n=e.length,r=0;r<n;)t.push(e[r]),r+=1}function i(t){var e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;for(var n=t.length,r=t[0].length,o=0;o<n;o++)for(var i=0;i<r;i++)e[i]||(e[i]=[]),e[i][o]=t[o][i];return e}function a(t,e,n,r){var o=-1,i=t,a=n;Array.isArray(t)||(i=Array.from(t));var s=i.length;for(r&&s&&(a=i[o+=1]),o+=1;o<s;)a=e(a,i[o],o,i),o+=1;return a}function s(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length,i=[],a=-1;n<o;){var s=r[n];e(s,n,r)&&(i[a+=1]=s),n+=1}return i}function l(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length,i=[],a=-1;n<o;){var s=r[n];i[a+=1]=e(s,n,r),n+=1}return i}function u(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));for(var o=r.length;n<o&&!1!==e(r[n],n,r);)n+=1;return t}function c(t){return a(t,(function(t,e){return t+e}),0)}function f(t){return a(t,(function(t,e){return t>e?t:e}),Array.isArray(t)?t[0]:void 0)}function h(t){return a(t,(function(t,e){return t<e?t:e}),Array.isArray(t)?t[0]:void 0)}function d(t){return t.length?c(t)/t.length:0}function p(t){return a(t,(function(t,e){return t.concat(Array.isArray(e)?p(e):e)}),[])}function g(t){var e=[];return u(t,(function(t){-1===e.indexOf(t)&&e.push(t)})),e}},function(t,e,n){"use strict";n.r(e),n.d(e,"duckSchema",(function(){return a})),n.d(e,"inherit",(function(){return s})),n.d(e,"extend",(function(){return l})),n.d(e,"deepExtend",(function(){return u})),n.d(e,"deepClone",(function(){return c})),n.d(e,"clone",(function(){return f})),n.d(e,"mixin",(function(){return h})),n.d(e,"isObjectEqual",(function(){return d})),n.d(e,"isObject",(function(){return p})),n.d(e,"defineGetter",(function(){return g})),n.d(e,"objectEach",(function(){return v})),n.d(e,"getProperty",(function(){return y})),n.d(e,"deepObjectSize",(function(){return m})),n.d(e,"createObjectPropListener",(function(){return b})),n.d(e,"hasOwnProperty",(function(){return w}));n(10),n(11),n(12),n(7),n(5),n(33),n(15),n(8),n(69),n(9);var r=n(1);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){var e;return Array.isArray(t)?e=[]:(e={},v(t,(function(t,n){"__children"!==n&&(t&&"object"===i(t)&&!Array.isArray(t)?e[n]=a(t):Array.isArray(t)?t.length&&"object"===i(t[0])&&!Array.isArray(t[0])?e[n]=[a(t[0])]:e[n]=[]:e[n]=null)}))),e}function s(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function l(t,e){return v(e,(function(e,n){t[n]=e})),t}function u(t,e){v(e,(function(n,r){e[r]&&"object"===i(e[r])?(t[r]||(Array.isArray(e[r])?t[r]=[]:"[object Date]"===Object.prototype.toString.call(e[r])?t[r]=e[r]:t[r]={}),u(t[r],e[r])):t[r]=e[r]}))}function c(t){return"object"===i(t)?JSON.parse(JSON.stringify(t)):t}function f(t){var e={};return v(t,(function(t,n){e[n]=t})),e}function h(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object(r.arrayEach)(n,(function(e){t.MIXINS.push(e.MIXIN_NAME),v(e,(function(e,n){if(void 0!==t.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"==typeof e)t.prototype[n]=e;else{Object.defineProperty(t.prototype,n,{get:(r=n,o=e,i="_".concat(r),function(){var t;return void 0===this[i]&&(this[i]=(t=o,(Array.isArray(t)||p(t))&&(t=c(t)),t)),this[i]}),set:function(t){var e="_".concat(t);return function(t){this[e]=t}}(n),configurable:!0})}var r,o,i}))})),t}function d(t,e){return JSON.stringify(t)===JSON.stringify(e)}function p(t){return"[object Object]"===Object.prototype.toString.call(t)}function g(t,e,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(t,e,r)}function v(t,e){for(var n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&!1===e(t[n],n,t))break;return t}function y(t,e){var n=e.split("."),r=t;return v(n,(function(t){if(void 0===(r=r[t]))return r=void 0,!1})),r}function m(t){if(!p(t))return 0;return function t(e){var n=0;return p(e)?v(e,(function(e){n+=t(e)})):n+=1,n}(t)}function b(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),i=(o(e={_touched:!1},r,t),o(e,"isTouched",(function(){return this._touched})),e);return Object.defineProperty(i,n,{get:function(){return this[r]},set:function(t){this._touched=!0,this[r]=t},enumerable:!0,configurable:!0}),i}function w(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},function(t,e,n){"use strict";n.r(e),n.d(e,"CONTEXT_MENU_ITEMS_NAMESPACE",(function(){return r})),n.d(e,"CONTEXTMENU_ITEMS_NO_ITEMS",(function(){return o})),n.d(e,"CONTEXTMENU_ITEMS_ROW_ABOVE",(function(){return i})),n.d(e,"CONTEXTMENU_ITEMS_ROW_BELOW",(function(){return a})),n.d(e,"CONTEXTMENU_ITEMS_INSERT_LEFT",(function(){return s})),n.d(e,"CONTEXTMENU_ITEMS_INSERT_RIGHT",(function(){return l})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_ROW",(function(){return u})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",(function(){return c})),n.d(e,"CONTEXTMENU_ITEMS_UNDO",(function(){return f})),n.d(e,"CONTEXTMENU_ITEMS_REDO",(function(){return h})),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY",(function(){return d})),n.d(e,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",(function(){return p})),n.d(e,"CONTEXTMENU_ITEMS_COPY",(function(){return g})),n.d(e,"CONTEXTMENU_ITEMS_CUT",(function(){return v})),n.d(e,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",(function(){return y})),n.d(e,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",(function(){return m})),n.d(e,"CONTEXTMENU_ITEMS_MERGE_CELLS",(function(){return b})),n.d(e,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",(function(){return w})),n.d(e,"CONTEXTMENU_ITEMS_ADD_COMMENT",(function(){return O})),n.d(e,"CONTEXTMENU_ITEMS_EDIT_COMMENT",(function(){return C})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",(function(){return E})),n.d(e,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",(function(){return S})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT",(function(){return k})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",(function(){return R})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",(function(){return _})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",(function(){return T})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",(function(){return M})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",(function(){return A})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",(function(){return N})),n.d(e,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",(function(){return j})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS",(function(){return x})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_TOP",(function(){return I})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",(function(){return D})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",(function(){return P})),n.d(e,"CONTEXTMENU_ITEMS_BORDERS_LEFT",(function(){return L})),n.d(e,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",(function(){return H})),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",(function(){return F})),n.d(e,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",(function(){return B})),n.d(e,"CONTEXTMENU_ITEMS_HIDE_COLUMN",(function(){return U})),n.d(e,"CONTEXTMENU_ITEMS_SHOW_COLUMN",(function(){return W})),n.d(e,"CONTEXTMENU_ITEMS_HIDE_ROW",(function(){return V})),n.d(e,"CONTEXTMENU_ITEMS_SHOW_ROW",(function(){return Y})),n.d(e,"FILTERS_NAMESPACE",(function(){return z})),n.d(e,"FILTERS_CONDITIONS_NAMESPACE",(function(){return G})),n.d(e,"FILTERS_CONDITIONS_NONE",(function(){return X})),n.d(e,"FILTERS_CONDITIONS_EMPTY",(function(){return q})),n.d(e,"FILTERS_CONDITIONS_NOT_EMPTY",(function(){return K})),n.d(e,"FILTERS_CONDITIONS_EQUAL",(function(){return $})),n.d(e,"FILTERS_CONDITIONS_NOT_EQUAL",(function(){return Q})),n.d(e,"FILTERS_CONDITIONS_BEGINS_WITH",(function(){return Z})),n.d(e,"FILTERS_CONDITIONS_ENDS_WITH",(function(){return J})),n.d(e,"FILTERS_CONDITIONS_CONTAINS",(function(){return tt})),n.d(e,"FILTERS_CONDITIONS_NOT_CONTAIN",(function(){return et})),n.d(e,"FILTERS_CONDITIONS_BY_VALUE",(function(){return nt})),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN",(function(){return rt})),n.d(e,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",(function(){return ot})),n.d(e,"FILTERS_CONDITIONS_LESS_THAN",(function(){return it})),n.d(e,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",(function(){return at})),n.d(e,"FILTERS_CONDITIONS_BETWEEN",(function(){return st})),n.d(e,"FILTERS_CONDITIONS_NOT_BETWEEN",(function(){return lt})),n.d(e,"FILTERS_CONDITIONS_AFTER",(function(){return ut})),n.d(e,"FILTERS_CONDITIONS_BEFORE",(function(){return ct})),n.d(e,"FILTERS_CONDITIONS_TODAY",(function(){return ft})),n.d(e,"FILTERS_CONDITIONS_TOMORROW",(function(){return ht})),n.d(e,"FILTERS_CONDITIONS_YESTERDAY",(function(){return dt})),n.d(e,"FILTERS_DIVS_FILTER_BY_CONDITION",(function(){return pt})),n.d(e,"FILTERS_DIVS_FILTER_BY_VALUE",(function(){return gt})),n.d(e,"FILTERS_LABELS_CONJUNCTION",(function(){return vt})),n.d(e,"FILTERS_LABELS_DISJUNCTION",(function(){return yt})),n.d(e,"FILTERS_VALUES_BLANK_CELLS",(function(){return mt})),n.d(e,"FILTERS_BUTTONS_SELECT_ALL",(function(){return bt})),n.d(e,"FILTERS_BUTTONS_CLEAR",(function(){return wt})),n.d(e,"FILTERS_BUTTONS_OK",(function(){return Ot})),n.d(e,"FILTERS_BUTTONS_CANCEL",(function(){return Ct})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",(function(){return Et})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",(function(){return St})),n.d(e,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",(function(){return kt}));var r="ContextMenu:items",o="".concat(r,".noItems"),i="".concat(r,".insertRowAbove"),a="".concat(r,".insertRowBelow"),s="".concat(r,".insertColumnOnTheLeft"),l="".concat(r,".insertColumnOnTheRight"),u="".concat(r,".removeRow"),c="".concat(r,".removeColumn"),f="".concat(r,".undo"),h="".concat(r,".redo"),d="".concat(r,".readOnly"),p="".concat(r,".clearColumn"),g="".concat(r,".copy"),v="".concat(r,".cut"),y="".concat(r,".freezeColumn"),m="".concat(r,".unfreezeColumn"),b="".concat(r,".mergeCells"),w="".concat(r,".unmergeCells"),O="".concat(r,".addComment"),C="".concat(r,".editComment"),E="".concat(r,".removeComment"),S="".concat(r,".readOnlyComment"),k="".concat(r,".align"),R="".concat(r,".align.left"),_="".concat(r,".align.center"),T="".concat(r,".align.right"),M="".concat(r,".align.justify"),A="".concat(r,".align.top"),N="".concat(r,".align.middle"),j="".concat(r,".align.bottom"),x="".concat(r,".borders"),I="".concat(r,".borders.top"),D="".concat(r,".borders.right"),P="".concat(r,".borders.bottom"),L="".concat(r,".borders.left"),H="".concat(r,".borders.remove"),F="".concat(r,".nestedHeaders.insertChildRow"),B="".concat(r,".nestedHeaders.detachFromParent"),U="".concat(r,".hideColumn"),W="".concat(r,".showColumn"),V="".concat(r,".hideRow"),Y="".concat(r,".showRow"),z="Filters:",G="".concat(z,"conditions"),X="".concat(G,".none"),q="".concat(G,".isEmpty"),K="".concat(G,".isNotEmpty"),$="".concat(G,".isEqualTo"),Q="".concat(G,".isNotEqualTo"),Z="".concat(G,".beginsWith"),J="".concat(G,".endsWith"),tt="".concat(G,".contains"),et="".concat(G,".doesNotContain"),nt="".concat(G,".byValue"),rt="".concat(G,".greaterThan"),ot="".concat(G,".greaterThanOrEqualTo"),it="".concat(G,".lessThan"),at="".concat(G,".lessThanOrEqualTo"),st="".concat(G,".isBetween"),lt="".concat(G,".isNotBetween"),ut="".concat(G,".after"),ct="".concat(G,".before"),ft="".concat(G,".today"),ht="".concat(G,".tomorrow"),dt="".concat(G,".yesterday"),pt="".concat(z,"labels.filterByCondition"),gt="".concat(z,"labels.filterByValue"),vt="".concat(z,"labels.conjunction"),yt="".concat(z,"labels.disjunction"),mt="".concat(z,"values.blankCells"),bt="".concat(z,"buttons.selectAll"),wt="".concat(z,"buttons.clear"),Ot="".concat(z,"buttons.ok"),Ct="".concat(z,"buttons.cancel"),Et="".concat(z,"buttons.placeholder.search"),St="".concat(z,"buttons.placeholder.value"),kt="".concat(z,"buttons.placeholder.secondValue")},function(t,e,n){"use strict";n.r(e),n.d(e,"isNumeric",(function(){return o})),n.d(e,"rangeEach",(function(){return i})),n.d(e,"rangeEachReverse",(function(){return a})),n.d(e,"valueAccordingPercent",(function(){return s}));n(10),n(11),n(12),n(7),n(5),n(33),n(15),n(8),n(58),n(9);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){var e=r(t);return"number"==e?!isNaN(t)&&isFinite(t):"string"==e?!!t.length&&(1==t.length?/\d/.test(t):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(t)):"object"==e&&!(!t||"number"!=typeof t.valueOf()||t instanceof Date)}function i(t,e,n){var r=-1;for("function"==typeof e?(n=e,e=t):r=t-1;++r<=e&&!1!==n(r););}function a(t,e,n){var r=t+1;for("function"==typeof e&&(n=e,e=0);--r>=e&&!1!==n(r););}function s(t,e){return e=parseInt(e.toString().replace("%",""),10),e=parseInt(t*e/100,10)}},function(t,e,n){var r=n(167),o=n(79),i=n(231);r||o(Object.prototype,"toString",i,{unsafe:!0})},function(t,e,n){"use strict";n(7),n(5),n(8),n(32),n(9);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}var a=new WeakMap,s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.viewportSize,o=e.scrollOffset,i=e.totalItems,s=e.itemSizeFn,l=e.overrideFn,u=e.calculationType,c=e.stretchMode,f=e.stretchingItemWidthFn,h=void 0===f?function(t){return t}:f;r(this,t),a.set(this,{viewportWidth:n,scrollOffset:o,totalColumns:i,columnWidthFn:s,overrideFn:l,calculationType:u,stretchingColumnWidthFn:h}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=c,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return i(t,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),i(t,[{key:"calculate",value:function(){for(var t,e=0,n=!0,r=[],o=a.get(this),i=o.calculationType,s=o.overrideFn,l=o.scrollOffset,u=o.totalColumns,c=o.viewportWidth,f=0;f<u;f++){if(t=this._getColumnWidth(f),e<=l&&2!==i&&(this.startColumn=f),e>=l&&e+(2===i?t:0)<=l+(l>0?c+1:c)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=f),this.endColumn=f),r.push(e),e+=t,2!==i&&(this.endColumn=f),e>=l+c){n=!1;break}}if(this.endColumn===u-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var h=r[this.endColumn]+t-r[this.startColumn-1];if((h<=c||2!==i)&&(this.startColumn-=1),h>c)break}1===i&&null!==this.startColumn&&s&&s(this),this.startPosition=r[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),u<this.endColumn&&(this.endColumn=u-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if("none"!==this.stretch){var e=t;this.totalTargetWidth=e;for(var n=a.get(this),r=n.totalColumns,o=0,i=0;i<r;i++){var s=this._getColumnWidth(i),l=n.stretchingColumnWidthFn(void 0,i);"number"==typeof l?e-=l:o+=s}var u=e-o;if("all"===this.stretch&&u>0)this.stretchAllRatio=e/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){var c=this._getColumnWidth(r-1),f=u+c;this.stretchLastWidth=f>=0?f:c}}}},{key:"getStretchedColumnWidth",value:function(t,e){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}},{key:"_getStretchedAllColumnWidth",value:function(t,e){var n=0,r=a.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[t]){var i=Math.round(e*this.stretchAllRatio),s=r.stretchingColumnWidthFn(i,t);this.stretchAllColumnsWidth[t]=void 0===s?i:isNaN(s)?this._getColumnWidth(t):s}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;l<this.stretchAllColumnsWidth.length;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){return t===a.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(e){var n=a.get(this).columnWidthFn(e);return isNaN(n)&&(n=t.DEFAULT_WIDTH),n}}]),t}();function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}var f=new WeakMap,h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.viewportSize,r=e.scrollOffset,o=e.totalItems,i=e.itemSizeFn,a=e.overrideFn,s=e.calculationType,u=e.scrollbarHeight;l(this,t),f.set(this,{viewportHeight:n,scrollOffset:r,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:s,horizontalScrollbarHeight:u}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return c(t,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),c(t,[{key:"calculate",value:function(){for(var e,n=0,r=!0,o=[],i=f.get(this),a=i.calculationType,s=i.overrideFn,l=i.rowHeightFn,u=i.scrollOffset,c=i.totalRows,h=i.viewportHeight,d=i.horizontalScrollbarHeight||0,p=0;p<c;p++)if(e=l(p),isNaN(e)&&(e=t.DEFAULT_HEIGHT),n<=u&&2!==a&&(this.startRow=p),n>=u&&n+(2===a?e:0)<=u+h-d&&(null===this.startRow&&(this.startRow=p),this.endRow=p),o.push(n),n+=e,2!==a&&(this.endRow=p),n>=u+h-d){r=!1;break}if(this.endRow===c-1&&r)for(this.startRow=this.endRow;this.startRow>0;){var g=o[this.endRow]+e-o[this.startRow-1];if((g<=h-d||2!==a)&&(this.startRow-=1),g>=h-d)break}1===a&&null!==this.startRow&&s&&s(this),this.startPosition=o[this.startRow],void 0===this.startPosition&&(this.startPosition=null),c<this.endRow&&(this.endRow=c-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}]),t}();function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.row=null,this.col=null,void 0!==e&&void 0!==n&&(this.row=e,this.col=n)}var e,n,r;return e=t,(n=[{key:"isValid",value:function(t){return!(this.row<0||this.col<0||this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}},{key:"isEqual",value:function(t){return t===this||this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&this.col>=t.col}},{key:"isNorthWestOf",value:function(t){return this.row<=t.row&&this.col<=t.col}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&this.col<=t.col}},{key:"isNorthEastOf",value:function(t){return this.row<=t.row&&this.col>=t.col}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}])&&d(e.prototype,n),r&&d(e,r),t}();n(43),n(23),n(54);function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var y=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;g(this,t),this.highlight=e,this.from=n,this.to=r}var e,n,r;return e=t,(n=[{key:"setHighlight",value:function(t){return this.highlight=t,this}},{key:"setFrom",value:function(t){return this.from=t,this}},{key:"setTo",value:function(t){return this.to=t,this}},{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(t){var e=t.row,n=t.col,r=this.getTopLeftCorner(),o=this.getBottomRightCorner();return r.row<=e&&o.row>=e&&r.col<=n&&o.col>=n}},{key:"includesRange",value:function(t){return this.includes(t.getTopLeftCorner())&&this.includes(t.getBottomRightCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getTopLeftCorner())&&t.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getTopLeftCorner().isSouthEastOf(t)||this.getBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getTopLeftCorner().isNorthWestOf(t)||this.getBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function(t){return this.getTopRightCorner().col>=t.getTopLeftCorner().col&&this.getTopRightCorner().col<=t.getTopRightCorner().col||this.getTopLeftCorner().col<=t.getTopRightCorner().col&&this.getTopLeftCorner().col>=t.getTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(t){return this.getBottomRightCorner().row>=t.getTopRightCorner().row&&this.getBottomRightCorner().row<=t.getBottomRightCorner().row||this.getTopRightCorner().row<=t.getBottomRightCorner().row&&this.getTopRightCorner().row>=t.getTopRightCorner().row}},{key:"expand",value:function(t){var e=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=new p(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=new p(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var e=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=this.getDirection(),o=t.getTopLeftCorner(),i=t.getBottomRightCorner(),a=Math.min(e.row,o.row),s=Math.min(e.col,o.col),l=Math.max(n.row,i.row),u=Math.max(n.col,i.col),c=new p(a,s),f=new p(l,u);return this.from=c,this.to=f,this.setDirection(r),this.highlight.row===this.getBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var e=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=e[0],this.to=e[1];break;case"NE-SW":var n=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopLeftCorner",value:function(){return new p(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new p(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new p(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new p(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(t,e){return!!(e&&e.includes(t)&&(this.getTopLeftCorner().isEqual(new p(e.from.row,e.from.col))||this.getTopRightCorner().isEqual(new p(e.from.row,e.to.col))||this.getBottomLeftCorner().isEqual(new p(e.to.row,e.from.col))||this.getBottomRightCorner().isEqual(new p(e.to.row,e.to.col))))||t.isEqual(this.getTopLeftCorner())||t.isEqual(this.getTopRightCorner())||t.isEqual(this.getBottomLeftCorner())||t.isEqual(this.getBottomRightCorner())}},{key:"getOppositeCorner",value:function(t,e){if(!(t instanceof p))return!1;if(e&&e.includes(t)){if(this.getTopLeftCorner().isEqual(new p(e.from.row,e.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new p(e.from.row,e.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new p(e.to.row,e.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new p(e.to.row,e.to.col)))return this.getTopLeftCorner()}return t.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():t.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():t.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():t.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var e=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),o=Math.max(this.from.col,this.to.col),i=Math.min(t.from.row,t.to.row),a=Math.max(t.from.row,t.to.row),s=Math.min(t.from.col,t.to.col),l=Math.max(t.from.col,t.to.col),u=[];return e===i&&u.push("top"),o===l&&u.push("right"),n===a&&u.push("bottom"),r===s&&u.push("left"),u}},{key:"getInner",value:function(){for(var t=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(new p(r,o));return n}},{key:"getAll",value:function(){for(var t=this.getTopLeftCorner(),e=this.getBottomRightCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)t.row===r&&t.col===o?n.push(t):e.row===r&&e.col===o?n.push(e):n.push(new p(r,o));return n}},{key:"forAll",value:function(t){for(var e=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=e.row;r<=n.row;r++)for(var o=e.col;o<=n.col;o++)if(!1===t(r,o))return}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}])&&v(e.prototype,n),r&&v(e,r),t}();function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var b=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.offset=e,this.total=n,this.countTH=r}var e,n,r;return e=t,(n=[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}])&&m(e.prototype,n),r&&m(e,r),t}();function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var O=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.offset=e,this.total=n,this.countTH=r}var e,n,r;return e=t,(n=[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}])&&w(e.prototype,n),r&&w(e,r),t}(),C=(n(10),n(11),n(12),n(17),n(18),n(0)),E=(n(30),n(15),n(29));function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var k=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}var e,n,r;return e=t,(n=[{key:"setSize",value:function(t){this.currentSize=this.nextSize,this.nextSize=t}},{key:"setOffset",value:function(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}])&&S(e.prototype,n),r&&S(e,r),t}();function R(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.size=new k,this.workingSpace=0,this.sharedSize=null}var e,n,r;return e=t,(n=[{key:"setSize",value:function(t){this.size.setSize(t)}},{key:"setOffset",value:function(t){this.size.setOffset(t)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof k}},{key:"isPlaceOn",value:function(t){return this.workingSpace===t}},{key:"append",value:function(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}},{key:"prepend",value:function(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}])&&R(e.prototype,n),r&&R(e,r),t}();function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var M=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootNode=e,this.nodesPool=n,this.sizeSet=new _,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}var e,n,r;return e=t,(n=[{key:"setSize",value:function(t){return this.sizeSet.setSize(t),this}},{key:"setOffset",value:function(t){return this.sizeSet.setOffset(t),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}},{key:"getCurrentNode",value:function(){var t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}},{key:"getRenderedChildCount",value:function(){var t=this.rootNode,e=this.sizeSet,n=0;if(this.isSharedViewSet())for(var r=t.firstElementChild;r;){if(r.tagName===this.childNodeType)n+=1;else if(e.isPlaceOn(1))break;r=r.nextElementSibling}else n=t.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var t=this.rootNode,e=this.sizeSet,n=this.isSharedViewSet(),r=e.getViewSize().nextSize,o=this.getRenderedChildCount();o<r;){var i=this.nodesPool();!n||n&&e.isPlaceOn(2)?t.appendChild(i):t.insertBefore(i,t.firstChild),o+=1}for(var a=n&&e.isPlaceOn(1);o>r;)t.removeChild(a?t.firstChild:t.lastChild),o-=1}},{key:"render",value:function(){var t=this.rootNode,e=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(2)&&(n+=e.sharedSize.nextSize);var r=t.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();t.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}])&&T(e.prototype,n),r&&T(e,r),t}();function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function x(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function D(t,e){return(D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var P=function(t){function e(){return N(this,e),x(this,I(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&D(t,e)}(e,t),n=e,(r=[{key:"prependView",value:function(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}])&&j(n.prototype,r),o&&j(n,o),e}(M);function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var H=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodeType=e.toUpperCase()}var e,n,r;return e=t,(n=[{key:"setRootDocument",value:function(t){this.rootDocument=t}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}])&&L(e.prototype,n),r&&L(e,r),t}();function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var B=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodesPool="string"==typeof e?new H(e):null,this.nodeType=e,this.rootNode=n,this.table=null,this.renderedNodes=0}var e,n,r;return e=t,(n=[{key:"setTable",value:function(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}])&&F(e.prototype,n),r&&F(e,r),t}();function U(t){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function V(t,e){return!e||"object"!==U(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Y(t){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function z(t,e){return(z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var G=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=V(this,Y(e).call(this,"TH"))).orderViews=new WeakMap,t.sourceRowIndex=0,t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&z(t,e)}(e,t),n=e,(r=[{key:"obtainOrderView",value:function(t){var e,n=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new P(t,(function(t){return n.nodesPool.obtain(n.sourceRowIndex,t)}),this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,n=t.rowHeaderFunctions,r=t.rowHeadersCount,o=t.rows,i=t.cells,a=0;a<e;a++){var s=this.table.renderedRowToSource(a),l=o.getRenderedNode(a);this.sourceRowIndex=s;var u=this.obtainOrderView(l),c=i.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<r;f++){u.render();var h=u.getCurrentNode();h.className="",h.removeAttribute("style"),n[f](s,h,f)}u.end()}}}])&&W(n.prototype,r),o&&W(n,o),e}(B);function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function K(t,e){return!e||"object"!==X(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $(t){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Q(t,e){return(Q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Z=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),K(this,$(e).call(this,null,t))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Q(t,e)}(e,t),n=e,(r=[{key:"adjust",value:function(){var t=this.table,e=t.columnHeadersCount,n=t.rowHeadersCount,r=this.rootNode.firstChild;if(e){for(var o=this.table.columnsToRender+n,i=0,a=e;i<a;i++){for((r=this.rootNode.childNodes[i])||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}var s=this.rootNode.childNodes.length;if(s>e)for(var l=e;l<s;l++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Object(C.empty)(r)}},{key:"render",value:function(){for(var t=this.table.columnHeadersCount,e=0;e<t;e++)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,i=n.rowHeadersCount,a=this.rootNode.childNodes[e],s=-1*i;s<o;s++){var l=this.table.renderedColumnToSource(s),u=a.childNodes[s+i];u.className="",u.removeAttribute("style"),r[e](l,u,e)}}}])&&q(n.prototype,r),o&&q(n,o),e}(B);function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function et(t,e){return!e||"object"!==J(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nt(t){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rt(t,e){return(rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ot=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),et(this,nt(e).call(this,null,t))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rt(t,e)}(e,t),n=e,(r=[{key:"adjust",value:function(){for(var t=this.table,e=t.columnsToRender+t.rowHeadersCount;this.renderedNodes<e;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>e;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var t=this.table,e=t.columnsToRender,n=t.rowHeadersCount,r=0;r<n;r++){var o=this.table.renderedColumnToSource(r),i=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width="".concat(i,"px")}for(var a=0;a<e;a++){var s=this.table.renderedColumnToSource(a),l=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[a+n].style.width="".concat(l,"px")}var u=this.rootNode.firstChild;u&&Object(C.addClass)(u,"rowHeader")}}])&&tt(n.prototype,r),o&&tt(n,o),e}(B),it=(n(38),n(81),n(34)),at=n(36);function st(t){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number \n        of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number\\x20\n        of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']);return lt=function(){return t},t}function ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ct(t,e){return!e||"object"!==st(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ft(t){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ht(t,e){return(ht=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dt=!1,pt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ct(this,ft(e).call(this,"TR",t))).orderView=new M(t,(function(t){return n.nodesPool.obtain(t)}),n.nodeType),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ht(t,e)}(e,t),n=e,(r=[{key:"getRenderedNode",value:function(t){return this.orderView.getNode(t)}},{key:"render",value:function(){var t=this.table.rowsToRender;!dt&&t>1e3&&(dt=!0,Object(it.b)(Object(at.a)(lt()))),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(var e=0;e<t;e++)this.orderView.render();this.orderView.end()}}])&&ut(n.prototype,r),o&&ut(n,o),e}(B);function gt(t){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yt(t,e){return!e||"object"!==gt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bt(t,e){return(bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=yt(this,mt(e).call(this,"TD"))).orderViews=new WeakMap,t.sourceRowIndex=0,t}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bt(t,e)}(e,t),n=e,(r=[{key:"obtainOrderView",value:function(t){var e,n=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new P(t,(function(t){return n.nodesPool.obtain(n.sourceRowIndex,t)}),this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,n=t.columnsToRender,r=t.rows,o=t.rowHeaders,i=0;i<e;i++){var a=this.table.renderedRowToSource(i),s=r.getRenderedNode(i);this.sourceRowIndex=a;var l=this.obtainOrderView(s),u=o.obtainOrderView(s);l.prependView(u).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var c=0;c<n;c++){l.render();var f=l.getCurrentNode(),h=this.table.renderedColumnToSource(c);Object(C.hasClass)(f,"hide")||(f.className=""),f.removeAttribute("style"),this.table.cellRenderer(a,h,f)}l.end()}}}])&&vt(n.prototype,r),o&&vt(n,o),e}(B);function Ot(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Et=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.cellRenderer;Ot(this,t),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=r}var e,n,r;return e=t,(n=[{key:"setAxisUtils",value:function(t,e){this.rowUtils=t,this.columnUtils=e}},{key:"setViewportSize",value:function(t,e){this.rowsToRender=t,this.columnsToRender=e}},{key:"setFilters",value:function(t,e){this.rowFilter=t,this.columnFilter=e}},{key:"setHeaderContentRenderers",value:function(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}},{key:"setRenderers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.rowHeaders,n=t.columnHeaders,r=t.colGroup,o=t.rows,i=t.cells;e.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=i}},{key:"renderedRowToSource",value:function(t){return this.rowFilter.renderedToSource(t)}},{key:"renderedColumnToSource",value:function(t){return this.columnFilter.renderedToSource(t)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var t=this.rowsToRender,e=this.rows,n=0;n<t;n++){var r=e.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),i=this.rowUtils.getHeight(o);r.firstChild.style.height=i?"".concat(i-1,"px"):""}}}}])&&Ct(e.prototype,n),r&&Ct(e,r),t}();function St(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Rt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.TABLE,r=e.THEAD,o=e.COLGROUP,i=e.TBODY,a=e.rowUtils,s=e.columnUtils,l=e.cellRenderer;St(this,t),this.renderer=new Et(n,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new G,columnHeaders:new Z(r),colGroup:new ot(o),rows:new pt(i),cells:new wt}),this.renderer.setAxisUtils(a,s)}var e,n,r;return e=t,(n=[{key:"setFilters",value:function(t,e){return this.renderer.setFilters(t,e),this}},{key:"setViewportSize",value:function(t,e){return this.renderer.setViewportSize(t,e),this}},{key:"setHeaderContentRenderers",value:function(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}])&&kt(e.prototype,n),r&&kt(e,r),t}(),_t=n(2),Tt=n(1),Mt=n(22),At=n(40),Nt=(n(47),n(37)),jt=n(39);function xt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var It=new WeakMap,Dt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.eventManager=new Mt.a(e),It.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}var e,n,r;return e=t,(n=[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",(function(e){return t.onContextMenu(e)})),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",(function(e){return t.onMouseOut(e)}));var e=function(){t.eventManager.addEventListener(t.instance.wtTable.holder,"touchstart",(function(e){return t.onTouchStart(e)})),t.eventManager.addEventListener(t.instance.wtTable.holder,"touchend",(function(e){return t.onTouchEnd(e)})),t.instance.momentumScrolling||(t.instance.momentumScrolling={}),t.eventManager.addEventListener(t.instance.wtTable.holder,"scroll",(function(){clearTimeout(t.instance.momentumScrolling._timeout),t.instance.momentumScrolling.ongoing||t.instance.getSetting("onBeforeTouchScroll"),t.instance.momentumScrolling.ongoing=!0,t.instance.momentumScrolling._timeout=setTimeout((function(){t.instance.touchApplied||(t.instance.momentumScrolling.ongoing=!1,t.instance.getSetting("onAfterMomentumScroll"))}),200)}))};Object(jt.isMobileBrowser)()?e():(Object(Nt.isTouchSupported)()&&e(),t.eventManager.addEventListener(t.instance.wtTable.holder,"mouseup",(function(e){return t.onMouseUp(e)})),t.eventManager.addEventListener(t.instance.wtTable.holder,"mousedown",(function(e){return t.onMouseDown(e)})))}},{key:"selectedCellWasTouched",value:function(t){var e=It.get(this),n=this.parentCell(t).coords;if(e.selectedCellBeforeTouchEnd&&n){var r=[n.row,e.selectedCellBeforeTouchEnd.from.row],o=r[0],i=r[1],a=[n.col,e.selectedCellBeforeTouchEnd.from.col];return o===i&&a[0]===a[1]}return!1}},{key:"parentCell",value:function(t){var e={},n=this.instance.wtTable.TABLE,r=Object(C.closestDown)(t,["TD","TH"],n);return r?(e.coords=this.instance.wtTable.getCoords(r),e.TD=r):Object(C.hasClass)(t,"wtBorder")&&Object(C.hasClass)(t,"current")?(e.coords=this.instance.selections.getCell().cellRange.highlight,e.TD=this.instance.wtTable.getCell(e.coords)):Object(C.hasClass)(t,"wtBorder")&&Object(C.hasClass)(t,"area")&&this.instance.selections.createOrGetArea().cellRange&&(e.coords=this.instance.selections.createOrGetArea().cellRange.to,e.TD=this.instance.wtTable.getCell(e.coords)),e}},{key:"onMouseDown",value:function(t){var e=It.get(this),n=this.instance.rootDocument.activeElement,r=Object(E.partial)(C.getParent,t.realTarget),o=t.realTarget;if(o!==n&&r(0)!==n&&r(1)!==n){var i=this.parentCell(o);Object(C.hasClass)(o,"corner")?this.instance.getSetting("onCellCornerMouseDown",t,o):i.TD&&this.instance.hasSetting("onCellMouseDown")&&this.instance.getSetting("onCellMouseDown",t,i.coords,i.TD,this.instance),(0===t.button||this.instance.touchApplied)&&i.TD&&(e.dblClickOrigin[0]=i.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout((function(){e.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(t){if(this.instance.hasSetting("onCellContextMenu")){var e=this.parentCell(t.realTarget);e.TD&&this.instance.getSetting("onCellContextMenu",t,e.coords,e.TD,this.instance)}}},{key:"onMouseOver",value:function(t){if(this.instance.hasSetting("onCellMouseOver")){var e=this.instance.wtTable.TABLE,n=Object(C.closestDown)(t.realTarget,["TD","TH"],e),r=this.instance.cloneSource||this.instance;n&&n!==r.lastMouseOver&&Object(C.isChildOf)(n,e)&&(r.lastMouseOver=n,this.instance.getSetting("onCellMouseOver",t,this.instance.wtTable.getCoords(n),n,this.instance))}}},{key:"onMouseOut",value:function(t){if(this.instance.hasSetting("onCellMouseOut")){var e=this.instance.wtTable.TABLE,n=Object(C.closestDown)(t.realTarget,["TD","TH"],e),r=Object(C.closestDown)(t.relatedTarget,["TD","TH"],e);n&&n!==r&&Object(C.isChildOf)(n,e)&&this.instance.getSetting("onCellMouseOut",t,this.instance.wtTable.getCoords(n),n,this.instance)}}},{key:"onMouseUp",value:function(t){var e=It.get(this),n=this.parentCell(t.realTarget);n.TD&&this.instance.hasSetting("onCellMouseUp")&&this.instance.getSetting("onCellMouseUp",t,n.coords,n.TD,this.instance),(0===t.button||this.instance.touchApplied)&&(n.TD===e.dblClickOrigin[0]&&n.TD===e.dblClickOrigin[1]?(Object(C.hasClass)(t.realTarget,"corner")?this.instance.getSetting("onCellCornerDblClick",t,n.coords,n.TD,this.instance):this.instance.getSetting("onCellDblClick",t,n.coords,n.TD,this.instance),e.dblClickOrigin[0]=null,e.dblClickOrigin[1]=null):n.TD===e.dblClickOrigin[0]&&(e.dblClickOrigin[1]=n.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout((function(){e.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(t){It.get(this).selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange,this.instance.touchApplied=!0,this.onMouseDown(t)}},{key:"onTouchEnd",value:function(t){var e=t.target;!1===this.selectedCellWasTouched(e)&&["A","BUTTON","INPUT"].includes(e.tagName)&&t.preventDefault(),this.onMouseUp(t),this.instance.touchApplied=!1}},{key:"destroy",value:function(){var t=It.get(this);clearTimeout(t.dblClickTimeout[0]),clearTimeout(t.dblClickTimeout[1]),this.eventManager.destroy()}}])&&xt(e.prototype,n),r&&xt(e,r),t}(),Pt=(n(107),n(108),n(21));function Lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ht=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wot=e;var n=this.wot,r=n.rootDocument,o=n.rootWindow,i=n.wtTable,a=parseInt(o.getComputedStyle(r.body).lineHeight,10),s=1.2*parseInt(o.getComputedStyle(r.body).fontSize,10);this.instance=this.wot,this.eventManager=new Mt.a(this.wot),this.scrollbarSize=Object(C.getScrollbarWidth)(r),this.wot.update("scrollbarWidth",this.scrollbarSize),this.wot.update("scrollbarHeight",this.scrollbarSize);var l="hidden"===o.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=l?i.holder:Object(C.getScrollableElement)(i.TABLE),this.topOverlay=void 0,this.bottomOverlay=void 0,this.leftOverlay=void 0,this.topLeftCornerOverlay=void 0,this.bottomLeftCornerOverlay=void 0,this.prepareOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.browserLineHeight=a||s,this.registerListeners(),this.lastScrollX=o.scrollX,this.lastScrollY=o.scrollY}var e,n,r;return e=t,(n=[{key:"prepareOverlays",value:function(){var t=!1;return this.topOverlay?t=this.topOverlay.updateStateOfRendering()||t:this.topOverlay=$t.createOverlay($t.CLONE_TOP,this.wot),$t.hasOverlay($t.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),$t.hasOverlay($t.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?t=this.bottomOverlay.updateStateOfRendering()||t:this.bottomOverlay=$t.createOverlay($t.CLONE_BOTTOM,this.wot),this.leftOverlay?t=this.leftOverlay.updateStateOfRendering()||t:this.leftOverlay=$t.createOverlay($t.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?t=this.topLeftCornerOverlay.updateStateOfRendering()||t:this.topLeftCornerOverlay=$t.createOverlay($t.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?t=this.bottomLeftCornerOverlay.updateStateOfRendering()||t:this.bottomLeftCornerOverlay=$t.createOverlay($t.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=$t.createOverlay($t.CLONE_DEBUG,this.wot)),t}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wot.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var t=this,e=this.wot,n=e.rootDocument,r=e.rootWindow,o=this.topOverlay.mainTableScrollableElement,i=this.leftOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(e){return t.onKeyDown(e)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return t.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return t.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(e){return t.onTableScroll(e)}),{passive:!0}),o!==i&&this.eventManager.addEventListener(i,"scroll",(function(e){return t.onTableScroll(e)}),{passive:!0});var a,s=r.devicePixelRatio&&r.devicePixelRatio>1,l=this.scrollableElement===r,u=this.wot.wtSettings.getSetting("preventWheel"),c={passive:l};(u||s||!Object(jt.isChrome)())&&this.eventManager.addEventListener(this.wot.wtTable.wtRootElement,"wheel",(function(e){return t.onCloneWheel(e,u)}),c),[this.topOverlay,this.bottomOverlay,this.leftOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay].forEach((function(e){if(e&&e.needFullRender){var n=e.clone.wtTable.holder;t.eventManager.addEventListener(n,"wheel",(function(e){return t.onCloneWheel(e,u)}),c)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(a),a=setTimeout((function(){t.wot.getSetting("onWindowResize")}),200)}))}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(t){var e=this.wot.rootWindow,n=this.leftOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=t.target;this.keyPressed&&(r!==e&&o!==e&&!t.target.contains(r)||n!==e&&o!==e&&!t.target.contains(n))||this.syncScrollPositions(t)}},{key:"onCloneWheel",value:function(t,e){var n=this.wot.rootWindow,r=this.leftOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=t.target,a=o!==n&&i!==n&&!i.contains(o),s=r!==n&&i!==n&&!i.contains(r);if(!this.keyPressed||!a&&!s){var l=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==n&&l)&&t.preventDefault()}}},{key:"onKeyDown",value:function(t){this.keyPressed=Object(Pt.isKey)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var e=this.browserLineHeight,n=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,r=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(r+=r*e,n+=n*e);var o=this.scrollVertically(n),i=this.scrollHorizontally(r);return o||i}},{key:"scrollVertically",value:function(t){var e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(t){var e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var t=this.wot.rootWindow,e=this.topOverlay.clone.wtTable.holder,n=this.leftOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],i=r[1];if(this.horizontalScrolling=e.scrollLeft!==o||this.lastScrollX!==t.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=o;var a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,e=t.scrollLeft,n=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var t=this.wot,e=t.rootWindow,n=t.wtTable;"hidden"===e.getComputedStyle(n.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=n.holder:this.scrollableElement=Object(C.getScrollableElement)(n.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var e=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,n=e.clientWidth,r=e.clientHeight;n===this.spreaderLastSize.width&&r===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.leftOverlay.refresh(t),this.topOverlay.refresh(t),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(t),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(t),this.debug&&this.debug.refresh(t)}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wot,n=e.wtViewport,r=e.wtTable,o=this.wot.getSetting("totalColumns"),i=this.wot.getSetting("totalRows"),a=n.getRowHeaderWidth(),s=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width="".concat(a+this.leftOverlay.sumCellSizes(0,o),"px"),l.height="".concat(s+this.topOverlay.sumCellSizes(0,i)+1,"px"),this.scrollbarSize>0){var u=r.wtRootElement,c=u.scrollHeight,f=u.scrollWidth,h=r.holder,d=h.scrollHeight,p=h.scrollWidth;this.hasScrollbarRight=c<d,this.hasScrollbarBottom=f<p,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>f?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.leftOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function(){this.wot.wtTable.isVisible()&&(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(t){if(!t)return null;var e=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],n=null;return Object(Tt.arrayEach)(e,(function(e){e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(n=e.clone)})),n}}])&&Lt(e.prototype,n),r&&Lt(e,r),t}();function Ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Bt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wot=e}var e,n,r;return e=t,(n=[{key:"scrollViewport",value:function(t,e,n,r,o){if(t.col<0||t.row<0)return!1;var i=this.scrollViewportHorizontally(t.col,n,o),a=this.scrollViewportVertically(t.row,e,r);return i||a}},{key:"scrollViewportHorizontally",value:function(t,e,n){if(!this.wot.drawn)return!1;var r=this._getVariables(),o=r.fixedColumnsLeft,i=r.leftOverlay,a=r.totalColumns,s=!1;if(t>=0&&t<=Math.max(a-1,0)){var l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn();t>=o&&l>-1&&(t<l||n)?s=i.scrollTo(t):(-1===u||u>-1&&(t>u||e))&&(s=i.scrollTo(t,!0))}return s}},{key:"scrollViewportVertically",value:function(t,e,n){if(!this.wot.drawn)return!1;var r=this._getVariables(),o=r.fixedRowsBottom,i=r.fixedRowsTop,a=r.topOverlay,s=r.totalRows,l=!1;if(t>=0&&t<=Math.max(s-1,0)){var u=this.getFirstVisibleRow(),c=this.getLastVisibleRow();t>=i&&u>-1&&(t<u||e)?l=a.scrollTo(t):(-1===c||c>-1&&(t>c&&t<s-o||n))&&(l=a.scrollTo(t,!0))}return l}},{key:"getFirstVisibleRow",value:function(){var t=this._getVariables(),e=t.topOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalRows,i=t.fixedRowsTop,a=this.wot.rootWindow,s=n.getFirstVisibleRow();if(e.mainTableScrollableElement===a){var l=Object(C.offset)(n.wtRootElement),u=Object(C.innerHeight)(n.hider),c=Object(C.innerHeight)(a),f=Object(C.getScrollTop)(a,a);if(l.top+u-c<=f){var h=r.getColumnHeaderHeight();h+=e.sumCellSizes(0,i);for(var d=o;d>0;d--)if(h+=e.sumCellSizes(d-1,d),l.top+u-h<=f){s=d;break}}}return s}},{key:"getLastVisibleRow",value:function(){var t=this._getVariables(),e=t.topOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalRows,i=this.wot.rootWindow,a=n.getLastVisibleRow();if(e.mainTableScrollableElement===i){var s=Object(C.offset)(n.wtRootElement),l=Object(C.getScrollTop)(i,i);if(s.top>l)for(var u=Object(C.innerHeight)(i),c=r.getColumnHeaderHeight(),f=1;f<=o;f++)if(c+=e.sumCellSizes(f-1,f),s.top+c-l>=u){a=f-2;break}}return a}},{key:"getFirstVisibleColumn",value:function(){var t=this._getVariables(),e=t.leftOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalColumns,i=this.wot.rootWindow,a=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===i){var s=Object(C.offset)(n.wtRootElement),l=Object(C.innerWidth)(n.hider),u=Object(C.innerWidth)(i),c=Object(C.getScrollLeft)(i,i);if(s.left+l-u<=c)for(var f=r.getRowHeaderWidth(),h=o;h>0;h--)if(f+=e.sumCellSizes(h-1,h),s.left+l-f<=c){a=h;break}}return a}},{key:"getLastVisibleColumn",value:function(){var t=this._getVariables(),e=t.leftOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalColumns,i=this.wot.rootWindow,a=n.getLastVisibleColumn();if(e.mainTableScrollableElement===i){var s=Object(C.offset)(n.wtRootElement),l=Object(C.getScrollLeft)(i,i);if(s.left>l)for(var u=Object(C.innerWidth)(i),c=r.getRowHeaderWidth(),f=1;f<=o;f++)if(c+=e.sumCellSizes(f-1,f),s.left+c-l>=u){a=f-2;break}}return a}},{key:"_getVariables",value:function(){var t=this.wot;return{topOverlay:t.wtOverlays.topOverlay,leftOverlay:t.wtOverlays.leftOverlay,wtTable:t.wtTable,wtViewport:t.wtViewport,totalRows:t.getSetting("totalRows"),totalColumns:t.getSetting("totalColumns"),fixedRowsTop:t.getSetting("fixedRowsTop"),fixedRowsBottom:t.getSetting("fixedRowsBottom"),fixedColumnsLeft:t.getSetting("fixedColumnsLeft")}}}])&&Ft(e.prototype,n),r&&Ft(e,r),t}();function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wt=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wot=e,this.instance=e,this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(t,e,n){var o=r.getSetting("data",t,e);Object(C.fastInnerText)(n,null==o?"":o)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(t){return t},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onWindowResize:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},Object(_t.objectEach)(this.defaults,(function(t,e){if(void 0!==n[e])r.settings[e]=n[e];else{if(void 0===t)throw new Error('A required setting "'.concat(e,'" was not provided'));r.settings[e]=t}}))}var e,n,r;return e=t,(n=[{key:"update",value:function(t,e){var n=this;return void 0===e?Object(_t.objectEach)(t,(function(t,e){n.settings[e]=t})):this.settings[t]=e,this.wot}},{key:"getSetting",value:function(t,e,n,r,o){return"function"==typeof this.settings[t]?this.settings[t](e,n,r,o):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}])&&Ut(e.prototype,n),r&&Ut(e,r),t}();function Vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Yt=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wot=e,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new Mt.a(this.wot),this.eventManager.addEventListener(this.wot.rootWindow,"resize",(function(){n.clientHeight=n.getWorkspaceHeight()}))}var e,n,r;return e=t,(n=[{key:"getWorkspaceHeight",value:function(){var t=this.wot.rootDocument,e=this.instance.wtOverlays.topOverlay.trimmingContainer;return e===this.wot.rootWindow?t.documentElement.clientHeight:Object(C.outerHeight)(e)>0&&e.clientHeight>0?e.clientHeight:1/0}},{key:"getWorkspaceWidth",value:function(){var t,e,n=this.wot,r=n.rootDocument,o=n.rootWindow,i=this.instance.wtOverlays.leftOverlay.trimmingContainer,a=r.documentElement.offsetWidth,s=n.getSetting("totalColumns");if(n.getSetting("preventOverflow"))return Object(C.outerWidth)(this.instance.wtTable.wtRootElement);if(t=n.getSetting("freezeOverlays")?Math.min(a-this.getWorkspaceOffset().left,a):Math.min(this.getContainerFillWidth(),a-this.getWorkspaceOffset().left,a),i===o&&s>0&&this.sumColumnWidths(0,s-1)>t)return r.documentElement.clientWidth;if(i!==o&&("scroll"===(e=Object(C.getStyle)(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow",o))||"hidden"===e||"auto"===e))return Math.max(t,i.clientWidth);var l=n.getSetting("stretchH");return"none"!==l&&l?t:Math.max(t,Object(C.outerWidth)(this.instance.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,e){for(var n=this.wot.wtTable,r=0,o=t;o<e;)r+=n.getColumnWidth(o),o+=1;return r}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.instance.wtTable.holder,e=this.wot.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);var n=e.offsetWidth;return this.containerWidth=n,t.removeChild(e),n}},{key:"getWorkspaceOffset",value:function(){return Object(C.offset)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return Object(C.outerHeight)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){var t=this.wot.wtTable;return Object(C.outerWidth)(t.TABLE)||Object(C.outerWidth)(t.TBODY)||Object(C.outerWidth)(t.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return this.instance.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Object(C.outerHeight)(this.wot.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight();if(t===1/0)return t;var e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}},{key:"getRowHeaderWidth",value:function(){var t=this.instance.getSetting("rowHeaderWidth"),e=this.instance.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var n=0,r=e.length;n<r;n++)this.rowHeaderWidth+=t[n]||t}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(e.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,a=e.length;i<a;i++)o?(this.rowHeaderWidth+=Object(C.outerWidth)(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth();if(t===1/0)return t;var e=this.getRowHeaderWidth();return e>0?t-e:t}},{key:"createRowsCalculator",value:function(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=this.wot,i=o.wtSettings,a=o.wtOverlays,s=o.wtTable,l=o.rootDocument;this.rowHeaderWidth=NaN,t=i.settings.renderAllRows&&1===r?1/0:this.getViewportHeight();var u=a.topOverlay.getScrollPosition()-a.topOverlay.getTableParentOffset();u<0&&(u=0);var c=o.getSetting("fixedRowsTop"),f=o.getSetting("fixedRowsBottom"),d=o.getSetting("totalRows");return c&&(u+=n=a.topOverlay.sumCellSizes(0,c),t-=n),f&&a.bottomOverlay.clone&&(t-=n=a.bottomOverlay.sumCellSizes(d-f,d)),e=s.holder.clientHeight===s.holder.offsetHeight?0:Object(C.getScrollbarWidth)(l),new h({viewportSize:t,scrollOffset:u,totalItems:o.getSetting("totalRows"),itemSizeFn:function(t){return s.getRowHeight(t)},overrideFn:i.settings.viewportRowCalculatorOverride,calculationType:r,scrollbarHeight:e})}},{key:"createColumnsCalculator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this.wot,n=e.wtSettings,r=e.wtOverlays,o=e.wtTable,i=e.rootDocument,a=this.getViewportWidth(),l=r.leftOverlay.getScrollPosition()-r.leftOverlay.getTableParentOffset();this.columnHeaderHeight=NaN,l<0&&(l=0);var u=e.getSetting("fixedColumnsLeft");if(u){var c=r.leftOverlay.sumCellSizes(0,u);l+=c,a-=c}return o.holder.clientWidth!==o.holder.offsetWidth&&(a-=Object(C.getScrollbarWidth)(i)),new s({viewportSize:a,scrollOffset:l,totalItems:e.getSetting("totalColumns"),itemSizeFn:function(t){return e.wtTable.getColumnWidth(t)},overrideFn:n.settings.viewportColumnCalculatorOverride,calculationType:t,stretchMode:e.getSetting("stretchH"),stretchingItemWidthFn:function(t,n){return e.getSetting("onBeforeStretchingColumnWidth",t,n)}})}},{key:"createRenderCalculators",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=t;if(e){var n=this.createRowsCalculator(2),r=this.createColumnsCalculator(2);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){if(!this.rowsVisibleCalculator)return!1;var e=t.startRow,n=t.endRow,r=this.rowsRenderCalculator,o=r.startRow,i=r.endRow;return!(e<o||e===o&&e>0||n>i||n===i&&n<this.wot.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){if(!this.columnsVisibleCalculator)return!1;var e=t.startColumn,n=t.endColumn,r=this.columnsRenderCalculator,o=r.startColumn,i=r.endColumn;return!(e<o||e===o&&e>0||n>i||n===i&&n<this.wot.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Object(_t.objectEach)(this.hasOversizedColumnHeadersMarked,(function(t,e,n){n[e]=void 0}))}}])&&Vt(e.prototype,n),r&&Vt(e,r),t}();function zt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Gt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=[];if(this.guid="wt_".concat(Object(At.randomString)()),this.rootDocument=e.table.ownerDocument,this.rootWindow=this.rootDocument.defaultView,e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=this.cloneOverlay.createTable(this,e.table),this.wtScroll=new Bt(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new Dt(this),this.selections=this.cloneSource.selections):(this.wtSettings=new Wt(this,e),this.wtTable=new ye(this,e.table),this.wtScroll=new Bt(this),this.wtViewport=new Yt(this),this.wtEvent=new Dt(this),this.selections=this.getSetting("selections"),this.wtOverlays=new Ht(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var r=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;r<o;r++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(t,e){Object(C.fastInnerText)(e,n[t])}])}this.drawn=!1,this.drawInterrupted=!1}var e,n,r;return e=t,(n=[{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}},{key:"getCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsLeft");if(t.row<r&&t.col<i)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(t);if(t.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<i&&t.row>=n-o){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<i)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(t);if(t.row<n&&t.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}},{key:"update",value:function(t,e){return this.wtSettings.update(t,e)}},{key:"scrollViewport",value:function(t,e,n,r,o){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){var t=this,e=[],n=[];Object(_t.objectEach)({rowHeaders:["array"],columnHeaders:["array"]},(function(r,o){r.indexOf("array")>-1&&t.getSetting(o).length&&n.push("ht".concat(Object(At.toUpperCaseFirst)(o))),e.push("ht".concat(Object(At.toUpperCaseFirst)(o)))})),Object(C.removeClass)(this.wtTable.wtRootElement.parentNode,e),Object(C.addClass)(this.wtTable.wtRootElement.parentNode,n)}},{key:"getSetting",value:function(t,e,n,r,o){return this.wtSettings.getSetting(t,e,n,r,o)}},{key:"hasSetting",value:function(t){return this.wtSettings.has(t)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}])&&zt(e.prototype,n),r&&zt(e,r),t}();function Xt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qt(t,e,n){return e&&Xt(t.prototype,e),n&&Xt(t,n),t}var Kt={},$t=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object(_t.defineGetter)(this,"wot",e,{writable:!1});var n=this.wot.wtTable,r=n.TABLE,o=n.hider,i=n.spreader,a=n.holder,s=n.wtRootElement;this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=r,this.hider=o,this.spreader=i,this.holder=a,this.wtRootElement=s,this.trimmingContainer=Object(C.getTrimmingContainer)(this.hider.parentNode.parentNode),this.areElementSizesAdjusted=!1,this.updateStateOfRendering()}return qt(t,null,[{key:"registerOverlay",value:function(e,n){if(-1===t.CLONE_TYPES.indexOf(e))throw new Error("Unsupported overlay (".concat(e,")."));Kt[e]=n}},{key:"createOverlay",value:function(t,e){return new Kt[t](e)}},{key:"hasOverlay",value:function(t){return void 0!==Kt[t]}},{key:"isOverlayTypeOf",value:function(t,e){return!(!t||!Kt[e])&&t instanceof Kt[e]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_DEBUG",get:function(){return"debug"}},{key:"CLONE_TYPES",get:function(){return[t.CLONE_TOP,t.CLONE_BOTTOM,t.CLONE_LEFT,t.CLONE_TOP_LEFT_CORNER,t.CLONE_BOTTOM_LEFT_CORNER,t.CLONE_DEBUG]}}]),qt(t,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Object(C.getTrimmingContainer)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var t=this.wot,e=t.wtTable;"hidden"===t.rootWindow.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Object(C.getScrollableElement)(e.TABLE)}},{key:"getRelativeCellPosition",value:function(t,e,n){if(!1!==this.clone.wtTable.holder.contains(t)){var r=this.mainTableScrollableElement===this.wot.rootWindow,o=n<this.wot.getSetting("fixedColumnsLeft"),i=e<this.wot.getSetting("fixedRowsTop"),a=e>=this.wot.getSetting("totalRows")-this.wot.getSetting("fixedRowsBottom"),s={left:this.clone.wtTable.spreader.offsetLeft,top:this.clone.wtTable.spreader.offsetTop},l={left:t.offsetLeft,top:t.offsetTop};return r?this.getRelativeCellPositionWithinWindow(i,o,l,s):this.getRelativeCellPositionWithinHolder(i,a,o,l,s)}Object(it.b)("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeCellPositionWithinWindow",value:function(t,e,n,r){var o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),i=0,a=0;(i=e?o.left<=0?-1*o.left:0:r.left,t)?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=r.top;return{left:n.left+i,top:n.top+a}}},{key:"getRelativeCellPositionWithinHolder",value:function(t,e,n,r,o){var i=this.clone.cloneSource.wtOverlays.leftOverlay.getScrollPosition(),a=this.clone.cloneSource.wtOverlays.topOverlay.getScrollPosition(),s=0,l=0;if(n||(s=i-o.left),e){var u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+u.top}else t||(l=a-o.top);return{left:r.left-s,top:r.top-l}}},{key:"makeClone",value:function(e){if(-1===t.CLONE_TYPES.indexOf(e))throw new Error('Clone type "'.concat(e,'" is not supported.'));var n=this.wot,r=n.wtTable,o=n.rootDocument,i=n.rootWindow,a=o.createElement("DIV"),s=o.createElement("TABLE");a.className="ht_clone_".concat(e," handsontable"),a.style.position="absolute",a.style.top=0,a.style.left=0,a.style.overflow="hidden",s.className=r.TABLE.className,a.appendChild(s),this.type=e,r.wtRootElement.parentNode.appendChild(a);var l=this.wot.getSetting("preventOverflow");return!0===l||"horizontal"===l&&this.type===t.CLONE_TOP||"vertical"===l&&this.type===t.CLONE_LEFT?this.mainTableScrollableElement=i:"hidden"===i.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=r.holder:this.mainTableScrollableElement=Object(C.getScrollableElement)(r.TABLE),new Gt({cloneSource:this.wot,cloneOverlay:this,table:s})}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,n=t.style,r=e.style,o=t.parentNode.style;Object(Tt.arrayEach)([n,r,o],(function(t){t.width="",t.height=""}))}}},{key:"destroy",value:function(){new Mt.a(this.clone).destroy()}}]),t}();n(80);function Qt(t){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Jt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wot=e,this.headerWidths=new Map}var e,n,r;return e=t,(n=[{key:"getWidth",value:function(t){var e=this.wot.wtSettings.settings.columnWidth;return"function"==typeof e?e=e(t):"object"===Qt(e)&&(e=e[t]),e||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(t){var e=this.getWidth(t),n=this.wot.wtViewport.columnsRenderCalculator,r=null==e?this.wot.wtSettings.settings.defaultColumnWidth:e;if(n){var o=n.getStretchedColumnWidth(t,r);o&&(r=o)}return r}},{key:"getHeaderHeight",value:function(t){var e=this.wot.wtSettings.settings.defaultRowHeight,n=this.wot.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}},{key:"getHeaderWidth",value:function(t){return this.headerWidths.get(this.wot.wtTable.columnFilter.sourceToRendered(t))}},{key:"calculateWidths",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,r=t.cloneSource,o=r?r.wtTable.holder:e.holder,i=o.offsetHeight<o.scrollHeight?Object(C.getScrollbarWidth)():0,a=t.getSetting("rowHeaderWidth");if(n.columnsRenderCalculator.refreshStretching(n.getViewportWidth()-i),null!=(a=t.getSetting("onModifyRowHeaderWidth",a)))for(var s=t.getSetting("rowHeaders").length,l=t.getSetting("defaultColumnWidth"),u=0;u<s;u++){var c=Array.isArray(a)?a[u]:a;c=null==c?l:c,this.headerWidths.set(u,c)}}}])&&Zt(e.prototype,n),r&&Zt(e,r),t}();function te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ee=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wot=e}var e,n,r;return e=t,(n=[{key:"getHeight",value:function(t){var e=this.wot.wtSettings.settings.rowHeight(t),n=this.wot.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}}])&&te(e.prototype,n),r&&te(e,r),t}();function ne(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function re(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ie=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isMaster=!e.cloneOverlay,this.wot=e,this.instance=this.wot,this.TABLE=n,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,this.hasTableHeight=!0,this.hasTableWidth=!0,this.isTableVisible=!1,Object(C.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var o=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return r._modifyRowHeaderWidth(o)},this.rowUtils=new ee(this.wot),this.columnUtils=new Jt(this.wot),this.tableRenderer=new Rt({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wot.wtSettings.settings.cellRenderer})}var e,n,r;return e=t,(n=[{key:"is",value:function(t){return $t.isOverlayTypeOf(this.wot.cloneOverlay,t)}},{key:"fixTableDomTree",value:function(){var t=this.wot.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(t.createElement("TR"))}},{key:"createSpreader",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(C.hasClass)(n,"wtHolder")||((e=this.wot.rootDocument.createElement("div")).className="wtSpreader",n&&n.insertBefore(e,t),e.appendChild(t)),e.style.position="relative",e}},{key:"createHider",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(C.hasClass)(n,"wtHolder")||((e=this.wot.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(e,t),e.appendChild(t)),e}},{key:"createHolder",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(C.hasClass)(n,"wtHolder")||((e=this.wot.rootDocument.createElement("div")).style.position="relative",e.className="wtHolder",n&&n.insertBefore(e,t),this.isMaster&&(e.parentNode.className+="ht_master handsontable"),e.appendChild(t)),e}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wot,n=e.wtOverlays,r=e.wtViewport,o=e.getSetting("totalRows"),i=e.getSetting("totalColumns"),a=e.getSetting("rowHeaders"),s=a.length,l=e.getSetting("columnHeaders"),u=l.length,c=!1,f=t;if(this.isMaster&&(this.holderOffset=Object(C.offset)(this.holder),f=r.createRenderCalculators(f),s&&!e.getSetting("fixedColumnsLeft"))){var h=n.leftOverlay.getScrollPosition(),d=this.correctHeaderWidth;this.correctHeaderWidth=h>0,d!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(c=n.prepareOverlays()),f)this.isMaster&&r.createVisibleCalculators(),n&&n.refresh(!0);else{this.isMaster?this.tableOffset=Object(C.offset)(this.TABLE):this.tableOffset=this.wot.cloneSource.wtTable.tableOffset;var p=o>0?this.getFirstRenderedRow():0,g=i>0?this.getFirstRenderedColumn():0;this.rowFilter=new O(p,o,u),this.columnFilter=new b(g,i,s);var v,y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var m={};this.wot.getSetting("beforeDraw",!0,m),y=!0!==m.skipRender}if(y)if(this.tableRenderer.setHeaderContentRenderers(a,l),(this.is($t.CLONE_BOTTOM)||this.is($t.CLONE_BOTTOM_LEFT_CORNER))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(v=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is($t.CLONE_BOTTOM))&&this.markOversizedRows(),this.isMaster){this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var w=Object(C.outerWidth)(this.hider),E=Object(C.outerWidth)(this.TABLE);0!==w&&E!==w&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),v!==this.wot.wtViewport.getWorkspaceWidth()&&(this.wot.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wot.getSetting("onDraw",!0)}else this.is($t.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize()}return this.refreshSelections(f),this.isMaster&&(n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&n.bottomOverlay.resetFixedPosition(),n.leftOverlay.resetFixedPosition(),n.topLeftCornerOverlay&&n.topLeftCornerOverlay.resetFixedPosition(),n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.resetFixedPosition()),c&&n.syncScrollWithMaster(),e.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(t){for(var e,n,r,o=this.wot.wtTable.columnFilter.renderedToSource(t),i=this.wot.getSetting("columnHeaders").length,a=this.wot.wtSettings.settings.defaultRowHeight,s=this.wot.getSetting("columnHeaderHeight")||[];i;)i-=1,e=this.wot.wtTable.getColumnHeaderHeight(i),(n=this.wot.wtTable.getColumnHeader(o,i))&&(r=Object(C.innerHeight)(n),(!e&&a<r||e<r)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=r),Array.isArray(s)?null!==s[i]&&void 0!==s[i]&&(this.wot.wtViewport.oversizedColumnHeaders[i]=s[i]):isNaN(s)||(this.wot.wtViewport.oversizedColumnHeaders[i]=s),this.wot.wtViewport.oversizedColumnHeaders[i]<(s[i]||s)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=s[i]||s))}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wot,e=t.wtTable.THEAD.childNodes,n=t.wtViewport.oversizedColumnHeaders,r=0,o=t.getSetting("columnHeaders").length;r<o;r++)if(n[r]){if(!e[r]||0===e[r].childNodes.length)return;e[r].childNodes[0].style.height="".concat(n[r],"px")}}},{key:"resetOversizedRows",value:function(){var t=this.wot;if((this.isMaster||this.is($t.CLONE_BOTTOM))&&!t.getSetting("externalRowCalculator"))for(var e=this.getRenderedRowsCount(),n=0;n<e;n++){var r=this.rowFilter.renderedToSource(n);t.wtViewport.oversizedRows&&t.wtViewport.oversizedRows[r]&&(t.wtViewport.oversizedRows[r]=void 0)}}},{key:"removeClassFromCells",value:function(t){for(var e=this.TABLE.querySelectorAll(".".concat(t)),n=0,r=e.length;n<r;n++)Object(C.removeClass)(e[n],t)}},{key:"refreshSelections",value:function(t){var e=this.wot;if(e.selections){var n=Array.from(e.selections),r=n.length;if(t){for(var o=[],i=0;i<r;i++){for(var a=n[i].settings,s=a.highlightHeaderClassName,l=a.highlightRowClassName,u=a.highlightColumnClassName,c=n[i].classNames,f=c.length,h=0;h<f;h++)o.includes(c[h])||o.push(c[h]);s&&!o.includes(s)&&o.push(s),l&&!o.includes(l)&&o.push(l),u&&!o.includes(u)&&o.push(u)}var d=e.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(d))for(var p=0;p<d.length;p++)o.push(d[p]);for(var g=o.length,v=0;v<g;v++)this.removeClassFromCells(o[v])}for(var y=0;y<r;y++)n[y].draw(e,t)}}},{key:"getCell",value:function(t){var e=t.row,n=t.col,r=this.wot.getSetting("onModifyGetCellCoords",e,n);if(r&&Array.isArray(r)){var o=re(r,2);e=o[0],n=o[1]}if(this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;if(e<0){var i=this.wot.getSetting("columnHeaders").length+e;return this.getColumnHeader(n,i)}var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];if(!a&&e>=0)throw new Error("TR was expected to be rendered but is not");var s=a.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getColumnHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[e];if(n)return n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}},{key:"getRowHeader",value:function(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var e=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return e?e.childNodes[0]:void 0}},{key:"getCoords",value:function(t){var e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=Object(C.closest)(e,["TD","TH"])),null===e)return null;var n=e.parentNode,r=n.parentNode,o=Object(C.index)(n),i=e.cellIndex;return Object(C.overlayContainsElement)($t.CLONE_TOP_LEFT_CORNER,e,this.wtRootElement)||Object(C.overlayContainsElement)($t.CLONE_TOP,e,this.wtRootElement)?"THEAD"===r.nodeName&&(o-=r.childNodes.length):o=Object(C.overlayContainsElement)($t.CLONE_BOTTOM_LEFT_CORNER,e,this.wtRootElement)||Object(C.overlayContainsElement)($t.CLONE_BOTTOM,e,this.wtRootElement)?this.wot.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o),i=Object(C.overlayContainsElement)($t.CLONE_TOP_LEFT_CORNER,e,this.wtRootElement)||Object(C.overlayContainsElement)($t.CLONE_LEFT,e,this.wtRootElement)||Object(C.overlayContainsElement)($t.CLONE_BOTTOM_LEFT_CORNER,e,this.wtRootElement)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),new p(o,i)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var t,e,n,r,o,i=this.TBODY.childNodes.length;if(i*this.wot.wtSettings.settings.defaultRowHeight!=Object(C.innerHeight)(this.TBODY)-1||this.wot.getSetting("fixedRowsBottom"))for(;i;)i-=1,n=this.rowFilter.renderedToSource(i),t=this.getRowHeight(n),e=(o=(r=this.getTrForRow(n)).querySelector("th"))?Object(C.innerHeight)(o):Object(C.innerHeight)(r)-1,(!t&&this.wot.wtSettings.settings.defaultRowHeight<e||t<e)&&(e+=1,this.wot.wtViewport.oversizedRows[n]=e)}}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"isColumnHeaderLevelRendered",value:function(t){return t>this.wot.getSetting("columnHeaders").length-1}},{key:"isRowHeaderLevelRendered",value:function(t){return t>this.wot.getSetting("rowHeaders").length-1}},{key:"isRowBeforeRenderedRows",value:function(t){var e=this.getFirstRenderedRow();return t<0&&(t=0),-1===e||t<e}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&t>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(t){if(t<0){var e=this.wot.getSetting("columnHeaders").length+t;return this.isColumnHeaderLevelRendered(e)}return t>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}},{key:"isColumnBeforeRenderedColumns",value:function(t){var e=this.getFirstRenderedColumn();return t<0&&(t=0),-1===e||t<e}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&t>this.getLastVisibleColumn()}},{key:"isColumnAfterRenderedColumns",value:function(t){if(t<0){var e=this.wot.getSetting("rowHeaders").length+t;return this.isRowHeaderLevelRendered(e)}return this.columnFilter&&t>this.getLastRenderedColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(t){return this.rowUtils.getHeight(t)}},{key:"getColumnHeaderHeight",value:function(t){return this.columnUtils.getHeaderHeight(t)}},{key:"getColumnWidth",value:function(t){return this.columnUtils.getWidth(t)}},{key:"getStretchedColumnWidth",value:function(t){return this.columnUtils.getStretchedColumnWidth(t)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"isVisible",value:function(){return Object(C.isVisible)(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(t){var e=Object(E.isFunction)(t)?t():null;return Array.isArray(e)?(e=ne(e))[e.length-1]=this._correctRowHeaderWidth(e[e.length-1]):e=this._correctRowHeaderWidth(e),e}},{key:"_correctRowHeaderWidth",value:function(t){var e=t;return"number"!=typeof t&&(e=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}])&&oe(e.prototype,n),r&&oe(e,r),t}(),ae={getFirstRenderedRow:function(){var t=this.wot.wtViewport.rowsRenderCalculator.startRow;return null===t?-1:t},getFirstVisibleRow:function(){var t=this.wot.wtViewport.rowsVisibleCalculator.startRow;return null===t?-1:t},getLastRenderedRow:function(){var t=this.wot.wtViewport.rowsRenderCalculator.endRow;return null===t?-1:t},getLastVisibleRow:function(){var t=this.wot.wtViewport.rowsVisibleCalculator.endRow;return null===t?-1:t},getRenderedRowsCount:function(){return this.wot.wtViewport.rowsRenderCalculator.count},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}};Object(_t.defineGetter)(ae,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var se=ae,le={getFirstRenderedColumn:function(){var t=this.wot.wtViewport.columnsRenderCalculator.startColumn;return null===t?-1:t},getFirstVisibleColumn:function(){var t=this.wot.wtViewport.columnsVisibleCalculator.startColumn;return null===t?-1:t},getLastRenderedColumn:function(){var t=this.wot.wtViewport.columnsRenderCalculator.endColumn;return null===t?-1:t},getLastVisibleColumn:function(){var t=this.wot.wtViewport.columnsVisibleCalculator.endColumn;return null===t?-1:t},getRenderedColumnsCount:function(){return this.wot.wtViewport.columnsRenderCalculator.count},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}};Object(_t.defineGetter)(le,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var ue=le;function ce(t){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function he(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function de(t,e){return!e||"object"!==ce(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pe(t){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ge(t,e){return(ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ve=function(t){function e(){return fe(this,e),de(this,pe(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ge(t,e)}(e,t),n=e,(r=[{key:"alignOverlaysWithTrimmingContainer",value:function(){var t=Object(C.getTrimmingContainer)(this.wtRootElement),e=this.wot.rootWindow;if(t===e)this.wot.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{var n=t.parentElement,r=Object(C.getStyle)(t,"height",e),o=Object(C.getStyle)(t,"overflow",e),i=this.holder.style,a=t.scrollWidth,s=t.scrollHeight,l=t.getBoundingClientRect(),u=l.width,c=l.height;if(n&&["auto","hidden","scroll"].includes(o)){var f=t.cloneNode(!1);f.style.overflow="auto",t.nextElementSibling?n.insertBefore(f,t.nextElementSibling):n.appendChild(f);var h=parseInt(Object(C.getComputedStyle)(f,e).height,10);n.removeChild(f),0===h&&(c=0)}c=Math.min(c,s),i.height="auto"===r?"auto":"".concat(c,"px"),u=Math.min(u,a),i.width="".concat(u,"px"),i.overflow="",this.hasTableHeight="auto"===i.height||c>0,this.hasTableWidth=u>0}this.isTableVisible=Object(C.isVisible)(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var t=this.wot,e=t.getOverlayName(),n=t.getSetting("columnHeaders").length;if(n&&!t.wtViewport.hasOversizedColumnHeadersMarked[e]){for(var r=t.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount(),i=0;i<n;i++)for(var a=-1*r;a<o;a++)this.markIfOversizedColumnHeader(a);t.wtViewport.hasOversizedColumnHeadersMarked[e]=!0}}}])&&he(n.prototype,r),o&&he(n,o),e}(ie);Object(_t.mixin)(ve,se),Object(_t.mixin)(ve,ue);var ye=ve,me=(n(131),{getFirstRenderedColumn:function(){return 0===this.wot.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wot.getSetting("totalColumns");return Math.min(this.wot.getSetting("fixedColumnsLeft"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}});Object(_t.defineGetter)(me,"MIXIN_NAME","stickyColumnsLeft",{writable:!1,enumerable:!1});var be=me;function we(t){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ce(t,e){return!e||"object"!==we(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ee(t){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Se(t,e){return(Se=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ke=function(t){function e(){return Oe(this,e),Ce(this,Ee(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Se(t,e)}(e,t),e}(ie);Object(_t.mixin)(ke,se),Object(_t.mixin)(ke,be);var Re=ke;function _e(t){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Te(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Me(t,e,n){return(Me=Te()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&xe(o,n.prototype),o}).apply(null,arguments)}function Ae(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ne(t,e){return!e||"object"!==_e(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function je(t){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xe(t,e){return(xe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ie=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ne(this,je(e).call(this,t))).clone=n.makeClone($t.CLONE_LEFT),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xe(t,e)}(e,t),n=e,(r=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Me(Re,e)}},{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){var t=this.wot.wtTable;if(this.needFullRender&&t.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,n=0,r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==this.wot.rootWindow||r&&"horizontal"===r)n=this.getScrollPosition(),Object(C.resetCssTransform)(e);else{var o,i,a=t.hider.getBoundingClientRect(),s=Math.ceil(a.left),l=Math.ceil(a.right);i=""===(i=t.hider.style.top)?0:i,n=o=s<0&&l-e.offsetWidth>0?-s:0,o+="px",Object(C.setOverlayPosition)(e,o,i)}this.adjustHeaderBordersPosition(n),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(t){var e=this.wot.rootWindow,n=!1;return this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,Object(C.getWindowScrollTop)(e)),n=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,n=!0),n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wot.wtSettings.defaultColumnWidth,r=t,o=0;r<e;)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),t||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot,e=t.wtTable,n=t.rootDocument,r=t.rootWindow,o=Object(C.getScrollbarWidth)(n),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===a){var s=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(s-=o),s=Math.min(s,e.wtRootElement.scrollHeight),i.height="".concat(s,"px")}else i.height="";this.clone.wtTable.holder.style.height=i.height;var l=Object(C.outerWidth)(this.clone.wtTable.TABLE);i.width="".concat(0===l?l:l+4,"px")}},{key:"adjustRootChildrenSize",value:function(){var t=Object(C.getScrollbarWidth)(this.wot.rootDocument);this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===t&&(t=30),this.clone.wtTable.holder.style.width="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+t,"px")}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;return e&&r.offsetWidth!==r.clientWidth&&(o=Object(C.getScrollbarWidth)(this.wot.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),t),n+=o,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var t=0;return this.wot.getSetting("preventOverflow")||this.trimmingContainer!==this.wot.rootWindow||(t=this.wot.wtTable.holderOffset.left),t}},{key:"getScrollPosition",value:function(){return Object(C.getScrollLeft)(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("rowHeaders"),r=this.wot.getSetting("fixedColumnsLeft");if(this.wot.getSetting("totalRows")?Object(C.removeClass)(e,"emptyRows"):Object(C.addClass)(e,"emptyRows"),r&&!n.length)Object(C.addClass)(e,"innerBorderLeft");else if(!r&&n.length){var o=Object(C.hasClass)(e,"innerBorderLeft");t?Object(C.addClass)(e,"innerBorderLeft"):Object(C.removeClass)(e,"innerBorderLeft"),(!o&&t||o&&!t)&&this.wot.wtOverlays.adjustElementsSize()}}}])&&Ae(n.prototype,r),o&&Ae(n,o),e}($t);$t.registerOverlay($t.CLONE_LEFT,Ie);var De={getFirstRenderedRow:function(){return 0===this.wot.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(_t.defineGetter)(De,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var Pe=De;function Le(t){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function He(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fe(t,e){return!e||"object"!==Le(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Be(t){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ue(t,e){return(Ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var We=function(t){function e(){return He(this,e),Fe(this,Be(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ue(t,e)}(e,t),e}(ie);Object(_t.mixin)(We,Pe),Object(_t.mixin)(We,ue);var Ve=We;function Ye(t){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ze(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ge(t,e,n){return(Ge=ze()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&$e(o,n.prototype),o}).apply(null,arguments)}function Xe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qe(t,e){return!e||"object"!==Ye(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ke(t){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $e(t,e){return($e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qe=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=qe(this,Ke(e).call(this,t))).clone=n.makeClone($t.CLONE_TOP),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}(e,t),n=e,(r=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Ge(Ve,e)}},{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==this.wot.rootWindow||n&&"vertical"===n)e=this.getScrollPosition(),Object(C.resetCssTransform)(t);else{var r,o,i=this.wot.wtTable,a=i.hider.getBoundingClientRect(),s=Math.ceil(a.top),l=Math.ceil(a.bottom);r=""===(r=i.hider.style.left)?0:r,e=o=s<0&&l-t.offsetHeight>0?-s:0,o+="px",Object(C.setOverlayPosition)(t,r,o)}this.adjustHeaderBordersPosition(e),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(t){var e=this.wot.rootWindow,n=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(Object(C.getWindowScrollLeft)(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wot.wtSettings.settings.defaultRowHeight,r=t,o=0;r<e;){var i=this.wot.wtTable.getRowHeight(r);o+=void 0===i?n:i,r+=1}return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),t||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot,e=t.wtTable,n=t.rootDocument,r=t.rootWindow,o=Object(C.getScrollbarWidth)(n),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===a){var s=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=o),s=Math.min(s,e.wtRootElement.scrollWidth),i.width="".concat(s,"px")}else i.width="";this.clone.wtTable.holder.style.width=i.width;var l=Object(C.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),i.height="".concat(0===l?l:l+4,"px")}},{key:"adjustRootChildrenSize",value:function(){var t=Object(C.getScrollbarWidth)(this.wot.rootDocument);this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===t&&(t=30),this.clone.wtTable.holder.style.height="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+t,"px")}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(t,e){var n=this.wot,r=(n.cloneSource?n.cloneSource:n).wtTable.holder,o=this.getTableParentOffset(),i=0;if(e&&r.offsetHeight!==r.clientHeight&&(i=Object(C.getScrollbarWidth)(n.rootDocument)),e){var a=n.getSetting("fixedRowsBottom"),s=n.getSetting("totalRows");o+=this.sumCellSizes(0,t+1),o-=n.wtViewport.getViewportHeight()-this.sumCellSizes(s-a,s),o+=1}else o+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);return o+=i,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(C.getScrollTop)(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"redrawSelectionBorders",value:function(t){if(t&&t.cellRange){var e=t.getBorder(this.wot),n=t.getCorners();e.disappear(),e.appear(n)}}},{key:"redrawAllSelectionsBorders",value:function(){var t=this,e=this.wot.selections;this.redrawSelectionBorders(e.getCell()),Object(Tt.arrayEach)(e.getAreas(),(function(e){t.redrawSelectionBorders(e)})),this.redrawSelectionBorders(e.getFill()),this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode;if(this.wot.getSetting("totalColumns")?Object(C.removeClass)(e,"emptyColumns"):Object(C.addClass)(e,"emptyColumns"),0===this.wot.getSetting("fixedRowsTop")&&this.wot.getSetting("columnHeaders").length>0){var n=Object(C.hasClass)(e,"innerBorderTop");t||0===this.wot.getSetting("totalRows")?Object(C.addClass)(e,"innerBorderTop"):Object(C.removeClass)(e,"innerBorderTop"),(!n&&t||n&&!t)&&(this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders())}if(0===this.wot.getSetting("rowHeaders").length){var r=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(r)for(var o=0;o<r.length;o++)r[o].style["border-left-width"]=0}}}])&&Xe(n.prototype,r),o&&Xe(n,o),e}($t);$t.registerOverlay($t.CLONE_TOP,Qe);function Ze(t){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Je(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tn(t,e){return!e||"object"!==Ze(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function en(t){return(en=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nn(t,e){return(nn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rn=function(t){function e(){return Je(this,e),tn(this,en(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nn(t,e)}(e,t),e}(ie);Object(_t.mixin)(rn,Pe),Object(_t.mixin)(rn,be);var on=rn;function an(t){return(an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ln(t,e,n){return(ln=sn()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&hn(o,n.prototype),o}).apply(null,arguments)}function un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cn(t,e){return!e||"object"!==an(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fn(t){return(fn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hn(t,e){return(hn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=cn(this,fn(e).call(this,t))).clone=n.makeClone($t.CLONE_TOP_LEFT_CORNER),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hn(t,e)}(e,t),n=e,(r=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return ln(on,e)}},{key:"shouldBeRendered",value:function(){var t=this.wot;return!(!t.getSetting("fixedRowsTop")&&!t.getSetting("columnHeaders").length||!t.getSetting("fixedColumnsLeft")&&!t.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow){var n=this.wot.wtTable.hider.getBoundingClientRect(),r=Math.ceil(n.top),o=Math.ceil(n.left),i=Math.ceil(n.bottom),a=Math.ceil(n.right),s="0",l="0";e&&"vertical"!==e||o<0&&a-t.offsetWidth>0&&(s="".concat(-o,"px")),e&&"horizontal"!==e||r<0&&i-t.offsetHeight>0&&(l="".concat(-r,"px")),Object(C.setOverlayPosition)(t,s,l)}else Object(C.resetCssTransform)(t);var u=Object(C.outerHeight)(this.clone.wtTable.TABLE),c=Object(C.outerWidth)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),t.style.height="".concat(0===u?u:u+4,"px"),t.style.width="".concat(0===c?c:c+4,"px")}}}])&&un(n.prototype,r),o&&un(n,o),e}($t);$t.registerOverlay($t.CLONE_TOP_LEFT_CORNER,dn);var pn={getFirstRenderedRow:function(){var t=this.wot.getSetting("totalRows")-this.wot.getSetting("fixedRowsBottom");return t<0?-1:t},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wot.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(_t.defineGetter)(pn,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var gn=pn;function vn(t){return(vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mn(t,e){return!e||"object"!==vn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bn(t){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wn(t,e){return(wn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var On=function(t){function e(){return yn(this,e),mn(this,bn(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wn(t,e)}(e,t),e}(ie);Object(_t.mixin)(On,gn),Object(_t.mixin)(On,ue);var Cn=On;function En(t){return(En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function kn(t,e,n){return(kn=Sn()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&Mn(o,n.prototype),o}).apply(null,arguments)}function Rn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _n(t,e){return!e||"object"!==En(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tn(t){return(Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mn(t,e){return(Mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var An=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=_n(this,Tn(e).call(this,t))).clone=n.makeClone($t.CLONE_BOTTOM),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mn(t,e)}(e,t),n=e,(r=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return kn(Cn,e)}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.rootDocument,r=this.clone.wtTable.holder.parentNode,o=Object(C.getScrollbarWidth)(n);e.holder.clientHeight===e.holder.offsetHeight&&(o=0),r.style.top="",r.style.bottom="".concat(o,"px")}},{key:"shouldBeRendered",value:function(){return!!this.wot.getSetting("fixedRowsBottom")}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=0;t.style.top="";var n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==this.wot.rootWindow||n&&"vertical"===n)e=this.getScrollPosition(),Object(C.resetCssTransform)(t),this.repositionOverlay();else{var r,o,i=this.wot,a=i.rootDocument,s=i.wtTable,l=s.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=a.body.offsetHeight;r=""===(r=s.hider.style.left)?0:r,e=o=u>c?u-c:0,o+="px",t.style.top="",t.style.left=r,t.style.bottom=o}this.adjustHeaderBordersPosition(e),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(t){var e=this.wot.rootWindow,n=!1;return this.mainTableScrollableElement===e?(e.scrollTo(Object(C.getWindowScrollLeft)(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){for(var n=this.wot,r=n.wtTable,o=n.wtSettings.settings.defaultRowHeight,i=t,a=0;i<e;){var s=r.getRowHeight(i);a+=void 0===s?o:s,i+=1}return a}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),t||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,r=t.rootWindow,o=Object(C.getScrollbarWidth)(this.wot.rootDocument),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===a){var s=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=o),s=Math.min(s,e.wtRootElement.scrollWidth),i.width="".concat(s,"px")}else i.width="";this.clone.wtTable.holder.style.width=i.width;var l=Object(C.outerHeight)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),i.height="".concat(l,"px")}},{key:"adjustRootChildrenSize",value:function(){var t=Object(C.getScrollbarWidth)(this.wot.rootDocument);this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===t&&(t=30),this.clone.wtTable.holder.style.height="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+t,"px")}},{key:"applyToDOM",value:function(){var t=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;e&&r.offsetHeight!==r.clientHeight&&(o=Object(C.getScrollbarWidth)(this.wot.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),t),n+=o,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(C.getScrollTop)(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(t){if(0===this.wot.getSetting("fixedRowsBottom")&&this.wot.getSetting("columnHeaders").length>0){var e=this.wot.wtTable.holder.parentNode,n=Object(C.hasClass)(e,"innerBorderTop");t?Object(C.addClass)(e,"innerBorderTop"):Object(C.removeClass)(e,"innerBorderTop"),(!n&&t||n&&!t)&&this.wot.wtOverlays.adjustElementsSize()}if(0===this.wot.getSetting("rowHeaders").length){var r=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");r&&(r.style["border-left-width"]=0)}}}])&&Rn(n.prototype,r),o&&Rn(n,o),e}($t);$t.registerOverlay($t.CLONE_BOTTOM,An);function Nn(t){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xn(t,e){return!e||"object"!==Nn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function In(t){return(In=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dn(t,e){return(Dn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pn=function(t){function e(){return jn(this,e),xn(this,In(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dn(t,e)}(e,t),e}(ie);Object(_t.mixin)(Pn,gn),Object(_t.mixin)(Pn,be);var Ln=Pn;function Hn(t){return(Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Bn(t,e,n){return(Bn=Fn()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&Yn(o,n.prototype),o}).apply(null,arguments)}function Un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wn(t,e){return!e||"object"!==Hn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vn(t){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yn(t,e){return(Yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Wn(this,Vn(e).call(this,t))).clone=n.makeClone($t.CLONE_BOTTOM_LEFT_CORNER),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yn(t,e)}(e,t),n=e,(r=[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Bn(Ln,e)}},{key:"shouldBeRendered",value:function(){var t=this.wot;return!(!t.getSetting("fixedRowsBottom")||!t.getSetting("fixedColumnsLeft")&&!t.getSetting("rowHeaders").length)}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.rootDocument,r=this.clone.wtTable.holder.parentNode,o=Object(C.getScrollbarWidth)(n);e.holder.clientHeight===e.holder.offsetHeight&&(o=0),r.style.top="",r.style.bottom="".concat(o,"px")}},{key:"resetFixedPosition",value:function(){var t=this.wot;if(this.updateTrimmingContainer(),t.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===t.rootWindow){var n,r,o=t.wtTable.hider.getBoundingClientRect(),i=Math.ceil(o.bottom),a=Math.ceil(o.left),s=t.rootDocument.body.offsetHeight;n=a<0?-a:0,r=i>s?i-s:0,r+="px",n+="px",e.style.top="",e.style.left=n,e.style.bottom=r}else Object(C.resetCssTransform)(e),this.repositionOverlay();var l=Object(C.outerHeight)(this.clone.wtTable.TABLE),u=Object(C.outerWidth)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),e.style.height="".concat(l,"px"),e.style.width="".concat(u,"px")}}}])&&Un(n.prototype,r),o&&Un(n,o),e}($t);$t.registerOverlay($t.CLONE_BOTTOM_LEFT_CORNER,zn);n(70);var Gn=n(14);function Xn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Kn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n&&(this.eventManager=new Mt.a(e),this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}var e,n,r;return e=t,(n=[{key:"registerListeners",value:function(){var t=this,e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",(function(){return t.onMouseDown()})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}));for(var n=function(e,n){t.eventManager.addEventListener(t.main.childNodes[e],"mouseenter",(function(n){return t.onMouseEnter(n,t.main.childNodes[e])}))},r=0,o=this.main.childNodes.length;r<o;r++)n(r)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,e){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),Object(Gn.stopImmediatePropagation)(t);var n=this,r=this.wot.rootDocument.body,o=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(r,"mousemove",(function t(i){var a;((a=i).clientY<Math.floor(o.top)||a.clientY>Math.ceil(o.top+o.height)||a.clientX<Math.floor(o.left)||a.clientX>Math.ceil(o.left+o.width))&&(n.eventManager.removeEventListener(r,"mousemove",t),e.style.display="block")}))}}},{key:"createBorders",value:function(t){var e=this.wot.rootDocument;this.main=e.createElement("div");var n=["top","left","bottom","right","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(var o=0;o<5;o++){var i=n[o],a=e.createElement("div");a.className="wtBorder ".concat(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(a.className+=" hidden"),(r=a.style).backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,r.height=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(t.border.width,"px"),r.width=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(t.border.width,"px"),this.main.appendChild(a)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Object(jt.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear();var s=this.wot.wtTable,l=s.bordersHolder;l||((l=e.createElement("div")).className="htBorders",s.bordersHolder=l,s.spreader.appendChild(l)),l.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var t=this,e=this.wot.rootDocument;this.selectionHandles={topLeft:e.createElement("DIV"),topLeftHitArea:e.createElement("DIV"),bottomRight:e.createElement("DIV"),bottomRightHitArea:e.createElement("DIV")},this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var n={position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")};Object(_t.objectEach)(n,(function(e,n){t.selectionHandles.styles.bottomRightHitArea[n]=e,t.selectionHandles.styles.topLeftHitArea[n]=e}));var r={position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Object(_t.objectEach)(r,(function(e,n){t.selectionHandles.styles.bottomRight[n]=e,t.selectionHandles.styles.topLeft[n]=e})),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(t,e){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||t===n.cellRange.to.row&&e===n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,e,n,r,o,i){var a=parseInt(this.selectionHandles.styles.topLeft.width,10),s=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top="".concat(parseInt(n-a,10),"px"),this.selectionHandles.styles.topLeft.left="".concat(parseInt(r-a,10),"px"),this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(n-s/4*3,10),"px"),this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(r-s/4*3,10),"px"),this.selectionHandles.styles.bottomRight.top="".concat(parseInt(n+i,10),"px"),this.selectionHandles.styles.bottomRight.left="".concat(parseInt(r+o,10),"px"),this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(n+i-s/4,10),"px"),this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(r+o-s/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(t,e)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){for(var e,n,r,o,i=this.wot,a=i.wtTable,s=i.rootDocument,l=i.rootWindow,u=a.getRenderedRowsCount(),c=0;c<u;c+=1){var f=a.rowFilter.renderedToSource(c);if(f>=t[0]&&f<=t[2]){e=f;break}}for(var h=u-1;h>=0;h-=1){var d=a.rowFilter.renderedToSource(h);if(d>=t[0]&&d<=t[2]){n=d;break}}for(var g=a.getRenderedColumnsCount(),v=0;v<g;v+=1){var y=a.columnFilter.renderedToSource(v);if(y>=t[1]&&y<=t[3]){r=y;break}}for(var m=g-1;m>=0;m-=1){var b=a.columnFilter.renderedToSource(m);if(b>=t[1]&&b<=t[3]){o=b;break}}if(void 0!==e&&void 0!==r){var w=a.getCell(new p(e,r)),O=e!==n||r!==o,E=O?a.getCell(new p(n,o)):w,S=Object(C.offset)(w),k=O?Object(C.offset)(E):S,R=Object(C.offset)(a.TABLE),_=S.top,T=S.left,M=T-R.left-1,A=k.left+Object(C.outerWidth)(E)-T;if(this.isEntireColumnSelected(e,n)){var N=this.getDimensionsFromHeader("columns",r,o,R),j=null;if(N){var x=Xn(N,3);j=x[0],M=x[1],A=x[2]}j&&(w=j)}var I=_-R.top-1,D=k.top+Object(C.outerHeight)(E)-_;if(this.isEntireRowSelected(r,o)){var P=this.getDimensionsFromHeader("rows",e,n,R),L=null;if(P){var H=Xn(P,3);L=H[0],I=H[1],D=H[2]}L&&(w=L)}var F=Object(C.getComputedStyle)(w,l);parseInt(F.borderTopWidth,10)>0&&(I+=1,D=D>0?D-1:0),parseInt(F.borderLeftWidth,10)>0&&(M+=1,A=A>0?A-1:0),this.topStyle.top="".concat(I,"px"),this.topStyle.left="".concat(M,"px"),this.topStyle.width="".concat(A,"px"),this.topStyle.display="block",this.leftStyle.top="".concat(I,"px"),this.leftStyle.left="".concat(M,"px"),this.leftStyle.height="".concat(D,"px"),this.leftStyle.display="block";var B=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(I+D-B,"px"),this.bottomStyle.left="".concat(M,"px"),this.bottomStyle.width="".concat(A,"px"),this.bottomStyle.display="block",this.rightStyle.top="".concat(I,"px"),this.rightStyle.left="".concat(M+A-B,"px"),this.rightStyle.height="".concat(D+1,"px"),this.rightStyle.display="block";var U=this.settings.border.cornerVisible;U="function"==typeof U?U(this.settings.layerLevel):U;var W=this.wot.getSetting("onModifyGetCellCoords",n,o),V=n,Y=o;if(W&&Array.isArray(W)){var z=Xn(W,4);V=z[2],Y=z[3]}if(Object(jt.isMobileBrowser)()||!U||this.isPartRange(V,Y))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(I+D-4,"px"),this.cornerStyle.left="".concat(M+A-4,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var G=Object(C.getTrimmingContainer)(a.TABLE),X=G===l;X&&(G=s.documentElement),o===this.wot.getSetting("totalColumns")-1&&(X?E.getBoundingClientRect().left:E.offsetLeft)+Object(C.outerWidth)(E)+parseInt(this.cornerDefaultStyle.width,10)/2>=Object(C.innerWidth)(G)&&(this.cornerStyle.left="".concat(Math.floor(M+A-3-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle.borderRightWidth=0),n===this.wot.getSetting("totalRows")-1&&(X?E.getBoundingClientRect().top:E.offsetTop)+Object(C.outerHeight)(E)+parseInt(this.cornerDefaultStyle.height,10)/2>=Object(C.innerHeight)(G)&&(this.cornerStyle.top="".concat(Math.floor(I+D-3-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Object(jt.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(n,o,I,M,A,D)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(t,e,n,r){var o=this.wot.wtTable,i=o.wtRootElement.parentNode,a=null,s=null,l=null,u=null,c=null,f=null,h=null,d=null;switch(t){case"rows":a=function(){return o.getRowHeader.apply(o,arguments)},s=function(){return C.outerHeight.apply(void 0,arguments)},l="ht__selection--rows",f="top";break;case"columns":a=function(){return o.getColumnHeader.apply(o,arguments)},s=function(){return C.outerWidth.apply(void 0,arguments)},l="ht__selection--columns",f="left"}if(i.className.includes(l)){var p=this.wot.getSetting("columnHeaders").length;if(h=a(e,p-1),d=a(n,p-1),!h||!d)return!1;var g=Object(C.offset)(h),v=Object(C.offset)(d);return h&&d&&(u=g[f]-r[f]-1,c=v[f]+s(d)-g[f]),[h,u,c]}return!1}},{key:"changeBorderStyle",value:function(t,e){var n=this[t].style,r=e[t];!r||r.hide?Object(C.addClass)(this[t],"hidden"):(Object(C.hasClass)(this[t],"hidden")&&Object(C.removeClass)(this[t],"hidden"),n.backgroundColor=r.color,"top"!==t&&"bottom"!==t||(n.height="".concat(r.width,"px")),"right"!==t&&"left"!==t||(n.width="".concat(r.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(t){var e=1,n="#000",r=this[t].style;r.backgroundColor=n,r.width="".concat(e,"px"),r.height="".concat(e,"px")}},{key:"toggleHiddenClass",value:function(t,e){this.changeBorderToDefaultStyle(t),e?Object(C.addClass)(this[t],"hidden"):Object(C.removeClass)(this[t],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",Object(jt.isMobileBrowser)()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}])&&qn(e.prototype,n),r&&qn(e,r),t}();n(27),n(213);function $n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Qn(t){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Jn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}var e,n,r;return e=t,(n=[{key:"getBorder",value:function(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new Kn(t,this.settings)),this.instanceBorders[t.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(t){return this.isEmpty()?this.cellRange=new y(t):this.cellRange.expand(t),this}},{key:"replace",value:function(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var t=this.cellRange.getTopLeftCorner(),e=this.cellRange.getBottomRightCorner();return[t.row,t.col,e.row,e.col]}},{key:"addClassAtCoords",value:function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t.wtTable.getCell(new p(e,n));if("object"===Qn(i)){var a=r;o&&(a=this.classNameGenerator(i),this.classNames.includes(a)||this.classNames.push(a)),Object(C.addClass)(i,a)}return this}},{key:"linearClassNameGenerator",value:function(t,e){return function n(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===e||0===o)return t;var i=o>=0?o:e,a=t,s=0==(i-=1)?t:"".concat(t,"-").concat(i);if(Object(C.hasClass)(r,s)){var l=i+1;a="".concat(t,"-").concat(l)}else a=n(r,i);return a}}},{key:"draw",value:function(t){if(this.isEmpty())this.settings.border&&this.getBorder(t).disappear();else{for(var e=t.wtTable.getRenderedRowsCount(),n=t.wtTable.getRenderedColumnsCount(),r=this.getCorners(),o=$n(r,4),i=o[0],a=o[1],s=o[2],l=o[3],u=0;u<n;u+=1){var c=t.wtTable.columnFilter.renderedToSource(u);if(c>=a&&c<=l){var f=t.wtTable.getColumnHeader(c);if(f){var h=[];this.settings.highlightHeaderClassName&&h.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&h.push(this.settings.highlightColumnClassName),Object(C.addClass)(f,h)}}}for(var d=0;d<e;d+=1){var p=t.wtTable.rowFilter.renderedToSource(d);if(p>=i&&p<=s){var g=t.wtTable.getRowHeader(p);if(g){var v=[];this.settings.highlightHeaderClassName&&v.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&v.push(this.settings.highlightRowClassName),Object(C.addClass)(g,v)}}for(var y=0;y<n;y+=1){var m=t.wtTable.columnFilter.renderedToSource(y);p>=i&&p<=s&&m>=a&&m<=l?this.settings.className&&this.addClassAtCoords(t,p,m,this.settings.className,this.settings.markIntersections):p>=i&&p<=s?this.settings.highlightRowClassName&&this.addClassAtCoords(t,p,m,this.settings.highlightRowClassName):m>=a&&m<=l&&this.settings.highlightColumnClassName&&this.addClassAtCoords(t,p,m,this.settings.highlightColumnClassName);var b=t.getSetting("onAfterDrawSelection",p,m,r,this.settings.layerLevel);"string"==typeof b&&this.addClassAtCoords(t,p,m,b)}}t.getSetting("onBeforeDrawBorders",r,this.settings.className),this.settings.border&&this.getBorder(t).appear(r)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(t){return t.destroy()}))}}])&&Zn(e.prototype,n),r&&Zn(e,r),t}();n.d(e,"d",(function(){return s})),n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return y})),n.d(e,"e",(function(){return Gt})),n.d(e,"c",(function(){return Jn}))},function(t,e,n){"use strict";var r=n(72),o=n(121),i=n(123),a=n(89),s=n(165),l=a.set,u=a.getterFor("Array Iterator");t.exports=s(Array,"Array",(function(t,e){l(this,{type:"Array Iterator",target:r(t),index:0,kind:e})}),(function(){var t=u(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),i.Arguments=i.Array,o("keys"),o("values"),o("entries")},function(t,e,n){"use strict";var r=n(168).charAt,o=n(89),i=n(165),a=o.set,s=o.getterFor("String Iterator");i(String,"String",(function(t){a(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=s(this),n=e.string,o=e.index;return o>=n.length?{value:void 0,done:!0}:(t=r(n,o),e.index+=t.length,{value:t,done:!1})}))},function(t,e,n){var r=n(49),o=n(201),i=n(7),a=n(78),s=n(50),l=s("iterator"),u=s("toStringTag"),c=i.values;for(var f in o){var h=r[f],d=h&&h.prototype;if(d){if(d[l]!==c)try{a(d,l,c)}catch(t){d[l]=c}if(d[u]||a(d,u,f),o[f])for(var p in i)if(d[p]!==i[p])try{a(d,p,i[p])}catch(t){d[p]=i[p]}}}},function(t,e,n){"use strict";var r=n(26),o=n(49),i=n(104),a=n(103),s=n(59),l=n(164),u=n(190),c=n(31),f=n(60),h=n(126),d=n(52),p=n(57),g=n(67),v=n(72),y=n(118),m=n(116),b=n(105),w=n(122),O=n(120),C=n(189),E=n(163),S=n(83),k=n(64),R=n(135),_=n(78),T=n(79),M=n(160),A=n(136),N=n(119),j=n(137),x=n(50),I=n(202),D=n(203),P=n(141),L=n(89),H=n(84).forEach,F=A("hidden"),B=x("toPrimitive"),U=L.set,W=L.getterFor("Symbol"),V=Object.prototype,Y=o.Symbol,z=i("JSON","stringify"),G=S.f,X=k.f,q=C.f,K=R.f,$=M("symbols"),Q=M("op-symbols"),Z=M("string-to-symbol-registry"),J=M("symbol-to-string-registry"),tt=M("wks"),et=o.QObject,nt=!et||!et.prototype||!et.prototype.findChild,rt=s&&c((function(){return 7!=b(X({},"a",{get:function(){return X(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=G(V,e);r&&delete V[e],X(t,e,n),r&&t!==V&&X(V,e,r)}:X,ot=function(t,e){var n=$[t]=b(Y.prototype);return U(n,{type:"Symbol",tag:t,description:e}),s||(n.description=e),n},it=u?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof Y},at=function(t,e,n){t===V&&at(Q,e,n),p(t);var r=y(e,!0);return p(n),f($,r)?(n.enumerable?(f(t,F)&&t[F][r]&&(t[F][r]=!1),n=b(n,{enumerable:m(0,!1)})):(f(t,F)||X(t,F,m(1,{})),t[F][r]=!0),rt(t,r,n)):X(t,r,n)},st=function(t,e){p(t);var n=v(e),r=w(n).concat(ft(n));return H(r,(function(e){s&&!lt.call(n,e)||at(t,e,n[e])})),t},lt=function(t){var e=y(t,!0),n=K.call(this,e);return!(this===V&&f($,e)&&!f(Q,e))&&(!(n||!f(this,e)||!f($,e)||f(this,F)&&this[F][e])||n)},ut=function(t,e){var n=v(t),r=y(e,!0);if(n!==V||!f($,r)||f(Q,r)){var o=G(n,r);return!o||!f($,r)||f(n,F)&&n[F][r]||(o.enumerable=!0),o}},ct=function(t){var e=q(v(t)),n=[];return H(e,(function(t){f($,t)||f(N,t)||n.push(t)})),n},ft=function(t){var e=t===V,n=q(e?Q:v(t)),r=[];return H(n,(function(t){!f($,t)||e&&!f(V,t)||r.push($[t])})),r};(l||(T((Y=function(){if(this instanceof Y)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=j(t),n=function(t){this===V&&n.call(Q,t),f(this,F)&&f(this[F],e)&&(this[F][e]=!1),rt(this,e,m(1,t))};return s&&nt&&rt(V,e,{configurable:!0,set:n}),ot(e,t)}).prototype,"toString",(function(){return W(this).tag})),T(Y,"withoutSetter",(function(t){return ot(j(t),t)})),R.f=lt,k.f=at,S.f=ut,O.f=C.f=ct,E.f=ft,I.f=function(t){return ot(x(t),t)},s&&(X(Y.prototype,"description",{configurable:!0,get:function(){return W(this).description}}),a||T(V,"propertyIsEnumerable",lt,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:Y}),H(w(tt),(function(t){D(t)})),r({target:"Symbol",stat:!0,forced:!l},{for:function(t){var e=String(t);if(f(Z,e))return Z[e];var n=Y(e);return Z[e]=n,J[n]=e,n},keyFor:function(t){if(!it(t))throw TypeError(t+" is not a symbol");if(f(J,t))return J[t]},useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),r({target:"Object",stat:!0,forced:!l,sham:!s},{create:function(t,e){return void 0===e?b(t):st(b(t),e)},defineProperty:at,defineProperties:st,getOwnPropertyDescriptor:ut}),r({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:ct,getOwnPropertySymbols:ft}),r({target:"Object",stat:!0,forced:c((function(){E.f(1)}))},{getOwnPropertySymbols:function(t){return E.f(g(t))}}),z)&&r({target:"JSON",stat:!0,forced:!l||c((function(){var t=Y();return"[null]"!=z([t])||"{}"!=z({a:t})||"{}"!=z(Object(t))}))},{stringify:function(t,e,n){for(var r,o=[t],i=1;arguments.length>i;)o.push(arguments[i++]);if(r=e,(d(e)||void 0!==t)&&!it(t))return h(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!it(e))return e}),o[1]=e,z.apply(null,o)}});Y.prototype[B]||_(Y.prototype,B,Y.prototype.valueOf),P(Y,"Symbol"),N[F]=!0},function(t,e,n){"use strict";var r=n(26),o=n(59),i=n(49),a=n(60),s=n(52),l=n(64).f,u=n(185),c=i.Symbol;if(o&&"function"==typeof c&&(!("description"in c.prototype)||void 0!==c().description)){var f={},h=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof h?new c(t):void 0===t?c():c(t);return""===t&&(f[e]=!0),e};u(h,c);var d=h.prototype=c.prototype;d.constructor=h;var p=d.toString,g="Symbol(test)"==String(c("test")),v=/^Symbol\((.*)\)[^)]+$/;l(d,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,e=p.call(t);if(a(f,t))return"";var n=g?e.slice(7,-1):e.replace(v,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:h})}},function(t,e,n){n(203)("iterator")},function(t,e,n){"use strict";n.r(e),n.d(e,"stringify",(function(){return p})),n.d(e,"isDefined",(function(){return g})),n.d(e,"isUndefined",(function(){return v})),n.d(e,"isEmpty",(function(){return y})),n.d(e,"isRegExp",(function(){return m})),n.d(e,"_injectProductInfo",(function(){return T}));n(10),n(11),n(12),n(7),n(38),n(81),n(5),n(33),n(15),n(235),n(8),n(210),n(58),n(69),n(9);var r=n(28),o=n.n(r),i=n(36);function a(){var t=h(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.']);return a=function(){return t},t}function s(){var t=h(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.']);return s=function(){return t},t}function l(){var t=h(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.']);return l=function(){return t},t}function u(){var t=h(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."]);return u=function(){return t},t}function c(){var t=h(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."]);return c=function(){return t},t}function f(){var t=h(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."]);return f=function(){return t},t}function h(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t){var e;switch(d(t)){case"string":case"number":e="".concat(t);break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function g(t){return void 0!==t}function v(t){return void 0===t}function y(t){return null===t||""===t||v(t)}function m(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var b="length",w=function(t){return parseInt(t,16)},O=function(t){return parseInt(t,10)},C=function(t,e,n){return t.substr(e,n)},E=function(t){return t.codePointAt(0)-65},S=function(t){return"".concat(t).replace(/\-/g,"")},k=!1,R={invalid:function(){return Object(i.a)(f())},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return Object(i.a)(c(),e,n,e)},missing:function(){return Object(i.a)(u())},non_commercial:function(){return""}},_={invalid:function(){return Object(i.a)(l())},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return Object(i.a)(s(),e,n,e)},missing:function(){return Object(i.a)(a())},non_commercial:function(){return""}};function T(t,e){var n,r,i=!y(t),a="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),s="invalid",l="invalid",u=function(t){var e=[][b],n=e;if(t[b]!==E("Z"))return!1;for(var r="",o="B<H4P+".split(""),i=E(o.shift());i;i=E(o.shift()||"A"))--i<""[b]?n|=(O("".concat(O(w(r)+(w(C(t,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:r=C(t,i,i?1===o[b]?9:8:6);return n===e}(t=S(t||""));if(i||a||u)if(u){var c=o()("19/02/2020","DD/MM/YYYY"),f=Math.floor(c.toDate().getTime()/864e5),h=w(C(S(r=t),w("12"),E("F")))/(w(C(S(r),E("B"),~~![][b]))||9);if(n=o()(864e5*(h+1),"x").format("MMMM DD, YYYY"),f>h){var d=o()().diff(c,"days");s=d<=1?"valid":"expired",l=d<=15?"valid":"expired"}else s="valid",l="valid"}else a?(s="non_commercial",l="valid"):(s="invalid",l="invalid");else s="missing",l="missing";("undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)&&(s="valid",l="valid"),k||"valid"===s)||(R[s]({keyValidityDate:n,hotVersion:"7.4.2"})&&console["non_commercial"===s?"info":"warn"](R[s]({keyValidityDate:n,hotVersion:"7.4.2"})),k=!0);if("valid"!==l&&e.parentNode&&_[l]({keyValidityDate:n,hotVersion:"7.4.2"})){var p=document.createElement("div");p.id="hot-display-license-info",p.innerHTML=_[l]({keyValidityDate:n,hotVersion:"7.4.2"}),e.parentNode.insertBefore(p,e.nextSibling)}}},function(t,e,n){"use strict";n.r(e),n.d(e,"stopImmediatePropagation",(function(){return o})),n.d(e,"isImmediatePropagationStopped",(function(){return i})),n.d(e,"stopPropagation",(function(){return a})),n.d(e,"pageX",(function(){return s})),n.d(e,"pageY",(function(){return l})),n.d(e,"isRightClick",(function(){return u})),n.d(e,"isLeftClick",(function(){return c}));var r=n(0);function o(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function i(t){return!1===t.isImmediatePropagationEnabled}function a(t){"function"==typeof t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function s(t){if(t.pageX)return t.pageX;var e=t.target.ownerDocument.defaultView;return t.clientX+Object(r.getWindowScrollLeft)(e)}function l(t){if(t.pageY)return t.pageY;var e=t.target.ownerDocument.defaultView,n=Object(r.getWindowScrollTop)(e);for(e=Object(r.getParentWindow)(e);e;)n-=Object(r.getWindowScrollTop)(e),e=Object(r.getParentWindow)(e);return t.clientY+n}function u(t){return 2===t.button}function c(t){return 0===t.button}},function(t,e,n){"use strict";var r=n(79),o=n(57),i=n(31),a=n(174),s=RegExp.prototype,l=s.toString,u=i((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),c="toString"!=l.name;(u||c)&&r(RegExp.prototype,"toString",(function(){var t=o(this),e=String(t.source),n=t.flags;return"/"+e+"/"+String(void 0===n&&t instanceof RegExp&&!("flags"in s)?a.call(t):n)}),{unsafe:!0})},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i})),n.d(e,"e",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return l}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function a(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function s(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function l(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}},function(t,e,n){var r=n(26),o=n(31),i=n(67),a=n(140),s=n(193);r({target:"Object",stat:!0,forced:o((function(){a(1)})),sham:!s},{getPrototypeOf:function(t){return a(i(t))}})},function(t,e,n){n(26)({target:"Object",stat:!0},{setPrototypeOf:n(166)})},function(t,e,n){"use strict";n.d(e,"d",(function(){return s})),n.d(e,"a",(function(){return l})),n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return c}));n(7),n(75),n(5),n(8),n(32),n(9);var r=n(20),o=n(2),i=n(40),a=new WeakMap;function s(t,e){var n=Object(i.toUpperCaseFirst)(t);r.a.getSingleton().add("construct",(function(){a.has(this)||a.set(this,{});var t=a.get(this);t[n]||(t[n]=new e(this))})),r.a.getSingleton().add("afterDestroy",(function(){if(a.has(this)){var t=a.get(this);Object(o.objectEach)(t,(function(t){return t.destroy()})),a.delete(this)}}))}function l(t,e){if("string"!=typeof e)throw Error('Only strings can be passed as "plugin" parameter');var n=Object(i.toUpperCaseFirst)(e);if(a.has(t)&&a.get(t)[n])return a.get(t)[n]}function u(t){return a.has(t)?Object.keys(a.get(t)):[]}function c(t,e){var n=null;return a.has(t)&&Object(o.objectEach)(a.get(t),(function(t,r){t===e&&(n=r)})),n}},function(t,e,n){"use strict";n(23),n(45);var r=n(1),o=n(2);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}var s=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","skipLengthCache","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions"],l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.globalBucket=this.createEmptyBucket()}return a(t,null,[{key:"getSingleton",value:function(){return u}}]),a(t,[{key:"createEmptyBucket",value:function(){var t=Object.create(null);return Object(r.arrayEach)(s,(function(e){return t[e]=[]})),t}},{key:"getBucket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}},{key:"add",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))Object(r.arrayEach)(e,(function(e){return n.add(t,e,o)}));else{var i=this.getBucket(o);if(void 0===i[t]&&(this.register(t),i[t]=[]),e.skip=!1,-1===i[t].indexOf(e)){var a=!1;e.initialHook&&Object(r.arrayEach)(i[t],(function(n,r){if(n.initialHook)return i[t][r]=e,a=!0,!1})),a||i[t].push(e)}}return this}},{key:"once",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?Object(r.arrayEach)(e,(function(e){return n.once(t,e,o)})):(e.runOnce=!0,this.add(t,e,o))}},{key:"remove",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return void 0!==r[t]&&r[t].indexOf(e)>=0&&(e.skip=!0,!0)}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(e);return!(void 0===n[t]||!n[t].length)}},{key:"run",value:function(t,e,n,r,o,i,a,s){var l=this.globalBucket[e],u=l?l.length:0,c=0;if(u)for(;c<u;)if(l[c]&&!l[c].skip){var f=l[c].call(t,n,r,o,i,a,s);void 0!==f&&(n=f),l[c]&&l[c].runOnce&&this.remove(e,l[c]),c+=1}else c+=1;var h=this.getBucket(t)[e],d=h?h.length:0,p=0;if(d)for(;p<d;)if(h[p]&&!h[p].skip){var g=h[p].call(t,n,r,o,i,a,s);void 0!==g&&(n=g),h[p]&&h[p].runOnce&&this.remove(e,h[p],t),p+=1}else p+=1;return n}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(o.objectEach)(this.getBucket(t),(function(t,e,n){return n[e].length=0}))}},{key:"register",value:function(t){this.isRegistered(t)||s.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&s.splice(s.indexOf(t),1)}},{key:"isRegistered",value:function(t){return s.indexOf(t)>=0}},{key:"getRegistered",value:function(){return s}}]),t}(),u=new l;e.a=l},function(t,e,n){"use strict";n.r(e),n.d(e,"KEY_CODES",(function(){return o})),n.d(e,"isPrintableChar",(function(){return i})),n.d(e,"isMetaKey",(function(){return a})),n.d(e,"isCtrlKey",(function(){return s})),n.d(e,"isCtrlMetaKey",(function(){return l})),n.d(e,"isKey",(function(){return u}));n(43),n(23),n(33),n(54),n(69);var r=n(1),o={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88};function i(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function a(t){return-1!==[o.ARROW_DOWN,o.ARROW_UP,o.ARROW_LEFT,o.ARROW_RIGHT,o.HOME,o.END,o.DELETE,o.BACKSPACE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.TAB,o.PAGE_DOWN,o.PAGE_UP,o.ENTER,o.ESCAPE,o.SHIFT,o.CAPS_LOCK,o.ALT].indexOf(t)}function s(t){var e=[];return navigator.platform.includes("Mac")?e.push(o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX):e.push(o.CONTROL),e.includes(t)}function l(t){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(t)}function u(t,e){var n=e.split("|"),i=!1;return Object(r.arrayEach)(n,(function(e){if(t===o[e])return i=!0,!1})),i}},function(t,e,n){"use strict";n.d(e,"b",(function(){return h}));n(45);var r=n(0),o=n(2),i=n(37),a=n(14);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=0,c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;s(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}var e,n,r;return e=t,(n=[{key:"addEventListener",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this.context;function s(t){n.call(this,f(a,t))}return"boolean"==typeof o||Object(i.isPassiveEventSupported)()||(o=!1),this.context.eventListeners.push({element:t,event:e,callback:n,callbackProxy:s,options:o,eventManager:this}),t.addEventListener(e,s,o),u+=1,function(){r.removeEventListener(t,e,n)}}},{key:"removeEventListener",value:function(t,e,n){for(var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;i;)if(i-=1,(r=this.context.eventListeners[i]).event===e&&r.element===t){if(n&&n!==r.callback)continue;if(o&&r.eventManager!==this)continue;this.context.eventListeners.splice(i,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),u-=1}}},{key:"clearEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var e=this.context.eventListeners.length;e;){e-=1;var n=this.context.eventListeners[e];n&&this.removeEventListener(n.element,n.event,n.callback,t)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(t,e){var n=t.document,r=t;n||(r=(n=t.ownerDocument?t.ownerDocument:t).defaultView);var o,i={bubbles:!0,cancelable:"mousemove"!==e,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};n.createEvent?(o=n.createEvent("MouseEvents")).initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode):o=n.createEventObject(),t.dispatchEvent?t.dispatchEvent(o):t.fireEvent("on".concat(e),o)}}])&&l(e.prototype,n),r&&l(e,r),t}();function f(t,e){var n,s,l,u,f;e.isTargetWebComponent=!1,e.realTarget=e.target;var h=e.stopImmediatePropagation;if(e.stopImmediatePropagation=function(){h.apply(this),Object(a.stopImmediatePropagation)(this)},!c.isHotTableEnv)return e;for(f=(e=Object(r.polymerWrap)(e)).path?e.path.length:0;f;){if(f-=1,"HOT-TABLE"===e.path[f].nodeName)n=!0;else if(n&&e.path[f].shadowRoot){u=e.path[f];break}0!==f||u||(u=e.path[f])}return u||(u=e.target),e.isTargetWebComponent=!0,Object(i.isWebComponentSupportedNatively)()?e.realTarget=e.srcElement||e.toElement:(Object(o.hasOwnProperty)(t,"hot")||t.isHotTableEnv||t.wtTable)&&(Object(o.hasOwnProperty)(t,"hot")?s=t.hot?t.hot.view.wt.wtTable.TABLE:null:t.isHotTableEnv?s=t.view.activeWt.wtTable.TABLE.parentNode.parentNode:t.wtTable&&(s=t.wtTable.TABLE.parentNode.parentNode),l=Object(r.closest)(e.target,["HOT-TABLE"],s),e.realTarget=l&&s.querySelector("HOT-TABLE")||e.target),Object.defineProperty(e,"target",{get:function(){return Object(r.polymerWrap)(u)},enumerable:!0,configurable:!0}),e}function h(){return u}e.a=c},function(t,e,n){"use strict";var r=n(26),o=n(161).indexOf,i=n(91),a=n(68),s=[].indexOf,l=!!s&&1/[1].indexOf(1,-0)<0,u=i("indexOf"),c=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:l||!u||!c},{indexOf:function(t){return l?s.apply(this,arguments)||0:o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(26),o=n(31),i=n(72),a=n(83).f,s=n(59),l=o((function(){a(1)}));r({target:"Object",stat:!0,forced:!s||l,sham:!s},{getOwnPropertyDescriptor:function(t,e){return a(i(t),e)}})},function(t,e,n){var r=n(26),o=n(52),i=n(57),a=n(60),s=n(83),l=n(140);r({target:"Reflect",stat:!0},{get:function t(e,n){var r,u,c=arguments.length<3?e:arguments[2];return i(e)===c?e[n]:(r=s.f(e,n))?a(r,"value")?r.value:void 0===r.get?void 0:r.get.call(c):o(u=l(e))?t(u,n,c):void 0}})},function(t,e,n){var r=n(49),o=n(83).f,i=n(78),a=n(79),s=n(159),l=n(185),u=n(139);t.exports=function(t,e){var n,c,f,h,d,p=t.target,g=t.global,v=t.stat;if(n=g?r:v?r[p]||s(p,{}):(r[p]||{}).prototype)for(c in e){if(h=e[c],f=t.noTargetGet?(d=o(n,c))&&d.value:n[c],!u(g?c:p+(v?".":"#")+c,t.forced)&&void 0!==f){if(typeof h==typeof f)continue;l(h,f)}(t.sham||f&&f.sham)&&i(h,"sham",!0),a(n,c,h,t)}}},function(t,e,n){"use strict";var r=n(26),o=n(31),i=n(126),a=n(52),s=n(67),l=n(62),u=n(127),c=n(173),f=n(128),h=n(50),d=n(206),p=h("isConcatSpreadable"),g=d>=51||!o((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),v=f("concat"),y=function(t){if(!a(t))return!1;var e=t[p];return void 0!==e?!!e:i(t)};r({target:"Array",proto:!0,forced:!g||!v},{concat:function(t){var e,n,r,o,i,a=s(this),f=c(a,0),h=0;for(e=-1,r=arguments.length;e<r;e++)if(i=-1===e?a:arguments[e],y(i)){if(h+(o=l(i.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<o;n++,h++)n in i&&u(f,h,i[n])}else{if(h>=9007199254740991)throw TypeError("Maximum allowed index exceeded");u(f,h++,i)}return f.length=h,f}})},function(t,e,n){(function(t){t.exports=function(){"use strict";var e,n;function r(){return e.apply(null,arguments)}function o(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function i(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function a(t){return void 0===t}function s(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function l(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function u(t,e){var n,r=[];for(n=0;n<t.length;++n)r.push(e(t[n],n));return r}function c(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function f(t,e){for(var n in e)c(e,n)&&(t[n]=e[n]);return c(e,"toString")&&(t.toString=e.toString),c(e,"valueOf")&&(t.valueOf=e.valueOf),t}function h(t,e,n,r){return Ee(t,e,n,r,!0).utc()}function d(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function p(t){if(null==t._isValid){var e=d(t),r=n.call(e.parsedDateParts,(function(t){return null!=t})),o=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r);if(t._strict&&(o=o&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return o;t._isValid=o}return t._isValid}function g(t){var e=h(NaN);return null!=t?f(d(e),t):d(e).userInvalidated=!0,e}n=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),n=e.length>>>0,r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};var v=r.momentProperties=[];function y(t,e){var n,r,o;if(a(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),a(e._i)||(t._i=e._i),a(e._f)||(t._f=e._f),a(e._l)||(t._l=e._l),a(e._strict)||(t._strict=e._strict),a(e._tzm)||(t._tzm=e._tzm),a(e._isUTC)||(t._isUTC=e._isUTC),a(e._offset)||(t._offset=e._offset),a(e._pf)||(t._pf=d(e)),a(e._locale)||(t._locale=e._locale),v.length>0)for(n=0;n<v.length;n++)a(o=e[r=v[n]])||(t[r]=o);return t}var m=!1;function b(t){y(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===m&&(m=!0,r.updateOffset(this),m=!1)}function w(t){return t instanceof b||null!=t&&null!=t._isAMomentObject}function O(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function C(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=O(e)),n}function E(t,e,n){var r,o=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),a=0;for(r=0;r<o;r++)(n&&t[r]!==e[r]||!n&&C(t[r])!==C(e[r]))&&a++;return a+i}function S(t){!1===r.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function k(t,e){var n=!0;return f((function(){if(null!=r.deprecationHandler&&r.deprecationHandler(null,t),n){for(var o,i=[],a=0;a<arguments.length;a++){if(o="","object"==typeof arguments[a]){for(var s in o+="\n["+a+"] ",arguments[0])o+=s+": "+arguments[0][s]+", ";o=o.slice(0,-2)}else o=arguments[a];i.push(o)}S(t+"\nArguments: "+Array.prototype.slice.call(i).join("")+"\n"+(new Error).stack),n=!1}return e.apply(this,arguments)}),e)}var R,_={};function T(t,e){null!=r.deprecationHandler&&r.deprecationHandler(t,e),_[t]||(S(e),_[t]=!0)}function M(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function A(t,e){var n,r=f({},t);for(n in e)c(e,n)&&(i(t[n])&&i(e[n])?(r[n]={},f(r[n],t[n]),f(r[n],e[n])):null!=e[n]?r[n]=e[n]:delete r[n]);for(n in t)c(t,n)&&!c(e,n)&&i(t[n])&&(r[n]=f({},r[n]));return r}function N(t){null!=t&&this.set(t)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null,R=Object.keys?Object.keys:function(t){var e,n=[];for(e in t)c(t,e)&&n.push(e);return n};var j={};function x(t,e){var n=t.toLowerCase();j[n]=j[n+"s"]=j[e]=t}function I(t){return"string"==typeof t?j[t]||j[t.toLowerCase()]:void 0}function D(t){var e,n,r={};for(n in t)c(t,n)&&(e=I(n))&&(r[e]=t[n]);return r}var P={};function L(t,e){P[t]=e}function H(t,e,n){var r=""+Math.abs(t),o=e-r.length;return(t>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+r}var F=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,B=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,U={},W={};function V(t,e,n,r){var o=r;"string"==typeof r&&(o=function(){return this[r]()}),t&&(W[t]=o),e&&(W[e[0]]=function(){return H(o.apply(this,arguments),e[1],e[2])}),n&&(W[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),t)})}function Y(t,e){return t.isValid()?(e=z(e,t.localeData()),U[e]=U[e]||function(t){var e,n,r,o=t.match(F);for(e=0,n=o.length;e<n;e++)W[o[e]]?o[e]=W[o[e]]:o[e]=(r=o[e]).match(/\[[\s\S]/)?r.replace(/^\[|\]$/g,""):r.replace(/\\/g,"");return function(e){var r,i="";for(r=0;r<n;r++)i+=M(o[r])?o[r].call(e,t):o[r];return i}}(e),U[e](t)):t.localeData().invalidDate()}function z(t,e){var n=5;function r(t){return e.longDateFormat(t)||t}for(B.lastIndex=0;n>=0&&B.test(t);)t=t.replace(B,r),B.lastIndex=0,n-=1;return t}var G=/\d/,X=/\d\d/,q=/\d{3}/,K=/\d{4}/,$=/[+-]?\d{6}/,Q=/\d\d?/,Z=/\d\d\d\d?/,J=/\d\d\d\d\d\d?/,tt=/\d{1,3}/,et=/\d{1,4}/,nt=/[+-]?\d{1,6}/,rt=/\d+/,ot=/[+-]?\d+/,it=/Z|[+-]\d\d:?\d\d/gi,at=/Z|[+-]\d\d(?::?\d\d)?/gi,st=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,lt={};function ut(t,e,n){lt[t]=M(e)?e:function(t,r){return t&&n?n:e}}function ct(t,e){return c(lt,t)?lt[t](e._strict,e._locale):new RegExp(ft(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(t,e,n,r,o){return e||n||r||o}))))}function ft(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var ht={};function dt(t,e){var n,r=e;for("string"==typeof t&&(t=[t]),s(e)&&(r=function(t,n){n[e]=C(t)}),n=0;n<t.length;n++)ht[t[n]]=r}function pt(t,e){dt(t,(function(t,n,r,o){r._w=r._w||{},e(t,r._w,r,o)}))}function gt(t,e,n){null!=e&&c(ht,t)&&ht[t](e,n._a,n,t)}function vt(t){return yt(t)?366:365}function yt(t){return t%4==0&&t%100!=0||t%400==0}V("Y",0,0,(function(){var t=this.year();return t<=9999?""+t:"+"+t})),V(0,["YY",2],0,(function(){return this.year()%100})),V(0,["YYYY",4],0,"year"),V(0,["YYYYY",5],0,"year"),V(0,["YYYYYY",6,!0],0,"year"),x("year","y"),L("year",1),ut("Y",ot),ut("YY",Q,X),ut("YYYY",et,K),ut("YYYYY",nt,$),ut("YYYYYY",nt,$),dt(["YYYYY","YYYYYY"],0),dt("YYYY",(function(t,e){e[0]=2===t.length?r.parseTwoDigitYear(t):C(t)})),dt("YY",(function(t,e){e[0]=r.parseTwoDigitYear(t)})),dt("Y",(function(t,e){e[0]=parseInt(t,10)})),r.parseTwoDigitYear=function(t){return C(t)+(C(t)>68?1900:2e3)};var mt,bt=wt("FullYear",!0);function wt(t,e){return function(n){return null!=n?(Ct(this,t,n),r.updateOffset(this,e),this):Ot(this,t)}}function Ot(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function Ct(t,e,n){t.isValid()&&!isNaN(n)&&("FullYear"===e&&yt(t.year())&&1===t.month()&&29===t.date()?t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),Et(n,t.month())):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function Et(t,e){if(isNaN(t)||isNaN(e))return NaN;var n,r=(e%(n=12)+n)%n;return t+=(e-r)/12,1===r?yt(t)?29:28:31-r%7%2}mt=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},V("M",["MM",2],"Mo",(function(){return this.month()+1})),V("MMM",0,0,(function(t){return this.localeData().monthsShort(this,t)})),V("MMMM",0,0,(function(t){return this.localeData().months(this,t)})),x("month","M"),L("month",8),ut("M",Q),ut("MM",Q,X),ut("MMM",(function(t,e){return e.monthsShortRegex(t)})),ut("MMMM",(function(t,e){return e.monthsRegex(t)})),dt(["M","MM"],(function(t,e){e[1]=C(t)-1})),dt(["MMM","MMMM"],(function(t,e,n,r){var o=n._locale.monthsParse(t,r,n._strict);null!=o?e[1]=o:d(n).invalidMonth=t}));var St=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,kt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Rt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function _t(t,e,n){var r,o,i,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)i=h([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(i,"").toLocaleLowerCase();return n?"MMM"===e?-1!==(o=mt.call(this._shortMonthsParse,a))?o:null:-1!==(o=mt.call(this._longMonthsParse,a))?o:null:"MMM"===e?-1!==(o=mt.call(this._shortMonthsParse,a))?o:-1!==(o=mt.call(this._longMonthsParse,a))?o:null:-1!==(o=mt.call(this._longMonthsParse,a))?o:-1!==(o=mt.call(this._shortMonthsParse,a))?o:null}function Tt(t,e){var n;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=C(e);else if(!s(e=t.localeData().monthsParse(e)))return t;return n=Math.min(t.date(),Et(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function Mt(t){return null!=t?(Tt(this,t),r.updateOffset(this,!0),this):Ot(this,"Month")}var At=st,Nt=st;function jt(){function t(t,e){return e.length-t.length}var e,n,r=[],o=[],i=[];for(e=0;e<12;e++)n=h([2e3,e]),r.push(this.monthsShort(n,"")),o.push(this.months(n,"")),i.push(this.months(n,"")),i.push(this.monthsShort(n,""));for(r.sort(t),o.sort(t),i.sort(t),e=0;e<12;e++)r[e]=ft(r[e]),o[e]=ft(o[e]);for(e=0;e<24;e++)i[e]=ft(i[e]);this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function xt(t,e,n,r,o,i,a){var s;return t<100&&t>=0?(s=new Date(t+400,e,n,r,o,i,a),isFinite(s.getFullYear())&&s.setFullYear(t)):s=new Date(t,e,n,r,o,i,a),s}function It(t){var e;if(t<100&&t>=0){var n=Array.prototype.slice.call(arguments);n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)}else e=new Date(Date.UTC.apply(null,arguments));return e}function Dt(t,e,n){var r=7+e-n;return-(7+It(t,0,r).getUTCDay()-e)%7+r-1}function Pt(t,e,n,r,o){var i,a,s=1+7*(e-1)+(7+n-r)%7+Dt(t,r,o);return s<=0?a=vt(i=t-1)+s:s>vt(t)?(i=t+1,a=s-vt(t)):(i=t,a=s),{year:i,dayOfYear:a}}function Lt(t,e,n){var r,o,i=Dt(t.year(),e,n),a=Math.floor((t.dayOfYear()-i-1)/7)+1;return a<1?r=a+Ht(o=t.year()-1,e,n):a>Ht(t.year(),e,n)?(r=a-Ht(t.year(),e,n),o=t.year()+1):(o=t.year(),r=a),{week:r,year:o}}function Ht(t,e,n){var r=Dt(t,e,n),o=Dt(t+1,e,n);return(vt(t)-r+o)/7}function Ft(t,e){return t.slice(e,7).concat(t.slice(0,e))}V("w",["ww",2],"wo","week"),V("W",["WW",2],"Wo","isoWeek"),x("week","w"),x("isoWeek","W"),L("week",5),L("isoWeek",5),ut("w",Q),ut("ww",Q,X),ut("W",Q),ut("WW",Q,X),pt(["w","ww","W","WW"],(function(t,e,n,r){e[r.substr(0,1)]=C(t)})),V("d",0,"do","day"),V("dd",0,0,(function(t){return this.localeData().weekdaysMin(this,t)})),V("ddd",0,0,(function(t){return this.localeData().weekdaysShort(this,t)})),V("dddd",0,0,(function(t){return this.localeData().weekdays(this,t)})),V("e",0,0,"weekday"),V("E",0,0,"isoWeekday"),x("day","d"),x("weekday","e"),x("isoWeekday","E"),L("day",11),L("weekday",11),L("isoWeekday",11),ut("d",Q),ut("e",Q),ut("E",Q),ut("dd",(function(t,e){return e.weekdaysMinRegex(t)})),ut("ddd",(function(t,e){return e.weekdaysShortRegex(t)})),ut("dddd",(function(t,e){return e.weekdaysRegex(t)})),pt(["dd","ddd","dddd"],(function(t,e,n,r){var o=n._locale.weekdaysParse(t,r,n._strict);null!=o?e.d=o:d(n).invalidWeekday=t})),pt(["d","e","E"],(function(t,e,n,r){e[r]=C(t)}));var Bt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ut="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Wt="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Vt(t,e,n){var r,o,i,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)i=h([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(i,"").toLocaleLowerCase();return n?"dddd"===e?-1!==(o=mt.call(this._weekdaysParse,a))?o:null:"ddd"===e?-1!==(o=mt.call(this._shortWeekdaysParse,a))?o:null:-1!==(o=mt.call(this._minWeekdaysParse,a))?o:null:"dddd"===e?-1!==(o=mt.call(this._weekdaysParse,a))?o:-1!==(o=mt.call(this._shortWeekdaysParse,a))?o:-1!==(o=mt.call(this._minWeekdaysParse,a))?o:null:"ddd"===e?-1!==(o=mt.call(this._shortWeekdaysParse,a))?o:-1!==(o=mt.call(this._weekdaysParse,a))?o:-1!==(o=mt.call(this._minWeekdaysParse,a))?o:null:-1!==(o=mt.call(this._minWeekdaysParse,a))?o:-1!==(o=mt.call(this._weekdaysParse,a))?o:-1!==(o=mt.call(this._shortWeekdaysParse,a))?o:null}var Yt=st,zt=st,Gt=st;function Xt(){function t(t,e){return e.length-t.length}var e,n,r,o,i,a=[],s=[],l=[],u=[];for(e=0;e<7;e++)n=h([2e3,1]).day(e),r=this.weekdaysMin(n,""),o=this.weekdaysShort(n,""),i=this.weekdays(n,""),a.push(r),s.push(o),l.push(i),u.push(r),u.push(o),u.push(i);for(a.sort(t),s.sort(t),l.sort(t),u.sort(t),e=0;e<7;e++)s[e]=ft(s[e]),l[e]=ft(l[e]),u[e]=ft(u[e]);this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function qt(){return this.hours()%12||12}function Kt(t,e){V(t,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)}))}function $t(t,e){return e._meridiemParse}V("H",["HH",2],0,"hour"),V("h",["hh",2],0,qt),V("k",["kk",2],0,(function(){return this.hours()||24})),V("hmm",0,0,(function(){return""+qt.apply(this)+H(this.minutes(),2)})),V("hmmss",0,0,(function(){return""+qt.apply(this)+H(this.minutes(),2)+H(this.seconds(),2)})),V("Hmm",0,0,(function(){return""+this.hours()+H(this.minutes(),2)})),V("Hmmss",0,0,(function(){return""+this.hours()+H(this.minutes(),2)+H(this.seconds(),2)})),Kt("a",!0),Kt("A",!1),x("hour","h"),L("hour",13),ut("a",$t),ut("A",$t),ut("H",Q),ut("h",Q),ut("k",Q),ut("HH",Q,X),ut("hh",Q,X),ut("kk",Q,X),ut("hmm",Z),ut("hmmss",J),ut("Hmm",Z),ut("Hmmss",J),dt(["H","HH"],3),dt(["k","kk"],(function(t,e,n){var r=C(t);e[3]=24===r?0:r})),dt(["a","A"],(function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t})),dt(["h","hh"],(function(t,e,n){e[3]=C(t),d(n).bigHour=!0})),dt("hmm",(function(t,e,n){var r=t.length-2;e[3]=C(t.substr(0,r)),e[4]=C(t.substr(r)),d(n).bigHour=!0})),dt("hmmss",(function(t,e,n){var r=t.length-4,o=t.length-2;e[3]=C(t.substr(0,r)),e[4]=C(t.substr(r,2)),e[5]=C(t.substr(o)),d(n).bigHour=!0})),dt("Hmm",(function(t,e,n){var r=t.length-2;e[3]=C(t.substr(0,r)),e[4]=C(t.substr(r))})),dt("Hmmss",(function(t,e,n){var r=t.length-4,o=t.length-2;e[3]=C(t.substr(0,r)),e[4]=C(t.substr(r,2)),e[5]=C(t.substr(o))}));var Qt,Zt=wt("Hours",!0),Jt={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:kt,monthsShort:Rt,week:{dow:0,doy:6},weekdays:Bt,weekdaysMin:Wt,weekdaysShort:Ut,meridiemParse:/[ap]\.?m?\.?/i},te={},ee={};function ne(t){return t?t.toLowerCase().replace("_","-"):t}function re(e){var n=null;if(!te[e]&&void 0!==t&&t&&t.exports)try{n=Qt._abbr,!function(){var t=new Error("Cannot find module 'undefined'");throw t.code="MODULE_NOT_FOUND",t}(),oe(n)}catch(t){}return te[e]}function oe(t,e){var n;return t&&((n=a(e)?ae(t):ie(t,e))?Qt=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Qt._abbr}function ie(t,e){if(null!==e){var n,r=Jt;if(e.abbr=t,null!=te[t])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=te[t]._config;else if(null!=e.parentLocale)if(null!=te[e.parentLocale])r=te[e.parentLocale]._config;else{if(null==(n=re(e.parentLocale)))return ee[e.parentLocale]||(ee[e.parentLocale]=[]),ee[e.parentLocale].push({name:t,config:e}),null;r=n._config}return te[t]=new N(A(r,e)),ee[t]&&ee[t].forEach((function(t){ie(t.name,t.config)})),oe(t),te[t]}return delete te[t],null}function ae(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Qt;if(!o(t)){if(e=re(t))return e;t=[t]}return function(t){for(var e,n,r,o,i=0;i<t.length;){for(e=(o=ne(t[i]).split("-")).length,n=(n=ne(t[i+1]))?n.split("-"):null;e>0;){if(r=re(o.slice(0,e).join("-")))return r;if(n&&n.length>=e&&E(o,n,!0)>=e-1)break;e--}i++}return Qt}(t)}function se(t){var e,n=t._a;return n&&-2===d(t).overflow&&(e=n[1]<0||n[1]>11?1:n[2]<1||n[2]>Et(n[0],n[1])?2:n[3]<0||n[3]>24||24===n[3]&&(0!==n[4]||0!==n[5]||0!==n[6])?3:n[4]<0||n[4]>59?4:n[5]<0||n[5]>59?5:n[6]<0||n[6]>999?6:-1,d(t)._overflowDayOfYear&&(e<0||e>2)&&(e=2),d(t)._overflowWeeks&&-1===e&&(e=7),d(t)._overflowWeekday&&-1===e&&(e=8),d(t).overflow=e),t}function le(t,e,n){return null!=t?t:null!=e?e:n}function ue(t){var e,n,o,i,a,s=[];if(!t._d){for(o=function(t){var e=new Date(r.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}(t),t._w&&null==t._a[2]&&null==t._a[1]&&function(t){var e,n,r,o,i,a,s,l;if(null!=(e=t._w).GG||null!=e.W||null!=e.E)i=1,a=4,n=le(e.GG,t._a[0],Lt(Se(),1,4).year),r=le(e.W,1),((o=le(e.E,1))<1||o>7)&&(l=!0);else{i=t._locale._week.dow,a=t._locale._week.doy;var u=Lt(Se(),i,a);n=le(e.gg,t._a[0],u.year),r=le(e.w,u.week),null!=e.d?((o=e.d)<0||o>6)&&(l=!0):null!=e.e?(o=e.e+i,(e.e<0||e.e>6)&&(l=!0)):o=i}r<1||r>Ht(n,i,a)?d(t)._overflowWeeks=!0:null!=l?d(t)._overflowWeekday=!0:(s=Pt(n,r,o,i,a),t._a[0]=s.year,t._dayOfYear=s.dayOfYear)}(t),null!=t._dayOfYear&&(a=le(t._a[0],o[0]),(t._dayOfYear>vt(a)||0===t._dayOfYear)&&(d(t)._overflowDayOfYear=!0),n=It(a,0,t._dayOfYear),t._a[1]=n.getUTCMonth(),t._a[2]=n.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=s[e]=o[e];for(;e<7;e++)t._a[e]=s[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[3]&&0===t._a[4]&&0===t._a[5]&&0===t._a[6]&&(t._nextDay=!0,t._a[3]=0),t._d=(t._useUTC?It:xt).apply(null,s),i=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[3]=24),t._w&&void 0!==t._w.d&&t._w.d!==i&&(d(t).weekdayMismatch=!0)}}var ce=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,fe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,he=/Z|[+-]\d\d(?::?\d\d)?/,de=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],pe=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ge=/^\/?Date\((\-?\d+)/i;function ve(t){var e,n,r,o,i,a,s=t._i,l=ce.exec(s)||fe.exec(s);if(l){for(d(t).iso=!0,e=0,n=de.length;e<n;e++)if(de[e][1].exec(l[1])){o=de[e][0],r=!1!==de[e][2];break}if(null==o)return void(t._isValid=!1);if(l[3]){for(e=0,n=pe.length;e<n;e++)if(pe[e][1].exec(l[3])){i=(l[2]||" ")+pe[e][0];break}if(null==i)return void(t._isValid=!1)}if(!r&&null!=i)return void(t._isValid=!1);if(l[4]){if(!he.exec(l[4]))return void(t._isValid=!1);a="Z"}t._f=o+(i||"")+(a||""),Oe(t)}else t._isValid=!1}var ye=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function me(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}var be={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function we(t){var e,n,r,o,i,a,s,l=ye.exec(t._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(l){var u=(e=l[4],n=l[3],r=l[2],o=l[5],i=l[6],a=l[7],s=[me(e),Rt.indexOf(n),parseInt(r,10),parseInt(o,10),parseInt(i,10)],a&&s.push(parseInt(a,10)),s);if(!function(t,e,n){return!t||Ut.indexOf(t)===new Date(e[0],e[1],e[2]).getDay()||(d(n).weekdayMismatch=!0,n._isValid=!1,!1)}(l[1],u,t))return;t._a=u,t._tzm=function(t,e,n){if(t)return be[t];if(e)return 0;var r=parseInt(n,10),o=r%100;return(r-o)/100*60+o}(l[8],l[9],l[10]),t._d=It.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),d(t).rfc2822=!0}else t._isValid=!1}function Oe(t){if(t._f!==r.ISO_8601)if(t._f!==r.RFC_2822){t._a=[],d(t).empty=!0;var e,n,o,i,a,s=""+t._i,l=s.length,u=0;for(o=z(t._f,t._locale).match(F)||[],e=0;e<o.length;e++)i=o[e],(n=(s.match(ct(i,t))||[])[0])&&((a=s.substr(0,s.indexOf(n))).length>0&&d(t).unusedInput.push(a),s=s.slice(s.indexOf(n)+n.length),u+=n.length),W[i]?(n?d(t).empty=!1:d(t).unusedTokens.push(i),gt(i,n,t)):t._strict&&!n&&d(t).unusedTokens.push(i);d(t).charsLeftOver=l-u,s.length>0&&d(t).unusedInput.push(s),t._a[3]<=12&&!0===d(t).bigHour&&t._a[3]>0&&(d(t).bigHour=void 0),d(t).parsedDateParts=t._a.slice(0),d(t).meridiem=t._meridiem,t._a[3]=function(t,e,n){var r;return null==n?e:null!=t.meridiemHour?t.meridiemHour(e,n):null!=t.isPM?((r=t.isPM(n))&&e<12&&(e+=12),r||12!==e||(e=0),e):e}(t._locale,t._a[3],t._meridiem),ue(t),se(t)}else we(t);else ve(t)}function Ce(t){var e=t._i,n=t._f;return t._locale=t._locale||ae(t._l),null===e||void 0===n&&""===e?g({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),w(e)?new b(se(e)):(l(e)?t._d=e:o(n)?function(t){var e,n,r,o,i;if(0===t._f.length)return d(t).invalidFormat=!0,void(t._d=new Date(NaN));for(o=0;o<t._f.length;o++)i=0,e=y({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[o],Oe(e),p(e)&&(i+=d(e).charsLeftOver,i+=10*d(e).unusedTokens.length,d(e).score=i,(null==r||i<r)&&(r=i,n=e));f(t,n||e)}(t):n?Oe(t):function(t){var e=t._i;a(e)?t._d=new Date(r.now()):l(e)?t._d=new Date(e.valueOf()):"string"==typeof e?function(t){var e=ge.exec(t._i);null===e?(ve(t),!1===t._isValid&&(delete t._isValid,we(t),!1===t._isValid&&(delete t._isValid,r.createFromInputFallback(t)))):t._d=new Date(+e[1])}(t):o(e)?(t._a=u(e.slice(0),(function(t){return parseInt(t,10)})),ue(t)):i(e)?function(t){if(!t._d){var e=D(t._i);t._a=u([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],(function(t){return t&&parseInt(t,10)})),ue(t)}}(t):s(e)?t._d=new Date(e):r.createFromInputFallback(t)}(t),p(t)||(t._d=null),t))}function Ee(t,e,n,r,a){var s,l={};return!0!==n&&!1!==n||(r=n,n=void 0),(i(t)&&function(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(t.hasOwnProperty(e))return!1;return!0}(t)||o(t)&&0===t.length)&&(t=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=a,l._l=n,l._i=t,l._f=e,l._strict=r,(s=new b(se(Ce(l))))._nextDay&&(s.add(1,"d"),s._nextDay=void 0),s}function Se(t,e,n,r){return Ee(t,e,n,r,!1)}r.createFromInputFallback=k("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))})),r.ISO_8601=function(){},r.RFC_2822=function(){};var ke=k("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=Se.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:g()})),Re=k("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=Se.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:g()}));function _e(t,e){var n,r;if(1===e.length&&o(e[0])&&(e=e[0]),!e.length)return Se();for(n=e[0],r=1;r<e.length;++r)e[r].isValid()&&!e[r][t](n)||(n=e[r]);return n}var Te=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Me(t){var e=D(t),n=e.year||0,r=e.quarter||0,o=e.month||0,i=e.week||e.isoWeek||0,a=e.day||0,s=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=function(t){for(var e in t)if(-1===mt.call(Te,e)||null!=t[e]&&isNaN(t[e]))return!1;for(var n=!1,r=0;r<Te.length;++r)if(t[Te[r]]){if(n)return!1;parseFloat(t[Te[r]])!==C(t[Te[r]])&&(n=!0)}return!0}(e),this._milliseconds=+c+1e3*u+6e4*l+1e3*s*60*60,this._days=+a+7*i,this._months=+o+3*r+12*n,this._data={},this._locale=ae(),this._bubble()}function Ae(t){return t instanceof Me}function Ne(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function je(t,e){V(t,0,0,(function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+H(~~(t/60),2)+e+H(~~t%60,2)}))}je("Z",":"),je("ZZ",""),ut("Z",at),ut("ZZ",at),dt(["Z","ZZ"],(function(t,e,n){n._useUTC=!0,n._tzm=Ie(at,t)}));var xe=/([\+\-]|\d\d)/gi;function Ie(t,e){var n=(e||"").match(t);if(null===n)return null;var r=((n[n.length-1]||[])+"").match(xe)||["-",0,0],o=60*r[1]+C(r[2]);return 0===o?0:"+"===r[0]?o:-o}function De(t,e){var n,o;return e._isUTC?(n=e.clone(),o=(w(t)||l(t)?t.valueOf():Se(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+o),r.updateOffset(n,!1),n):Se(t).local()}function Pe(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function Le(){return!!this.isValid()&&this._isUTC&&0===this._offset}r.updateOffset=function(){};var He=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Fe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Be(t,e){var n,r,o,i,a,l,u=t,f=null;return Ae(t)?u={ms:t._milliseconds,d:t._days,M:t._months}:s(t)?(u={},e?u[e]=t:u.milliseconds=t):(f=He.exec(t))?(n="-"===f[1]?-1:1,u={y:0,d:C(f[2])*n,h:C(f[3])*n,m:C(f[4])*n,s:C(f[5])*n,ms:C(Ne(1e3*f[6]))*n}):(f=Fe.exec(t))?(n="-"===f[1]?-1:1,u={y:Ue(f[2],n),M:Ue(f[3],n),w:Ue(f[4],n),d:Ue(f[5],n),h:Ue(f[6],n),m:Ue(f[7],n),s:Ue(f[8],n)}):null==u?u={}:"object"==typeof u&&("from"in u||"to"in u)&&(i=Se(u.from),a=Se(u.to),o=i.isValid()&&a.isValid()?(a=De(a,i),i.isBefore(a)?l=We(i,a):((l=We(a,i)).milliseconds=-l.milliseconds,l.months=-l.months),l):{milliseconds:0,months:0},(u={}).ms=o.milliseconds,u.M=o.months),r=new Me(u),Ae(t)&&c(t,"_locale")&&(r._locale=t._locale),r}function Ue(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function We(t,e){var n={};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Ve(t,e){return function(n,r){var o;return null===r||isNaN(+r)||(T(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),Ye(this,Be(n="string"==typeof n?+n:n,r),t),this}}function Ye(t,e,n,o){var i=e._milliseconds,a=Ne(e._days),s=Ne(e._months);t.isValid()&&(o=null==o||o,s&&Tt(t,Ot(t,"Month")+s*n),a&&Ct(t,"Date",Ot(t,"Date")+a*n),i&&t._d.setTime(t._d.valueOf()+i*n),o&&r.updateOffset(t,a||s))}Be.fn=Me.prototype,Be.invalid=function(){return Be(NaN)};var ze=Ve(1,"add"),Ge=Ve(-1,"subtract");function Xe(t,e){var n=12*(e.year()-t.year())+(e.month()-t.month()),r=t.clone().add(n,"months");return-(n+(e-r<0?(e-r)/(r-t.clone().add(n-1,"months")):(e-r)/(t.clone().add(n+1,"months")-r)))||0}function qe(t){var e;return void 0===t?this._locale._abbr:(null!=(e=ae(t))&&(this._locale=e),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Ke=k("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(t){return void 0===t?this.localeData():this.locale(t)}));function $e(){return this._locale}function Qe(t,e){return(t%e+e)%e}function Ze(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-126227808e5:new Date(t,e,n).valueOf()}function Je(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-126227808e5:Date.UTC(t,e,n)}function tn(t,e){V(0,[t,t.length],0,e)}function en(t,e,n,r,o){var i;return null==t?Lt(this,r,o).year:(e>(i=Ht(t,r,o))&&(e=i),nn.call(this,t,e,n,r,o))}function nn(t,e,n,r,o){var i=Pt(t,e,n,r,o),a=It(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}V(0,["gg",2],0,(function(){return this.weekYear()%100})),V(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),tn("gggg","weekYear"),tn("ggggg","weekYear"),tn("GGGG","isoWeekYear"),tn("GGGGG","isoWeekYear"),x("weekYear","gg"),x("isoWeekYear","GG"),L("weekYear",1),L("isoWeekYear",1),ut("G",ot),ut("g",ot),ut("GG",Q,X),ut("gg",Q,X),ut("GGGG",et,K),ut("gggg",et,K),ut("GGGGG",nt,$),ut("ggggg",nt,$),pt(["gggg","ggggg","GGGG","GGGGG"],(function(t,e,n,r){e[r.substr(0,2)]=C(t)})),pt(["gg","GG"],(function(t,e,n,o){e[o]=r.parseTwoDigitYear(t)})),V("Q",0,"Qo","quarter"),x("quarter","Q"),L("quarter",7),ut("Q",G),dt("Q",(function(t,e){e[1]=3*(C(t)-1)})),V("D",["DD",2],"Do","date"),x("date","D"),L("date",9),ut("D",Q),ut("DD",Q,X),ut("Do",(function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient})),dt(["D","DD"],2),dt("Do",(function(t,e){e[2]=C(t.match(Q)[0])}));var rn=wt("Date",!0);V("DDD",["DDDD",3],"DDDo","dayOfYear"),x("dayOfYear","DDD"),L("dayOfYear",4),ut("DDD",tt),ut("DDDD",q),dt(["DDD","DDDD"],(function(t,e,n){n._dayOfYear=C(t)})),V("m",["mm",2],0,"minute"),x("minute","m"),L("minute",14),ut("m",Q),ut("mm",Q,X),dt(["m","mm"],4);var on=wt("Minutes",!1);V("s",["ss",2],0,"second"),x("second","s"),L("second",15),ut("s",Q),ut("ss",Q,X),dt(["s","ss"],5);var an,sn=wt("Seconds",!1);for(V("S",0,0,(function(){return~~(this.millisecond()/100)})),V(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),V(0,["SSS",3],0,"millisecond"),V(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),V(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),V(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),V(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),V(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),V(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),x("millisecond","ms"),L("millisecond",16),ut("S",tt,G),ut("SS",tt,X),ut("SSS",tt,q),an="SSSS";an.length<=9;an+="S")ut(an,rt);function ln(t,e){e[6]=C(1e3*("0."+t))}for(an="S";an.length<=9;an+="S")dt(an,ln);var un=wt("Milliseconds",!1);V("z",0,0,"zoneAbbr"),V("zz",0,0,"zoneName");var cn=b.prototype;function fn(t){return t}cn.add=ze,cn.calendar=function(t,e){var n=t||Se(),o=De(n,this).startOf("day"),i=r.calendarFormat(this,o)||"sameElse",a=e&&(M(e[i])?e[i].call(this,n):e[i]);return this.format(a||this.localeData().calendar(i,this,Se(n)))},cn.clone=function(){return new b(this)},cn.diff=function(t,e,n){var r,o,i;if(!this.isValid())return NaN;if(!(r=De(t,this)).isValid())return NaN;switch(o=6e4*(r.utcOffset()-this.utcOffset()),e=I(e)){case"year":i=Xe(this,r)/12;break;case"month":i=Xe(this,r);break;case"quarter":i=Xe(this,r)/3;break;case"second":i=(this-r)/1e3;break;case"minute":i=(this-r)/6e4;break;case"hour":i=(this-r)/36e5;break;case"day":i=(this-r-o)/864e5;break;case"week":i=(this-r-o)/6048e5;break;default:i=this-r}return n?i:O(i)},cn.endOf=function(t){var e;if(void 0===(t=I(t))||"millisecond"===t||!this.isValid())return this;var n=this._isUTC?Je:Ze;switch(t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=36e5-Qe(e+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":e=this._d.valueOf(),e+=6e4-Qe(e,6e4)-1;break;case"second":e=this._d.valueOf(),e+=1e3-Qe(e,1e3)-1}return this._d.setTime(e),r.updateOffset(this,!0),this},cn.format=function(t){t||(t=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var e=Y(this,t);return this.localeData().postformat(e)},cn.from=function(t,e){return this.isValid()&&(w(t)&&t.isValid()||Se(t).isValid())?Be({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},cn.fromNow=function(t){return this.from(Se(),t)},cn.to=function(t,e){return this.isValid()&&(w(t)&&t.isValid()||Se(t).isValid())?Be({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},cn.toNow=function(t){return this.to(Se(),t)},cn.get=function(t){return M(this[t=I(t)])?this[t]():this},cn.invalidAt=function(){return d(this).overflow},cn.isAfter=function(t,e){var n=w(t)?t:Se(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=I(e)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf())},cn.isBefore=function(t,e){var n=w(t)?t:Se(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=I(e)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf())},cn.isBetween=function(t,e,n,r){var o=w(t)?t:Se(t),i=w(e)?e:Se(e);return!!(this.isValid()&&o.isValid()&&i.isValid())&&("("===(r=r||"()")[0]?this.isAfter(o,n):!this.isBefore(o,n))&&(")"===r[1]?this.isBefore(i,n):!this.isAfter(i,n))},cn.isSame=function(t,e){var n,r=w(t)?t:Se(t);return!(!this.isValid()||!r.isValid())&&("millisecond"===(e=I(e)||"millisecond")?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf()))},cn.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},cn.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},cn.isValid=function(){return p(this)},cn.lang=Ke,cn.locale=qe,cn.localeData=$e,cn.max=Re,cn.min=ke,cn.parsingFlags=function(){return f({},d(this))},cn.set=function(t,e){if("object"==typeof t)for(var n=function(t){var e=[];for(var n in t)e.push({unit:n,priority:P[n]});return e.sort((function(t,e){return t.priority-e.priority})),e}(t=D(t)),r=0;r<n.length;r++)this[n[r].unit](t[n[r].unit]);else if(M(this[t=I(t)]))return this[t](e);return this},cn.startOf=function(t){var e;if(void 0===(t=I(t))||"millisecond"===t||!this.isValid())return this;var n=this._isUTC?Je:Ze;switch(t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Qe(e+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":e=this._d.valueOf(),e-=Qe(e,6e4);break;case"second":e=this._d.valueOf(),e-=Qe(e,1e3)}return this._d.setTime(e),r.updateOffset(this,!0),this},cn.subtract=Ge,cn.toArray=function(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]},cn.toObject=function(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}},cn.toDate=function(){return new Date(this.valueOf())},cn.toISOString=function(t){if(!this.isValid())return null;var e=!0!==t,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Y(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):M(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",Y(n,"Z")):Y(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},cn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o=e+'[")]';return this.format(n+r+"-MM-DD[T]HH:mm:ss.SSS"+o)},cn.toJSON=function(){return this.isValid()?this.toISOString():null},cn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},cn.unix=function(){return Math.floor(this.valueOf()/1e3)},cn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},cn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},cn.year=bt,cn.isLeapYear=function(){return yt(this.year())},cn.weekYear=function(t){return en.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},cn.isoWeekYear=function(t){return en.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},cn.quarter=cn.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},cn.month=Mt,cn.daysInMonth=function(){return Et(this.year(),this.month())},cn.week=cn.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},cn.isoWeek=cn.isoWeeks=function(t){var e=Lt(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},cn.weeksInYear=function(){var t=this.localeData()._week;return Ht(this.year(),t.dow,t.doy)},cn.isoWeeksInYear=function(){return Ht(this.year(),1,4)},cn.date=rn,cn.day=cn.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=function(t,e){return"string"!=typeof t?t:isNaN(t)?"number"==typeof(t=e.weekdaysParse(t))?t:null:parseInt(t,10)}(t,this.localeData()),this.add(t-e,"d")):e},cn.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},cn.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=function(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7},cn.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},cn.hour=cn.hours=Zt,cn.minute=cn.minutes=on,cn.second=cn.seconds=sn,cn.millisecond=cn.milliseconds=un,cn.utcOffset=function(t,e,n){var o,i=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"==typeof t){if(null===(t=Ie(at,t)))return this}else Math.abs(t)<16&&!n&&(t*=60);return!this._isUTC&&e&&(o=Pe(this)),this._offset=t,this._isUTC=!0,null!=o&&this.add(o,"m"),i!==t&&(!e||this._changeInProgress?Ye(this,Be(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:Pe(this)},cn.utc=function(t){return this.utcOffset(0,t)},cn.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Pe(this),"m")),this},cn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=Ie(it,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},cn.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?Se(t).utcOffset():0,(this.utcOffset()-t)%60==0)},cn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},cn.isLocal=function(){return!!this.isValid()&&!this._isUTC},cn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},cn.isUtc=Le,cn.isUTC=Le,cn.zoneAbbr=function(){return this._isUTC?"UTC":""},cn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},cn.dates=k("dates accessor is deprecated. Use date instead.",rn),cn.months=k("months accessor is deprecated. Use month instead",Mt),cn.years=k("years accessor is deprecated. Use year instead",bt),cn.zone=k("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()})),cn.isDSTShifted=k("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!a(this._isDSTShifted))return this._isDSTShifted;var t={};if(y(t,this),(t=Ce(t))._a){var e=t._isUTC?h(t._a):Se(t._a);this._isDSTShifted=this.isValid()&&E(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}));var hn=N.prototype;function dn(t,e,n,r){var o=ae(),i=h().set(r,e);return o[n](i,t)}function pn(t,e,n){if(s(t)&&(e=t,t=void 0),t=t||"",null!=e)return dn(t,e,n,"month");var r,o=[];for(r=0;r<12;r++)o[r]=dn(t,r,n,"month");return o}function gn(t,e,n,r){"boolean"==typeof t?(s(e)&&(n=e,e=void 0),e=e||""):(n=e=t,t=!1,s(e)&&(n=e,e=void 0),e=e||"");var o,i=ae(),a=t?i._week.dow:0;if(null!=n)return dn(e,(n+a)%7,r,"day");var l=[];for(o=0;o<7;o++)l[o]=dn(e,(o+a)%7,r,"day");return l}hn.calendar=function(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return M(r)?r.call(e,n):r},hn.longDateFormat=function(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.replace(/MMMM|MM|DD|dddd/g,(function(t){return t.slice(1)})),this._longDateFormat[t])},hn.invalidDate=function(){return this._invalidDate},hn.ordinal=function(t){return this._ordinal.replace("%d",t)},hn.preparse=fn,hn.postformat=fn,hn.relativeTime=function(t,e,n,r){var o=this._relativeTime[n];return M(o)?o(t,e,n,r):o.replace(/%d/i,t)},hn.pastFuture=function(t,e){var n=this._relativeTime[t>0?"future":"past"];return M(n)?n(e):n.replace(/%s/i,e)},hn.set=function(t){var e,n;for(n in t)M(e=t[n])?this[n]=e:this["_"+n]=e;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},hn.months=function(t,e){return t?o(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||St).test(e)?"format":"standalone"][t.month()]:o(this._months)?this._months:this._months.standalone},hn.monthsShort=function(t,e){return t?o(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[St.test(e)?"format":"standalone"][t.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},hn.monthsParse=function(t,e,n){var r,o,i;if(this._monthsParseExact)return _t.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(o=h([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[r].test(t))return r;if(n&&"MMM"===e&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}},hn.monthsRegex=function(t){return this._monthsParseExact?(c(this,"_monthsRegex")||jt.call(this),t?this._monthsStrictRegex:this._monthsRegex):(c(this,"_monthsRegex")||(this._monthsRegex=Nt),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},hn.monthsShortRegex=function(t){return this._monthsParseExact?(c(this,"_monthsRegex")||jt.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(c(this,"_monthsShortRegex")||(this._monthsShortRegex=At),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},hn.week=function(t){return Lt(t,this._week.dow,this._week.doy).week},hn.firstDayOfYear=function(){return this._week.doy},hn.firstDayOfWeek=function(){return this._week.dow},hn.weekdays=function(t,e){var n=o(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?Ft(n,this._week.dow):t?n[t.day()]:n},hn.weekdaysMin=function(t){return!0===t?Ft(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin},hn.weekdaysShort=function(t){return!0===t?Ft(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort},hn.weekdaysParse=function(t,e,n){var r,o,i;if(this._weekdaysParseExact)return Vt.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(o=h([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),n&&"dddd"===e&&this._fullWeekdaysParse[r].test(t))return r;if(n&&"ddd"===e&&this._shortWeekdaysParse[r].test(t))return r;if(n&&"dd"===e&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}},hn.weekdaysRegex=function(t){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||Xt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(c(this,"_weekdaysRegex")||(this._weekdaysRegex=Yt),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},hn.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||Xt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(c(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=zt),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},hn.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||Xt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(c(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Gt),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},hn.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},hn.meridiem=function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},oe("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===C(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),r.lang=k("moment.lang is deprecated. Use moment.locale instead.",oe),r.langData=k("moment.langData is deprecated. Use moment.localeData instead.",ae);var vn=Math.abs;function yn(t,e,n,r){var o=Be(e,n);return t._milliseconds+=r*o._milliseconds,t._days+=r*o._days,t._months+=r*o._months,t._bubble()}function mn(t){return t<0?Math.floor(t):Math.ceil(t)}function bn(t){return 4800*t/146097}function wn(t){return 146097*t/4800}function On(t){return function(){return this.as(t)}}var Cn=On("ms"),En=On("s"),Sn=On("m"),kn=On("h"),Rn=On("d"),_n=On("w"),Tn=On("M"),Mn=On("Q"),An=On("y");function Nn(t){return function(){return this.isValid()?this._data[t]:NaN}}var jn=Nn("milliseconds"),xn=Nn("seconds"),In=Nn("minutes"),Dn=Nn("hours"),Pn=Nn("days"),Ln=Nn("months"),Hn=Nn("years"),Fn=Math.round,Bn={ss:44,s:45,m:45,h:22,d:26,M:11};function Un(t,e,n,r,o){return o.relativeTime(e||1,!!n,t,r)}var Wn=Math.abs;function Vn(t){return(t>0)-(t<0)||+t}function Yn(){if(!this.isValid())return this.localeData().invalidDate();var t,e,n=Wn(this._milliseconds)/1e3,r=Wn(this._days),o=Wn(this._months);t=O(n/60),e=O(t/60),n%=60,t%=60;var i=O(o/12),a=o%=12,s=r,l=e,u=t,c=n?n.toFixed(3).replace(/\.?0+$/,""):"",f=this.asSeconds();if(!f)return"P0D";var h=f<0?"-":"",d=Vn(this._months)!==Vn(f)?"-":"",p=Vn(this._days)!==Vn(f)?"-":"",g=Vn(this._milliseconds)!==Vn(f)?"-":"";return h+"P"+(i?d+i+"Y":"")+(a?d+a+"M":"")+(s?p+s+"D":"")+(l||u||c?"T":"")+(l?g+l+"H":"")+(u?g+u+"M":"")+(c?g+c+"S":"")}var zn=Me.prototype;return zn.isValid=function(){return this._isValid},zn.abs=function(){var t=this._data;return this._milliseconds=vn(this._milliseconds),this._days=vn(this._days),this._months=vn(this._months),t.milliseconds=vn(t.milliseconds),t.seconds=vn(t.seconds),t.minutes=vn(t.minutes),t.hours=vn(t.hours),t.months=vn(t.months),t.years=vn(t.years),this},zn.add=function(t,e){return yn(this,t,e,1)},zn.subtract=function(t,e){return yn(this,t,e,-1)},zn.as=function(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if("month"===(t=I(t))||"quarter"===t||"year"===t)switch(e=this._days+r/864e5,n=this._months+bn(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(wn(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return 24*e+r/36e5;case"minute":return 1440*e+r/6e4;case"second":return 86400*e+r/1e3;case"millisecond":return Math.floor(864e5*e)+r;default:throw new Error("Unknown unit "+t)}},zn.asMilliseconds=Cn,zn.asSeconds=En,zn.asMinutes=Sn,zn.asHours=kn,zn.asDays=Rn,zn.asWeeks=_n,zn.asMonths=Tn,zn.asQuarters=Mn,zn.asYears=An,zn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*C(this._months/12):NaN},zn._bubble=function(){var t,e,n,r,o,i=this._milliseconds,a=this._days,s=this._months,l=this._data;return i>=0&&a>=0&&s>=0||i<=0&&a<=0&&s<=0||(i+=864e5*mn(wn(s)+a),a=0,s=0),l.milliseconds=i%1e3,t=O(i/1e3),l.seconds=t%60,e=O(t/60),l.minutes=e%60,n=O(e/60),l.hours=n%24,a+=O(n/24),o=O(bn(a)),s+=o,a-=mn(wn(o)),r=O(s/12),s%=12,l.days=a,l.months=s,l.years=r,this},zn.clone=function(){return Be(this)},zn.get=function(t){return t=I(t),this.isValid()?this[t+"s"]():NaN},zn.milliseconds=jn,zn.seconds=xn,zn.minutes=In,zn.hours=Dn,zn.days=Pn,zn.weeks=function(){return O(this.days()/7)},zn.months=Ln,zn.years=Hn,zn.humanize=function(t){if(!this.isValid())return this.localeData().invalidDate();var e=this.localeData(),n=function(t,e,n){var r=Be(t).abs(),o=Fn(r.as("s")),i=Fn(r.as("m")),a=Fn(r.as("h")),s=Fn(r.as("d")),l=Fn(r.as("M")),u=Fn(r.as("y")),c=o<=Bn.ss&&["s",o]||o<Bn.s&&["ss",o]||i<=1&&["m"]||i<Bn.m&&["mm",i]||a<=1&&["h"]||a<Bn.h&&["hh",a]||s<=1&&["d"]||s<Bn.d&&["dd",s]||l<=1&&["M"]||l<Bn.M&&["MM",l]||u<=1&&["y"]||["yy",u];return c[2]=e,c[3]=+t>0,c[4]=n,Un.apply(null,c)}(this,!t,e);return t&&(n=e.pastFuture(+this,n)),e.postformat(n)},zn.toISOString=Yn,zn.toString=Yn,zn.toJSON=Yn,zn.locale=qe,zn.localeData=$e,zn.toIsoString=k("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Yn),zn.lang=Ke,V("X",0,0,"unix"),V("x",0,0,"valueOf"),ut("x",ot),ut("X",/[+-]?\d+(\.\d{1,3})?/),dt("X",(function(t,e,n){n._d=new Date(1e3*parseFloat(t,10))})),dt("x",(function(t,e,n){n._d=new Date(C(t))})),r.version="2.24.0",e=Se,r.fn=cn,r.min=function(){var t=[].slice.call(arguments,0);return _e("isBefore",t)},r.max=function(){var t=[].slice.call(arguments,0);return _e("isAfter",t)},r.now=function(){return Date.now?Date.now():+new Date},r.utc=h,r.unix=function(t){return Se(1e3*t)},r.months=function(t,e){return pn(t,e,"months")},r.isDate=l,r.locale=oe,r.invalid=g,r.duration=Be,r.isMoment=w,r.weekdays=function(t,e,n){return gn(t,e,n,"weekdays")},r.parseZone=function(){return Se.apply(null,arguments).parseZone()},r.localeData=ae,r.isDuration=Ae,r.monthsShort=function(t,e){return pn(t,e,"monthsShort")},r.weekdaysMin=function(t,e,n){return gn(t,e,n,"weekdaysMin")},r.defineLocale=ie,r.updateLocale=function(t,e){if(null!=e){var n,r,o=Jt;null!=(r=re(t))&&(o=r._config),e=A(o,e),(n=new N(e)).parentLocale=te[t],te[t]=n,oe(t)}else null!=te[t]&&(null!=te[t].parentLocale?te[t]=te[t].parentLocale:null!=te[t]&&delete te[t]);return te[t]},r.locales=function(){return R(te)},r.weekdaysShort=function(t,e,n){return gn(t,e,n,"weekdaysShort")},r.normalizeUnits=I,r.relativeTimeRounding=function(t){return void 0===t?Fn:"function"==typeof t&&(Fn=t,!0)},r.relativeTimeThreshold=function(t,e){return void 0!==Bn[t]&&(void 0===e?Bn[t]:(Bn[t]=e,"s"===t&&(Bn.ss=e-1),!0))},r.calendarFormat=function(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},r.prototype=cn,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r}()}).call(this,n(238)(t))},function(t,e,n){"use strict";n.r(e),n.d(e,"isFunction",(function(){return o})),n.d(e,"throttle",(function(){return i})),n.d(e,"throttleAfterHits",(function(){return a})),n.d(e,"debounce",(function(){return s})),n.d(e,"pipe",(function(){return l})),n.d(e,"partial",(function(){return u})),n.d(e,"curry",(function(){return c})),n.d(e,"curryRight",(function(){return f}));n(27),n(148),n(38),n(47);var r=n(1);function o(t){return"function"==typeof t}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,r={lastCallThrottled:!0},o=null;function i(){for(var i=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];var u=Date.now(),c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);var f=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,s)):(o&&clearTimeout(o),o=setTimeout((function(){r.lastCallThrottled=!1,t.apply(i,s),n=0,o=void 0}),f)),r}return i}function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=i(t,e),o=n;function a(){o=n}function s(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return o?(o-=1,t.apply(this,n)):r.apply(this,n)}return s.clearHits=a,s}function s(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;function o(){for(var o=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout((function(){e=t.apply(o,a)}),n),e}return o}function l(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=e[0],i=e.slice(1);return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Object(r.arrayReduce)(i,(function(t,e){return e(t)}),o.apply(this,e))}}function u(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(this,n.concat(r))}}function c(t){var e=t.length;return function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r.concat(i);return s.length>=e?t.apply(this,s):n(s)}}([])}function f(t){var e=t.length;return function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=r.concat(i.reverse());return s.length>=e?t.apply(this,s):n(s)}}([])}},function(t,e,n){var r=n(26),o=n(232);r({target:"Array",stat:!0,forced:!n(199)((function(t){Array.from(t)}))},{from:o})},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){"use strict";var r,o=n(49),i=n(169),a=n(124),s=n(142),l=n(200),u=n(52),c=n(89).enforce,f=n(184),h=!o.ActiveXObject&&"ActiveXObject"in o,d=Object.isExtensible,p=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},g=t.exports=s("WeakMap",p,l);if(f&&h){r=l.getConstructor(p,"WeakMap",!0),a.REQUIRED=!0;var v=g.prototype,y=v.delete,m=v.has,b=v.get,w=v.set;i(v,{delete:function(t){if(u(t)&&!d(t)){var e=c(this);return e.frozen||(e.frozen=new r),y.call(this,t)||e.frozen.delete(t)}return y.call(this,t)},has:function(t){if(u(t)&&!d(t)){var e=c(this);return e.frozen||(e.frozen=new r),m.call(this,t)||e.frozen.has(t)}return m.call(this,t)},get:function(t){if(u(t)&&!d(t)){var e=c(this);return e.frozen||(e.frozen=new r),m.call(this,t)?b.call(this,t):e.frozen.get(t)}return b.call(this,t)},set:function(t,e){if(u(t)&&!d(t)){var n=c(this);n.frozen||(n.frozen=new r),m.call(this,t)?w.call(this,t,e):n.frozen.set(t,e)}else w.call(this,t,e);return this}})}},function(t,e,n){"use strict";var r=n(26),o=n(144);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i}));var r=n(13);function o(){var t;Object(r.isDefined)(console)&&(t=console).warn.apply(t,arguments)}function i(){var t;Object(r.isDefined)(console)&&(t=console).error.apply(t,arguments)}},function(t,e,n){"use strict";n(7),n(5),n(8),n(32),n(9);var r=n(61),o=n(20),i=n(66),a=(n(10),n(11),n(12),n(63),n(149),n(23),n(85),n(24),n(17),n(18),n(25),n(33),n(58),n(21)),s=n(13),l=n(40),u=n(1),c=n(0),f=n(2),h=n(14),d=(n(27),n(43),n(38),n(4)),p=n(219),g=n.n(p),v=n(39),y=n(22);function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(t,e,n){return(O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=C(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var S=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==m(e)&&"function"!=typeof e?w(t):e}(this,C(e).call(this,t))).eventManager=new y.a(w(n)),n.autoResize=g()(),n.TEXTAREA=void 0,n.textareaStyle=void 0,n.TEXTAREA_PARENT=void 0,n.textareaParentStyle=void 0,n.layerClass=void 0,n.createElements(),n.bindEvents(),n.hot.addHookOnce("afterDestroy",(function(){return n.destroy()})),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(e,t),n=e,(r=[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(t){this.TEXTAREA.value=t}},{key:"open",value:function(){var t=this;this.refreshDimensions(),this.showEditableElement(),this.addHook("beforeKeyDown",(function(e){return t.onBeforeKeyDown(e)}))}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.removeHooksByKey("beforeKeyDown")}},{key:"prepare",value:function(t,n,r,o,a,s){var l=this,u=this.state;if(O(C(e.prototype),"prepare",this).call(this,t,n,r,o,a,s),!s.readOnly){this.refreshDimensions(!0);var c=s.allowInvalid,f=s.fragmentSelection;c&&(this.TEXTAREA.value=""),u!==i.a.FINISHED&&this.hideEditableElement(),!f&&!Object(v.isMobileBrowser)()&&this.hot._registerImmediate((function(){return l.focus(!0)}))}}},{key:"beginEditing",value:function(t,n){this.state===i.a.VIRGIN&&(this.TEXTAREA.value="",O(C(e.prototype),"beginEditing",this).call(this,t,n))}},{key:"focus",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?Object(c.selectElementIfAllowed)(this.TEXTAREA):(this.TEXTAREA.select(),Object(c.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length))}},{key:"createElements",value:function(){var t=this.hot.rootDocument;this.TEXTAREA=t.createElement("TEXTAREA"),this.TEXTAREA.tabIndex=-1,Object(c.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),Object(c.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),Object(c.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&Object(c.removeClass)(this.TEXTAREA_PARENT,this.layerClass),Object(c.addClass)(this.TEXTAREA_PARENT,"ht_editor_hidden"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(Object(v.isIE)()||Object(v.isEdge)())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Object(c.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&Object(c.removeClass)(this.TEXTAREA_PARENT,this.layerClass),Object(c.addClass)(this.TEXTAREA_PARENT,"ht_editor_hidden")}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle.right="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var t=this.TEXTAREA_PARENT.childNodes,e=!1;Object(d.rangeEach)(t.length-1,(function(n){var r=t[n];if(Object(c.hasClass)(r,"handsontableEditor"))return e=!0,!1})),Object(c.hasClass)(this.TEXTAREA_PARENT,"ht_editor_hidden")&&Object(c.removeClass)(this.TEXTAREA_PARENT,"ht_editor_hidden"),e?(this.layerClass="ht_editor_visible",Object(c.addClass)(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Object(c.addClass)(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===i.a.EDITING||t)if(this.TD=this.getEditedCell(),this.TD){var e,n=this.hot.view.wt,r=n.wtOverlays,o=n.wtViewport,a=Object(c.offset)(this.TD),s=Object(c.offset)(this.hot.rootElement),l=r.topOverlay.holder,u=r.leftOverlay.holder,f=this.hot.countRows(),h=l!==this.hot.rootWindow?l.scrollTop:0,d=u!==this.hot.rootWindow?u.scrollLeft:0,p=this.checkEditorSection(),g=["","left"].includes(p)?h:0,v=["","top","bottom"].includes(p)?d:0,y=a.top===s.top?0:1,m=this.hot.getSettings(),b=this.hot.hasColHeaders(),w=this.TD.style.backgroundColor,O=a.top-s.top-y-g,C=a.left-s.left-1-v;switch(p){case"top":e=Object(c.getCssTransform)(r.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=Object(c.getCssTransform)(r.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=Object(c.getCssTransform)(r.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=Object(c.getCssTransform)(r.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=Object(c.getCssTransform)(r.bottomOverlay.clone.wtTable.holder.parentNode)}(b&&0===this.hot.getSelectedLast()[0]||m.fixedRowsBottom&&this.hot.getSelectedLast()[0]===f-m.fixedRowsBottom)&&(O+=1),0===this.hot.getSelectedLast()[1]&&(C+=1),e&&-1!==e?this.textareaParentStyle[e[0]]=e[1]:Object(c.resetCssTransform)(this.TEXTAREA_PARENT),this.textareaParentStyle.top="".concat(O,"px"),this.textareaParentStyle.left="".concat(C,"px"),this.showEditableElement();var E=o.rowsRenderCalculator.startPosition,S=o.columnsRenderCalculator.startPosition,k=r.leftOverlay.getScrollPosition(),R=r.topOverlay.getScrollPosition(),_=Object(c.getScrollbarWidth)(this.hot.rootDocument),T=this.TD.offsetTop+E-R,M=this.TD.offsetLeft+S-k,A=Object(c.innerWidth)(this.TD)-8,N=Object(c.hasVerticalScrollbar)(l)?_:0,j=Object(c.hasHorizontalScrollbar)(u)?_:0,x=this.hot.view.maximumVisibleElementWidth(M)-9-N,I=this.TD.scrollHeight+1,D=Math.max(this.hot.view.maximumVisibleElementHeight(T)-j,23),P=Object(c.getComputedStyle)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=P.fontSize,this.TEXTAREA.style.fontFamily=P.fontFamily,this.TEXTAREA.style.backgroundColor=w,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(I,D),maxHeight:D,minWidth:Math.min(A,x),maxWidth:x},!0)}else t||this.close()}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(t){return Object(h.stopPropagation)(t)})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(t){return Object(h.stopPropagation)(t)})),this.addHook("afterScrollHorizontally",(function(){return t.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return t.refreshDimensions()})),this.addHook("afterColumnResize",(function(){t.refreshDimensions(),t.focus()})),this.addHook("afterRowResize",(function(){t.refreshDimensions(),t.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"onBeforeKeyDown",value:function(t){var e=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.target===this.TEXTAREA&&!Object(h.isImmediatePropagationStopped)(t)){switch(t.keyCode){case a.KEY_CODES.ARROW_RIGHT:case a.KEY_CODES.ARROW_LEFT:this.isInFullEditMode()&&(this.isWaiting()||this.allowKeyEventPropagation(t.keyCode)||Object(h.stopImmediatePropagation)(t));break;case a.KEY_CODES.ARROW_UP:case a.KEY_CODES.ARROW_DOWN:this.isInFullEditMode()&&(this.isWaiting()||this.allowKeyEventPropagation(t.keyCode)||Object(h.stopImmediatePropagation)(t));break;case a.KEY_CODES.ENTER:var n=this.hot.selection.isMultiple();if(e&&!n||t.altKey){if(this.isOpened()){var r=Object(c.getCaretPosition)(this.TEXTAREA),o=this.getValue(),i="".concat(o.slice(0,r),"\n").concat(o.slice(r));this.setValue(i),Object(c.setCaretPosition)(this.TEXTAREA,r+1)}else this.beginEditing("".concat(this.originalValue,"\n"));Object(h.stopImmediatePropagation)(t)}t.preventDefault();break;case a.KEY_CODES.BACKSPACE:case a.KEY_CODES.DELETE:case a.KEY_CODES.HOME:case a.KEY_CODES.END:Object(h.stopImmediatePropagation)(t)}-1===[a.KEY_CODES.ARROW_UP,a.KEY_CODES.ARROW_RIGHT,a.KEY_CODES.ARROW_DOWN,a.KEY_CODES.ARROW_LEFT].indexOf(t.keyCode)&&this.autoResize.resize(String.fromCharCode(t.keyCode))}}}])&&b(n.prototype,r),o&&b(n,o),e}(i.b);function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function T(t,e){return!e||"object"!==k(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function M(t,e,n){return(M="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function N(t,e){return(N=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var j=function(t){function e(){return R(this,e),T(this,A(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&N(t,e)}(e,t),n=e,(r=[{key:"open",value:function(){M(A(e.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Object(c.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length)}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),M(A(e.prototype),"close",this).call(this)}},{key:"prepare",value:function(t,n,r,o,i,a){M(A(e.prototype),"prepare",this).call(this,t,n,r,o,i,a);var s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(t,e){var n=this.getSourceData(e.row,e.col);void 0!==n&&s.setValue(n),s.instance.destroyEditor()},preventWheel:!0};this.cellProperties.handsontable&&Object(f.extend)(l,a.handsontable),this.htOptions=l}},{key:"beginEditing",value:function(t,n){var r=this.hot.getSettings().onBeginEditing;r&&!1===r()||M(A(e.prototype),"beginEditing",this).call(this,t,n)}},{key:"focus",value:function(t){M(A(e.prototype),"focus",this).call(this,t)}},{key:"createElements",value:function(){M(A(e.prototype),"createElements",this).call(this);var t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}},{key:"finishEditing",value:function(t,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var o=this.htEditor.getInstance().getValue();void 0!==o&&this.setValue(o)}return M(A(e.prototype),"finishEditing",this).call(this,t,n,r)}},{key:"assignHooks",value:function(){var t=this;this.hot.addHook("afterDestroy",(function(){t.htEditor&&t.htEditor.destroy()}))}},{key:"onBeforeKeyDown",value:function(t){if(!Object(h.isImmediatePropagationStopped)(t)){var n,r,o=this.htEditor.getInstance();if(t.keyCode===a.KEY_CODES.ARROW_DOWN)if(o.getSelectedLast()||o.flipped){if(o.getSelectedLast())if(o.flipped)n=o.getSelectedLast()[0]+1;else if(!o.flipped){var i=o.countRows()-1;r=o.getSelectedLast()[0],n=Math.min(i,r+1)}}else n=0;else t.keyCode===a.KEY_CODES.ARROW_UP&&(!o.getSelectedLast()&&o.flipped?n=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(r=o.getSelectedLast()[0],n=Math.max(0,r-1)):n=(r=o.getSelectedLast()[0])-1));void 0!==n&&(n<0||o.flipped&&n>o.countRows()-1?o.deselectCell():o.selectCell(n,0),o.getData().length&&(t.preventDefault(),Object(h.stopImmediatePropagation)(t),this.hot.listen(),this.TEXTAREA.focus())),M(A(e.prototype),"onBeforeKeyDown",this).call(this,t)}}}])&&_(n.prototype,r),o&&_(n,o),e}(S);function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function D(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P(t,e,n){return(P="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=L(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function H(t,e){return(H=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var F=new WeakMap,B=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==x(e)&&"function"!=typeof e?D(t):e}(this,L(e).call(this,t))).query=null,n.strippedChoices=[],n.rawChoices=[],F.set(D(n),{skipOne:!1}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&H(t,e)}(e,t),n=e,(r=[{key:"getValue",value:function(){var t=this,e=this.rawChoices.find((function(e){return t.stripValueIfNeeded(e)===t.TEXTAREA.value}));return Object(s.isDefined)(e)?e:this.TEXTAREA.value}},{key:"createElements",value:function(){P(L(e.prototype),"createElements",this).call(this),Object(c.addClass)(this.htContainer,"autocompleteEditor"),Object(c.addClass)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var t=this,n=F.get(this);this.TEXTAREA_PARENT.style.overflow="auto",P(L(e.prototype),"open",this).call(this),this.TEXTAREA_PARENT.style.overflow="";var r=this.htEditor.getInstance(),o=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var i=Object(c.getScrollbarWidth)(this.hot.rootDocument);r.updateSettings({colWidths:o?[Object(c.outerWidth)(this.TEXTAREA)-2]:void 0,width:o?Object(c.outerWidth)(this.TEXTAREA)+i+2:void 0,afterRenderer:function(e,n,r,o,i){var a,l,u=t.cellProperties,c=u.filteringCaseSensitive,f=u.allowHtml,h=t.query,d=Object(s.stringify)(i);d&&!f&&-1!==(a=!0===c?d.indexOf(h):d.toLowerCase().indexOf(h.toLowerCase()))&&(l=d.substr(a,h.length),d=d.replace(l,"<strong>".concat(l,"</strong>"))),e.innerHTML=d},autoColumnSize:!0,modifyColWidth:function(t,e){var n=this.getPlugin("autoColumnSize"),r=t;if(n){var i=n.widths;i[e]&&(r=i[e])}return o?r:r+15}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]="".concat(i+2,"px"),n.skipOne&&(n.skipOne=!1),this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),P(L(e.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(t){P(L(e.prototype),"discardEditor",this).call(this,t),this.hot.view.render()}},{key:"queryChoices",value:function(t){var e=this,n=this.cellProperties.source;this.query=t,"function"==typeof n?n.call(this.cellProperties,t,(function(t){e.rawChoices=t,e.updateChoicesList(e.stripValuesIfNeeded(t))})):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(t){var n=Object(c.getCaretPosition)(this.TEXTAREA),r=Object(c.getSelectionEndPosition)(this.TEXTAREA),o=this.cellProperties.sortByRelevance,i=this.cellProperties.filter,a=null,s=null,l=t;o&&(a=e.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));var f=Array.isArray(a)?a.length:0;if(!1===i)f&&(s=a[0]);else{for(var h=[],d=0,p=l.length;d<p&&!(o&&f<=d);d++)f?h.push(l[a[d]]):h.push(l[d]);s=0,l=h}this.strippedChoices=l,this.htEditor.loadData(Object(u.pivot)([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s),this.hot.listen(!1),Object(c.setCaretPosition)(this.TEXTAREA,n,n===r?void 0:r)}},{key:"flipDropdownIfNeeded",value:function(){var t=Object(c.offset)(this.TEXTAREA),e=Object(c.outerHeight)(this.TEXTAREA),n=this.getDropdownHeight(),r=Object(c.getTrimmingContainer)(this.hot.view.wt.wtTable.TABLE),o=r.scrollTop,i=Object(c.outerHeight)(this.hot.view.wt.wtTable.THEAD),a={row:0,col:0};r!==this.hot.rootWindow&&(a=Object(c.offset)(r));var s=t.top-a.top-i+o,l=r.scrollHeight-s-i-e,u=n>l&&s>l;return u?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(u?s:l,n),u}},{key:"limitDropdownIfNeeded",value:function(t,e){if(e>t){var n,r=0,o=0,i=0;do{r+=i=this.htEditor.getRowHeight(o)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,o+=1}while(r<t);n=r-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+e-n,"px")),this.setDropdownHeight(r-i)}}},{key:"flipDropdown",value:function(t){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="".concat(-t,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var t=this.htEditor.rootElement.style;"absolute"===t.position&&(t.position="",t.top=""),this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var t=this.htEditor.getColWidth(0)+Object(c.getScrollbarWidth)(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(t){this.htEditor.updateSettings({height:t})}},{key:"highlightBestMatchingChoice",value:function(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var t=this.htEditor.getInstance().getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}},{key:"stripValueIfNeeded",value:function(t){return this.stripValuesIfNeeded([t])[0]}},{key:"stripValuesIfNeeded",value:function(t){var e=this.cellProperties.allowHtml,n=Object(u.arrayMap)(t,(function(t){return Object(s.stringify)(t)}));return Object(u.arrayMap)(n,(function(t){return e?t:Object(l.stripTags)(t)}))}},{key:"allowKeyEventPropagation",value:function(t){var e=this.htEditor.getSelectedRangeLast(),n=e?e.from.row:-1,r=!1;return t===a.KEY_CODES.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(r=!0),t===a.KEY_CODES.ARROW_UP&&n>-1&&(r=!0),r}},{key:"onBeforeKeyDown",value:function(t){var n=this,r=F.get(this);if(r.skipOne=!1,Object(a.isPrintableChar)(t.keyCode)||t.keyCode===a.KEY_CODES.BACKSPACE||t.keyCode===a.KEY_CODES.DELETE||t.keyCode===a.KEY_CODES.INSERT){var o=0;if(t.keyCode===a.KEY_CODES.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(o+=10),this.htEditor&&this.hot._registerTimeout((function(){n.queryChoices(n.TEXTAREA.value),r.skipOne=!0}),o)}P(L(e.prototype),"onBeforeKeyDown",this).call(this,t)}}])&&I(n.prototype,r),o&&I(n,o),e}(j);B.sortByRelevance=function(t,e,n){var r,o,i,a,u=[],c=t.length,f=[],h=e.length;if(0===c){for(a=0;a<h;a++)f.push(a);return f}for(a=0;a<h;a++)r=Object(l.stripTags)(Object(s.stringify)(e[a])),-1!==(o=n?r.indexOf(t):r.toLowerCase().indexOf(t.toLowerCase()))&&(i=r.length-o-c,u.push({baseIndex:a,index:o,charsLeft:i,value:r}));for(u.sort((function(t,e){if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),a=0,h=u.length;a<h;a++)f.push(u[a].baseIndex);return f};var U=B;function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function V(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function z(t,e){return!e||"object"!==W(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function G(t){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function X(t,e){return(X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var q=function(t){function e(){return V(this,e),z(this,G(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}(e,t),n=e,(r=[{key:"beginEditing",value:function(t,e){if(e&&"mouseup"===e.type){var n=this.TD.querySelector('input[type="checkbox"]');Object(c.hasClass)(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}])&&Y(n.prototype,r),o&&Y(n,o),e}(i.b),K=n(28),$=n.n(K),Q=n(180),Z=n.n(Q);function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function et(t,e){return!e||"object"!==J(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nt(t,e,n){return(nt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function rt(t){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ot(t,e){return(ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var it=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=et(this,rt(e).call(this,t))).defaultDateFormat="DD/MM/YYYY",n.isCellEdited=!1,n.parentDestroyed=!1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ot(t,e)}(e,t),n=e,(r=[{key:"init",value:function(){var t=this;if("function"!=typeof $.a)throw new Error("You need to include moment.js to your project.");if("function"!=typeof Z.a)throw new Error("You need to include Pikaday to your project.");nt(rt(e.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){t.parentDestroyed=!0,t.destroyElements()}))}},{key:"createElements",value:function(){nt(rt(e.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,Object(c.addClass)(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.$datePicker=new Z.a(this.getDatePickerConfig()),new y.a(this).addEventListener(this.datePicker,"mousedown",(function(t){return Object(h.stopPropagation)(t)})),this.hideDatepicker()}},{key:"destroyElements",value:function(){var t=this.datePicker.parentNode;this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}},{key:"prepare",value:function(t,n,r,o,i,a){nt(rt(e.prototype),"prepare",this).call(this,t,n,r,o,i,a)}},{key:"open",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;nt(rt(e.prototype),"open",this).call(this),this.showDatepicker(t)}},{key:"close",value:function(){var t=this;this._opened=!1,this.instance._registerTimeout((function(){t.instance._refreshBorders()})),nt(rt(e.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var r=this.originalValue;void 0!==r&&this.setValue(r)}this.hideDatepicker(),nt(rt(e.prototype),"finishEditing",this).call(this,t,n)}},{key:"showDatepicker",value:function(t){this.$datePicker.config(this.getDatePickerConfig());var e,n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.$datePicker.config(),i=this.instance.view.isMouseDown(),s=!!t&&Object(a.isMetaKey)(t.keyCode);this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+n.top+Object(c.outerHeight)(this.TD),"px"),this.datePickerStyle.left="".concat(this.hot.rootWindow.pageXOffset+n.left,"px"),this.$datePicker._onInputFocus=function(){},o.format=r,this.originalValue?(e=this.originalValue,$()(e,r,!0).isValid()&&this.$datePicker.setMoment($()(e,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),s||i||this.setValue("")):this.cellProperties.defaultDate?(e=this.cellProperties.defaultDate,o.defaultDate=e,$()(e,r,!0).isValid()&&this.$datePicker.setMoment($()(e,r),!0),s||i||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var t=this,e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Object(f.deepExtend)(n,this.cellProperties.datePickerConfig);var r=n.onSelect,o=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(e){var n=e;isNaN(n.getTime())||(n=$()(n).format(t.cellProperties.dateFormat||t.defaultDateFormat)),t.setValue(n),t.hideDatepicker(),r&&r()},n.onClose=function(){t.parentDestroyed||t.finishEditing(!1),o&&o()},n}}])&&tt(n.prototype,r),o&&tt(n,o),e}(S);function at(t){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function st(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ut(t,e){return!e||"object"!==at(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ct(t,e,n){return(ct="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ft(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ft(t){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ht(t,e){return(ht=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dt=function(t){function e(){return st(this,e),ut(this,ft(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ht(t,e)}(e,t),n=e,(r=[{key:"prepare",value:function(t,n,r,o,i,a){ct(ft(e.prototype),"prepare",this).call(this,t,n,r,o,i,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}])&&lt(n.prototype,r),o&&lt(n,o),e}(U);o.a.getSingleton().add("beforeValidate",(function(t,e,n){var r=this.getCellMeta(e,this.propToCol(n));r.editor===dt&&void 0===r.strict&&(r.filter=!1,r.strict=!0)}));var pt=dt;function gt(t){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yt(t,e){return!e||"object"!==gt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bt(t,e){return(bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wt=function(t){function e(){return vt(this,e),yt(this,mt(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bt(t,e)}(e,t),e}(S);function Ot(t){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function St(t,e){return!e||"object"!==Ot(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kt(t,e,n){return(kt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Rt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Rt(t){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _t(t,e){return(_t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tt=function(t){function e(){return Ct(this,e),St(this,Rt(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_t(t,e)}(e,t),n=e,(r=[{key:"createElements",value:function(){kt(Rt(e.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Object(c.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}])&&Et(n.prototype,r),o&&Et(n,o),e}(S);function Mt(t){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function At(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jt(t,e){return!e||"object"!==Mt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xt(t,e,n){return(xt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=It(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function It(t){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dt(t,e){return(Dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pt=function(t){function e(){return At(this,e),jt(this,It(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dt(t,e)}(e,t),n=e,(r=[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Object(c.addClass)(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(t){this.select.value=t}},{key:"open",value:function(){var t=this;this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.addHook("beforeKeyDown",(function(){return t.onBeforeKeyDown()}))}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Object(c.hasClass)(this.select,"ht_editor_visible")&&Object(c.removeClass)(this.select,"ht_editor_visible"),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var t=this;this.addHook("afterScrollHorizontally",(function(){return t.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return t.refreshDimensions()})),this.addHook("afterColumnResize",(function(){return t.refreshDimensions()})),this.addHook("afterRowResize",(function(){return t.refreshDimensions()}))}},{key:"prepare",value:function(t,n,r,o,i,a){var s=this;xt(It(e.prototype),"prepare",this).call(this,t,n,r,o,i,a);var l,u=this.cellProperties.selectOptions;l="function"==typeof u?this.prepareOptions(u(this.row,this.col,this.prop)):this.prepareOptions(u),Object(c.empty)(this.select),Object(f.objectEach)(l,(function(t,e){var n=s.hot.rootDocument.createElement("OPTION");n.value=e,Object(c.fastInnerHTML)(n,t),s.select.appendChild(n)}))}},{key:"prepareOptions",value:function(t){var e={};if(Array.isArray(t))for(var n=0,r=t.length;n<r;n++)e[t[n]]=t[n];else"object"===Mt(t)&&(e=t);return e}},{key:"refreshValue",value:function(){var t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===i.a.EDITING)if(this.TD=this.getEditedCell(),this.TD){var t,e=this.hot.view.wt.wtOverlays,n=Object(c.offset)(this.TD),r=Object(c.offset)(this.hot.rootElement),o=e.scrollableElement,a=this.checkEditorSection(),s=Object(c.outerWidth)(this.TD)+1,l=Object(c.outerHeight)(this.TD)+1,u=n.top-r.top-1-(o.scrollTop||0),f=n.left-r.left-1-(o.scrollLeft||0);switch(a){case"top":t=Object(c.getCssTransform)(e.topOverlay.clone.wtTable.holder.parentNode);break;case"left":t=Object(c.getCssTransform)(e.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":t=Object(c.getCssTransform)(e.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":t=Object(c.getCssTransform)(e.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":t=Object(c.getCssTransform)(e.bottomOverlay.clone.wtTable.holder.parentNode)}0===this.hot.getSelectedLast()[0]&&(u+=1),0===this.hot.getSelectedLast()[1]&&(f+=1);var h=this.select.style;t&&-1!==t?h[t[0]]=t[1]:Object(c.resetCssTransform)(this.select);var d=Object(c.getComputedStyle)(this.TD,this.hot.rootWindow);parseInt(d.borderTopWidth,10)>0&&(l-=1),parseInt(d.borderLeftWidth,10)>0&&(s-=1),h.height="".concat(l,"px"),h.minWidth="".concat(s,"px"),h.top="".concat(u,"px"),h.left="".concat(f,"px"),h.margin="0px",Object(c.addClass)(this.select,"ht_editor_visible")}else this.close()}},{key:"onBeforeKeyDown",value:function(){var t=this.select.selectedIndex-1,e=this.select.selectedIndex+1;switch(event.keyCode){case a.KEY_CODES.ARROW_UP:t>=0&&(this.select[t].selected=!0),Object(h.stopImmediatePropagation)(event),event.preventDefault();break;case a.KEY_CODES.ARROW_DOWN:e<=this.select.length-1&&(this.select[e].selected=!0),Object(h.stopImmediatePropagation)(event),event.preventDefault()}}}])&&Nt(n.prototype,r),o&&Nt(n,o),e}(i.b);n.d(e,"d",(function(){return Gt})),n.d(e,"a",(function(){return zt})),n.d(e,"b",(function(){return Yt})),n.d(e,"c",(function(){return Wt}));var Lt=new WeakMap,Ht=Object(r.a)("editors"),Ft=Ht.register,Bt=Ht.getItem,Ut=Ht.hasItem,Wt=Ht.getNames;Ht.getValues;function Vt(t){var e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},o.a.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function Yt(t,e){var n;if("function"==typeof t)Lt.get(t)||Gt(null,t),n=Lt.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=Bt(t)}if(!n)throw Error('No editor registered under name "'.concat(t,'"'));return n.getInstance(e)}function zt(t){if(!Ut(t))throw Error('No registered editor found under "'.concat(t,'" name'));return Bt(t).getConstructor()}function Gt(t,e){var n=new Vt(e);"string"==typeof t&&Ft(t,n),Lt.set(e,n)}Gt("base",i.b),Gt("autocomplete",U),Gt("checkbox",q),Gt("date",it),Gt("dropdown",pt),Gt("handsontable",j),Gt("numeric",wt),Gt("password",Tt),Gt("select",Pt),Gt("text",S)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n(33),n(58),n(147);var r=n(1);function o(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];var i=Object(r.arrayReduce)(t,(function(t,e,r){return t+e.replace(/(?:\r?\n\s+)/g,"")+(n[r]?n[r]:"")}),"");return i.trim()}},function(t,e,n){"use strict";n.r(e),n.d(e,"requestAnimationFrame",(function(){return h})),n.d(e,"isClassListSupported",(function(){return d})),n.d(e,"isTextContentSupported",(function(){return p})),n.d(e,"isGetComputedStyleSupported",(function(){return g})),n.d(e,"cancelAnimationFrame",(function(){return v})),n.d(e,"isTouchSupported",(function(){return y})),n.d(e,"isWebComponentSupportedNatively",(function(){return m})),n.d(e,"hasCaptionProblem",(function(){return b})),n.d(e,"getComparisonFunction",(function(){return w})),n.d(e,"isPassiveEventSupported",(function(){return O}));n(10),n(11),n(12),n(7),n(5),n(33),n(15),n(8),n(130),n(9),n(47);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}for(var o,i,a,s=0,l=["ms","moz","webkit","o"],u=window.requestAnimationFrame,c=window.cancelAnimationFrame,f=0;f<l.length&&!u;++f)u=window["".concat(l[f],"RequestAnimationFrame")],c=window["".concat(l[f],"CancelAnimationFrame")]||window["".concat(l[f],"CancelRequestAnimationFrame")];function h(t){return u.call(window,t)}function d(){return!!document.documentElement.classList}function p(){return!!document.createTextNode("test").textContent}function g(){return!!window.getComputedStyle}function v(t){c.call(window,t)}function y(){return"ontouchstart"in window}function m(){var t=document.createElement("div");return!(!t.createShadowRoot||!t.createShadowRoot.toString().match(/\[native code\]/))}function b(){return void 0===o&&function(){var t=document.createElement("TABLE");t.style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0";var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",t.insertBefore(n,e),document.body.appendChild(t),o=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}(),o}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i||(i="object"===("undefined"==typeof Intl?"undefined":r(Intl))?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?function(t,e){return"".concat(t).localeCompare(e)}:function(t,e){return t===e?0:t>e?-1:1})}function O(){if(void 0!==a)return a;try{var t={get passive(){a=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){a=!1}return a}u||(u=function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-s)),r=window.setTimeout((function(){t(e+n)}),n);return s=e+n,r}),c||(c=function(t){clearTimeout(t)})},function(t,e,n){"use strict";var r=n(26),o=n(52),i=n(126),a=n(138),s=n(62),l=n(72),u=n(127),c=n(50),f=n(128),h=n(68),d=f("slice"),p=h("slice",{ACCESSORS:!0,0:0,1:2}),g=c("species"),v=[].slice,y=Math.max;r({target:"Array",proto:!0,forced:!d||!p},{slice:function(t,e){var n,r,c,f=l(this),h=s(f.length),d=a(t,h),p=a(void 0===e?h:e,h);if(i(f)&&("function"!=typeof(n=f.constructor)||n!==Array&&!i(n.prototype)?o(n)&&null===(n=n[g])&&(n=void 0):n=void 0,n===Array||void 0===n))return v.call(f,d,p);for(r=new(void 0===n?Array:n)(y(p-d,0)),c=0;d<p;d++,c++)d in f&&u(r,c,f[d]);return r.length=c,r}})},function(t,e,n){"use strict";n.r(e),n.d(e,"setBrowserMeta",(function(){return s})),n.d(e,"setPlatformMeta",(function(){return l})),n.d(e,"isChrome",(function(){return u})),n.d(e,"isEdge",(function(){return c})),n.d(e,"isIE",(function(){return f})),n.d(e,"isIE8",(function(){return h})),n.d(e,"isIE9",(function(){return d})),n.d(e,"isMSBrowser",(function(){return p})),n.d(e,"isMobileBrowser",(function(){return g})),n.d(e,"isSafari",(function(){return v})),n.d(e,"isFirefox",(function(){return y})),n.d(e,"isWindowsOS",(function(){return m})),n.d(e,"isMacOS",(function(){return b})),n.d(e,"isLinuxOS",(function(){return w}));var r=n(2),o=function(t){var e={value:!1,test:function(n,r){e.value=t(n,r)}};return e},i={chrome:o((function(t,e){return/Chrome/.test(t)&&/Google/.test(e)})),edge:o((function(t){return/Edge/.test(t)})),firefox:o((function(t){return/Firefox/.test(t)})),ie:o((function(t){return/Trident/.test(t)})),ie8:o((function(){return!document.createTextNode("test").textContent})),ie9:o((function(){return!!document.documentMode})),mobile:o((function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)})),safari:o((function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)}))},a={mac:o((function(t){return/^Mac/.test(t)})),win:o((function(t){return/^Win/.test(t)})),linux:o((function(t){return/^Linux/.test(t)}))};function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.userAgent,n=void 0===e?navigator.userAgent:e,o=t.vendor,a=void 0===o?navigator.vendor:o;Object(r.objectEach)(i,(function(t){(0,t.test)(n,a)}))}function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.platform,n=void 0===e?navigator.platform:e;Object(r.objectEach)(a,(function(t){(0,t.test)(n)}))}function u(){return i.chrome.value}function c(){return i.edge.value}function f(){return i.ie.value}function h(){return i.ie8.value}function d(){return i.ie9.value}function p(){return i.ie.value||i.edge.value}function g(){return i.mobile.value}function v(){return i.safari.value}function y(){return i.firefox.value}function m(){return a.win.value}function b(){return a.mac.value}function w(){return a.linux.value}s(),l()},function(t,e,n){"use strict";n.r(e),n.d(e,"toUpperCaseFirst",(function(){return o})),n.d(e,"equalsIgnoreCase",(function(){return i})),n.d(e,"randomString",(function(){return a})),n.d(e,"isPercentValue",(function(){return s})),n.d(e,"substitute",(function(){return l})),n.d(e,"stripTags",(function(){return c}));n(23),n(5),n(33),n(15),n(58);var r=n(13);function o(t){return t[0].toUpperCase()+t.substr(1)}function i(){for(var t=[],e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];for(var i=n.length;i;){i-=1;var a=Object(r.stringify)(n[i]).toLowerCase();-1===t.indexOf(a)&&t.push(a)}return 1===t.length}function a(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function s(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(t).replace(/(?:\\)?\[([^[\]]+)]/g,(function(t,n){return"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]}))}var u=/<\/?\w+\/?>|<\w+[\s|/][^>]*>/gi;function c(t){return"".concat(t).replace(u,"")}},function(t,e,n){"use strict";var r=n(61),o=(n(27),n(0));var i=function(t,e,n,r,i,a,s){var l=[],u=[];s.className&&(e.className?e.className="".concat(e.className," ").concat(s.className):e.className=s.className),s.readOnly&&l.push(s.readOnlyCellClassName),!1===s.valid&&s.invalidCellClassName?l.push(s.invalidCellClassName):u.push(s.invalidCellClassName),!1===s.wordWrap&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!a&&s.placeholder&&l.push(s.placeholderCellClassName),Object(o.removeClass)(e,u),Object(o.addClass)(e,l)},a=n(22),s=n(6);var l=function(t,e,n,r,i,l,u){var c=t.rootDocument,f=u.allowHtml?"html":"text",h=c.createElement("DIV");h.className="htAutocompleteArrow",h.appendChild(c.createTextNode(String.fromCharCode(9660)));for(var d=arguments.length,p=new Array(d>7?d-7:0),g=7;g<d;g++)p[g-7]=arguments[g];if(x(f).apply(this,[t,e,n,r,i,l,u].concat(p)),e.firstChild||e.appendChild(c.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),Object(o.addClass)(e,"htAutocomplete"),!t.acArrowListener){var v=new a.a(t);t.acArrowListener=function(i){Object(o.hasClass)(i.target,"htAutocompleteArrow")&&t.view.wt.getSetting("onCellDblClick",null,new s.a(n,r),e)},v.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(function(){v.destroy()}))}},u=(n(43),n(7),n(5),n(15),n(54),n(8),n(32),n(9),n(47),n(40)),c=n(21),f=n(29),h=n(14),d=new WeakMap,p=new WeakMap;function g(t){var e=p.get(t);if(!e){var n=t.rootElement;(e=new a.a(t)).addEventListener(n,"click",(function(e){return function(t,e){if(!m(t.target))return!1;var n=parseInt(t.target.getAttribute("data-row"),10),r=parseInt(t.target.getAttribute("data-col"),10);e.getCellMeta(n,r).readOnly&&t.preventDefault()}(e,t)})),e.addEventListener(n,"mouseup",(function(e){return function(t,e){if(!m(t.target))return;setTimeout(e.listen,10)}(e,t)})),e.addEventListener(n,"change",(function(e){return function(t,e){if(!m(t.target))return!1;var n=parseInt(t.target.getAttribute("data-row"),10),r=parseInt(t.target.getAttribute("data-col"),10),o=e.getCellMeta(n,r);if(!o.readOnly){var i=null;i=t.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,e.setDataAtCell(n,r,i)}}(e,t)})),p.set(t,e)}return e}function v(t){var e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function y(t,e){var n=t.createElement("label");return n.className="htCheckboxRendererLabel",n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function m(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}var b=function(t,e,n,r,i,a,s){for(var l=t.rootDocument,p=arguments.length,m=new Array(p>7?p-7:0),b=7;b<p;b++)m[b-7]=arguments[b];x("base").apply(this,[t,e,n,r,i,a,s].concat(m)),g(t);var w=v(l),O=s.label,C=!1;if(void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1),Object(o.empty)(e),a===s.checkedTemplate||Object(u.equalsIgnoreCase)(a,s.checkedTemplate)?w.checked=!0:a===s.uncheckedTemplate||Object(u.equalsIgnoreCase)(a,s.uncheckedTemplate)?w.checked=!1:null===a?Object(o.addClass)(w,"noValue"):(w.style.display="none",Object(o.addClass)(w,"htBadValue"),C=!0),w.setAttribute("data-row",n),w.setAttribute("data-col",r),!C&&O){var E="";if(O.value)E="function"==typeof O.value?O.value.call(this,n,r,i,a):O.value;else if(O.property){var S=t.getDataAtRowProp(n,O.property);E=null!==S?S:""}var k=y(l,E);"before"===O.position?k.appendChild(w):k.insertBefore(w,k.firstChild),w=k}function R(e){var n=Object(f.partial)(c.isKey,e.keyCode);!t.getSettings().enterBeginsEditing&&n("ENTER")||(n("".concat("SPACE|ENTER","|").concat("DELETE|BACKSPACE"))&&!Object(h.isImmediatePropagationStopped)(e)&&T((function(){Object(h.stopImmediatePropagation)(e),e.preventDefault()})),n("SPACE|ENTER")&&_(),n("DELETE|BACKSPACE")&&_(!0))}function _(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.getSelectedRangeLast();if(n){for(var r=n.getTopLeftCorner(),o=r.row,i=r.col,a=n.getBottomRightCorner(),s=a.row,l=a.col,u=[],c=o;c<=s;c+=1)for(var f=i;f<=l;f+=1){var h=t.getCellMeta(c,f);if("checkbox"!==h.type)return;if(!0!==h.readOnly){void 0===h.checkedTemplate&&(h.checkedTemplate=!0),void 0===h.uncheckedTemplate&&(h.uncheckedTemplate=!1);var d=t.getDataAtCell(c,f);!1===e?[h.checkedTemplate,h.checkedTemplate.toString()].includes(d)?u.push([c,f,h.uncheckedTemplate]):[h.uncheckedTemplate,h.uncheckedTemplate.toString(),null,void 0].includes(d)&&u.push([c,f,h.checkedTemplate]):u.push([c,f,h.uncheckedTemplate])}}u.length>0&&t.setDataAtCell(u)}}function T(e){var n=t.getSelectedRangeLast();if(n)for(var r=n.getTopLeftCorner(),o=n.getBottomRightCorner(),i=r.row;i<=o.row;i++)for(var a=r.col;a<=o.col;a++){var s=t.getCellMeta(i,a);if("checkbox"!==s.type)return;var l=t.getCell(i,a);if(null==l)e(i,a,s);else{var u=l.querySelectorAll("input[type=checkbox]");u.length>0&&!s.readOnly&&e(u)}}}e.appendChild(w),C&&e.appendChild(l.createTextNode("#bad-value#")),d.has(t)||(d.set(t,!0),t.addHook("beforeKeyDown",R))};var w=function(t,e,n,r,i,a){for(var s=arguments.length,l=new Array(s>6?s-6:0),u=6;u<s;u++)l[u-6]=arguments[u];x("base").apply(this,[t,e,n,r,i,a].concat(l)),Object(o.fastInnerHTML)(e,null==a?"":a)},O=(n(23),n(70),n(33),n(58),n(69),n(98)),C=n.n(O),E=n(4);var S=function(t,e,n,r,o,i,a){var s=i;if(Object(E.isNumeric)(s)){var l=a.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,f=a.className||"",h=f.length?f.split(" "):[];if(void 0!==u&&!C.a.languages()[u]){var d=u.replace("-",""),p=C.a.allLanguages?C.a.allLanguages[u]:C.a[d];p&&C.a.registerLanguage(p)}C.a.setLanguage(u),s=C()(s).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" ")}x("text")(t,e,n,r,o,s,a)};var k=function(t,e,n,r,i,a,s){for(var l=arguments.length,u=new Array(l>7?l-7:0),c=7;c<l;c++)u[c-7]=arguments[c];x("text").apply(this,[t,e,n,r,i,a,s].concat(u));var f=s.hashLength||e.innerHTML.length,h=s.hashSymbol||"*",d="";Object(E.rangeEach)(f-1,(function(){d+=h})),Object(o.fastInnerHTML)(e,d)},R=n(13);var _=function(t,e,n,r,i,a,s){for(var l=arguments.length,u=new Array(l>7?l-7:0),c=7;c<l;c++)u[c-7]=arguments[c];x("base").apply(this,[t,e,n,r,i,a,s].concat(u));var f=a;if(!f&&s.placeholder&&(f=s.placeholder),f=Object(R.stringify)(f),t.getSettings().trimWhitespace||(f=f.replace(/ /g,String.fromCharCode(160))),s.rendererTemplate){Object(o.empty)(e);var h=t.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=t.getSourceDataAtRow(n),e.appendChild(h)}else Object(o.fastInnerText)(e,f)};n.d(e,"c",(function(){return M})),n.d(e,"b",(function(){return x})),n.d(e,"a",(function(){return j}));var T=Object(r.a)("renderers"),M=T.register,A=T.getItem,N=T.hasItem,j=T.getNames;T.getValues;function x(t){if("function"==typeof t)return t;if(!N(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return A(t)}M("base",i),M("autocomplete",l),M("checkbox",b),M("html",w),M("numeric",S),M("password",k),M("text",_)},function(t,e,n){"use strict";(function(t,r){n.d(e,"d",(function(){return i})),n.d(e,"j",(function(){return a})),n.d(e,"g",(function(){return l})),n.d(e,"n",(function(){return u})),n.d(e,"l",(function(){return c})),n.d(e,"e",(function(){return f})),n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return p})),n.d(e,"h",(function(){return g})),n.d(e,"i",(function(){return v})),n.d(e,"m",(function(){return m})),n.d(e,"k",(function(){return b})),n.d(e,"f",(function(){return w}));var o=n(51);n(100);function i(t,e){return t.require(e)}function a(){return"[object process]"===Object.prototype.toString.call(void 0!==t?t:0)}var s={};function l(){return a()?r:"undefined"!=typeof window?window:"undefined"!=typeof self?self:s}function u(){var t=l(),e=t.crypto||t.msCrypto;if(void 0!==e&&e.getRandomValues){var n=new Uint16Array(8);e.getRandomValues(n),n[3]=4095&n[3]|16384,n[4]=16383&n[4]|32768;var r=function(t){for(var e=t.toString(16);e.length<4;)e="0"+e;return e};return r(n[0])+r(n[1])+r(n[2])+r(n[3])+r(n[4])+r(n[5])+r(n[6])+r(n[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}function c(t){if(!t)return{};var e=t.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};var n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],relative:e[5]+n+r}}function f(t){if(t.message)return t.message;if(t.exception&&t.exception.values&&t.exception.values[0]){var e=t.exception.values[0];return e.type&&e.value?e.type+": "+e.value:e.type||e.value||t.event_id||"<unknown>"}return t.event_id||"<unknown>"}function h(t){var e=l();if(!("console"in e))return t();var n=e.console,r={};["debug","info","warn","error","log","assert"].forEach((function(t){t in e.console&&n[t].__sentry_original__&&(r[t]=n[t],n[t]=n[t].__sentry_original__)}));var o=t();return Object.keys(r).forEach((function(t){n[t]=r[t]})),o}function d(t,e,n){t.exception=t.exception||{},t.exception.values=t.exception.values||[],t.exception.values[0]=t.exception.values[0]||{},t.exception.values[0].value=t.exception.values[0].value||e||"",t.exception.values[0].type=t.exception.values[0].type||n||"Error"}function p(t,e){void 0===e&&(e={});try{t.exception.values[0].mechanism=t.exception.values[0].mechanism||{},Object.keys(e).forEach((function(n){t.exception.values[0].mechanism[n]=e[n]}))}catch(t){}}function g(){try{return document.location.href}catch(t){return""}}function v(t){try{for(var e=t,n=[],r=0,o=0,i=" > ".length,a=void 0;e&&r++<5&&!("html"===(a=y(e))||r>1&&o+n.length*i+a.length>=80);)n.push(a),o+=a.length,e=e.parentNode;return n.reverse().join(" > ")}catch(t){return"<unknown>"}}function y(t){var e,n,r,i,a,s=t,l=[];if(!s||!s.tagName)return"";if(l.push(s.tagName.toLowerCase()),s.id&&l.push("#"+s.id),(e=s.className)&&Object(o.k)(e))for(n=e.split(/\s+/),a=0;a<n.length;a++)l.push("."+n[a]);var u=["type","name","title","alt"];for(a=0;a<u.length;a++)r=u[a],(i=s.getAttribute(r))&&l.push("["+r+'="'+i+'"]');return l.join("")}function m(){return Date.now()/1e3}function b(t,e){if(!e)return 6e4;var n=parseInt(""+e,10);if(!isNaN(n))return 1e3*n;var r=Date.parse(""+e);return isNaN(r)?6e4:r-t}function w(t){try{return t&&"function"==typeof t&&t.name||"<anonymous>"}catch(t){return"<anonymous>"}}}).call(this,n(215),n(115))},function(t,e,n){"use strict";var r=n(26),o=n(161).includes,i=n(121);r({target:"Array",proto:!0,forced:!n(68)("indexOf",{ACCESSORS:!0,1:0})},{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("includes")},function(t,e,n){"use strict";var r=n(1),o=n(2),i={_localHooks:Object.create(null),addLocalHook:function(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks:function(t){for(var e=this,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this._localHooks[t]&&Object(r.arrayEach)(this._localHooks[t],(function(t){return t.apply(e,o)}))},clearLocalHooks:function(){return this._localHooks={},this}};Object(o.defineGetter)(i,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),e.a=i},function(t,e,n){"use strict";var r=n(26),o=n(138),i=n(90),a=n(62),s=n(67),l=n(173),u=n(127),c=n(128),f=n(68),h=c("splice"),d=f("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,g=Math.min;r({target:"Array",proto:!0,forced:!h||!d},{splice:function(t,e){var n,r,c,f,h,d,v=s(this),y=a(v.length),m=o(t,y),b=arguments.length;if(0===b?n=r=0:1===b?(n=0,r=y-m):(n=b-2,r=g(p(i(e),0),y-m)),y+n-r>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(c=l(v,r),f=0;f<r;f++)(h=m+f)in v&&u(c,f,v[h]);if(c.length=r,n<r){for(f=m;f<y-r;f++)d=f+n,(h=f+r)in v?v[d]=v[h]:delete v[d];for(f=y;f>y-r+n;f--)delete v[f-1]}else if(n>r)for(f=y-r;f>m;f--)d=f+n-1,(h=f+r-1)in v?v[d]=v[h]:delete v[d];for(f=0;f<n;f++)v[f+m]=arguments[f+2];return v.length=y-r+n,c}})},function(t,e,n){var r,o;!function(){var i={version:"3.5.17"},a=[].slice,s=function(t){return a.call(t)},l=this.document;function u(t){return t&&(t.ownerDocument||t.document||t).documentElement}function c(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}if(l)try{s(l.documentElement.childNodes)[0].nodeType}catch(t){s=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),l)try{l.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var f=this.Element.prototype,h=f.setAttribute,d=f.setAttributeNS,p=this.CSSStyleDeclaration.prototype,g=p.setProperty;f.setAttribute=function(t,e){h.call(this,t,e+"")},f.setAttributeNS=function(t,e,n){d.call(this,t,e,n+"")},p.setProperty=function(t,e,n){g.call(this,t,e+"",n)}}function v(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function y(t){return null===t?NaN:+t}function m(t){return!isNaN(t)}function b(t){return{left:function(e,n,r,o){for(arguments.length<3&&(r=0),arguments.length<4&&(o=e.length);r<o;){var i=r+o>>>1;t(e[i],n)<0?r=i+1:o=i}return r},right:function(e,n,r,o){for(arguments.length<3&&(r=0),arguments.length<4&&(o=e.length);r<o;){var i=r+o>>>1;t(e[i],n)>0?o=i:r=i+1}return r}}}i.ascending=v,i.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},i.min=function(t,e){var n,r,o=-1,i=t.length;if(1===arguments.length){for(;++o<i;)if(null!=(r=t[o])&&r>=r){n=r;break}for(;++o<i;)null!=(r=t[o])&&n>r&&(n=r)}else{for(;++o<i;)if(null!=(r=e.call(t,t[o],o))&&r>=r){n=r;break}for(;++o<i;)null!=(r=e.call(t,t[o],o))&&n>r&&(n=r)}return n},i.max=function(t,e){var n,r,o=-1,i=t.length;if(1===arguments.length){for(;++o<i;)if(null!=(r=t[o])&&r>=r){n=r;break}for(;++o<i;)null!=(r=t[o])&&r>n&&(n=r)}else{for(;++o<i;)if(null!=(r=e.call(t,t[o],o))&&r>=r){n=r;break}for(;++o<i;)null!=(r=e.call(t,t[o],o))&&r>n&&(n=r)}return n},i.extent=function(t,e){var n,r,o,i=-1,a=t.length;if(1===arguments.length){for(;++i<a;)if(null!=(r=t[i])&&r>=r){n=o=r;break}for(;++i<a;)null!=(r=t[i])&&(n>r&&(n=r),o<r&&(o=r))}else{for(;++i<a;)if(null!=(r=e.call(t,t[i],i))&&r>=r){n=o=r;break}for(;++i<a;)null!=(r=e.call(t,t[i],i))&&(n>r&&(n=r),o<r&&(o=r))}return[n,o]},i.sum=function(t,e){var n,r=0,o=t.length,i=-1;if(1===arguments.length)for(;++i<o;)m(n=+t[i])&&(r+=n);else for(;++i<o;)m(n=+e.call(t,t[i],i))&&(r+=n);return r},i.mean=function(t,e){var n,r=0,o=t.length,i=-1,a=o;if(1===arguments.length)for(;++i<o;)m(n=y(t[i]))?r+=n:--a;else for(;++i<o;)m(n=y(e.call(t,t[i],i)))?r+=n:--a;if(a)return r/a},i.quantile=function(t,e){var n=(t.length-1)*e+1,r=Math.floor(n),o=+t[r-1],i=n-r;return i?o+i*(t[r]-o):o},i.median=function(t,e){var n,r=[],o=t.length,a=-1;if(1===arguments.length)for(;++a<o;)m(n=y(t[a]))&&r.push(n);else for(;++a<o;)m(n=y(e.call(t,t[a],a)))&&r.push(n);if(r.length)return i.quantile(r.sort(v),.5)},i.variance=function(t,e){var n,r,o=t.length,i=0,a=0,s=-1,l=0;if(1===arguments.length)for(;++s<o;)m(n=y(t[s]))&&(a+=(r=n-i)*(n-(i+=r/++l)));else for(;++s<o;)m(n=y(e.call(t,t[s],s)))&&(a+=(r=n-i)*(n-(i+=r/++l)));if(l>1)return a/(l-1)},i.deviation=function(){var t=i.variance.apply(this,arguments);return t?Math.sqrt(t):t};var w=b(v);function O(t){return t.length}i.bisectLeft=w.left,i.bisect=i.bisectRight=w.right,i.bisector=function(t){return b(1===t.length?function(e,n){return v(t(e),n)}:t)},i.shuffle=function(t,e,n){(i=arguments.length)<3&&(n=t.length,i<2&&(e=0));for(var r,o,i=n-e;i;)o=Math.random()*i--|0,r=t[i+e],t[i+e]=t[o+e],t[o+e]=r;return t},i.permute=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},i.pairs=function(t){for(var e=0,n=t.length-1,r=t[0],o=new Array(n<0?0:n);e<n;)o[e]=[r,r=t[++e]];return o},i.transpose=function(t){if(!(o=t.length))return[];for(var e=-1,n=i.min(t,O),r=new Array(n);++e<n;)for(var o,a=-1,s=r[e]=new Array(o);++a<o;)s[a]=t[a][e];return r},i.zip=function(){return i.transpose(arguments)},i.keys=function(t){var e=[];for(var n in t)e.push(n);return e},i.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},i.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},i.merge=function(t){for(var e,n,r,o=t.length,i=-1,a=0;++i<o;)a+=t[i].length;for(n=new Array(a);--o>=0;)for(e=(r=t[o]).length;--e>=0;)n[--a]=r[e];return n};var C=Math.abs;function E(t){for(var e=1;t*e%1;)e*=10;return e}function S(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function k(){this._=Object.create(null)}i.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n==1/0)throw new Error("infinite range");var r,o=[],i=E(C(n)),a=-1;if(t*=i,e*=i,(n*=i)<0)for(;(r=t+n*++a)>e;)o.push(r/i);else for(;(r=t+n*++a)<e;)o.push(r/i);return o},i.map=function(t,e){var n=new k;if(t instanceof k)t.forEach((function(t,e){n.set(t,e)}));else if(Array.isArray(t)){var r,o=-1,i=t.length;if(1===arguments.length)for(;++o<i;)n.set(o,t[o]);else for(;++o<i;)n.set(e.call(t,r=t[o],o),r)}else for(var a in t)n.set(a,t[a]);return n};function R(t){return"__proto__"==(t+="")||"\0"===t[0]?"\0"+t:t}function _(t){return"\0"===(t+="")[0]?t.slice(1):t}function T(t){return R(t)in this._}function M(t){return(t=R(t))in this._&&delete this._[t]}function A(){var t=[];for(var e in this._)t.push(_(e));return t}function N(){var t=0;for(var e in this._)++t;return t}function j(){for(var t in this._)return!1;return!0}function x(){this._=Object.create(null)}function I(t){return t}function D(t,e,n){return function(){var r=n.apply(e,arguments);return r===e?t:r}}function P(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,r=L.length;n<r;++n){var o=L[n]+e;if(o in t)return o}}S(k,{has:T,get:function(t){return this._[R(t)]},set:function(t,e){return this._[R(t)]=e},remove:M,keys:A,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:_(e),value:this._[e]});return t},size:N,empty:j,forEach:function(t){for(var e in this._)t.call(this,_(e),this._[e])}}),i.nest=function(){var t,e,n={},r=[],o=[];function a(o,i,s){if(s>=r.length)return e?e.call(n,i):t?i.sort(t):i;for(var l,u,c,f,h=-1,d=i.length,p=r[s++],g=new k;++h<d;)(f=g.get(l=p(u=i[h])))?f.push(u):g.set(l,[u]);return o?(u=o(),c=function(t,e){u.set(t,a(o,e,s))}):(u={},c=function(t,e){u[t]=a(o,e,s)}),g.forEach(c),u}return n.map=function(t,e){return a(e,t,0)},n.entries=function(t){return function t(e,n){if(n>=r.length)return e;var i=[],a=o[n++];return e.forEach((function(e,r){i.push({key:e,values:t(r,n)})})),a?i.sort((function(t,e){return a(t.key,e.key)})):i}(a(i.map,t,0),0)},n.key=function(t){return r.push(t),n},n.sortKeys=function(t){return o[r.length-1]=t,n},n.sortValues=function(e){return t=e,n},n.rollup=function(t){return e=t,n},n},i.set=function(t){var e=new x;if(t)for(var n=0,r=t.length;n<r;++n)e.add(t[n]);return e},S(x,{has:T,add:function(t){return this._[R(t+="")]=!0,t},remove:M,values:A,size:N,empty:j,forEach:function(t){for(var e in this._)t.call(this,_(e))}}),i.behavior={},i.rebind=function(t,e){for(var n,r=1,o=arguments.length;++r<o;)t[n=arguments[r]]=D(t,e,e[n]);return t};var L=["webkit","ms","moz","Moz","o","O"];function H(){}function F(){}function B(t){var e=[],n=new k;function r(){for(var n,r=e,o=-1,i=r.length;++o<i;)(n=r[o].on)&&n.apply(this,arguments);return t}return r.on=function(r,o){var i,a=n.get(r);return arguments.length<2?a&&a.on:(a&&(a.on=null,e=e.slice(0,i=e.indexOf(a)).concat(e.slice(i+1)),n.remove(r)),o&&e.push(n.set(r,{on:o})),t)},r}function U(){i.event.preventDefault()}function W(){for(var t,e=i.event;t=e.sourceEvent;)e=t;return e}function V(t){for(var e=new F,n=0,r=arguments.length;++n<r;)e[arguments[n]]=B(e);return e.of=function(n,r){return function(o){try{var a=o.sourceEvent=i.event;o.target=t,i.event=o,e[o.type].apply(n,r)}finally{i.event=a}}},e}i.dispatch=function(){for(var t=new F,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=B(t);return t},F.prototype.on=function(t,e){var n=t.indexOf("."),r="";if(n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(r):this[t].on(r,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},i.event=null,i.requote=function(t){return t.replace(Y,"\\$&")};var Y=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,z={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]};function G(t){return z(t,$),t}var X=function(t,e){return e.querySelector(t)},q=function(t,e){return e.querySelectorAll(t)},K=function(t,e){var n=t.matches||t[P(t,"matchesSelector")];return(K=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&(X=function(t,e){return Sizzle(t,e)[0]||null},q=Sizzle,K=Sizzle.matchesSelector),i.selection=function(){return i.select(l.documentElement)};var $=i.selection.prototype=[];function Q(t){return"function"==typeof t?t:function(){return X(t,this)}}function Z(t){return"function"==typeof t?t:function(){return q(t,this)}}$.select=function(t){var e,n,r,o,i=[];t=Q(t);for(var a=-1,s=this.length;++a<s;){i.push(e=[]),e.parentNode=(r=this[a]).parentNode;for(var l=-1,u=r.length;++l<u;)(o=r[l])?(e.push(n=t.call(o,o.__data__,l,a)),n&&"__data__"in o&&(n.__data__=o.__data__)):e.push(null)}return G(i)},$.selectAll=function(t){var e,n,r=[];t=Z(t);for(var o=-1,i=this.length;++o<i;)for(var a=this[o],l=-1,u=a.length;++l<u;)(n=a[l])&&(r.push(e=s(t.call(n,n.__data__,l,o))),e.parentNode=n);return G(r)};var J="http://www.w3.org/1999/xhtml",tt={svg:"http://www.w3.org/2000/svg",xhtml:J,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function et(t,e){return t=i.ns.qualify(t),null==e?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof e?t.local?function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}:function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}:t.local?function(){this.setAttributeNS(t.space,t.local,e)}:function(){this.setAttribute(t,e)}}function nt(t){return t.trim().replace(/\s+/g," ")}function rt(t){return new RegExp("(?:^|\\s+)"+i.requote(t)+"(?:\\s+|$)","g")}function ot(t){return(t+"").trim().split(/^|\s+/)}function it(t,e){var n=(t=ot(t).map(at)).length;return"function"==typeof e?function(){for(var r=-1,o=e.apply(this,arguments);++r<n;)t[r](this,o)}:function(){for(var r=-1;++r<n;)t[r](this,e)}}function at(t){var e=rt(t);return function(n,r){if(o=n.classList)return r?o.add(t):o.remove(t);var o=n.getAttribute("class")||"";r?(e.lastIndex=0,e.test(o)||n.setAttribute("class",nt(o+" "+t))):n.setAttribute("class",nt(o.replace(e," ")))}}function st(t,e,n){return null==e?function(){this.style.removeProperty(t)}:"function"==typeof e?function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}:function(){this.style.setProperty(t,e,n)}}function lt(t,e){return null==e?function(){delete this[t]}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}:function(){this[t]=e}}function ut(t){return"function"==typeof t?t:(t=i.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){var e=this.ownerDocument,n=this.namespaceURI;return n===J&&e.documentElement.namespaceURI===J?e.createElement(t):e.createElementNS(n,t)}}function ct(){var t=this.parentNode;t&&t.removeChild(this)}function ft(t){return{__data__:t}}function ht(t){return function(){return K(this,t)}}function dt(t){return arguments.length||(t=v),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function pt(t,e){for(var n=0,r=t.length;n<r;n++)for(var o,i=t[n],a=0,s=i.length;a<s;a++)(o=i[a])&&e(o,a,n);return t}function gt(t){return z(t,vt),t}i.ns={prefix:tt,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),tt.hasOwnProperty(n)?{space:tt[n],local:t}:t}},$.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return(t=i.ns.qualify(t)).local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(et(e,t[e]));return this}return this.each(et(t,e))},$.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),r=(t=ot(t)).length,o=-1;if(e=n.classList){for(;++o<r;)if(!e.contains(t[o]))return!1}else for(e=n.getAttribute("class");++o<r;)if(!rt(t[o]).test(e))return!1;return!0}for(e in t)this.each(it(e,t[e]));return this}return this.each(it(t,e))},$.style=function(t,e,n){var r=arguments.length;if(r<3){if("string"!=typeof t){for(n in r<2&&(e=""),t)this.each(st(n,t[n],e));return this}if(r<2){var o=this.node();return c(o).getComputedStyle(o,null).getPropertyValue(t)}n=""}return this.each(st(t,e,n))},$.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(lt(e,t[e]));return this}return this.each(lt(t,e))},$.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},$.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},$.append=function(t){return t=ut(t),this.select((function(){return this.appendChild(t.apply(this,arguments))}))},$.insert=function(t,e){return t=ut(t),e=Q(e),this.select((function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)}))},$.remove=function(){return this.each(ct)},$.data=function(t,e){var n,r,o=-1,i=this.length;if(!arguments.length){for(t=new Array(i=(n=this[0]).length);++o<i;)(r=n[o])&&(t[o]=r.__data__);return t}function a(t,n){var r,o,i,a=t.length,c=n.length,f=Math.min(a,c),h=new Array(c),d=new Array(c),p=new Array(a);if(e){var g,v=new k,y=new Array(a);for(r=-1;++r<a;)(o=t[r])&&(v.has(g=e.call(o,o.__data__,r))?p[r]=o:v.set(g,o),y[r]=g);for(r=-1;++r<c;)(o=v.get(g=e.call(n,i=n[r],r)))?!0!==o&&(h[r]=o,o.__data__=i):d[r]=ft(i),v.set(g,!0);for(r=-1;++r<a;)r in y&&!0!==v.get(y[r])&&(p[r]=t[r])}else{for(r=-1;++r<f;)o=t[r],i=n[r],o?(o.__data__=i,h[r]=o):d[r]=ft(i);for(;r<c;++r)d[r]=ft(n[r]);for(;r<a;++r)p[r]=t[r]}d.update=h,d.parentNode=h.parentNode=p.parentNode=t.parentNode,s.push(d),l.push(h),u.push(p)}var s=gt([]),l=G([]),u=G([]);if("function"==typeof t)for(;++o<i;)a(n=this[o],t.call(n,n.parentNode.__data__,o));else for(;++o<i;)a(n=this[o],t);return l.enter=function(){return s},l.exit=function(){return u},l},$.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},$.filter=function(t){var e,n,r,o=[];"function"!=typeof t&&(t=ht(t));for(var i=0,a=this.length;i<a;i++){o.push(e=[]),e.parentNode=(n=this[i]).parentNode;for(var s=0,l=n.length;s<l;s++)(r=n[s])&&t.call(r,r.__data__,s,i)&&e.push(r)}return G(o)},$.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,r=this[t],o=r.length-1,i=r[o];--o>=0;)(n=r[o])&&(i&&i!==n.nextSibling&&i.parentNode.insertBefore(n,i),i=n);return this},$.sort=function(t){t=dt.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},$.each=function(t){return pt(this,(function(e,n,r){t.call(e,e.__data__,n,r)}))},$.call=function(t){var e=s(arguments);return t.apply(e[0]=this,e),this},$.empty=function(){return!this.node()},$.node=function(){for(var t=0,e=this.length;t<e;t++)for(var n=this[t],r=0,o=n.length;r<o;r++){var i=n[r];if(i)return i}return null},$.size=function(){var t=0;return pt(this,(function(){++t})),t};var vt=[];function yt(t){var e,n;return function(r,o,i){var a,s=t[i].update,l=s.length;for(i!=n&&(n=i,e=0),o>=e&&(e=o+1);!(a=s[e])&&++e<l;);return a}}function mt(t,e,n){var r="__on"+t,o=t.indexOf("."),a=wt;o>0&&(t=t.slice(0,o));var l=bt.get(t);function u(){var e=this[r];e&&(this.removeEventListener(t,e,e.$),delete this[r])}return l&&(t=l,a=Ot),o?e?function(){var o=a(e,s(arguments));u.call(this),this.addEventListener(t,this[r]=o,o.$=n),o._=e}:u:e?H:function(){var e,n=new RegExp("^__on([^.]+)"+i.requote(t)+"$");for(var r in this)if(e=r.match(n)){var o=this[r];this.removeEventListener(e[1],o,o.$),delete this[r]}}}i.selection.enter=gt,i.selection.enter.prototype=vt,vt.append=$.append,vt.empty=$.empty,vt.node=$.node,vt.call=$.call,vt.size=$.size,vt.select=function(t){for(var e,n,r,o,i,a=[],s=-1,l=this.length;++s<l;){r=(o=this[s]).update,a.push(e=[]),e.parentNode=o.parentNode;for(var u=-1,c=o.length;++u<c;)(i=o[u])?(e.push(r[u]=n=t.call(o.parentNode,i.__data__,u,s)),n.__data__=i.__data__):e.push(null)}return G(a)},vt.insert=function(t,e){return arguments.length<2&&(e=yt(this)),$.insert.call(this,t,e)},i.select=function(t){var e;return"string"==typeof t?(e=[X(t,l)]).parentNode=l.documentElement:(e=[t]).parentNode=u(t),G([e])},i.selectAll=function(t){var e;return"string"==typeof t?(e=s(q(t,l))).parentNode=l.documentElement:(e=s(t)).parentNode=null,G([e])},$.on=function(t,e,n){var r=arguments.length;if(r<3){if("string"!=typeof t){for(n in r<2&&(e=!1),t)this.each(mt(n,t[n],e));return this}if(r<2)return(r=this.node()["__on"+t])&&r._;n=!1}return this.each(mt(t,e,n))};var bt=i.map({mouseenter:"mouseover",mouseleave:"mouseout"});function wt(t,e){return function(n){var r=i.event;i.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{i.event=r}}}function Ot(t,e){var n=wt(t,e);return function(t){var e=t.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||n.call(this,t)}}l&&bt.forEach((function(t){"on"+t in l&&bt.remove(t)}));var Ct,Et=0;function St(t){var e=".dragsuppress-"+ ++Et,n="click"+e,r=i.select(c(t)).on("touchmove"+e,U).on("dragstart"+e,U).on("selectstart"+e,U);if(null==Ct&&(Ct=!("onselectstart"in t)&&P(t.style,"userSelect")),Ct){var o=u(t).style,a=o[Ct];o[Ct]="none"}return function(t){if(r.on(e,null),Ct&&(o[Ct]=a),t){var i=function(){r.on(n,null)};r.on(n,(function(){U(),i()}),!0),setTimeout(i,0)}}}i.mouse=function(t){return Rt(t,W())};var kt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function Rt(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();if(kt<0){var o=c(t);if(o.scrollX||o.scrollY){var a=(n=i.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();kt=!(a.f||a.e),n.remove()}}return kt?(r.x=e.pageX,r.y=e.pageY):(r.x=e.clientX,r.y=e.clientY),[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}function _t(){return i.event.changedTouches[0].identifier}i.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=W().changedTouches),e)for(var r,o=0,i=e.length;o<i;++o)if((r=e[o]).identifier===n)return Rt(t,r)},i.behavior.drag=function(){var t=V(o,"drag","dragstart","dragend"),e=null,n=a(H,i.mouse,c,"mousemove","mouseup"),r=a(_t,i.touch,I,"touchmove","touchend");function o(){this.on("mousedown.drag",n).on("touchstart.drag",r)}function a(n,r,o,a,s){return function(){var l,u=this,c=i.event.target.correspondingElement||i.event.target,f=u.parentNode,h=t.of(u,arguments),d=0,p=n(),g=".drag"+(null==p?"":"-"+p),v=i.select(o(c)).on(a+g,b).on(s+g,w),y=St(c),m=r(f,p);function b(){var t,e,n=r(f,p);n&&(t=n[0]-m[0],e=n[1]-m[1],d|=t|e,m=n,h({type:"drag",x:n[0]+l[0],y:n[1]+l[1],dx:t,dy:e}))}function w(){r(f,p)&&(v.on(a+g,null).on(s+g,null),y(d),h({type:"dragend"}))}l=e?[(l=e.apply(u,arguments)).x-m[0],l.y-m[1]]:[0,0],h({type:"dragstart"})}}return o.origin=function(t){return arguments.length?(e=t,o):e},i.rebind(o,t,"on")},i.touches=function(t,e){return arguments.length<2&&(e=W().touches),e?s(e).map((function(e){var n=Rt(t,e);return n.identifier=e.identifier,n})):[]};var Tt=1e-6,Mt=Tt*Tt,At=Math.PI,Nt=2*At,jt=Nt-Tt,xt=At/2,It=At/180,Dt=180/At;function Pt(t){return t>0?1:t<0?-1:0}function Lt(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function Ht(t){return t>1?0:t<-1?At:Math.acos(t)}function Ft(t){return t>1?xt:t<-1?-xt:Math.asin(t)}function Bt(t){return((t=Math.exp(t))+1/t)/2}function Ut(t){return(t=Math.sin(t/2))*t}var Wt=Math.SQRT2;i.interpolateZoom=function(t,e){var n,r,o=t[0],i=t[1],a=t[2],s=e[0],l=e[1],u=e[2],c=s-o,f=l-i,h=c*c+f*f;if(h<Mt)r=Math.log(u/a)/Wt,n=function(t){return[o+t*c,i+t*f,a*Math.exp(Wt*t*r)]};else{var d=Math.sqrt(h),p=(u*u-a*a+4*h)/(2*a*2*d),g=(u*u-a*a-4*h)/(2*u*2*d),v=Math.log(Math.sqrt(p*p+1)-p),y=Math.log(Math.sqrt(g*g+1)-g);r=(y-v)/Wt,n=function(t){var e,n=t*r,s=Bt(v),l=a/(2*d)*(s*(e=Wt*n+v,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(v));return[o+l*c,i+l*f,a*s/Bt(Wt*n+v)]}}return n.duration=1e3*r,n},i.behavior.zoom=function(){var t,e,n,r,o,a,s,u,f,h={x:0,y:0,k:1},d=[960,500],p=zt,g=250,v=0,y="mousedown.zoom",m="mousemove.zoom",b="mouseup.zoom",w="touchstart.zoom",O=V(C,"zoomstart","zoom","zoomend");function C(t){t.on(y,N).on(Yt+".zoom",x).on("dblclick.zoom",I).on(w,j)}function E(t){return[(t[0]-h.x)/h.k,(t[1]-h.y)/h.k]}function S(t){h.k=Math.max(p[0],Math.min(p[1],t))}function k(t,e){e=function(t){return[t[0]*h.k+h.x,t[1]*h.k+h.y]}(e),h.x+=t[0]-e[0],h.y+=t[1]-e[1]}function R(t,n,r,o){t.__chart__={x:h.x,y:h.y,k:h.k},S(Math.pow(2,o)),k(e=n,r),t=i.select(t),g>0&&(t=t.transition().duration(g)),t.call(C.event)}function _(){s&&s.domain(a.range().map((function(t){return(t-h.x)/h.k})).map(a.invert)),f&&f.domain(u.range().map((function(t){return(t-h.y)/h.k})).map(u.invert))}function T(t){v++||t({type:"zoomstart"})}function M(t){_(),t({type:"zoom",scale:h.k,translate:[h.x,h.y]})}function A(t){--v||(t({type:"zoomend"}),e=null)}function N(){var t=this,e=O.of(t,arguments),n=0,r=i.select(c(t)).on(m,s).on(b,l),o=E(i.mouse(t)),a=St(t);function s(){n=1,k(i.mouse(t),o),M(e)}function l(){r.on(m,null).on(b,null),a(n),A(e)}Os.call(t),T(e)}function j(){var t,e=this,n=O.of(e,arguments),r={},a=0,s=".zoom-"+i.event.changedTouches[0].identifier,l="touchmove"+s,u="touchend"+s,c=[],f=i.select(e),d=St(e);function p(){var n=i.touches(e);return t=h.k,n.forEach((function(t){t.identifier in r&&(r[t.identifier]=E(t))})),n}function g(){var t=i.event.target;i.select(t).on(l,v).on(u,m),c.push(t);for(var n=i.event.changedTouches,s=0,f=n.length;s<f;++s)r[n[s].identifier]=null;var d=p(),g=Date.now();if(1===d.length){if(g-o<500){var y=d[0];R(e,y,r[y.identifier],Math.floor(Math.log(h.k)/Math.LN2)+1),U()}o=g}else if(d.length>1){y=d[0];var b=d[1],w=y[0]-b[0],O=y[1]-b[1];a=w*w+O*O}}function v(){var s,l,u,c,f=i.touches(e);Os.call(e);for(var h=0,d=f.length;h<d;++h,c=null)if(u=f[h],c=r[u.identifier]){if(l)break;s=u,l=c}if(c){var p=(p=u[0]-s[0])*p+(p=u[1]-s[1])*p,g=a&&Math.sqrt(p/a);s=[(s[0]+u[0])/2,(s[1]+u[1])/2],l=[(l[0]+c[0])/2,(l[1]+c[1])/2],S(g*t)}o=null,k(s,l),M(n)}function m(){if(i.event.touches.length){for(var t=i.event.changedTouches,e=0,o=t.length;e<o;++e)delete r[t[e].identifier];for(var a in r)return void p()}i.selectAll(c).on(s,null),f.on(y,N).on(w,j),d(),A(n)}g(),T(n),f.on(y,null).on(w,g)}function x(){var o=O.of(this,arguments);r?clearTimeout(r):(Os.call(this),t=E(e=n||i.mouse(this)),T(o)),r=setTimeout((function(){r=null,A(o)}),50),U(),S(Math.pow(2,.002*Vt())*h.k),k(e,t),M(o)}function I(){var t=i.mouse(this),e=Math.log(h.k)/Math.LN2;R(this,t,E(t),i.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}return Yt||(Yt="onwheel"in l?(Vt=function(){return-i.event.deltaY*(i.event.deltaMode?120:1)},"wheel"):"onmousewheel"in l?(Vt=function(){return i.event.wheelDelta},"mousewheel"):(Vt=function(){return-i.event.detail},"MozMousePixelScroll")),C.event=function(t){t.each((function(){var t=O.of(this,arguments),n=h;Ss?i.select(this).transition().each("start.zoom",(function(){h=this.__chart__||{x:0,y:0,k:1},T(t)})).tween("zoom:zoom",(function(){var r=d[0],o=d[1],a=e?e[0]:r/2,s=e?e[1]:o/2,l=i.interpolateZoom([(a-h.x)/h.k,(s-h.y)/h.k,r/h.k],[(a-n.x)/n.k,(s-n.y)/n.k,r/n.k]);return function(e){var n=l(e),o=r/n[2];this.__chart__=h={x:a-n[0]*o,y:s-n[1]*o,k:o},M(t)}})).each("interrupt.zoom",(function(){A(t)})).each("end.zoom",(function(){A(t)})):(this.__chart__=h,T(t),M(t),A(t))}))},C.translate=function(t){return arguments.length?(h={x:+t[0],y:+t[1],k:h.k},_(),C):[h.x,h.y]},C.scale=function(t){return arguments.length?(h={x:h.x,y:h.y,k:null},S(+t),_(),C):h.k},C.scaleExtent=function(t){return arguments.length?(p=null==t?zt:[+t[0],+t[1]],C):p},C.center=function(t){return arguments.length?(n=t&&[+t[0],+t[1]],C):n},C.size=function(t){return arguments.length?(d=t&&[+t[0],+t[1]],C):d},C.duration=function(t){return arguments.length?(g=+t,C):g},C.x=function(t){return arguments.length?(s=t,a=t.copy(),h={x:0,y:0,k:1},C):s},C.y=function(t){return arguments.length?(f=t,u=t.copy(),h={x:0,y:0,k:1},C):f},i.rebind(C,O,"on")};var Vt,Yt,zt=[0,1/0];function Gt(){}function Xt(t,e,n){return this instanceof Xt?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof Xt?new Xt(t.h,t.s,t.l):he(""+t,de,Xt):new Xt(t,e,n)}i.color=Gt,Gt.prototype.toString=function(){return this.rgb()+""},i.hsl=Xt;var qt=Xt.prototype=new Gt;function Kt(t,e,n){var r,o;function i(t){return Math.round(255*function(t){return t>360?t-=360:t<0&&(t+=360),t<60?r+(o-r)*t/60:t<180?o:t<240?r+(o-r)*(240-t)/60:r}(t))}return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:e<0?0:e>1?1:e,r=2*(n=n<0?0:n>1?1:n)-(o=n<=.5?n*(1+e):n+e-n*e),new se(i(t+120),i(t),i(t-120))}function $t(t,e,n){return this instanceof $t?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof $t?new $t(t.h,t.c,t.l):re(t instanceof Jt?t.l:(t=pe((t=i.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new $t(t,e,n)}qt.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new Xt(this.h,this.s,this.l/t)},qt.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new Xt(this.h,this.s,t*this.l)},qt.rgb=function(){return Kt(this.h,this.s,this.l)},i.hcl=$t;var Qt=$t.prototype=new Gt;function Zt(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new Jt(n,Math.cos(t*=It)*e,Math.sin(t)*e)}function Jt(t,e,n){return this instanceof Jt?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof Jt?new Jt(t.l,t.a,t.b):t instanceof $t?Zt(t.h,t.c,t.l):pe((t=se(t)).r,t.g,t.b):new Jt(t,e,n)}Qt.brighter=function(t){return new $t(this.h,this.c,Math.min(100,this.l+te*(arguments.length?t:1)))},Qt.darker=function(t){return new $t(this.h,this.c,Math.max(0,this.l-te*(arguments.length?t:1)))},Qt.rgb=function(){return Zt(this.h,this.c,this.l).rgb()},i.lab=Jt;var te=18,ee=Jt.prototype=new Gt;function ne(t,e,n){var r=(t+16)/116,o=r+e/500,i=r-n/200;return new se(ae(3.2404542*(o=.95047*oe(o))-1.5371385*(r=1*oe(r))-.4985314*(i=1.08883*oe(i))),ae(-.969266*o+1.8760108*r+.041556*i),ae(.0556434*o-.2040259*r+1.0572252*i))}function re(t,e,n){return t>0?new $t(Math.atan2(n,e)*Dt,Math.sqrt(e*e+n*n),t):new $t(NaN,NaN,t)}function oe(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function ie(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function ae(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function se(t,e,n){return this instanceof se?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof se?new se(t.r,t.g,t.b):he(""+t,se,Kt):new se(t,e,n)}function le(t){return new se(t>>16,t>>8&255,255&t)}function ue(t){return le(t)+""}ee.brighter=function(t){return new Jt(Math.min(100,this.l+te*(arguments.length?t:1)),this.a,this.b)},ee.darker=function(t){return new Jt(Math.max(0,this.l-te*(arguments.length?t:1)),this.a,this.b)},ee.rgb=function(){return ne(this.l,this.a,this.b)},i.rgb=se;var ce=se.prototype=new Gt;function fe(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function he(t,e,n){var r,o,i,a=0,s=0,l=0;if(r=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(o=r[2].split(","),r[1]){case"hsl":return n(parseFloat(o[0]),parseFloat(o[1])/100,parseFloat(o[2])/100);case"rgb":return e(ve(o[0]),ve(o[1]),ve(o[2]))}return(i=ye.get(t))?e(i.r,i.g,i.b):(null==t||"#"!==t.charAt(0)||isNaN(i=parseInt(t.slice(1),16))||(4===t.length?(a=(3840&i)>>4,a|=a>>4,s=240&i,s|=s>>4,l=15&i,l|=l<<4):7===t.length&&(a=(16711680&i)>>16,s=(65280&i)>>8,l=255&i)),e(a,s,l))}function de(t,e,n){var r,o,i=Math.min(t/=255,e/=255,n/=255),a=Math.max(t,e,n),s=a-i,l=(a+i)/2;return s?(o=l<.5?s/(a+i):s/(2-a-i),r=t==a?(e-n)/s+(e<n?6:0):e==a?(n-t)/s+2:(t-e)/s+4,r*=60):(r=NaN,o=l>0&&l<1?0:r),new Xt(r,o,l)}function pe(t,e,n){var r=ie((.4124564*(t=ge(t))+.3575761*(e=ge(e))+.1804375*(n=ge(n)))/.95047),o=ie((.2126729*t+.7151522*e+.072175*n)/1);return Jt(116*o-16,500*(r-o),200*(o-ie((.0193339*t+.119192*e+.9503041*n)/1.08883)))}function ge(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ve(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}ce.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,r=this.b,o=30;return e||n||r?(e&&e<o&&(e=o),n&&n<o&&(n=o),r&&r<o&&(r=o),new se(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,r/t))):new se(o,o,o)},ce.darker=function(t){return new se((t=Math.pow(.7,arguments.length?t:1))*this.r,t*this.g,t*this.b)},ce.hsl=function(){return de(this.r,this.g,this.b)},ce.toString=function(){return"#"+fe(this.r)+fe(this.g)+fe(this.b)};var ye=i.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function me(t){return"function"==typeof t?t:function(){return t}}function be(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=null),we(e,n,t,r)}}function we(t,e,n,r){var o={},a=i.dispatch("beforesend","progress","load","error"),l={},u=new XMLHttpRequest,c=null;function f(){var t,e=u.status;if(!e&&function(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}(u)||e>=200&&e<300||304===e){try{t=n.call(o,u)}catch(t){return void a.error.call(o,t)}a.load.call(o,t)}else a.error.call(o,u)}return!this.XDomainRequest||"withCredentials"in u||!/^(http(s)?:)?\/\//.test(t)||(u=new XDomainRequest),"onload"in u?u.onload=u.onerror=f:u.onreadystatechange=function(){u.readyState>3&&f()},u.onprogress=function(t){var e=i.event;i.event=t;try{a.progress.call(o,u)}finally{i.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l[t]:(null==e?delete l[t]:l[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",o):e},o.responseType=function(t){return arguments.length?(c=t,o):c},o.response=function(t){return n=t,o},["get","post"].forEach((function(t){o[t]=function(){return o.send.apply(o,[t].concat(s(arguments)))}})),o.send=function(n,r,i){if(2===arguments.length&&"function"==typeof r&&(i=r,r=null),u.open(n,t,!0),null==e||"accept"in l||(l.accept=e+",*/*"),u.setRequestHeader)for(var s in l)u.setRequestHeader(s,l[s]);return null!=e&&u.overrideMimeType&&u.overrideMimeType(e),null!=c&&(u.responseType=c),null!=i&&o.on("error",i).on("load",(function(t){i(null,t)})),a.beforesend.call(o,u),u.send(null==r?null:r),o},o.abort=function(){return u.abort(),o},i.rebind(o,a,"on"),null==r?o:o.get(function(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}(r))}ye.forEach((function(t,e){ye.set(t,le(e))})),i.functor=me,i.xhr=be(I),i.dsv=function(t,e){var n=new RegExp('["'+t+"\n]"),r=t.charCodeAt(0);function o(t,n,r){arguments.length<3&&(r=n,n=null);var o=we(t,e,null==n?i:a(n),r);return o.row=function(t){return arguments.length?o.response(null==(n=t)?i:a(t)):n},o}function i(t){return o.parse(t.responseText)}function a(t){return function(e){return o.parse(e.responseText,t)}}function s(e){return e.map(l).join(t)}function l(t){return n.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}return o.parse=function(t,e){var n;return o.parseRows(t,(function(t,r){if(n)return n(t,r-1);var o=new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+"]"})).join(",")+"}");n=e?function(t,n){return e(o(t),n)}:o}))},o.parseRows=function(t,e){var n,o,i={},a={},s=[],l=t.length,u=0,c=0;function f(){if(u>=l)return a;if(o)return o=!1,i;var e=u;if(34===t.charCodeAt(e)){for(var n=e;n++<l;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}return u=n+2,13===(s=t.charCodeAt(n+1))?(o=!0,10===t.charCodeAt(n+2)&&++u):10===s&&(o=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;u<l;){var s,c=1;if(10===(s=t.charCodeAt(u++)))o=!0;else if(13===s)o=!0,10===t.charCodeAt(u)&&(++u,++c);else if(s!==r)continue;return t.slice(e,u-c)}return t.slice(e)}for(;(n=f())!==a;){for(var h=[];n!==i&&n!==a;)h.push(n),n=f();e&&null==(h=e(h,c++))||s.push(h)}return s},o.format=function(e){if(Array.isArray(e[0]))return o.formatRows(e);var n=new x,r=[];return e.forEach((function(t){for(var e in t)n.has(e)||r.push(n.add(e))})),[r.map(l).join(t)].concat(e.map((function(e){return r.map((function(t){return l(e[t])})).join(t)}))).join("\n")},o.formatRows=function(t){return t.map(s).join("\n")},o},i.csv=i.dsv(",","text/csv"),i.tsv=i.dsv("\t","text/tab-separated-values");var Oe,Ce,Ee,Se,ke=this[P(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};function Re(t,e,n){var r=arguments.length;r<2&&(e=0),r<3&&(n=Date.now());var o=n+e,i={c:t,t:o,n:null};return Ce?Ce.n=i:Oe=i,Ce=i,Ee||(Se=clearTimeout(Se),Ee=1,ke(_e)),i}function _e(){var t=Te(),e=Me()-t;e>24?(isFinite(e)&&(clearTimeout(Se),Se=setTimeout(_e,e)),Ee=0):(Ee=1,ke(_e))}function Te(){for(var t=Date.now(),e=Oe;e;)t>=e.t&&e.c(t-e.t)&&(e.c=null),e=e.n;return t}function Me(){for(var t,e=Oe,n=1/0;e;)e.c?(e.t<n&&(n=e.t),e=(t=e).n):e=t?t.n=e.n:Oe=e.n;return Ce=t,n}function Ae(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}i.timer=function(){Re.apply(this,arguments)},i.timer.flush=function(){Te(),Me()},i.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var Ne=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map((function(t,e){var n=Math.pow(10,3*C(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}));function je(t){var e=t.decimal,n=t.thousands,r=t.grouping,o=t.currency,a=r&&n?function(t,e){for(var o=t.length,i=[],a=0,s=r[0],l=0;o>0&&s>0&&(l+s+1>e&&(s=Math.max(1,e-l)),i.push(t.substring(o-=s,o+s)),!((l+=s+1)>e));)s=r[a=(a+1)%r.length];return i.reverse().join(n)}:I;return function(t){var n=xe.exec(t),r=n[1]||" ",s=n[2]||">",l=n[3]||"-",u=n[4]||"",c=n[5],f=+n[6],h=n[7],d=n[8],p=n[9],g=1,v="",y="",m=!1,b=!0;switch(d&&(d=+d.substring(1)),(c||"0"===r&&"="===s)&&(c=r="0",s="="),p){case"n":h=!0,p="g";break;case"%":g=100,y="%",p="f";break;case"p":g=100,y="%",p="r";break;case"b":case"o":case"x":case"X":"#"===u&&(v="0"+p.toLowerCase());case"c":b=!1;case"d":m=!0,d=0;break;case"s":g=-1,p="r"}"$"===u&&(v=o[0],y=o[1]),"r"!=p||d||(p="g"),null!=d&&("g"==p?d=Math.max(1,Math.min(21,d)):"e"!=p&&"f"!=p||(d=Math.max(0,Math.min(20,d)))),p=Ie.get(p)||De;var w=c&&h;return function(t){var n=y;if(m&&t%1)return"";var o=t<0||0===t&&1/t<0?(t=-t,"-"):"-"===l?"":l;if(g<0){var u=i.formatPrefix(t,d);t=u.scale(t),n=u.symbol+y}else t*=g;var O,C,E=(t=p(t,d)).lastIndexOf(".");if(E<0){var S=b?t.lastIndexOf("e"):-1;S<0?(O=t,C=""):(O=t.substring(0,S),C=t.substring(S))}else O=t.substring(0,E),C=e+t.substring(E+1);!c&&h&&(O=a(O,1/0));var k=v.length+O.length+C.length+(w?0:o.length),R=k<f?new Array(k=f-k+1).join(r):"";return w&&(O=a(R+O,R.length?f-C.length:1/0)),o+=v,t=O+C,("<"===s?o+t+R:">"===s?R+o+t:"^"===s?R.substring(0,k>>=1)+o+t+R.substring(k):o+(w?t:R+t))+n}}}i.formatPrefix=function(t,e){var n=0;return(t=+t)&&(t<0&&(t*=-1),e&&(t=i.round(t,Ae(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),Ne[8+n/3]};var xe=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Ie=i.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=i.round(t,Ae(t,e))).toFixed(Math.max(0,Math.min(20,Ae(t*(1+1e-15),e))))}});function De(t){return t+""}var Pe=i.time={},Le=Date;function He(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}He.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Fe.setUTCDate.apply(this._,arguments)},setDay:function(){Fe.setUTCDay.apply(this._,arguments)},setFullYear:function(){Fe.setUTCFullYear.apply(this._,arguments)},setHours:function(){Fe.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Fe.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Fe.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Fe.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Fe.setUTCSeconds.apply(this._,arguments)},setTime:function(){Fe.setTime.apply(this._,arguments)}};var Fe=Date.prototype;function Be(t,e,n){function r(e){var n=t(e),r=i(n,1);return e-n<r-e?n:r}function o(n){return e(n=t(new Le(n-1)),1),n}function i(t,n){return e(t=new Le(+t),n),t}function a(t,r,i){var a=o(t),s=[];if(i>1)for(;a<r;)n(a)%i||s.push(new Date(+a)),e(a,1);else for(;a<r;)s.push(new Date(+a)),e(a,1);return s}t.floor=t,t.round=r,t.ceil=o,t.offset=i,t.range=a;var s=t.utc=Ue(t);return s.floor=s,s.round=Ue(r),s.ceil=Ue(o),s.offset=Ue(i),s.range=function(t,e,n){try{Le=He;var r=new He;return r._=t,a(r,e,n)}finally{Le=Date}},t}function Ue(t){return function(e,n){try{Le=He;var r=new He;return r._=e,t(r,n)._}finally{Le=Date}}}function We(t){var e=t.dateTime,n=t.date,r=t.time,o=t.periods,a=t.days,s=t.shortDays,l=t.months,u=t.shortMonths;function c(t){var e=t.length;function n(n){for(var r,o,i,a=[],s=-1,l=0;++s<e;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(o=Ve[r=t.charAt(++s)])&&(r=t.charAt(++s)),(i=O[r])&&(r=i(n,null==o?"e"===r?" ":"0":o)),a.push(r),l=s+1);return a.push(t.slice(l,s)),a.join("")}return n.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(f(n,t,e,0)!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var r=null!=n.Z&&Le!==He,o=new(r?He:Le);return"j"in n?o.setFullYear(n.y,0,n.j):"W"in n||"U"in n?("w"in n||(n.w="W"in n?1:0),o.setFullYear(n.y,0,1),o.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(o.getDay()+5)%7:n.w+7*n.U-(o.getDay()+6)%7)):o.setFullYear(n.y,n.m,n.d),o.setHours(n.H+(n.Z/100|0),n.M+n.Z%100,n.S,n.L),r?o._:o},n.toString=function(){return t},n}function f(t,e,n,r){for(var o,i,a,s=0,l=e.length,u=n.length;s<l;){if(r>=u)return-1;if(37===(o=e.charCodeAt(s++))){if(a=e.charAt(s++),!(i=C[a in Ve?e.charAt(s++):a])||(r=i(t,n,r))<0)return-1}else if(o!=n.charCodeAt(r++))return-1}return r}c.utc=function(t){var e=c(t);function n(t){try{var n=new(Le=He);return n._=t,e(n)}finally{Le=Date}}return n.parse=function(t){try{Le=He;var n=e.parse(t);return n&&n._}finally{Le=Date}},n.toString=e.toString,n},c.multi=c.utc.multi=fn;var h=i.map(),d=Xe(a),p=qe(a),g=Xe(s),v=qe(s),y=Xe(l),m=qe(l),b=Xe(u),w=qe(u);o.forEach((function(t,e){h.set(t.toLowerCase(),e)}));var O={a:function(t){return s[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return l[t.getMonth()]},c:c(e),d:function(t,e){return Ge(t.getDate(),e,2)},e:function(t,e){return Ge(t.getDate(),e,2)},H:function(t,e){return Ge(t.getHours(),e,2)},I:function(t,e){return Ge(t.getHours()%12||12,e,2)},j:function(t,e){return Ge(1+Pe.dayOfYear(t),e,3)},L:function(t,e){return Ge(t.getMilliseconds(),e,3)},m:function(t,e){return Ge(t.getMonth()+1,e,2)},M:function(t,e){return Ge(t.getMinutes(),e,2)},p:function(t){return o[+(t.getHours()>=12)]},S:function(t,e){return Ge(t.getSeconds(),e,2)},U:function(t,e){return Ge(Pe.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Ge(Pe.mondayOfYear(t),e,2)},x:c(n),X:c(r),y:function(t,e){return Ge(t.getFullYear()%100,e,2)},Y:function(t,e){return Ge(t.getFullYear()%1e4,e,4)},Z:un,"%":function(){return"%"}},C={a:function(t,e,n){g.lastIndex=0;var r=g.exec(e.slice(n));return r?(t.w=v.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){d.lastIndex=0;var r=d.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){b.lastIndex=0;var r=b.exec(e.slice(n));return r?(t.m=w.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){y.lastIndex=0;var r=y.exec(e.slice(n));return r?(t.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,e,n){return f(t,O.c.toString(),e,n)},d:nn,e:nn,H:on,I:on,j:rn,L:ln,m:en,M:an,p:function(t,e,n){var r=h.get(e.slice(n,n+=2).toLowerCase());return null==r?-1:(t.p=r,n)},S:sn,U:$e,w:Ke,W:Qe,x:function(t,e,n){return f(t,O.x.toString(),e,n)},X:function(t,e,n){return f(t,O.X.toString(),e,n)},y:Je,Y:Ze,Z:tn,"%":cn};return c}Pe.year=Be((function(t){return(t=Pe.day(t)).setMonth(0,1),t}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t){return t.getFullYear()})),Pe.years=Pe.year.range,Pe.years.utc=Pe.year.utc.range,Pe.day=Be((function(t){var e=new Le(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t){return t.getDate()-1})),Pe.days=Pe.day.range,Pe.days.utc=Pe.day.utc.range,Pe.dayOfYear=function(t){var e=Pe.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach((function(t,e){e=7-e;var n=Pe[t]=Be((function(t){return(t=Pe.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t}),(function(t,e){t.setDate(t.getDate()+7*Math.floor(e))}),(function(t){var n=Pe.year(t).getDay();return Math.floor((Pe.dayOfYear(t)+(n+e)%7)/7)-(n!==e)}));Pe[t+"s"]=n.range,Pe[t+"s"].utc=n.utc.range,Pe[t+"OfYear"]=function(t){var n=Pe.year(t).getDay();return Math.floor((Pe.dayOfYear(t)+(n+e)%7)/7)}})),Pe.week=Pe.sunday,Pe.weeks=Pe.sunday.range,Pe.weeks.utc=Pe.sunday.utc.range,Pe.weekOfYear=Pe.sundayOfYear;var Ve={"-":"",_:" ",0:"0"},Ye=/^\s*\d+/,ze=/^%/;function Ge(t,e,n){var r=t<0?"-":"",o=(r?-t:t)+"",i=o.length;return r+(i<n?new Array(n-i+1).join(e)+o:o)}function Xe(t){return new RegExp("^(?:"+t.map(i.requote).join("|")+")","i")}function qe(t){for(var e=new k,n=-1,r=t.length;++n<r;)e.set(t[n].toLowerCase(),n);return e}function Ke(t,e,n){Ye.lastIndex=0;var r=Ye.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function $e(t,e,n){Ye.lastIndex=0;var r=Ye.exec(e.slice(n));return r?(t.U=+r[0],n+r[0].length):-1}function Qe(t,e,n){Ye.lastIndex=0;var r=Ye.exec(e.slice(n));return r?(t.W=+r[0],n+r[0].length):-1}function Ze(t,e,n){Ye.lastIndex=0;var r=Ye.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Je(t,e,n){Ye.lastIndex=0;var r,o=Ye.exec(e.slice(n,n+2));return o?(t.y=(r=+o[0])+(r>68?1900:2e3),n+o[0].length):-1}function tn(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function en(t,e,n){Ye.lastIndex=0;var r=Ye.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function nn(t,e,n){Ye.lastIndex=0;var r=Ye.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function rn(t,e,n){Ye.lastIndex=0;var r=Ye.exec(e.slice(n,n+3));return r?(t.j=+r[0],n+r[0].length):-1}function on(t,e,n){Ye.lastIndex=0;var r=Ye.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function an(t,e,n){Ye.lastIndex=0;var r=Ye.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function sn(t,e,n){Ye.lastIndex=0;var r=Ye.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function ln(t,e,n){Ye.lastIndex=0;var r=Ye.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function un(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",r=C(e)/60|0,o=C(e)%60;return n+Ge(r,"0",2)+Ge(o,"0",2)}function cn(t,e,n){ze.lastIndex=0;var r=ze.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function fn(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,r=t[n];!r[1](e);)r=t[++n];return r[0](e)}}i.locale=function(t){return{numberFormat:je(t),timeFormat:We(t)}};var hn=i.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function dn(){}i.format=hn.numberFormat,i.geo={},dn.prototype={s:0,t:0,add:function(t){gn(t,this.t,pn),gn(pn.s,this.s,this),this.s?this.t+=pn.t:this.s=pn.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var pn=new dn;function gn(t,e,n){var r=n.s=t+e,o=r-t,i=r-o;n.t=t-i+(e-o)}function vn(t,e){t&&mn.hasOwnProperty(t.type)&&mn[t.type](t,e)}i.geo.stream=function(t,e){t&&yn.hasOwnProperty(t.type)?yn[t.type](t,e):vn(t,e)};var yn={Feature:function(t,e){vn(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,o=n.length;++r<o;)vn(n[r].geometry,e)}},mn={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){bn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)bn(n[r],e,0)},Polygon:function(t,e){wn(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,o=n.length;++r<o;)wn(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,o=n.length;++r<o;)vn(n[r],e)}};function bn(t,e,n){var r,o=-1,i=t.length-n;for(e.lineStart();++o<i;)r=t[o],e.point(r[0],r[1],r[2]);e.lineEnd()}function wn(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)bn(t[n],e,1);e.polygonEnd()}i.geo.area=function(t){return On=0,i.geo.stream(t,In),On};var On,Cn,En,Sn,kn,Rn,_n,Tn,Mn,An,Nn,jn,xn=new dn,In={sphere:function(){On+=4*At},point:H,lineStart:H,lineEnd:H,polygonStart:function(){xn.reset(),In.lineStart=Dn},polygonEnd:function(){var t=2*xn;On+=t<0?4*At+t:t,In.lineStart=In.lineEnd=In.point=H}};function Dn(){var t,e,n,r,o;function i(t,e){e=e*It/2+At/4;var i=(t*=It)-n,a=i>=0?1:-1,s=a*i,l=Math.cos(e),u=Math.sin(e),c=o*u,f=r*l+c*Math.cos(s),h=c*a*Math.sin(s);xn.add(Math.atan2(h,f)),n=t,r=l,o=u}In.point=function(a,s){In.point=i,n=(t=a)*It,r=Math.cos(s=(e=s)*It/2+At/4),o=Math.sin(s)},In.lineEnd=function(){i(t,e)}}function Pn(t){var e=t[0],n=t[1],r=Math.cos(n);return[r*Math.cos(e),r*Math.sin(e),Math.sin(n)]}function Ln(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Hn(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Fn(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Bn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Un(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Wn(t){return[Math.atan2(t[1],t[0]),Ft(t[2])]}function Vn(t,e){return C(t[0]-e[0])<Tt&&C(t[1]-e[1])<Tt}i.geo.bounds=function(){var t,e,n,r,o,a,s,l,u,c,f,h={point:d,lineStart:g,lineEnd:v,polygonStart:function(){h.point=y,h.lineStart=m,h.lineEnd=b,u=0,In.polygonStart()},polygonEnd:function(){In.polygonEnd(),h.point=d,h.lineStart=g,h.lineEnd=v,xn<0?(t=-(n=180),e=-(r=90)):u>Tt?r=90:u<-Tt&&(e=-90),f[0]=t,f[1]=n}};function d(o,i){c.push(f=[t=o,n=o]),i<e&&(e=i),i>r&&(r=i)}function p(i,a){var s=Pn([i*It,a*It]);if(l){var u=Hn(l,s),c=Hn([u[1],-u[0],0],u);Un(c),c=Wn(c);var f=i-o,h=f>0?1:-1,p=c[0]*Dt*h,g=C(f)>180;if(g^(h*o<p&&p<h*i))(v=c[1]*Dt)>r&&(r=v);else if(g^(h*o<(p=(p+360)%360-180)&&p<h*i)){var v;(v=-c[1]*Dt)<e&&(e=v)}else a<e&&(e=a),a>r&&(r=a);g?i<o?w(t,i)>w(t,n)&&(n=i):w(i,n)>w(t,n)&&(t=i):n>=t?(i<t&&(t=i),i>n&&(n=i)):i>o?w(t,i)>w(t,n)&&(n=i):w(i,n)>w(t,n)&&(t=i)}else d(i,a);l=s,o=i}function g(){h.point=p}function v(){f[0]=t,f[1]=n,h.point=d,l=null}function y(t,e){if(l){var n=t-o;u+=C(n)>180?n+(n>0?360:-360):n}else a=t,s=e;In.point(t,e),p(t,e)}function m(){In.lineStart()}function b(){y(a,s),In.lineEnd(),C(u)>Tt&&(t=-(n=180)),f[0]=t,f[1]=n,l=null}function w(t,e){return(e-=t)<0?e+360:e}function O(t,e){return t[0]-e[0]}function E(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}return function(o){if(r=n=-(t=e=1/0),c=[],i.geo.stream(o,h),u=c.length){c.sort(O);for(var a=1,s=[g=c[0]];a<u;++a)E((d=c[a])[0],g)||E(d[1],g)?(w(g[0],d[1])>w(g[0],g[1])&&(g[1]=d[1]),w(d[0],g[1])>w(g[0],g[1])&&(g[0]=d[0])):s.push(g=d);for(var l,u,d,p=-1/0,g=(a=0,s[u=s.length-1]);a<=u;g=d,++a)d=s[a],(l=w(g[1],d[0]))>p&&(p=l,t=d[0],n=g[1])}return c=f=null,t===1/0||e===1/0?[[NaN,NaN],[NaN,NaN]]:[[t,e],[n,r]]}}(),i.geo.centroid=function(t){Cn=En=Sn=kn=Rn=_n=Tn=Mn=An=Nn=jn=0,i.geo.stream(t,Yn);var e=An,n=Nn,r=jn,o=e*e+n*n+r*r;return o<Mt&&(e=_n,n=Tn,r=Mn,En<Tt&&(e=Sn,n=kn,r=Rn),(o=e*e+n*n+r*r)<Mt)?[NaN,NaN]:[Math.atan2(n,e)*Dt,Ft(r/Math.sqrt(o))*Dt]};var Yn={sphere:H,point:zn,lineStart:Xn,lineEnd:qn,polygonStart:function(){Yn.lineStart=Kn},polygonEnd:function(){Yn.lineStart=Xn}};function zn(t,e){t*=It;var n=Math.cos(e*=It);Gn(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function Gn(t,e,n){++Cn,Sn+=(t-Sn)/Cn,kn+=(e-kn)/Cn,Rn+=(n-Rn)/Cn}function Xn(){var t,e,n;function r(r,o){r*=It;var i=Math.cos(o*=It),a=i*Math.cos(r),s=i*Math.sin(r),l=Math.sin(o),u=Math.atan2(Math.sqrt((u=e*l-n*s)*u+(u=n*a-t*l)*u+(u=t*s-e*a)*u),t*a+e*s+n*l);En+=u,_n+=u*(t+(t=a)),Tn+=u*(e+(e=s)),Mn+=u*(n+(n=l)),Gn(t,e,n)}Yn.point=function(o,i){o*=It;var a=Math.cos(i*=It);t=a*Math.cos(o),e=a*Math.sin(o),n=Math.sin(i),Yn.point=r,Gn(t,e,n)}}function qn(){Yn.point=zn}function Kn(){var t,e,n,r,o;function i(t,e){t*=It;var i=Math.cos(e*=It),a=i*Math.cos(t),s=i*Math.sin(t),l=Math.sin(e),u=r*l-o*s,c=o*a-n*l,f=n*s-r*a,h=Math.sqrt(u*u+c*c+f*f),d=n*a+r*s+o*l,p=h&&-Ht(d)/h,g=Math.atan2(h,d);An+=p*u,Nn+=p*c,jn+=p*f,En+=g,_n+=g*(n+(n=a)),Tn+=g*(r+(r=s)),Mn+=g*(o+(o=l)),Gn(n,r,o)}Yn.point=function(a,s){t=a,e=s,Yn.point=i,a*=It;var l=Math.cos(s*=It);n=l*Math.cos(a),r=l*Math.sin(a),o=Math.sin(s),Gn(n,r,o)},Yn.lineEnd=function(){i(t,e),Yn.lineEnd=qn,Yn.point=zn}}function $n(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function Qn(){return!0}function Zn(t,e,n,r,o){var i=[],a=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],r=t[e];if(Vn(n,r)){o.lineStart();for(var s=0;s<e;++s)o.point((n=t[s])[0],n[1]);o.lineEnd()}else{var l=new tr(n,t,null,!0),u=new tr(n,null,l,!1);l.o=u,i.push(l),a.push(u),l=new tr(r,t,null,!1),u=new tr(r,null,l,!0),l.o=u,i.push(l),a.push(u)}}})),a.sort(e),Jn(i),Jn(a),i.length){for(var s=0,l=n,u=a.length;s<u;++s)a[s].e=l=!l;for(var c,f,h=i[0];;){for(var d=h,p=!0;d.v;)if((d=d.n)===h)return;c=d.z,o.lineStart();do{if(d.v=d.o.v=!0,d.e){if(p)for(s=0,u=c.length;s<u;++s)o.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,o);d=d.n}else{if(p)for(s=(c=d.p.z).length-1;s>=0;--s)o.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,o);d=d.p}c=(d=d.o).z,p=!p}while(!d.v);o.lineEnd()}}}function Jn(t){if(e=t.length){for(var e,n,r=0,o=t[0];++r<e;)o.n=n=t[r],n.p=o,o=n;o.n=n=t[0],n.p=o}}function tr(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function er(t,e,n,r){return function(o,a){var s,l=e(a),u=o.invert(r[0],r[1]),c={point:f,lineStart:d,lineEnd:p,polygonStart:function(){c.point=w,c.lineStart=O,c.lineEnd=C,s=[],g=[]},polygonEnd:function(){c.point=f,c.lineStart=d,c.lineEnd=p,s=i.merge(s);var t=function(t,e){var n=t[0],r=t[1],o=[Math.sin(n),-Math.cos(n),0],i=0,a=0;xn.reset();for(var s=0,l=e.length;s<l;++s){var u=e[s],c=u.length;if(c)for(var f=u[0],h=f[0],d=f[1]/2+At/4,p=Math.sin(d),g=Math.cos(d),v=1;;){v===c&&(v=0);var y=(t=u[v])[0],m=t[1]/2+At/4,b=Math.sin(m),w=Math.cos(m),O=y-h,C=O>=0?1:-1,E=C*O,S=E>At,k=p*b;if(xn.add(Math.atan2(k*C*Math.sin(E),g*w+k*Math.cos(E))),i+=S?O+C*Nt:O,S^h>=n^y>=n){var R=Hn(Pn(f),Pn(t));Un(R);var _=Hn(o,R);Un(_);var T=(S^O>=0?-1:1)*Ft(_[2]);(r>T||r===T&&(R[0]||R[1]))&&(a+=S^O>=0?1:-1)}if(!v++)break;h=y,p=b,g=w,f=t}}return(i<-Tt||i<Tt&&xn<-Tt)^1&a}(u,g);s.length?(b||(a.polygonStart(),b=!0),Zn(s,or,t,n,a)):t&&(b||(a.polygonStart(),b=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),b&&(a.polygonEnd(),b=!1),s=g=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function f(e,n){var r=o(e,n);t(e=r[0],n=r[1])&&a.point(e,n)}function h(t,e){var n=o(t,e);l.point(n[0],n[1])}function d(){c.point=h,l.lineStart()}function p(){c.point=f,l.lineEnd()}var g,v,y=rr(),m=e(y),b=!1;function w(t,e){v.push([t,e]);var n=o(t,e);m.point(n[0],n[1])}function O(){m.lineStart(),v=[]}function C(){w(v[0][0],v[0][1]),m.lineEnd();var t,e=m.clean(),n=y.buffer(),r=n.length;if(v.pop(),g.push(v),v=null,r)if(1&e){var o,i=-1;if((r=(t=n[0]).length-1)>0){for(b||(a.polygonStart(),b=!0),a.lineStart();++i<r;)a.point((o=t[i])[0],o[1]);a.lineEnd()}}else r>1&&2&e&&n.push(n.pop().concat(n.shift())),s.push(n.filter(nr))}return c}}function nr(t){return t.length>1}function rr(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:H,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function or(t,e){return((t=t.x)[0]<0?t[1]-xt-Tt:xt-t[1])-((e=e.x)[0]<0?e[1]-xt-Tt:xt-e[1])}var ir=er(Qn,(function(t){var e,n=NaN,r=NaN,o=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(i,a){var s=i>0?At:-At,l=C(i-n);C(l-At)<Tt?(t.point(n,r=(r+a)/2>0?xt:-xt),t.point(o,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(i,r),e=0):o!==s&&l>=At&&(C(n-o)<Tt&&(n-=o*Tt),C(i-s)<Tt&&(i-=s*Tt),r=function(t,e,n,r){var o,i,a=Math.sin(t-n);return C(a)>Tt?Math.atan((Math.sin(e)*(i=Math.cos(r))*Math.sin(n)-Math.sin(r)*(o=Math.cos(e))*Math.sin(t))/(o*i*a)):(e+r)/2}(n,r,i,a),t.point(o,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=i,r=a),o=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var o;if(null==t)o=n*xt,r.point(-At,o),r.point(0,o),r.point(At,o),r.point(At,0),r.point(At,-o),r.point(0,-o),r.point(-At,-o),r.point(-At,0),r.point(-At,o);else if(C(t[0]-e[0])>Tt){var i=t[0]<e[0]?At:-At;o=n*i/2,r.point(-i,o),r.point(0,o),r.point(i,o)}else r.point(e[0],e[1])}),[-At,-At/2]);function ar(t){var e=Math.cos(t),n=e>0,r=C(e)>Tt;return er(o,(function(t){var e,s,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(f,h){var d,p=[f,h],g=o(f,h),v=n?g?0:a(f,h):g?a(f+(f<0?At:-At),h):0;if(!e&&(u=l=g)&&t.lineStart(),g!==l&&(d=i(e,p),(Vn(e,d)||Vn(p,d))&&(p[0]+=Tt,p[1]+=Tt,g=o(p[0],p[1]))),g!==l)c=0,g?(t.lineStart(),d=i(p,e),t.point(d[0],d[1])):(d=i(e,p),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(r&&e&&n^g){var y;v&s||!(y=i(p,e,!0))||(c=0,n?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!g||e&&Vn(e,p)||t.point(p[0],p[1]),e=p,l=g,s=v},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),Wr(t,6*It),n?[0,-t]:[-At,t-At]);function o(t,n){return Math.cos(t)*Math.cos(n)>e}function i(t,n,r){var o=[1,0,0],i=Hn(Pn(t),Pn(n)),a=Ln(i,i),s=i[0],l=a-s*s;if(!l)return!r&&t;var u=e*a/l,c=-e*s/l,f=Hn(o,i),h=Bn(o,u);Fn(h,Bn(i,c));var d=f,p=Ln(h,d),g=Ln(d,d),v=p*p-g*(Ln(h,h)-1);if(!(v<0)){var y=Math.sqrt(v),m=Bn(d,(-p-y)/g);if(Fn(m,h),m=Wn(m),!r)return m;var b,w=t[0],O=n[0],E=t[1],S=n[1];O<w&&(b=w,w=O,O=b);var k=O-w,R=C(k-At)<Tt;if(!R&&S<E&&(b=E,E=S,S=b),R||k<Tt?R?E+S>0^m[1]<(C(m[0]-w)<Tt?E:S):E<=m[1]&&m[1]<=S:k>At^(w<=m[0]&&m[0]<=O)){var _=Bn(d,(-p+y)/g);return Fn(_,h),[m,Wn(_)]}}}function a(e,r){var o=n?t:At-t,i=0;return e<-o?i|=1:e>o&&(i|=2),r<-o?i|=4:r>o&&(i|=8),i}}function sr(t,e,n,r){return function(o){var i,a=o.a,s=o.b,l=a.x,u=a.y,c=0,f=1,h=s.x-l,d=s.y-u;if(i=t-l,h||!(i>0)){if(i/=h,h<0){if(i<c)return;i<f&&(f=i)}else if(h>0){if(i>f)return;i>c&&(c=i)}if(i=n-l,h||!(i<0)){if(i/=h,h<0){if(i>f)return;i>c&&(c=i)}else if(h>0){if(i<c)return;i<f&&(f=i)}if(i=e-u,d||!(i>0)){if(i/=d,d<0){if(i<c)return;i<f&&(f=i)}else if(d>0){if(i>f)return;i>c&&(c=i)}if(i=r-u,d||!(i<0)){if(i/=d,d<0){if(i>f)return;i>c&&(c=i)}else if(d>0){if(i<c)return;i<f&&(f=i)}return c>0&&(o.a={x:l+c*h,y:u+c*d}),f<1&&(o.b={x:l+f*h,y:u+f*d}),o}}}}}}function lr(t,e,n,r){return function(l){var u,c,f,h,d,p,g,v,y,m,b,w=l,O=rr(),C=sr(t,e,n,r),E={point:R,lineStart:function(){E.point=_,c&&c.push(f=[]);m=!0,y=!1,g=v=NaN},lineEnd:function(){u&&(_(h,d),p&&y&&O.rejoin(),u.push(O.buffer()));E.point=R,y&&l.lineEnd()},polygonStart:function(){l=O,u=[],c=[],b=!0},polygonEnd:function(){l=w,u=i.merge(u);var e=function(t){for(var e=0,n=c.length,r=t[1],o=0;o<n;++o)for(var i,a=1,s=c[o],l=s.length,u=s[0];a<l;++a)i=s[a],u[1]<=r?i[1]>r&&Lt(u,i,t)>0&&++e:i[1]<=r&&Lt(u,i,t)<0&&--e,u=i;return 0!==e}([t,r]),n=b&&e,o=u.length;(n||o)&&(l.polygonStart(),n&&(l.lineStart(),S(null,null,1,l),l.lineEnd()),o&&Zn(u,a,e,S,l),l.polygonEnd()),u=c=f=null}};function S(i,a,l,u){var c=0,f=0;if(null==i||(c=o(i,l))!==(f=o(a,l))||s(i,a)<0^l>0)do{u.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+l+4)%4)!==f);else u.point(a[0],a[1])}function k(o,i){return t<=o&&o<=n&&e<=i&&i<=r}function R(t,e){k(t,e)&&l.point(t,e)}function _(t,e){var n=k(t=Math.max(-1e9,Math.min(1e9,t)),e=Math.max(-1e9,Math.min(1e9,e)));if(c&&f.push([t,e]),m)h=t,d=e,p=n,m=!1,n&&(l.lineStart(),l.point(t,e));else if(n&&y)l.point(t,e);else{var r={a:{x:g,y:v},b:{x:t,y:e}};C(r)?(y||(l.lineStart(),l.point(r.a.x,r.a.y)),l.point(r.b.x,r.b.y),n||l.lineEnd(),b=!1):n&&(l.lineStart(),l.point(t,e),b=!1)}g=t,v=e,y=n}return E};function o(r,o){return C(r[0]-t)<Tt?o>0?0:3:C(r[0]-n)<Tt?o>0?2:1:C(r[1]-e)<Tt?o>0?1:0:o>0?3:2}function a(t,e){return s(t.x,e.x)}function s(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}}function ur(t){var e=0,n=At/3,r=Ir(t),o=r(e,n);return o.parallels=function(t){return arguments.length?r(e=t[0]*At/180,n=t[1]*At/180):[e/At*180,n/At*180]},o}function cr(t,e){var n=Math.sin(t),r=(n+Math.sin(e))/2,o=1+n*(2*r-n),i=Math.sqrt(o)/r;function a(t,e){var n=Math.sqrt(o-2*r*Math.sin(e))/r;return[n*Math.sin(t*=r),i-n*Math.cos(t)]}return a.invert=function(t,e){var n=i-e;return[Math.atan2(t,n)/r,Ft((o-(t*t+n*n)*r*r)/(2*r))]},a}i.geo.clipExtent=function(){var t,e,n,r,o,i,a={stream:function(t){return o&&(o.valid=!1),(o=i(t)).valid=!0,o},extent:function(s){return arguments.length?(i=lr(t=+s[0][0],e=+s[0][1],n=+s[1][0],r=+s[1][1]),o&&(o.valid=!1,o=null),a):[[t,e],[n,r]]}};return a.extent([[0,0],[960,500]])},(i.geo.conicEqualArea=function(){return ur(cr)}).raw=cr,i.geo.albers=function(){return i.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},i.geo.albersUsa=function(){var t,e,n,r,o=i.geo.albers(),a=i.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=i.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,n){t=[e,n]}};function u(o){var i=o[0],a=o[1];return t=null,e(i,a),t||(n(i,a),t)||r(i,a),t}return u.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?a:i>=.166&&i<.234&&r>=-.214&&r<-.115?s:o).invert(t)},u.stream=function(t){var e=o.stream(t),n=a.stream(t),r=s.stream(t);return{point:function(t,o){e.point(t,o),n.point(t,o),r.point(t,o)},sphere:function(){e.sphere(),n.sphere(),r.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),r.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),r.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),r.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),r.polygonEnd()}}},u.precision=function(t){return arguments.length?(o.precision(t),a.precision(t),s.precision(t),u):o.precision()},u.scale=function(t){return arguments.length?(o.scale(t),a.scale(.35*t),s.scale(t),u.translate(o.translate())):o.scale()},u.translate=function(t){if(!arguments.length)return o.translate();var i=o.scale(),c=+t[0],f=+t[1];return e=o.translate(t).clipExtent([[c-.455*i,f-.238*i],[c+.455*i,f+.238*i]]).stream(l).point,n=a.translate([c-.307*i,f+.201*i]).clipExtent([[c-.425*i+Tt,f+.12*i+Tt],[c-.214*i-Tt,f+.234*i-Tt]]).stream(l).point,r=s.translate([c-.205*i,f+.212*i]).clipExtent([[c-.214*i+Tt,f+.166*i+Tt],[c-.115*i-Tt,f+.234*i-Tt]]).stream(l).point,u},u.scale(1070)};var fr,hr,dr,pr,gr,vr,yr={point:H,lineStart:H,lineEnd:H,polygonStart:function(){hr=0,yr.lineStart=mr},polygonEnd:function(){yr.lineStart=yr.lineEnd=yr.point=H,fr+=C(hr/2)}};function mr(){var t,e,n,r;function o(t,e){hr+=r*t-n*e,n=t,r=e}yr.point=function(i,a){yr.point=o,t=n=i,e=r=a},yr.lineEnd=function(){o(t,e)}}var br={point:function(t,e){t<dr&&(dr=t);t>gr&&(gr=t);e<pr&&(pr=e);e>vr&&(vr=e)},lineStart:H,lineEnd:H,polygonStart:H,polygonEnd:H};function wr(){var t=Or(4.5),e=[],n={point:r,lineStart:function(){n.point=o},lineEnd:a,polygonStart:function(){n.lineEnd=s},polygonEnd:function(){n.lineEnd=a,n.point=r},pointRadius:function(e){return t=Or(e),n},result:function(){if(e.length){var t=e.join("");return e=[],t}}};function r(n,r){e.push("M",n,",",r,t)}function o(t,r){e.push("M",t,",",r),n.point=i}function i(t,n){e.push("L",t,",",n)}function a(){n.point=r}function s(){e.push("Z")}return n}function Or(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}var Cr,Er={point:Sr,lineStart:kr,lineEnd:Rr,polygonStart:function(){Er.lineStart=_r},polygonEnd:function(){Er.point=Sr,Er.lineStart=kr,Er.lineEnd=Rr}};function Sr(t,e){Sn+=t,kn+=e,++Rn}function kr(){var t,e;function n(n,r){var o=n-t,i=r-e,a=Math.sqrt(o*o+i*i);_n+=a*(t+n)/2,Tn+=a*(e+r)/2,Mn+=a,Sr(t=n,e=r)}Er.point=function(r,o){Er.point=n,Sr(t=r,e=o)}}function Rr(){Er.point=Sr}function _r(){var t,e,n,r;function o(t,e){var o=t-n,i=e-r,a=Math.sqrt(o*o+i*i);_n+=a*(n+t)/2,Tn+=a*(r+e)/2,Mn+=a,An+=(a=r*t-n*e)*(n+t),Nn+=a*(r+e),jn+=3*a,Sr(n=t,r=e)}Er.point=function(i,a){Er.point=o,Sr(t=n=i,e=r=a)},Er.lineEnd=function(){o(t,e)}}function Tr(t){var e=4.5,n={point:r,lineStart:function(){n.point=o},lineEnd:a,polygonStart:function(){n.lineEnd=s},polygonEnd:function(){n.lineEnd=a,n.point=r},pointRadius:function(t){return e=t,n},result:H};function r(n,r){t.moveTo(n+e,r),t.arc(n,r,e,0,Nt)}function o(e,r){t.moveTo(e,r),n.point=i}function i(e,n){t.lineTo(e,n)}function a(){n.point=r}function s(){t.closePath()}return n}function Mr(t){var e=.5,n=Math.cos(30*It),r=16;function o(t){return(r?a:i)(t)}function i(e){return jr(e,(function(n,r){n=t(n,r),e.point(n[0],n[1])}))}function a(e){var n,o,i,a,l,u,c,f,h,d,p,g,v={point:y,lineStart:m,lineEnd:w,polygonStart:function(){e.polygonStart(),v.lineStart=O},polygonEnd:function(){e.polygonEnd(),v.lineStart=m}};function y(n,r){n=t(n,r),e.point(n[0],n[1])}function m(){f=NaN,v.point=b,e.lineStart()}function b(n,o){var i=Pn([n,o]),a=t(n,o);s(f,h,c,d,p,g,f=a[0],h=a[1],c=n,d=i[0],p=i[1],g=i[2],r,e),e.point(f,h)}function w(){v.point=y,e.lineEnd()}function O(){m(),v.point=C,v.lineEnd=E}function C(t,e){b(n=t,e),o=f,i=h,a=d,l=p,u=g,v.point=b}function E(){s(f,h,c,d,p,g,o,i,n,a,l,u,r,e),v.lineEnd=w,w()}return v}function s(r,o,i,a,l,u,c,f,h,d,p,g,v,y){var m=c-r,b=f-o,w=m*m+b*b;if(w>4*e&&v--){var O=a+d,E=l+p,S=u+g,k=Math.sqrt(O*O+E*E+S*S),R=Math.asin(S/=k),_=C(C(S)-1)<Tt||C(i-h)<Tt?(i+h)/2:Math.atan2(E,O),T=t(_,R),M=T[0],A=T[1],N=M-r,j=A-o,x=b*N-m*j;(x*x/w>e||C((m*N+b*j)/w-.5)>.3||a*d+l*p+u*g<n)&&(s(r,o,i,a,l,u,M,A,_,O/=k,E/=k,S,v,y),y.point(M,A),s(M,A,_,O,E,S,c,f,h,d,p,g,v,y))}}return o.precision=function(t){return arguments.length?(r=(e=t*t)>0&&16,o):Math.sqrt(e)},o}function Ar(t){var e=Mr((function(e,n){return t([e*Dt,n*Dt])}));return function(t){return Dr(e(t))}}function Nr(t){this.stream=t}function jr(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function xr(t){return Ir((function(){return t}))()}function Ir(t){var e,n,r,o,a,s,l=Mr((function(t,n){return[(t=e(t,n))[0]*u+o,a-t[1]*u]})),u=150,c=480,f=250,h=0,d=0,p=0,g=0,v=0,y=ir,m=I,b=null,w=null;function O(t){return[(t=r(t[0]*It,t[1]*It))[0]*u+o,a-t[1]*u]}function C(t){return(t=r.invert((t[0]-o)/u,(a-t[1])/u))&&[t[0]*Dt,t[1]*Dt]}function E(){r=$n(n=Hr(p,g,v),e);var t=e(h,d);return o=c-t[0]*u,a=f+t[1]*u,S()}function S(){return s&&(s.valid=!1,s=null),O}return O.stream=function(t){return s&&(s.valid=!1),(s=Dr(y(n,l(m(t))))).valid=!0,s},O.clipAngle=function(t){return arguments.length?(y=null==t?(b=t,ir):ar((b=+t)*It),S()):b},O.clipExtent=function(t){return arguments.length?(w=t,m=t?lr(t[0][0],t[0][1],t[1][0],t[1][1]):I,S()):w},O.scale=function(t){return arguments.length?(u=+t,E()):u},O.translate=function(t){return arguments.length?(c=+t[0],f=+t[1],E()):[c,f]},O.center=function(t){return arguments.length?(h=t[0]%360*It,d=t[1]%360*It,E()):[h*Dt,d*Dt]},O.rotate=function(t){return arguments.length?(p=t[0]%360*It,g=t[1]%360*It,v=t.length>2?t[2]%360*It:0,E()):[p*Dt,g*Dt,v*Dt]},i.rebind(O,l,"precision"),function(){return e=t.apply(this,arguments),O.invert=e.invert&&C,E()}}function Dr(t){return jr(t,(function(e,n){t.point(e*It,n*It)}))}function Pr(t,e){return[t,e]}function Lr(t,e){return[t>At?t-Nt:t<-At?t+Nt:t,e]}function Hr(t,e,n){return t?e||n?$n(Br(t),Ur(e,n)):Br(t):e||n?Ur(e,n):Lr}function Fr(t){return function(e,n){return[(e+=t)>At?e-Nt:e<-At?e+Nt:e,n]}}function Br(t){var e=Fr(t);return e.invert=Fr(-t),e}function Ur(t,e){var n=Math.cos(t),r=Math.sin(t),o=Math.cos(e),i=Math.sin(e);function a(t,e){var a=Math.cos(e),s=Math.cos(t)*a,l=Math.sin(t)*a,u=Math.sin(e),c=u*n+s*r;return[Math.atan2(l*o-c*i,s*n-u*r),Ft(c*o+l*i)]}return a.invert=function(t,e){var a=Math.cos(e),s=Math.cos(t)*a,l=Math.sin(t)*a,u=Math.sin(e),c=u*o-l*i;return[Math.atan2(l*o+u*i,s*n+c*r),Ft(c*n-s*r)]},a}function Wr(t,e){var n=Math.cos(t),r=Math.sin(t);return function(o,i,a,s){var l=a*e;null!=o?(o=Vr(n,o),i=Vr(n,i),(a>0?o<i:o>i)&&(o+=a*Nt)):(o=t+a*Nt,i=t-.5*l);for(var u,c=o;a>0?c>i:c<i;c-=l)s.point((u=Wn([n,-r*Math.cos(c),-r*Math.sin(c)]))[0],u[1])}}function Vr(t,e){var n=Pn(e);n[0]-=t,Un(n);var r=Ht(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-Tt)%(2*Math.PI)}function Yr(t,e,n){var r=i.range(t,e-Tt,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function zr(t,e,n){var r=i.range(t,e-Tt,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function Gr(t){return t.source}function Xr(t){return t.target}i.geo.path=function(){var t,e,n,r,o,a=4.5;function s(t){return t&&("function"==typeof a&&r.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=n(r)),i.geo.stream(t,o)),r.result()}function l(){return o=null,s}return s.area=function(t){return fr=0,i.geo.stream(t,n(yr)),fr},s.centroid=function(t){return Sn=kn=Rn=_n=Tn=Mn=An=Nn=jn=0,i.geo.stream(t,n(Er)),jn?[An/jn,Nn/jn]:Mn?[_n/Mn,Tn/Mn]:Rn?[Sn/Rn,kn/Rn]:[NaN,NaN]},s.bounds=function(t){return gr=vr=-(dr=pr=1/0),i.geo.stream(t,n(br)),[[dr,pr],[gr,vr]]},s.projection=function(e){return arguments.length?(n=(t=e)?e.stream||Ar(e):I,l()):t},s.context=function(t){return arguments.length?(r=null==(e=t)?new wr:new Tr(t),"function"!=typeof a&&r.pointRadius(a),l()):e},s.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(r.pointRadius(+t),+t),s):a},s.projection(i.geo.albersUsa()).context(null)},i.geo.transform=function(t){return{stream:function(e){var n=new Nr(e);for(var r in t)n[r]=t[r];return n}}},Nr.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},i.geo.projection=xr,i.geo.projectionMutator=Ir,(i.geo.equirectangular=function(){return xr(Pr)}).raw=Pr.invert=Pr,i.geo.rotation=function(t){function e(e){return(e=t(e[0]*It,e[1]*It))[0]*=Dt,e[1]*=Dt,e}return t=Hr(t[0]%360*It,t[1]*It,t.length>2?t[2]*It:0),e.invert=function(e){return(e=t.invert(e[0]*It,e[1]*It))[0]*=Dt,e[1]*=Dt,e},e},Lr.invert=Pr,i.geo.circle=function(){var t,e,n=[0,0],r=6;function o(){var t="function"==typeof n?n.apply(this,arguments):n,r=Hr(-t[0]*It,-t[1]*It,0).invert,o=[];return e(null,null,1,{point:function(t,e){o.push(t=r(t,e)),t[0]*=Dt,t[1]*=Dt}}),{type:"Polygon",coordinates:[o]}}return o.origin=function(t){return arguments.length?(n=t,o):n},o.angle=function(n){return arguments.length?(e=Wr((t=+n)*It,r*It),o):t},o.precision=function(n){return arguments.length?(e=Wr(t*It,(r=+n)*It),o):r},o.angle(90)},i.geo.distance=function(t,e){var n,r=(e[0]-t[0])*It,o=t[1]*It,i=e[1]*It,a=Math.sin(r),s=Math.cos(r),l=Math.sin(o),u=Math.cos(o),c=Math.sin(i),f=Math.cos(i);return Math.atan2(Math.sqrt((n=f*a)*n+(n=u*c-l*f*s)*n),l*c+u*f*s)},i.geo.graticule=function(){var t,e,n,r,o,a,s,l,u,c,f,h,d=10,p=d,g=90,v=360,y=2.5;function m(){return{type:"MultiLineString",coordinates:b()}}function b(){return i.range(Math.ceil(r/g)*g,n,g).map(f).concat(i.range(Math.ceil(l/v)*v,s,v).map(h)).concat(i.range(Math.ceil(e/d)*d,t,d).filter((function(t){return C(t%g)>Tt})).map(u)).concat(i.range(Math.ceil(a/p)*p,o,p).filter((function(t){return C(t%v)>Tt})).map(c))}return m.lines=function(){return b().map((function(t){return{type:"LineString",coordinates:t}}))},m.outline=function(){return{type:"Polygon",coordinates:[f(r).concat(h(s).slice(1),f(n).reverse().slice(1),h(l).reverse().slice(1))]}},m.extent=function(t){return arguments.length?m.majorExtent(t).minorExtent(t):m.minorExtent()},m.majorExtent=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],l=+t[0][1],s=+t[1][1],r>n&&(t=r,r=n,n=t),l>s&&(t=l,l=s,s=t),m.precision(y)):[[r,l],[n,s]]},m.minorExtent=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],a=+n[0][1],o=+n[1][1],e>t&&(n=e,e=t,t=n),a>o&&(n=a,a=o,o=n),m.precision(y)):[[e,a],[t,o]]},m.step=function(t){return arguments.length?m.majorStep(t).minorStep(t):m.minorStep()},m.majorStep=function(t){return arguments.length?(g=+t[0],v=+t[1],m):[g,v]},m.minorStep=function(t){return arguments.length?(d=+t[0],p=+t[1],m):[d,p]},m.precision=function(i){return arguments.length?(y=+i,u=Yr(a,o,90),c=zr(e,t,y),f=Yr(l,s,90),h=zr(r,n,y),m):y},m.majorExtent([[-180,-90+Tt],[180,90-Tt]]).minorExtent([[-180,-80-Tt],[180,80+Tt]])},i.geo.greatArc=function(){var t,e,n=Gr,r=Xr;function o(){return{type:"LineString",coordinates:[t||n.apply(this,arguments),e||r.apply(this,arguments)]}}return o.distance=function(){return i.geo.distance(t||n.apply(this,arguments),e||r.apply(this,arguments))},o.source=function(e){return arguments.length?(n=e,t="function"==typeof e?null:e,o):n},o.target=function(t){return arguments.length?(r=t,e="function"==typeof t?null:t,o):r},o.precision=function(){return arguments.length?o:0},o},i.geo.interpolate=function(t,e){return n=t[0]*It,r=t[1]*It,o=e[0]*It,i=e[1]*It,a=Math.cos(r),s=Math.sin(r),l=Math.cos(i),u=Math.sin(i),c=a*Math.cos(n),f=a*Math.sin(n),h=l*Math.cos(o),d=l*Math.sin(o),p=2*Math.asin(Math.sqrt(Ut(i-r)+a*l*Ut(o-n))),g=1/Math.sin(p),(v=p?function(t){var e=Math.sin(t*=p)*g,n=Math.sin(p-t)*g,r=n*c+e*h,o=n*f+e*d,i=n*s+e*u;return[Math.atan2(o,r)*Dt,Math.atan2(i,Math.sqrt(r*r+o*o))*Dt]}:function(){return[n*Dt,r*Dt]}).distance=p,v;var n,r,o,i,a,s,l,u,c,f,h,d,p,g,v},i.geo.length=function(t){return Cr=0,i.geo.stream(t,qr),Cr};var qr={sphere:H,point:H,lineStart:function(){var t,e,n;function r(r,o){var i=Math.sin(o*=It),a=Math.cos(o),s=C((r*=It)-t),l=Math.cos(s);Cr+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=n*i-e*a*l)*s),e*i+n*a*l),t=r,e=i,n=a}qr.point=function(o,i){t=o*It,e=Math.sin(i*=It),n=Math.cos(i),qr.point=r},qr.lineEnd=function(){qr.point=qr.lineEnd=H}},lineEnd:H,polygonStart:H,polygonEnd:H};function Kr(t,e){function n(e,n){var r=Math.cos(e),o=Math.cos(n),i=t(r*o);return[i*o*Math.sin(e),i*Math.sin(n)]}return n.invert=function(t,n){var r=Math.sqrt(t*t+n*n),o=e(r),i=Math.sin(o),a=Math.cos(o);return[Math.atan2(t*i,r*a),Math.asin(r&&n*i/r)]},n}var $r=Kr((function(t){return Math.sqrt(2/(1+t))}),(function(t){return 2*Math.asin(t/2)}));(i.geo.azimuthalEqualArea=function(){return xr($r)}).raw=$r;var Qr=Kr((function(t){var e=Math.acos(t);return e&&e/Math.sin(e)}),I);function Zr(t,e){var n=Math.cos(t),r=function(t){return Math.tan(At/4+t/2)},o=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(r(e)/r(t)),i=n*Math.pow(r(t),o)/o;if(!o)return eo;function a(t,e){i>0?e<-xt+Tt&&(e=-xt+Tt):e>xt-Tt&&(e=xt-Tt);var n=i/Math.pow(r(e),o);return[n*Math.sin(o*t),i-n*Math.cos(o*t)]}return a.invert=function(t,e){var n=i-e,r=Pt(o)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/o,2*Math.atan(Math.pow(i/r,1/o))-xt]},a}function Jr(t,e){var n=Math.cos(t),r=t===e?Math.sin(t):(n-Math.cos(e))/(e-t),o=n/r+t;if(C(r)<Tt)return Pr;function i(t,e){var n=o-e;return[n*Math.sin(r*t),o-n*Math.cos(r*t)]}return i.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/r,o-Pt(r)*Math.sqrt(t*t+n*n)]},i}(i.geo.azimuthalEquidistant=function(){return xr(Qr)}).raw=Qr,(i.geo.conicConformal=function(){return ur(Zr)}).raw=Zr,(i.geo.conicEquidistant=function(){return ur(Jr)}).raw=Jr;var to=Kr((function(t){return 1/t}),Math.atan);function eo(t,e){return[t,Math.log(Math.tan(At/4+e/2))]}function no(t){var e,n=xr(t),r=n.scale,o=n.translate,i=n.clipExtent;return n.scale=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=o.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var a=i.apply(n,arguments);if(a===n){if(e=null==t){var s=At*r(),l=o();i([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else e&&(a=null);return a},n.clipExtent(null)}(i.geo.gnomonic=function(){return xr(to)}).raw=to,eo.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-xt]},(i.geo.mercator=function(){return no(eo)}).raw=eo;var ro=Kr((function(){return 1}),Math.asin);(i.geo.orthographic=function(){return xr(ro)}).raw=ro;var oo=Kr((function(t){return 1/(1+t)}),(function(t){return 2*Math.atan(t)}));function io(t,e){return[Math.log(Math.tan(At/4+e/2)),-t]}function ao(t){return t[0]}function so(t){return t[1]}function lo(t){for(var e=t.length,n=[0,1],r=2,o=2;o<e;o++){for(;r>1&&Lt(t[n[r-2]],t[n[r-1]],t[o])<=0;)--r;n[r++]=o}return n.slice(0,r)}function uo(t,e){return t[0]-e[0]||t[1]-e[1]}(i.geo.stereographic=function(){return xr(oo)}).raw=oo,io.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-xt]},(i.geo.transverseMercator=function(){var t=no(io),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90])}).raw=io,i.geom={},i.geom.hull=function(t){var e=ao,n=so;if(arguments.length)return r(t);function r(t){if(t.length<3)return[];var r,o=me(e),i=me(n),a=t.length,s=[],l=[];for(r=0;r<a;r++)s.push([+o.call(this,t[r],r),+i.call(this,t[r],r),r]);for(s.sort(uo),r=0;r<a;r++)l.push([s[r][0],-s[r][1]]);var u=lo(s),c=lo(l),f=c[0]===u[0],h=c[c.length-1]===u[u.length-1],d=[];for(r=u.length-1;r>=0;--r)d.push(t[s[u[r]][2]]);for(r=+f;r<c.length-h;++r)d.push(t[s[c[r]][2]]);return d}return r.x=function(t){return arguments.length?(e=t,r):e},r.y=function(t){return arguments.length?(n=t,r):n},r},i.geom.polygon=function(t){return z(t,co),t};var co=i.geom.polygon.prototype=[];function fo(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function ho(t,e,n,r){var o=t[0],i=n[0],a=e[0]-o,s=r[0]-i,l=t[1],u=n[1],c=e[1]-l,f=r[1]-u,h=(s*(l-u)-f*(o-i))/(f*a-s*c);return[o+h*a,l+h*c]}function po(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}co.area=function(){for(var t,e=-1,n=this.length,r=this[n-1],o=0;++e<n;)t=r,r=this[e],o+=t[1]*r[0]-t[0]*r[1];return.5*o},co.centroid=function(t){var e,n,r=-1,o=this.length,i=0,a=0,s=this[o-1];for(arguments.length||(t=-1/(6*this.area()));++r<o;)e=s,s=this[r],n=e[0]*s[1]-s[0]*e[1],i+=(e[0]+s[0])*n,a+=(e[1]+s[1])*n;return[i*t,a*t]},co.clip=function(t){for(var e,n,r,o,i,a,s=po(t),l=-1,u=this.length-po(this),c=this[u-1];++l<u;){for(e=t.slice(),t.length=0,o=this[l],i=e[(r=e.length-s)-1],n=-1;++n<r;)fo(a=e[n],c,o)?(fo(i,c,o)||t.push(ho(i,a,c,o)),t.push(a)):fo(i,c,o)&&t.push(ho(i,a,c,o)),i=a;s&&t.push(t[0]),c=o}return t};var go,vo,yo,mo,bo,wo=[],Oo=[];function Co(){Uo(this),this.edge=this.site=this.circle=null}function Eo(t){var e=wo.pop()||new Co;return e.site=t,e}function So(t){xo(t),yo.remove(t),wo.push(t),Uo(t)}function ko(t){var e=t.circle,n=e.x,r=e.cy,o={x:n,y:r},i=t.P,a=t.N,s=[t];So(t);for(var l=i;l.circle&&C(n-l.circle.x)<Tt&&C(r-l.circle.cy)<Tt;)i=l.P,s.unshift(l),So(l),l=i;s.unshift(l),xo(l);for(var u=a;u.circle&&C(n-u.circle.x)<Tt&&C(r-u.circle.cy)<Tt;)a=u.N,s.push(u),So(u),u=a;s.push(u),xo(u);var c,f=s.length;for(c=1;c<f;++c)u=s[c],l=s[c-1],Ho(u.edge,l.site,u.site,o);l=s[0],(u=s[f-1]).edge=Po(l.site,u.site,null,o),jo(l),jo(u)}function Ro(t){for(var e,n,r,o,i=t.x,a=t.y,s=yo._;s;)if((r=_o(s,a)-i)>Tt)s=s.L;else{if(!((o=i-To(s,a))>Tt)){r>-Tt?(e=s.P,n=s):o>-Tt?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}var l=Eo(t);if(yo.insert(e,l),e||n){if(e===n)return xo(e),n=Eo(e.site),yo.insert(l,n),l.edge=n.edge=Po(e.site,l.site),jo(e),void jo(n);if(n){xo(e),xo(n);var u=e.site,c=u.x,f=u.y,h=t.x-c,d=t.y-f,p=n.site,g=p.x-c,v=p.y-f,y=2*(h*v-d*g),m=h*h+d*d,b=g*g+v*v,w={x:(v*m-d*b)/y+c,y:(h*b-g*m)/y+f};Ho(n.edge,u,p,w),l.edge=Po(u,t,null,w),n.edge=Po(t,p,null,w),jo(e),jo(n)}else l.edge=Po(e.site,l.site)}}function _o(t,e){var n=t.site,r=n.x,o=n.y,i=o-e;if(!i)return r;var a=t.P;if(!a)return-1/0;var s=(n=a.site).x,l=n.y,u=l-e;if(!u)return s;var c=s-r,f=1/i-1/u,h=c/u;return f?(-h+Math.sqrt(h*h-2*f*(c*c/(-2*u)-l+u/2+o-i/2)))/f+r:(r+s)/2}function To(t,e){var n=t.N;if(n)return _o(n,e);var r=t.site;return r.y===e?r.x:1/0}function Mo(t){this.site=t,this.edges=[]}function Ao(t,e){return e.angle-t.angle}function No(){Uo(this),this.x=this.y=this.arc=this.site=this.cy=null}function jo(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,o=t.site,i=n.site;if(r!==i){var a=o.x,s=o.y,l=r.x-a,u=r.y-s,c=i.x-a,f=2*(l*(v=i.y-s)-u*c);if(!(f>=-Mt)){var h=l*l+u*u,d=c*c+v*v,p=(v*h-u*d)/f,g=(l*d-c*h)/f,v=g+s,y=Oo.pop()||new No;y.arc=t,y.site=o,y.x=p+a,y.y=v+Math.sqrt(p*p+g*g),y.cy=v,t.circle=y;for(var m=null,b=bo._;b;)if(y.y<b.y||y.y===b.y&&y.x<=b.x){if(!b.L){m=b.P;break}b=b.L}else{if(!b.R){m=b;break}b=b.R}bo.insert(m,y),m||(mo=y)}}}}function xo(t){var e=t.circle;e&&(e.P||(mo=e.N),bo.remove(e),Oo.push(e),Uo(e),t.circle=null)}function Io(t,e){var n=t.b;if(n)return!0;var r,o,i=t.a,a=e[0][0],s=e[1][0],l=e[0][1],u=e[1][1],c=t.l,f=t.r,h=c.x,d=c.y,p=f.x,g=f.y,v=(h+p)/2,y=(d+g)/2;if(g===d){if(v<a||v>=s)return;if(h>p){if(i){if(i.y>=u)return}else i={x:v,y:l};n={x:v,y:u}}else{if(i){if(i.y<l)return}else i={x:v,y:u};n={x:v,y:l}}}else if(o=y-(r=(h-p)/(g-d))*v,r<-1||r>1)if(h>p){if(i){if(i.y>=u)return}else i={x:(l-o)/r,y:l};n={x:(u-o)/r,y:u}}else{if(i){if(i.y<l)return}else i={x:(u-o)/r,y:u};n={x:(l-o)/r,y:l}}else if(d<g){if(i){if(i.x>=s)return}else i={x:a,y:r*a+o};n={x:s,y:r*s+o}}else{if(i){if(i.x<a)return}else i={x:s,y:r*s+o};n={x:a,y:r*a+o}}return t.a=i,t.b=n,!0}function Do(t,e){this.l=t,this.r=e,this.a=this.b=null}function Po(t,e,n,r){var o=new Do(t,e);return go.push(o),n&&Ho(o,t,e,n),r&&Ho(o,e,t,r),vo[t.i].edges.push(new Fo(o,t,e)),vo[e.i].edges.push(new Fo(o,e,t)),o}function Lo(t,e,n){var r=new Do(t,null);return r.a=e,r.b=n,go.push(r),r}function Ho(t,e,n,r){t.a||t.b?t.l===n?t.b=r:t.a=r:(t.a=r,t.l=e,t.r=n)}function Fo(t,e,n){var r=t.a,o=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(o.x-r.x,r.y-o.y):Math.atan2(r.x-o.x,o.y-r.y)}function Bo(){this._=null}function Uo(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Wo(t,e){var n=e,r=e.R,o=n.U;o?o.L===n?o.L=r:o.R=r:t._=r,r.U=o,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Vo(t,e){var n=e,r=e.L,o=n.U;o?o.L===n?o.L=r:o.R=r:t._=r,r.U=o,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function Yo(t){for(;t.L;)t=t.L;return t}function zo(t,e){var n,r,o,i=t.sort(Go).pop();for(go=[],vo=new Array(t.length),yo=new Bo,bo=new Bo;;)if(o=mo,i&&(!o||i.y<o.y||i.y===o.y&&i.x<o.x))i.x===n&&i.y===r||(vo[i.i]=new Mo(i),Ro(i),n=i.x,r=i.y),i=t.pop();else{if(!o)break;ko(o.arc)}e&&(function(t){for(var e,n=go,r=sr(t[0][0],t[0][1],t[1][0],t[1][1]),o=n.length;o--;)(!Io(e=n[o],t)||!r(e)||C(e.a.x-e.b.x)<Tt&&C(e.a.y-e.b.y)<Tt)&&(e.a=e.b=null,n.splice(o,1))}(e),function(t){for(var e,n,r,o,i,a,s,l,u,c,f=t[0][0],h=t[1][0],d=t[0][1],p=t[1][1],g=vo,v=g.length;v--;)if((i=g[v])&&i.prepare())for(l=(s=i.edges).length,a=0;a<l;)r=(c=s[a].end()).x,o=c.y,e=(u=s[++a%l].start()).x,n=u.y,(C(r-e)>Tt||C(o-n)>Tt)&&(s.splice(a,0,new Fo(Lo(i.site,c,C(r-f)<Tt&&p-o>Tt?{x:f,y:C(e-f)<Tt?n:p}:C(o-p)<Tt&&h-r>Tt?{x:C(n-p)<Tt?e:h,y:p}:C(r-h)<Tt&&o-d>Tt?{x:h,y:C(e-h)<Tt?n:d}:C(o-d)<Tt&&r-f>Tt?{x:C(n-d)<Tt?e:f,y:d}:null),i.site,null)),++l)}(e));var a={cells:vo,edges:go};return yo=bo=go=vo=null,a}function Go(t,e){return e.y-t.y||e.x-t.x}Mo.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)(t=e[n].edge).b&&t.a||e.splice(n,1);return e.sort(Ao),e.length},Fo.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Bo.prototype={insert:function(t,e){var n,r,o;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Yo(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(o=r.R)&&o.C?(n.C=o.C=!1,r.C=!0,t=r):(t===n.R&&(Wo(this,n),n=(t=n).U),n.C=!1,r.C=!0,Vo(this,r)):(o=r.L)&&o.C?(n.C=o.C=!1,r.C=!0,t=r):(t===n.L&&(Vo(this,n),n=(t=n).U),n.C=!1,r.C=!0,Wo(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,o=t.U,i=t.L,a=t.R;if(n=i?a?Yo(a):i:a,o?o.L===t?o.L=n:o.R=n:this._=n,i&&a?(r=n.C,n.C=t.C,n.L=i,i.U=n,n!==a?(o=n.U,n.U=t.U,t=n.R,o.L=t,n.R=a,a.U=n):(n.U=o,o=n,t=n.R)):(r=t.C,t=n),t&&(t.U=o),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===o.L){if((e=o.R).C&&(e.C=!1,o.C=!0,Wo(this,o),e=o.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Vo(this,e),e=o.R),e.C=o.C,o.C=e.R.C=!1,Wo(this,o),t=this._;break}}else if((e=o.L).C&&(e.C=!1,o.C=!0,Vo(this,o),e=o.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Wo(this,e),e=o.L),e.C=o.C,o.C=e.L.C=!1,Vo(this,o),t=this._;break}e.C=!0,t=o,o=o.U}while(!t.C);t&&(t.C=!1)}}},i.geom.voronoi=function(t){var e=ao,n=so,r=e,o=n,i=Xo;if(t)return a(t);function a(t){var e=new Array(t.length),n=i[0][0],r=i[0][1],o=i[1][0],a=i[1][1];return zo(s(t),i).cells.forEach((function(i,s){var l=i.edges,u=i.site;(e[s]=l.length?l.map((function(t){var e=t.start();return[e.x,e.y]})):u.x>=n&&u.x<=o&&u.y>=r&&u.y<=a?[[n,a],[o,a],[o,r],[n,r]]:[]).point=t[s]})),e}function s(t){return t.map((function(t,e){return{x:Math.round(r(t,e)/Tt)*Tt,y:Math.round(o(t,e)/Tt)*Tt,i:e}}))}return a.links=function(t){return zo(s(t)).edges.filter((function(t){return t.l&&t.r})).map((function(e){return{source:t[e.l.i],target:t[e.r.i]}}))},a.triangles=function(t){var e=[];return zo(s(t)).cells.forEach((function(n,r){for(var o,i,a,s,l=n.site,u=n.edges.sort(Ao),c=-1,f=u.length,h=u[f-1].edge,d=h.l===l?h.r:h.l;++c<f;)h,o=d,d=(h=u[c].edge).l===l?h.r:h.l,r<o.i&&r<d.i&&(a=o,s=d,((i=l).x-s.x)*(a.y-i.y)-(i.x-a.x)*(s.y-i.y)<0)&&e.push([t[r],t[o.i],t[d.i]])})),e},a.x=function(t){return arguments.length?(r=me(e=t),a):e},a.y=function(t){return arguments.length?(o=me(n=t),a):n},a.clipExtent=function(t){return arguments.length?(i=null==t?Xo:t,a):i===Xo?null:i},a.size=function(t){return arguments.length?a.clipExtent(t&&[[0,0],t]):i===Xo?null:i&&i[1]},a};var Xo=[[-1e6,-1e6],[1e6,1e6]];function qo(t){return t.x}function Ko(t){return t.y}function $o(t,e,n,r,o,i){if(!t(e,n,r,o,i)){var a=.5*(n+o),s=.5*(r+i),l=e.nodes;l[0]&&$o(t,l[0],n,r,a,s),l[1]&&$o(t,l[1],a,r,o,s),l[2]&&$o(t,l[2],n,s,a,i),l[3]&&$o(t,l[3],a,s,o,i)}}function Qo(t,e,n,r,o,i,a){var s,l=1/0;return function t(u,c,f,h,d){if(!(c>i||f>a||h<r||d<o)){if(p=u.point){var p,g=e-u.x,v=n-u.y,y=g*g+v*v;if(y<l){var m=Math.sqrt(l=y);r=e-m,o=n-m,i=e+m,a=n+m,s=p}}for(var b=u.nodes,w=.5*(c+h),O=.5*(f+d),C=(n>=O)<<1|e>=w,E=C+4;C<E;++C)if(u=b[3&C])switch(3&C){case 0:t(u,c,f,w,O);break;case 1:t(u,w,f,h,O);break;case 2:t(u,c,O,w,d);break;case 3:t(u,w,O,h,d)}}}(t,r,o,i,a),s}function Zo(t,e){t=i.rgb(t),e=i.rgb(e);var n=t.r,r=t.g,o=t.b,a=e.r-n,s=e.g-r,l=e.b-o;return function(t){return"#"+fe(Math.round(n+a*t))+fe(Math.round(r+s*t))+fe(Math.round(o+l*t))}}function Jo(t,e){var n,r={},o={};for(n in t)n in e?r[n]=oi(t[n],e[n]):o[n]=t[n];for(n in e)n in t||(o[n]=e[n]);return function(t){for(n in r)o[n]=r[n](t);return o}}function ti(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function ei(t,e){var n,r,o,i=ni.lastIndex=ri.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=ni.exec(t))&&(r=ri.exec(e));)(o=r.index)>i&&(o=e.slice(i,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:ti(n,r)})),i=ri.lastIndex;return i<e.length&&(o=e.slice(i),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var n,r=0;r<e;++r)s[(n=l[r]).i]=n.x(t);return s.join("")})}i.geom.delaunay=function(t){return i.geom.voronoi().triangles(t)},i.geom.quadtree=function(t,e,n,r,o){var i,a=ao,s=so;if(i=arguments.length)return a=qo,s=Ko,3===i&&(o=n,r=e,n=e=0),l(t);function l(t){var l,u,c,f,h,d,p,g,v,y=me(a),m=me(s);if(null!=e)d=e,p=n,g=r,v=o;else if(g=v=-(d=p=1/0),u=[],c=[],h=t.length,i)for(f=0;f<h;++f)(l=t[f]).x<d&&(d=l.x),l.y<p&&(p=l.y),l.x>g&&(g=l.x),l.y>v&&(v=l.y),u.push(l.x),c.push(l.y);else for(f=0;f<h;++f){var b=+y(l=t[f],f),w=+m(l,f);b<d&&(d=b),w<p&&(p=w),b>g&&(g=b),w>v&&(v=w),u.push(b),c.push(w)}var O=g-d,E=v-p;function S(t,e,n,r,o,i,a,s){if(!isNaN(n)&&!isNaN(r))if(t.leaf){var l=t.x,u=t.y;if(null!=l)if(C(l-n)+C(u-r)<.01)k(t,e,n,r,o,i,a,s);else{var c=t.point;t.x=t.y=t.point=null,k(t,c,l,u,o,i,a,s),k(t,e,n,r,o,i,a,s)}else t.x=n,t.y=r,t.point=e}else k(t,e,n,r,o,i,a,s)}function k(t,e,n,r,o,i,a,s){var l=.5*(o+a),u=.5*(i+s),c=n>=l,f=r>=u,h=f<<1|c;t.leaf=!1,c?o=l:a=l,f?i=u:s=u,S(t=t.nodes[h]||(t.nodes[h]={leaf:!0,nodes:[],point:null,x:null,y:null}),e,n,r,o,i,a,s)}O>E?v=p+O:g=d+E;var R={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(t){S(R,t,+y(t,++f),+m(t,f),d,p,g,v)},visit:function(t){$o(t,R,d,p,g,v)},find:function(t){return Qo(R,t[0],t[1],d,p,g,v)}};if(f=-1,null==e){for(;++f<h;)S(R,t[f],u[f],c[f],d,p,g,v);--f}else t.forEach(R.add);return u=c=t=l=null,R}return l.x=function(t){return arguments.length?(a=t,l):a},l.y=function(t){return arguments.length?(s=t,l):s},l.extent=function(t){return arguments.length?(null==t?e=n=r=o=null:(e=+t[0][0],n=+t[0][1],r=+t[1][0],o=+t[1][1]),l):null==e?null:[[e,n],[r,o]]},l.size=function(t){return arguments.length?(null==t?e=n=r=o=null:(e=n=0,r=+t[0],o=+t[1]),l):null==e?null:[r-e,o-n]},l},i.interpolateRgb=Zo,i.interpolateObject=Jo,i.interpolateNumber=ti,i.interpolateString=ei;var ni=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ri=new RegExp(ni.source,"g");function oi(t,e){for(var n,r=i.interpolators.length;--r>=0&&!(n=i.interpolators[r](t,e)););return n}function ii(t,e){var n,r=[],o=[],i=t.length,a=e.length,s=Math.min(t.length,e.length);for(n=0;n<s;++n)r.push(oi(t[n],e[n]));for(;n<i;++n)o[n]=t[n];for(;n<a;++n)o[n]=e[n];return function(t){for(n=0;n<s;++n)o[n]=r[n](t);return o}}i.interpolate=oi,i.interpolators=[function(t,e){var n=typeof e;return("string"===n?ye.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?Zo:ei:e instanceof Gt?Zo:Array.isArray(e)?ii:"object"===n&&isNaN(e)?Jo:ti)(t,e)}],i.interpolateArray=ii;var ai=function(){return I},si=i.map({linear:ai,poly:function(t){return function(e){return Math.pow(e,t)}},quad:function(){return hi},cubic:function(){return di},sin:function(){return gi},exp:function(){return vi},circle:function(){return yi},elastic:function(t,e){var n;arguments.length<2&&(e=.45);arguments.length?n=e/Nt*Math.asin(1/t):(t=1,n=e/4);return function(r){return 1+t*Math.pow(2,-10*r)*Math.sin((r-n)*Nt/e)}},back:function(t){t||(t=1.70158);return function(e){return e*e*((t+1)*e-t)}},bounce:function(){return mi}}),li=i.map({in:I,out:ci,"in-out":fi,"out-in":function(t){return fi(ci(t))}});function ui(t){return function(e){return e<=0?0:e>=1?1:t(e)}}function ci(t){return function(e){return 1-t(1-e)}}function fi(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function hi(t){return t*t}function di(t){return t*t*t}function pi(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function gi(t){return 1-Math.cos(t*xt)}function vi(t){return Math.pow(2,10*(t-1))}function yi(t){return 1-Math.sqrt(1-t*t)}function mi(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function bi(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function wi(t){var e,n,r,o=[t.a,t.b],i=[t.c,t.d],a=Ci(o),s=Oi(o,i),l=Ci(((e=i)[0]+=(r=-s)*(n=o)[0],e[1]+=r*n[1],e))||0;o[0]*i[1]<i[0]*o[1]&&(o[0]*=-1,o[1]*=-1,a*=-1,s*=-1),this.rotate=(a?Math.atan2(o[1],o[0]):Math.atan2(-i[0],i[1]))*Dt,this.translate=[t.e,t.f],this.scale=[a,l],this.skew=l?Math.atan2(s,l)*Dt:0}function Oi(t,e){return t[0]*e[0]+t[1]*e[1]}function Ci(t){var e=Math.sqrt(Oi(t,t));return e&&(t[0]/=e,t[1]/=e),e}i.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.slice(0,e):t,r=e>=0?t.slice(e+1):"in";return n=si.get(n)||ai,ui((r=li.get(r)||I)(n.apply(null,a.call(arguments,1))))},i.interpolateHcl=function(t,e){t=i.hcl(t),e=i.hcl(e);var n=t.h,r=t.c,o=t.l,a=e.h-n,s=e.c-r,l=e.l-o;isNaN(s)&&(s=0,r=isNaN(r)?e.c:r);isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:a<-180&&(a+=360);return function(t){return Zt(n+a*t,r+s*t,o+l*t)+""}},i.interpolateHsl=function(t,e){t=i.hsl(t),e=i.hsl(e);var n=t.h,r=t.s,o=t.l,a=e.h-n,s=e.s-r,l=e.l-o;isNaN(s)&&(s=0,r=isNaN(r)?e.s:r);isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:a<-180&&(a+=360);return function(t){return Kt(n+a*t,r+s*t,o+l*t)+""}},i.interpolateLab=function(t,e){t=i.lab(t),e=i.lab(e);var n=t.l,r=t.a,o=t.b,a=e.l-n,s=e.a-r,l=e.b-o;return function(t){return ne(n+a*t,r+s*t,o+l*t)+""}},i.interpolateRound=bi,i.transform=function(t){var e=l.createElementNS(i.ns.prefix.svg,"g");return(i.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new wi(n?n.matrix:Ei)})(t)},wi.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Ei={a:1,b:0,c:0,d:1,e:0,f:0};function Si(t){return t.length?t.pop()+",":""}function ki(t,e){var n=[],r=[];return t=i.transform(t),e=i.transform(e),function(t,e,n,r){if(t[0]!==e[0]||t[1]!==e[1]){var o=n.push("translate(",null,",",null,")");r.push({i:o-4,x:ti(t[0],e[0])},{i:o-2,x:ti(t[1],e[1])})}else(e[0]||e[1])&&n.push("translate("+e+")")}(t.translate,e.translate,n,r),function(t,e,n,r){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),r.push({i:n.push(Si(n)+"rotate(",null,")")-2,x:ti(t,e)})):e&&n.push(Si(n)+"rotate("+e+")")}(t.rotate,e.rotate,n,r),function(t,e,n,r){t!==e?r.push({i:n.push(Si(n)+"skewX(",null,")")-2,x:ti(t,e)}):e&&n.push(Si(n)+"skewX("+e+")")}(t.skew,e.skew,n,r),function(t,e,n,r){if(t[0]!==e[0]||t[1]!==e[1]){var o=n.push(Si(n)+"scale(",null,",",null,")");r.push({i:o-4,x:ti(t[0],e[0])},{i:o-2,x:ti(t[1],e[1])})}else 1===e[0]&&1===e[1]||n.push(Si(n)+"scale("+e+")")}(t.scale,e.scale,n,r),t=e=null,function(t){for(var e,o=-1,i=r.length;++o<i;)n[(e=r[o]).i]=e.x(t);return n.join("")}}function Ri(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function _i(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function Ti(t){for(var e=t.source,n=t.target,r=function(t,e){if(t===e)return t;var n=Mi(t),r=Mi(e),o=n.pop(),i=r.pop(),a=null;for(;o===i;)a=o,o=n.pop(),i=r.pop();return a}(e,n),o=[e];e!==r;)e=e.parent,o.push(e);for(var i=o.length;n!==r;)o.splice(i,0,n),n=n.parent;return o}function Mi(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Ai(t){t.fixed|=2}function Ni(t){t.fixed&=-7}function ji(t){t.fixed|=4,t.px=t.x,t.py=t.y}function xi(t){t.fixed&=-5}i.interpolateTransform=ki,i.layout={},i.layout.bundle=function(){return function(t){for(var e=[],n=-1,r=t.length;++n<r;)e.push(Ti(t[n]));return e}},i.layout.chord=function(){var t,e,n,r,o,a,s,l={},u=0;function c(){var l,c,h,d,p,g={},v=[],y=i.range(r),m=[];for(t=[],e=[],l=0,d=-1;++d<r;){for(c=0,p=-1;++p<r;)c+=n[d][p];v.push(c),m.push(i.range(r)),l+=c}for(o&&y.sort((function(t,e){return o(v[t],v[e])})),a&&m.forEach((function(t,e){t.sort((function(t,r){return a(n[e][t],n[e][r])}))})),l=(Nt-u*r)/l,c=0,d=-1;++d<r;){for(h=c,p=-1;++p<r;){var b=y[d],w=m[b][p],O=n[b][w],C=c,E=c+=O*l;g[b+"-"+w]={index:b,subindex:w,startAngle:C,endAngle:E,value:O}}e[b]={index:b,startAngle:h,endAngle:c,value:v[b]},c+=u}for(d=-1;++d<r;)for(p=d-1;++p<r;){var S=g[d+"-"+p],k=g[p+"-"+d];(S.value||k.value)&&t.push(S.value<k.value?{source:k,target:S}:{source:S,target:k})}s&&f()}function f(){t.sort((function(t,e){return s((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)}))}return l.matrix=function(o){return arguments.length?(r=(n=o)&&n.length,t=e=null,l):n},l.padding=function(n){return arguments.length?(u=n,t=e=null,l):u},l.sortGroups=function(n){return arguments.length?(o=n,t=e=null,l):o},l.sortSubgroups=function(e){return arguments.length?(a=e,t=null,l):a},l.sortChords=function(e){return arguments.length?(s=e,t&&f(),l):s},l.chords=function(){return t||c(),t},l.groups=function(){return e||c(),e},l},i.layout.force=function(){var t,e,n,r,o,a,s={},l=i.dispatch("start","tick","end"),u=[1,1],c=.9,f=Ii,h=Di,d=-30,p=Pi,g=.1,v=.64,y=[],m=[];function b(t){return function(e,n,r,o){if(e.point!==t){var i=e.cx-t.x,a=e.cy-t.y,s=o-n,l=i*i+a*a;if(s*s/v<l){if(l<p){var u=e.charge/l;t.px-=i*u,t.py-=a*u}return!0}if(e.point&&l&&l<p){u=e.pointCharge/l;t.px-=i*u,t.py-=a*u}}return!e.charge}}function w(t){t.px=i.event.x,t.py=i.event.y,s.resume()}return s.tick=function(){if((n*=.99)<.005)return t=null,l.end({type:"end",alpha:n=0}),!0;var e,s,f,h,p,v,w,O,C,E=y.length,S=m.length;for(s=0;s<S;++s)h=(f=m[s]).source,(v=(O=(p=f.target).x-h.x)*O+(C=p.y-h.y)*C)&&(O*=v=n*o[s]*((v=Math.sqrt(v))-r[s])/v,C*=v,p.x-=O*(w=h.weight+p.weight?h.weight/(h.weight+p.weight):.5),p.y-=C*w,h.x+=O*(w=1-w),h.y+=C*w);if((w=n*g)&&(O=u[0]/2,C=u[1]/2,s=-1,w))for(;++s<E;)(f=y[s]).x+=(O-f.x)*w,f.y+=(C-f.y)*w;if(d)for(!function t(e,n,r){var o=0,i=0;if(e.charge=0,!e.leaf)for(var a,s=e.nodes,l=s.length,u=-1;++u<l;)null!=(a=s[u])&&(t(a,n,r),e.charge+=a.charge,o+=a.charge*a.cx,i+=a.charge*a.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var c=n*r[e.point.index];e.charge+=e.pointCharge=c,o+=c*e.point.x,i+=c*e.point.y}e.cx=o/e.charge,e.cy=i/e.charge}(e=i.geom.quadtree(y),n,a),s=-1;++s<E;)(f=y[s]).fixed||e.visit(b(f));for(s=-1;++s<E;)(f=y[s]).fixed?(f.x=f.px,f.y=f.py):(f.x-=(f.px-(f.px=f.x))*c,f.y-=(f.py-(f.py=f.y))*c);l.tick({type:"tick",alpha:n})},s.nodes=function(t){return arguments.length?(y=t,s):y},s.links=function(t){return arguments.length?(m=t,s):m},s.size=function(t){return arguments.length?(u=t,s):u},s.linkDistance=function(t){return arguments.length?(f="function"==typeof t?t:+t,s):f},s.distance=s.linkDistance,s.linkStrength=function(t){return arguments.length?(h="function"==typeof t?t:+t,s):h},s.friction=function(t){return arguments.length?(c=+t,s):c},s.charge=function(t){return arguments.length?(d="function"==typeof t?t:+t,s):d},s.chargeDistance=function(t){return arguments.length?(p=t*t,s):Math.sqrt(p)},s.gravity=function(t){return arguments.length?(g=+t,s):g},s.theta=function(t){return arguments.length?(v=t*t,s):Math.sqrt(v)},s.alpha=function(e){return arguments.length?(e=+e,n?e>0?n=e:(t.c=null,t.t=NaN,t=null,l.end({type:"end",alpha:n=0})):e>0&&(l.start({type:"start",alpha:n=e}),t=Re(s.tick)),s):n},s.start=function(){var t,e,n,i=y.length,l=m.length,c=u[0],p=u[1];for(t=0;t<i;++t)(n=y[t]).index=t,n.weight=0;for(t=0;t<l;++t)"number"==typeof(n=m[t]).source&&(n.source=y[n.source]),"number"==typeof n.target&&(n.target=y[n.target]),++n.source.weight,++n.target.weight;for(t=0;t<i;++t)n=y[t],isNaN(n.x)&&(n.x=g("x",c)),isNaN(n.y)&&(n.y=g("y",p)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(r=[],"function"==typeof f)for(t=0;t<l;++t)r[t]=+f.call(this,m[t],t);else for(t=0;t<l;++t)r[t]=f;if(o=[],"function"==typeof h)for(t=0;t<l;++t)o[t]=+h.call(this,m[t],t);else for(t=0;t<l;++t)o[t]=h;if(a=[],"function"==typeof d)for(t=0;t<i;++t)a[t]=+d.call(this,y[t],t);else for(t=0;t<i;++t)a[t]=d;function g(n,r){if(!e){for(e=new Array(i),u=0;u<i;++u)e[u]=[];for(u=0;u<l;++u){var o=m[u];e[o.source.index].push(o.target),e[o.target.index].push(o.source)}}for(var a,s=e[t],u=-1,c=s.length;++u<c;)if(!isNaN(a=s[u][n]))return a;return Math.random()*r}return s.resume()},s.resume=function(){return s.alpha(.1)},s.stop=function(){return s.alpha(0)},s.drag=function(){if(e||(e=i.behavior.drag().origin(I).on("dragstart.force",Ai).on("drag.force",w).on("dragend.force",Ni)),!arguments.length)return e;this.on("mouseover.force",ji).on("mouseout.force",xi).call(e)},i.rebind(s,l,"on")};var Ii=20,Di=1,Pi=1/0;function Li(t,e){return i.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=Vi,t}function Hi(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(o=t.children)&&(r=o.length))for(var r,o;--r>=0;)n.push(o[r])}function Fi(t,e){for(var n=[t],r=[];null!=(t=n.pop());)if(r.push(t),(i=t.children)&&(o=i.length))for(var o,i,a=-1;++a<o;)n.push(i[a]);for(;null!=(t=r.pop());)e(t)}function Bi(t){return t.children}function Ui(t){return t.value}function Wi(t,e){return e.value-t.value}function Vi(t){return i.merge(t.map((function(t){return(t.children||[]).map((function(e){return{source:t,target:e}}))})))}i.layout.hierarchy=function(){var t=Wi,e=Bi,n=Ui;function r(o){var i,a=[o],s=[];for(o.depth=0;null!=(i=a.pop());)if(s.push(i),(u=e.call(r,i,i.depth))&&(l=u.length)){for(var l,u,c;--l>=0;)a.push(c=u[l]),c.parent=i,c.depth=i.depth+1;n&&(i.value=0),i.children=u}else n&&(i.value=+n.call(r,i,i.depth)||0),delete i.children;return Fi(o,(function(e){var r,o;t&&(r=e.children)&&r.sort(t),n&&(o=e.parent)&&(o.value+=e.value)})),s}return r.sort=function(e){return arguments.length?(t=e,r):t},r.children=function(t){return arguments.length?(e=t,r):e},r.value=function(t){return arguments.length?(n=t,r):n},r.revalue=function(t){return n&&(Hi(t,(function(t){t.children&&(t.value=0)})),Fi(t,(function(t){var e;t.children||(t.value=+n.call(r,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)}))),t},r},i.layout.partition=function(){var t=i.layout.hierarchy(),e=[1,1];function n(n,r){var o=t.call(this,n,r);return function t(e,n,r,o){var i=e.children;if(e.x=n,e.y=e.depth*o,e.dx=r,e.dy=o,i&&(a=i.length)){var a,s,l,u=-1;for(r=e.value?r/e.value:0;++u<a;)t(s=i[u],n,l=s.value*r,o),n+=l}}(o[0],0,e[0],e[1]/function t(e){var n=e.children,r=0;if(n&&(o=n.length))for(var o,i=-1;++i<o;)r=Math.max(r,t(n[i]));return 1+r}(o[0])),o}return n.size=function(t){return arguments.length?(e=t,n):e},Li(n,t)},i.layout.pie=function(){var t=Number,e=Yi,n=0,r=Nt,o=0;function a(s){var l,u=s.length,c=s.map((function(e,n){return+t.call(a,e,n)})),f=+("function"==typeof n?n.apply(this,arguments):n),h=("function"==typeof r?r.apply(this,arguments):r)-f,d=Math.min(Math.abs(h)/u,+("function"==typeof o?o.apply(this,arguments):o)),p=d*(h<0?-1:1),g=i.sum(c),v=g?(h-u*p)/g:0,y=i.range(u),m=[];return null!=e&&y.sort(e===Yi?function(t,e){return c[e]-c[t]}:function(t,n){return e(s[t],s[n])}),y.forEach((function(t){m[t]={data:s[t],value:l=c[t],startAngle:f,endAngle:f+=l*v+p,padAngle:d}})),m}return a.value=function(e){return arguments.length?(t=e,a):t},a.sort=function(t){return arguments.length?(e=t,a):e},a.startAngle=function(t){return arguments.length?(n=t,a):n},a.endAngle=function(t){return arguments.length?(r=t,a):r},a.padAngle=function(t){return arguments.length?(o=t,a):o},a};var Yi={};function zi(t){return t.x}function Gi(t){return t.y}function Xi(t,e,n){t.y0=e,t.y=n}i.layout.stack=function(){var t=I,e=$i,n=Qi,r=Xi,o=zi,a=Gi;function s(l,u){if(!(d=l.length))return l;var c=l.map((function(e,n){return t.call(s,e,n)})),f=c.map((function(t){return t.map((function(t,e){return[o.call(s,t,e),a.call(s,t,e)]}))})),h=e.call(s,f,u);c=i.permute(c,h),f=i.permute(f,h);var d,p,g,v,y=n.call(s,f,u),m=c[0].length;for(g=0;g<m;++g)for(r.call(s,c[0][g],v=y[g],f[0][g][1]),p=1;p<d;++p)r.call(s,c[p][g],v+=f[p-1][g][1],f[p][g][1]);return l}return s.values=function(e){return arguments.length?(t=e,s):t},s.order=function(t){return arguments.length?(e="function"==typeof t?t:qi.get(t)||$i,s):e},s.offset=function(t){return arguments.length?(n="function"==typeof t?t:Ki.get(t)||Qi,s):n},s.x=function(t){return arguments.length?(o=t,s):o},s.y=function(t){return arguments.length?(a=t,s):a},s.out=function(t){return arguments.length?(r=t,s):r},s};var qi=i.map({"inside-out":function(t){var e,n,r=t.length,o=t.map(Zi),a=t.map(Ji),s=i.range(r).sort((function(t,e){return o[t]-o[e]})),l=0,u=0,c=[],f=[];for(e=0;e<r;++e)n=s[e],l<u?(l+=a[n],c.push(n)):(u+=a[n],f.push(n));return f.reverse().concat(c)},reverse:function(t){return i.range(t.length).reverse()},default:$i}),Ki=i.map({silhouette:function(t){var e,n,r,o=t.length,i=t[0].length,a=[],s=0,l=[];for(n=0;n<i;++n){for(e=0,r=0;e<o;e++)r+=t[e][n][1];r>s&&(s=r),a.push(r)}for(n=0;n<i;++n)l[n]=(s-a[n])/2;return l},wiggle:function(t){var e,n,r,o,i,a,s,l,u,c=t.length,f=t[0],h=f.length,d=[];for(d[0]=l=u=0,n=1;n<h;++n){for(e=0,o=0;e<c;++e)o+=t[e][n][1];for(e=0,i=0,s=f[n][0]-f[n-1][0];e<c;++e){for(r=0,a=(t[e][n][1]-t[e][n-1][1])/(2*s);r<e;++r)a+=(t[r][n][1]-t[r][n-1][1])/s;i+=a*t[e][n][1]}d[n]=l-=o?i/o*s:0,l<u&&(u=l)}for(n=0;n<h;++n)d[n]-=u;return d},expand:function(t){var e,n,r,o=t.length,i=t[0].length,a=1/o,s=[];for(n=0;n<i;++n){for(e=0,r=0;e<o;e++)r+=t[e][n][1];if(r)for(e=0;e<o;e++)t[e][n][1]/=r;else for(e=0;e<o;e++)t[e][n][1]=a}for(n=0;n<i;++n)s[n]=0;return s},zero:Qi});function $i(t){return i.range(t.length)}function Qi(t){for(var e=-1,n=t[0].length,r=[];++e<n;)r[e]=0;return r}function Zi(t){for(var e,n=1,r=0,o=t[0][1],i=t.length;n<i;++n)(e=t[n][1])>o&&(r=n,o=e);return r}function Ji(t){return t.reduce(ta,0)}function ta(t,e){return t+e[1]}function ea(t,e){return na(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function na(t,e){for(var n=-1,r=+t[0],o=(t[1]-r)/e,i=[];++n<=e;)i[n]=o*n+r;return i}function ra(t){return[i.min(t),i.max(t)]}function oa(t,e){return t.value-e.value}function ia(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function aa(t,e){t._pack_next=e,e._pack_prev=t}function sa(t,e){var n=e.x-t.x,r=e.y-t.y,o=t.r+e.r;return.999*o*o>n*n+r*r}function la(t){if((e=t.children)&&(l=e.length)){var e,n,r,o,i,a,s,l,u=1/0,c=-1/0,f=1/0,h=-1/0;if(e.forEach(ua),(n=e[0]).x=-n.r,n.y=0,b(n),l>1&&((r=e[1]).x=r.r,r.y=0,b(r),l>2))for(fa(n,r,o=e[2]),b(o),ia(n,o),n._pack_prev=o,ia(o,r),r=n._pack_next,i=3;i<l;i++){fa(n,r,o=e[i]);var d=0,p=1,g=1;for(a=r._pack_next;a!==r;a=a._pack_next,p++)if(sa(a,o)){d=1;break}if(1==d)for(s=n._pack_prev;s!==a._pack_prev&&!sa(s,o);s=s._pack_prev,g++);d?(p<g||p==g&&r.r<n.r?aa(n,r=a):aa(n=s,r),i--):(ia(n,o),r=o,b(o))}var v=(u+c)/2,y=(f+h)/2,m=0;for(i=0;i<l;i++)(o=e[i]).x-=v,o.y-=y,m=Math.max(m,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=m,e.forEach(ca)}function b(t){u=Math.min(t.x-t.r,u),c=Math.max(t.x+t.r,c),f=Math.min(t.y-t.r,f),h=Math.max(t.y+t.r,h)}}function ua(t){t._pack_next=t._pack_prev=t}function ca(t){delete t._pack_next,delete t._pack_prev}function fa(t,e,n){var r=t.r+n.r,o=e.x-t.x,i=e.y-t.y;if(r&&(o||i)){var a=e.r+n.r,s=o*o+i*i,l=.5+((r*=r)-(a*=a))/(2*s),u=Math.sqrt(Math.max(0,2*a*(r+s)-(r-=s)*r-a*a))/(2*s);n.x=t.x+l*o+u*i,n.y=t.y+l*i-u*o}else n.x=t.x+r,n.y=t.y}function ha(t,e){return t.parent==e.parent?1:2}function da(t){var e=t.children;return e.length?e[0]:t.t}function pa(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function ga(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function va(t,e,n){return t.a.parent===e.parent?t.a:n}function ya(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function ma(t,e){var n=t.x+e[3],r=t.y+e[0],o=t.dx-e[1]-e[3],i=t.dy-e[0]-e[2];return o<0&&(n+=o/2,o=0),i<0&&(r+=i/2,i=0),{x:n,y:r,dx:o,dy:i}}function ba(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]}function wa(t){return t.rangeExtent?t.rangeExtent():ba(t.range())}function Oa(t,e,n,r){var o=n(t[0],t[1]),i=r(e[0],e[1]);return function(t){return i(o(t))}}function Ca(t,e){var n,r=0,o=t.length-1,i=t[r],a=t[o];return a<i&&(n=r,r=o,o=n,n=i,i=a,a=n),t[r]=e.floor(i),t[o]=e.ceil(a),t}function Ea(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:Sa}i.layout.histogram=function(){var t=!0,e=Number,n=ra,r=ea;function o(o,a){for(var s,l,u=[],c=o.map(e,this),f=n.call(this,c,a),h=r.call(this,f,c,a),d=(a=-1,c.length),p=h.length-1,g=t?1:1/d;++a<p;)(s=u[a]=[]).dx=h[a+1]-(s.x=h[a]),s.y=0;if(p>0)for(a=-1;++a<d;)(l=c[a])>=f[0]&&l<=f[1]&&((s=u[i.bisect(h,l,1,p)-1]).y+=g,s.push(o[a]));return u}return o.value=function(t){return arguments.length?(e=t,o):e},o.range=function(t){return arguments.length?(n=me(t),o):n},o.bins=function(t){return arguments.length?(r="number"==typeof t?function(e){return na(e,t)}:me(t),o):r},o.frequency=function(e){return arguments.length?(t=!!e,o):t},o},i.layout.pack=function(){var t,e=i.layout.hierarchy().sort(oa),n=0,r=[1,1];function o(o,i){var a=e.call(this,o,i),s=a[0],l=r[0],u=r[1],c=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(s.x=s.y=0,Fi(s,(function(t){t.r=+c(t.value)})),Fi(s,la),n){var f=n*(t?1:Math.max(2*s.r/l,2*s.r/u))/2;Fi(s,(function(t){t.r+=f})),Fi(s,la),Fi(s,(function(t){t.r-=f}))}return function t(e,n,r,o){var i=e.children;if(e.x=n+=o*e.x,e.y=r+=o*e.y,e.r*=o,i)for(var a=-1,s=i.length;++a<s;)t(i[a],n,r,o)}(s,l/2,u/2,t?1:1/Math.max(2*s.r/l,2*s.r/u)),a}return o.size=function(t){return arguments.length?(r=t,o):r},o.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,o):t},o.padding=function(t){return arguments.length?(n=+t,o):n},Li(o,e)},i.layout.tree=function(){var t=i.layout.hierarchy().sort(null).value(null),e=ha,n=[1,1],r=null;function o(o,i){var u=t.call(this,o,i),c=u[0],f=function(t){var e,n={A:null,children:[t]},r=[n];for(;null!=(e=r.pop());)for(var o,i=e.children,a=0,s=i.length;a<s;++a)r.push((i[a]=o={_:i[a],parent:e,children:(o=i[a].children)&&o.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=o);return n.children[0]}(c);if(Fi(f,a),f.parent.m=-f.z,Hi(f,s),r)Hi(c,l);else{var h=c,d=c,p=c;Hi(c,(function(t){t.x<h.x&&(h=t),t.x>d.x&&(d=t),t.depth>p.depth&&(p=t)}));var g=e(h,d)/2-h.x,v=n[0]/(d.x+e(d,h)/2+g),y=n[1]/(p.depth||1);Hi(c,(function(t){t.x=(t.x+g)*v,t.y=t.depth*y}))}return u}function a(t){var n=t.children,r=t.parent.children,o=t.i?r[t.i-1]:null;if(n.length){!function(t){var e,n=0,r=0,o=t.children,i=o.length;for(;--i>=0;)(e=o[i]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(t);var i=(n[0].z+n[n.length-1].z)/2;o?(t.z=o.z+e(t._,o._),t.m=t.z-i):t.z=i}else o&&(t.z=o.z+e(t._,o._));t.parent.A=function(t,n,r){if(n){for(var o,i=t,a=t,s=n,l=i.parent.children[0],u=i.m,c=a.m,f=s.m,h=l.m;s=pa(s),i=da(i),s&&i;)l=da(l),(a=pa(a)).a=t,(o=s.z+f-i.z-u+e(s._,i._))>0&&(ga(va(s,t,r),t,o),u+=o,c+=o),f+=s.m,u+=i.m,h+=l.m,c+=a.m;s&&!pa(a)&&(a.t=s,a.m+=f-c),i&&!da(l)&&(l.t=i,l.m+=u-h,r=t)}return r}(t,o,t.parent.A||r[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function l(t){t.x*=n[0],t.y=t.depth*n[1]}return o.separation=function(t){return arguments.length?(e=t,o):e},o.size=function(t){return arguments.length?(r=null==(n=t)?l:null,o):r?null:n},o.nodeSize=function(t){return arguments.length?(r=null==(n=t)?null:l,o):r?n:null},Li(o,t)},i.layout.cluster=function(){var t=i.layout.hierarchy().sort(null).value(null),e=ha,n=[1,1],r=!1;function o(o,a){var s,l=t.call(this,o,a),u=l[0],c=0;Fi(u,(function(t){var n=t.children;n&&n.length?(t.x=function(t){return t.reduce((function(t,e){return t+e.x}),0)/t.length}(n),t.y=function(t){return 1+i.max(t,(function(t){return t.y}))}(n)):(t.x=s?c+=e(t,s):0,t.y=0,s=t)}));var f=function t(e){var n=e.children;return n&&n.length?t(n[0]):e}(u),h=function t(e){var n,r=e.children;return r&&(n=r.length)?t(r[n-1]):e}(u),d=f.x-e(f,h)/2,p=h.x+e(h,f)/2;return Fi(u,r?function(t){t.x=(t.x-u.x)*n[0],t.y=(u.y-t.y)*n[1]}:function(t){t.x=(t.x-d)/(p-d)*n[0],t.y=(1-(u.y?t.y/u.y:1))*n[1]}),l}return o.separation=function(t){return arguments.length?(e=t,o):e},o.size=function(t){return arguments.length?(r=null==(n=t),o):r?null:n},o.nodeSize=function(t){return arguments.length?(r=null!=(n=t),o):r?n:null},Li(o,t)},i.layout.treemap=function(){var t,e=i.layout.hierarchy(),n=Math.round,r=[1,1],o=null,a=ya,s=!1,l="squarify",u=.5*(1+Math.sqrt(5));function c(t,e){for(var n,r,o=-1,i=t.length;++o<i;)r=(n=t[o]).value*(e<0?0:e),n.area=isNaN(r)||r<=0?0:r}function f(t){var e=t.children;if(e&&e.length){var n,r,o,i=a(t),s=[],u=e.slice(),h=1/0,g="slice"===l?i.dx:"dice"===l?i.dy:"slice-dice"===l?1&t.depth?i.dy:i.dx:Math.min(i.dx,i.dy);for(c(u,i.dx*i.dy/t.value),s.area=0;(o=u.length)>0;)s.push(n=u[o-1]),s.area+=n.area,"squarify"!==l||(r=d(s,g))<=h?(u.pop(),h=r):(s.area-=s.pop().area,p(s,g,i,!1),g=Math.min(i.dx,i.dy),s.length=s.area=0,h=1/0);s.length&&(p(s,g,i,!0),s.length=s.area=0),e.forEach(f)}}function h(t){var e=t.children;if(e&&e.length){var n,r=a(t),o=e.slice(),i=[];for(c(o,r.dx*r.dy/t.value),i.area=0;n=o.pop();)i.push(n),i.area+=n.area,null!=n.z&&(p(i,n.z?r.dx:r.dy,r,!o.length),i.length=i.area=0);e.forEach(h)}}function d(t,e){for(var n,r=t.area,o=0,i=1/0,a=-1,s=t.length;++a<s;)(n=t[a].area)&&(n<i&&(i=n),n>o&&(o=n));return e*=e,(r*=r)?Math.max(e*o*u/r,r/(e*i*u)):1/0}function p(t,e,r,o){var i,a=-1,s=t.length,l=r.x,u=r.y,c=e?n(t.area/e):0;if(e==r.dx){for((o||c>r.dy)&&(c=r.dy);++a<s;)(i=t[a]).x=l,i.y=u,i.dy=c,l+=i.dx=Math.min(r.x+r.dx-l,c?n(i.area/c):0);i.z=!0,i.dx+=r.x+r.dx-l,r.y+=c,r.dy-=c}else{for((o||c>r.dx)&&(c=r.dx);++a<s;)(i=t[a]).x=l,i.y=u,i.dx=c,u+=i.dy=Math.min(r.y+r.dy-u,c?n(i.area/c):0);i.z=!1,i.dy+=r.y+r.dy-u,r.x+=c,r.dx-=c}}function g(n){var o=t||e(n),i=o[0];return i.x=i.y=0,i.value?(i.dx=r[0],i.dy=r[1]):i.dx=i.dy=0,t&&e.revalue(i),c([i],i.dx*i.dy/i.value),(t?h:f)(i),s&&(t=o),o}return g.size=function(t){return arguments.length?(r=t,g):r},g.padding=function(t){if(!arguments.length)return o;function e(e){var n=t.call(g,e,e.depth);return null==n?ya(e):ma(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return ma(e,t)}var r;return a=null==(o=t)?ya:"function"==(r=typeof t)?e:"number"===r?(t=[t,t,t,t],n):n,g},g.round=function(t){return arguments.length?(n=t?Math.round:Number,g):n!=Number},g.sticky=function(e){return arguments.length?(s=e,t=null,g):s},g.ratio=function(t){return arguments.length?(u=t,g):u},g.mode=function(t){return arguments.length?(l=t+"",g):l},Li(g,e)},i.random={normal:function(t,e){var n=arguments.length;return n<2&&(e=1),n<1&&(t=0),function(){var n,r,o;do{o=(n=2*Math.random()-1)*n+(r=2*Math.random()-1)*r}while(!o||o>1);return t+e*n*Math.sqrt(-2*Math.log(o)/o)}},logNormal:function(){var t=i.random.normal.apply(i,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=i.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;n<t;n++)e+=Math.random();return e}}},i.scale={};var Sa={floor:I,ceil:I};function ka(t,e,n,r){var o=[],a=[],s=0,l=Math.min(t.length,e.length)-1;for(t[l]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<=l;)o.push(n(t[s-1],t[s])),a.push(r(e[s-1],e[s]));return function(e){var n=i.bisect(t,e,1,l)-1;return a[n](o[n](e))}}function Ra(t,e){return i.rebind(t,e,"range","rangeRound","interpolate","clamp")}function _a(t,e){return Ca(t,Ea(Ta(t,e)[2])),Ca(t,Ea(Ta(t,e)[2])),t}function Ta(t,e){null==e&&(e=10);var n=ba(t),r=n[1]-n[0],o=Math.pow(10,Math.floor(Math.log(r/e)/Math.LN10)),i=e/r*o;return i<=.15?o*=10:i<=.35?o*=5:i<=.75&&(o*=2),n[0]=Math.ceil(n[0]/o)*o,n[1]=Math.floor(n[1]/o)*o+.5*o,n[2]=o,n}function Ma(t,e){return i.range.apply(i,Ta(t,e))}function Aa(t,e,n){var r=Ta(t,e);if(n){var o=xe.exec(n);if(o.shift(),"s"===o[8]){var a=i.formatPrefix(Math.max(C(r[0]),C(r[1])));return o[7]||(o[7]="."+ja(a.scale(r[2]))),o[8]="f",n=i.format(o.join("")),function(t){return n(a.scale(t))+a.symbol}}o[7]||(o[7]="."+function(t,e){var n=ja(e[2]);return t in Na?Math.abs(n-ja(Math.max(C(e[0]),C(e[1]))))+ +("e"!==t):n-2*("%"===t)}(o[8],r)),n=o.join("")}else n=",."+ja(r[2])+"f";return i.format(n)}i.scale.linear=function(){return function t(e,n,r,o){var i,a;function s(){var t=Math.min(e.length,n.length)>2?ka:Oa,s=o?_i:Ri;return i=t(e,n,s,r),a=t(n,e,s,oi),l}function l(t){return i(t)}return l.invert=function(t){return a(t)},l.domain=function(t){return arguments.length?(e=t.map(Number),s()):e},l.range=function(t){return arguments.length?(n=t,s()):n},l.rangeRound=function(t){return l.range(t).interpolate(bi)},l.clamp=function(t){return arguments.length?(o=t,s()):o},l.interpolate=function(t){return arguments.length?(r=t,s()):r},l.ticks=function(t){return Ma(e,t)},l.tickFormat=function(t,n){return Aa(e,t,n)},l.nice=function(t){return _a(e,t),s()},l.copy=function(){return t(e,n,r,o)},s()}([0,1],[0,1],oi,!1)};var Na={s:1,g:1,p:1,r:1,e:1};function ja(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}i.scale.log=function(){return function t(e,n,r,o){function a(t){return(r?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(n)}function s(t){return r?Math.pow(n,t):-Math.pow(n,-t)}function l(t){return e(a(t))}return l.invert=function(t){return s(e.invert(t))},l.domain=function(t){return arguments.length?(r=t[0]>=0,e.domain((o=t.map(Number)).map(a)),l):o},l.base=function(t){return arguments.length?(n=+t,e.domain(o.map(a)),l):n},l.nice=function(){var t=Ca(o.map(a),r?Math:Ia);return e.domain(t),o=t.map(s),l},l.ticks=function(){var t=ba(o),e=[],i=t[0],l=t[1],u=Math.floor(a(i)),c=Math.ceil(a(l)),f=n%1?2:n;if(isFinite(c-u)){if(r){for(;u<c;u++)for(var h=1;h<f;h++)e.push(s(u)*h);e.push(s(u))}else for(e.push(s(u));u++<c;)for(h=f-1;h>0;h--)e.push(s(u)*h);for(u=0;e[u]<i;u++);for(c=e.length;e[c-1]>l;c--);e=e.slice(u,c)}return e},l.tickFormat=function(t,e){if(!arguments.length)return xa;arguments.length<2?e=xa:"function"!=typeof e&&(e=i.format(e));var r=Math.max(1,n*t/l.ticks().length);return function(t){var o=t/s(Math.round(a(t)));return o*n<n-.5&&(o*=n),o<=r?e(t):""}},l.copy=function(){return t(e.copy(),n,r,o)},Ra(l,e)}(i.scale.linear().domain([0,1]),10,!0,[1,10])};var xa=i.format(".0e"),Ia={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};function Da(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}i.scale.pow=function(){return function t(e,n,r){var o=Da(n),i=Da(1/n);function a(t){return e(o(t))}return a.invert=function(t){return i(e.invert(t))},a.domain=function(t){return arguments.length?(e.domain((r=t.map(Number)).map(o)),a):r},a.ticks=function(t){return Ma(r,t)},a.tickFormat=function(t,e){return Aa(r,t,e)},a.nice=function(t){return a.domain(_a(r,t))},a.exponent=function(t){return arguments.length?(o=Da(n=t),i=Da(1/n),e.domain(r.map(o)),a):n},a.copy=function(){return t(e.copy(),n,r)},Ra(a,e)}(i.scale.linear(),1,[0,1])},i.scale.sqrt=function(){return i.scale.pow().exponent(.5)},i.scale.ordinal=function(){return function t(e,n){var r,o,a;function s(t){return o[((r.get(t)||("range"===n.t?r.set(t,e.push(t)):NaN))-1)%o.length]}function l(t,n){return i.range(e.length).map((function(e){return t+n*e}))}return s.domain=function(t){if(!arguments.length)return e;e=[],r=new k;for(var o,i=-1,a=t.length;++i<a;)r.has(o=t[i])||r.set(o,e.push(o));return s[n.t].apply(s,n.a)},s.range=function(t){return arguments.length?(o=t,a=0,n={t:"range",a:arguments},s):o},s.rangePoints=function(t,r){arguments.length<2&&(r=0);var i=t[0],u=t[1],c=e.length<2?(i=(i+u)/2,0):(u-i)/(e.length-1+r);return o=l(i+c*r/2,c),a=0,n={t:"rangePoints",a:arguments},s},s.rangeRoundPoints=function(t,r){arguments.length<2&&(r=0);var i=t[0],u=t[1],c=e.length<2?(i=u=Math.round((i+u)/2),0):(u-i)/(e.length-1+r)|0;return o=l(i+Math.round(c*r/2+(u-i-(e.length-1+r)*c)/2),c),a=0,n={t:"rangeRoundPoints",a:arguments},s},s.rangeBands=function(t,r,i){arguments.length<2&&(r=0),arguments.length<3&&(i=r);var u=t[1]<t[0],c=t[u-0],f=t[1-u],h=(f-c)/(e.length-r+2*i);return o=l(c+h*i,h),u&&o.reverse(),a=h*(1-r),n={t:"rangeBands",a:arguments},s},s.rangeRoundBands=function(t,r,i){arguments.length<2&&(r=0),arguments.length<3&&(i=r);var u=t[1]<t[0],c=t[u-0],f=t[1-u],h=Math.floor((f-c)/(e.length-r+2*i));return o=l(c+Math.round((f-c-(e.length-r)*h)/2),h),u&&o.reverse(),a=Math.round(h*(1-r)),n={t:"rangeRoundBands",a:arguments},s},s.rangeBand=function(){return a},s.rangeExtent=function(){return ba(n.a[0])},s.copy=function(){return t(e,n)},s.domain(e)}([],{t:"range",a:[[]]})},i.scale.category10=function(){return i.scale.ordinal().range(Pa)},i.scale.category20=function(){return i.scale.ordinal().range(La)},i.scale.category20b=function(){return i.scale.ordinal().range(Ha)},i.scale.category20c=function(){return i.scale.ordinal().range(Fa)};var Pa=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ue),La=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ue),Ha=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ue),Fa=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ue);function Ba(){return 0}i.scale.quantile=function(){return function t(e,n){var r;function o(){var t=0,o=n.length;for(r=[];++t<o;)r[t-1]=i.quantile(e,t/o);return a}function a(t){if(!isNaN(t=+t))return n[i.bisect(r,t)]}return a.domain=function(t){return arguments.length?(e=t.map(y).filter(m).sort(v),o()):e},a.range=function(t){return arguments.length?(n=t,o()):n},a.quantiles=function(){return r},a.invertExtent=function(t){return(t=n.indexOf(t))<0?[NaN,NaN]:[t>0?r[t-1]:e[0],t<r.length?r[t]:e[e.length-1]]},a.copy=function(){return t(e,n)},o()}([],[])},i.scale.quantize=function(){return function t(e,n,r){var o,i;function a(t){return r[Math.max(0,Math.min(i,Math.floor(o*(t-e))))]}function s(){return o=r.length/(n-e),i=r.length-1,a}return a.domain=function(t){return arguments.length?(e=+t[0],n=+t[t.length-1],s()):[e,n]},a.range=function(t){return arguments.length?(r=t,s()):r},a.invertExtent=function(t){return[t=(t=r.indexOf(t))<0?NaN:t/o+e,t+1/o]},a.copy=function(){return t(e,n,r)},s()}(0,1,[0,1])},i.scale.threshold=function(){return function t(e,n){function r(t){if(t<=t)return n[i.bisect(e,t)]}return r.domain=function(t){return arguments.length?(e=t,r):e},r.range=function(t){return arguments.length?(n=t,r):n},r.invertExtent=function(t){return t=n.indexOf(t),[e[t-1],e[t]]},r.copy=function(){return t(e,n)},r}([.5],[0,1])},i.scale.identity=function(){return function t(e){function n(t){return+t}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=t.map(n),n):e},n.ticks=function(t){return Ma(e,t)},n.tickFormat=function(t,n){return Aa(e,t,n)},n.copy=function(){return t(e)},n}([0,1])},i.svg={},i.svg.arc=function(){var t=Wa,e=Va,n=Ba,r=Ua,o=Ya,i=za,a=Ga;function s(){var s=Math.max(0,+t.apply(this,arguments)),u=Math.max(0,+e.apply(this,arguments)),c=o.apply(this,arguments)-xt,f=i.apply(this,arguments)-xt,h=Math.abs(f-c),d=c>f?0:1;if(u<s&&(p=u,u=s,s=p),h>=jt)return l(u,d)+(s?l(s,1-d):"")+"Z";var p,g,v,y,m,b,w,O,C,E,S,k,R=0,_=0,T=[];if((y=(+a.apply(this,arguments)||0)/2)&&(v=r===Ua?Math.sqrt(s*s+u*u):+r.apply(this,arguments),d||(_*=-1),u&&(_=Ft(v/u*Math.sin(y))),s&&(R=Ft(v/s*Math.sin(y)))),u){m=u*Math.cos(c+_),b=u*Math.sin(c+_),w=u*Math.cos(f-_),O=u*Math.sin(f-_);var M=Math.abs(f-c-2*_)<=At?0:1;if(_&&Xa(m,b,w,O)===d^M){var A=(c+f)/2;m=u*Math.cos(A),b=u*Math.sin(A),w=O=null}}else m=b=0;if(s){C=s*Math.cos(f-R),E=s*Math.sin(f-R),S=s*Math.cos(c+R),k=s*Math.sin(c+R);var N=Math.abs(c-f+2*R)<=At?0:1;if(R&&Xa(C,E,S,k)===1-d^N){var j=(c+f)/2;C=s*Math.cos(j),E=s*Math.sin(j),S=k=null}}else C=E=0;if(h>Tt&&(p=Math.min(Math.abs(u-s)/2,+n.apply(this,arguments)))>.001){g=s<u^d?0:1;var x=p,I=p;if(h<At){var D=null==S?[C,E]:null==w?[m,b]:ho([m,b],[S,k],[w,O],[C,E]),P=m-D[0],L=b-D[1],H=w-D[0],F=O-D[1],B=1/Math.sin(Math.acos((P*H+L*F)/(Math.sqrt(P*P+L*L)*Math.sqrt(H*H+F*F)))/2),U=Math.sqrt(D[0]*D[0]+D[1]*D[1]);I=Math.min(p,(s-U)/(B-1)),x=Math.min(p,(u-U)/(B+1))}if(null!=w){var W=qa(null==S?[C,E]:[S,k],[m,b],u,x,d),V=qa([w,O],[C,E],u,x,d);p===x?T.push("M",W[0],"A",x,",",x," 0 0,",g," ",W[1],"A",u,",",u," 0 ",1-d^Xa(W[1][0],W[1][1],V[1][0],V[1][1]),",",d," ",V[1],"A",x,",",x," 0 0,",g," ",V[0]):T.push("M",W[0],"A",x,",",x," 0 1,",g," ",V[0])}else T.push("M",m,",",b);if(null!=S){var Y=qa([m,b],[S,k],s,-I,d),z=qa([C,E],null==w?[m,b]:[w,O],s,-I,d);p===I?T.push("L",z[0],"A",I,",",I," 0 0,",g," ",z[1],"A",s,",",s," 0 ",d^Xa(z[1][0],z[1][1],Y[1][0],Y[1][1]),",",1-d," ",Y[1],"A",I,",",I," 0 0,",g," ",Y[0]):T.push("L",z[0],"A",I,",",I," 0 0,",g," ",Y[0])}else T.push("L",C,",",E)}else T.push("M",m,",",b),null!=w&&T.push("A",u,",",u," 0 ",M,",",d," ",w,",",O),T.push("L",C,",",E),null!=S&&T.push("A",s,",",s," 0 ",N,",",1-d," ",S,",",k);return T.push("Z"),T.join("")}function l(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}return s.innerRadius=function(e){return arguments.length?(t=me(e),s):t},s.outerRadius=function(t){return arguments.length?(e=me(t),s):e},s.cornerRadius=function(t){return arguments.length?(n=me(t),s):n},s.padRadius=function(t){return arguments.length?(r=t==Ua?Ua:me(t),s):r},s.startAngle=function(t){return arguments.length?(o=me(t),s):o},s.endAngle=function(t){return arguments.length?(i=me(t),s):i},s.padAngle=function(t){return arguments.length?(a=me(t),s):a},s.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+o.apply(this,arguments)+ +i.apply(this,arguments))/2-xt;return[Math.cos(r)*n,Math.sin(r)*n]},s};var Ua="auto";function Wa(t){return t.innerRadius}function Va(t){return t.outerRadius}function Ya(t){return t.startAngle}function za(t){return t.endAngle}function Ga(t){return t&&t.padAngle}function Xa(t,e,n,r){return(t-n)*e-(e-r)*t>0?0:1}function qa(t,e,n,r,o){var i=t[0]-e[0],a=t[1]-e[1],s=(o?r:-r)/Math.sqrt(i*i+a*a),l=s*a,u=-s*i,c=t[0]+l,f=t[1]+u,h=e[0]+l,d=e[1]+u,p=(c+h)/2,g=(f+d)/2,v=h-c,y=d-f,m=v*v+y*y,b=n-r,w=c*d-h*f,O=(y<0?-1:1)*Math.sqrt(Math.max(0,b*b*m-w*w)),C=(w*y-v*O)/m,E=(-w*v-y*O)/m,S=(w*y+v*O)/m,k=(-w*v+y*O)/m,R=C-p,_=E-g,T=S-p,M=k-g;return R*R+_*_>T*T+M*M&&(C=S,E=k),[[C-l,E-u],[C*n/b,E*n/b]]}function Ka(t){var e=ao,n=so,r=Qn,o=Qa,i=o.key,a=.7;function s(i){var s,l=[],u=[],c=-1,f=i.length,h=me(e),d=me(n);function p(){l.push("M",o(t(u),a))}for(;++c<f;)r.call(this,s=i[c],c)?u.push([+h.call(this,s,c),+d.call(this,s,c)]):u.length&&(p(),u=[]);return u.length&&p(),l.length?l.join(""):null}return s.x=function(t){return arguments.length?(e=t,s):e},s.y=function(t){return arguments.length?(n=t,s):n},s.defined=function(t){return arguments.length?(r=t,s):r},s.interpolate=function(t){return arguments.length?(i="function"==typeof t?o=t:(o=$a.get(t)||Qa).key,s):i},s.tension=function(t){return arguments.length?(a=t,s):a},s}i.svg.line=function(){return Ka(I)};var $a=i.map({linear:Qa,"linear-closed":Za,step:function(t){var e=0,n=t.length,r=t[0],o=[r[0],",",r[1]];for(;++e<n;)o.push("H",(r[0]+(r=t[e])[0])/2,"V",r[1]);n>1&&o.push("H",r[0]);return o.join("")},"step-before":Ja,"step-after":ts,basis:rs,"basis-open":function(t){if(t.length<4)return Qa(t);var e,n=[],r=-1,o=t.length,i=[0],a=[0];for(;++r<3;)e=t[r],i.push(e[0]),a.push(e[1]);n.push(os(ss,i)+","+os(ss,a)),--r;for(;++r<o;)e=t[r],i.shift(),i.push(e[0]),a.shift(),a.push(e[1]),ls(n,i,a);return n.join("")},"basis-closed":function(t){var e,n,r=-1,o=t.length,i=o+4,a=[],s=[];for(;++r<4;)n=t[r%o],a.push(n[0]),s.push(n[1]);e=[os(ss,a),",",os(ss,s)],--r;for(;++r<i;)n=t[r%o],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),ls(e,a,s);return e.join("")},bundle:function(t,e){var n=t.length-1;if(n)for(var r,o,i=t[0][0],a=t[0][1],s=t[n][0]-i,l=t[n][1]-a,u=-1;++u<=n;)r=t[u],o=u/n,r[0]=e*r[0]+(1-e)*(i+o*s),r[1]=e*r[1]+(1-e)*(a+o*l);return rs(t)},cardinal:function(t,e){return t.length<3?Qa(t):t[0]+es(t,ns(t,e))},"cardinal-open":function(t,e){return t.length<4?Qa(t):t[1]+es(t.slice(1,-1),ns(t,e))},"cardinal-closed":function(t,e){return t.length<3?Za(t):t[0]+es((t.push(t[0]),t),ns([t[t.length-2]].concat(t,[t[1]]),e))},monotone:function(t){return t.length<3?Qa(t):t[0]+es(t,function(t){var e,n,r,o,i=[],a=function(t){var e=0,n=t.length-1,r=[],o=t[0],i=t[1],a=r[0]=us(o,i);for(;++e<n;)r[e]=(a+(a=us(o=i,i=t[e+1])))/2;return r[e]=a,r}(t),s=-1,l=t.length-1;for(;++s<l;)e=us(t[s],t[s+1]),C(e)<Tt?a[s]=a[s+1]=0:(n=a[s]/e,r=a[s+1]/e,(o=n*n+r*r)>9&&(o=3*e/Math.sqrt(o),a[s]=o*n,a[s+1]=o*r));s=-1;for(;++s<=l;)o=(t[Math.min(l,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),i.push([o||0,a[s]*o||0]);return i}(t))}});function Qa(t){return t.length>1?t.join("L"):t+"Z"}function Za(t){return t.join("L")+"Z"}function Ja(t){for(var e=0,n=t.length,r=t[0],o=[r[0],",",r[1]];++e<n;)o.push("V",(r=t[e])[1],"H",r[0]);return o.join("")}function ts(t){for(var e=0,n=t.length,r=t[0],o=[r[0],",",r[1]];++e<n;)o.push("H",(r=t[e])[0],"V",r[1]);return o.join("")}function es(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return Qa(t);var n=t.length!=e.length,r="",o=t[0],i=t[1],a=e[0],s=a,l=1;if(n&&(r+="Q"+(i[0]-2*a[0]/3)+","+(i[1]-2*a[1]/3)+","+i[0]+","+i[1],o=t[1],l=2),e.length>1){s=e[1],i=t[l],l++,r+="C"+(o[0]+a[0])+","+(o[1]+a[1])+","+(i[0]-s[0])+","+(i[1]-s[1])+","+i[0]+","+i[1];for(var u=2;u<e.length;u++,l++)i=t[l],s=e[u],r+="S"+(i[0]-s[0])+","+(i[1]-s[1])+","+i[0]+","+i[1]}if(n){var c=t[l];r+="Q"+(i[0]+2*s[0]/3)+","+(i[1]+2*s[1]/3)+","+c[0]+","+c[1]}return r}function ns(t,e){for(var n,r=[],o=(1-e)/2,i=t[0],a=t[1],s=1,l=t.length;++s<l;)n=i,i=a,a=t[s],r.push([o*(a[0]-n[0]),o*(a[1]-n[1])]);return r}function rs(t){if(t.length<3)return Qa(t);var e=1,n=t.length,r=t[0],o=r[0],i=r[1],a=[o,o,o,(r=t[1])[0]],s=[i,i,i,r[1]],l=[o,",",i,"L",os(ss,a),",",os(ss,s)];for(t.push(t[n-1]);++e<=n;)r=t[e],a.shift(),a.push(r[0]),s.shift(),s.push(r[1]),ls(l,a,s);return t.pop(),l.push("L",r),l.join("")}function os(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}$a.forEach((function(t,e){e.key=t,e.closed=/-closed$/.test(t)}));var is=[0,2/3,1/3,0],as=[0,1/3,2/3,0],ss=[0,1/6,2/3,1/6];function ls(t,e,n){t.push("C",os(is,e),",",os(is,n),",",os(as,e),",",os(as,n),",",os(ss,e),",",os(ss,n))}function us(t,e){return(e[1]-t[1])/(e[0]-t[0])}function cs(t){for(var e,n,r,o=-1,i=t.length;++o<i;)n=(e=t[o])[0],r=e[1]-xt,e[0]=n*Math.cos(r),e[1]=n*Math.sin(r);return t}function fs(t){var e=ao,n=ao,r=0,o=so,i=Qn,a=Qa,s=a.key,l=a,u="L",c=.7;function f(s){var f,h,d,p=[],g=[],v=[],y=-1,m=s.length,b=me(e),w=me(r),O=e===n?function(){return h}:me(n),C=r===o?function(){return d}:me(o);function E(){p.push("M",a(t(v),c),u,l(t(g.reverse()),c),"Z")}for(;++y<m;)i.call(this,f=s[y],y)?(g.push([h=+b.call(this,f,y),d=+w.call(this,f,y)]),v.push([+O.call(this,f,y),+C.call(this,f,y)])):g.length&&(E(),g=[],v=[]);return g.length&&E(),p.length?p.join(""):null}return f.x=function(t){return arguments.length?(e=n=t,f):n},f.x0=function(t){return arguments.length?(e=t,f):e},f.x1=function(t){return arguments.length?(n=t,f):n},f.y=function(t){return arguments.length?(r=o=t,f):o},f.y0=function(t){return arguments.length?(r=t,f):r},f.y1=function(t){return arguments.length?(o=t,f):o},f.defined=function(t){return arguments.length?(i=t,f):i},f.interpolate=function(t){return arguments.length?(s="function"==typeof t?a=t:(a=$a.get(t)||Qa).key,l=a.reverse||a,u=a.closed?"M":"L",f):s},f.tension=function(t){return arguments.length?(c=t,f):c},f}function hs(t){return t.radius}function ds(t){return[t.x,t.y]}function ps(t){return function(){var e=t.apply(this,arguments),n=e[0],r=e[1]-xt;return[n*Math.cos(r),n*Math.sin(r)]}}function gs(){return 64}function vs(){return"circle"}function ys(t){var e=Math.sqrt(t/At);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}i.svg.line.radial=function(){var t=Ka(cs);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},Ja.reverse=ts,ts.reverse=Ja,i.svg.area=function(){return fs(I)},i.svg.area.radial=function(){var t=fs(cs);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},i.svg.chord=function(){var t=Gr,e=Xr,n=hs,r=Ya,o=za;function i(n,r){var o,i,u=a(this,t,n,r),c=a(this,e,n,r);return"M"+u.p0+s(u.r,u.p1,u.a1-u.a0)+(i=c,(o=u).a0==i.a0&&o.a1==i.a1?l(u.r,u.p1,u.r,u.p0):l(u.r,u.p1,c.r,c.p0)+s(c.r,c.p1,c.a1-c.a0)+l(c.r,c.p1,u.r,u.p0))+"Z"}function a(t,e,i,a){var s=e.call(t,i,a),l=n.call(t,s,a),u=r.call(t,s,a)-xt,c=o.call(t,s,a)-xt;return{r:l,a0:u,a1:c,p0:[l*Math.cos(u),l*Math.sin(u)],p1:[l*Math.cos(c),l*Math.sin(c)]}}function s(t,e,n){return"A"+t+","+t+" 0 "+ +(n>At)+",1 "+e}function l(t,e,n,r){return"Q 0,0 "+r}return i.radius=function(t){return arguments.length?(n=me(t),i):n},i.source=function(e){return arguments.length?(t=me(e),i):t},i.target=function(t){return arguments.length?(e=me(t),i):e},i.startAngle=function(t){return arguments.length?(r=me(t),i):r},i.endAngle=function(t){return arguments.length?(o=me(t),i):o},i},i.svg.diagonal=function(){var t=Gr,e=Xr,n=ds;function r(r,o){var i=t.call(this,r,o),a=e.call(this,r,o),s=(i.y+a.y)/2,l=[i,{x:i.x,y:s},{x:a.x,y:s},a];return"M"+(l=l.map(n))[0]+"C"+l[1]+" "+l[2]+" "+l[3]}return r.source=function(e){return arguments.length?(t=me(e),r):t},r.target=function(t){return arguments.length?(e=me(t),r):e},r.projection=function(t){return arguments.length?(n=t,r):n},r},i.svg.diagonal.radial=function(){var t=i.svg.diagonal(),e=ds,n=t.projection;return t.projection=function(t){return arguments.length?n(ps(e=t)):e},t},i.svg.symbol=function(){var t=vs,e=gs;function n(n,r){return(ms.get(t.call(this,n,r))||ys)(e.call(this,n,r))}return n.type=function(e){return arguments.length?(t=me(e),n):t},n.size=function(t){return arguments.length?(e=me(t),n):e},n};var ms=i.map({circle:ys,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*ws)),n=e*ws;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/bs),n=e*bs/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/bs),n=e*bs/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});i.svg.symbolTypes=ms.keys();var bs=Math.sqrt(3),ws=Math.tan(30*It);$.transition=function(t){for(var e,n,r=Ss||++_s,o=As(t),i=[],a=ks||{time:Date.now(),ease:pi,delay:0,duration:250},s=-1,l=this.length;++s<l;){i.push(e=[]);for(var u=this[s],c=-1,f=u.length;++c<f;)(n=u[c])&&Ns(n,c,o,r,a),e.push(n)}return Es(i,o,r)},$.interrupt=function(t){return this.each(null==t?Os:Cs(As(t)))};var Os=Cs(As());function Cs(t){return function(){var e,n,r;(e=this[t])&&(r=e[n=e.active])&&(r.timer.c=null,r.timer.t=NaN,--e.count?delete e[n]:delete this[t],e.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function Es(t,e,n){return z(t,Rs),t.namespace=e,t.id=n,t}var Ss,ks,Rs=[],_s=0;function Ts(t,e,n,r){var o=t.id,i=t.namespace;return pt(t,"function"==typeof n?function(t,a,s){t[i][o].tween.set(e,r(n.call(t,t.__data__,a,s)))}:(n=r(n),function(t){t[i][o].tween.set(e,n)}))}function Ms(t){return null==t&&(t=""),function(){this.textContent=t}}function As(t){return null==t?"__transition__":"__transition_"+t+"__"}function Ns(t,e,n,r,o){var i,a,s,l,u,c=t[n]||(t[n]={active:0,count:0}),f=c[r];function h(n){var o=c.active,h=c[o];for(var p in h&&(h.timer.c=null,h.timer.t=NaN,--c.count,delete c[o],h.event&&h.event.interrupt.call(t,t.__data__,h.index)),c)if(+p<r){var g=c[p];g.timer.c=null,g.timer.t=NaN,--c.count,delete c[p]}a.c=d,Re((function(){return a.c&&d(n||1)&&(a.c=null,a.t=NaN),1}),0,i),c.active=r,f.event&&f.event.start.call(t,t.__data__,e),u=[],f.tween.forEach((function(n,r){(r=r.call(t,t.__data__,e))&&u.push(r)})),l=f.ease,s=f.duration}function d(o){for(var i=o/s,a=l(i),h=u.length;h>0;)u[--h].call(t,a);if(i>=1)return f.event&&f.event.end.call(t,t.__data__,e),--c.count?delete c[r]:delete t[n],1}f||(i=o.time,a=Re((function(t){var e=f.delay;if(a.t=e+i,e<=t)return h(t-e);a.c=h}),0,i),f=c[r]={tween:new k,time:i,timer:a,delay:o.delay,duration:o.duration,ease:o.ease,index:e},o=null,++c.count)}Rs.call=$.call,Rs.empty=$.empty,Rs.node=$.node,Rs.size=$.size,i.transition=function(t,e){return t&&t.transition?Ss?t.transition(e):t:i.selection().transition(t)},i.transition.prototype=Rs,Rs.select=function(t){var e,n,r,o=this.id,i=this.namespace,a=[];t=Q(t);for(var s=-1,l=this.length;++s<l;){a.push(e=[]);for(var u=this[s],c=-1,f=u.length;++c<f;)(r=u[c])&&(n=t.call(r,r.__data__,c,s))?("__data__"in r&&(n.__data__=r.__data__),Ns(n,c,i,o,r[i][o]),e.push(n)):e.push(null)}return Es(a,i,o)},Rs.selectAll=function(t){var e,n,r,o,i,a=this.id,s=this.namespace,l=[];t=Z(t);for(var u=-1,c=this.length;++u<c;)for(var f=this[u],h=-1,d=f.length;++h<d;)if(r=f[h]){i=r[s][a],n=t.call(r,r.__data__,h,u),l.push(e=[]);for(var p=-1,g=n.length;++p<g;)(o=n[p])&&Ns(o,p,s,a,i),e.push(o)}return Es(l,s,a)},Rs.filter=function(t){var e,n,r=[];"function"!=typeof t&&(t=ht(t));for(var o=0,i=this.length;o<i;o++){r.push(e=[]);for(var a,s=0,l=(a=this[o]).length;s<l;s++)(n=a[s])&&t.call(n,n.__data__,s,o)&&e.push(n)}return Es(r,this.namespace,this.id)},Rs.tween=function(t,e){var n=this.id,r=this.namespace;return arguments.length<2?this.node()[r][n].tween.get(t):pt(this,null==e?function(e){e[r][n].tween.remove(t)}:function(o){o[r][n].tween.set(t,e)})},Rs.attr=function(t,e){if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var n="transform"==t?ki:oi,r=i.ns.qualify(t);function o(){this.removeAttribute(r)}function a(){this.removeAttributeNS(r.space,r.local)}function s(t){return null==t?o:(t+="",function(){var e,o=this.getAttribute(r);return o!==t&&(e=n(o,t),function(t){this.setAttribute(r,e(t))})})}function l(t){return null==t?a:(t+="",function(){var e,o=this.getAttributeNS(r.space,r.local);return o!==t&&(e=n(o,t),function(t){this.setAttributeNS(r.space,r.local,e(t))})})}return Ts(this,"attr."+t,e,r.local?l:s)},Rs.attrTween=function(t,e){var n=i.ns.qualify(t);return this.tween("attr."+t,n.local?function(t,r){var o=e.call(this,t,r,this.getAttributeNS(n.space,n.local));return o&&function(t){this.setAttributeNS(n.space,n.local,o(t))}}:function(t,r){var o=e.call(this,t,r,this.getAttribute(n));return o&&function(t){this.setAttribute(n,o(t))}})},Rs.style=function(t,e,n){var r=arguments.length;if(r<3){if("string"!=typeof t){for(n in r<2&&(e=""),t)this.style(n,t[n],e);return this}n=""}function o(){this.style.removeProperty(t)}function i(e){return null==e?o:(e+="",function(){var r,o=c(this).getComputedStyle(this,null).getPropertyValue(t);return o!==e&&(r=oi(o,e),function(e){this.style.setProperty(t,r(e),n)})})}return Ts(this,"style."+t,e,i)},Rs.styleTween=function(t,e,n){function r(r,o){var i=e.call(this,r,o,c(this).getComputedStyle(this,null).getPropertyValue(t));return i&&function(e){this.style.setProperty(t,i(e),n)}}return arguments.length<3&&(n=""),this.tween("style."+t,r)},Rs.text=function(t){return Ts(this,"text",t,Ms)},Rs.remove=function(){var t=this.namespace;return this.each("end.transition",(function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)}))},Rs.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=i.ease.apply(i,arguments)),pt(this,(function(r){r[n][e].ease=t})))},Rs.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:pt(this,"function"==typeof t?function(r,o,i){r[n][e].delay=+t.call(r,r.__data__,o,i)}:(t=+t,function(r){r[n][e].delay=t}))},Rs.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:pt(this,"function"==typeof t?function(r,o,i){r[n][e].duration=Math.max(1,t.call(r,r.__data__,o,i))}:(t=Math.max(1,t),function(r){r[n][e].duration=t}))},Rs.each=function(t,e){var n=this.id,r=this.namespace;if(arguments.length<2){var o=ks,a=Ss;try{Ss=n,pt(this,(function(e,o,i){ks=e[r][n],t.call(e,e.__data__,o,i)}))}finally{ks=o,Ss=a}}else pt(this,(function(o){var a=o[r][n];(a.event||(a.event=i.dispatch("start","end","interrupt"))).on(t,e)}));return this},Rs.transition=function(){for(var t,e,n,r=this.id,o=++_s,i=this.namespace,a=[],s=0,l=this.length;s<l;s++){a.push(t=[]);for(var u,c=0,f=(u=this[s]).length;c<f;c++)(e=u[c])&&Ns(e,c,i,o,{time:(n=e[i][r]).time,ease:n.ease,delay:n.delay+n.duration,duration:n.duration}),t.push(e)}return Es(a,i,o)},i.svg.axis=function(){var t,e=i.scale.linear(),n=js,r=6,o=6,a=3,l=[10],u=null;function c(s){s.each((function(){var s,c=i.select(this),f=this.__chart__||e,h=this.__chart__=e.copy(),d=null==u?h.ticks?h.ticks.apply(h,l):h.domain():u,p=null==t?h.tickFormat?h.tickFormat.apply(h,l):I:t,g=c.selectAll(".tick").data(d,h),v=g.enter().insert("g",".domain").attr("class","tick").style("opacity",Tt),y=i.transition(g.exit()).style("opacity",Tt).remove(),m=i.transition(g.order()).style("opacity",1),b=Math.max(r,0)+a,w=wa(h),O=c.selectAll(".domain").data([0]),C=(O.enter().append("path").attr("class","domain"),i.transition(O));v.append("line"),v.append("text");var E,S,k,R,_=v.select("line"),T=m.select("line"),M=g.select("text").text(p),A=v.select("text"),N=m.select("text"),j="top"===n||"left"===n?-1:1;if("bottom"===n||"top"===n?(s=Is,E="x",k="y",S="x2",R="y2",M.attr("dy",j<0?"0em":".71em").style("text-anchor","middle"),C.attr("d","M"+w[0]+","+j*o+"V0H"+w[1]+"V"+j*o)):(s=Ds,E="y",k="x",S="y2",R="x2",M.attr("dy",".32em").style("text-anchor",j<0?"end":"start"),C.attr("d","M"+j*o+","+w[0]+"H0V"+w[1]+"H"+j*o)),_.attr(R,j*r),A.attr(k,j*b),T.attr(S,0).attr(R,j*r),N.attr(E,0).attr(k,j*b),h.rangeBand){var x=h,D=x.rangeBand()/2;f=h=function(t){return x(t)+D}}else f.rangeBand?f=h:y.call(s,h,f);v.call(s,f,h),m.call(s,h,h)}))}return c.scale=function(t){return arguments.length?(e=t,c):e},c.orient=function(t){return arguments.length?(n=t in xs?t+"":js,c):n},c.ticks=function(){return arguments.length?(l=s(arguments),c):l},c.tickValues=function(t){return arguments.length?(u=t,c):u},c.tickFormat=function(e){return arguments.length?(t=e,c):t},c.tickSize=function(t){var e=arguments.length;return e?(r=+t,o=+arguments[e-1],c):r},c.innerTickSize=function(t){return arguments.length?(r=+t,c):r},c.outerTickSize=function(t){return arguments.length?(o=+t,c):o},c.tickPadding=function(t){return arguments.length?(a=+t,c):a},c.tickSubdivide=function(){return arguments.length&&c},c};var js="bottom",xs={top:1,right:1,bottom:1,left:1};function Is(t,e,n){t.attr("transform",(function(t){var r=e(t);return"translate("+(isFinite(r)?r:n(t))+",0)"}))}function Ds(t,e,n){t.attr("transform",(function(t){var r=e(t);return"translate(0,"+(isFinite(r)?r:n(t))+")"}))}i.svg.brush=function(){var t,e,n=V(h,"brushstart","brush","brushend"),r=null,o=null,a=[0,0],s=[0,0],l=!0,u=!0,f=Ls[0];function h(t){t.each((function(){var t=i.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",v).on("touchstart.brush",v),e=t.selectAll(".background").data([0]);e.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var n=t.selectAll(".resize").data(f,I);n.exit().remove(),n.enter().append("g").attr("class",(function(t){return"resize "+t})).style("cursor",(function(t){return Ps[t]})).append("rect").attr("x",(function(t){return/[ew]$/.test(t)?-3:null})).attr("y",(function(t){return/^[ns]/.test(t)?-3:null})).attr("width",6).attr("height",6).style("visibility","hidden"),n.style("display",h.empty()?"none":null);var a,s=i.transition(t),l=i.transition(e);r&&(a=wa(r),l.attr("x",a[0]).attr("width",a[1]-a[0]),p(s)),o&&(a=wa(o),l.attr("y",a[0]).attr("height",a[1]-a[0]),g(s)),d(s)}))}function d(t){t.selectAll(".resize").attr("transform",(function(t){return"translate("+a[+/e$/.test(t)]+","+s[+/^s/.test(t)]+")"}))}function p(t){t.select(".extent").attr("x",a[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",a[1]-a[0])}function g(t){t.select(".extent").attr("y",s[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",s[1]-s[0])}function v(){var f,v,y=this,m=i.select(i.event.target),b=n.of(y,arguments),w=i.select(y),O=m.datum(),C=!/^(n|s)$/.test(O)&&r,E=!/^(e|w)$/.test(O)&&o,S=m.classed("extent"),k=St(y),R=i.mouse(y),_=i.select(c(y)).on("keydown.brush",A).on("keyup.brush",N);if(i.event.changedTouches?_.on("touchmove.brush",j).on("touchend.brush",I):_.on("mousemove.brush",j).on("mouseup.brush",I),w.interrupt().selectAll("*").interrupt(),S)R[0]=a[0]-R[0],R[1]=s[0]-R[1];else if(O){var T=+/w$/.test(O),M=+/^n/.test(O);v=[a[1-T]-R[0],s[1-M]-R[1]],R[0]=a[T],R[1]=s[M]}else i.event.altKey&&(f=R.slice());function A(){32==i.event.keyCode&&(S||(f=null,R[0]-=a[1],R[1]-=s[1],S=2),U())}function N(){32==i.event.keyCode&&2==S&&(R[0]+=a[1],R[1]+=s[1],S=0,U())}function j(){var t=i.mouse(y),e=!1;v&&(t[0]+=v[0],t[1]+=v[1]),S||(i.event.altKey?(f||(f=[(a[0]+a[1])/2,(s[0]+s[1])/2]),R[0]=a[+(t[0]<f[0])],R[1]=s[+(t[1]<f[1])]):f=null),C&&x(t,r,0)&&(p(w),e=!0),E&&x(t,o,1)&&(g(w),e=!0),e&&(d(w),b({type:"brush",mode:S?"move":"resize"}))}function x(n,r,o){var i,c,h=wa(r),d=h[0],p=h[1],g=R[o],v=o?s:a,y=v[1]-v[0];if(S&&(d-=g,p-=y+g),i=(o?u:l)?Math.max(d,Math.min(p,n[o])):n[o],S?c=(i+=g)+y:(f&&(g=Math.max(d,Math.min(p,2*f[o]-i))),g<i?(c=i,i=g):c=g),v[0]!=i||v[1]!=c)return o?e=null:t=null,v[0]=i,v[1]=c,!0}function I(){j(),w.style("pointer-events","all").selectAll(".resize").style("display",h.empty()?"none":null),i.select("body").style("cursor",null),_.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),k(),b({type:"brushend"})}w.style("pointer-events","none").selectAll(".resize").style("display",null),i.select("body").style("cursor",m.style("cursor")),b({type:"brushstart"}),j()}return h.event=function(r){r.each((function(){var r=n.of(this,arguments),o={x:a,y:s,i:t,j:e},l=this.__chart__||o;this.__chart__=o,Ss?i.select(this).transition().each("start.brush",(function(){t=l.i,e=l.j,a=l.x,s=l.y,r({type:"brushstart"})})).tween("brush:brush",(function(){var n=ii(a,o.x),i=ii(s,o.y);return t=e=null,function(t){a=o.x=n(t),s=o.y=i(t),r({type:"brush",mode:"resize"})}})).each("end.brush",(function(){t=o.i,e=o.j,r({type:"brush",mode:"resize"}),r({type:"brushend"})})):(r({type:"brushstart"}),r({type:"brush",mode:"resize"}),r({type:"brushend"}))}))},h.x=function(t){return arguments.length?(f=Ls[!(r=t)<<1|!o],h):r},h.y=function(t){return arguments.length?(f=Ls[!r<<1|!(o=t)],h):o},h.clamp=function(t){return arguments.length?(r&&o?(l=!!t[0],u=!!t[1]):r?l=!!t:o&&(u=!!t),h):r&&o?[l,u]:r?l:o?u:null},h.extent=function(n){var i,l,u,c,f;return arguments.length?(r&&(i=n[0],l=n[1],o&&(i=i[0],l=l[0]),t=[i,l],r.invert&&(i=r(i),l=r(l)),l<i&&(f=i,i=l,l=f),i==a[0]&&l==a[1]||(a=[i,l])),o&&(u=n[0],c=n[1],r&&(u=u[1],c=c[1]),e=[u,c],o.invert&&(u=o(u),c=o(c)),c<u&&(f=u,u=c,c=f),u==s[0]&&c==s[1]||(s=[u,c])),h):(r&&(t?(i=t[0],l=t[1]):(i=a[0],l=a[1],r.invert&&(i=r.invert(i),l=r.invert(l)),l<i&&(f=i,i=l,l=f))),o&&(e?(u=e[0],c=e[1]):(u=s[0],c=s[1],o.invert&&(u=o.invert(u),c=o.invert(c)),c<u&&(f=u,u=c,c=f))),r&&o?[[i,u],[l,c]]:r?[i,l]:o&&[u,c])},h.clear=function(){return h.empty()||(a=[0,0],s=[0,0],t=e=null),h},h.empty=function(){return!!r&&a[0]==a[1]||!!o&&s[0]==s[1]},i.rebind(h,n,"on")};var Ps={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ls=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Hs=Pe.format=hn.timeFormat,Fs=Hs.utc,Bs=Fs("%Y-%m-%dT%H:%M:%S.%LZ");function Us(t){return t.toISOString()}function Ws(t,e,n){function r(e){return t(e)}function o(t,n){var r=(t[1]-t[0])/n,o=i.bisect(Ys,r);return o==Ys.length?[e.year,Ta(t.map((function(t){return t/31536e6})),n)[2]]:o?e[r/Ys[o-1]<Ys[o]/r?o-1:o]:[Xs,Ta(t,n)[2]]}return r.invert=function(e){return Vs(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain(e),r):t.domain().map(Vs)},r.nice=function(t,e){var n=r.domain(),i=ba(n),a=null==t?o(i,10):"number"==typeof t&&o(i,t);function s(n){return!isNaN(n)&&!t.range(n,Vs(+n+1),e).length}return a&&(t=a[0],e=a[1]),r.domain(Ca(n,e>1?{floor:function(e){for(;s(e=t.floor(e));)e=Vs(e-1);return e},ceil:function(e){for(;s(e=t.ceil(e));)e=Vs(+e+1);return e}}:t))},r.ticks=function(t,e){var n=ba(r.domain()),i=null==t?o(n,10):"number"==typeof t?o(n,t):!t.range&&[{range:t},e];return i&&(t=i[0],e=i[1]),t.range(n[0],Vs(+n[1]+1),e<1?1:e)},r.tickFormat=function(){return n},r.copy=function(){return Ws(t.copy(),e,n)},Ra(r,t)}function Vs(t){return new Date(t)}Hs.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Us:Bs,Us.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Us.toString=Bs.toString,Pe.second=Be((function(t){return new Le(1e3*Math.floor(t/1e3))}),(function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))}),(function(t){return t.getSeconds()})),Pe.seconds=Pe.second.range,Pe.seconds.utc=Pe.second.utc.range,Pe.minute=Be((function(t){return new Le(6e4*Math.floor(t/6e4))}),(function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))}),(function(t){return t.getMinutes()})),Pe.minutes=Pe.minute.range,Pe.minutes.utc=Pe.minute.utc.range,Pe.hour=Be((function(t){var e=t.getTimezoneOffset()/60;return new Le(36e5*(Math.floor(t/36e5-e)+e))}),(function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))}),(function(t){return t.getHours()})),Pe.hours=Pe.hour.range,Pe.hours.utc=Pe.hour.utc.range,Pe.month=Be((function(t){return(t=Pe.day(t)).setDate(1),t}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t){return t.getMonth()})),Pe.months=Pe.month.range,Pe.months.utc=Pe.month.utc.range;var Ys=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],zs=[[Pe.second,1],[Pe.second,5],[Pe.second,15],[Pe.second,30],[Pe.minute,1],[Pe.minute,5],[Pe.minute,15],[Pe.minute,30],[Pe.hour,1],[Pe.hour,3],[Pe.hour,6],[Pe.hour,12],[Pe.day,1],[Pe.day,2],[Pe.week,1],[Pe.month,1],[Pe.month,3],[Pe.year,1]],Gs=Hs.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Qn]]),Xs={range:function(t,e,n){return i.range(Math.ceil(t/n)*n,+e,n).map(Vs)},floor:I,ceil:I};zs.year=Pe.year,Pe.scale=function(){return Ws(i.scale.linear(),zs,Gs)};var qs=zs.map((function(t){return[t[0].utc,t[1]]})),Ks=Fs.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Qn]]);function $s(t){return JSON.parse(t.responseText)}function Qs(t){var e=l.createRange();return e.selectNode(l.body),e.createContextualFragment(t.responseText)}qs.year=Pe.year.utc,Pe.scale.utc=function(){return Ws(i.scale.linear(),qs,Ks)},i.text=be((function(t){return t.responseText})),i.json=function(t,e){return we(t,"application/json",$s,e)},i.html=function(t,e){return we(t,"text/html",Qs,e)},i.xml=be((function(t){return t.responseXML})),this.d3=i,void 0===(o="function"==typeof(r=i)?r.call(e,n,e,t):r)||(t.exports=o)}()},function(t,e,n){var r=n(26),o=n(49),i=n(143),a=[].slice,s=function(t){return function(e,n){var r=arguments.length>2,o=r?a.call(arguments,2):void 0;return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,o)}:e,n)}};r({global:!0,bind:!0,forced:/MSIE .\./.test(i)},{setTimeout:s(o.setTimeout),setInterval:s(o.setInterval)})},,function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n(115))},function(t,e,n){var r=n(49),o=n(160),i=n(60),a=n(137),s=n(164),l=n(190),u=o("wks"),c=r.Symbol,f=l?c:c&&c.withoutSetter||a;t.exports=function(t){return i(u,t)||(s&&i(c,t)?u[t]=c[t]:u[t]=f("Symbol."+t)),u[t]}},function(t,e,n){"use strict";function r(t){switch(Object.prototype.toString.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return g(t,Error)}}function o(t){return"[object ErrorEvent]"===Object.prototype.toString.call(t)}function i(t){return"[object DOMError]"===Object.prototype.toString.call(t)}function a(t){return"[object DOMException]"===Object.prototype.toString.call(t)}function s(t){return"[object String]"===Object.prototype.toString.call(t)}function l(t){return null===t||"object"!=typeof t&&"function"!=typeof t}function u(t){return"[object Object]"===Object.prototype.toString.call(t)}function c(t){return"undefined"!=typeof Event&&g(t,Event)}function f(t){return"undefined"!=typeof Element&&g(t,Element)}function h(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function d(t){return Boolean(t&&t.then&&"function"==typeof t.then)}function p(t){return u(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function g(t,e){try{return t instanceof e}catch(t){return!1}}n.d(e,"d",(function(){return r})),n.d(e,"e",(function(){return o})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"k",(function(){return s})),n.d(e,"i",(function(){return l})),n.d(e,"h",(function(){return u})),n.d(e,"f",(function(){return c})),n.d(e,"c",(function(){return f})),n.d(e,"j",(function(){return h})),n.d(e,"m",(function(){return d})),n.d(e,"l",(function(){return p})),n.d(e,"g",(function(){return g}))},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var r;"undefined"!=typeof self&&self,r=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=15)}([function(t,e){e.nil=new Error("#NULL!"),e.div0=new Error("#DIV/0!"),e.value=new Error("#VALUE!"),e.ref=new Error("#REF!"),e.name=new Error("#NAME?"),e.num=new Error("#NUM!"),e.na=new Error("#N/A"),e.error=new Error("#ERROR!"),e.data=new Error("#GETTING_DATA")},function(t,e,n){var r=n(0);e.flattenShallow=function(t){return t&&t.reduce?t.reduce((function(t,e){var n=Array.isArray(t),r=Array.isArray(e);return n&&r?t.concat(e):n?(t.push(e),t):r?[t].concat(e):[t,e]})):t},e.isFlat=function(t){if(!t)return!1;for(var e=0;e<t.length;++e)if(Array.isArray(t[e]))return!1;return!0},e.flatten=function(){for(var t=e.argsToArray.apply(null,arguments);!e.isFlat(t);)t=e.flattenShallow(t);return t},e.argsToArray=function(t){var n=[];return e.arrayEach(t,(function(t){n.push(t)})),n},e.numbers=function(){var t=this.flatten.apply(null,arguments);return t.filter((function(t){return"number"==typeof t}))},e.cleanFloat=function(t){return Math.round(1e14*t)/1e14},e.parseBool=function(t){if("boolean"==typeof t)return t;if(t instanceof Error)return t;if("number"==typeof t)return 0!==t;if("string"==typeof t){var e=t.toUpperCase();if("TRUE"===e)return!0;if("FALSE"===e)return!1}return t instanceof Date&&!isNaN(t)||r.value},e.parseNumber=function(t){return void 0===t||""===t?r.value:isNaN(t)?r.value:parseFloat(t)},e.parseNumberArray=function(t){var n,o;if(!t||0===(n=t.length))return r.value;for(;n--;){if((o=e.parseNumber(t[n]))===r.value)return o;t[n]=o}return t},e.parseMatrix=function(t){var n;if(!t||0===t.length)return r.value;for(var o=0;o<t.length;o++)if(n=e.parseNumberArray(t[o]),t[o]=n,n instanceof Error)return n;return t};var o=new Date(Date.UTC(1900,0,1));e.parseDate=function(t){if(!isNaN(t)){if(t instanceof Date)return new Date(t);var e=parseInt(t,10);return e<0?r.num:e<=60?new Date(o.getTime()+864e5*(e-1)):new Date(o.getTime()+864e5*(e-2))}return"string"!=typeof t||(t=new Date(t),isNaN(t))?r.value:t},e.parseDateArray=function(t){for(var e,n=t.length;n--;){if((e=this.parseDate(t[n]))===r.value)return e;t[n]=e}return t},e.anyIsError=function(){for(var t=arguments.length;t--;)if(arguments[t]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(t){for(var e,n=t.length;n--;)if("number"!=typeof(e=t[n]))if(!0!==e)if(!1!==e){if("string"==typeof e){var r=this.parseNumber(e);r instanceof Error?t[n]=0:t[n]=r}}else t[n]=0;else t[n]=1;return t},e.rest=function(t,e){return e=e||1,t&&"function"==typeof t.slice?t.slice(e):t},e.initial=function(t,e){return e=e||1,t&&"function"==typeof t.slice?t.slice(0,t.length-e):t},e.arrayEach=function(t,e){for(var n=-1,r=t.length;++n<r&&!1!==e(t[n],n,t););return t},e.transpose=function(t){return t?t[0].map((function(e,n){return t.map((function(t){return t[n]}))})):r.value}},function(t,e,n){"use strict";var r;e.__esModule=!0,e.default=function(t){var e=void 0;return t=(t+"").replace(/#|!|\?/g,""),h[t]&&(e=h[t]),e||null},e.isValidStrict=function(t){var e=!1;for(var n in h)if(Object.prototype.hasOwnProperty.call(h,n)&&h[n]===t){e=!0;break}return e};var o=e.ERROR="ERROR",i=e.ERROR_DIV_ZERO="DIV/0",a=e.ERROR_NAME="NAME",s=e.ERROR_NOT_AVAILABLE="N/A",l=e.ERROR_NULL="NULL",u=e.ERROR_NUM="NUM",c=e.ERROR_REF="REF",f=e.ERROR_VALUE="VALUE",h=((r={})[o]="#ERROR!",r[i]="#DIV/0!",r[a]="#NAME?",r[s]="#N/A",r[l]="#NULL!",r[u]="#NUM!",r[c]="#REF!",r[f]="#VALUE!",r)},function(t,e,n){"use strict";function r(t){var e=void 0;return"number"==typeof t?e=t:"string"==typeof t&&(e=t.indexOf(".")>-1?parseFloat(t):parseInt(t,10)),e}e.__esModule=!0,e.toNumber=r,e.invertNumber=function(t){return-1*r(t)}},function(t,e,n){var r=n(1),o=n(0),i=n(5),a=n(8),s=n(7);e.ABS=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.abs(t)},e.ACOS=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.acos(t);return isNaN(e)&&(e=o.num),e},e.ACOSH=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.log(t+Math.sqrt(t*t-1));return isNaN(e)&&(e=o.num),e},e.ACOT=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.atan(1/t)},e.ACOTH=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=.5*Math.log((t+1)/(t-1));return isNaN(e)&&(e=o.num),e},e.AGGREGATE=function(t,n,a,s){if(t=r.parseNumber(t),n=r.parseNumber(t),r.anyIsError(t,n))return o.value;switch(t){case 1:return i.AVERAGE(a);case 2:return i.COUNT(a);case 3:return i.COUNTA(a);case 4:return i.MAX(a);case 5:return i.MIN(a);case 6:return e.PRODUCT(a);case 7:return i.STDEV.S(a);case 8:return i.STDEV.P(a);case 9:return e.SUM(a);case 10:return i.VAR.S(a);case 11:return i.VAR.P(a);case 12:return i.MEDIAN(a);case 13:return i.MODE.SNGL(a);case 14:return i.LARGE(a,s);case 15:return i.SMALL(a,s);case 16:return i.PERCENTILE.INC(a,s);case 17:return i.QUARTILE.INC(a,s);case 18:return i.PERCENTILE.EXC(a,s);case 19:return i.QUARTILE.EXC(a,s)}},e.ARABIC=function(t){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return o.value;var e=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(t){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]})),e},e.ASIN=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.asin(t);return isNaN(e)&&(e=o.num),e},e.ASINH=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.log(t+Math.sqrt(t*t+1))},e.ATAN=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.atan(t)},e.ATAN2=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:Math.atan2(t,e)},e.ATANH=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.log((1+t)/(1-t))/2;return isNaN(e)&&(e=o.num),e},e.BASE=function(t,e,n){if(n=n||0,t=r.parseNumber(t),e=r.parseNumber(e),n=r.parseNumber(n),r.anyIsError(t,e,n))return o.value;n=void 0===n?0:n;var i=t.toString(e);return new Array(Math.max(n+1-i.length,0)).join("0")+i},e.CEILING=function(t,n,i){if(n=void 0===n?1:Math.abs(n),i=i||0,t=r.parseNumber(t),n=r.parseNumber(n),i=r.parseNumber(i),r.anyIsError(t,n,i))return o.value;if(0===n)return 0;var a=-Math.floor(Math.log(n)/Math.log(10));return t>=0?e.ROUND(Math.ceil(t/n)*n,a):0===i?-e.ROUND(Math.floor(Math.abs(t)/n)*n,a):-e.ROUND(Math.ceil(Math.abs(t)/n)*n,a)},e.CEILING.MATH=e.CEILING,e.CEILING.PRECISE=e.CEILING,e.COMBIN=function(t,n){return t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n)?o.value:e.FACT(t)/(e.FACT(n)*e.FACT(t-n))},e.COMBINA=function(t,n){return t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n)?o.value:0===t&&0===n?1:e.COMBIN(t+n-1,t-1)},e.COS=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.cos(t)},e.COSH=function(t){return(t=r.parseNumber(t))instanceof Error?t:(Math.exp(t)+Math.exp(-t))/2},e.COT=function(t){return(t=r.parseNumber(t))instanceof Error?t:1/Math.tan(t)},e.COTH=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e+1)/(e-1)},e.CSC=function(t){return(t=r.parseNumber(t))instanceof Error?t:1/Math.sin(t)},e.CSCH=function(t){return(t=r.parseNumber(t))instanceof Error?t:2/(Math.exp(t)-Math.exp(-t))},e.DECIMAL=function(t,e){return arguments.length<1?o.value:parseInt(t,e)},e.DEGREES=function(t){return(t=r.parseNumber(t))instanceof Error?t:180*t/Math.PI},e.EVEN=function(t){return(t=r.parseNumber(t))instanceof Error?t:e.CEILING(t,-2,-1)},e.EXP=function(t){return arguments.length<1?o.na:"number"!=typeof t||arguments.length>1?o.error:t=Math.exp(t)};var l=[];e.FACT=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var n=Math.floor(t);return 0===n||1===n?1:l[n]>0?l[n]:(l[n]=e.FACT(n-1)*n,l[n])},e.FACTDOUBLE=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var n=Math.floor(t);return n<=0?1:n*e.FACTDOUBLE(n-2)},e.FLOOR=function(t,n){if(t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n))return o.value;if(0===n)return 0;if(!(t>0&&n>0||t<0&&n<0))return o.num;n=Math.abs(n);var i=-Math.floor(Math.log(n)/Math.log(10));return t>=0?e.ROUND(Math.floor(t/n)*n,i):-e.ROUND(Math.ceil(Math.abs(t)/n),i)},e.FLOOR.MATH=function(t,n,i){if(n=void 0===n?1:n,i=void 0===i?0:i,t=r.parseNumber(t),n=r.parseNumber(n),i=r.parseNumber(i),r.anyIsError(t,n,i))return o.value;if(0===n)return 0;n=n?Math.abs(n):1;var a=-Math.floor(Math.log(n)/Math.log(10));return t>=0?e.ROUND(Math.floor(t/n)*n,a):0===i||void 0===i?-e.ROUND(Math.ceil(Math.abs(t)/n)*n,a):-e.ROUND(Math.floor(Math.abs(t)/n)*n,a)},e.FLOOR.PRECISE=e.FLOOR.MATH,e.GCD=function(){var t=r.parseNumberArray(r.flatten(arguments));if(t instanceof Error)return t;for(var e=t.length,n=t[0],o=n<0?-n:n,i=1;i<e;i++){for(var a=t[i],s=a<0?-a:a;o&&s;)o>s?o%=s:s%=o;o+=s}return o},e.INT=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.floor(t)},e.ISO={CEILING:e.CEILING},e.LCM=function(){var t=r.parseNumberArray(r.flatten(arguments));if(t instanceof Error)return t;for(var e,n,o,i,a=1;void 0!==(o=t.pop());)for(;o>1;){if(o%2){for(e=3,n=Math.floor(Math.sqrt(o));e<=n&&o%e;e+=2);i=e<=n?e:o}else i=2;for(o/=i,a*=i,e=t.length;e;t[--e]%i==0&&1==(t[e]/=i)&&t.splice(e,1));}return a},e.LN=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.log(t)},e.LN10=function(){return Math.log(10)},e.LN2=function(){return Math.log(2)},e.LOG10E=function(){return Math.LOG10E},e.LOG2E=function(){return Math.LOG2E},e.LOG=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:(e=void 0===e?10:e,Math.log(t)/Math.log(e))},e.LOG10=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.log(t)/Math.log(10)},e.MOD=function(t,e){if(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e))return o.value;if(0===e)return o.div0;var n=Math.abs(t%e);return e>0?n:-n},e.MROUND=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:t*e<0?o.num:Math.round(t/e)*e},e.MULTINOMIAL=function(){var t=r.parseNumberArray(r.flatten(arguments));if(t instanceof Error)return t;for(var n=0,o=1,i=0;i<t.length;i++)n+=t[i],o*=e.FACT(t[i]);return e.FACT(n)/o},e.ODD=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.ceil(Math.abs(t));return e=1&e?e:e+1,t>0?e:-e},e.PI=function(){return Math.PI},e.E=function(){return Math.E},e.POWER=function(t,e){if(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e))return o.value;var n=Math.pow(t,e);return isNaN(n)?o.num:n},e.PRODUCT=function(){var t=r.parseNumberArray(r.flatten(arguments));if(t instanceof Error)return t;for(var e=1,n=0;n<t.length;n++)e*=t[n];return e},e.QUOTIENT=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:parseInt(t/e,10)},e.RADIANS=function(t){return(t=r.parseNumber(t))instanceof Error?t:t*Math.PI/180},e.RAND=function(){return Math.random()},e.RANDBETWEEN=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:t+Math.ceil((e-t+1)*Math.random())-1},e.ROMAN=function(t){if((t=r.parseNumber(t))instanceof Error)return t;for(var e=String(t).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],o="",i=3;i--;)o=(n[+e.pop()+10*i]||"")+o;return new Array(+e.join("")+1).join("M")+o},e.ROUND=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:Math.round(t*Math.pow(10,e))/Math.pow(10,e)},e.ROUNDDOWN=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)},e.ROUNDUP=function(t,e){return t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:(t>0?1:-1)*Math.ceil(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)},e.SEC=function(t){return(t=r.parseNumber(t))instanceof Error?t:1/Math.cos(t)},e.SECH=function(t){return(t=r.parseNumber(t))instanceof Error?t:2/(Math.exp(t)+Math.exp(-t))},e.SERIESSUM=function(t,e,n,i){if(t=r.parseNumber(t),e=r.parseNumber(e),n=r.parseNumber(n),i=r.parseNumberArray(i),r.anyIsError(t,e,n,i))return o.value;for(var a=i[0]*Math.pow(t,e),s=1;s<i.length;s++)a+=i[s]*Math.pow(t,e+s*n);return a},e.SIGN=function(t){return(t=r.parseNumber(t))instanceof Error?t:t<0?-1:0===t?0:1},e.SIN=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.sin(t)},e.SINH=function(t){return(t=r.parseNumber(t))instanceof Error?t:(Math.exp(t)-Math.exp(-t))/2},e.SQRT=function(t){return(t=r.parseNumber(t))instanceof Error?t:t<0?o.num:Math.sqrt(t)},e.SQRTPI=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.sqrt(t*Math.PI)},e.SQRT1_2=function(){return 1/Math.sqrt(2)},e.SQRT2=function(){return Math.sqrt(2)},e.SUBTOTAL=function(t,n){if((t=r.parseNumber(t))instanceof Error)return t;switch(t){case 1:return i.AVERAGE(n);case 2:return i.COUNT(n);case 3:return i.COUNTA(n);case 4:return i.MAX(n);case 5:return i.MIN(n);case 6:return e.PRODUCT(n);case 7:return i.STDEV.S(n);case 8:return i.STDEV.P(n);case 9:return e.SUM(n);case 10:return i.VAR.S(n);case 11:return i.VAR.P(n);case 101:return i.AVERAGE(n);case 102:return i.COUNT(n);case 103:return i.COUNTA(n);case 104:return i.MAX(n);case 105:return i.MIN(n);case 106:return e.PRODUCT(n);case 107:return i.STDEV.S(n);case 108:return i.STDEV.P(n);case 109:return e.SUM(n);case 110:return i.VAR.S(n);case 111:return i.VAR.P(n)}},e.ADD=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:t+e)},e.MINUS=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:t-e)},e.DIVIDE=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:0===e?o.div0:t/e)},e.MULTIPLY=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:t*e)},e.GTE=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.error:t>=e)},e.LT=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.error:t<e)},e.LTE=function(t,e){return 2!==arguments.length?o.na:(t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.error:t<=e)},e.EQ=function(t,e){return 2!==arguments.length?o.na:t===e},e.NE=function(t,e){return 2!==arguments.length?o.na:t!==e},e.POW=function(t,n){return 2!==arguments.length?o.na:(t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n)?o.error:e.POWER(t,n))},e.SUM=function(){var t=0;return r.arrayEach(r.argsToArray(arguments),(function(n){if("number"==typeof n)t+=n;else if("string"==typeof n){var r=parseFloat(n);!isNaN(r)&&(t+=r)}else Array.isArray(n)&&(t+=e.SUM.apply(null,n))})),t},e.SUMIF=function(t,e){if((t=r.parseNumberArray(r.flatten(t)))instanceof Error)return t;for(var n=0,o=void 0===e||"*"===e,i=o?null:s.parse(e+""),a=0;a<t.length;a++){var l=t[a];if(o)n+=l;else{var u=[s.createToken(l,s.TOKEN_TYPE_LITERAL)].concat(i);n+=s.compute(u)?l:0}}return n},e.SUMIFS=function(){var t=r.argsToArray(arguments),e=r.parseNumberArray(r.flatten(t.shift()));if(e instanceof Error)return e;for(var n=t,o=e.length,i=n.length,a=0,l=0;l<o;l++){for(var u=e[l],c=!1,f=0;f<i;f++){var h=n[f],d=void 0===h||"*"===h,p=!1;if(d)p=!0;else{var g=s.parse(h+""),v=[s.createToken(u,s.TOKEN_TYPE_LITERAL)].concat(g);p=s.compute(v)}if(!p){c=!1;break}c=!0}c&&(a+=u)}return a},e.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return o.value;for(var t,e,n,i,a=arguments.length+1,s=0,l=0;l<arguments[0].length;l++)if(arguments[0][l]instanceof Array)for(var u=0;u<arguments[0][l].length;u++){for(t=1,e=1;e<a;e++){if((i=r.parseNumber(arguments[e-1][l][u]))instanceof Error)return i;t*=i}s+=t}else{for(t=1,e=1;e<a;e++){if((n=r.parseNumber(arguments[e-1][l]))instanceof Error)return n;t*=n}s+=t}return s},e.SUMSQ=function(){var t=r.parseNumberArray(r.flatten(arguments));if(t instanceof Error)return t;for(var e=0,n=t.length,o=0;o<n;o++)e+=a.ISNUMBER(t[o])?t[o]*t[o]:0;return e},e.SUMX2MY2=function(t,e){if(t=r.parseNumberArray(r.flatten(t)),e=r.parseNumberArray(r.flatten(e)),r.anyIsError(t,e))return o.value;for(var n=0,i=0;i<t.length;i++)n+=t[i]*t[i]-e[i]*e[i];return n},e.SUMX2PY2=function(t,e){if(t=r.parseNumberArray(r.flatten(t)),e=r.parseNumberArray(r.flatten(e)),r.anyIsError(t,e))return o.value;var n=0;t=r.parseNumberArray(r.flatten(t)),e=r.parseNumberArray(r.flatten(e));for(var i=0;i<t.length;i++)n+=t[i]*t[i]+e[i]*e[i];return n},e.SUMXMY2=function(t,e){if(t=r.parseNumberArray(r.flatten(t)),e=r.parseNumberArray(r.flatten(e)),r.anyIsError(t,e))return o.value;var n=0;t=r.flatten(t),e=r.flatten(e);for(var i=0;i<t.length;i++)n+=Math.pow(t[i]-e[i],2);return n},e.TAN=function(t){return(t=r.parseNumber(t))instanceof Error?t:Math.tan(t)},e.TANH=function(t){if((t=r.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e-1)/(e+1)},e.TRUNC=function(t,e){return e=void 0===e?0:e,t=r.parseNumber(t),e=r.parseNumber(e),r.anyIsError(t,e)?o.value:(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)}},function(t,e,n){var r=n(4),o=n(6),i=n(10),a=n(1),s=n(7),l=n(0),u=n(11);e.AVEDEV=function(){var t=a.parseNumberArray(a.flatten(arguments));return t instanceof Error?t:i.sum(i(t).subtract(i.mean(t)).abs()[0])/t.length},e.AVERAGE=function(){for(var t,e=a.numbers(a.flatten(arguments)),n=e.length,r=0,o=0,i=0;i<n;i++)r+=e[i],o+=1;return t=r/o,isNaN(t)&&(t=l.num),t},e.AVERAGEA=function(){for(var t,e=a.flatten(arguments),n=e.length,r=0,o=0,i=0;i<n;i++){var s=e[i];"number"==typeof s&&(r+=s),!0===s&&r++,null!==s&&o++}return t=r/o,isNaN(t)&&(t=l.num),t},e.AVERAGEIF=function(t,e,n){if(arguments.length<=1)return l.na;if(n=n||t,t=a.flatten(t),(n=a.parseNumberArray(a.flatten(n)))instanceof Error)return n;for(var r=0,o=0,i=void 0===e||"*"===e,u=i?null:s.parse(e+""),c=0;c<t.length;c++){var f=t[c];if(i)o+=n[c],r++;else{var h=[s.createToken(f,s.TOKEN_TYPE_LITERAL)].concat(u);s.compute(h)&&(o+=n[c],r++)}}return o/r},e.AVERAGEIFS=function(){for(var t=a.argsToArray(arguments),e=(t.length-1)/2,n=a.flatten(t[0]),r=0,o=0,i=0;i<n.length;i++){for(var l=!1,u=0;u<e;u++){var c=t[2*u+1][i],f=t[2*u+2],h=void 0===f||"*"===f,d=!1;if(h)d=!0;else{var p=s.parse(f+""),g=[s.createToken(c,s.TOKEN_TYPE_LITERAL)].concat(p);d=s.compute(g)}if(!d){l=!1;break}l=!0}l&&(o+=n[i],r++)}var v=o/r;return isNaN(v)?0:v},e.BETA={},e.BETA.DIST=function(t,e,n,r,o,s){return arguments.length<4?l.value:(o=void 0===o?0:o,s=void 0===s?1:s,t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),o=a.parseNumber(o),s=a.parseNumber(s),a.anyIsError(t,e,n,o,s)?l.value:(t=(t-o)/(s-o),r?i.beta.cdf(t,e,n):i.beta.pdf(t,e,n)))},e.BETA.INV=function(t,e,n,r,o){return r=void 0===r?0:r,o=void 0===o?1:o,t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(t,e,n,r,o)?l.value:i.beta.inv(t,e,n)*(o-r)+r},e.BINOM={},e.BINOM.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),r=a.parseNumber(r),a.anyIsError(t,e,n,r)?l.value:r?i.binomial.cdf(t,e,n):i.binomial.pdf(t,e,n)},e.BINOM.DIST.RANGE=function(t,e,n,o){if(o=void 0===o?n:o,t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),o=a.parseNumber(o),a.anyIsError(t,e,n,o))return l.value;for(var i=0,s=n;s<=o;s++)i+=r.COMBIN(t,s)*Math.pow(e,s)*Math.pow(1-e,t-s);return i},e.BINOM.INV=function(t,e,n){if(t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n))return l.value;for(var r=0;r<=t;){if(i.binomial.cdf(r,t,e)>=n)return r;r++}},e.CHISQ={},e.CHISQ.DIST=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:n?i.chisquare.cdf(t,e):i.chisquare.pdf(t,e)},e.CHISQ.DIST.RT=function(t,e){return!t|!e?l.na:t<1||e>Math.pow(10,10)?l.num:"number"!=typeof t||"number"!=typeof e?l.value:1-i.chisquare.cdf(t,e)},e.CHISQ.INV=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:i.chisquare.inv(t,e)},e.CHISQ.INV.RT=function(t,e){return!t|!e?l.na:t<0||t>1||e<1||e>Math.pow(10,10)?l.num:"number"!=typeof t||"number"!=typeof e?l.value:i.chisquare.inv(1-t,e)},e.CHISQ.TEST=function(t,e){if(2!==arguments.length)return l.na;if(!(t instanceof Array&&e instanceof Array))return l.value;if(t.length!==e.length)return l.value;if(t[0]&&e[0]&&t[0].length!==e[0].length)return l.value;var n,r,o,i=t.length;for(r=0;r<i;r++)t[r]instanceof Array||(n=t[r],t[r]=[],t[r].push(n)),e[r]instanceof Array||(n=e[r],e[r]=[],e[r].push(n));var a=t[0].length,s=1===a?i-1:(i-1)*(a-1),u=0,c=Math.PI;for(r=0;r<i;r++)for(o=0;o<a;o++)u+=Math.pow(t[r][o]-e[r][o],2)/e[r][o];function f(t,e){var n=Math.exp(-.5*t);e%2==1&&(n*=Math.sqrt(2*t/c));for(var r=e;r>=2;)n=n*t/r,r-=2;for(var o=n,i=e;o>1e-10*n;)n+=o=o*t/(i+=2);return 1-n}return Math.round(1e6*f(u,s))/1e6},e.COLUMN=function(t,e){return 2!==arguments.length?l.na:e<0?l.num:t instanceof Array&&"number"==typeof e?0!==t.length?i.col(t,e):void 0:l.value},e.COLUMNS=function(t){return 1!==arguments.length?l.na:t instanceof Array?0===t.length?0:i.cols(t):l.value},e.CONFIDENCE={},e.CONFIDENCE.NORM=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:i.normalci(1,t,e,n)[1]-1},e.CONFIDENCE.T=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:i.tci(1,t,e,n)[1]-1},e.CORREL=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e)?l.value:i.corrcoeff(t,e)},e.COUNT=function(){return a.numbers(a.flatten(arguments)).length},e.COUNTA=function(){var t=a.flatten(arguments);return t.length-e.COUNTBLANK(t)},e.COUNTIN=function(t,e){var n=0;t=a.flatten(t);for(var r=0;r<t.length;r++)t[r]===e&&n++;return n},e.COUNTBLANK=function(){for(var t,e=a.flatten(arguments),n=0,r=0;r<e.length;r++)null!==(t=e[r])&&""!==t||n++;return n},e.COUNTIF=function(t,e){if(t=a.flatten(t),void 0===e||"*"===e)return t.length;for(var n=0,r=s.parse(e+""),o=0;o<t.length;o++){var i=t[o],l=[s.createToken(i,s.TOKEN_TYPE_LITERAL)].concat(r);s.compute(l)&&n++}return n},e.COUNTIFS=function(){for(var t=a.argsToArray(arguments),e=new Array(a.flatten(t[0]).length),n=0;n<e.length;n++)e[n]=!0;for(n=0;n<t.length;n+=2){var r=a.flatten(t[n]),o=t[n+1],i=void 0===o||"*"===o;if(!i)for(var l=s.parse(o+""),u=0;u<r.length;u++){var c=r[u],f=[s.createToken(c,s.TOKEN_TYPE_LITERAL)].concat(l);e[u]=e[u]&&s.compute(f)}}var h=0;for(n=0;n<e.length;n++)e[n]&&h++;return h},e.COUNTUNIQUE=function(){return u.UNIQUE.apply(null,a.flatten(arguments)).length},e.COVARIANCE={},e.COVARIANCE.P=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var n=i.mean(t),r=i.mean(e),o=0,s=t.length,u=0;u<s;u++)o+=(t[u]-n)*(e[u]-r);return o/s},e.COVARIANCE.S=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e)?l.value:i.covariance(t,e)},e.DEVSQ=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},e.EXPON={},e.EXPON.DIST=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:n?i.exponential.cdf(t,e):i.exponential.pdf(t,e)},e.F={},e.F.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:r?i.centralF.cdf(t,e,n):i.centralF.pdf(t,e,n)},e.F.DIST.RT=function(t,e,n){return 3!==arguments.length?l.na:t<0||e<1||n<1?l.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?l.value:1-i.centralF.cdf(t,e,n)},e.F.INV=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:t<=0||t>1?l.num:i.centralF.inv(t,e,n)},e.F.INV.RT=function(t,e,n){return 3!==arguments.length?l.na:t<0||t>1||e<1||e>Math.pow(10,10)||n<1||n>Math.pow(10,10)?l.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?l.value:i.centralF.inv(1-t,e,n)},e.F.TEST=function(t,e){if(!t||!e)return l.na;if(!(t instanceof Array&&e instanceof Array))return l.na;if(t.length<2||e.length<2)return l.div0;var n=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},o=r.SUM(t)/t.length,i=r.SUM(e)/e.length;return n(t,o)/(t.length-1)/(n(e,i)/(e.length-1))},e.FISHER=function(t){return(t=a.parseNumber(t))instanceof Error?t:Math.log((1+t)/(1-t))/2},e.FISHERINV=function(t){if((t=a.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e-1)/(e+1)},e.FORECAST=function(t,e,n){if(t=a.parseNumber(t),e=a.parseNumberArray(a.flatten(e)),n=a.parseNumberArray(a.flatten(n)),a.anyIsError(t,e,n))return l.value;for(var r=i.mean(n),o=i.mean(e),s=n.length,u=0,c=0,f=0;f<s;f++)u+=(n[f]-r)*(e[f]-o),c+=Math.pow(n[f]-r,2);var h=u/c;return o-h*r+h*t},e.FREQUENCY=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var n=t.length,r=e.length,o=[],i=0;i<=r;i++){o[i]=0;for(var s=0;s<n;s++)0===i?t[s]<=e[0]&&(o[0]+=1):i<r?t[s]>e[i-1]&&t[s]<=e[i]&&(o[i]+=1):i===r&&t[s]>e[r-1]&&(o[r]+=1)}return o},e.GAMMA=function(t){return(t=a.parseNumber(t))instanceof Error?t:0===t?l.num:parseInt(t,10)===t&&t<0?l.num:i.gammafn(t)},e.GAMMA.DIST=function(t,e,n,r){return 4!==arguments.length?l.na:t<0||e<=0||n<=0?l.value:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?l.value:r?i.gamma.cdf(t,e,n,!0):i.gamma.pdf(t,e,n,!1)},e.GAMMA.INV=function(t,e,n){return 3!==arguments.length?l.na:t<0||t>1||e<=0||n<=0?l.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof n?l.value:i.gamma.inv(t,e,n)},e.GAMMALN=function(t){return(t=a.parseNumber(t))instanceof Error?t:i.gammaln(t)},e.GAMMALN.PRECISE=function(t){return 1!==arguments.length?l.na:t<=0?l.num:"number"!=typeof t?l.value:i.gammaln(t)},e.GAUSS=function(t){return(t=a.parseNumber(t))instanceof Error?t:i.normal.cdf(t,0,1)-.5},e.GEOMEAN=function(){var t=a.parseNumberArray(a.flatten(arguments));return t instanceof Error?t:i.geomean(t)},e.GROWTH=function(t,e,n,r){if((t=a.parseNumberArray(t))instanceof Error)return t;var o;if(void 0===e)for(e=[],o=1;o<=t.length;o++)e.push(o);if(void 0===n)for(n=[],o=1;o<=t.length;o++)n.push(o);if(e=a.parseNumberArray(e),n=a.parseNumberArray(n),a.anyIsError(e,n))return l.value;void 0===r&&(r=!0);var i,s,u=t.length,c=0,f=0,h=0,d=0;for(o=0;o<u;o++){var p=e[o],g=Math.log(t[o]);c+=p,f+=g,h+=p*g,d+=p*p}c/=u,f/=u,h/=u,d/=u,r?s=f-(i=(h-c*f)/(d-c*c))*c:(i=h/d,s=0);var v=[];for(o=0;o<n.length;o++)v.push(Math.exp(s+i*n[o]));return v},e.HARMEAN=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=t.length,n=0,r=0;r<e;r++)n+=1/t[r];return e/n},e.HYPGEOM={},e.HYPGEOM.DIST=function(t,e,n,o,i){if(t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),o=a.parseNumber(o),a.anyIsError(t,e,n,o))return l.value;function s(t,e,n,o){return r.COMBIN(n,t)*r.COMBIN(o-n,e-t)/r.COMBIN(o,e)}return i?function(t,e,n,r){for(var o=0,i=0;i<=t;i++)o+=s(i,e,n,r);return o}(t,e,n,o):s(t,e,n,o)},e.INTERCEPT=function(t,n){return t=a.parseNumberArray(t),n=a.parseNumberArray(n),a.anyIsError(t,n)?l.value:t.length!==n.length?l.na:e.FORECAST(0,t,n)},e.KURT=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),n=t.length,r=0,o=0;o<n;o++)r+=Math.pow(t[o]-e,4);return n*(n+1)/((n-1)*(n-2)*(n-3))*(r/=Math.pow(i.stdev(t,!0),4))-3*(n-1)*(n-1)/((n-2)*(n-3))},e.LARGE=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e)?t:t.sort((function(t,e){return e-t}))[e-1]},e.LINEST=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var n=i.mean(t),r=i.mean(e),o=e.length,s=0,u=0,c=0;c<o;c++)s+=(e[c]-r)*(t[c]-n),u+=Math.pow(e[c]-r,2);var f=s/u;return[f,n-f*r]},e.LOGEST=function(t,n){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumberArray(a.flatten(n)),a.anyIsError(t,n))return l.value;for(var r=0;r<t.length;r++)t[r]=Math.log(t[r]);var o=e.LINEST(t,n);return o[0]=Math.round(1e6*Math.exp(o[0]))/1e6,o[1]=Math.round(1e6*Math.exp(o[1]))/1e6,o},e.LOGNORM={},e.LOGNORM.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:r?i.lognormal.cdf(t,e,n):i.lognormal.pdf(t,e,n)},e.LOGNORM.INV=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:i.lognormal.inv(t,e,n)},e.MAX=function(){var t=a.numbers(a.flatten(arguments));return 0===t.length?0:Math.max.apply(Math,t)},e.MAXA=function(){var t=a.arrayValuesToNumbers(a.flatten(arguments));return 0===t.length?0:Math.max.apply(Math,t)},e.MEDIAN=function(){var t=a.arrayValuesToNumbers(a.flatten(arguments)),e=i.median(t);return isNaN(e)&&(e=l.num),e},e.MIN=function(){var t=a.numbers(a.flatten(arguments));return 0===t.length?0:Math.min.apply(Math,t)},e.MINA=function(){var t=a.arrayValuesToNumbers(a.flatten(arguments));return 0===t.length?0:Math.min.apply(Math,t)},e.MODE={},e.MODE.MULT=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e,n=t.length,r={},o=[],i=0,s=0;s<n;s++)r[e=t[s]]=r[e]?r[e]+1:1,r[e]>i&&(i=r[e],o=[]),r[e]===i&&(o[o.length]=e);return o},e.MODE.SNGL=function(){var t=a.parseNumberArray(a.flatten(arguments));return t instanceof Error?t:e.MODE.MULT(t).sort((function(t,e){return t-e}))[0]},e.NEGBINOM={},e.NEGBINOM.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:r?i.negbin.cdf(t,e,n):i.negbin.pdf(t,e,n)},e.NORM={},e.NORM.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:n<=0?l.num:r?i.normal.cdf(t,e,n):i.normal.pdf(t,e,n)},e.NORM.INV=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:i.normal.inv(t,e,n)},e.NORM.S={},e.NORM.S.DIST=function(t,e){return(t=a.parseNumber(t))instanceof Error?l.value:e?i.normal.cdf(t,0,1):i.normal.pdf(t,0,1)},e.NORM.S.INV=function(t){return(t=a.parseNumber(t))instanceof Error?l.value:i.normal.inv(t,0,1)},e.PEARSON=function(t,e){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return l.value;for(var n=i.mean(t),r=i.mean(e),o=t.length,s=0,u=0,c=0,f=0;f<o;f++)s+=(t[f]-n)*(e[f]-r),u+=Math.pow(t[f]-n,2),c+=Math.pow(e[f]-r,2);return s/Math.sqrt(u*c)},e.PERCENTILE={},e.PERCENTILE.EXC=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e))return l.value;var n=(t=t.sort((function(t,e){return t-e}))).length;if(e<1/(n+1)||e>1-1/(n+1))return l.num;var r=e*(n+1)-1,o=Math.floor(r);return a.cleanFloat(r===o?t[r]:t[o]+(r-o)*(t[o+1]-t[o]))},e.PERCENTILE.INC=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e))return l.value;var n=e*((t=t.sort((function(t,e){return t-e}))).length-1),r=Math.floor(n);return a.cleanFloat(n===r?t[n]:t[r]+(n-r)*(t[r+1]-t[r]))},e.PERCENTRANK={},e.PERCENTRANK.EXC=function(t,e,n){if(n=void 0===n?3:n,t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n))return l.value;t=t.sort((function(t,e){return t-e}));for(var r=u.UNIQUE.apply(null,t),o=t.length,i=r.length,s=Math.pow(10,n),c=0,f=!1,h=0;!f&&h<i;)e===r[h]?(c=(t.indexOf(r[h])+1)/(o+1),f=!0):e>=r[h]&&(e<r[h+1]||h===i-1)&&(c=(t.indexOf(r[h])+1+(e-r[h])/(r[h+1]-r[h]))/(o+1),f=!0),h++;return Math.floor(c*s)/s},e.PERCENTRANK.INC=function(t,e,n){if(n=void 0===n?3:n,t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n))return l.value;t=t.sort((function(t,e){return t-e}));for(var r=u.UNIQUE.apply(null,t),o=t.length,i=r.length,s=Math.pow(10,n),c=0,f=!1,h=0;!f&&h<i;)e===r[h]?(c=t.indexOf(r[h])/(o-1),f=!0):e>=r[h]&&(e<r[h+1]||h===i-1)&&(c=(t.indexOf(r[h])+(e-r[h])/(r[h+1]-r[h]))/(o-1),f=!0),h++;return Math.floor(c*s)/s},e.PERMUT=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:r.FACT(t)/r.FACT(t-e)},e.PERMUTATIONA=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:Math.pow(t,e)},e.PHI=function(t){return(t=a.parseNumber(t))instanceof Error?l.value:Math.exp(-.5*t*t)/2.5066282746310002},e.POISSON={},e.POISSON.DIST=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:n?i.poisson.cdf(t,e):i.poisson.pdf(t,e)},e.PROB=function(t,e,n,r){if(void 0===n)return 0;if(r=void 0===r?n:r,t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),n=a.parseNumber(n),r=a.parseNumber(r),a.anyIsError(t,e,n,r))return l.value;if(n===r)return t.indexOf(n)>=0?e[t.indexOf(n)]:0;for(var o=t.sort((function(t,e){return t-e})),i=o.length,s=0,u=0;u<i;u++)o[u]>=n&&o[u]<=r&&(s+=e[t.indexOf(o[u])]);return s},e.QUARTILE={},e.QUARTILE.EXC=function(t,n){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumber(n),a.anyIsError(t,n))return l.value;switch(n){case 1:return e.PERCENTILE.EXC(t,.25);case 2:return e.PERCENTILE.EXC(t,.5);case 3:return e.PERCENTILE.EXC(t,.75);default:return l.num}},e.QUARTILE.INC=function(t,n){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumber(n),a.anyIsError(t,n))return l.value;switch(n){case 1:return e.PERCENTILE.INC(t,.25);case 2:return e.PERCENTILE.INC(t,.5);case 3:return e.PERCENTILE.INC(t,.75);default:return l.num}},e.RANK={},e.RANK.AVG=function(t,e,n){if(t=a.parseNumber(t),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var r=(n=n||!1)?function(t,e){return t-e}:function(t,e){return e-t},o=(e=(e=a.flatten(e)).sort(r)).length,i=0,s=0;s<o;s++)e[s]===t&&i++;return i>1?(2*e.indexOf(t)+i+1)/2:e.indexOf(t)+1},e.RANK.EQ=function(t,e,n){if(t=a.parseNumber(t),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;var r=(n=n||!1)?function(t,e){return t-e}:function(t,e){return e-t};return(e=e.sort(r)).indexOf(t)+1},e.ROW=function(t,e){return 2!==arguments.length?l.na:e<0?l.num:t instanceof Array&&"number"==typeof e?0!==t.length?i.row(t,e):void 0:l.value},e.ROWS=function(t){return 1!==arguments.length?l.na:t instanceof Array?0===t.length?0:i.rows(t):l.value},e.RSQ=function(t,n){return t=a.parseNumberArray(a.flatten(t)),n=a.parseNumberArray(a.flatten(n)),a.anyIsError(t,n)?l.value:Math.pow(e.PEARSON(t,n),2)},e.SKEW=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),n=t.length,r=0,o=0;o<n;o++)r+=Math.pow(t[o]-e,3);return n*r/((n-1)*(n-2)*Math.pow(i.stdev(t,!0),3))},e.SKEW.P=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),n=t.length,r=0,o=0,s=0;s<n;s++)o+=Math.pow(t[s]-e,3),r+=Math.pow(t[s]-e,2);return r/=n,(o/=n)/Math.pow(r,1.5)},e.SLOPE=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var n=i.mean(e),r=i.mean(t),o=e.length,s=0,u=0,c=0;c<o;c++)s+=(e[c]-n)*(t[c]-r),u+=Math.pow(e[c]-n,2);return s/u},e.SMALL=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e)?t:t.sort((function(t,e){return t-e}))[e-1]},e.STANDARDIZE=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:(t-e)/n},e.STDEV={},e.STDEV.P=function(){var t=e.VAR.P.apply(this,arguments),n=Math.sqrt(t);return isNaN(n)&&(n=l.num),n},e.STDEV.S=function(){var t=e.VAR.S.apply(this,arguments),n=Math.sqrt(t);return n},e.STDEVA=function(){var t=e.VARA.apply(this,arguments),n=Math.sqrt(t);return n},e.STDEVPA=function(){var t=e.VARPA.apply(this,arguments),n=Math.sqrt(t);return isNaN(n)&&(n=l.num),n},e.STEYX=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var n=i.mean(e),r=i.mean(t),o=e.length,s=0,u=0,c=0,f=0;f<o;f++)s+=Math.pow(t[f]-r,2),u+=(e[f]-n)*(t[f]-r),c+=Math.pow(e[f]-n,2);return Math.sqrt((s-u*u/c)/(o-2))},e.TRANSPOSE=function(t){return t?i.transpose(t):l.na},e.T=o.T,e.T.DIST=function(t,e,n){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:n?i.studentt.cdf(t,e):i.studentt.pdf(t,e)},e.T.DIST["2T"]=function(t,e){return 2!==arguments.length?l.na:t<0||e<1?l.num:"number"!=typeof t||"number"!=typeof e?l.value:2*(1-i.studentt.cdf(t,e))},e.T.DIST.RT=function(t,e){return 2!==arguments.length?l.na:t<0||e<1?l.num:"number"!=typeof t||"number"!=typeof e?l.value:1-i.studentt.cdf(t,e)},e.T.INV=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:i.studentt.inv(t,e)},e.T.INV["2T"]=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),t<=0||t>1||e<1?l.num:a.anyIsError(t,e)?l.value:Math.abs(i.studentt.inv(t/2,e))},e.T.TEST=function(t,n){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumberArray(a.flatten(n)),a.anyIsError(t,n))return l.value;var r,o=i.mean(t),s=i.mean(n),u=0,c=0;for(r=0;r<t.length;r++)u+=Math.pow(t[r]-o,2);for(r=0;r<n.length;r++)c+=Math.pow(n[r]-s,2);u/=t.length-1,c/=n.length-1;var f=Math.abs(o-s)/Math.sqrt(u/t.length+c/n.length);return e.T.DIST["2T"](f,t.length+n.length-2)},e.TREND=function(t,n,r){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumberArray(a.flatten(n)),r=a.parseNumberArray(a.flatten(r)),a.anyIsError(t,n,r))return l.value;var o=e.LINEST(t,n),i=o[0],s=o[1],u=[];return r.forEach((function(t){u.push(i*t+s)})),u},e.TRIMMEAN=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e))return l.value;var n=r.FLOOR(t.length*e,2)/2;return i.mean(a.initial(a.rest(t.sort((function(t,e){return t-e})),n),n))},e.VAR={},e.VAR.P=function(){for(var t,n=a.numbers(a.flatten(arguments)),r=n.length,o=0,i=e.AVERAGE(n),s=0;s<r;s++)o+=Math.pow(n[s]-i,2);return t=o/r,isNaN(t)&&(t=l.num),t},e.VAR.S=function(){for(var t=a.numbers(a.flatten(arguments)),n=t.length,r=0,o=e.AVERAGE(t),i=0;i<n;i++)r+=Math.pow(t[i]-o,2);return r/(n-1)},e.VARA=function(){for(var t=a.flatten(arguments),n=t.length,r=0,o=0,i=e.AVERAGEA(t),s=0;s<n;s++){var l=t[s];r+="number"==typeof l?Math.pow(l-i,2):!0===l?Math.pow(1-i,2):Math.pow(0-i,2),null!==l&&o++}return r/(o-1)},e.VARPA=function(){for(var t,n=a.flatten(arguments),r=n.length,o=0,i=0,s=e.AVERAGEA(n),u=0;u<r;u++){var c=n[u];o+="number"==typeof c?Math.pow(c-s,2):!0===c?Math.pow(1-s,2):Math.pow(0-s,2),null!==c&&i++}return t=o/i,isNaN(t)&&(t=l.num),t},e.WEIBULL={},e.WEIBULL.DIST=function(t,e,n,r){return t=a.parseNumber(t),e=a.parseNumber(e),n=a.parseNumber(n),a.anyIsError(t,e,n)?l.value:r?1-Math.exp(-Math.pow(t/n,e)):Math.pow(t,e-1)*Math.exp(-Math.pow(t/n,e))*e/Math.pow(n,e)},e.Z={},e.Z.TEST=function(t,n,r){if(t=a.parseNumberArray(a.flatten(t)),n=a.parseNumber(n),a.anyIsError(t,n))return l.value;r=r||e.STDEV.S(t);var o=t.length;return 1-e.NORM.S.DIST((e.AVERAGE(t)-n)/(r/Math.sqrt(o)),!0)}},function(t,e,n){var r=n(1),o=n(0);e.ASC=function(){throw new Error("ASC is not implemented")},e.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},e.CHAR=function(t){return(t=r.parseNumber(t))instanceof Error?t:String.fromCharCode(t)},e.CLEAN=function(t){return(t=t||"").replace(/[\0-\x1F]/g,"")},e.CODE=function(t){var e=(t=t||"").charCodeAt(0);return isNaN(e)&&(e=o.na),e},e.CONCATENATE=function(){for(var t=r.flatten(arguments),e=0;(e=t.indexOf(!0))>-1;)t[e]="TRUE";for(var n=0;(n=t.indexOf(!1))>-1;)t[n]="FALSE";return t.join("")},e.DBCS=function(){throw new Error("DBCS is not implemented")},e.DOLLAR=function(){throw new Error("DOLLAR is not implemented")},e.EXACT=function(t,e){return 2!==arguments.length?o.na:t===e},e.FIND=function(t,e,n){return arguments.length<2?o.na:(n=void 0===n?0:n,e?e.indexOf(t,n-1)+1:null)},e.FIXED=function(){throw new Error("FIXED is not implemented")},e.HTML2TEXT=function(t){var e="";return t&&(t instanceof Array?t.forEach((function(t){""!==e&&(e+="\n"),e+=t.replace(/<(?:.|\n)*?>/gm,"")})):e=t.replace(/<(?:.|\n)*?>/gm,"")),e},e.LEFT=function(t,e){return e=void 0===e?1:e,(e=r.parseNumber(e))instanceof Error||"string"!=typeof t?o.value:t?t.substring(0,e):null},e.LEN=function(t){return 0===arguments.length?o.error:"string"==typeof t?t?t.length:0:t.length?t.length:o.value},e.LOWER=function(t){return"string"!=typeof t?o.value:t?t.toLowerCase():t},e.MID=function(t,e,n){if(e=r.parseNumber(e),n=r.parseNumber(n),r.anyIsError(e,n)||"string"!=typeof t)return n;var o=e-1,i=o+n;return t.substring(o,i)},e.NUMBERVALUE=function(t,e,n){return e=void 0===e?".":e,n=void 0===n?",":n,Number(t.replace(e,".").replace(n,""))},e.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},e.PROPER=function(t){return void 0===t||0===t.length?o.value:(!0===t&&(t="TRUE"),!1===t&&(t="FALSE"),isNaN(t)&&"number"==typeof t?o.value:("number"==typeof t&&(t=""+t),t.replace(/\w\S*/g,(function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()}))))},e.REGEXEXTRACT=function(t,e){if(arguments.length<2)return o.na;var n=t.match(new RegExp(e));return n?n[n.length>1?n.length-1:0]:null},e.REGEXMATCH=function(t,e,n){if(arguments.length<2)return o.na;var r=t.match(new RegExp(e));return n?r:!!r},e.REGEXREPLACE=function(t,e,n){return arguments.length<3?o.na:t.replace(new RegExp(e),n)},e.REPLACE=function(t,e,n,i){return e=r.parseNumber(e),n=r.parseNumber(n),r.anyIsError(e,n)||"string"!=typeof t||"string"!=typeof i?o.value:t.substr(0,e-1)+i+t.substr(e-1+n)},e.REPT=function(t,e){return(e=r.parseNumber(e))instanceof Error?e:new Array(e+1).join(t)},e.RIGHT=function(t,e){return e=void 0===e?1:e,(e=r.parseNumber(e))instanceof Error?e:t?t.substring(t.length-e):o.na},e.SEARCH=function(t,e,n){var r;return"string"!=typeof t||"string"!=typeof e?o.value:(n=void 0===n?0:n,0===(r=e.toLowerCase().indexOf(t.toLowerCase(),n-1)+1)?o.value:r)},e.SPLIT=function(t,e){return t.split(e)},e.SUBSTITUTE=function(t,e,n,r){if(arguments.length<2)return o.na;if(!(t&&e&&n))return t;if(void 0===r)return t.replace(new RegExp(e,"g"),n);for(var i=0,a=0;t.indexOf(e,i)>0;)if(i=t.indexOf(e,i+1),++a===r)return t.substring(0,i)+n+t.substring(i+e.length)},e.T=function(t){return"string"==typeof t?t:""},e.TEXT=function(){throw new Error("TEXT is not implemented")},e.TRIM=function(t){return"string"!=typeof t?o.value:t.replace(/ +/g," ").trim()},e.UNICHAR=e.CHAR,e.UNICODE=e.CODE,e.UPPER=function(t){return"string"!=typeof t?o.value:t.toUpperCase()},e.VALUE=function(){throw new Error("VALUE is not implemented")}},function(t,e){var n=[">",">=","<","<=","=","<>"],r=["operator","literal"];function o(t,e){if(-1===r.indexOf(e))throw new Error("Unsupported token type: "+e);return{value:t,type:e}}function i(t){for(var e,r="",i=[],a=0;a<t.length;a++){var s=t[a];0===a&&n.indexOf(s)>=0?i.push(o(s,"operator")):r+=s}return r.length>0&&i.push(o("string"!=typeof(e=r)?e:(/^\d+(\.\d+)?$/.test(e)&&(e=-1===e.indexOf(".")?parseInt(e,10):parseFloat(e)),e),"literal")),i.length>0&&"operator"!==i[0].type&&i.unshift(o("=","operator")),i}e.TOKEN_TYPE_OPERATOR="operator",e.TOKEN_TYPE_LITERAL="literal",e.parse=function(t){return i(function(t){for(var e=t.length,n=[],r=0,o="",i="";r<e;){var a=t.charAt(r);switch(a){case">":case"<":case"=":i+=a,o.length>0&&(n.push(o),o="");break;default:i.length>0&&(n.push(i),i=""),o+=a}r++}return o.length>0&&n.push(o),i.length>0&&n.push(i),n}(t))},e.createToken=o,e.compute=function(t){for(var e,n=[],r=0;r<t.length;r++){var o=t[r];switch(o.type){case"operator":e=o.value;break;case"literal":n.push(o.value)}}return function(t,e){var n=!1;switch(e){case">":n=t[0]>t[1];break;case">=":n=t[0]>=t[1];break;case"<":n=t[0]<t[1];break;case"<=":n=t[0]<=t[1];break;case"=":n=t[0]==t[1];break;case"<>":n=t[0]!=t[1]}return n}(n,e)}},function(t,e,n){var r=n(0);e.CELL=function(){throw new Error("CELL is not implemented")},e.ERROR={},e.ERROR.TYPE=function(t){switch(t){case r.nil:return 1;case r.div0:return 2;case r.value:return 3;case r.ref:return 4;case r.name:return 5;case r.num:return 6;case r.na:return 7;case r.data:return 8}return r.na},e.INFO=function(){throw new Error("INFO is not implemented")},e.ISBLANK=function(t){return null===t},e.ISBINARY=function(t){return/^[01]{1,10}$/.test(t)},e.ISERR=function(t){return[r.value,r.ref,r.div0,r.num,r.name,r.nil].indexOf(t)>=0||"number"==typeof t&&(isNaN(t)||!isFinite(t))},e.ISERROR=function(t){return e.ISERR(t)||t===r.na},e.ISEVEN=function(t){return!(1&Math.floor(Math.abs(t)))},e.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},e.ISLOGICAL=function(t){return!0===t||!1===t},e.ISNA=function(t){return t===r.na},e.ISNONTEXT=function(t){return"string"!=typeof t},e.ISNUMBER=function(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)},e.ISODD=function(t){return!!(1&Math.floor(Math.abs(t)))},e.ISREF=function(){throw new Error("ISREF is not implemented")},e.ISTEXT=function(t){return"string"==typeof t},e.N=function(t){return this.ISNUMBER(t)?t:t instanceof Date?t.getTime():!0===t?1:!1===t?0:this.ISERROR(t)?t:0},e.NA=function(){return r.na},e.SHEET=function(){throw new Error("SHEET is not implemented")},e.SHEETS=function(){throw new Error("SHEETS is not implemented")},e.TYPE=function(t){return this.ISNUMBER(t)?1:this.ISTEXT(t)?2:this.ISLOGICAL(t)?4:this.ISERROR(t)?16:Array.isArray(t)?64:void 0}},function(t,e,n){var r=n(0),o=n(1),i=new Date(Date.UTC(1900,0,1)),a=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],s=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function u(t){return 1===new Date(t,1,29).getMonth()}function c(t,e){return Math.ceil((e-t)/1e3/60/60/24)}function f(t){var e=t>-22038912e5?2:1;return Math.ceil((t-i)/864e5)+e}e.DATE=function(t,e,n){return t=o.parseNumber(t),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(t,e,n)?r.value:t<0||e<0||n<0?r.num:new Date(t,e-1,n)},e.DATEVALUE=function(t){var e,n=2;return"string"!=typeof t?r.value:(e=Date.parse(t),isNaN(e)?r.value:(e<=-22038912e5&&(n=1),Math.ceil((e-i)/864e5)+n))},e.DAY=function(t){var e=o.parseDate(t);return e instanceof Error?e:e.getDate()},e.DAYS=function(t,e){return t=o.parseDate(t),e=o.parseDate(e),t instanceof Error?t:e instanceof Error?e:f(t)-f(e)},e.DAYS360=function(t,e,n){if(n=o.parseBool(n),t=o.parseDate(t),e=o.parseDate(e),t instanceof Error)return t;if(e instanceof Error)return e;if(n instanceof Error)return n;var r,i,a=t.getMonth(),s=e.getMonth();if(n)r=31===t.getDate()?30:t.getDate(),i=31===e.getDate()?30:e.getDate();else{var l=new Date(t.getFullYear(),a+1,0).getDate(),u=new Date(e.getFullYear(),s+1,0).getDate();r=t.getDate()===l?30:t.getDate(),e.getDate()===u?r<30?(s++,i=1):i=30:i=e.getDate()}return 360*(e.getFullYear()-t.getFullYear())+30*(s-a)+(i-r)},e.EDATE=function(t,e){return(t=o.parseDate(t))instanceof Error?t:isNaN(e)?r.value:(e=parseInt(e,10),t.setMonth(t.getMonth()+e),f(t))},e.EOMONTH=function(t,e){return(t=o.parseDate(t))instanceof Error?t:isNaN(e)?r.value:(e=parseInt(e,10),f(new Date(t.getFullYear(),t.getMonth()+e+1,0)))},e.HOUR=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getHours()},e.INTERVAL=function(t){if("number"!=typeof t&&"string"!=typeof t)return r.value;t=parseInt(t,10);var e=Math.floor(t/94608e4);t%=94608e4;var n=Math.floor(t/2592e3);t%=2592e3;var o=Math.floor(t/86400);t%=86400;var i=Math.floor(t/3600);t%=3600;var a=Math.floor(t/60),s=t%=60;return"P"+(e=e>0?e+"Y":"")+(n=n>0?n+"M":"")+(o=o>0?o+"D":"")+"T"+(i=i>0?i+"H":"")+(a=a>0?a+"M":"")+(s=s>0?s+"S":"")},e.ISOWEEKNUM=function(t){if((t=o.parseDate(t))instanceof Error)return t;t.setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7));var e=new Date(t.getFullYear(),0,1);return Math.ceil(((t-e)/864e5+1)/7)},e.MINUTE=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getMinutes()},e.MONTH=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getMonth()+1},e.NETWORKDAYS=function(t,e,n){return this.NETWORKDAYS.INTL(t,e,1,n)},e.NETWORKDAYS.INTL=function(t,e,n,i){if((t=o.parseDate(t))instanceof Error)return t;if((e=o.parseDate(e))instanceof Error)return e;if(!((n=void 0===n?l[1]:l[n])instanceof Array))return r.value;void 0===i?i=[]:i instanceof Array||(i=[i]);for(var a=0;a<i.length;a++){var s=o.parseDate(i[a]);if(s instanceof Error)return s;i[a]=s}var u=(e-t)/864e5+1,c=u,f=t;for(a=0;a<u;a++){var h=(new Date).getTimezoneOffset()>0?f.getUTCDay():f.getDay(),d=!1;h!==n[0]&&h!==n[1]||(d=!0);for(var p=0;p<i.length;p++){var g=i[p];if(g.getDate()===f.getDate()&&g.getMonth()===f.getMonth()&&g.getFullYear()===f.getFullYear()){d=!0;break}}d&&c--,f.setDate(f.getDate()+1)}return c},e.NOW=function(){return new Date},e.SECOND=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getSeconds()},e.TIME=function(t,e,n){return t=o.parseNumber(t),e=o.parseNumber(e),n=o.parseNumber(n),o.anyIsError(t,e,n)?r.value:t<0||e<0||n<0?r.num:(3600*t+60*e+n)/86400},e.TIMEVALUE=function(t){return(t=o.parseDate(t))instanceof Error?t:(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},e.TODAY=function(){return new Date},e.WEEKDAY=function(t,e){if((t=o.parseDate(t))instanceof Error)return t;void 0===e&&(e=1);var n=t.getDay();return s[e][n]},e.WEEKNUM=function(t,e){if((t=o.parseDate(t))instanceof Error)return t;if(void 0===e&&(e=1),21===e)return this.ISOWEEKNUM(t);var n=a[e],r=new Date(t.getFullYear(),0,1),i=r.getDay()<n?1:0;return r-=24*Math.abs(r.getDay()-n)*60*60*1e3,Math.floor((t-r)/864e5/7+1)+i},e.WORKDAY=function(t,e,n){return this.WORKDAY.INTL(t,e,1,n)},e.WORKDAY.INTL=function(t,e,n,i){if((t=o.parseDate(t))instanceof Error)return t;if((e=o.parseNumber(e))instanceof Error)return e;if(e<0)return r.num;if(!((n=void 0===n?l[1]:l[n])instanceof Array))return r.value;void 0===i?i=[]:i instanceof Array||(i=[i]);for(var a=0;a<i.length;a++){var s=o.parseDate(i[a]);if(s instanceof Error)return s;i[a]=s}for(var u=0;u<e;){t.setDate(t.getDate()+1);var c=t.getDay();if(c!==n[0]&&c!==n[1]){for(var f=0;f<i.length;f++){var h=i[f];if(h.getDate()===t.getDate()&&h.getMonth()===t.getMonth()&&h.getFullYear()===t.getFullYear()){u--;break}}u++}}return t},e.YEAR=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getFullYear()},e.YEARFRAC=function(t,e,n){if((t=o.parseDate(t))instanceof Error)return t;if((e=o.parseDate(e))instanceof Error)return e;n=n||0;var r=t.getDate(),i=t.getMonth()+1,a=t.getFullYear(),s=e.getDate(),l=e.getMonth()+1,f=e.getFullYear();switch(n){case 0:return 31===r&&31===s?(r=30,s=30):31===r?r=30:30===r&&31===s&&(s=30),(s+30*l+360*f-(r+30*i+360*a))/360;case 1:var h=365;if(a===f||a+1===f&&(i>l||i===l&&r>=s))return(a===f&&u(a)||function(t,e){var n=t.getFullYear(),r=new Date(n,2,1);if(u(n)&&t<r&&e>=r)return!0;var o=e.getFullYear(),i=new Date(o,2,1);return u(o)&&e>=i&&t<i}(t,e)||1===l&&29===s)&&(h=366),c(t,e)/h;var d=f-a+1,p=(new Date(f+1,0,1)-new Date(a,0,1))/1e3/60/60/24/d;return c(t,e)/p;case 2:return c(t,e)/360;case 3:return c(t,e)/365;case 4:return(s+30*l+360*f-(r+30*i+360*a))/360}}},function(t,e,n){var r;t.exports=(function(t,e){var n=t.utils.isFunction;function r(t,e){return t-e}function o(t,n,r){return e.max(n,e.min(t,r))}t.sum=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n];return e},t.sumsqrd=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n]*t[n];return e},t.sumsqerr=function(e){for(var n,r=t.mean(e),o=0,i=e.length;--i>=0;)o+=(n=e[i]-r)*n;return o},t.sumrow=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n];return e},t.product=function(t){for(var e=1,n=t.length;--n>=0;)e*=t[n];return e},t.min=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]<e&&(e=t[n]);return e},t.max=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]>e&&(e=t[n]);return e},t.unique=function(t){for(var e={},n=[],r=0;r<t.length;r++)e[t[r]]||(e[t[r]]=!0,n.push(t[r]));return n},t.mean=function(e){return t.sum(e)/e.length},t.meansqerr=function(e){return t.sumsqerr(e)/e.length},t.geomean=function(n){return e.pow(t.product(n),1/n.length)},t.median=function(t){var e=t.length,n=t.slice().sort(r);return 1&e?n[e/2|0]:(n[e/2-1]+n[e/2])/2},t.cumsum=function(e){return t.cumreduce(e,(function(t,e){return t+e}))},t.cumprod=function(e){return t.cumreduce(e,(function(t,e){return t*e}))},t.diff=function(t){var e,n=[],r=t.length;for(e=1;e<r;e++)n.push(t[e]-t[e-1]);return n},t.rank=function(t){for(var e,n=t.length,o=t.slice().sort(r),i=new Array(n),a=0;a<n;a++){var s=o.indexOf(t[a]),l=o.lastIndexOf(t[a]);e=s===l?s:(s+l)/2,i[a]=e+1}return i},t.mode=function(t){var e,n=t.length,o=t.slice().sort(r),i=1,a=0,s=0,l=[];for(e=0;e<n;e++)o[e]===o[e+1]?i++:(i>a?(l=[o[e]],a=i,s=0):i===a&&(l.push(o[e]),s++),i=1);return 0===s?l[0]:l},t.range=function(e){return t.max(e)-t.min(e)},t.variance=function(e,n){return t.sumsqerr(e)/(e.length-(n?1:0))},t.pooledvariance=function(e){return e.reduce((function(e,n){return e+t.sumsqerr(n)}),0)/(e.reduce((function(t,e){return t+e.length}),0)-e.length)},t.deviation=function(e){for(var n=t.mean(e),r=e.length,o=new Array(r),i=0;i<r;i++)o[i]=e[i]-n;return o},t.stdev=function(n,r){return e.sqrt(t.variance(n,r))},t.pooledstdev=function(n){return e.sqrt(t.pooledvariance(n))},t.meandev=function(n){for(var r=t.mean(n),o=[],i=n.length-1;i>=0;i--)o.push(e.abs(n[i]-r));return t.mean(o)},t.meddev=function(n){for(var r=t.median(n),o=[],i=n.length-1;i>=0;i--)o.push(e.abs(n[i]-r));return t.median(o)},t.coeffvar=function(e){return t.stdev(e)/t.mean(e)},t.quartiles=function(t){var n=t.length,o=t.slice().sort(r);return[o[e.round(n/4)-1],o[e.round(n/2)-1],o[e.round(3*n/4)-1]]},t.quantiles=function(t,n,i,a){var s,l,u,c,f,h=t.slice().sort(r),d=[n.length],p=t.length;for(void 0===i&&(i=3/8),void 0===a&&(a=3/8),s=0;s<n.length;s++)u=p*(l=n[s])+(i+l*(1-i-a)),c=e.floor(o(u,1,p-1)),f=o(u-c,0,1),d[s]=(1-f)*h[c-1]+f*h[c];return d},t.percentile=function(t,e,n){var o=t.slice().sort(r),i=e*(o.length+(n?1:-1))+(n?0:1),a=parseInt(i),s=i-a;return a+1<o.length?o[a-1]+s*(o[a]-o[a-1]):o[a-1]},t.percentileOfScore=function(t,e,n){var r,o,i=0,a=t.length,s=!1;for("strict"===n&&(s=!0),o=0;o<a;o++)r=t[o],(s&&r<e||!s&&r<=e)&&i++;return i/a},t.histogram=function(n,r){r=r||4;var o,i=t.min(n),a=(t.max(n)-i)/r,s=n.length,l=[];for(o=0;o<r;o++)l[o]=0;for(o=0;o<s;o++)l[e.min(e.floor((n[o]-i)/a),r-1)]+=1;return l},t.covariance=function(e,n){var r,o=t.mean(e),i=t.mean(n),a=e.length,s=new Array(a);for(r=0;r<a;r++)s[r]=(e[r]-o)*(n[r]-i);return t.sum(s)/(a-1)},t.corrcoeff=function(e,n){return t.covariance(e,n)/t.stdev(e,1)/t.stdev(n,1)},t.spearmancoeff=function(e,n){return e=t.rank(e),n=t.rank(n),t.corrcoeff(e,n)},t.stanMoment=function(n,r){for(var o=t.mean(n),i=t.stdev(n),a=n.length,s=0,l=0;l<a;l++)s+=e.pow((n[l]-o)/i,r);return s/n.length},t.skewness=function(e){return t.stanMoment(e,3)},t.kurtosis=function(e){return t.stanMoment(e,4)-3};var i=t.prototype;!function(e){for(var r=0;r<e.length;r++)!function(e){i[e]=function(r,o){var a=[],s=0,l=this;if(n(r)&&(o=r,r=!1),o)return setTimeout((function(){o.call(l,i[e].call(l,r))})),this;if(this.length>1){for(l=!0===r?this:this.transpose();s<l.length;s++)a[s]=t[e](l[s]);return a}return t[e](this[0],r)}}(e[r])}("cumsum cumprod".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){i[e]=function(r,o){var a=[],s=0,l=this;if(n(r)&&(o=r,r=!1),o)return setTimeout((function(){o.call(l,i[e].call(l,r))})),this;if(this.length>1){for("sumrow"!==e&&(l=!0===r?this:this.transpose());s<l.length;s++)a[s]=t[e](l[s]);return!0===r?t[e](t.utils.toVector(a)):a}return t[e](this[0],r)}}(e[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){i[e]=function(){var r,o=[],a=0,s=this,l=Array.prototype.slice.call(arguments);if(n(l[l.length-1])){r=l[l.length-1];var u=l.slice(0,l.length-1);return setTimeout((function(){r.call(s,i[e].apply(s,u))})),this}r=void 0;var c=function(n){return t[e].apply(s,[n].concat(l))};if(this.length>1){for(s=s.transpose();a<s.length;a++)o[a]=c(s[a]);return o}return c(this[0])}}(e[r])}("quantiles percentileOfScore".split(" "))}(r=function(t,e){var n=Array.prototype.concat,r=Array.prototype.slice,o=Object.prototype.toString;function i(e,n){var r=e>n?e:n;return t.pow(10,17-~~(t.log(r>0?r:-r)*t.LOG10E))}var a=Array.isArray||function(t){return"[object Array]"===o.call(t)};function s(t){return"[object Function]"===o.call(t)}function l(t){return"number"==typeof t&&t-t==0}function u(){return new u._init(arguments)}function c(){return 0}function f(){return 1}function h(t,e){return t===e?1:0}u.fn=u.prototype,u._init=function(t){if(a(t[0]))if(a(t[0][0])){s(t[1])&&(t[0]=u.map(t[0],t[1]));for(var e=0;e<t[0].length;e++)this[e]=t[0][e];this.length=t[0].length}else this[0]=s(t[1])?u.map(t[0],t[1]):t[0],this.length=1;else if(l(t[0]))this[0]=u.seq.apply(null,t),this.length=1;else{if(t[0]instanceof u)return u(t[0].toArray());this[0]=[],this.length=1}return this},u._init.prototype=u.prototype,u._init.constructor=u,u.utils={calcRdx:i,isArray:a,isFunction:s,isNumber:l,toVector:function(t){return n.apply([],t)}},u._random_fn=t.random,u.setRandom=function(t){if("function"!=typeof t)throw new TypeError("fn is not a function");u._random_fn=t},u.extend=function(t){var e,n;if(1===arguments.length){for(n in t)u[n]=t[n];return this}for(e=1;e<arguments.length;e++)for(n in arguments[e])t[n]=arguments[e][n];return t},u.rows=function(t){return t.length||1},u.cols=function(t){return t[0].length||1},u.dimensions=function(t){return{rows:u.rows(t),cols:u.cols(t)}},u.row=function(t,e){return a(e)?e.map((function(e){return u.row(t,e)})):t[e]},u.rowa=function(t,e){return u.row(t,e)},u.col=function(t,e){if(a(e)){var n=u.arange(t.length).map((function(){return new Array(e.length)}));return e.forEach((function(e,r){u.arange(t.length).forEach((function(o){n[o][r]=t[o][e]}))})),n}for(var r=new Array(t.length),o=0;o<t.length;o++)r[o]=[t[o][e]];return r},u.cola=function(t,e){return u.col(t,e).map((function(t){return t[0]}))},u.diag=function(t){for(var e=u.rows(t),n=new Array(e),r=0;r<e;r++)n[r]=[t[r][r]];return n},u.antidiag=function(t){for(var e=u.rows(t)-1,n=new Array(e),r=0;e>=0;e--,r++)n[r]=[t[r][e]];return n},u.transpose=function(t){var e,n,r,o,i,s=[];for(a(t[0])||(t=[t]),n=t.length,r=t[0].length,i=0;i<r;i++){for(e=new Array(n),o=0;o<n;o++)e[o]=t[o][i];s.push(e)}return 1===s.length?s[0]:s},u.map=function(t,e,n){var r,o,i,s,l;for(a(t[0])||(t=[t]),o=t.length,i=t[0].length,s=n?t:new Array(o),r=0;r<o;r++)for(s[r]||(s[r]=new Array(i)),l=0;l<i;l++)s[r][l]=e(t[r][l],r,l);return 1===s.length?s[0]:s},u.cumreduce=function(t,e,n){var r,o,i,s,l;for(a(t[0])||(t=[t]),o=t.length,i=t[0].length,s=n?t:new Array(o),r=0;r<o;r++)for(s[r]||(s[r]=new Array(i)),i>0&&(s[r][0]=t[r][0]),l=1;l<i;l++)s[r][l]=e(s[r][l-1],t[r][l]);return 1===s.length?s[0]:s},u.alter=function(t,e){return u.map(t,e,!0)},u.create=function(t,e,n){var r,o,i=new Array(t);for(s(e)&&(n=e,e=t),r=0;r<t;r++)for(i[r]=new Array(e),o=0;o<e;o++)i[r][o]=n(r,o);return i},u.zeros=function(t,e){return l(e)||(e=t),u.create(t,e,c)},u.ones=function(t,e){return l(e)||(e=t),u.create(t,e,f)},u.rand=function(t,e){return l(e)||(e=t),u.create(t,e,u._random_fn)},u.identity=function(t,e){return l(e)||(e=t),u.create(t,e,h)},u.symmetric=function(t){var e,n,r=t.length;if(t.length!==t[0].length)return!1;for(e=0;e<r;e++)for(n=0;n<r;n++)if(t[n][e]!==t[e][n])return!1;return!0},u.clear=function(t){return u.alter(t,c)},u.seq=function(t,e,n,r){s(r)||(r=!1);var o,a=[],l=i(t,e),u=(e*l-t*l)/((n-1)*l),c=t;for(o=0;c<=e&&o<n;c=(t*l+u*l*++o)/l)a.push(r?r(c,o):c);return a},u.arange=function(t,e,n){var r,o=[];if(n=n||1,void 0===e&&(e=t,t=0),t===e||0===n)return[];if(t<e&&n<0)return[];if(t>e&&n>0)return[];if(n>0)for(r=t;r<e;r+=n)o.push(r);else for(r=t;r>e;r+=n)o.push(r);return o},u.slice=function(){function t(t,e,n,r){var o,i=[],a=t.length;if(void 0===e&&void 0===n&&void 0===r)return u.copy(t);if(r=r||1,(e=(e=e||0)>=0?e:a+e)===(n=(n=n||t.length)>=0?n:a+n)||0===r)return[];if(e<n&&r<0)return[];if(e>n&&r>0)return[];if(r>0)for(o=e;o<n;o+=r)i.push(t[o]);else for(o=e;o>n;o+=r)i.push(t[o]);return i}return function(e,n){var r,o;return l((n=n||{}).row)?l(n.col)?e[n.row][n.col]:t(u.rowa(e,n.row),(r=n.col||{}).start,r.end,r.step):l(n.col)?t(u.cola(e,n.col),(o=n.row||{}).start,o.end,o.step):(o=n.row||{},r=n.col||{},t(e,o.start,o.end,o.step).map((function(e){return t(e,r.start,r.end,r.step)})))}}(),u.sliceAssign=function(e,n,r){var o,i;if(l(n.row)){if(l(n.col))return e[n.row][n.col]=r;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||e[0].length,n.col.step=n.col.step||1,o=u.arange(n.col.start,t.min(e.length,n.col.end),n.col.step);var a=n.row;return o.forEach((function(t,n){e[a][t]=r[n]})),e}if(l(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||e.length,n.row.step=n.row.step||1,i=u.arange(n.row.start,t.min(e[0].length,n.row.end),n.row.step);var s=n.col;return i.forEach((function(t,n){e[t][s]=r[n]})),e}return void 0===r[0].length&&(r=[r]),n.row.start=n.row.start||0,n.row.end=n.row.end||e.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||e[0].length,n.col.step=n.col.step||1,i=u.arange(n.row.start,t.min(e.length,n.row.end),n.row.step),o=u.arange(n.col.start,t.min(e[0].length,n.col.end),n.col.step),i.forEach((function(t,n){o.forEach((function(o,i){e[t][o]=r[n][i]}))})),e},u.diagonal=function(t){var e=u.zeros(t.length,t.length);return t.forEach((function(t,n){e[n][n]=t})),e},u.copy=function(t){return t.map((function(t){return l(t)?t:t.map((function(t){return t}))}))};var d=u.prototype;return d.length=0,d.push=Array.prototype.push,d.sort=Array.prototype.sort,d.splice=Array.prototype.splice,d.slice=Array.prototype.slice,d.toArray=function(){return this.length>1?r.call(this):r.call(this)[0]},d.map=function(t,e){return u(u.map(this,t,e))},d.cumreduce=function(t,e){return u(u.cumreduce(this,t,e))},d.alter=function(t){return u.alter(this,t),this},function(t){for(var e=0;e<t.length;e++)!function(t){d[t]=function(e){var n,r=this;return e?(setTimeout((function(){e.call(r,d[t].call(r))})),this):(n=u[t](this),a(n)?u(n):n)}}(t[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){d[t]=function(e,n){var r=this;return n?(setTimeout((function(){n.call(r,d[t].call(r,e))})),this):u(u[t](this,e))}}(t[e])}("row col".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){d[t]=function(){return u(u[t].apply(null,arguments))}}(t[e])}("create zeros ones rand identity".split(" ")),u}(Math),Math),function(t,e){t.gammaln=function(t){var n,r,o,i=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],s=1.000000000190015;for(o=(r=n=t)+5.5,o-=(n+.5)*e.log(o);i<6;i++)s+=a[i]/++r;return e.log(2.5066282746310007*s/n)-o},t.loggam=function(t){var n,r,o,i,a,s,l,u=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(n=t,l=0,1==t||2==t)return 0;for(t<=7&&(n=t+(l=e.floor(7-t))),r=1/(n*n),o=2*e.PI,a=u[9],s=8;s>=0;s--)a*=r,a+=u[s];if(i=a/n+.5*e.log(o)+(n-.5)*e.log(n)-n,t<=7)for(s=1;s<=l;s++)i-=e.log(n-1),n-=1;return i},t.gammafn=function(t){var n,r,o,i,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],s=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,u=0,c=0,f=0,h=t;if(h<=0){if(!(i=h%1+36e-17))return 1/0;l=(1&h?-1:1)*e.PI/e.sin(e.PI*i),h=1-h}for(o=h,r=h<1?h++:(h-=u=(0|h)-1)-1,n=0;n<8;++n)f=(f+a[n])*r,c=c*r+s[n];if(i=f/c+1,o<h)i/=o;else if(o>h)for(n=0;n<u;++n)i*=h,h++;return l&&(i=l/i),i},t.gammap=function(e,n){return t.lowRegGamma(e,n)*t.gammafn(e)},t.lowRegGamma=function(n,r){var o,i=t.gammaln(n),a=n,s=1/n,l=s,u=r+1-n,c=1/1e-30,f=1/u,h=f,d=1,p=-~(8.5*e.log(n>=1?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;d<=p;d++)s+=l*=r/++a;return s*e.exp(-r+n*e.log(r)-i)}for(;d<=p;d++)h*=(f=1/(f=(o=-d*(d-n))*f+(u+=2)))*(c=u+o/c);return 1-h*e.exp(-r+n*e.log(r)-i)},t.factorialln=function(e){return e<0?NaN:t.gammaln(e+1)},t.factorial=function(e){return e<0?NaN:t.gammafn(e+1)},t.combination=function(n,r){return n>170||r>170?e.exp(t.combinationln(n,r)):t.factorial(n)/t.factorial(r)/t.factorial(n-r)},t.combinationln=function(e,n){return t.factorialln(e)-t.factorialln(n)-t.factorialln(e-n)},t.permutation=function(e,n){return t.factorial(e)/t.factorial(e-n)},t.betafn=function(n,r){if(!(n<=0||r<=0))return n+r>170?e.exp(t.betaln(n,r)):t.gammafn(n)*t.gammafn(r)/t.gammafn(n+r)},t.betaln=function(e,n){return t.gammaln(e)+t.gammaln(n)-t.gammaln(e+n)},t.betacf=function(t,n,r){var o,i,a,s,l=1,u=n+r,c=n+1,f=n-1,h=1,d=1-u*t/c;for(e.abs(d)<1e-30&&(d=1e-30),s=d=1/d;l<=100&&(d=1+(i=l*(r-l)*t/((f+(o=2*l))*(n+o)))*d,e.abs(d)<1e-30&&(d=1e-30),h=1+i/h,e.abs(h)<1e-30&&(h=1e-30),s*=(d=1/d)*h,d=1+(i=-(n+l)*(u+l)*t/((n+o)*(c+o)))*d,e.abs(d)<1e-30&&(d=1e-30),h=1+i/h,e.abs(h)<1e-30&&(h=1e-30),s*=a=(d=1/d)*h,!(e.abs(a-1)<3e-7));l++);return s},t.gammapinv=function(n,r){var o,i,a,s,l,u,c=0,f=r-1,h=t.gammaln(r);if(n>=1)return e.max(100,r+100*e.sqrt(r));if(n<=0)return 0;for(r>1?(l=e.log(f),u=e.exp(f*(l-1)-h),s=n<.5?n:1-n,o=(2.30753+.27061*(i=e.sqrt(-2*e.log(s))))/(1+i*(.99229+.04481*i))-i,n<.5&&(o=-o),o=e.max(.001,r*e.pow(1-1/(9*r)-o/(3*e.sqrt(r)),3))):o=n<(i=1-r*(.253+.12*r))?e.pow(n/i,1/r):1-e.log(1-(n-i)/(1-i));c<12;c++){if(o<=0)return 0;if((o-=i=(a=(t.lowRegGamma(r,o)-n)/(i=r>1?u*e.exp(-(o-f)+f*(e.log(o)-l)):e.exp(-o+f*e.log(o)-h)))/(1-.5*e.min(1,a*((r-1)/o-1))))<=0&&(o=.5*(o+i)),e.abs(i)<1e-8*o)break}return o},t.erf=function(t){var n,r,o,i,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],s=a.length-1,l=!1,u=0,c=0;for(t<0&&(t=-t,l=!0),r=4*(n=2/(2+t))-2;s>0;s--)o=u,u=r*u-c+a[s],c=o;return i=n*e.exp(-t*t+.5*(a[0]+r*u)-c),l?i-1:1-i},t.erfc=function(e){return 1-t.erf(e)},t.erfcinv=function(n){var r,o,i,a,s=0;if(n>=2)return-100;if(n<=0)return 100;for(a=n<1?n:2-n,r=-.70711*((2.30753+.27061*(i=e.sqrt(-2*e.log(a/2))))/(1+i*(.99229+.04481*i))-i);s<2;s++)r+=(o=t.erfc(r)-a)/(1.1283791670955126*e.exp(-r*r)-r*o);return n<1?r:-r},t.ibetainv=function(n,r,o){var i,a,s,l,u,c,f,h,d,p,g=r-1,v=o-1,y=0;if(n<=0)return 0;if(n>=1)return 1;for(r>=1&&o>=1?(s=n<.5?n:1-n,c=(2.30753+.27061*(l=e.sqrt(-2*e.log(s))))/(1+l*(.99229+.04481*l))-l,n<.5&&(c=-c),f=(c*c-3)/6,h=2/(1/(2*r-1)+1/(2*o-1)),d=c*e.sqrt(f+h)/h-(1/(2*o-1)-1/(2*r-1))*(f+5/6-2/(3*h)),c=r/(r+o*e.exp(2*d))):(i=e.log(r/(r+o)),a=e.log(o/(r+o)),c=n<(l=e.exp(r*i)/r)/(d=l+(u=e.exp(o*a)/o))?e.pow(r*d*n,1/r):1-e.pow(o*d*(1-n),1/o)),p=-t.gammaln(r)-t.gammaln(o)+t.gammaln(r+o);y<10;y++){if(0===c||1===c)return c;if((c-=l=(u=(t.ibeta(c,r,o)-n)/(l=e.exp(g*e.log(c)+v*e.log(1-c)+p)))/(1-.5*e.min(1,u*(g/c-v/(1-c)))))<=0&&(c=.5*(c+l)),c>=1&&(c=.5*(c+l+1)),e.abs(l)<1e-8*c&&y>0)break}return c},t.ibeta=function(n,r,o){var i=0===n||1===n?0:e.exp(t.gammaln(r+o)-t.gammaln(r)-t.gammaln(o)+r*e.log(n)+o*e.log(1-n));return!(n<0||n>1)&&(n<(r+1)/(r+o+2)?i*t.betacf(n,r,o)/r:1-i*t.betacf(1-n,o,r)/o)},t.randn=function(n,r){var o,i,a,s,l;if(r||(r=n),n)return t.create(n,r,(function(){return t.randn()}));do{o=t._random_fn(),i=1.7156*(t._random_fn()-.5),l=(a=o-.449871)*a+(s=e.abs(i)+.386595)*(.196*s-.25472*a)}while(l>.27597&&(l>.27846||i*i>-4*e.log(o)*o*o));return i/o},t.randg=function(n,r,o){var i,a,s,l,u,c,f=n;if(o||(o=r),n||(n=1),r)return(c=t.zeros(r,o)).alter((function(){return t.randg(n)})),c;n<1&&(n+=1),i=n-1/3,a=1/e.sqrt(9*i);do{do{l=1+a*(u=t.randn())}while(l<=0);l*=l*l,s=t._random_fn()}while(s>1-.331*e.pow(u,4)&&e.log(s)>.5*u*u+i*(1-l+e.log(l)));if(n==f)return i*l;do{s=t._random_fn()}while(0===s);return e.pow(s,1/f)*i*l},function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(){return t(t.map(this,(function(n){return t[e](n)})))}}(e[n])}("gammaln gammafn factorial factorialln".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(){return t(t[e].apply(null,arguments))}}(e[n])}("randn".split(" "))}(r,Math),function(t,e){function n(t,n,r,o){for(var i,a=0,s=1,l=1,u=1,c=0,f=0;e.abs((l-f)/l)>o;)f=l,s=u+(i=-(n+c)*(n+r+c)*t/(n+2*c)/(n+2*c+1))*s,l=(a=l+i*a)+(i=(c+=1)*(r-c)*t/(n+2*c-1)/(n+2*c))*l,a/=u=s+i*u,s/=u,l/=u,u=1;return l/n}function r(n,r,o){var i=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],a=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],s=.5*n;if(s>=8)return 1;var l,u=2*t.normal.cdf(s,0,1,1,0)-1;u=u>=e.exp(-50/o)?e.pow(u,o):0;for(var c=s,f=(8-s)/(l=n>3?2:3),h=c+f,d=0,p=o-1,g=1;g<=l;g++){for(var v=0,y=.5*(h+c),m=.5*(h-c),b=1;b<=12;b++){var w,O=y+m*(6<b?i[(w=12-b+1)-1]:-i[(w=b)-1]),C=O*O;if(C>60)break;var E=2*t.normal.cdf(O,0,1,1,0)*.5-2*t.normal.cdf(O,n,1,1,0)*.5;E>=e.exp(-30/p)&&(v+=E=a[w-1]*e.exp(-.5*C)*e.pow(E,p))}d+=v*=2*m*o/e.sqrt(2*e.PI),c=h,h+=f}return(u+=d)<=e.exp(-30/r)?0:(u=e.pow(u,r))>=1?1:u}!function(e){for(var n=0;n<e.length;n++)!function(e){t[e]=function(t,e,n){return this instanceof arguments.callee?(this._a=t,this._b=e,this._c=n,this):new arguments.callee(t,e,n)},t.fn[e]=function(n,r,o){var i=t[e](n,r,o);return i.data=this,i},t[e].prototype.sample=function(n){var r=this._a,o=this._b,i=this._c;return n?t.alter(n,(function(){return t[e].sample(r,o,i)})):t[e].sample(r,o,i)},function(n){for(var r=0;r<n.length;r++)!function(n){t[e].prototype[n]=function(r){var o=this._a,i=this._b,a=this._c;return r||0===r||(r=this.data),"number"!=typeof r?t.fn.map.call(r,(function(r){return t[e][n](r,o,i,a)})):t[e][n](r,o,i,a)}}(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){t[e].prototype[n]=function(){return t[e][n](this._a,this._b,this._c)}}(n[r])}("mean median mode variance".split(" "))}(e[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(n,r,o){return n>1||n<0?0:1==r&&1==o?1:r<512&&o<512?e.pow(n,r-1)*e.pow(1-n,o-1)/t.betafn(r,o):e.exp((r-1)*e.log(n)+(o-1)*e.log(1-n)-t.betaln(r,o))},cdf:function(e,n,r){return e>1||e<0?1*(e>1):t.ibeta(e,n,r)},inv:function(e,n,r){return t.ibetainv(e,n,r)},mean:function(t,e){return t/(t+e)},median:function(e,n){return t.ibetainv(.5,e,n)},mode:function(t,e){return(t-1)/(t+e-2)},sample:function(e,n){var r=t.randg(e);return r/(r+t.randg(n))},variance:function(t,n){return t*n/(e.pow(t+n,2)*(t+n+1))}}),t.extend(t.centralF,{pdf:function(n,r,o){var i;return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:1/t.betafn(r/2,o/2)*e.pow(r/o,r/2)*e.pow(n,r/2-1)*e.pow(1+r/o*n,-(r+o)/2):(i=r*n/(o+n*r),r*(o/(o+n*r))/2*t.binomial.pdf((r-2)/2,(r+o-2)/2,i))},cdf:function(e,n,r){return e<0?0:t.ibeta(n*e/(n*e+r),n/2,r/2)},inv:function(e,n,r){return r/(n*(1/t.ibetainv(e,n/2,r/2)-1))},mean:function(t,e){return e>2?e/(e-2):void 0},mode:function(t,e){return t>2?e*(t-2)/(t*(e+2)):void 0},sample:function(e,n){return 2*t.randg(e/2)/e/(2*t.randg(n/2)/n)},variance:function(t,e){if(!(e<=4))return 2*e*e*(t+e-2)/(t*(e-2)*(e-2)*(e-4))}}),t.extend(t.cauchy,{pdf:function(t,n,r){return r<0?0:r/(e.pow(t-n,2)+e.pow(r,2))/e.PI},cdf:function(t,n,r){return e.atan((t-n)/r)/e.PI+.5},inv:function(t,n,r){return n+r*e.tan(e.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(n,r){return t.randn()*e.sqrt(1/(2*t.randg(.5)))*r+n}}),t.extend(t.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:e.exp((r/2-1)*e.log(n)-n/2-r/2*e.log(2)-t.gammaln(r/2))},cdf:function(e,n){return e<0?0:t.lowRegGamma(n/2,e/2)},inv:function(e,n){return 2*t.gammapinv(e,.5*n)},mean:function(t){return t},median:function(t){return t*e.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(e){return 2*t.randg(e/2)},variance:function(t){return 2*t}}),t.extend(t.exponential,{pdf:function(t,n){return t<0?0:n*e.exp(-n*t)},cdf:function(t,n){return t<0?0:1-e.exp(-n*t)},inv:function(t,n){return-e.log(1-t)/n},mean:function(t){return 1/t},median:function(t){return 1/t*e.log(2)},mode:function(){return 0},sample:function(n){return-1/n*e.log(t._random_fn())},variance:function(t){return e.pow(t,-2)}}),t.extend(t.gamma,{pdf:function(n,r,o){return n<0?0:0===n&&1===r?1/o:e.exp((r-1)*e.log(n)-n/o-t.gammaln(r)-r*e.log(o))},cdf:function(e,n,r){return e<0?0:t.lowRegGamma(n,e/r)},inv:function(e,n,r){return t.gammapinv(e,n)*r},mean:function(t,e){return t*e},mode:function(t,e){if(t>1)return(t-1)*e},sample:function(e,n){return t.randg(e)*n},variance:function(t,e){return t*e*e}}),t.extend(t.invgamma,{pdf:function(n,r,o){return n<=0?0:e.exp(-(r+1)*e.log(n)-o/n-t.gammaln(r)+r*e.log(o))},cdf:function(e,n,r){return e<=0?0:1-t.lowRegGamma(n,r/e)},inv:function(e,n,r){return r/t.gammapinv(1-e,n)},mean:function(t,e){return t>1?e/(t-1):void 0},mode:function(t,e){return e/(t+1)},sample:function(e,n){return n/t.randg(e)},variance:function(t,e){if(!(t<=2))return e*e/((t-1)*(t-1)*(t-2))}}),t.extend(t.kumaraswamy,{pdf:function(t,n,r){return 0===t&&1===n?r:1===t&&1===r?n:e.exp(e.log(n)+e.log(r)+(n-1)*e.log(t)+(r-1)*e.log(1-e.pow(t,n)))},cdf:function(t,n,r){return t<0?0:t>1?1:1-e.pow(1-e.pow(t,n),r)},inv:function(t,n,r){return e.pow(1-e.pow(1-t,1/r),1/n)},mean:function(e,n){return n*t.gammafn(1+1/e)*t.gammafn(n)/t.gammafn(1+1/e+n)},median:function(t,n){return e.pow(1-e.pow(2,-1/n),1/t)},mode:function(t,n){if(t>=1&&n>=1&&1!==t&&1!==n)return e.pow((t-1)/(t*n-1),1/t)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(t,n,r){return t<=0?0:e.exp(-e.log(t)-.5*e.log(2*e.PI)-e.log(r)-e.pow(e.log(t)-n,2)/(2*r*r))},cdf:function(n,r,o){return n<0?0:.5+.5*t.erf((e.log(n)-r)/e.sqrt(2*o*o))},inv:function(n,r,o){return e.exp(-1.4142135623730951*o*t.erfcinv(2*n)+r)},mean:function(t,n){return e.exp(t+n*n/2)},median:function(t){return e.exp(t)},mode:function(t,n){return e.exp(t-n*n)},sample:function(n,r){return e.exp(t.randn()*r+n)},variance:function(t,n){return(e.exp(n*n)-1)*e.exp(2*t+n*n)}}),t.extend(t.noncentralt,{pdf:function(n,r,o){return e.abs(o)<1e-14?t.studentt.pdf(n,r):e.abs(n)<1e-14?e.exp(t.gammaln((r+1)/2)-o*o/2-.5*e.log(e.PI*r)-t.gammaln(r/2)):r/n*(t.noncentralt.cdf(n*e.sqrt(1+2/r),r+2,o)-t.noncentralt.cdf(n,r,o))},cdf:function(n,r,o){if(e.abs(o)<1e-14)return t.studentt.cdf(n,r);var i=!1;n<0&&(i=!0,o=-o);for(var a=t.normal.cdf(-o,0,1),s=1e-14+1,l=s,u=n*n/(n*n+r),c=0,f=e.exp(-o*o/2),h=e.exp(-o*o/2-.5*e.log(2)-t.gammaln(1.5))*o;c<200||l>1e-14||s>1e-14;)l=s,c>0&&(f*=o*o/(2*c),h*=o*o/(2*(c+.5))),a+=.5*(s=f*t.beta.cdf(u,c+.5,r/2)+h*t.beta.cdf(u,c+1,r/2)),c++;return i?1-a:a}}),t.extend(t.normal,{pdf:function(t,n,r){return e.exp(-.5*e.log(2*e.PI)-e.log(r)-e.pow(t-n,2)/(2*r*r))},cdf:function(n,r,o){return.5*(1+t.erf((n-r)/e.sqrt(2*o*o)))},inv:function(e,n,r){return-1.4142135623730951*r*t.erfcinv(2*e)+n},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},sample:function(e,n){return t.randn()*n+e},variance:function(t,e){return e*e}}),t.extend(t.pareto,{pdf:function(t,n,r){return t<n?0:r*e.pow(n,r)/e.pow(t,r+1)},cdf:function(t,n,r){return t<n?0:1-e.pow(n/t,r)},inv:function(t,n,r){return n/e.pow(1-t,1/r)},mean:function(t,n){if(!(n<=1))return n*e.pow(t,n)/(n-1)},median:function(t,n){return t*(n*e.SQRT2)},mode:function(t){return t},variance:function(t,n){if(!(n<=2))return t*t*n/(e.pow(n-1,2)*(n-2))}}),t.extend(t.studentt,{pdf:function(n,r){return r=r>1e100?1e100:r,1/(e.sqrt(r)*t.betafn(.5,r/2))*e.pow(1+n*n/r,-(r+1)/2)},cdf:function(n,r){var o=r/2;return t.ibeta((n+e.sqrt(n*n+r))/(2*e.sqrt(n*n+r)),o,o)},inv:function(n,r){var o=t.ibetainv(2*e.min(n,1-n),.5*r,.5);return o=e.sqrt(r*(1-o)/o),n>.5?o:-o},mean:function(t){return t>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return t.randn()*e.sqrt(n/(2*t.randg(n/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(t,n,r){return t<0||n<0||r<0?0:r/n*e.pow(t/n,r-1)*e.exp(-e.pow(t/n,r))},cdf:function(t,n,r){return t<0?0:1-e.exp(-e.pow(t/n,r))},inv:function(t,n,r){return n*e.pow(-e.log(1-t),1/r)},mean:function(e,n){return e*t.gammafn(1+1/n)},median:function(t,n){return t*e.pow(e.log(2),1/n)},mode:function(t,n){return n<=1?0:t*e.pow((n-1)/n,1/n)},sample:function(n,r){return n*e.pow(-e.log(t._random_fn()),1/r)},variance:function(n,r){return n*n*t.gammafn(1+2/r)-e.pow(t.weibull.mean(n,r),2)}}),t.extend(t.uniform,{pdf:function(t,e,n){return t<e||t>n?0:1/(n-e)},cdf:function(t,e,n){return t<e?0:t<n?(t-e)/(n-e):1},inv:function(t,e,n){return e+t*(n-e)},mean:function(t,e){return.5*(t+e)},median:function(e,n){return t.mean(e,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,n){return e/2+n/2+(n/2-e/2)*(2*t._random_fn()-1)},variance:function(t,n){return e.pow(n-t,2)/12}}),t.extend(t.binomial,{pdf:function(n,r,o){return 0===o||1===o?r*o===n?1:0:t.combination(r,n)*e.pow(o,n)*e.pow(1-o,r-n)},cdf:function(r,o,i){var a;if(r<0)return 0;if(r>=o)return 1;if(i<0||i>1||o<=0)return NaN;var s=i,l=(r=e.floor(r))+1,u=o-r,c=l+u,f=e.exp(t.gammaln(c)-t.gammaln(u)-t.gammaln(l)+l*e.log(s)+u*e.log(1-s));return a=s<(l+1)/(c+2)?f*n(s,l,u,1e-10):1-f*n(1-s,u,l,1e-10),e.round(1e10*(1-a))/1e10}}),t.extend(t.negbin,{pdf:function(n,r,o){return n===n>>>0&&(n<0?0:t.combination(n+r-1,r-1)*e.pow(1-o,n)*e.pow(o,r))},cdf:function(e,n,r){var o=0,i=0;if(e<0)return 0;for(;i<=e;i++)o+=t.negbin.pdf(i,n,r);return o}}),t.extend(t.hypgeom,{pdf:function(n,r,o,i){if(n!=n|0)return!1;if(n<0||n<o-(r-i))return 0;if(n>i||n>o)return 0;if(2*o>r)return 2*i>r?t.hypgeom.pdf(r-o-i+n,r,r-o,r-i):t.hypgeom.pdf(i-n,r,r-o,i);if(2*i>r)return t.hypgeom.pdf(o-n,r,o,r-i);if(o<i)return t.hypgeom.pdf(n,r,i,o);for(var a=1,s=0,l=0;l<n;l++){for(;a>1&&s<i;)a*=1-o/(r-s),s++;a*=(i-l)*(o-l)/((l+1)*(r-o-i+l+1))}for(;s<i;s++)a*=1-o/(r-s);return e.min(1,e.max(0,a))},cdf:function(n,r,o,i){if(n<0||n<o-(r-i))return 0;if(n>=i||n>=o)return 1;if(2*o>r)return 2*i>r?t.hypgeom.cdf(r-o-i+n,r,r-o,r-i):1-t.hypgeom.cdf(i-n-1,r,r-o,i);if(2*i>r)return 1-t.hypgeom.cdf(o-n-1,r,o,r-i);if(o<i)return t.hypgeom.cdf(n,r,i,o);for(var a=1,s=1,l=0,u=0;u<n;u++){for(;a>1&&l<i;){var c=1-o/(r-l);s*=c,a*=c,l++}a+=s*=(i-u)*(o-u)/((u+1)*(r-o-i+u+1))}for(;l<i;l++)a*=1-o/(r-l);return e.min(1,e.max(0,a))}}),t.extend(t.poisson,{pdf:function(n,r){return r<0||n%1!=0||n<0?0:e.pow(r,n)*e.exp(-r)/t.factorial(n)},cdf:function(e,n){var r=[],o=0;if(e<0)return 0;for(;o<=e;o++)r.push(t.poisson.pdf(o,n));return t.sum(r)},mean:function(t){return t},variance:function(t){return t},sampleSmall:function(n){var r=1,o=0,i=e.exp(-n);do{o++,r*=t._random_fn()}while(r>i);return o-1},sampleLarge:function(n){var r,o,i,a,s,l,u,c,f,h,d=n;for(a=e.sqrt(d),s=e.log(d),l=.02483*(u=.931+2.53*a)-.059,c=1.1239+1.1328/(u-3.4),f=.9277-3.6224/(u-2);;){if(o=e.random()-.5,i=e.random(),h=.5-e.abs(o),r=e.floor((2*l/h+u)*o+d+.43),h>=.07&&i<=f)return r;if(!(r<0||h<.013&&i>h)&&e.log(i)+e.log(c)-e.log(l/(h*h)+u)<=r*s-d-t.loggam(r+1))return r}},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),t.extend(t.triangular,{pdf:function(t,e,n,r){return n<=e||r<e||r>n?NaN:t<e||t>n?0:t<r?2*(t-e)/((n-e)*(r-e)):t===r?2/(n-e):2*(n-t)/((n-e)*(n-r))},cdf:function(t,n,r,o){return r<=n||o<n||o>r?NaN:t<=n?0:t>=r?1:t<=o?e.pow(t-n,2)/((r-n)*(o-n)):1-e.pow(r-t,2)/((r-n)*(r-o))},inv:function(t,n,r,o){return r<=n||o<n||o>r?NaN:t<=(o-n)/(r-n)?n+(r-n)*e.sqrt(t*((o-n)/(r-n))):n+(r-n)*(1-e.sqrt((1-t)*(1-(o-n)/(r-n))))},mean:function(t,e,n){return(t+e+n)/3},median:function(t,n,r){return r<=(t+n)/2?n-e.sqrt((n-t)*(n-r))/e.sqrt(2):r>(t+n)/2?t+e.sqrt((n-t)*(r-t))/e.sqrt(2):void 0},mode:function(t,e,n){return n},sample:function(n,r,o){var i=t._random_fn();return i<(o-n)/(r-n)?n+e.sqrt(i*(r-n)*(o-n)):r-e.sqrt((1-i)*(r-n)*(r-o))},variance:function(t,e,n){return(t*t+e*e+n*n-t*e-t*n-e*n)/18}}),t.extend(t.arcsine,{pdf:function(t,n,r){return r<=n?NaN:t<=n||t>=r?0:2/e.PI*e.pow(e.pow(r-n,2)-e.pow(2*t-n-r,2),-.5)},cdf:function(t,n,r){return t<n?0:t<r?2/e.PI*e.asin(e.sqrt((t-n)/(r-n))):1},inv:function(t,n,r){return n+(.5-.5*e.cos(e.PI*t))*(r-n)},mean:function(t,e){return e<=t?NaN:(t+e)/2},median:function(t,e){return e<=t?NaN:(t+e)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*e.sin(2*e.PI*t.uniform.sample(0,1))},variance:function(t,n){return n<=t?NaN:e.pow(n-t,2)/8}}),t.extend(t.laplace,{pdf:function(t,n,r){return r<=0?0:e.exp(-e.abs(t-n)/r)/(2*r)},cdf:function(t,n,r){return r<=0?0:t<n?.5*e.exp((t-n)/r):1-.5*e.exp(-(t-n)/r)},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},variance:function(t,e){return 2*e*e},sample:function(n,r){var o,i=t._random_fn()-.5;return n-r*((o=i)/e.abs(o))*e.log(1-2*e.abs(i))}}),t.extend(t.tukey,{cdf:function(n,o,i){var a=o,s=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],l=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(i<2||a<2)return NaN;if(!Number.isFinite(n))return 1;if(i>25e3)return r(n,1,a);var u,c=.5*i,f=c*e.log(i)-i*e.log(2)-t.gammaln(c),h=c-1,d=.25*i;u=i<=100?1:i<=800?.5:i<=5e3?.25:.125,f+=e.log(u);for(var p=0,g=1;g<=50;g++){for(var v=0,y=(2*g-1)*u,m=1;m<=16;m++){var b,w;8<m?(b=m-8-1,w=f+h*e.log(y+s[b]*u)-(s[b]*u+y)*d):(b=m-1,w=f+h*e.log(y-s[b]*u)+(s[b]*u-y)*d),w>=-30&&(v+=r(8<m?n*e.sqrt(.5*(s[b]*u+y)):n*e.sqrt(.5*(-s[b]*u+y)),1,a)*l[b]*e.exp(w))}if(g*u>=1&&v<=1e-14)break;p+=v}if(v>1e-14)throw new Error("tukey.cdf failed to converge");return p>1&&(p=1),p},inv:function(n,r,o){if(o<2||r<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var i,a=function(t,n,r){var o=.5-.5*t,i=e.sqrt(e.log(1/(o*o))),a=i+((((-453642210148e-16*i-.204231210125)*i-.342242088547)*i-1)*i+.322232421088)/((((.0038560700634*i+.10353775285)*i+.531103462366)*i+.588581570495)*i+.099348462606);r<120&&(a+=(a*a*a+a)/r/4);var s=.8832-.2368*a;return r<120&&(s+=-1.214/r+1.208*a/r),a*(s*e.log(n-1)+1.4142)}(n,r,o),s=t.tukey.cdf(a,r,o)-n;i=s>0?e.max(0,a-1):a+1;for(var l,u=t.tukey.cdf(i,r,o)-n,c=1;c<50;c++)if(l=i-u*(i-a)/(u-s),s=u,a=i,l<0&&(l=0,u=-n),u=t.tukey.cdf(l,r,o)-n,i=l,e.abs(i-a)<1e-4)return l;throw new Error("tukey.inv failed to converge")}})}(r,Math),function(t,e){var n,r,o=Array.prototype.push,i=t.utils.isArray;function a(e){return i(e)||e instanceof t}t.extend({add:function(e,n){return a(n)?(a(n[0])||(n=[n]),t.map(e,(function(t,e,r){return t+n[e][r]}))):t.map(e,(function(t){return t+n}))},subtract:function(e,n){return a(n)?(a(n[0])||(n=[n]),t.map(e,(function(t,e,r){return t-n[e][r]||0}))):t.map(e,(function(t){return t-n}))},divide:function(e,n){return a(n)?(a(n[0])||(n=[n]),t.multiply(e,t.inv(n))):t.map(e,(function(t){return t/n}))},multiply:function(e,n){var r,o,i,s,l,u,c,f;if(void 0===e.length&&void 0===n.length)return e*n;if(l=e.length,u=e[0].length,c=t.zeros(l,i=a(n)?n[0].length:u),f=0,a(n)){for(;f<i;f++)for(r=0;r<l;r++){for(s=0,o=0;o<u;o++)s+=e[r][o]*n[o][f];c[r][f]=s}return 1===l&&1===f?c[0][0]:c}return t.map(e,(function(t){return t*n}))},outer:function(e,n){return t.multiply(e.map((function(t){return[t]})),[n])},dot:function(e,n){a(e[0])||(e=[e]),a(n[0])||(n=[n]);for(var r,o,i=1===e[0].length&&1!==e.length?t.transpose(e):e,s=1===n[0].length&&1!==n.length?t.transpose(n):n,l=[],u=0,c=i.length,f=i[0].length;u<c;u++){for(l[u]=[],r=0,o=0;o<f;o++)r+=i[u][o]*s[u][o];l[u]=r}return 1===l.length?l[0]:l},pow:function(n,r){return t.map(n,(function(t){return e.pow(t,r)}))},exp:function(n){return t.map(n,(function(t){return e.exp(t)}))},log:function(n){return t.map(n,(function(t){return e.log(t)}))},abs:function(n){return t.map(n,(function(t){return e.abs(t)}))},norm:function(t,n){var r=0,o=0;for(isNaN(n)&&(n=2),a(t[0])&&(t=t[0]);o<t.length;o++)r+=e.pow(e.abs(t[o]),n);return e.pow(r,1/n)},angle:function(n,r){return e.acos(t.dot(n,r)/(t.norm(n)*t.norm(r)))},aug:function(t,e){var n,r=[];for(n=0;n<t.length;n++)r.push(t[n].slice());for(n=0;n<r.length;n++)o.apply(r[n],e[n]);return r},inv:function(e){for(var n,r=e.length,o=e[0].length,i=t.identity(r,o),a=t.gauss_jordan(e,i),s=[],l=0;l<r;l++)for(s[l]=[],n=o;n<a[0].length;n++)s[l][n-o]=a[l][n];return s},det:function(t){var e,n=t.length,r=2*n,o=new Array(r),i=n-1,a=r-1,s=i-n+1,l=a,u=0,c=0;if(2===n)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(;u<r;u++)o[u]=1;for(u=0;u<n;u++){for(e=0;e<n;e++)o[s<0?s+n:s]*=t[u][e],o[l<n?l+n:l]*=t[u][e],s++,l--;s=--i-n+1,l=--a}for(u=0;u<n;u++)c+=o[u];for(;u<r;u++)c-=o[u];return c},gauss_elimination:function(n,r){var o,i,a,s,l=0,u=0,c=n.length,f=n[0].length,h=1,d=0,p=[];for(o=(n=t.aug(n,r))[0].length,l=0;l<c;l++){for(i=n[l][l],u=l,s=l+1;s<f;s++)i<e.abs(n[s][l])&&(i=n[s][l],u=s);if(u!=l)for(s=0;s<o;s++)a=n[l][s],n[l][s]=n[u][s],n[u][s]=a;for(u=l+1;u<c;u++)for(h=n[u][l]/n[l][l],s=l;s<o;s++)n[u][s]=n[u][s]-h*n[l][s]}for(l=c-1;l>=0;l--){for(d=0,u=l+1;u<=c-1;u++)d+=p[u]*n[l][u];p[l]=(n[l][o-1]-d)/n[l][l]}return p},gauss_jordan:function(n,r){var o,i,a,s=t.aug(n,r),l=s.length,u=s[0].length,c=0;for(i=0;i<l;i++){var f=i;for(a=i+1;a<l;a++)e.abs(s[a][i])>e.abs(s[f][i])&&(f=a);var h=s[i];for(s[i]=s[f],s[f]=h,a=i+1;a<l;a++)for(c=s[a][i]/s[i][i],o=i;o<u;o++)s[a][o]-=s[i][o]*c}for(i=l-1;i>=0;i--){for(c=s[i][i],a=0;a<i;a++)for(o=u-1;o>i-1;o--)s[a][o]-=s[i][o]*s[a][i]/c;for(s[i][i]/=c,o=l;o<u;o++)s[i][o]/=c}return s},triaUpSolve:function(e,n){var r,o=e[0].length,i=t.zeros(1,o)[0],a=!1;return null!=n[0].length&&(n=n.map((function(t){return t[0]})),a=!0),t.arange(o-1,-1,-1).forEach((function(a){r=t.arange(a+1,o).map((function(t){return i[t]*e[a][t]})),i[a]=(n[a]-t.sum(r))/e[a][a]})),a?i.map((function(t){return[t]})):i},triaLowSolve:function(e,n){var r,o=e[0].length,i=t.zeros(1,o)[0],a=!1;return null!=n[0].length&&(n=n.map((function(t){return t[0]})),a=!0),t.arange(o).forEach((function(o){r=t.arange(o).map((function(t){return e[o][t]*i[t]})),i[o]=(n[o]-t.sum(r))/e[o][o]})),a?i.map((function(t){return[t]})):i},lu:function(e){var n,r=e.length,o=t.identity(r),i=t.zeros(e.length,e[0].length);return t.arange(r).forEach((function(t){i[0][t]=e[0][t]})),t.arange(1,r).forEach((function(a){t.arange(a).forEach((function(r){n=t.arange(r).map((function(t){return o[a][t]*i[t][r]})),o[a][r]=(e[a][r]-t.sum(n))/i[r][r]})),t.arange(a,r).forEach((function(r){n=t.arange(a).map((function(t){return o[a][t]*i[t][r]})),i[a][r]=e[n.length][r]-t.sum(n)}))})),[o,i]},cholesky:function(n){var r,o=n.length,i=t.zeros(n.length,n[0].length);return t.arange(o).forEach((function(a){r=t.arange(a).map((function(t){return e.pow(i[a][t],2)})),i[a][a]=e.sqrt(n[a][a]-t.sum(r)),t.arange(a+1,o).forEach((function(e){r=t.arange(a).map((function(t){return i[a][t]*i[e][t]})),i[e][a]=(n[a][e]-t.sum(r))/i[a][a]}))})),i},gauss_jacobi:function(n,r,o,i){for(var a,s,l,u,c=0,f=0,h=n.length,d=[],p=[],g=[];c<h;c++)for(d[c]=[],p[c]=[],g[c]=[],f=0;f<h;f++)c>f?(d[c][f]=n[c][f],p[c][f]=g[c][f]=0):c<f?(p[c][f]=n[c][f],d[c][f]=g[c][f]=0):(g[c][f]=n[c][f],d[c][f]=p[c][f]=0);for(l=t.multiply(t.multiply(t.inv(g),t.add(d,p)),-1),s=t.multiply(t.inv(g),r),a=o,u=t.add(t.multiply(l,o),s),c=2;e.abs(t.norm(t.subtract(u,a)))>i;)a=u,u=t.add(t.multiply(l,a),s),c++;return u},gauss_seidel:function(n,r,o,i){for(var a,s,l,u,c,f=0,h=n.length,d=[],p=[],g=[];f<h;f++)for(d[f]=[],p[f]=[],g[f]=[],a=0;a<h;a++)f>a?(d[f][a]=n[f][a],p[f][a]=g[f][a]=0):f<a?(p[f][a]=n[f][a],d[f][a]=g[f][a]=0):(g[f][a]=n[f][a],d[f][a]=p[f][a]=0);for(u=t.multiply(t.multiply(t.inv(t.add(g,d)),p),-1),l=t.multiply(t.inv(t.add(g,d)),r),s=o,c=t.add(t.multiply(u,o),l),f=2;e.abs(t.norm(t.subtract(c,s)))>i;)s=c,c=t.add(t.multiply(u,s),l),f+=1;return c},SOR:function(n,r,o,i,a){for(var s,l,u,c,f,h=0,d=n.length,p=[],g=[],v=[];h<d;h++)for(p[h]=[],g[h]=[],v[h]=[],s=0;s<d;s++)h>s?(p[h][s]=n[h][s],g[h][s]=v[h][s]=0):h<s?(g[h][s]=n[h][s],p[h][s]=v[h][s]=0):(v[h][s]=n[h][s],p[h][s]=g[h][s]=0);for(c=t.multiply(t.inv(t.add(v,t.multiply(p,a))),t.subtract(t.multiply(v,1-a),t.multiply(g,a))),u=t.multiply(t.multiply(t.inv(t.add(v,t.multiply(p,a))),r),a),l=o,f=t.add(t.multiply(c,o),u),h=2;e.abs(t.norm(t.subtract(f,l)))>i;)l=f,f=t.add(t.multiply(c,l),u),h++;return f},householder:function(n){for(var r,o,i,a,s=n.length,l=n[0].length,u=0,c=[],f=[];u<s-1;u++){for(r=0,a=u+1;a<l;a++)r+=n[a][u]*n[a][u];for(r=(n[u+1][u]>0?-1:1)*e.sqrt(r),o=e.sqrt((r*r-n[u+1][u]*r)/2),(c=t.zeros(s,1))[u+1][0]=(n[u+1][u]-r)/(2*o),i=u+2;i<s;i++)c[i][0]=n[i][u]/(2*o);f=t.subtract(t.identity(s,l),t.multiply(t.multiply(c,t.transpose(c)),2)),n=t.multiply(f,t.multiply(n,f))}return n},QR:(n=t.sum,r=t.arange,function(o){var i,a,s,l=o.length,u=o[0].length,c=t.zeros(u,u);for(o=t.copy(o),a=0;a<u;a++){for(c[a][a]=e.sqrt(n(r(l).map((function(t){return o[t][a]*o[t][a]})))),i=0;i<l;i++)o[i][a]=o[i][a]/c[a][a];for(s=a+1;s<u;s++)for(c[a][s]=n(r(l).map((function(t){return o[t][a]*o[t][s]}))),i=0;i<l;i++)o[i][s]=o[i][s]-o[i][a]*c[a][s]}return[o,c]}),lstsq:function(e,n){var r=!1;void 0===n[0].length&&(n=n.map((function(t){return[t]})),r=!0);var o=t.QR(e),i=o[0],a=o[1],s=e[0].length,l=t.slice(i,{col:{end:s}}),u=function(e){var n=(e=t.copy(e)).length,r=t.identity(n);return t.arange(n-1,-1,-1).forEach((function(n){t.sliceAssign(r,{row:n},t.divide(t.slice(r,{row:n}),e[n][n])),t.sliceAssign(e,{row:n},t.divide(t.slice(e,{row:n}),e[n][n])),t.arange(n).forEach((function(o){var i=t.multiply(e[o][n],-1),a=t.slice(e,{row:o}),s=t.multiply(t.slice(e,{row:n}),i);t.sliceAssign(e,{row:o},t.add(a,s));var l=t.slice(r,{row:o}),u=t.multiply(t.slice(r,{row:n}),i);t.sliceAssign(r,{row:o},t.add(l,u))}))})),r}(t.slice(a,{row:{end:s}})),c=t.transpose(l);void 0===c[0].length&&(c=[c]);var f=t.multiply(t.multiply(u,c),n);return void 0===f.length&&(f=[[f]]),r?f.map((function(t){return t[0]})):f},jacobi:function(n){for(var r,o,i,a,s,l,u,c=1,f=n.length,h=t.identity(f,f),d=[];1===c;){for(s=n[0][1],i=0,a=1,r=0;r<f;r++)for(o=0;o<f;o++)r!=o&&s<e.abs(n[r][o])&&(s=e.abs(n[r][o]),i=r,a=o);for(l=n[i][i]===n[a][a]?n[i][a]>0?e.PI/4:-e.PI/4:e.atan(2*n[i][a]/(n[i][i]-n[a][a]))/2,(u=t.identity(f,f))[i][i]=e.cos(l),u[i][a]=-e.sin(l),u[a][i]=e.sin(l),u[a][a]=e.cos(l),h=t.multiply(h,u),n=t.multiply(t.multiply(t.inv(u),n),u),c=0,r=1;r<f;r++)for(o=1;o<f;o++)r!=o&&e.abs(n[r][o])>.001&&(c=1)}for(r=0;r<f;r++)d.push(n[r][r]);return[h,d]},rungekutta:function(t,e,n,r,o,i){var a,s,l;if(2===i)for(;r<=n;)o+=((a=e*t(r,o))+(s=e*t(r+e,o+a)))/2,r+=e;if(4===i)for(;r<=n;)o+=((a=e*t(r,o))+2*(s=e*t(r+e/2,o+a/2))+2*(l=e*t(r+e/2,o+s/2))+e*t(r+e,o+l))/6,r+=e;return o},romberg:function(t,n,r,o){for(var i,a,s,l,u,c=0,f=(r-n)/2,h=[],d=[],p=[];c<o/2;){for(u=t(n),s=n,l=0;s<=r;s+=f,l++)h[l]=s;for(i=h.length,s=1;s<i-1;s++)u+=(s%2!=0?4:2)*t(h[s]);u=f/3*(u+t(r)),p[c]=u,f/=2,c++}for(a=p.length,i=1;1!==a;){for(s=0;s<a-1;s++)d[s]=(e.pow(4,i)*p[s+1]-p[s])/(e.pow(4,i)-1);a=d.length,p=d,d=[],i++}return p},richardson:function(t,n,r,o){function i(t,e){for(var n,r=0,o=t.length;r<o;r++)t[r]===e&&(n=r);return n}for(var a,s,l,u,c,f=e.abs(r-t[i(t,r)+1]),h=0,d=[],p=[];o>=f;)a=i(t,r+o),s=i(t,r),d[h]=(n[a]-2*n[s]+n[2*s-a])/(o*o),o/=2,h++;for(u=d.length,l=1;1!=u;){for(c=0;c<u-1;c++)p[c]=(e.pow(4,l)*d[c+1]-d[c])/(e.pow(4,l)-1);u=p.length,d=p,p=[],l++}return d},simpson:function(t,e,n,r){for(var o,i=(n-e)/r,a=t(e),s=[],l=e,u=0,c=1;l<=n;l+=i,u++)s[u]=l;for(o=s.length;c<o-1;c++)a+=(c%2!=0?4:2)*t(s[c]);return i/3*(a+t(n))},hermite:function(t,e,n,r){for(var o,i=t.length,a=0,s=0,l=[],u=[],c=[],f=[];s<i;s++){for(l[s]=1,o=0;o<i;o++)s!=o&&(l[s]*=(r-t[o])/(t[s]-t[o]));for(u[s]=0,o=0;o<i;o++)s!=o&&(u[s]+=1/(t[s]-t[o]));c[s]=(1-2*(r-t[s])*u[s])*(l[s]*l[s]),f[s]=(r-t[s])*(l[s]*l[s]),a+=c[s]*e[s]+f[s]*n[s]}return a},lagrange:function(t,e,n){for(var r,o,i=0,a=0,s=t.length;a<s;a++){for(o=e[a],r=0;r<s;r++)a!=r&&(o*=(n-t[r])/(t[a]-t[r]));i+=o}return i},cubic_spline:function(e,n,r){for(var o,i,a=e.length,s=0,l=[],u=[],c=[],f=[],h=[],d=[];s<a-1;s++)f[s]=e[s+1]-e[s];for(c[0]=0,s=1;s<a-1;s++)c[s]=3/f[s]*(n[s+1]-n[s])-3/f[s-1]*(n[s]-n[s-1]);for(s=1;s<a-1;s++)l[s]=[],u[s]=[],l[s][s-1]=f[s-1],l[s][s]=2*(f[s-1]+f[s]),l[s][s+1]=f[s],u[s][0]=c[s];for(i=t.multiply(t.inv(l),u),o=0;o<a-1;o++)h[o]=(n[o+1]-n[o])/f[o]-f[o]*(i[o+1][0]+2*i[o][0])/3,d[o]=(i[o+1][0]-i[o][0])/(3*f[o]);for(o=0;o<a&&!(e[o]>r);o++);return n[o-=1]+(r-e[o])*h[o]+t.sq(r-e[o])*i[o]+(r-e[o])*t.sq(r-e[o])*d[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(e){var n,r,o,i,a,s=e.length,l=e[0].length,u=0,c=[],f=[],h=[],d=[],p=[],g=[],v=[];for(u=0;u<s;u++)c[u]=t.sum(e[u])/l;for(u=0;u<l;u++)for(p[u]=[],n=0;n<s;n++)p[u][n]=e[n][u]-c[n];for(p=t.transpose(p),u=0;u<s;u++)for(g[u]=[],n=0;n<s;n++)g[u][n]=t.dot([p[u]],[p[n]])/(l-1);for(a=(o=t.jacobi(g))[0],f=o[1],v=t.transpose(a),u=0;u<f.length;u++)for(n=u;n<f.length;n++)f[u]<f[n]&&(r=f[u],f[u]=f[n],f[n]=r,h=v[u],v[u]=v[n],v[n]=h);for(i=t.transpose(p),u=0;u<s;u++)for(d[u]=[],n=0;n<i.length;n++)d[u][n]=t.dot([v[u]],[i[n]]);return[e,f,v,d]}}),function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(n,r){var o=this;return r?(setTimeout((function(){r.call(o,t.fn[e].call(o,n))}),15),this):"number"==typeof t[e](this,n)?t[e](this,n):t(t[e](this,n))}}(e[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(r,Math),function(t,e){var n=[].slice,r=t.utils.isNumber,o=t.utils.isArray;function i(t,n,r,o){if(t>1||r>1||t<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(t*n+r*o)/(n+o);return(t-r)/e.sqrt(i*(1-i)*(1/n+1/o))}t.extend({zscore:function(){var e=n.call(arguments);return r(e[1])?(e[0]-e[1])/e[2]:(e[0]-t.mean(e[1]))/t.stdev(e[1],e[2])},ztest:function(){var r,i=n.call(arguments);return o(i[1])?(r=t.zscore(i[0],i[1],i[3]),1===i[2]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1)):i.length>2?(r=t.zscore(i[0],i[1],i[2]),1===i[3]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1)):(r=i[0],1===i[1]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1))}}),t.extend(t.fn,{zscore:function(t,e){return(t-this.mean())/this.stdev(e)},ztest:function(n,r,o){var i=e.abs(this.zscore(n,o));return 1===r?t.normal.cdf(-i,0,1):2*t.normal.cdf(-i,0,1)}}),t.extend({tscore:function(){var r=n.call(arguments);return 4===r.length?(r[0]-r[1])/(r[2]/e.sqrt(r[3])):(r[0]-t.mean(r[1]))/(t.stdev(r[1],!0)/e.sqrt(r[1].length))},ttest:function(){var o,i=n.call(arguments);return 5===i.length?(o=e.abs(t.tscore(i[0],i[1],i[2],i[3])),1===i[4]?t.studentt.cdf(-o,i[3]-1):2*t.studentt.cdf(-o,i[3]-1)):r(i[1])?(o=e.abs(i[0]),1==i[2]?t.studentt.cdf(-o,i[1]-1):2*t.studentt.cdf(-o,i[1]-1)):(o=e.abs(t.tscore(i[0],i[1])),1==i[2]?t.studentt.cdf(-o,i[1].length-1):2*t.studentt.cdf(-o,i[1].length-1))}}),t.extend(t.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-t.studentt.cdf(e.abs(this.tscore(n)),this.cols()-1):2*t.studentt.cdf(-e.abs(this.tscore(n)),this.cols()-1)}}),t.extend({anovafscore:function(){var r,o,i,a,s,l,u,c,f=n.call(arguments);if(1===f.length){for(s=new Array(f[0].length),u=0;u<f[0].length;u++)s[u]=f[0][u];f=s}for(o=new Array,u=0;u<f.length;u++)o=o.concat(f[u]);for(i=t.mean(o),r=0,u=0;u<f.length;u++)r+=f[u].length*e.pow(t.mean(f[u])-i,2);for(r/=f.length-1,l=0,u=0;u<f.length;u++)for(a=t.mean(f[u]),c=0;c<f[u].length;c++)l+=e.pow(f[u][c]-a,2);return r/(l/=o.length-f.length)},anovaftest:function(){var e,o,i,a,s=n.call(arguments);if(r(s[0]))return 1-t.centralF.cdf(s[0],s[1],s[2]);var l=t.anovafscore(s);for(e=s.length-1,i=0,a=0;a<s.length;a++)i+=s[a].length;return o=i-e-1,1-t.centralF.cdf(l,e,o)},ftest:function(e,n,r){return 1-t.centralF.cdf(e,n,r)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var e,n=0;for(e=0;e<this.length;e++)n+=this[e].length;return t.ftest(this.anovafscore(),this.length-1,n-this.length)}}),t.extend({qscore:function(){var o,i,a,s,l,u=n.call(arguments);return r(u[0])?(o=u[0],i=u[1],a=u[2],s=u[3],l=u[4]):(o=t.mean(u[0]),i=t.mean(u[1]),a=u[0].length,s=u[1].length,l=u[2]),e.abs(o-i)/(l*e.sqrt((1/a+1/s)/2))},qtest:function(){var e,r=n.call(arguments);3===r.length?(e=r[0],r=r.slice(1)):7===r.length?(e=t.qscore(r[0],r[1],r[2],r[3],r[4]),r=r.slice(5)):(e=t.qscore(r[0],r[1],r[2]),r=r.slice(3));var o=r[0],i=r[1];return 1-t.tukey.cdf(e,i,o-i)},tukeyhsd:function(e){for(var n=t.pooledstdev(e),r=e.map((function(e){return t.mean(e)})),o=e.reduce((function(t,e){return t+e.length}),0),i=[],a=0;a<e.length;++a)for(var s=a+1;s<e.length;++s){var l=t.qtest(r[a],r[s],e[a].length,e[s].length,n,o,e.length);i.push([[a,s],l])}return i}}),t.extend({normalci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?e.abs(t.normal.inv(o[1]/2,0,1)*o[2]/e.sqrt(o[3])):e.abs(t.normal.inv(o[1]/2,0,1)*t.stdev(o[2])/e.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},tci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?e.abs(t.studentt.inv(o[1]/2,o[3]-1)*o[2]/e.sqrt(o[3])):e.abs(t.studentt.inv(o[1]/2,o[2].length-1)*t.stdev(o[2],!0)/e.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},significant:function(t,e){return t<e}}),t.extend(t.fn,{normalci:function(e,n){return t.normalci(e,n,this.toArray())},tci:function(e,n){return t.tci(e,n,this.toArray())}}),t.extend(t.fn,{oneSidedDifferenceOfProportions:function(e,n,r,o){var a=i(e,n,r,o);return t.ztest(a,1)},twoSidedDifferenceOfProportions:function(e,n,r,o){var a=i(e,n,r,o);return t.ztest(a,2)}})}(r,Math),r.models=function(){function t(t,e){var n=t.length,o=e[0].length-1,i=n-o-1,a=r.lstsq(e,t),s=r.multiply(e,a.map((function(t){return[t]}))).map((function(t){return t[0]})),l=r.subtract(t,s),u=r.mean(t),c=r.sum(s.map((function(t){return Math.pow(t-u,2)}))),f=r.sum(t.map((function(t,e){return Math.pow(t-s[e],2)}))),h=c+f;return{exog:e,endog:t,nobs:n,df_model:o,df_resid:i,coef:a,predict:s,resid:l,ybar:u,SST:h,SSE:c,SSR:f,R2:c/h}}function e(e){var n,o,i=(n=e.exog,o=n[0].length,r.arange(o).map((function(e){var i=r.arange(o).filter((function(t){return t!==e}));return t(r.col(n,e).map((function(t){return t[0]})),r.col(n,i))}))),a=Math.sqrt(e.SSR/e.df_resid),s=i.map((function(t){var e=t.SST,n=t.R2;return a/Math.sqrt(e*(1-n))})),l=e.coef.map((function(t,e){return(t-0)/s[e]})),u=l.map((function(t){var n=r.studentt.cdf(t,e.df_resid);return 2*(n>.5?1-n:n)})),c=r.studentt.inv(.975,e.df_resid),f=e.coef.map((function(t,e){var n=c*s[e];return[t-n,t+n]}));return{se:s,t:l,p:u,sigmaHat:a,interval95:f}}return{ols:function(n,o){var i=t(n,o),a=e(i),s=function(t){var e,n,o,i=t.R2/t.df_model/((1-t.R2)/t.df_resid);return{F_statistic:i,pvalue:1-(e=i,n=t.df_model,o=t.df_resid,r.beta.cdf(e/(o/n+e),n/2,o/2))}}(i),l=1-(1-i.R2)*((i.nobs-1)/i.df_resid);return i.t=a,i.f=s,i.adjust_R2=l,i}}}(),r.extend({buildxmatrix:function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++){var n=[1];t[e]=n.concat(arguments[e])}return r(t)},builddxmatrix:function(){for(var t=new Array(arguments[0].length),e=0;e<arguments[0].length;e++){var n=[1];t[e]=n.concat(arguments[0][e])}return r(t)},buildjxmatrix:function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n];return r.builddxmatrix(e)},buildymatrix:function(t){return r(t).transpose()},buildjymatrix:function(t){return t.transpose()},matrixmult:function(t,e){var n,o,i,a,s;if(t.cols()==e.rows()){if(e.rows()>1){for(a=[],n=0;n<t.rows();n++)for(a[n]=[],o=0;o<e.cols();o++){for(s=0,i=0;i<t.cols();i++)s+=t.toArray()[n][i]*e.toArray()[i][o];a[n][o]=s}return r(a)}for(a=[],n=0;n<t.rows();n++)for(a[n]=[],o=0;o<e.cols();o++){for(s=0,i=0;i<t.cols();i++)s+=t.toArray()[n][i]*e.toArray()[o];a[n][o]=s}return r(a)}},regress:function(t,e){var n=r.xtranspxinv(t),o=t.transpose(),i=r.matrixmult(r(n),o);return r.matrixmult(i,e)},regresst:function(t,e,n){var o=r.regress(t,e),i={anova:{}},a=r.jMatYBar(t,o);i.yBar=a;var s=e.mean();i.anova.residuals=r.residuals(e,a),i.anova.ssr=r.ssr(a,s),i.anova.msr=i.anova.ssr/(t[0].length-1),i.anova.sse=r.sse(e,a),i.anova.mse=i.anova.sse/(e.length-(t[0].length-1)-1),i.anova.sst=r.sst(e,s),i.anova.mst=i.anova.sst/(e.length-1),i.anova.r2=1-i.anova.sse/i.anova.sst,i.anova.r2<0&&(i.anova.r2=0),i.anova.fratio=i.anova.msr/i.anova.mse,i.anova.pvalue=r.anovaftest(i.anova.fratio,t[0].length-1,e.length-(t[0].length-1)-1),i.anova.rmse=Math.sqrt(i.anova.mse),i.anova.r2adj=1-i.anova.mse/i.anova.mst,i.anova.r2adj<0&&(i.anova.r2adj=0),i.stats=new Array(t[0].length);for(var l,u,c,f=r.xtranspxinv(t),h=0;h<o.length;h++)l=Math.sqrt(i.anova.mse*Math.abs(f[h][h])),u=Math.abs(o[h]/l),c=r.ttest(u,e.length-t[0].length-1,n),i.stats[h]=[o[h],l,u,c];return i.regress=o,i},xtranspx:function(t){return r.matrixmult(t.transpose(),t)},xtranspxinv:function(t){var e=r.matrixmult(t.transpose(),t);return r.inv(e)},jMatYBar:function(t,e){var n=r.matrixmult(t,e);return new r(n)},residuals:function(t,e){return r.matrixsubtract(t,e)},ssr:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},sse:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e[r],2);return n},sst:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},matrixsubtract:function(t,e){for(var n=new Array(t.length),o=0;o<t.length;o++){n[o]=new Array(t[o].length);for(var i=0;i<t[o].length;i++)n[o][i]=t[o][i]-e[o][i]}return r(n)}}),r.jStat=r,r)},function(t,e,n){var r=n(1),o=n(0);e.UNIQUE=function(){for(var t=[],e=0;e<arguments.length;++e){for(var n=!1,r=arguments[e],o=0;o<t.length&&!(n=t[o]===r);++o);n||t.push(r)}return t},e.FLATTEN=r.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(t,e){if(!arguments.length)return o.error;try{for(var n=e.split("."),r=t,i=0;i<n.length;++i){var a=n[i];if("]"===a[a.length-1]){var s=a.indexOf("["),l=a.substring(s+1,a.length-1);r=r[a.substring(0,s)][l]}else r=r[a]}return r}catch(t){}},e.JOIN=function(t,e){return t.join(e)},e.NUMBERS=function(){var t=r.flatten(arguments);return t.filter((function(t){return"number"==typeof t}))}},function(t,e,n){var r=n(0),o=n(10),i=n(6),a=n(1),s=n(26);function l(t){return/^[01]{1,10}$/.test(t)}e.BESSELI=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:s.besseli(t,e)},e.BESSELJ=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:s.besselj(t,e)},e.BESSELK=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:s.besselk(t,e)},e.BESSELY=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:s.bessely(t,e)},e.BIN2DEC=function(t){if(!l(t))return r.num;var e=parseInt(t,2),n=t.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:e},e.BIN2HEX=function(t,e){if(!l(t))return r.num;var n=t.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var o=parseInt(t,2).toString(16);return void 0===e?o:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:r.num},e.BIN2OCT=function(t,e){if(!l(t))return r.num;var n=t.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var o=parseInt(t,2).toString(8);return void 0===e?o:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:r.num},e.BITAND=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t<0||e<0?r.num:Math.floor(t)!==t||Math.floor(e)!==e?r.num:t>0xffffffffffff||e>0xffffffffffff?r.num:t&e},e.BITLSHIFT=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t<0?r.num:Math.floor(t)!==t?r.num:t>0xffffffffffff?r.num:Math.abs(e)>53?r.num:e>=0?t<<e:t>>-e},e.BITOR=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t<0||e<0?r.num:Math.floor(t)!==t||Math.floor(e)!==e?r.num:t>0xffffffffffff||e>0xffffffffffff?r.num:t|e},e.BITRSHIFT=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t<0?r.num:Math.floor(t)!==t?r.num:t>0xffffffffffff?r.num:Math.abs(e)>53?r.num:e>=0?t>>e:t<<-e},e.BITXOR=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t<0||e<0?r.num:Math.floor(t)!==t||Math.floor(e)!==e?r.num:t>0xffffffffffff||e>0xffffffffffff?r.num:t^e},e.COMPLEX=function(t,e,n){if(t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e))return t;if("i"!==(n=void 0===n?"i":n)&&"j"!==n)return r.value;if(0===t&&0===e)return 0;if(0===t)return 1===e?n:e.toString()+n;if(0===e)return t.toString();var o=e>0?"+":"";return t.toString()+o+(1===e?n:e.toString()+n)},e.CONVERT=function(t,e,n){if((t=a.parseNumber(t))instanceof Error)return t;for(var o,i=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},u=null,c=null,f=e,h=n,d=1,p=1,g=0;g<i.length;g++)o=null===i[g][2]?[]:i[g][2],(i[g][1]===f||o.indexOf(f)>=0)&&(u=i[g]),(i[g][1]===h||o.indexOf(h)>=0)&&(c=i[g]);if(null===u){var v=s[e.substring(0,2)],y=l[e.substring(0,1)];"da"===e.substring(0,2)&&(y=["dekao",10,"da"]),v?(d=v[2],f=e.substring(2)):y&&(d=y[1],f=e.substring(y[2].length));for(var m=0;m<i.length;m++)o=null===i[m][2]?[]:i[m][2],(i[m][1]===f||o.indexOf(f)>=0)&&(u=i[m])}if(null===c){var b=s[n.substring(0,2)],w=l[n.substring(0,1)];"da"===n.substring(0,2)&&(w=["dekao",10,"da"]),b?(p=b[2],h=n.substring(2)):w&&(p=w[1],h=n.substring(w[2].length));for(var O=0;O<i.length;O++)o=null===i[O][2]?[]:i[O][2],(i[O][1]===h||o.indexOf(h)>=0)&&(c=i[O])}return null===u||null===c?r.na:u[3]!==c[3]?r.na:t*u[6]*d/(c[6]*p)},e.DEC2BIN=function(t,e){if((t=a.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return r.num;if(t<0)return"1"+i.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var n=parseInt(t,10).toString(2);return void 0===e?n:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=n.length?i.REPT("0",e-n.length)+n:r.num},e.DEC2HEX=function(t,e){if((t=a.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return r.num;if(t<0)return(1099511627776+t).toString(16);var n=parseInt(t,10).toString(16);return void 0===e?n:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=n.length?i.REPT("0",e-n.length)+n:r.num},e.DEC2OCT=function(t,e){if((t=a.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return r.num;if(t<0)return(1073741824+t).toString(8);var n=parseInt(t,10).toString(8);return void 0===e?n:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=n.length?i.REPT("0",e-n.length)+n:r.num},e.DELTA=function(t,e){return e=void 0===e?0:e,t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:t===e?1:0},e.ERF=function(t,e){return e=void 0===e?0:e,t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?r.value:o.erf(t)},e.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},e.ERFC=function(t){return isNaN(t)?r.value:o.erfc(t)},e.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},e.GESTEP=function(t,e){return e=e||0,t=a.parseNumber(t),a.anyIsError(e,t)?t:t>=e?1:0},e.HEX2BIN=function(t,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return r.num;var n=10===t.length&&"f"===t.substring(0,1).toLowerCase(),o=n?parseInt(t,16)-1099511627776:parseInt(t,16);if(o<-512||o>511)return r.num;if(n)return"1"+i.REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var a=o.toString(2);return void 0===e?a:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=a.length?i.REPT("0",e-a.length)+a:r.num},e.HEX2DEC=function(t){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return r.num;var e=parseInt(t,16);return e>=549755813888?e-1099511627776:e},e.HEX2OCT=function(t,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return r.num;var n=parseInt(t,16);if(n>536870911&&n<0xffe0000000)return r.num;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var o=n.toString(8);return void 0===e?o:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:r.num},e.IMABS=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:Math.sqrt(Math.pow(n,2)+Math.pow(o,2))},e.IMAGINARY=function(t){if(void 0===t||!0===t||!1===t)return r.value;if(0===t||"0"===t)return 0;if(["i","j"].indexOf(t)>=0)return 1;var e=(t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=t.indexOf("-");0===e&&(e=t.indexOf("+",1)),0===n&&(n=t.indexOf("-",1));var o=t.substring(t.length-1,t.length),i="i"===o||"j"===o;return e>=0||n>=0?i?e>=0?isNaN(t.substring(0,e))||isNaN(t.substring(e+1,t.length-1))?r.num:Number(t.substring(e+1,t.length-1)):isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?r.num:-Number(t.substring(n+1,t.length-1)):r.num:i?isNaN(t.substring(0,t.length-1))?r.num:t.substring(0,t.length-1):isNaN(t)?r.num:0},e.IMARGUMENT=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:0===n&&0===o?r.div0:0===n&&o>0?Math.PI/2:0===n&&o<0?-Math.PI/2:0===o&&n>0?0:0===o&&n<0?-Math.PI:n>0?Math.atan(o/n):n<0&&o>=0?Math.atan(o/n)+Math.PI:Math.atan(o/n)-Math.PI},e.IMCONJUGATE=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",0!==o?e.COMPLEX(n,-o,i):t},e.IMCOS=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(n)*(Math.exp(o)+Math.exp(-o))/2,-Math.sin(n)*(Math.exp(o)-Math.exp(-o))/2,i)},e.IMCOSH=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(o)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(o)*(Math.exp(n)-Math.exp(-n))/2,i)},e.IMCOT=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:e.IMDIV(e.IMCOS(t),e.IMSIN(t))},e.IMDIV=function(t,n){var o=e.IMREAL(t),i=e.IMAGINARY(t),s=e.IMREAL(n),l=e.IMAGINARY(n);if(a.anyIsError(o,i,s,l))return r.value;var u=t.substring(t.length-1),c=n.substring(n.length-1),f="i";if("j"===u?f="j":"j"===c&&(f="j"),0===s&&0===l)return r.num;var h=s*s+l*l;return e.COMPLEX((o*s+i*l)/h,(i*s-o*l)/h,f)},e.IMEXP=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);i="i"===i||"j"===i?i:"i";var s=Math.exp(n);return e.COMPLEX(s*Math.cos(o),s*Math.sin(o),i)},e.IMLN=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+o*o)),Math.atan(o/n),i)},e.IMLOG10=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+o*o))/Math.log(10),Math.atan(o/n)/Math.log(10),i)},e.IMLOG2=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(n*n+o*o))/Math.log(2),Math.atan(o/n)/Math.log(2),i)},e.IMPOWER=function(t,n){n=a.parseNumber(n);var o=e.IMREAL(t),i=e.IMAGINARY(t);if(a.anyIsError(n,o,i))return r.value;var s=t.substring(t.length-1);s="i"===s||"j"===s?s:"i";var l=Math.pow(e.IMABS(t),n),u=e.IMARGUMENT(t);return e.COMPLEX(l*Math.cos(n*u),l*Math.sin(n*u),s)},e.IMPRODUCT=function(){var t=arguments[0];if(!arguments.length)return r.value;for(var n=1;n<arguments.length;n++){var o=e.IMREAL(t),i=e.IMAGINARY(t),s=e.IMREAL(arguments[n]),l=e.IMAGINARY(arguments[n]);if(a.anyIsError(o,i,s,l))return r.value;t=e.COMPLEX(o*s-i*l,o*l+i*s)}return t},e.IMREAL=function(t){if(void 0===t||!0===t||!1===t)return r.value;if(0===t||"0"===t)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;var e=t.indexOf("+"),n=t.indexOf("-");0===e&&(e=t.indexOf("+",1)),0===n&&(n=t.indexOf("-",1));var o=t.substring(t.length-1,t.length),i="i"===o||"j"===o;return e>=0||n>=0?i?e>=0?isNaN(t.substring(0,e))||isNaN(t.substring(e+1,t.length-1))?r.num:Number(t.substring(0,e)):isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?r.num:Number(t.substring(0,n)):r.num:i?isNaN(t.substring(0,t.length-1))?r.num:0:isNaN(t)?r.num:t},e.IMSEC=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:e.IMDIV("1",e.IMCOS(t))},e.IMSECH=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:e.IMDIV("1",e.IMCOSH(t))},e.IMSIN=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.sin(n)*(Math.exp(o)+Math.exp(-o))/2,Math.cos(n)*(Math.exp(o)-Math.exp(-o))/2,i)},e.IMSINH=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(o)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(o)*(Math.exp(n)+Math.exp(-n))/2,i)},e.IMSQRT=function(t){var n=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(n,o))return r.value;var i=t.substring(t.length-1);i="i"===i||"j"===i?i:"i";var s=Math.sqrt(e.IMABS(t)),l=e.IMARGUMENT(t);return e.COMPLEX(s*Math.cos(l/2),s*Math.sin(l/2),i)},e.IMCSC=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.num:e.IMDIV("1",e.IMSIN(t))},e.IMCSCH=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.num:e.IMDIV("1",e.IMSINH(t))},e.IMSUB=function(t,e){var n=this.IMREAL(t),o=this.IMAGINARY(t),i=this.IMREAL(e),s=this.IMAGINARY(e);if(a.anyIsError(n,o,i,s))return r.value;var l=t.substring(t.length-1),u=e.substring(e.length-1),c="i";return"j"===l?c="j":"j"===u&&(c="j"),this.COMPLEX(n-i,o-s,c)},e.IMSUM=function(){if(!arguments.length)return r.value;for(var t=a.flatten(arguments),e=t[0],n=1;n<t.length;n++){var o=this.IMREAL(e),i=this.IMAGINARY(e),s=this.IMREAL(t[n]),l=this.IMAGINARY(t[n]);if(a.anyIsError(o,i,s,l))return r.value;e=this.COMPLEX(o+s,i+l)}return e},e.IMTAN=function(t){if(!0===t||!1===t)return r.value;var n=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(n,o)?r.value:this.IMDIV(this.IMSIN(t),this.IMCOS(t))},e.OCT2BIN=function(t,e){if(!/^[0-7]{1,10}$/.test(t))return r.num;var n=10===t.length&&"7"===t.substring(0,1),o=n?parseInt(t,8)-1073741824:parseInt(t,8);if(o<-512||o>511)return r.num;if(n)return"1"+i.REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var a=o.toString(2);return void 0===e?a:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=a.length?i.REPT("0",e-a.length)+a:r.num},e.OCT2DEC=function(t){if(!/^[0-7]{1,10}$/.test(t))return r.num;var e=parseInt(t,8);return e>=536870912?e-1073741824:e},e.OCT2HEX=function(t,e){if(!/^[0-7]{1,10}$/.test(t))return r.num;var n=parseInt(t,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);var o=n.toString(16);return void 0===e?o:isNaN(e)?r.value:e<0?r.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:r.num}},function(t,e,n){"use strict";e.__esModule=!0,e.default=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"]},function(t,e,n){"use strict";function r(t){var e=parseInt(t,10);return e=isNaN(e)?-1:Math.max(e-1,-1)}function o(t){var e="";return t>=0&&(e=""+(t+1)),e}e.__esModule=!0,e.rowLabelToIndex=r,e.rowIndexToLabel=o,e.columnLabelToIndex=a,e.columnIndexToLabel=s,e.extractLabel=function(t){if("string"!=typeof t||!l.test(t))return[];var e=t.toUpperCase().match(l),n=e[1],o=e[2],i=e[3],s=e[4];return[{index:r(s),label:s,isAbsolute:"$"===i},{index:a(o),label:o,isAbsolute:"$"===n}]},e.toLabel=function(t,e){var n=(t.isAbsolute?"$":"")+o(t.index);return(e.isAbsolute?"$":"")+s(e.index)+n};var i="ABCDEFGHIJKLMNOPQRSTUVWXYZ".length;function a(t){var e=0;if("string"==typeof t)for(var n=0,r=(t=t.toUpperCase()).length-1;n<t.length;n+=1,r-=1)e+=Math.pow(i,r)*("ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(t[n])+1);return--e}function s(t){for(var e="";t>=0;)e=String.fromCharCode(t%i+97)+e,t=Math.floor(t/i)-1;return e.toUpperCase()}var l=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/},function(t,e,n){"use strict";e.__esModule=!0,e.rowLabelToIndex=e.rowIndexToLabel=e.columnLabelToIndex=e.columnIndexToLabel=e.toLabel=e.extractLabel=e.error=e.Parser=e.ERROR_VALUE=e.ERROR_REF=e.ERROR_NUM=e.ERROR_NULL=e.ERROR_NOT_AVAILABLE=e.ERROR_NAME=e.ERROR_DIV_ZERO=e.ERROR=e.SUPPORTED_FORMULAS=void 0;var r=l(n(16)),o=l(n(13)),i=n(2),a=l(i),s=n(14);function l(t){return t&&t.__esModule?t:{default:t}}e.SUPPORTED_FORMULAS=o.default,e.ERROR=i.ERROR,e.ERROR_DIV_ZERO=i.ERROR_DIV_ZERO,e.ERROR_NAME=i.ERROR_NAME,e.ERROR_NOT_AVAILABLE=i.ERROR_NOT_AVAILABLE,e.ERROR_NULL=i.ERROR_NULL,e.ERROR_NUM=i.ERROR_NUM,e.ERROR_REF=i.ERROR_REF,e.ERROR_VALUE=i.ERROR_VALUE,e.Parser=r.default,e.error=a.default,e.extractLabel=s.extractLabel,e.toLabel=s.toLabel,e.columnIndexToLabel=s.columnIndexToLabel,e.columnLabelToIndex=s.columnLabelToIndex,e.rowIndexToLabel=s.rowIndexToLabel,e.rowLabelToIndex=s.rowLabelToIndex},function(t,e,n){"use strict";e.__esModule=!0;var r=f(n(17)),o=f(n(18)),i=n(39),a=n(40),s=n(3),l=n(2),u=f(l),c=n(14);function f(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n.parser=new i.Parser,n.parser.yy={toNumber:s.toNumber,trimEdges:a.trimEdges,invertNumber:s.invertNumber,throwError:function(t){return n._throwError(t)},callVariable:function(t){return n._callVariable(t)},evaluateByOperator:o.default,callFunction:function(t,e){return n._callFunction(t,e)},cellValue:function(t){return n._callCellValue(t)},rangeValue:function(t,e){return n._callRangeValue(t,e)}},n.variables=Object.create(null),n.functions=Object.create(null),n.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.parse=function(t){var e=null,n=null;try{e=""===t?"":this.parser.parse(t)}catch(t){var r=(0,u.default)(t.message);n=r||(0,u.default)(l.ERROR)}return e instanceof Error&&(n=(0,u.default)(e.message)||(0,u.default)(l.ERROR),e=null),{error:n,result:e}},e.prototype.setVariable=function(t,e){return this.variables[t]=e,this},e.prototype.getVariable=function(t){return this.variables[t]},e.prototype._callVariable=function(t){var e=this.getVariable(t);if(this.emit("callVariable",t,(function(t){void 0!==t&&(e=t)})),void 0===e)throw Error(l.ERROR_NAME);return e},e.prototype.setFunction=function(t,e){return this.functions[t]=e,this},e.prototype.getFunction=function(t){return this.functions[t]},e.prototype._callFunction=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.getFunction(t),r=void 0;return n&&(r=n(e)),this.emit("callFunction",t,e,(function(t){void 0!==t&&(r=t)})),void 0===r?(0,o.default)(t,e):r},e.prototype._callCellValue=function(t){t=t.toUpperCase();var e=(0,c.extractLabel)(t),n=e[0],r=e[1],o=void 0;return this.emit("callCellValue",{label:t,row:n,column:r},(function(t){o=t})),o},e.prototype._callRangeValue=function(t,e){t=t.toUpperCase(),e=e.toUpperCase();var n=(0,c.extractLabel)(t),r=n[0],o=n[1],i=(0,c.extractLabel)(e),a=i[0],s=i[1],l={},u={};r.index<=a.index?(l.row=r,u.row=a):(l.row=a,u.row=r),o.index<=s.index?(l.column=o,u.column=s):(l.column=s,u.column=o),l.label=(0,c.toLabel)(l.row,l.column),u.label=(0,c.toLabel)(u.row,u.column);var f=[];return this.emit("callRangeValue",l,u,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];f=t})),f},e.prototype._throwError=function(t){if((0,l.isValidStrict)(t))throw Error(t);throw Error(l.ERROR)},e}(r.default);e.default=h},function(t,e){function n(){}n.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var r=this;function o(){r.off(t,o),e.apply(n,arguments)}return o._=e,this.on(t,o,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],o=[];if(r&&e)for(var i=0,a=r.length;i<a;i++)r[i].fn!==e&&r[i].fn._!==e&&o.push(r[i]);return o.length?n[t]=o:delete n[t],this}},t.exports=n,t.exports.TinyEmitter=n},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t=t.toUpperCase(),!m[t])throw Error(v.ERROR_NAME);return m[t].apply(m,e)},e.registerOperation=b;var r=y(n(19)),o=y(n(20)),i=y(n(21)),a=y(n(22)),s=y(n(23)),l=y(n(31)),u=y(n(32)),c=y(n(33)),f=y(n(34)),h=y(n(35)),d=y(n(36)),p=y(n(37)),g=y(n(38)),v=n(2);function y(t){return t&&t.__esModule?t:{default:t}}var m=Object.create(null);function b(t,e){Array.isArray(t)||(t=[t.toUpperCase()]),t.forEach((function(t){e.isFactory?m[t]=e(t):m[t]=e}))}b(r.default.SYMBOL,r.default),b(o.default.SYMBOL,o.default),b(i.default.SYMBOL,i.default),b(a.default.SYMBOL,a.default),b(g.default.SYMBOL,g.default),b(s.default.SYMBOL,s.default),b(l.default.SYMBOL,l.default),b(u.default.SYMBOL,u.default),b(c.default.SYMBOL,c.default),b(f.default.SYMBOL,f.default),b(d.default.SYMBOL,d.default),b(p.default.SYMBOL,p.default),b(h.default.SYMBOL,h.default)},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=a;var r=n(3),o=n(2),i=e.SYMBOL="+";function a(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var a=n.reduce((function(t,e){return t+(0,r.toNumber)(e)}),(0,r.toNumber)(t));if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL="&";function o(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce((function(t,e){return t+e.toString()}),"")}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=a;var r=n(3),o=n(2),i=e.SYMBOL="/";function a(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var a=n.reduce((function(t,e){return t/(0,r.toNumber)(e)}),(0,r.toNumber)(t));if(a===1/0)throw Error(o.ERROR_DIV_ZERO);if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL="=";function o(t,e){return t===e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=u;var r,o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(24)),i=n(13),a=(r=i)&&r.__esModule?r:{default:r},s=n(2),l=e.SYMBOL=a.default;function u(t){return function(){var e=(t=t.toUpperCase()).split("."),n=!1,r=void 0;if(1===e.length)o[e[0]]&&(n=!0,r=o[e[0]].apply(o,arguments));else{for(var i=e.length,a=0,l=o;a<i;)if(l=l[e[a]],a++,!l){l=null;break}l&&(n=!0,r=l.apply(void 0,arguments))}if(!n)throw Error(s.ERROR_NAME);return r}}u.isFactory=!0,u.SYMBOL=l},function(t,e,n){var r=[n(25),n(27),n(12),n(28),n(4),n(6),n(9),n(29),n(8),n(30),n(5),n(11)];for(var o in r){var i=r[o];for(var a in i)e[a]=e[a]||i[a]}},function(t,e,n){var r=n(4),o=n(5),i=n(12),a=n(9);function s(t,e){if(e)for(var n in e)t[n]=e[n];return t}e.BETADIST=o.BETA.DIST,e.BETAINV=o.BETA.INV,e.BINOMDIST=o.BINOM.DIST,e.CEILING=e.ISOCEILING=s(r.CEILING.MATH,r.CEILING),e.CEILINGMATH=r.CEILING.MATH,e.CEILINGPRECISE=r.CEILING.PRECISE,e.CHIDIST=o.CHISQ.DIST,e.CHIDISTRT=o.CHISQ.DIST.RT,e.CHIINV=o.CHISQ.INV,e.CHIINVRT=o.CHISQ.INV.RT,e.CHITEST=o.CHISQ.TEST,e.CONFIDENCE=s(o.CONFIDENCE.NORM,o.CONFIDENCE),e.COVAR=o.COVARIANCE.P,e.COVARIANCEP=o.COVARIANCE.P,e.COVARIANCES=o.COVARIANCE.S,e.CRITBINOM=o.BINOM.INV,e.EXPONDIST=o.EXPON.DIST,e.ERFCPRECISE=i.ERFC.PRECISE,e.ERFPRECISE=i.ERF.PRECISE,e.FDIST=o.F.DIST,e.FDISTRT=o.F.DIST.RT,e.FINVRT=o.F.INV.RT,e.FINV=o.F.INV,e.FLOOR=s(r.FLOOR.MATH,r.FLOOR),e.FLOORMATH=r.FLOOR.MATH,e.FLOORPRECISE=r.FLOOR.PRECISE,e.FTEST=o.F.TEST,e.GAMMADIST=o.GAMMA.DIST,e.GAMMAINV=o.GAMMA.INV,e.GAMMALNPRECISE=o.GAMMALN.PRECISE,e.HYPGEOMDIST=o.HYPGEOM.DIST,e.LOGINV=o.LOGNORM.INV,e.LOGNORMINV=o.LOGNORM.INV,e.LOGNORMDIST=o.LOGNORM.DIST,e.MODE=s(o.MODE.SNGL,o.MODE),e.MODEMULT=o.MODE.MULT,e.MODESNGL=o.MODE.SNGL,e.NEGBINOMDIST=o.NEGBINOM.DIST,e.NETWORKDAYSINTL=a.NETWORKDAYS.INTL,e.NORMDIST=o.NORM.DIST,e.NORMINV=o.NORM.INV,e.NORMSDIST=o.NORM.S.DIST,e.NORMSINV=o.NORM.S.INV,e.PERCENTILE=s(o.PERCENTILE.EXC,o.PERCENTILE),e.PERCENTILEEXC=o.PERCENTILE.EXC,e.PERCENTILEINC=o.PERCENTILE.INC,e.PERCENTRANK=s(o.PERCENTRANK.INC,o.PERCENTRANK),e.PERCENTRANKEXC=o.PERCENTRANK.EXC,e.PERCENTRANKINC=o.PERCENTRANK.INC,e.POISSON=s(o.POISSON.DIST,o.POISSON),e.POISSONDIST=o.POISSON.DIST,e.QUARTILE=s(o.QUARTILE.INC,o.QUARTILE),e.QUARTILEEXC=o.QUARTILE.EXC,e.QUARTILEINC=o.QUARTILE.INC,e.RANK=s(o.RANK.EQ,o.RANK),e.RANKAVG=o.RANK.AVG,e.RANKEQ=o.RANK.EQ,e.SKEWP=o.SKEW.P,e.STDEV=s(o.STDEV.S,o.STDEV),e.STDEVP=o.STDEV.P,e.STDEVS=o.STDEV.S,e.TDIST=o.T.DIST,e.TDISTRT=o.T.DIST.RT,e.TINV=o.T.INV,e.TTEST=o.T.TEST,e.VAR=s(o.VAR.S,o.VAR),e.VARP=o.VAR.P,e.VARS=o.VAR.S,e.WEIBULL=s(o.WEIBULL.DIST,o.WEIBULL),e.WEIBULLDIST=o.WEIBULL.DIST,e.WORKDAYINTL=a.WORKDAY.INTL,e.ZTEST=o.Z.TEST},function(t,e,n){var r;r=function(t){t.version="1.0.2";var e=Math;function n(t,e){for(var n=0,r=0;n<t.length;++n)r=e*r+t[n];return r}function r(t,e,n,r,o){if(0===e)return n;if(1===e)return r;for(var i=2/t,a=r,s=1;s<e;++s)a=r*s*i+o*n,n=r,r=a;return a}function o(t,e,n,o,i){return function(n,a){if(o){if(0===n)return 1==o?-1/0:1/0;if(n<0)return NaN}return 0===a?t(n):1===a?e(n):a<0?NaN:r(n,a|=0,t(n),e(n),i)}}var i,a,s,l,u,c,f,h,d,p,g,v,y,m=function(){var t=.636619772,o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function l(r){var l=0,u=0,c=0,f=r*r;if(r<8)l=(u=n(o,f))/(c=n(i,f));else{var h=r-.785398164;u=n(a,f=64/f),c=n(s,f),l=e.sqrt(t/r)*(e.cos(h)*u-e.sin(h)*c*8/r)}return l}var u=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),c=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function d(r){var o=0,i=0,a=0,s=r*r,l=e.abs(r)-2.356194491;return Math.abs(r)<8?o=(i=r*n(u,s))/(a=n(c,s)):(i=n(f,s=64/s),a=n(h,s),o=e.sqrt(t/e.abs(r))*(e.cos(l)*i-e.sin(l)*a*8/e.abs(r)),r<0&&(o=-o)),o}return function t(n,o){if(o=Math.round(o),!isFinite(n))return isNaN(n)?n:0;if(o<0)return(o%2?-1:1)*t(n,-o);if(n<0)return(o%2?-1:1)*t(-n,o);if(0===o)return l(n);if(1===o)return d(n);if(0===n)return 0;var i=0;if(n>o)i=r(n,o,l(n),d(n),-1);else{for(var a=!1,s=0,u=0,c=1,f=0,h=2/n,p=2*e.floor((o+e.floor(e.sqrt(40*o)))/2);p>0;p--)f=p*h*c-s,s=c,c=f,e.abs(c)>1e10&&(c*=1e-10,s*=1e-10,i*=1e-10,u*=1e-10),a&&(u+=c),a=!a,p==o&&(i=s);i/=u=2*u-c}return i}}(),b=(i=.636619772,a=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),s=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),u=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),f=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),d=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),o((function(t){var r=0,o=0,c=0,f=t*t,h=t-.785398164;return t<8?r=(o=n(a,f))/(c=n(s,f))+i*m(t,0)*e.log(t):(o=n(l,f=64/f),c=n(u,f),r=e.sqrt(i/t)*(e.sin(h)*o+e.cos(h)*c*8/t)),r}),(function(t){var r=0,o=0,a=0,s=t*t,l=t-2.356194491;return t<8?r=(o=t*n(c,s))/(a=n(f,s))+i*(m(t,1)*e.log(t)-1/t):(o=n(h,s=64/s),a=n(d,s),r=e.sqrt(i/t)*(e.sin(l)*o+e.cos(l)*a*8/t)),r}),0,1,-1)),w=(p=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),g=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),v=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),y=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function t(r,o){if(0===(o=Math.round(o)))return function(t){return t<=3.75?n(p,t*t/14.0625):e.exp(e.abs(t))/e.sqrt(e.abs(t))*n(g,3.75/e.abs(t))}(r);if(1===o)return function(t){return t<3.75?t*n(v,t*t/14.0625):(t<0?-1:1)*e.exp(e.abs(t))/e.sqrt(e.abs(t))*n(y,3.75/e.abs(t))}(r);if(o<0)return NaN;if(0===e.abs(r))return 0;if(r==1/0)return 1/0;var i,a=0,s=2/e.abs(r),l=0,u=1,c=0;for(i=2*e.round((o+e.round(e.sqrt(40*o)))/2);i>0;i--)c=i*s*u+l,l=u,u=c,e.abs(u)>1e10&&(u*=1e-10,l*=1e-10,a*=1e-10),i==o&&(a=l);return a*=t(r,0)/u,r<0&&o%2?-a:a}),O=function(){var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),r=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),a=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return o((function(o){return o<=2?-e.log(o/2)*w(o,0)+n(t,o*o/4):e.exp(-o)/e.sqrt(o)*n(r,2/o)}),(function(t){return t<=2?e.log(t/2)*w(t,1)+1/t*n(i,t*t/4):e.exp(-t)/e.sqrt(t)*n(a,2/t)}),0,2,1)}();t.besselj=m,t.bessely=b,t.besseli=w,t.besselk=O},"undefined"==typeof DO_NOT_EXPORT_BESSEL?r(e):r({})},function(t,e,n){var r=n(0),o=n(5),i=n(4),a=n(1),s=n(7);function l(t){var e=[];return a.arrayEach(t,(function(t){t&&e.push(t)})),e}function u(t,e){for(var n={},r=1;r<t[0].length;++r)n[r]=!0;var o=e[0].length;for(r=1;r<e.length;++r)e[r].length>o&&(o=e[r].length);for(var i=1;i<t.length;++i)for(var a=1;a<t[i].length;++a){for(var l=!1,u=!1,c=0;c<e.length;++c){var f=e[c];if(!(f.length<o)){var h=f[0];if(t[i][0]===h){u=!0;for(var d=1;d<f.length;++d)if(!l)if(void 0===f[d]||"*"===f[d])l=!0;else{var p=s.parse(f[d]+""),g=[s.createToken(t[i][a],s.TOKEN_TYPE_LITERAL)].concat(p);l=s.compute(g)}}}}u&&(n[a]=n[a]&&l)}for(var v=[],y=0;y<t[0].length;++y)n[y]&&v.push(y-1);return v}e.FINDFIELD=function(t,e){var n=null;return a.arrayEach(t,(function(t,r){if(t[0]===e)return n=r,!1})),null==n?r.value:n},e.DAVERAGE=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var i=u(t,o),s=[];if("string"==typeof n){var l=e.FINDFIELD(t,n);s=a.rest(t[l])}else s=a.rest(t[n]);var c=0;return a.arrayEach(i,(function(t){c+=s[t]})),0===i.length?r.div0:c/i.length},e.DCOUNT=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),l=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);l=a.rest(t[c])}else l=a.rest(t[n]);var f=[];return a.arrayEach(s,(function(t){f.push(l[t])})),o.COUNT(f)},e.DCOUNTA=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),l=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);l=a.rest(t[c])}else l=a.rest(t[n]);var f=[];return a.arrayEach(s,(function(t){f.push(l[t])})),o.COUNTA(f)},e.DGET=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var i=u(t,o),s=[];if("string"==typeof n){var l=e.FINDFIELD(t,n);s=a.rest(t[l])}else s=a.rest(t[n]);return 0===i.length?r.value:i.length>1?r.num:s[i[0]]},e.DMAX=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var i=u(t,o),s=[];if("string"==typeof n){var l=e.FINDFIELD(t,n);s=a.rest(t[l])}else s=a.rest(t[n]);var c=s[i[0]];return a.arrayEach(i,(function(t){c<s[t]&&(c=s[t])})),c},e.DMIN=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var i=u(t,o),s=[];if("string"==typeof n){var l=e.FINDFIELD(t,n);s=a.rest(t[l])}else s=a.rest(t[n]);var c=s[i[0]];return a.arrayEach(i,(function(t){c>s[t]&&(c=s[t])})),c},e.DPRODUCT=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var i=u(t,o),s=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);s=a.rest(t[c])}else s=a.rest(t[n]);var f=[];a.arrayEach(i,(function(t){f.push(s[t])})),f=l(f);var h=1;return a.arrayEach(f,(function(t){h*=t})),h},e.DSTDEV=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),c=[];if("string"==typeof n){var f=e.FINDFIELD(t,n);c=a.rest(t[f])}else c=a.rest(t[n]);var h=[];return a.arrayEach(s,(function(t){h.push(c[t])})),h=l(h),o.STDEV.S(h)},e.DSTDEVP=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),c=[];if("string"==typeof n){var f=e.FINDFIELD(t,n);c=a.rest(t[f])}else c=a.rest(t[n]);var h=[];return a.arrayEach(s,(function(t){h.push(c[t])})),h=l(h),o.STDEV.P(h)},e.DSUM=function(t,n,o){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,o),l=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);l=a.rest(t[c])}else l=a.rest(t[n]);var f=[];return a.arrayEach(s,(function(t){f.push(l[t])})),i.SUM(f)},e.DVAR=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),l=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);l=a.rest(t[c])}else l=a.rest(t[n]);var f=[];return a.arrayEach(s,(function(t){f.push(l[t])})),o.VAR.S(f)},e.DVARP=function(t,n,i){if(isNaN(n)&&"string"!=typeof n)return r.value;var s=u(t,i),l=[];if("string"==typeof n){var c=e.FINDFIELD(t,n);l=a.rest(t[c])}else l=a.rest(t[n]);var f=[];return a.arrayEach(s,(function(t){f.push(l[t])})),o.VAR.P(f)}},function(t,e,n){var r=n(0),o=n(1),i=n(8);e.AND=function(){for(var t=o.flatten(arguments),e=!0,n=0;n<t.length;n++)t[n]||(e=!1);return e},e.CHOOSE=function(){if(arguments.length<2)return r.na;var t=arguments[0];return t<1||t>254?r.value:arguments.length<t+1?r.value:arguments[t]},e.FALSE=function(){return!1},e.IF=function(t,e,n){return t?e:n},e.IFERROR=function(t,e){return i.ISERROR(t)?e:t},e.IFNA=function(t,e){return t===r.na?e:t},e.NOT=function(t){return!t},e.OR=function(){for(var t=o.flatten(arguments),e=!1,n=0;n<t.length;n++)t[n]&&(e=!0);return e},e.TRUE=function(){return!0},e.XOR=function(){for(var t=o.flatten(arguments),e=0,n=0;n<t.length;n++)t[n]&&e++;return!!(1&Math.floor(Math.abs(e)))},e.SWITCH=function(){var t;if(arguments.length>0){var e=arguments[0],n=arguments.length-1,o=Math.floor(n/2),i=!1,a=n%2!=0,s=n%2==0?null:arguments[arguments.length-1];if(o)for(var l=0;l<o;l++)if(e===arguments[2*l+1]){t=arguments[2*l+2],i=!0;break}i||(t=a?s:r.na)}else t=r.value;return t}},function(t,e,n){var r=n(0),o=n(9),i=n(1);function a(t){return t&&t.getTime&&!isNaN(t.getTime())}function s(t){return t instanceof Date?t:new Date(t)}e.ACCRINT=function(t,e,n,i,l,u,c){return t=s(t),e=s(e),n=s(n),a(t)&&a(e)&&a(n)?i<=0||l<=0?r.num:-1===[1,2,4].indexOf(u)?r.num:-1===[0,1,2,3,4].indexOf(c)?r.num:n<=t?r.num:(c=c||0,(l=l||0)*i*o.YEARFRAC(t,n,c)):r.value},e.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},e.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},e.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},e.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},e.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},e.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},e.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},e.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},e.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},e.CUMIPMT=function(t,n,o,a,s,l){if(t=i.parseNumber(t),n=i.parseNumber(n),o=i.parseNumber(o),i.anyIsError(t,n,o))return r.value;if(t<=0||n<=0||o<=0)return r.num;if(a<1||s<1||a>s)return r.num;if(0!==l&&1!==l)return r.num;var u=e.PMT(t,n,o,0,l),c=0;1===a&&0===l&&(c=-o,a++);for(var f=a;f<=s;f++)c+=1===l?e.FV(t,f-2,u,o,1)-u:e.FV(t,f-1,u,o,0);return c*=t},e.CUMPRINC=function(t,n,o,a,s,l){if(t=i.parseNumber(t),n=i.parseNumber(n),o=i.parseNumber(o),i.anyIsError(t,n,o))return r.value;if(t<=0||n<=0||o<=0)return r.num;if(a<1||s<1||a>s)return r.num;if(0!==l&&1!==l)return r.num;var u=e.PMT(t,n,o,0,l),c=0;1===a&&(c=0===l?u+o*t:u,a++);for(var f=a;f<=s;f++)c+=l>0?u-(e.FV(t,f-2,u,o,1)-u)*t:u-e.FV(t,f-1,u,o,0)*t;return c},e.DB=function(t,e,n,o,a){if(a=void 0===a?12:a,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a))return r.value;if(t<0||e<0||n<0||o<0)return r.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(a))return r.num;if(o>n)return r.num;if(e>=t)return 0;for(var s=(1-Math.pow(e/t,1/n)).toFixed(3),l=t*s*a/12,u=l,c=0,f=o===n?n-1:o,h=2;h<=f;h++)u+=c=(t-u)*s;return 1===o?l:o===n?(t-u)*s:c},e.DDB=function(t,e,n,o,a){if(a=void 0===a?2:a,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a))return r.value;if(t<0||e<0||n<0||o<0||a<=0)return r.num;if(o>n)return r.num;if(e>=t)return 0;for(var s=0,l=0,u=1;u<=o;u++)s+=l=Math.min(a/n*(t-s),t-e-s);return l},e.DISC=function(){throw new Error("DISC is not implemented")},e.DOLLARDE=function(t,e){if(t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e))return r.value;if(e<0)return r.num;if(e>=0&&e<1)return r.div0;e=parseInt(e,10);var n=parseInt(t,10);n+=t%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;var o=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return n=Math.round(n*o)/o},e.DOLLARFR=function(t,e){if(t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e))return r.value;if(e<0)return r.num;if(e>=0&&e<1)return r.div0;e=parseInt(e,10);var n=parseInt(t,10);return n+=t%1*Math.pow(10,-Math.ceil(Math.log(e)/Math.LN10))*e},e.DURATION=function(){throw new Error("DURATION is not implemented")},e.EFFECT=function(t,e){return t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e)?r.value:t<=0||e<1?r.num:(e=parseInt(e,10),Math.pow(1+t/e,e)-1)},e.FV=function(t,e,n,o,a){if(o=o||0,a=a||0,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a))return r.value;var s;if(0===t)s=o+n*e;else{var l=Math.pow(1+t,e);s=1===a?o*l+n*(1+t)*(l-1)/t:o*l+n*(l-1)/t}return-s},e.FVSCHEDULE=function(t,e){if(t=i.parseNumber(t),e=i.parseNumberArray(i.flatten(e)),i.anyIsError(t,e))return r.value;for(var n=e.length,o=t,a=0;a<n;a++)o*=1+e[a];return o},e.INTRATE=function(){throw new Error("INTRATE is not implemented")},e.IPMT=function(t,n,o,a,s,l){if(s=s||0,l=l||0,t=i.parseNumber(t),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),s=i.parseNumber(s),l=i.parseNumber(l),i.anyIsError(t,n,o,a,s,l))return r.value;var u=e.PMT(t,o,a,s,l);return(1===n?1===l?0:-a:1===l?e.FV(t,n-2,u,a,1)-u:e.FV(t,n-1,u,a,0))*t},e.IRR=function(t,e){if(e=e||0,t=i.parseNumberArray(i.flatten(t)),e=i.parseNumber(e),i.anyIsError(t,e))return r.value;for(var n=function(t,e,n){for(var r=n+1,o=t[0],i=1;i<t.length;i++)o+=t[i]/Math.pow(r,(e[i]-e[0])/365);return o},o=function(t,e,n){for(var r=n+1,o=0,i=1;i<t.length;i++){var a=(e[i]-e[0])/365;o-=a*t[i]/Math.pow(r,a+1)}return o},a=[],s=!1,l=!1,u=0;u<t.length;u++)a[u]=0===u?0:a[u-1]+365,t[u]>0&&(s=!0),t[u]<0&&(l=!0);if(!s||!l)return r.num;var c,f,h,d=e=void 0===e?.1:e,p=!0;do{c=d-(h=n(t,a,d))/o(t,a,d),f=Math.abs(c-d),d=c,p=f>1e-10&&Math.abs(h)>1e-10}while(p);return d},e.ISPMT=function(t,e,n,o){return t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),i.anyIsError(t,e,n,o)?r.value:o*t*(e/n-1)},e.MDURATION=function(){throw new Error("MDURATION is not implemented")},e.MIRR=function(t,n,o){if(t=i.parseNumberArray(i.flatten(t)),n=i.parseNumber(n),o=i.parseNumber(o),i.anyIsError(t,n,o))return r.value;for(var a=t.length,s=[],l=[],u=0;u<a;u++)t[u]<0?s.push(t[u]):l.push(t[u]);var c=-e.NPV(o,l)*Math.pow(1+o,a-1),f=e.NPV(n,s)*(1+n);return Math.pow(c/f,1/(a-1))-1},e.NOMINAL=function(t,e){return t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e)?r.value:t<=0||e<1?r.num:(e=parseInt(e,10),(Math.pow(t+1,1/e)-1)*e)},e.NPER=function(t,e,n,o,a){if(a=void 0===a?0:a,o=void 0===o?0:o,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a))return r.value;var s=e*(1+t*a)-o*t,l=n*t+e*(1+t*a);return Math.log(s/l)/Math.log(1+t)},e.NPV=function(){var t=i.parseNumberArray(i.flatten(arguments));if(t instanceof Error)return t;for(var e=t[0],n=0,r=1;r<t.length;r++)n+=t[r]/Math.pow(1+e,r);return n},e.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},e.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},e.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},e.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},e.PDURATION=function(t,e,n){return t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:t<=0?r.num:(Math.log(n)-Math.log(e))/Math.log(1+t)},e.PMT=function(t,e,n,o,a){if(o=o||0,a=a||0,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a))return r.value;var s;if(0===t)s=(n+o)/e;else{var l=Math.pow(1+t,e);s=1===a?(o*t/(l-1)+n*t/(1-1/l))/(1+t):o*t/(l-1)+n*t/(1-1/l)}return-s},e.PPMT=function(t,n,o,a,s,l){return s=s||0,l=l||0,t=i.parseNumber(t),o=i.parseNumber(o),a=i.parseNumber(a),s=i.parseNumber(s),l=i.parseNumber(l),i.anyIsError(t,o,a,s,l)?r.value:e.PMT(t,o,a,s,l)-e.IPMT(t,n,o,a,s,l)},e.PRICE=function(){throw new Error("PRICE is not implemented")},e.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},e.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},e.PV=function(t,e,n,o,a){return o=o||0,a=a||0,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,n,o,a)?r.value:0===t?-n*e-o:((1-Math.pow(1+t,e))/t*n*(1+t*a)-o)/Math.pow(1+t,e)},e.RATE=function(t,e,n,o,a,s){if(s=void 0===s?.01:s,o=void 0===o?0:o,a=void 0===a?0:a,t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),a=i.parseNumber(a),s=i.parseNumber(s),i.anyIsError(t,e,n,o,a,s))return r.value;var l,u,c,f=0,h=0,d=0,p=s;for(Math.abs(p)<1e-10||(h=Math.exp(t*Math.log(1+p))),l=n+e*t+o,u=n*h+e*(1/p+a)*(h-1)+o,d=c=0,f=p;Math.abs(l-u)>1e-10&&d<50;)p=(u*c-l*f)/(u-l),c=f,f=p,l=u,u=Math.abs(p)<1e-10?n*(1+t*p)+e*(1+p*a)*t+o:n*(h=Math.exp(t*Math.log(1+p)))+e*(1/p+a)*(h-1)+o,++d;return p},e.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},e.RRI=function(t,e,n){return t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:0===t||0===e?r.num:Math.pow(n/e,1/t)-1},e.SLN=function(t,e,n){return t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:0===n?r.num:(t-e)/n},e.SYD=function(t,e,n,o){return t=i.parseNumber(t),e=i.parseNumber(e),n=i.parseNumber(n),o=i.parseNumber(o),i.anyIsError(t,e,n,o)?r.value:0===n?r.num:o<1||o>n?r.num:(t-e)*(n-(o=parseInt(o,10))+1)*2/(n*(n+1))},e.TBILLEQ=function(t,e,n){return t=i.parseDate(t),e=i.parseDate(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:n<=0?r.num:t>e?r.num:e-t>31536e6?r.num:365*n/(360-n*o.DAYS360(t,e,!1))},e.TBILLPRICE=function(t,e,n){return t=i.parseDate(t),e=i.parseDate(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:n<=0?r.num:t>e?r.num:e-t>31536e6?r.num:100*(1-n*o.DAYS360(t,e,!1)/360)},e.TBILLYIELD=function(t,e,n){return t=i.parseDate(t),e=i.parseDate(e),n=i.parseNumber(n),i.anyIsError(t,e,n)?r.value:n<=0?r.num:t>e?r.num:e-t>31536e6?r.num:360*(100-n)/(n*o.DAYS360(t,e,!1))},e.VDB=function(){throw new Error("VDB is not implemented")},e.XNPV=function(t,e,n){if(t=i.parseNumber(t),e=i.parseNumberArray(i.flatten(e)),n=i.parseDateArray(i.flatten(n)),i.anyIsError(t,e,n))return r.value;for(var a=0,s=0;s<e.length;s++)a+=e[s]/Math.pow(1+t,o.DAYS(n[s],n[0])/365);return a},e.YIELD=function(){throw new Error("YIELD is not implemented")},e.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},e.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(t,e,n){var r=n(0),o=n(1);e.MATCH=function(t,e,n){if(!t&&!e)return r.na;if(2===arguments.length&&(n=1),!(e instanceof Array))return r.na;if(-1!==n&&0!==n&&1!==n)return r.na;for(var o,i,a=0;a<e.length;a++)if(1===n){if(e[a]===t)return a+1;e[a]<t&&(i?e[a]>i&&(o=a+1,i=e[a]):(o=a+1,i=e[a]))}else if(0===n){if("string"==typeof t){if(t=t.replace(/\?/g,"."),e[a].toLowerCase().match(t.toLowerCase()))return a+1}else if(e[a]===t)return a+1}else if(-1===n){if(e[a]===t)return a+1;e[a]>t&&(i?e[a]<i&&(o=a+1,i=e[a]):(o=a+1,i=e[a]))}return o||r.na},e.VLOOKUP=function(t,e,n,o){if(!t||!e||!n)return r.na;o=o||!1;for(var i=0;i<e.length;i++){var a=e[i];if(!o&&a[0]===t||a[0]===t||o&&"string"==typeof a[0]&&-1!==a[0].toLowerCase().indexOf(t.toLowerCase()))return n<a.length+1?a[n-1]:r.ref}return r.na},e.HLOOKUP=function(t,e,n,i){if(!t||!e||!n)return r.na;i=i||!1;for(var a=o.transpose(e),s=0;s<a.length;s++){var l=a[s];if(!i&&l[0]===t||l[0]===t||i&&"string"==typeof l[0]&&-1!==l[0].toLowerCase().indexOf(t.toLowerCase()))return n<l.length+1?l[n-1]:r.ref}return r.na}},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL=">";function o(t,e){return t>e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL=">=";function o(t,e){return t>=e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL="<";function o(t,e){return t<e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL="<=";function o(t,e){return t<=e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=a;var r=n(3),o=n(2),i=e.SYMBOL="-";function a(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var a=n.reduce((function(t,e){return t-(0,r.toNumber)(e)}),(0,r.toNumber)(t));if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=a;var r=n(3),o=n(2),i=e.SYMBOL="*";function a(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var a=n.reduce((function(t,e){return t*(0,r.toNumber)(e)}),(0,r.toNumber)(t));if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(t,e,n){"use strict";e.__esModule=!0,e.default=o;var r=e.SYMBOL="<>";function o(t,e){return t!==e}o.SYMBOL=r},function(t,e,n){"use strict";e.__esModule=!0,e.SYMBOL=void 0,e.default=a;var r=n(3),o=n(2),i=e.SYMBOL="^";function a(t,e){var n=Math.pow((0,r.toNumber)(t),(0,r.toNumber)(e));if(isNaN(n))throw Error(o.ERROR_VALUE);return n}a.SYMBOL=i},function(t,e,n){var r=function(){var t=function(t,e,n,r){for(n=n||{},r=t.length;r--;n[t[r]]=e);return n},e=[1,5],n=[1,8],r=[1,6],o=[1,7],i=[1,9],a=[1,14],s=[1,15],l=[1,16],u=[1,12],c=[1,13],f=[1,17],h=[1,19],d=[1,20],p=[1,21],g=[1,22],v=[1,23],y=[1,24],m=[1,25],b=[1,26],w=[1,27],O=[1,28],C=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],E=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],S=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],k=[5,10,11,13,14,15,16,17,29,30],R=[5,10,13,14,15,16,29,30],_=[5,10,11,13,14,15,16,17,18,19,29,30],T=[13,29,30],M={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function(t,e,n,r,o,i,a){var s=i.length-1;switch(o){case 1:return i[s-1];case 2:this.$=r.callVariable(i[s][0]);break;case 3:this.$=r.toNumber(i[s]);break;case 4:this.$=r.trimEdges(i[s]);break;case 5:this.$=r.evaluateByOperator("&",[i[s-2],i[s]]);break;case 6:this.$=r.evaluateByOperator("=",[i[s-2],i[s]]);break;case 7:this.$=r.evaluateByOperator("+",[i[s-2],i[s]]);break;case 8:this.$=i[s-1];break;case 9:this.$=r.evaluateByOperator("<=",[i[s-3],i[s]]);break;case 10:this.$=r.evaluateByOperator(">=",[i[s-3],i[s]]);break;case 11:this.$=r.evaluateByOperator("<>",[i[s-3],i[s]]);break;case 12:this.$=r.evaluateByOperator("NOT",[i[s-2],i[s]]);break;case 13:this.$=r.evaluateByOperator(">",[i[s-2],i[s]]);break;case 14:this.$=r.evaluateByOperator("<",[i[s-2],i[s]]);break;case 15:this.$=r.evaluateByOperator("-",[i[s-2],i[s]]);break;case 16:this.$=r.evaluateByOperator("*",[i[s-2],i[s]]);break;case 17:this.$=r.evaluateByOperator("/",[i[s-2],i[s]]);break;case 18:this.$=r.evaluateByOperator("^",[i[s-2],i[s]]);break;case 19:var l=r.invertNumber(i[s]);this.$=l,isNaN(this.$)&&(this.$=0);break;case 20:l=r.toNumber(i[s]),this.$=l,isNaN(this.$)&&(this.$=0);break;case 21:this.$=r.callFunction(i[s-2]);break;case 22:this.$=r.callFunction(i[s-3],i[s-1]);break;case 26:case 27:case 28:this.$=r.cellValue(i[s]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=r.rangeValue(i[s-2],i[s]);break;case 38:case 42:this.$=[i[s]];break;case 39:this.$=r.trimEdges(t).split(",");break;case 40:case 41:i[s-2].push(i[s]),this.$=i[s-2];break;case 43:this.$=Array.isArray(i[s-2])?i[s-2]:[i[s-2]],this.$.push(i[s]);break;case 44:this.$=i[s];break;case 45:this.$=1*(i[s-2]+"."+i[s]);break;case 46:this.$=.01*i[s-1];break;case 47:this.$=r.throwError(i[s])}},table:[{2:11,3:1,4:2,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{1:[3]},{5:[1,18],9:h,10:d,11:p,14:g,15:v,16:y,17:m,18:b,19:w,20:O},t(C,[2,2],{32:[1,29]}),t(C,[2,3],{34:[1,30]}),t(C,[2,4]),{2:11,4:31,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:32,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:33,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{12:[1,34]},t(C,[2,23]),t(C,[2,24],{2:35,35:f}),t(E,[2,42]),t(S,[2,44],{32:[1,36]}),t(C,[2,26],{27:[1,37]}),t(C,[2,27],{27:[1,38]}),t(C,[2,28],{27:[1,39]}),t([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:41,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:42,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:45,6:3,7:4,8:e,10:[1,43],11:n,12:r,15:[1,44],17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:47,6:3,7:4,8:e,10:[1,46],11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:48,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:49,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:50,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:51,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:52,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{31:[1,53]},t(S,[2,46]),{9:h,10:d,11:p,13:[1,54],14:g,15:v,16:y,17:m,18:b,19:w,20:O},t(k,[2,19],{9:h,18:b,19:w,20:O}),t(k,[2,20],{9:h,18:b,19:w,20:O}),{2:11,4:57,6:3,7:4,8:e,11:n,12:r,13:[1,55],17:o,21:i,22:56,23:10,24:a,25:s,26:l,28:[1,58],31:u,33:c,35:f},t(C,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},t(C,[2,5]),t([5,10,13,29,30],[2,6],{9:h,11:p,14:g,15:v,16:y,17:m,18:b,19:w,20:O}),t(k,[2,7],{9:h,18:b,19:w,20:O}),{2:11,4:69,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:70,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},t(R,[2,14],{9:h,11:p,17:m,18:b,19:w,20:O}),{2:11,4:71,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},t(R,[2,13],{9:h,11:p,17:m,18:b,19:w,20:O}),t([5,10,13,16,29,30],[2,12],{9:h,11:p,14:g,15:v,17:m,18:b,19:w,20:O}),t(k,[2,15],{9:h,18:b,19:w,20:O}),t(_,[2,16],{9:h,20:O}),t(_,[2,17],{9:h,20:O}),t([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:h}),t(E,[2,43]),t(C,[2,8]),t(C,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},t(T,[2,38],{9:h,10:d,11:p,14:g,15:v,16:y,17:m,18:b,19:w,20:O}),t(T,[2,39]),t(S,[2,45]),t(C,[2,29]),t(C,[2,30]),t(C,[2,31]),t(C,[2,32]),t(C,[2,33]),t(C,[2,34]),t(C,[2,35]),t(C,[2,36]),t(C,[2,37]),t(R,[2,9],{9:h,11:p,17:m,18:b,19:w,20:O}),t(R,[2,11],{9:h,11:p,17:m,18:b,19:w,20:O}),t(R,[2,10],{9:h,11:p,17:m,18:b,19:w,20:O}),t(C,[2,22]),{2:11,4:75,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:76,6:3,7:4,8:e,11:n,12:r,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},t(T,[2,40],{9:h,10:d,11:p,14:g,15:v,16:y,17:m,18:b,19:w,20:O}),t(T,[2,41],{9:h,10:d,11:p,14:g,15:v,16:y,17:m,18:b,19:w,20:O})],defaultActions:{18:[2,1]},parseError:function(t,e){if(!e.recoverable){var n=new Error(t);throw n.hash=e,n}this.trace(t)},parse:function(t){var e=this,n=[0],r=[null],o=[],i=this.table,a="",s=0,l=0,u=0,c=2,f=1,h=o.slice.call(arguments,1),d=Object.create(this.lexer),p={yy:{}};for(var g in this.yy)Object.prototype.hasOwnProperty.call(this.yy,g)&&(p.yy[g]=this.yy[g]);d.setInput(t,p.yy),p.yy.lexer=d,p.yy.parser=this,void 0===d.yylloc&&(d.yylloc={});var v=d.yylloc;o.push(v);var y=d.options&&d.options.ranges;function m(t){n.length=n.length-2*t,r.length=r.length-t,o.length=o.length-t}"function"==typeof p.yy.parseError?this.parseError=p.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var b,w,O,C,E,S,k,R,_,T=function(){var t;return"number"!=typeof(t=d.lex()||f)&&(t=e.symbols_[t]||t),t},M={};;){if(O=n[n.length-1],this.defaultActions[O]?C=this.defaultActions[O]:(null==b&&(b=T()),C=i[O]&&i[O][b]),void 0===C||!C.length||!C[0]){var A,N="";function j(t){for(var e=n.length-1,r=0;;){if(c.toString()in i[t])return r;if(0===t||e<2)return!1;t=n[e-=2],++r}}if(u)w!==f&&(A=j(O));else{for(S in A=j(O),_=[],i[O])this.terminals_[S]&&S>c&&_.push("'"+this.terminals_[S]+"'");N=d.showPosition?"Parse error on line "+(s+1)+":\n"+d.showPosition()+"\nExpecting "+_.join(", ")+", got '"+(this.terminals_[b]||b)+"'":"Parse error on line "+(s+1)+": Unexpected "+(b==f?"end of input":"'"+(this.terminals_[b]||b)+"'"),this.parseError(N,{text:d.match,token:this.terminals_[b]||b,line:d.yylineno,loc:v,expected:_,recoverable:!1!==A})}if(3==u){if(b===f||w===f)throw new Error(N||"Parsing halted while starting to recover from another error.");l=d.yyleng,a=d.yytext,s=d.yylineno,v=d.yylloc,b=T()}if(!1===A)throw new Error(N||"Parsing halted. No suitable error recovery rule available.");m(A),w=b==c?null:b,b=c,O=n[n.length-1],C=i[O]&&i[O][c],u=3}if(C[0]instanceof Array&&C.length>1)throw new Error("Parse Error: multiple actions possible at state: "+O+", token: "+b);switch(C[0]){case 1:n.push(b),r.push(d.yytext),o.push(d.yylloc),n.push(C[1]),b=null,w?(b=w,w=null):(l=d.yyleng,a=d.yytext,s=d.yylineno,v=d.yylloc,u>0&&u--);break;case 2:if(k=this.productions_[C[1]][1],M.$=r[r.length-k],M._$={first_line:o[o.length-(k||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(k||1)].first_column,last_column:o[o.length-1].last_column},y&&(M._$.range=[o[o.length-(k||1)].range[0],o[o.length-1].range[1]]),void 0!==(E=this.performAction.apply(M,[a,l,s,p.yy,C[1],r,o].concat(h))))return E;k&&(n=n.slice(0,-1*k*2),r=r.slice(0,-1*k),o=o.slice(0,-1*k)),n.push(this.productions_[C[1]][0]),r.push(M.$),o.push(M._$),R=i[n[n.length-2]][n[n.length-1]],n.push(R);break;case 3:return!0}}return!0}},A={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,r,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(o.yylloc.range=this.yylloc.range.slice(0))),(r=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var i in o)this[i]=o[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),i=0;i<o.length;i++)if((n=this._input.match(this.rules[o[i]]))&&(!e||n[0].length>e[0].length)){if(e=n,r=i,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,o[i])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,o[r]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n,r){switch(n){case 0:break;case 1:case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:case 7:return 26;case 8:return 25;case 9:return 21;case 10:case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}};function N(){this.yy={}}return M.lexer=A,N.prototype=M,M.Parser=N,new N}();e.parser=r,e.Parser=r.Parser,e.parse=function(){return r.parse.apply(r,arguments)}},function(t,e,n){"use strict";e.__esModule=!0,e.trimEdges=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t=t.substring(e,t.length-e)}}])},t.exports=r()},function(t,e,n){"use strict";var r=n(26),o=n(177),i=n(65);r({target:"String",proto:!0,forced:!n(178)("includes")},{includes:function(t){return!!~String(i(this)).indexOf(o(t),arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return p})),n.d(e,"e",(function(){return g})),n.d(e,"f",(function(){return v})),n.d(e,"g",(function(){return y})),n.d(e,"d",(function(){return m}));n(10),n(11),n(12),n(30),n(43),n(7),n(109),n(85),n(5),n(15),n(94),n(54),n(8),n(9);var r=n(6),o=n(1),i=n(13);function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var l=0,u=1,c=[3,2],f=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],h=Symbol("root"),d=Symbol("child");function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;if(e!==h&&e!==d)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(t),o=e===h,i=l;if(n){var a=t[0];if(0===t.length)i=u;else if(o&&a instanceof r.b)i=3;else if(o&&Array.isArray(a))i=p(a,d);else if(t.length>=2&&t.length<=4){var c=!t.some((function(t,e){return!f[e].includes(s(t))}));c&&(i=2)}}return i}function g(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.keepDirection,r=void 0!==n&&n,o=e.propToCol;if(!c.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(e){var n=3===t,a=n?e.from.row:e[0],s=n?e.from.col:e[1],l=n?e.to.row:e[2],u=n?e.to.col:e[3];if("function"==typeof o&&("string"==typeof s&&(s=o(s)),"string"==typeof u&&(u=o(u))),Object(i.isUndefined)(l)&&(l=a),Object(i.isUndefined)(u)&&(u=s),!r){var c=a,f=s,h=l,d=u;a=Math.min(c,h),s=Math.min(f,d),l=Math.max(c,h),u=Math.max(f,d)}return[a,s,l,u]}}function v(t){var e=p(t);if(e===l||e===u)return[];var n=g(e),r=new Set;Object(o.arrayEach)(t,(function(t){var e=a(n(t),4),i=e[1],s=e[3]-i+1;Object(o.arrayEach)(Array.from(new Array(s),(function(t,e){return i+e})),(function(t){r.has(t)||r.add(t)}))}));var i=Array.from(r).sort((function(t,e){return t-e}));return Object(o.arrayReduce)(i,(function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t}),[])}function y(t){var e=p(t);if(e===l||e===u)return[];var n=g(e),r=new Set;Object(o.arrayEach)(t,(function(t){var e=a(n(t),3),i=e[0],s=e[2]-i+1;Object(o.arrayEach)(Array.from(new Array(s),(function(t,e){return i+e})),(function(t){r.has(t)||r.add(t)}))}));var i=Array.from(r).sort((function(t,e){return t-e}));return Object(o.arrayReduce)(i,(function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t}),[])}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof t&&t>=0&&t<e}},function(t,e,n){"use strict";var r=n(61);function o(t,e){var n=t;return function(t){for(var r=!1,o=0,i=t.length;o<i;o++)if(n===t[o]){r=!0;break}e(r)}}n(33),n(214);var i=n(28),a=n.n(i),s=n(153),l=n(35);var u=n(4);var c=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return g}));var f=Object(r.a)("validators"),h=f.register,d=f.getItem,p=f.hasItem,g=f.getNames;f.getValues;function v(t){if("function"==typeof t)return t;if(!p(t))throw Error('No registered validator found under "'.concat(t,'" name'));return d(t)}h("autocomplete",(function(t,e){var n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,o(n,e)):o(n,e)(this.source):e(!0)})),h("date",(function(t,e){var n=Object(l.b)("date",this.instance),r=t,o=!0;null==r&&(r="");var i=a()(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),u=a()(new Date(r)).isValid()||i;if(this.allowEmpty&&""===r&&(u=!0,i=!0),u||(o=!1),!u&&i&&(o=!0),u&&!i)if(!0===this.correctFormat){var c=function(t,e){var n,r=a()(Object(s.getNormalizedDate)(t)),o=a()(t,e),i=t.search(/[A-z]/g)>-1;n=r.isValid()&&r.format("x")===o.format("x")||!o.isValid()||i?r:o;return n.format(e)}(r,this.dateFormat),f=this.instance.runHooks("unmodifyRow",this.row),h=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(f,h,c,"dateValidator"),o=!0}else o=!1;e(o)})),h("numeric",(function(t,e){var n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):e(""!==n&&Object(u.isNumeric)(t))})),h("time",(function(t,e){var n=this.timeFormat||"h:mm:ss a",r=!0,o=t;null===o&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var s=a()(o,c,!0).isValid()?a()(o):a()(o,n),l=s.isValid(),u=a()(o,n,!0).isValid()&&!i;if(this.allowEmpty&&""===o&&(l=!0,u=!0),l||(r=!1),!l&&u&&(r=!0),l&&!u)if(!0===this.correctFormat){var f=s.format(n),h=this.instance.runHooks("unmodifyRow",this.row),d=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(h,d,f,"timeValidator"),r=!0}else r=!1;e(r)}))},function(t,e,n){var r=n(52);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,n){"use strict";var r=n(145),o=n(57),i=n(67),a=n(62),s=n(90),l=n(65),u=n(176),c=n(146),f=Math.max,h=Math.min,d=Math.floor,p=/\$([$&'`]|\d\d?|<[^>]*>)/g,g=/\$([$&'`]|\d\d?)/g;r("replace",2,(function(t,e,n,r){var v=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,y=r.REPLACE_KEEPS_$0,m=v?"$":"$0";return[function(n,r){var o=l(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,o,r):e.call(String(o),n,r)},function(t,r){if(!v&&y||"string"==typeof r&&-1===r.indexOf(m)){var i=n(e,t,this,r);if(i.done)return i.value}var l=o(t),d=String(this),p="function"==typeof r;p||(r=String(r));var g=l.global;if(g){var w=l.unicode;l.lastIndex=0}for(var O=[];;){var C=c(l,d);if(null===C)break;if(O.push(C),!g)break;""===String(C[0])&&(l.lastIndex=u(d,a(l.lastIndex),w))}for(var E,S="",k=0,R=0;R<O.length;R++){C=O[R];for(var _=String(C[0]),T=f(h(s(C.index),d.length),0),M=[],A=1;A<C.length;A++)M.push(void 0===(E=C[A])?E:String(E));var N=C.groups;if(p){var j=[_].concat(M,T,d);void 0!==N&&j.push(N);var x=String(r.apply(void 0,j))}else x=b(_,d,T,M,N,r);T>=k&&(S+=d.slice(k,T)+x,k=T+_.length)}return S+d.slice(k)}];function b(t,n,r,o,a,s){var l=r+t.length,u=o.length,c=g;return void 0!==a&&(a=i(a),c=p),e.call(s,c,(function(e,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(l);case"<":s=a[i.slice(1,-1)];break;default:var c=+i;if(0===c)return e;if(c>u){var f=d(c/10);return 0===f?e:f<=u?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):e}s=o[c-1]}return void 0===s?"":s}))}}))},function(t,e,n){var r=n(31);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n(10),n(11),n(12),n(30),n(7),n(80),n(5),n(15),n(8),n(9);function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=new Map;function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";o.has(t)||o.set(t,new Map);var e=o.get(t);function n(t,n){e.set(t,n)}function i(t){return e.get(t)}function a(t){return e.has(t)}function s(){return r(e.keys())}function l(){return r(e.values())}return{register:n,getItem:i,hasItem:a,getNames:s,getValues:l}}},function(t,e,n){var r=n(90),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e,n){"use strict";var r=n(26),o=n(84).filter,i=n(128),a=n(68),s=i("filter"),l=a("filter");r({target:"Array",proto:!0,forced:!s||!l},{filter:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(59),o=n(181),i=n(57),a=n(118),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(i(t),e=a(e,!0),i(n),o)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,n){"use strict";n(10),n(11),n(12),n(7),n(17),n(18),n(5),n(8),n(147),n(9);var r=n(6),o=n(13),i=n(2),a=n(1),s={_hooksStorage:Object.create(null),addHook:function(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey:function(t){var e=this;Object(a.arrayEach)(this._hooksStorage[t]||[],(function(n){e.hot.removeHook(t,n)}))},clearHooks:function(){var t=this;Object(i.objectEach)(this._hooksStorage,(function(e,n){return t.removeHooksByKey(n)})),this._hooksStorage={}}};Object(i.defineGetter)(s,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var l=s;function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",(function(){return g}));var g={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},v=function(){function t(e){d(this,t),this.hot=e,this.instance=e,this.state=g.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}var e,n,i;return e=t,(n=[{key:"_fireCallbacks",value:function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(t,e,n,r,o,i){this.TD=r,this.row=t,this.col=e,this.prop=n,this.originalValue=o,this.cellProperties=i,this.state=g.VIRGIN}},{key:"extend",value:function(){return function(t){function e(){return d(this,e),c(this,f(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(e,t),e}(this.constructor)}},{key:"saveValue",value:function(t,e){var n,r;e?((n=this.hot.getSelectedLast())[0]>n[2]&&(r=n[0],n[0]=n[2],n[2]=r),n[1]>n[3]&&(r=n[1],n[1]=n[3],n[3]=r)):n=[this.row,this.col,null,null],this.hot.populateFromArray(n[0],n[1],t,n[2],n[3],"edit")}},{key:"beginEditing",value:function(t,e){if(this.state===g.VIRGIN){if(this.hot.view.scrollViewport(new r.a(this.row,this.col)),this.state=g.EDITING,this.isInFullEditMode()){var n="string"==typeof t?t:Object(o.stringify)(this.originalValue);this.setValue(n)}this.open(e),this._opened=!0,this.focus(),this.hot.view.render(),this.hot.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(t,e,n){var r,o=this;if(n){var i=this._closeCallback;this._closeCallback=function(t){i&&i(t),n(t),o.hot.view.render()}}if(!this.isWaiting())if(this.state!==g.VIRGIN){if(this.state===g.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();var a=this.getValue();r=this.hot.getSettings().trimWhitespace?[["string"==typeof a?String.prototype.trim.call(a||""):a]]:[[a]],this.state=g.WAITING,this.saveValue(r,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(t){o.state=g.FINISHED,o.discardEditor(t)})):(this.state=g.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){o._fireCallbacks(!0)}))}},{key:"cancelChanges",value:function(){this.state=g.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(t){this.state===g.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=g.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=g.VIRGIN,this._fireCallbacks(!0)))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===g.WAITING}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"right":return"ht_clone_right";case"left":return"ht_clone_left";case"bottom":return"ht_clone_bottom";case"bottom-right-corner":return"ht_clone_bottom_right_corner";case"bottom-left-corner":return"ht_clone_bottom_left_corner";case"top":return"ht_clone_top";case"top-right-corner":return"ht_clone_top_right_corner";case"top-left-corner":return"ht_clone_top_left_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var t=this.hot.countRows(),e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsLeft&&(e="left"),e}}])&&p(e.prototype,n),i&&p(e,i),t}();Object(i.mixin)(v,l);e.b=v},function(t,e,n){var r=n(65);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(59),o=n(31),i=n(60),a=Object.defineProperty,s={},l=function(t){throw t};t.exports=function(t,e){if(i(s,t))return s[t];e||(e={});var n=[][t],u=!!i(e,"ACCESSORS")&&e.ACCESSORS,c=i(e,0)?e[0]:l,f=i(e,1)?e[1]:void 0;return s[t]=!!n&&!o((function(){if(u&&!r)return!0;var t={length:-1};u?a(t,1,{enumerable:!0,get:l}):t[1]=1,n.call(t,c,f)}))}},function(t,e,n){"use strict";var r=n(145),o=n(175),i=n(57),a=n(65),s=n(233),l=n(176),u=n(62),c=n(146),f=n(144),h=n(31),d=[].push,p=Math.min,g=!h((function(){return!RegExp(4294967295,"y")}));r("split",2,(function(t,e,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var r=String(a(this)),i=void 0===n?4294967295:n>>>0;if(0===i)return[];if(void 0===t)return[r];if(!o(t))return e.call(r,t,i);for(var s,l,u,c=[],h=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,g=new RegExp(t.source,h+"g");(s=f.call(g,r))&&!((l=g.lastIndex)>p&&(c.push(r.slice(p,s.index)),s.length>1&&s.index<r.length&&d.apply(c,s.slice(1)),u=s[0].length,p=l,c.length>=i));)g.lastIndex===s.index&&g.lastIndex++;return p===r.length?!u&&g.test("")||c.push(""):c.push(r.slice(p)),c.length>i?c.slice(0,i):c}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var o=a(this),i=null==e?void 0:e[t];return void 0!==i?i.call(e,o,n):r.call(String(o),e,n)},function(t,o){var a=n(r,t,this,o,r!==e);if(a.done)return a.value;var f=i(t),h=String(this),d=s(f,RegExp),v=f.unicode,y=(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.unicode?"u":"")+(g?"y":"g"),m=new d(g?f:"^(?:"+f.source+")",y),b=void 0===o?4294967295:o>>>0;if(0===b)return[];if(0===h.length)return null===c(m,h)?[h]:[];for(var w=0,O=0,C=[];O<h.length;){m.lastIndex=g?O:0;var E,S=c(m,g?h:h.slice(O));if(null===S||(E=p(u(m.lastIndex+(g?0:O)),h.length))===w)O=l(h,O,v);else{if(C.push(h.slice(w,O)),C.length===b)return C;for(var k=1;k<=S.length-1;k++)if(C.push(S[k]),C.length===b)return C;O=w=E}}return C.push(h.slice(w)),C}]}),!g)},function(t,e,n){"use strict";var r=n(26),o=n(117),i=n(72),a=n(91),s=[].join,l=o!=Object,u=a("join",",");r({target:"Array",proto:!0,forced:l||!u},{join:function(t){return s.call(i(this),void 0===t?",":t)}})},function(t,e,n){var r=n(59),o=n(64).f,i=Function.prototype,a=i.toString,s=/^\s*function ([^ (]*)/;!r||"name"in i||o(i,"name",{configurable:!0,get:function(){try{return a.call(this).match(s)[1]}catch(t){return""}}})},function(t,e,n){var r=n(117),o=n(65);t.exports=function(t){return r(o(t))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));n(7),n(5),n(8),n(32),n(9);var r=n(99),o=n(2);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e}var e,n,r;return e=t,(n=[{key:"toVisualRow",value:function(t){return this.hot.runHooks("unmodifyRow",t)}},{key:"toVisualColumn",value:function(t){return this.hot.runHooks("unmodifyCol",t)}},{key:"toVisual",value:function(t,e){return Object(o.isObject)(t)?{row:this.toVisualRow(t.row),column:this.toVisualColumn(t.column)}:[this.toVisualRow(t),this.toVisualColumn(e)]}},{key:"toPhysicalRow",value:function(t){return this.hot.runHooks("modifyRow",t)}},{key:"toPhysicalColumn",value:function(t){return this.hot.runHooks("modifyCol",t)}},{key:"toPhysical",value:function(t,e){return Object(o.isObject)(t)?{row:this.toPhysicalRow(t.row),column:this.toPhysicalColumn(t.column)}:[this.toPhysicalRow(t),this.toPhysicalColumn(e)]}}])&&i(e.prototype,n),r&&i(e,r),t}(),s=new WeakMap,l=new WeakMap;function u(t){var e,n=t instanceof r.a?t:function(t){if(!s.has(t))throw Error("Record translator was not registered for this object identity");return s.get(t)}(t);return l.has(n)?e=l.get(n):(e=new a(n),l.set(n,e)),e}},function(t,e,n){"use strict";n.r(e),n.d(e,"spreadsheetColumnLabel",(function(){return a})),n.d(e,"spreadsheetColumnIndex",(function(){return s})),n.d(e,"createSpreadsheetData",(function(){return l})),n.d(e,"createSpreadsheetObjectData",(function(){return u})),n.d(e,"createEmptySpreadsheetData",(function(){return c})),n.d(e,"translateRowsToColumns",(function(){return f})),n.d(e,"cellMethodLookupFactory",(function(){return h}));n(17);var r=n(87),o=n(2),i="ABCDEFGHIJKLMNOPQRSTUVWXYZ".length;function a(t){for(var e,n=t+1,r="";n>0;)e=(n-1)%i,r=String.fromCharCode(65+e)+r,n=parseInt((n-e)/i,10);return r}function s(t){var e=0;if(t)for(var n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Math.pow(i,r)*("ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(t[n])+1);return e-=1}function l(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;t<n;t++){var i=[];for(e=0;e<r;e++)i.push(a(e)+(t+1));o.push(i)}return o}function u(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;t<n;t++){var i={};for(e=0;e<r;e++)i["prop".concat(e)]=a(e)+(t+1);o.push(i)}return o}function c(t,e){for(var n,r=[],o=0;o<t;o++){n=[];for(var i=0;i<e;i++)n.push("");r.push(n)}return r}function f(t){var e,n,r,o,i=[],a=0;for(e=0,n=t.length;e<n;e++)for(r=0,o=t[e].length;r<o;r++)r===a&&(i.push([]),a+=1),i[r].push(t[e][r]);return i}function h(t,e){var n=void 0===e||e;return function(e,i){return function e(i){if(i){if(Object(o.hasOwnProperty)(i,t)&&void 0!==i[t])return i[t];if(Object(o.hasOwnProperty)(i,"type")&&i.type){if("string"!=typeof i.type)throw new Error("Cell type must be a string ");var a=Object(r.a)(i.type);if(Object(o.hasOwnProperty)(a,t))return a[t];if(n)return}return e(Object.getPrototypeOf(i))}}("number"==typeof e?this.getCellMeta(e,i):e)}}},function(t,e,n){var r=n(26),o=n(67),i=n(122);r({target:"Object",stat:!0,forced:n(31)((function(){i(1)}))},{keys:function(t){return i(o(t))}})},function(t,e,n){"use strict";var r,o=n(2),i=n(112),a=n(61),s=n(3);function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}
/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */var u=(l(r={languageCode:"en-US"},s.CONTEXTMENU_ITEMS_NO_ITEMS,"No available options"),l(r,s.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),l(r,s.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),l(r,s.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),l(r,s.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),l(r,s.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),l(r,s.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),l(r,s.CONTEXTMENU_ITEMS_UNDO,"Undo"),l(r,s.CONTEXTMENU_ITEMS_REDO,"Redo"),l(r,s.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),l(r,s.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),l(r,s.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),l(r,s.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),l(r,s.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),l(r,s.CONTEXTMENU_ITEMS_BORDERS,"Borders"),l(r,s.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),l(r,s.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),l(r,s.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),l(r,s.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),l(r,s.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),l(r,s.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),l(r,s.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),l(r,s.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),l(r,s.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),l(r,s.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),l(r,s.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),l(r,s.CONTEXTMENU_ITEMS_COPY,"Copy"),l(r,s.CONTEXTMENU_ITEMS_CUT,"Cut"),l(r,s.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),l(r,s.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),l(r,s.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),l(r,s.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),l(r,s.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),l(r,s.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),l(r,s.FILTERS_CONDITIONS_NONE,"None"),l(r,s.FILTERS_CONDITIONS_EMPTY,"Is empty"),l(r,s.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),l(r,s.FILTERS_CONDITIONS_EQUAL,"Is equal to"),l(r,s.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),l(r,s.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),l(r,s.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),l(r,s.FILTERS_CONDITIONS_CONTAINS,"Contains"),l(r,s.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),l(r,s.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),l(r,s.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),l(r,s.FILTERS_CONDITIONS_LESS_THAN,"Less than"),l(r,s.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),l(r,s.FILTERS_CONDITIONS_BETWEEN,"Is between"),l(r,s.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),l(r,s.FILTERS_CONDITIONS_AFTER,"After"),l(r,s.FILTERS_CONDITIONS_BEFORE,"Before"),l(r,s.FILTERS_CONDITIONS_TODAY,"Today"),l(r,s.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),l(r,s.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),l(r,s.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),l(r,s.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),l(r,s.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),l(r,s.FILTERS_LABELS_CONJUNCTION,"And"),l(r,s.FILTERS_LABELS_DISJUNCTION,"Or"),l(r,s.FILTERS_BUTTONS_SELECT_ALL,"Select all"),l(r,s.FILTERS_BUTTONS_CLEAR,"Clear"),l(r,s.FILTERS_BUTTONS_OK,"OK"),l(r,s.FILTERS_BUTTONS_CANCEL,"Cancel"),l(r,s.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),l(r,s.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),l(r,s.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),r);n.d(e,"e",(function(){return v})),n.d(e,"b",(function(){return y})),n.d(e,"d",(function(){return m})),n.d(e,"c",(function(){return b})),n.d(e,"a",(function(){return c}));var c=u.languageCode,f=Object(a.a)("languagesDictionaries"),h=f.register,d=f.getItem,p=f.hasItem,g=f.getValues;function v(t,e){var n=t,r=e;return Object(o.isObject)(t)&&(n=(r=t).languageCode),function(t,e){t!==c&&Object(i.b)(e,d(c))}(n,r),h(n,Object(o.deepClone)(r)),Object(o.deepClone)(r)}function y(t){return m(t)?Object(o.deepClone)(d(t)):null}function m(t){return p(t)}function b(){return g()}v(u)},function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return l})),n.d(e,"d",(function(){return f})),n.d(e,"c",(function(){return p})),n.d(e,"a",(function(){return g}));n(16);var r=n(51),o=n(224),i=n(42),a=n(100);function s(t,e,n){if(e in t){var r=t[e],o=n(r);if("function"==typeof o)try{o.prototype=o.prototype||{},Object.defineProperties(o,{__sentry_original__:{enumerable:!1,value:r}})}catch(t){}t[e]=o}}function l(t){return Object.keys(t).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&")}function u(t){if(Object(r.d)(t)){var e=t,n={message:e.message,name:e.name,stack:e.stack};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}if(Object(r.f)(t)){var a=t,s={};s.type=a.type;try{s.target=Object(r.c)(a.target)?Object(i.i)(a.target):Object.prototype.toString.call(a.target)}catch(t){s.target="<unknown>"}try{s.currentTarget=Object(r.c)(a.currentTarget)?Object(i.i)(a.currentTarget):Object.prototype.toString.call(a.currentTarget)}catch(t){s.currentTarget="<unknown>"}for(var o in"undefined"!=typeof CustomEvent&&Object(r.g)(t,CustomEvent)&&(s.detail=a.detail),a)Object.prototype.hasOwnProperty.call(a,o)&&(s[o]=a);return s}return t}function c(t){return function(t){return~-encodeURI(t).split(/%..|./).length}(JSON.stringify(t))}function f(t,e,n){void 0===e&&(e=3),void 0===n&&(n=102400);var r=p(t,e);return c(r)>n?f(t,e-1,n):r}function h(e,n){return"domain"===n&&e&&"object"==typeof e&&e._events?"[Domain]":"domainEmitter"===n?"[DomainEmitter]":void 0!==t&&e===t?"[Global]":"undefined"!=typeof window&&e===window?"[Window]":"undefined"!=typeof document&&e===document?"[Document]":Object(r.l)(e)?"[SyntheticEvent]":"number"==typeof e&&e!=e?"[NaN]":void 0===e?"[undefined]":"function"==typeof e?"[Function: "+Object(i.f)(e)+"]":e}function d(t,e,n,i){if(void 0===n&&(n=1/0),void 0===i&&(i=new o.a),0===n)return function(t){var e=Object.prototype.toString.call(t);if("string"==typeof t)return t;if("[object Object]"===e)return"[Object]";if("[object Array]"===e)return"[Array]";var n=h(t);return Object(r.i)(n)?n:e}(e);if(null!=e&&"function"==typeof e.toJSON)return e.toJSON();var a=h(e,t);if(Object(r.i)(a))return a;var s=u(e),l=Array.isArray(e)?[]:{};if(i.memoize(e))return"[Circular ~]";for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(l[c]=d(c,s[c],n-1,i));return i.unmemoize(e),l}function p(t,e){try{return JSON.parse(JSON.stringify(t,(function(t,n){return d(t,n,e)})))}catch(t){return"**non-serializable**"}}function g(t,e){void 0===e&&(e=40);var n=Object.keys(u(t));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=e)return Object(a.d)(n[0],e);for(var r=n.length;r>0;r--){var o=n.slice(0,r).join(", ");if(!(o.length>e))return r===n.length?o:Object(a.d)(o,e)}return""}}).call(this,n(115))},function(t,e,n){var r=n(59),o=n(64),i=n(116);t.exports=r?function(t,e,n){return o.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(49),o=n(78),i=n(60),a=n(159),s=n(182),l=n(89),u=l.get,c=l.enforce,f=String(String).split("String");(t.exports=function(t,e,n,s){var l=!!s&&!!s.unsafe,u=!!s&&!!s.enumerable,h=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof e||i(n,"name")||o(n,"name",e),c(n).source=f.join("string"==typeof e?e:"")),t!==r?(l?!h&&t[e]&&(u=!0):delete t[e],u?t[e]=n:o(t,e,n)):u?t[e]=n:a(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||s(this)}))},function(t,e,n){"use strict";var r=n(142),o=n(204);t.exports=r("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),o)},function(t,e,n){var r=n(26),o=n(195),i=n(31),a=n(52),s=n(124).onFreeze,l=Object.freeze;r({target:"Object",stat:!0,forced:i((function(){l(1)})),sham:!o},{freeze:function(t){return l&&a(t)?l(s(t)):t}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return u}));n(30),n(7),n(109),n(5),n(94),n(8),n(9);var r=n(22),o=n(21),i=new r.a,a=new Set,s=0;function l(t){0===s&&(i.addEventListener(t,"keydown",(function(t){a.has(t.keyCode)||a.add(t.keyCode)})),i.addEventListener(t,"keyup",(function(t){a.has(t.keyCode)&&a.delete(t.keyCode)})),i.addEventListener(t,"visibilitychange",(function(){t.hidden&&a.clear()})),i.addEventListener(t.defaultView,"blur",(function(){a.clear()}))),s+=1}function u(){s>0&&(s-=1),0===s&&(i.clearEvents(),a.clear(),s=0)}function c(){return Array.from(a.values()).some((function(t){return Object(o.isCtrlMetaKey)(t)}))}},function(t,e,n){var r=n(59),o=n(135),i=n(116),a=n(72),s=n(118),l=n(60),u=n(181),c=Object.getOwnPropertyDescriptor;e.f=r?c:function(t,e){if(t=a(t),e=s(e,!0),u)try{return c(t,e)}catch(t){}if(l(t,e))return i(!o.f.call(t,e),t[e])}},function(t,e,n){var r=n(125),o=n(117),i=n(67),a=n(62),s=n(173),l=[].push,u=function(t){var e=1==t,n=2==t,u=3==t,c=4==t,f=6==t,h=5==t||f;return function(d,p,g,v){for(var y,m,b=i(d),w=o(b),O=r(p,g,3),C=a(w.length),E=0,S=v||s,k=e?S(d,C):n?S(d,0):void 0;C>E;E++)if((h||E in w)&&(m=O(y=w[E],E,b),t))if(e)k[E]=m;else if(m)switch(t){case 3:return!0;case 5:return y;case 6:return E;case 2:l.call(k,y)}else if(c)return!1;return f?-1:u||c?c:k}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6)}},function(t,e,n){"use strict";var r=n(26),o=n(106),i=n(67),a=n(31),s=n(91),l=[],u=l.sort,c=a((function(){l.sort(void 0)})),f=a((function(){l.sort(null)})),h=s("sort");r({target:"Array",proto:!0,forced:c||!f||!h},{sort:function(t){return void 0===t?u.call(i(this)):u.call(i(this),o(t))}})},function(t,e,n){"use strict";n.r(e),n.d(e,"instanceToHTML",(function(){return u})),n.d(e,"_dataToHTML",(function(){return c})),n.d(e,"htmlToGridSettings",(function(){return f}));n(10),n(11),n(12),n(27),n(63),n(247),n(30),n(43),n(7),n(70),n(248),n(151),n(216),n(45),n(75),n(5),n(129),n(33),n(15),n(54),n(8),n(130),n(58),n(9);var r=n(0),o=n(13);function i(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var a={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},s=new RegExp(Object.keys(a).map((function(t){return"(".concat(t,")")})).join("|"),"gi");function l(t){return"TABLE"===(t&&t.nodeName||"")}function u(t){for(var e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData.apply(t,r),a=i.length,s=a>0?i[0].length:0,l=["<table>","</table>"],u=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],f=n?1:0,h=e?1:0,d=0;d<a;d+=1){for(var p=e&&0===d,g=[],v=0;v<s;v+=1){var y=!p&&n&&0===v,m="";if(p)m="<th>".concat(t.getColHeader(v-f),"</th>");else if(y)m="<th>".concat(t.getRowHeader(d-h),"</th>");else{var b=i[d][v],w=t.getCellMeta(d-f,v-h),O=w.hidden,C=w.rowspan,E=w.colspan;if(!O){var S=[];if(C&&S.push('rowspan="'.concat(C,'"')),E&&S.push('colspan="'.concat(E,'"')),Object(o.isEmpty)(b))m="<td ".concat(S.join(" "),"></td>");else{var k=b.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");m="<td ".concat(S.join(" "),">").concat(k,"</td>")}}}g.push(m)}var R=["<tr>"].concat(g,["</tr>"]).join("");p?u.splice(1,0,R):c.splice(-1,0,R)}return l.splice(1,0,u.join(""),c.join("")),l.join("")}function c(t){for(var e=t.length,n=["<table>"],r=0;r<e;r+=1){var i=t[r],a=i.length,s=[];0===r&&n.push("<tbody>");for(var l=0;l<a;l+=1){var u=i[l],c=Object(o.isEmpty)(u)?"":u.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");s.push("<td>".concat(c,"</td>"))}n.push.apply(n,["<tr>"].concat(s,["</tr>"])),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function f(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n={},o=e.createDocumentFragment(),u=e.createElement("div");o.appendChild(u);var c=t;if("string"==typeof c){var f=c.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(t){var e=t.match(/<td\b[^>]*?>/g)[0],n=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(e).concat(n).concat("</td>")}));u.insertAdjacentHTML("afterbegin","".concat(f)),c=u.querySelector("table")}if(c&&l(c)){var h=u.querySelector("style"),d=null,p=[];h&&(e.body.appendChild(h),h.disabled=!0,d=h.sheet,p=d?Array.from(d.cssRules):[],e.body.removeChild(h));var g=u.querySelector('meta[name$="enerator"]'),v=null!==c.querySelector("tbody th"),y=Array.from(c.querySelector("tr").cells).reduce((function(t,e){return t+e.colSpan}),0)-(v?1:0),m=c.tFoot&&Array.from(c.tFoot.rows)||[],b=[],w=!1,O=0,C=0;if(c.tHead){var E=Array.from(c.tHead.rows).filter((function(t){var e=null!==t.querySelector("td");return e&&b.push(t),!e}));w=(O=E.length)>0,O>1?n.nestedHeaders=Array.from(E).reduce((function(t,e){var n=Array.from(e.cells).reduce((function(t,e,n){if(v&&0===n)return t;var r=e.colSpan,o=e.innerHTML,i=r>1?{label:o,colspan:r}:o;return t.push(i),t}),[]);return t.push(n),t}),[]):w&&(n.colHeaders=Array.from(E[0].children).reduce((function(t,e,n){return v&&0===n?t:(t.push(e.innerHTML),t)}),[]))}b.length&&(n.fixedRowsTop=b.length),m.length&&(n.fixedRowsBottom=m.length);var S=[].concat(b,i(Array.from(c.tBodies).reduce((function(t,e){return t.push.apply(t,i(Array.from(e.rows))),t}),[])),i(m));C=S.length;for(var k=new Array(C),R=0;R<C;R++)k[R]=new Array(y);for(var _=[],T=[],M=0;M<C;M++)for(var A=S[M],N=Array.from(A.cells),j=N.length,x=function(t){var e=N[t],n=e.nodeName,o=e.innerHTML,i=e.rowSpan,l=e.colSpan,u=k[M].findIndex((function(t){return void 0===t}));if("TD"===n){if(i>1||l>1){for(var c=M;c<M+i;c++)if(c<C)for(var f=u;f<u+l;f++)k[c][f]=null;var h=e.getAttribute("style");h&&h.includes("mso-ignore:colspan")||_.push({col:u,row:M,rowspan:i,colspan:l})}var d="";d="nowrap"===p.reduce((function(t,n){if(Object(r.matchesCSSRules)(e,n)){var o=n.style.whiteSpace;o&&(t.whiteSpace=o)}return t}),{}).whiteSpace?o.replace(/[\r\n][\x20]{0,2}/gim," ").replace(/<br(\s*|\/)>/gim,"\r\n"):g&&/excel/gi.test(g.content)?o.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):o.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),k[M][u]=d.replace(s,(function(t){return a[t]}))}else T.push(o)},I=0;I<j;I++)x(I);return _.length&&(n.mergeCells=_),T.length&&(n.rowHeaders=T),k.length&&(n.data=k),n}}},function(t,e,n){"use strict";var r=n(61),o=n(35),i=n(41),a=n(56),s={editor:Object(o.a)("autocomplete"),renderer:Object(i.b)("autocomplete"),validator:Object(a.b)("autocomplete")},l={editor:Object(o.a)("checkbox"),renderer:Object(i.b)("checkbox")},u={editor:Object(o.a)("date"),renderer:Object(i.b)("autocomplete"),validator:Object(a.b)("date")},c={editor:Object(o.a)("dropdown"),renderer:Object(i.b)("autocomplete"),validator:Object(a.b)("autocomplete")},f={editor:Object(o.a)("handsontable"),renderer:Object(i.b)("autocomplete")},h={editor:Object(o.a)("numeric"),renderer:Object(i.b)("numeric"),validator:Object(a.b)("numeric"),dataType:"number"},d={editor:Object(o.a)("password"),renderer:Object(i.b)("password"),copyable:!1},p={editor:Object(o.a)("text"),renderer:Object(i.b)("text")},g={editor:Object(o.a)("text"),renderer:Object(i.b)("text"),validator:Object(a.b)("time")};n.d(e,"c",(function(){return C})),n.d(e,"a",(function(){return O})),n.d(e,"b",(function(){return w}));var v=Object(r.a)("cellTypes"),y=v.register,m=v.getItem,b=v.hasItem,w=v.getNames;v.getValues;function O(t){if(!b(t))throw Error('You declared cell type "'.concat(t,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method'));return m(t)}function C(t,e){var n=e.editor,r=e.renderer,s=e.validator;n&&Object(o.d)(t,n),r&&Object(i.c)(t,r),s&&Object(a.c)(t,s),y(t,e)}C("autocomplete",s),C("checkbox",l),C("date",u),C("dropdown",c),C("handsontable",f),C("numeric",h),C("password",d),C("text",p),C("time",g)},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var r,o,i,a=n(184),s=n(49),l=n(52),u=n(78),c=n(60),f=n(136),h=n(119),d=s.WeakMap;if(a){var p=new d,g=p.get,v=p.has,y=p.set;r=function(t,e){return y.call(p,t,e),e},o=function(t){return g.call(p,t)||{}},i=function(t){return v.call(p,t)}}else{var m=f("state");h[m]=!0,r=function(t,e){return u(t,m,e),e},o=function(t){return c(t,m)?t[m]:{}},i=function(t){return c(t,m)}}t.exports={set:r,get:o,has:i,enforce:function(t){return i(t)?o(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!l(e)||(n=o(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){"use strict";var r=n(31);t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){throw 1},1)}))}},function(t,e,n){"use strict";var r=n(59),o=n(49),i=n(139),a=n(79),s=n(60),l=n(88),u=n(172),c=n(118),f=n(31),h=n(105),d=n(120).f,p=n(83).f,g=n(64).f,v=n(208).trim,y=o.Number,m=y.prototype,b="Number"==l(h(m)),w=function(t){var e,n,r,o,i,a,s,l,u=c(t,!1);if("string"==typeof u&&u.length>2)if(43===(e=(u=v(u)).charCodeAt(0))||45===e){if(88===(n=u.charCodeAt(2))||120===n)return NaN}else if(48===e){switch(u.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+u}for(a=(i=u.slice(2)).length,s=0;s<a;s++)if((l=i.charCodeAt(s))<48||l>o)return NaN;return parseInt(i,r)}return+u};if(i("Number",!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var O,C=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof C&&(b?f((function(){m.valueOf.call(n)})):"Number"!=l(n))?u(new y(w(e)),n,C):w(e)},E=r?d(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;E.length>S;S++)s(y,O=E[S])&&!s(C,O)&&g(C,O,p(y,O));C.prototype=m,m.constructor=C,a(o,"Number",C)}},function(t,e,n){n(26)({target:"Number",stat:!0},{isInteger:n(243)})},function(t,e,n){"use strict";var r=n(142),o=n(204);t.exports=r("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),o)},function(t,e,n){"use strict";n.r(e),n.d(e,"columnFactory",(function(){return o}));var r=n(2);function o(t,e){function n(){}Object(r.inherit)(n,t);for(var o=0,i=e.length;o<i;o++)n.prototype[e[o]]=void 0;return n}},function(t,e,n){!function(t){"use strict";function n(t){return t.split('"').length-1}var r=function(t){var e,r,o,i,a,s,l,u=[],c=0;for((o=t.replace(/\r\n|\r/g,"\n").split("\n")).length>1&&""===o[o.length-1]&&o.pop(),e=0,r=o.length;e<r;e+=1){for(o[e]=o[e].split("\t"),i=0,a=o[e].length;i<a;i+=1)u[c]||(u[c]=[]),s&&0===i?(l=u[c].length-1,u[c][l]=u[c][l]+"\n"+o[e][0],s&&1&n(o[e][0])&&(s=!1,u[c][l]=u[c][l].substring(0,u[c][l].length-1).replace(/""/g,'"'))):i===a-1&&0===o[e][i].indexOf('"')&&1&n(o[e][i])?(u[c].push(o[e][i].substring(1).replace(/""/g,'"')),s=!0):(u[c].push(o[e][i].replace(/""/g,'"')),s=!1);s||(c+=1)}return u},o=function(t){var e,n,r,o,i,a="";for(e=0,n=t.length;e<n;e+=1){for(o=t[e].length,r=0;r<o;r+=1)r>0&&(a+="\t"),"string"==typeof(i=t[e][r])?i.indexOf("\n")>-1?a+='"'+i.replace(/"/g,'""')+'"':a+=i:a+=null==i?"":i;e!==n-1&&(a+="\n")}return a};e.parse=r,e.stringify=o}(window)},function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));n(10),n(11),n(7),n(5),n(8),n(32),n(9);var r=new WeakMap,o=Symbol("rootInstance");function i(t){r.set(t,!0)}function a(t){return t===o}function s(t){return r.has(t)}},function(t,e,n){t.exports=function t(e,n,r){function o(a,s){if(!n[a]){if(!e[a]){if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};e[a][0].call(u.exports,(function(t){return o(e[a][1][t]||t)}),u,u.exports,t,e,n,r)}return n[a].exports}for(var i=!1,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){!function(t){"use strict";var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,o=Math.ceil,i=Math.floor,a="[BigNumber Error] ",s=a+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,d=1e9;function p(t){var e=0|t;return 0<t||t===e?e:e-1}function g(t){for(var e,n,r=1,o=t.length,i=t[0]+"";r<o;){for(e=t[r++]+"",n=u-e.length;n--;e="0"+e);i+=e}for(o=i.length;48===i.charCodeAt(--o););return i.slice(0,o+1||1)}function v(t,e){var n,r,o=t.c,i=e.c,a=t.s,s=e.s,l=t.e,u=e.e;if(!a||!s)return null;if(n=o&&!o[0],r=i&&!i[0],n||r)return n?r?0:-s:a;if(a!=s)return a;if(n=a<0,r=l==u,!o||!i)return r?0:!o^n?1:-1;if(!r)return u<l^n?1:-1;for(s=(l=o.length)<(u=i.length)?l:u,a=0;a<s;a++)if(o[a]!=i[a])return o[a]>i[a]^n?1:-1;return l==u?0:u<l^n?1:-1}function y(t,e,n,r){if(t<e||n<t||t!==(t<0?o(t):i(t)))throw Error(a+(r||"Argument")+("number"==typeof t?t<e||n<t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function m(t){var e=t.c.length-1;return p(t.e/u)==e&&t.c[e]%2!=0}function b(t,e){return(1<t.length?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function w(t,e,n){var r,o;if(e<0){for(o=n+".";++e;o+=n);t=o+t}else if(++e>(r=t.length)){for(o=n,e-=r;--e;o+=n);t+=o}else e<r&&(t=t.slice(0,e)+"."+t.slice(e));return t}(n=function t(e){var n,O,C,E,S,k,R,_,T,M,A=V.prototype={constructor:V,toString:null,valueOf:null},N=new V(1),j=20,x=4,I=-7,D=21,P=-1e7,L=1e7,H=!1,F=1,B=0,U={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},W="0123456789abcdefghijklmnopqrstuvwxyz";function V(t,e){var n,o,a,l,f,h,d,p,g=this;if(!(g instanceof V))return new V(t,e);if(null==e){if(t instanceof V)return g.s=t.s,g.e=t.e,void(g.c=(t=t.c)?t.slice():t);if((h="number"==typeof t)&&0*t==0){if(g.s=1/t<0?(t=-t,-1):1,t===~~t){for(l=0,f=t;10<=f;f/=10,l++);return g.e=l,void(g.c=[t])}p=String(t)}else{if(p=String(t),!r.test(p))return C(g,p,h);g.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}-1<(l=p.indexOf("."))&&(p=p.replace(".","")),0<(f=p.search(/e/i))?(l<0&&(l=f),l+=+p.slice(f+1),p=p.substring(0,f)):l<0&&(l=p.length)}else{if(y(e,2,W.length,"Base"),p=String(t),10==e)return X(g=new V(t instanceof V?t:p),j+g.e+1,x);if(h="number"==typeof t){if(0*t!=0)return C(g,p,h,e);if(g.s=1/t<0?(p=p.slice(1),-1):1,V.DEBUG&&15<p.replace(/^0\.0*|\./,"").length)throw Error(s+t);h=!1}else g.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(n=W.slice(0,e),l=f=0,d=p.length;f<d;f++)if(n.indexOf(o=p.charAt(f))<0){if("."==o){if(l<f){l=d;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,f=-1,l=0;continue}return C(g,String(t),h,e)}-1<(l=(p=O(p,e,10,g.s)).indexOf("."))?p=p.replace(".",""):l=p.length}for(f=0;48===p.charCodeAt(f);f++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(f,++d)){if(d-=f,h&&V.DEBUG&&15<d&&(c<t||t!==i(t)))throw Error(s+g.s*t);if(L<(l=l-f-1))g.c=g.e=null;else if(l<P)g.c=[g.e=0];else{if(g.e=l,g.c=[],f=(l+1)%u,l<0&&(f+=u),f<d){for(f&&g.c.push(+p.slice(0,f)),d-=u;f<d;)g.c.push(+p.slice(f,f+=u));p=p.slice(f),f=u-p.length}else f-=d;for(;f--;p+="0");g.c.push(+p)}}else g.c=[g.e=0]}function Y(t,e,n,r){var o,i,a,s,l;if(null==n?n=x:y(n,0,8),!t.c)return t.toString();if(o=t.c[0],a=t.e,null==e)l=g(t.c),l=1==r||2==r&&(a<=I||D<=a)?b(l,a):w(l,a,"0");else if(i=(t=X(new V(t),e,n)).e,s=(l=g(t.c)).length,1==r||2==r&&(e<=i||i<=I)){for(;s<e;l+="0",s++);l=b(l,i)}else if(e-=a,l=w(l,i,"0"),s<i+1){if(0<--e)for(l+=".";e--;l+="0");}else if(0<(e+=i-s))for(i+1==s&&(l+=".");e--;l+="0");return t.s<0&&o?"-"+l:l}function z(t,e){for(var n,r=1,o=new V(t[0]);r<t.length;r++){if(!(n=new V(t[r])).s){o=n;break}e.call(o,n)&&(o=n)}return o}function G(t,e,n){for(var r=1,o=e.length;!e[--o];e.pop());for(o=e[0];10<=o;o/=10,r++);return(n=r+n*u-1)>L?t.c=t.e=null:t.c=n<P?[t.e=0]:(t.e=n,e),t}function X(t,e,n,r){var a,s,c,h,d,p,g,v=t.c,y=f;if(v){t:{for(a=1,h=v[0];10<=h;h/=10,a++);if((s=e-a)<0)s+=u,c=e,g=(d=v[p=0])/y[a-c-1]%10|0;else if((p=o((s+1)/u))>=v.length){if(!r)break t;for(;v.length<=p;v.push(0));d=g=0,c=(s%=u)-u+(a=1)}else{for(d=h=v[p],a=1;10<=h;h/=10,a++);g=(c=(s%=u)-u+a)<0?0:d/y[a-c-1]%10|0}if(r=r||e<0||null!=v[p+1]||(c<0?d:d%y[a-c-1]),r=n<4?(g||r)&&(0==n||n==(t.s<0?3:2)):5<g||5==g&&(4==n||r||6==n&&(0<s?0<c?d/y[a-c]:0:v[p-1])%10&1||n==(t.s<0?8:7)),e<1||!v[0])return v.length=0,r?(e-=t.e+1,v[0]=y[(u-e%u)%u],t.e=-e||0):v[0]=t.e=0,t;if(0==s?(v.length=p,h=1,p--):(v.length=p+1,h=y[u-s],v[p]=0<c?i(d/y[a-c]%y[c])*h:0),r)for(;;){if(0==p){for(s=1,c=v[0];10<=c;c/=10,s++);for(c=v[0]+=h,h=1;10<=c;c/=10,h++);s!=h&&(t.e++,v[0]==l&&(v[0]=1));break}if(v[p]+=h,v[p]!=l)break;v[p--]=0,h=1}for(s=v.length;0===v[--s];v.pop());}t.e>L?t.c=t.e=null:t.e<P&&(t.c=[t.e=0])}return t}function q(t){var e,n=t.e;return null===n?t.toString():(e=g(t.c),e=n<=I||D<=n?b(e,n):w(e,n,"0"),t.s<0?"-"+e:e)}return V.clone=t,V.ROUND_UP=0,V.ROUND_DOWN=1,V.ROUND_CEIL=2,V.ROUND_FLOOR=3,V.ROUND_HALF_UP=4,V.ROUND_HALF_DOWN=5,V.ROUND_HALF_EVEN=6,V.ROUND_HALF_CEIL=7,V.ROUND_HALF_FLOOR=8,V.EUCLID=9,V.config=V.set=function(t){var e,n;if(null!=t){if("object"!=typeof t)throw Error(a+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(y(n=t[e],0,d,e),j=n),t.hasOwnProperty(e="ROUNDING_MODE")&&(y(n=t[e],0,8,e),x=n),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((n=t[e])&&n.pop?(y(n[0],-d,0,e),y(n[1],0,d,e),I=n[0],D=n[1]):(y(n,-d,d,e),I=-(D=n<0?-n:n))),t.hasOwnProperty(e="RANGE"))if((n=t[e])&&n.pop)y(n[0],-d,-1,e),y(n[1],1,d,e),P=n[0],L=n[1];else{if(y(n,-d,d,e),!n)throw Error(a+e+" cannot be zero: "+n);P=-(L=n<0?-n:n)}if(t.hasOwnProperty(e="CRYPTO")){if((n=t[e])!==!!n)throw Error(a+e+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw H=!n,Error(a+"crypto unavailable");H=n}else H=n}if(t.hasOwnProperty(e="MODULO_MODE")&&(y(n=t[e],0,9,e),F=n),t.hasOwnProperty(e="POW_PRECISION")&&(y(n=t[e],0,d,e),B=n),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(n=t[e]))throw Error(a+e+" not an object: "+n);U=n}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(n=t[e])||/^.$|[+-.\s]|(.).*\1/.test(n))throw Error(a+e+" invalid: "+n);W=n}}return{DECIMAL_PLACES:j,ROUNDING_MODE:x,EXPONENTIAL_AT:[I,D],RANGE:[P,L],CRYPTO:H,MODULO_MODE:F,POW_PRECISION:B,FORMAT:U,ALPHABET:W}},V.isBigNumber=function(t){return t instanceof V||t&&!0===t._isBigNumber||!1},V.maximum=V.max=function(){return z(arguments,A.lt)},V.minimum=V.min=function(){return z(arguments,A.gt)},V.random=(E=9007199254740992,S=Math.random()*E&2097151?function(){return i(Math.random()*E)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,n,r,s,l,c=0,h=[],p=new V(N);if(null==t?t=j:y(t,0,d),s=o(t/u),H)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(s*=2));c<s;)9e15<=(l=131072*e[c]+(e[c+1]>>>11))?(n=crypto.getRandomValues(new Uint32Array(2)),e[c]=n[0],e[c+1]=n[1]):(h.push(l%1e14),c+=2);c=s/2}else{if(!crypto.randomBytes)throw H=!1,Error(a+"crypto unavailable");for(e=crypto.randomBytes(s*=7);c<s;)9e15<=(l=281474976710656*(31&e[c])+1099511627776*e[c+1]+4294967296*e[c+2]+16777216*e[c+3]+(e[c+4]<<16)+(e[c+5]<<8)+e[c+6])?crypto.randomBytes(7).copy(e,c):(h.push(l%1e14),c+=7);c=s/7}if(!H)for(;c<s;)(l=S())<9e15&&(h[c++]=l%1e14);for(s=h[--c],t%=u,s&&t&&(l=f[u-t],h[c]=i(s/l)*l);0===h[c];h.pop(),c--);if(c<0)h=[r=0];else{for(r=-1;0===h[0];h.splice(0,1),r-=u);for(c=1,l=h[0];10<=l;l/=10,c++);c<u&&(r-=u-c)}return p.e=r,p.c=h,p}),V.sum=function(){for(var t=1,e=arguments,n=new V(e[0]);t<e.length;)n=n.plus(e[t++]);return n},O=function(){var t="0123456789";function e(t,e,n,r){for(var o,i,a=[0],s=0,l=t.length;s<l;){for(i=a.length;i--;a[i]*=e);for(a[0]+=r.indexOf(t.charAt(s++)),o=0;o<a.length;o++)a[o]>n-1&&(null==a[o+1]&&(a[o+1]=0),a[o+1]+=a[o]/n|0,a[o]%=n)}return a.reverse()}return function(r,o,i,a,s){var l,u,c,f,h,d,p,v,y=r.indexOf("."),m=j,b=x;for(0<=y&&(f=B,B=0,r=r.replace(".",""),d=(v=new V(o)).pow(r.length-y),B=f,v.c=e(w(g(d.c),d.e,"0"),10,i,t),v.e=v.c.length),c=f=(p=e(r,o,i,s?(l=W,t):(l=t,W))).length;0==p[--f];p.pop());if(!p[0])return l.charAt(0);if(y<0?--c:(d.c=p,d.e=c,d.s=a,p=(d=n(d,v,m,b,i)).c,h=d.r,c=d.e),y=p[u=c+m+1],f=i/2,h=h||u<0||null!=p[u+1],h=b<4?(null!=y||h)&&(0==b||b==(d.s<0?3:2)):f<y||y==f&&(4==b||h||6==b&&1&p[u-1]||b==(d.s<0?8:7)),u<1||!p[0])r=h?w(l.charAt(1),-m,l.charAt(0)):l.charAt(0);else{if(p.length=u,h)for(--i;++p[--u]>i;)p[u]=0,u||(++c,p=[1].concat(p));for(f=p.length;!p[--f];);for(y=0,r="";y<=f;r+=l.charAt(p[y++]));r=w(r,c,l.charAt(0))}return r}}(),n=function(){function t(t,e,n){var r,o,i,a,s=0,l=t.length,u=e%h,c=e/h|0;for(t=t.slice();l--;)s=((o=u*(i=t[l]%h)+(r=c*i+(a=t[l]/h|0)*u)%h*h+s)/n|0)+(r/h|0)+c*a,t[l]=o%n;return s&&(t=[s].concat(t)),t}function e(t,e,n,r){var o,i;if(n!=r)i=r<n?1:-1;else for(o=i=0;o<n;o++)if(t[o]!=e[o]){i=t[o]>e[o]?1:-1;break}return i}function n(t,e,n,r){for(var o=0;n--;)t[n]-=o,o=t[n]<e[n]?1:0,t[n]=o*r+t[n]-e[n];for(;!t[0]&&1<t.length;t.splice(0,1));}return function(r,o,a,s,c){var f,h,d,g,v,y,m,b,w,O,C,E,S,k,R,_,T,M=r.s==o.s?1:-1,A=r.c,N=o.c;if(!(A&&A[0]&&N&&N[0]))return new V(r.s&&o.s&&(A?!N||A[0]!=N[0]:N)?A&&0==A[0]||!N?0*M:M/0:NaN);for(w=(b=new V(M)).c=[],M=a+(h=r.e-o.e)+1,c||(c=l,h=p(r.e/u)-p(o.e/u),M=M/u|0),d=0;N[d]==(A[d]||0);d++);if(N[d]>(A[d]||0)&&h--,M<0)w.push(1),g=!0;else{for(k=A.length,_=N.length,M+=2,1<(v=i(c/(N[d=0]+1)))&&(N=t(N,v,c),A=t(A,v,c),_=N.length,k=A.length),S=_,C=(O=A.slice(0,_)).length;C<_;O[C++]=0);T=N.slice(),T=[0].concat(T),R=N[0],N[1]>=c/2&&R++;do{if(v=0,(f=e(N,O,_,C))<0){if(E=O[0],_!=C&&(E=E*c+(O[1]||0)),1<(v=i(E/R)))for(c<=v&&(v=c-1),m=(y=t(N,v,c)).length,C=O.length;1==e(y,O,m,C);)v--,n(y,_<m?T:N,m,c),m=y.length,f=1;else 0==v&&(f=v=1),m=(y=N.slice()).length;if(m<C&&(y=[0].concat(y)),n(O,y,C,c),C=O.length,-1==f)for(;e(N,O,_,C)<1;)v++,n(O,_<C?T:N,C,c),C=O.length}else 0===f&&(v++,O=[0]);w[d++]=v,O[0]?O[C++]=A[S]||0:(O=[A[S]],C=1)}while((S++<k||null!=O[0])&&M--);g=null!=O[0],w[0]||w.splice(0,1)}if(c==l){for(d=1,M=w[0];10<=M;M/=10,d++);X(b,a+(b.e=d+h*u-1)+1,s,g)}else b.e=h,b.r=+g;return b}}(),k=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,_=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,M=/^\s*\+(?=[\w.])|^\s+|\s+$/g,C=function(t,e,n,r){var o,i=n?e:e.replace(M,"");if(T.test(i))t.s=isNaN(i)?null:i<0?-1:1,t.c=t.e=null;else{if(!n&&(i=i.replace(k,(function(t,e,n){return o="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=o?t:e})),r&&(o=r,i=i.replace(R,"$1").replace(_,"0.$1")),e!=i))return new V(i,o);if(V.DEBUG)throw Error(a+"Not a"+(r?" base "+r:"")+" number: "+e);t.c=t.e=t.s=null}},A.absoluteValue=A.abs=function(){var t=new V(this);return t.s<0&&(t.s=1),t},A.comparedTo=function(t,e){return v(this,new V(t,e))},A.decimalPlaces=A.dp=function(t,e){var n,r,o;if(null!=t)return y(t,0,d),null==e?e=x:y(e,0,8),X(new V(this),t+this.e+1,e);if(!(n=this.c))return null;if(r=((o=n.length-1)-p(this.e/u))*u,o=n[o])for(;o%10==0;o/=10,r--);return r<0&&(r=0),r},A.dividedBy=A.div=function(t,e){return n(this,new V(t,e),j,x)},A.dividedToIntegerBy=A.idiv=function(t,e){return n(this,new V(t,e),0,1)},A.exponentiatedBy=A.pow=function(t,e){var n,r,s,l,c,f,h,d,p=this;if((t=new V(t)).c&&!t.isInteger())throw Error(a+"Exponent not an integer: "+q(t));if(null!=e&&(e=new V(e)),c=14<t.e,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!t.c||!t.c[0])return d=new V(Math.pow(+q(p),c?2-m(t):+q(t))),e?d.mod(e):d;if(f=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new V(NaN);(r=!f&&p.isInteger()&&e.isInteger())&&(p=p.mod(e))}else{if(9<t.e&&(0<p.e||p.e<-1||(0==p.e?1<p.c[0]||c&&24e7<=p.c[1]:p.c[0]<8e13||c&&p.c[0]<=9999975e7)))return l=p.s<0&&m(t)?-0:0,-1<p.e&&(l=1/l),new V(f?1/l:l);B&&(l=o(B/u+2))}for(h=c?(n=new V(.5),f&&(t.s=1),m(t)):(s=Math.abs(+q(t)))%2,d=new V(N);;){if(h){if(!(d=d.times(p)).c)break;l?d.c.length>l&&(d.c.length=l):r&&(d=d.mod(e))}if(s){if(0===(s=i(s/2)))break;h=s%2}else if(X(t=t.times(n),t.e+1,1),14<t.e)h=m(t);else{if(0==(s=+q(t)))break;h=s%2}p=p.times(p),l?p.c&&p.c.length>l&&(p.c.length=l):r&&(p=p.mod(e))}return r?d:(f&&(d=N.div(d)),e?d.mod(e):l?X(d,B,x,void 0):d)},A.integerValue=function(t){var e=new V(this);return null==t?t=x:y(t,0,8),X(e,e.e+1,t)},A.isEqualTo=A.eq=function(t,e){return 0===v(this,new V(t,e))},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(t,e){return 0<v(this,new V(t,e))},A.isGreaterThanOrEqualTo=A.gte=function(t,e){return 1===(e=v(this,new V(t,e)))||0===e},A.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},A.isLessThan=A.lt=function(t,e){return v(this,new V(t,e))<0},A.isLessThanOrEqualTo=A.lte=function(t,e){return-1===(e=v(this,new V(t,e)))||0===e},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return 0<this.s},A.isZero=function(){return!!this.c&&0==this.c[0]},A.minus=function(t,e){var n,r,o,i,a=this,s=a.s;if(e=(t=new V(t,e)).s,!s||!e)return new V(NaN);if(s!=e)return t.s=-e,a.plus(t);var c=a.e/u,f=t.e/u,h=a.c,d=t.c;if(!c||!f){if(!h||!d)return h?(t.s=-e,t):new V(d?a:NaN);if(!h[0]||!d[0])return d[0]?(t.s=-e,t):new V(h[0]?a:3==x?-0:0)}if(c=p(c),f=p(f),h=h.slice(),s=c-f){for((o=(i=s<0)?(s=-s,h):(f=c,d)).reverse(),e=s;e--;o.push(0));o.reverse()}else for(r=(i=(s=h.length)<(e=d.length))?s:e,s=e=0;e<r;e++)if(h[e]!=d[e]){i=h[e]<d[e];break}if(i&&(o=h,h=d,d=o,t.s=-t.s),0<(e=(r=d.length)-(n=h.length)))for(;e--;h[n++]=0);for(e=l-1;s<r;){if(h[--r]<d[r]){for(n=r;n&&!h[--n];h[n]=e);--h[n],h[r]+=l}h[r]-=d[r]}for(;0==h[0];h.splice(0,1),--f);return h[0]?G(t,h,f):(t.s=3==x?-1:1,t.c=[t.e=0],t)},A.modulo=A.mod=function(t,e){var r,o,i=this;return t=new V(t,e),!i.c||!t.s||t.c&&!t.c[0]?new V(NaN):!t.c||i.c&&!i.c[0]?new V(i):(9==F?(o=t.s,t.s=1,r=n(i,t,0,3),t.s=o,r.s*=o):r=n(i,t,0,F),(t=i.minus(r.times(t))).c[0]||1!=F||(t.s=i.s),t)},A.multipliedBy=A.times=function(t,e){var n,r,o,i,a,s,l,c,f,d,g,v,y,m,b=this,w=b.c,O=(t=new V(t,e)).c;if(!(w&&O&&w[0]&&O[0]))return!b.s||!t.s||w&&!w[0]&&!O||O&&!O[0]&&!w?t.c=t.e=t.s=null:(t.s*=b.s,w&&O?(t.c=[0],t.e=0):t.c=t.e=null),t;for(r=p(b.e/u)+p(t.e/u),t.s*=b.s,(l=w.length)<(d=O.length)&&(y=w,w=O,O=y,o=l,l=d,d=o),o=l+d,y=[];o--;y.push(0));for(m=h,o=d;0<=--o;){for(n=0,g=O[o]%m,v=O[o]/m|0,i=o+(a=l);o<i;)n=((c=g*(c=w[--a]%m)+(s=v*c+(f=w[a]/m|0)*g)%m*m+y[i]+n)/1e14|0)+(s/m|0)+v*f,y[i--]=c%1e14;y[i]=n}return n?++r:y.splice(0,1),G(t,y,r)},A.negated=function(){var t=new V(this);return t.s=-t.s||null,t},A.plus=function(t,e){var n,r=this,o=r.s;if(e=(t=new V(t,e)).s,!o||!e)return new V(NaN);if(o!=e)return t.s=-e,r.minus(t);var i=r.e/u,a=t.e/u,s=r.c,c=t.c;if(!i||!a){if(!s||!c)return new V(o/0);if(!s[0]||!c[0])return c[0]?t:new V(s[0]?r:0*o)}if(i=p(i),a=p(a),s=s.slice(),o=i-a){for((n=0<o?(a=i,c):(o=-o,s)).reverse();o--;n.push(0));n.reverse()}for((o=s.length)-(e=c.length)<0&&(n=c,c=s,s=n,e=o),o=0;e;)o=(s[--e]=s[e]+c[e]+o)/l|0,s[e]=l===s[e]?0:s[e]%l;return o&&(s=[o].concat(s),++a),G(t,s,a)},A.precision=A.sd=function(t,e){var n,r,o;if(null!=t&&t!==!!t)return y(t,1,d),null==e?e=x:y(e,0,8),X(new V(this),t,e);if(!(n=this.c))return null;if(r=(o=n.length-1)*u+1,o=n[o]){for(;o%10==0;o/=10,r--);for(o=n[0];10<=o;o/=10,r++);}return t&&this.e+1>r&&(r=this.e+1),r},A.shiftedBy=function(t){return y(t,-c,c),this.times("1e"+t)},A.squareRoot=A.sqrt=function(){var t,e,r,o,i,a=this,s=a.c,l=a.s,u=a.e,c=j+4,f=new V("0.5");if(1!==l||!s||!s[0])return new V(!l||l<0&&(!s||s[0])?NaN:s?a:1/0);if((r=0==(l=Math.sqrt(+q(a)))||l==1/0?(((e=g(s)).length+u)%2==0&&(e+="0"),l=Math.sqrt(+e),u=p((u+1)/2)-(u<0||u%2),new V(e=l==1/0?"1e"+u:(e=l.toExponential()).slice(0,e.indexOf("e")+1)+u)):new V(l+"")).c[0])for((l=(u=r.e)+c)<3&&(l=0);;)if(i=r,r=f.times(i.plus(n(a,i,c,1))),g(i.c).slice(0,l)===(e=g(r.c)).slice(0,l)){if(r.e<u&&--l,"9999"!=(e=e.slice(l-3,l+1))&&(o||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(X(r,r.e+j+2,1),t=!r.times(r).eq(a));break}if(!o&&(X(i,i.e+j+2,0),i.times(i).eq(a))){r=i;break}c+=4,l+=4,o=1}return X(r,r.e+j+1,x,t)},A.toExponential=function(t,e){return null!=t&&(y(t,0,d),t++),Y(this,t,e,1)},A.toFixed=function(t,e){return null!=t&&(y(t,0,d),t=t+this.e+1),Y(this,t,e)},A.toFormat=function(t,e,n){var r;if(null==n)null!=t&&e&&"object"==typeof e?(n=e,e=null):t&&"object"==typeof t?(n=t,t=e=null):n=U;else if("object"!=typeof n)throw Error(a+"Argument not an object: "+n);if(r=this.toFixed(t,e),this.c){var o,i=r.split("."),s=+n.groupSize,l=+n.secondaryGroupSize,u=n.groupSeparator||"",c=i[0],f=i[1],h=this.s<0,d=h?c.slice(1):c,p=d.length;if(l&&(o=s,s=l,p-=l=o),0<s&&0<p){for(o=p%s||s,c=d.substr(0,o);o<p;o+=s)c+=u+d.substr(o,s);0<l&&(c+=u+d.slice(o)),h&&(c="-"+c)}r=f?c+(n.decimalSeparator||"")+((l=+n.fractionGroupSize)?f.replace(new RegExp("\\d{"+l+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):f):c}return(n.prefix||"")+r+(n.suffix||"")},A.toFraction=function(t){var e,r,o,i,s,l,c,h,d,p,v,y,m=this,b=m.c;if(null!=t&&(!(c=new V(t)).isInteger()&&(c.c||1!==c.s)||c.lt(N)))throw Error(a+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+q(c));if(!b)return new V(m);for(e=new V(N),d=r=new V(N),o=h=new V(N),y=g(b),s=e.e=y.length-m.e-1,e.c[0]=f[(l=s%u)<0?u+l:l],t=!t||0<c.comparedTo(e)?0<s?e:d:c,l=L,L=1/0,c=new V(y),h.c[0]=0;p=n(c,e,0,1),1!=(i=r.plus(p.times(o))).comparedTo(t);)r=o,o=i,d=h.plus(p.times(i=d)),h=i,e=c.minus(p.times(i=e)),c=i;return i=n(t.minus(r),o,0,1),h=h.plus(i.times(d)),r=r.plus(i.times(o)),h.s=d.s=m.s,v=n(d,o,s*=2,x).minus(m).abs().comparedTo(n(h,r,s,x).minus(m).abs())<1?[d,o]:[h,r],L=l,v},A.toNumber=function(){return+q(this)},A.toPrecision=function(t,e){return null!=t&&y(t,1,d),Y(this,t,e,2)},A.toString=function(t){var e,n=this,r=n.s,o=n.e;return null===o?r?(e="Infinity",r<0&&(e="-"+e)):e="NaN":(e=null==t?o<=I||D<=o?b(g(n.c),o):w(g(n.c),o,"0"):10===t?w(g((n=X(new V(n),j+o+1,x)).c),n.e,"0"):(y(t,2,W.length,"Base"),O(w(g(n.c),o,"0"),10,t,r,!0)),r<0&&n.c[0]&&(e="-"+e)),e},A.valueOf=A.toJSON=function(){return q(this)},A._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(A[Symbol.toStringTag]="BigNumber",A[Symbol.for("nodejs.util.inspect.custom")]=A.valueOf),null!=e&&V.set(e),V}()).default=n.BigNumber=n,void 0!==e&&e.exports?e.exports=n:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=n)}(this)},{}],2:[function(t,e,n){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=t("./globalState"),i=t("./validating"),a=t("./parsing"),s=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],l={general:{scale:1024,suffixes:s,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:s,marker:"d"}},u={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function c(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;if("string"==typeof e&&(e=a.parseFormat(e)),!i.validateFormat(e))return"ERROR: invalid format";var r=e.prefix||"",s=e.postfix||"",c=function(t,e,n){switch(e.output){case"currency":return function(t,e,n){var r=n.currentCurrency(),o=Object.assign({},u,e),i=void 0,a="",s=!!o.totalLength||!!o.forceAverage||o.average,l=e.currencyPosition||r.position,c=e.currencySymbol||r.symbol;o.spaceSeparated&&(a=" "),"infix"===l&&(i=a+c+a);var f=p({instance:t,providedFormat:e,state:n,decimalSeparator:i});return"prefix"===l&&(f=t._value<0&&"sign"===o.negative?"-".concat(a).concat(c).concat(f.slice(1)):c+a+f),l&&"postfix"!==l||(f=f+(a=s?"":a)+c),f}(t,e=g(e,o.currentCurrencyDefaultFormat()),o);case"percent":return function(t,e,n,r){var o=e.prefixSymbol,i=p({instance:r(100*t._value),providedFormat:e,state:n}),a=Object.assign({},u,e);return o?"%".concat(a.spaceSeparated?" ":"").concat(i):"".concat(i).concat(a.spaceSeparated?" ":"","%")}(t,e=g(e,o.currentPercentageDefaultFormat()),o,n);case"byte":return e=g(e,o.currentByteDefaultFormat()),w=t,C=o,E=n,S=(O=e).base||"binary",k=l[S],_=(R=f(w._value,k.suffixes,k.scale)).value,T=R.suffix,M=p({instance:E(_),providedFormat:O,state:C,defaults:C.currentByteDefaultFormat()}),A=C.currentAbbreviations(),"".concat(M).concat(A.spaced?" ":"").concat(T);case"time":return e=g(e,o.currentTimeDefaultFormat()),v=t,y=Math.floor(v._value/60/60),m=Math.floor((v._value-60*y*60)/60),b=Math.round(v._value-60*y*60-60*m),"".concat(y,":").concat(m<10?"0":"").concat(m,":").concat(b<10?"0":"").concat(b);case"ordinal":return r=t,i=e=g(e,o.currentOrdinalDefaultFormat()),s=(a=o).currentOrdinal(),c=Object.assign({},u,i),h=p({instance:r,providedFormat:i,state:a}),d=s(r._value),"".concat(h).concat(c.spaceSeparated?" ":"").concat(d);case"number":default:return p({instance:t,providedFormat:e,numbro:n})}var r,i,a,s,c,h,d,v,y,m,b,w,O,C,E,S,k,R,_,T,M,A}(t,e,n);return(c=r+c)+s}function f(t,e,n){var r=e[0],o=Math.abs(t);if(n<=o){for(var i=1;i<e.length;++i){var a=Math.pow(n,i),s=Math.pow(n,i+1);if(a<=o&&o<s){r=e[i],t/=a;break}}r===e[0]&&(t/=Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function h(t){for(var e="",n=0;n<t;n++)e+="0";return e}function d(t,e){return-1!==t.toString().indexOf("e")?function(t,e){var n=t.toString(),o=r(n.split("e"),2),i=o[0],a=o[1],s=r(i.split("."),2),l=s[0],u=s[1],c=void 0===u?"":u;if(0<+a)n=l+c+h(a-c.length);else{var f=".";f=+l<0?"-0".concat(f):"0".concat(f);var d=(h(-a-1)+Math.abs(l)+c).substr(0,e);d.length<e&&(d+=h(e-d.length)),n=f+d}return 0<+a&&0<e&&(n+=".".concat(h(e))),n}(t,e):(Math.round(+"".concat(t,"e+").concat(e))/Math.pow(10,e)).toFixed(e)}function p(t){var e=t.instance,n=t.providedFormat,i=t.state,a=void 0===i?o:i,s=t.decimalSeparator,l=t.defaults,c=void 0===l?a.currentDefaults():l,f=e._value;if(0===f&&a.hasZeroFormat())return a.getZeroFormat();if(!isFinite(f))return f.toString();var h,p,g,v,y,m,b,w,O=Object.assign({},u,c,n),C=O.totalLength,E=C?0:O.characteristic,S=O.optionalCharacteristic,k=O.forceAverage,R=!!C||!!k||O.average,_=C?-1:R&&void 0===n.mantissa?0:O.mantissa,T=!C&&(void 0===n.optionalMantissa?-1===_:O.optionalMantissa),M=O.trimMantissa,A=O.thousandSeparated,N=O.spaceSeparated,j=O.negative,x=O.forceSign,I=O.exponential,D="";if(R){var P=function(t){var e=t.value,n=t.forceAverage,r=t.abbreviations,o=t.spaceSeparated,i=void 0!==o&&o,a=t.totalLength,s=void 0===a?0:a,l="",u=Math.abs(e),c=-1;if(u>=Math.pow(10,12)&&!n||"trillion"===n?(l=r.trillion,e/=Math.pow(10,12)):u<Math.pow(10,12)&&u>=Math.pow(10,9)&&!n||"billion"===n?(l=r.billion,e/=Math.pow(10,9)):u<Math.pow(10,9)&&u>=Math.pow(10,6)&&!n||"million"===n?(l=r.million,e/=Math.pow(10,6)):(u<Math.pow(10,6)&&u>=Math.pow(10,3)&&!n||"thousand"===n)&&(l=r.thousand,e/=Math.pow(10,3)),l&&(l=(i?" ":"")+l),s){var f=e.toString().split(".")[0];c=Math.max(s-f.length,0)}return{value:e,abbreviation:l,mantissaPrecision:c}}({value:f,forceAverage:k,abbreviations:a.currentAbbreviations(),spaceSeparated:N,totalLength:C});f=P.value,D+=P.abbreviation,C&&(_=P.mantissaPrecision)}if(I){var L=(p=(h={value:f,characteristicPrecision:E}).value,v=void 0===(g=h.characteristicPrecision)?0:g,m=(y=r(p.toExponential().split("e"),2))[0],b=y[1],w=+m,v&&1<v&&(w*=Math.pow(10,v-1),b=0<=(b=+b-(v-1))?"+".concat(b):b),{value:w,abbreviation:"e".concat(b)});f=L.value,D=L.abbreviation+D}var H,F,B,U=function(t,e,n,o,i){if(-1===o)return t;var a=d(e,o),s=r(a.toString().split("."),2),l=s[0],u=s[1],c=void 0===u?"":u;if(c.match(/^0+$/)&&(n||i))return l;var f=c.match(/0+$/);return i&&f?"".concat(l,".").concat(c.toString().slice(0,f.index)):a.toString()}(f.toString(),f,T,_,M);return U=function(t,e,n,r,o){var i=r.currentDelimiters(),a=i.thousands;o=o||i.decimal;var s=i.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];return n&&(e<0&&(u=u.slice(1)),function(t,e){for(var n=[],r=0,o=t;0<o;o--)r===e&&(n.unshift(o),r=0),r++;return n}(u.length,s).forEach((function(t,e){u=u.slice(0,t+e)+a+u.slice(t+e)})),e<0&&(u="-".concat(u))),c?u+o+c:u}(U=function(t,e,n,o){var i=t,a=r(i.toString().split("."),2),s=a[0],l=a[1];if(s.match(/^-?0$/)&&n)return l?"".concat(s.replace("0",""),".").concat(l):s.replace("0","");if(s.length<o)for(var u=o-s.length,c=0;c<u;c++)i="0".concat(i);return i.toString()}(U,0,S,E),f,A,a,s),(R||I)&&(U+=D),(x||f<0)&&(H=U,B=j,U=0===(F=f)?H:0==+H?H.replace("-",""):0<F?"+".concat(H):"sign"===B?H:"(".concat(H.replace("-",""),")")),U}function g(t,e){if(!t)return e;var n=Object.keys(t);return 1===n.length&&"output"===n[0]?e:t}e.exports=function(t){return{format:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return c.apply(void 0,n.concat([t]))},getByteUnit:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(t){var e=l.general;return f(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(t){var e=l.binary;return f(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(t){var e=l.decimal;return f(t._value,e.suffixes,e.scale).suffix}.apply(void 0,n.concat([t]))},formatOrDefault:g}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,n){"use strict";var r=t("./en-US"),o=t("./validating"),i=t("./parsing"),a={},s=void 0,l={},u=null,c={};function f(t){s=t}function h(){return l[s]}a.languages=function(){return Object.assign({},l)},a.currentLanguage=function(){return s},a.currentCurrency=function(){return h().currency},a.currentAbbreviations=function(){return h().abbreviations},a.currentDelimiters=function(){return h().delimiters},a.currentOrdinal=function(){return h().ordinal},a.currentDefaults=function(){return Object.assign({},h().defaults,c)},a.currentOrdinalDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().ordinalFormat)},a.currentByteDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().byteFormat)},a.currentPercentageDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().percentageFormat)},a.currentCurrencyDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().currencyFormat)},a.currentTimeDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().timeFormat)},a.setDefaults=function(t){t=i.parseFormat(t),o.validateFormat(t)&&(c=t)},a.getZeroFormat=function(){return u},a.setZeroFormat=function(t){return u="string"==typeof t?t:null},a.hasZeroFormat=function(){return null!==u},a.languageData=function(t){if(t){if(l[t])return l[t];throw new Error('Unknown tag "'.concat(t,'"'))}return h()},a.registerLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!o.validateLanguage(t))throw new Error("Invalid language data");l[t.languageTag]=t,e&&f(t.languageTag)},a.setLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r.languageTag;if(!l[t]){var n=t.split("-")[0],o=Object.keys(l).find((function(t){return t.split("-")[0]===n}));return l[o]?void f(o):void f(e)}f(t)},a.registerLanguage(r),s=r.languageTag,e.exports=a},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,n){"use strict";e.exports=function(e){return{loadLanguagesInNode:function(n){return r=e,void n.forEach((function(e){var n=void 0;try{n=t("../languages/".concat(e))}catch(n){console.error('Unable to load "'.concat(e,'". No matching language file found.'))}n&&r.registerLanguage(n)}));var r}}}},{}],6:[function(t,e,n){"use strict";var r=t("bignumber.js");function o(t,e,n){var o=new r(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new r(i),t._value=o.minus(i).toNumber(),t}e.exports=function(t){return{add:function(e,n){return i=n,a=t,s=new r((o=e)._value),l=i,a.isNumbro(i)&&(l=i._value),l=new r(l),o._value=s.plus(l).toNumber(),o;var o,i,a,s,l},subtract:function(e,n){return o(e,n,t)},multiply:function(e,n){return i=n,a=t,s=new r((o=e)._value),l=i,a.isNumbro(i)&&(l=i._value),l=new r(l),o._value=s.times(l).toNumber(),o;var o,i,a,s,l},divide:function(e,n){return i=n,a=t,s=new r((o=e)._value),l=i,a.isNumbro(i)&&(l=i._value),l=new r(l),o._value=s.dividedBy(l).toNumber(),o;var o,i,a,s,l},set:function(e,n){return r=e,i=o=n,t.isNumbro(o)&&(i=o._value),r._value=i,r;var r,o,i},difference:function(e,n){return r=n,o(a=(i=t)(e._value),r,i),Math.abs(a._value);var r,i,a}}}},{"bignumber.js":1}],7:[function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=t("./globalState"),i=t("./validating"),a=t("./loading")(d),s=t("./unformatting"),l=t("./formatting")(d),u=t("./manipulating")(d),c=t("./parsing"),f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=e}var e,n;return e=t,(n=[{key:"clone",value:function(){return d(this._value)}},{key:"format",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l.format(this,t)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=c.parseFormat(t)),(t=l.formatOrDefault(t,o.currentCurrencyDefaultFormat())).output="currency",l.format(this,t)}},{key:"formatTime",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",l.format(this,t)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(t){return u.difference(this,t)}},{key:"add",value:function(t){return u.add(this,t)}},{key:"subtract",value:function(t){return u.subtract(this,t)}},{key:"multiply",value:function(t){return u.multiply(this,t)}},{key:"divide",value:function(t){return u.divide(this,t)}},{key:"set",value:function(t){return u.set(this,h(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&r(e.prototype,n),t}();function h(t){var e=t;return d.isNumbro(t)?e=t._value:"string"==typeof t?e=d.unformat(t):isNaN(t)&&(e=NaN),e}function d(t){return new f(h(t))}d.version="2.1.2",d.isNumbro=function(t){return t instanceof f},d.language=o.currentLanguage,d.registerLanguage=o.registerLanguage,d.setLanguage=o.setLanguage,d.languages=o.languages,d.languageData=o.languageData,d.zeroFormat=o.setZeroFormat,d.defaultFormat=o.currentDefaults,d.setDefaults=o.setDefaults,d.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,d.validate=i.validate,d.loadLanguagesInNode=a.loadLanguagesInNode,d.unformat=s.unformat,e.exports=d},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,n){"use strict";e.exports={parseFormat:function(t){var e,n,r,o,i,a,s,l,u,c,f,h,d,p,g,v,y,m,b,w,O=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(n=O,i=O,function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return-1!==t.indexOf("bd")?(e.output="byte",e.base="general"):-1!==t.indexOf("b")?(e.output="byte",e.base="binary"):-1!==t.indexOf("d")?(e.output="byte",e.base="decimal"):-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time";e.output="percent"}else e.output="currency"}(t=(a=(o=t=(r=(e=t).match(/^{([^}]*)}/))?(n.prefix=r[1],e.slice(r[0].length)):e).match(/{([^}]*)}$/))?(i.postfix=a[1],o.slice(0,-a[0].length)):o,O),s=O,(l=t.match(/[1-9]+[0-9]*/))&&(s.totalLength=+l[0]),u=O,(c=t.split(".")[0].match(/0+/))&&(u.characteristic=c[0].length),function(t,e){if(-1!==t.indexOf(".")){var n=t.split(".")[0];e.optionalCharacteristic=-1===n.indexOf("0")}}(t,O),f=O,-1!==t.indexOf("a")&&(f.average=!0),d=O,-1!==(h=t).indexOf("K")?d.forceAverage="thousand":-1!==h.indexOf("M")?d.forceAverage="million":-1!==h.indexOf("B")?d.forceAverage="billion":-1!==h.indexOf("T")&&(d.forceAverage="trillion"),function(t,e){var n=t.split(".")[1];if(n){var r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}(t,O),g=O,(p=t).match(/\[\.]/)?g.optionalMantissa=!0:p.match(/\./)&&(g.optionalMantissa=!1),v=O,-1!==t.indexOf(",")&&(v.thousandSeparated=!0),y=O,-1!==t.indexOf(" ")&&(y.spaceSeparated=!0),b=O,(m=t).match(/^\+?\([^)]*\)$/)&&(b.negative="parenthesis"),m.match(/^\+?-/)&&(b.negative="sign"),w=O,t.match(/^\+/)&&(w.forceSign=!0),O)}}},{}],9:[function(t,e,n){"use strict";var r=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}e.exports={unformat:function(e,n){var i,a,s,l=t("./globalState"),u=l.currentDelimiters(),c=l.currentCurrency().symbol,f=l.currentOrdinal(),h=l.getZeroFormat(),d=l.currentAbbreviations(),p=void 0;if("string"==typeof e)p=function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var n=t.split(":");if(3!==n.length)return!1;var r=+n[0],o=+n[1],i=+n[2];return!isNaN(r)&&!isNaN(o)&&!isNaN(i)}(e,u)?(a=+(i=e.split(":"))[0],s=+i[1],+i[2]+60*s+3600*a):function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=3<arguments.length?arguments[3]:void 0,a=4<arguments.length?arguments[4]:void 0,s=5<arguments.length?arguments[5]:void 0,l=6<arguments.length?arguments[6]:void 0;if(""!==t)return t===a?0:function t(e,n){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",a=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,u=6<arguments.length?arguments[6]:void 0;if(!isNaN(+e))return+e;var c="",f=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(f!==e)return-1*t(f,n,i,a,s,l,u);for(var h=0;h<r.length;h++){var d=r[h];if((c=e.replace(d.key,""))!==e)return t(c,n,i,a,s,l,u)*d.factor}if((c=e.replace("%",""))!==e)return t(c,n,i,a,s,l,u)/100;var p=parseFloat(e);if(!isNaN(p)){var g=a(p);if(g&&"."!==g&&(c=e.replace(new RegExp("".concat(o(g),"$")),""))!==e)return t(c,n,i,a,s,l,u);var v={};Object.keys(l).forEach((function(t){v[l[t]]=t}));for(var y=Object.keys(v).sort().reverse(),m=y.length,b=0;b<m;b++){var w=y[b],O=v[w];if((c=e.replace(w,""))!==e){var C=void 0;switch(O){case"thousand":C=Math.pow(10,3);break;case"million":C=Math.pow(10,6);break;case"billion":C=Math.pow(10,9);break;case"trillion":C=Math.pow(10,12)}return t(c,n,i,a,s,l,u)*C}}}}(function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=t.replace(n,"");return(r=r.replace(new RegExp("([0-9])".concat(o(e.thousands),"([0-9])"),"g"),"$1$2")).replace(e.decimal,".")}(t,e,n),e,n,i,a,s,l)}(e,u,c,f,h,d,n);else{if("number"!=typeof e)return;p=e}if(void 0!==p)return p}}},{"./globalState":4}],10:[function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=t("./unformatting"),a=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,s={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return 0<=t},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(a)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function u(t){return!!i.unformat(t)}function c(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=Object.keys(t).map((function(r){if(!e[r])return console.error("".concat(n," Invalid key: ").concat(r)),!1;var i=t[r],a=e[r];if("string"==typeof a&&(a={type:a}),"format"===a.type){if(!c(i,s,"[Validate ".concat(r,"]"),!0))return!1}else if(o(i)!==a.type)return console.error("".concat(n," ").concat(r,' type mismatched: "').concat(a.type,'" expected, "').concat(o(i),'" provided')),!1;if(a.restrictions&&a.restrictions.length)for(var l=a.restrictions.length,u=0;u<l;u++){var f=a.restrictions[u],h=f.restriction,d=f.message;if(!h(i,t))return console.error("".concat(n," ").concat(r," invalid value: ").concat(d)),!1}return a.restriction&&!a.restriction(i,t)?(console.error("".concat(n," ").concat(r," invalid value: ").concat(a.message)),!1):a.validValues&&-1===a.validValues.indexOf(i)?(console.error("".concat(n," ").concat(r," invalid value: must be among ").concat(JSON.stringify(a.validValues),', "').concat(i,'" provided')),!1):!(a.children&&!c(i,a.children,"[Validate ".concat(r,"]")))}));return i||a.push.apply(a,r(Object.keys(e).map((function(r){var o=e[r];if("string"==typeof o&&(o={type:o}),o.mandatory){var i=o.mandatory;if("function"==typeof i&&(i=i(t)),i&&void 0===t[r])return console.error("".concat(n,' Missing mandatory key "').concat(r,'"')),!1}return!0})))),a.reduce((function(t,e){return t&&e}),!0)}function f(t){return c(t,s,"[Validate format]")}e.exports={validate:function(t,e){var n=u(t),r=f(e);return n&&r},validateFormat:f,validateInput:u,validateLanguage:function(t){return c(t,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},function(t,e,n){"use strict";(function(t,r){n.d(e,"a",(function(){return F}));n(10),n(11),n(12),n(27),n(30),n(23),n(7),n(85),n(45),n(92),n(93),n(5),n(33),n(15),n(8),n(58),n(9),n(244),n(47);var o=n(0),i=n(95),a=n(29),s=n(34),l=n(13),u=n(39),c=n(226),f=n(220),h=n(22),d=n(2),p=n(1),g=n(86),v=n(19),y=n(41),m=n(56),b=n(40),w=n(4),O=n(221),C=n(222),E=n(74),S=n(73),k=n(97),R=n(6),_=n(20),T=n(154),M=n(87),A=n(155),N=n(76),j=n(112),x=n(82),I=n(102);function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function L(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var H=null;function F(e,n){var F,B,U,W,V,Y=this,z=arguments.length>2&&void 0!==arguments[2]&&arguments[2],G=!1,X=this,q=function(){},K=new h.a(X);Object(d.extend)(q.prototype,T.a.prototype),Object(d.extend)(q.prototype,n),Object(d.extend)(q.prototype,ot(n)),Object(j.a)(q.prototype,n.language),Object(k.a)(z)&&Object(k.c)(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Object(x.b)(this.rootDocument),this.isDestroyed=!1,this.isHotTableEnv=Object(o.isChildOfWebComponentTable)(this.rootElement),h.a.isHotTableEnv=this.isHotTableEnv,this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),Object(k.b)(this)&&Object(l._injectProductInfo)(n.licenseKey,e),this.guid="ht_".concat(Object(b.randomString)());var $=Object(S.a)(X);U=new C.a(X),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),F={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width","language"],settings:new q,selRange:null,isPopulated:null,scrollable:null,firstRun:!0};var Q=new I.a(F.settings,{countCols:function(){return X.countCols()},countRows:function(){return X.countRows()},propToCol:function(t){return B.propToCol(t)},isEditorOpened:function(){return!!X.getActiveEditor()&&X.getActiveEditor().isOpened()}});function Z(t){var e=Object(j.c)(t);Object(N.d)(e)?(X.runHooks("beforeLanguageChange",e),q.prototype.language=e,X.runHooks("afterLanguageChange",e)):Object(j.d)(t)}function J(){var t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function tt(t){var e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function et(t,e,n){if(t.length){var r=X.getActiveEditor(),i=X.runHooks("beforeChange",t,e||"edit"),l=!0;if(Object(a.isFunction)(i))Object(s.b)("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed).");else if(!1===i)return void(r&&r.cancelChanges());var u,c=new J;c.onQueueEmpty=function(t){r&&l&&r.cancelChanges(),n(t)};for(var f=t.length-1;f>=0;f--)if(null===t[f])t.splice(f,1);else{var h=P(t[f],4),d=h[0],p=h[1],g=h[3],v=B.propToCol(p),y=X.getCellMeta(d,v);"numeric"===y.type&&"string"==typeof g&&((u=g).length>0&&/^\s*[+-.]?\s*(?:(?:\d+(?:(\.|,)\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/.test(u))&&(t[f][3]=tt(g)),X.getCellValidator(y)&&(c.addValidatorToQueue(),X.validateCell(t[f][3],y,function(e,n){return function(r){if("boolean"!=typeof r)throw new Error("Validation error: result is not boolean");if(!1===r&&!1===n.allowInvalid){l=!1,t.splice(e,1),n.valid=!0;var i=X.getCell(n.visualRow,n.visualCol);null!==i&&Object(o.removeClass)(i,X.getSettings().invalidCellClassName)}c.removeValidatorFormQueue()}}(f,y),e))}c.checkIfQueueIsEmpty()}}function nt(t,e){var n=t.length-1;if(!(n<0)){for(;n>=0;n--){var r=!1;if(null!==t[n]){if(null!==t[n][2]&&void 0!==t[n][2]||null!==t[n][3]&&void 0!==t[n][3]){if(F.settings.allowInsertRow)for(;t[n][0]>X.countRows()-1;){if(0===B.createRow(void 0,void 0,e)){r=!0;break}}if("array"===X.dataType&&(!F.settings.columns||0===F.settings.columns.length)&&F.settings.allowInsertColumn)for(;B.propToCol(t[n][1])>X.countCols()-1;){if(0===B.createCol(void 0,void 0,e)){r=!0;break}}r||B.set(t[n][0],t[n][1],t[n][3])}}else t.splice(n,1)}X.forceFullRender=!0,W.adjustRowsAndCols(),X.runHooks("beforeChangeRender",t,e),V.lockEditor(),X._refreshBorders(null),V.unlockEditor(),X.view.wt.wtOverlays.adjustElementsSize(),X.runHooks("afterChange",t,e||"edit");var o=X.getActiveEditor();o&&Object(l.isDefined)(o.refreshValue)&&o.refreshValue()}}function rt(t,e,n){return"object"===D(t)?t:[[t,e,n]]}function ot(t){if(Object(d.hasOwnProperty)(t,"type")){var e,n={};for(var r in"object"===D(t.type)?e=t.type:"string"==typeof t.type&&(e=Object(M.a)(t.type)),e)Object(d.hasOwnProperty)(e,r)&&!Object(d.hasOwnProperty)(t,r)&&(n[r]=e[r]);return n}}this.selection=Q,this.selection.addLocalHook("beforeSetRangeStart",(function(t){Y.runHooks("beforeSetRangeStart",t)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(t){Y.runHooks("beforeSetRangeStartOnly",t)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(t){Y.runHooks("beforeSetRangeEnd",t),t.row<0&&(t.row=Y.view.wt.wtTable.getFirstVisibleRow()),t.col<0&&(t.col=Y.view.wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(t){var e=Object(d.createObjectPropListener)(!1),n=Y.selection.getSelectedRange(),r=n.current(),i=r.from,a=r.to,s=n.size()-1;Y.runHooks("afterSelection",i.row,i.col,a.row,a.col,e,s),Y.runHooks("afterSelectionByProp",i.row,X.colToProp(i.col),a.row,X.colToProp(a.col),e,s);var l=Y.selection.isSelectedByAnyHeader(),u=Y.selection.selectedRange.current(),c=!0;G&&(c=!1),e.isTouched()&&(c=!e.value);var f=Y.selection.isSelectedByRowHeader(),h=Y.selection.isSelectedByColumnHeader();!1!==c&&(l?f?Y.view.scrollViewportVertically(t.row):h&&Y.view.scrollViewportHorizontally(t.col):u&&!Y.selection.isMultiple()?Y.view.scrollViewport(u.from):Y.view.scrollViewport(t)),f&&h?Object(o.addClass)(Y.rootElement,["ht__selection--rows","ht__selection--columns"]):f?(Object(o.removeClass)(Y.rootElement,"ht__selection--columns"),Object(o.addClass)(Y.rootElement,"ht__selection--rows")):h?(Object(o.removeClass)(Y.rootElement,"ht__selection--rows"),Object(o.addClass)(Y.rootElement,"ht__selection--columns")):Object(o.removeClass)(Y.rootElement,["ht__selection--rows","ht__selection--columns"]),Y._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(t){var e=t.length-1,n=t[e],r=n.from,o=n.to;Y.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,e),Y.runHooks("afterSelectionEndByProp",r.row,X.colToProp(r.col),o.row,X.colToProp(o.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(t){var e=Y.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(t){Y.runHooks("modifyTransformStart",t)})),this.selection.addLocalHook("afterModifyTransformStart",(function(t,e,n){Y.runHooks("afterModifyTransformStart",t,e,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(t){Y.runHooks("modifyTransformEnd",t)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(t,e,n){Y.runHooks("afterModifyTransformEnd",t,e,n)})),this.selection.addLocalHook("afterDeselect",(function(){V.destroyEditor(),Y._refreshBorders(),Object(o.removeClass)(Y.rootElement,["ht__selection--rows","ht__selection--columns"]),Y.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(t){Y.alter("insert_row",t,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(t){Y.alter("insert_col",t,1,"auto")})),W={alter:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;function a(t,e,n,r){var o=Object(p.arrayMap)(new Array(n),(function(){return"array"===r?t=[]:"object"===r&&(t={}),t;var t}));o.unshift(e,0),t.splice.apply(t,L(o))}var s=function(t){if(0===t.length)return[];var e=L(t);return e.sort((function(t,e){var n=P(t,1)[0],r=P(e,1)[0];return n===r?0:n>r?1:-1})),Object(p.arrayReduce)(e,(function(t,e){var n=P(e,2),r=n[0],o=n[1],i=t[t.length-1],a=P(i,2),s=a[0]+a[1];if(r<=s){var l=Math.max(o-(s-r),0);i[1]+=l}else t.push([r,o]);return t}),[e[0]])};switch(t){case"insert_row":var u=X.countSourceRows();if(X.getSettings().maxRows===u)return;e=Object(l.isDefined)(e)?e:u,n=B.createRow(e,r,o),a(F.cellSettings,e,r,"array"),n&&(Q.isSelected()&&Q.selectedRange.current().from.row>=e?(Q.selectedRange.current().from.row+=n,Q.transformEnd(n,0)):X._refreshBorders());break;case"insert_col":n=B.createCol(e,r,o);for(var c=0,f=X.countSourceRows();c<f;c++)F.cellSettings[c]&&a(F.cellSettings[c],e,r);if(n){if(Array.isArray(X.getSettings().colHeaders)){var h=[e,0];h.length+=n,Array.prototype.splice.apply(X.getSettings().colHeaders,h)}Q.isSelected()&&Q.selectedRange.current().from.col>=e?(Q.selectedRange.current().from.col+=n,Q.transformEnd(0,n)):X._refreshBorders()}break;case"remove_row":var d=function(t){var e=0;Object(p.arrayEach)(t,(function(t){var n=P(t,2),i=n[0],a=n[1],s=Object(l.isEmpty)(i)?X.countRows()-1:Math.max(i-e,0);Number.isInteger(i)&&(i=Math.max(i-e,0)),B.removeRow(i,a,o),F.cellSettings.splice(s,r);var u=X.countRows(),c=X.getSettings().fixedRowsTop;c>=s+1&&(X.getSettings().fixedRowsTop-=Math.min(a,c-s));var f=X.getSettings().fixedRowsBottom;f&&s>=u-f&&(X.getSettings().fixedRowsBottom-=Math.min(a,f)),e+=a}))};Array.isArray(e)?d(s(e)):d([[e,r]]),W.adjustRowsAndCols(),X._refreshBorders();break;case"remove_col":var g=function(t){var e=0;Object(p.arrayEach)(t,(function(t){var n=P(t,2),r=n[0],i=n[1],a=Object(l.isEmpty)(r)?X.countCols()-1:Math.max(r-e,0),s=$.toPhysicalColumn(a);Number.isInteger(r)&&(r=Math.max(r-e,0)),B.removeCol(r,i,o);for(var u=0,c=X.countSourceRows();u<c;u++)F.cellSettings[u]&&F.cellSettings[u].splice(s,i);var f=X.getSettings().fixedColumnsLeft;f>=a+1&&(X.getSettings().fixedColumnsLeft-=Math.min(i,f-a)),Array.isArray(X.getSettings().colHeaders)&&(void 0===s&&(s=-1),X.getSettings().colHeaders.splice(s,i)),e+=i}))};Array.isArray(e)?g(s(e)):g([[e,r]]),W.adjustRowsAndCols(),X._refreshBorders();break;default:throw new Error('There is no such action "'.concat(t,'"'))}i||W.adjustRowsAndCols()},adjustRowsAndCols:function(){if(F.settings.minRows){var t=X.countRows();if(t<F.settings.minRows)for(var e=0,n=F.settings.minRows;e<n-t;e++)B.createRow(X.countRows(),1,"auto")}if(F.settings.minSpareRows){var r=X.countEmptyRows(!0);if(r<F.settings.minSpareRows)for(;r<F.settings.minSpareRows&&X.countSourceRows()<F.settings.maxRows;r++)B.createRow(X.countRows(),1,"auto")}var o;if((F.settings.minCols||F.settings.minSpareCols)&&(o=X.countEmptyCols(!0)),F.settings.minCols&&!F.settings.columns&&X.countCols()<F.settings.minCols)for(;X.countCols()<F.settings.minCols;o++)B.createCol(X.countCols(),1,"auto");if(F.settings.minSpareCols&&!F.settings.columns&&"array"===X.dataType&&o<F.settings.minSpareCols)for(;o<F.settings.minSpareCols&&X.countCols()<F.settings.maxCols;o++)B.createCol(X.countCols(),1,"auto");var i=X.countRows(),a=X.countCols();0!==i&&0!==a||Q.deselect(),Q.isSelected()&&Object(p.arrayEach)(Q.selectedRange,(function(t){var e=!1,n=t.from.row,r=t.from.col,o=t.to.row,s=t.to.col;n>i-1?(e=!0,o>(n=i-1)&&(o=n)):o>i-1&&(e=!0,n>(o=i-1)&&(n=o)),r>a-1?(e=!0,s>(r=a-1)&&(s=r)):s>a-1&&(e=!0,r>(s=a-1)&&(r=s)),e&&X.selectCell(n,r,o,s)})),X.view&&X.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(t,e,n,r,o,i,a){var s,u,c,f,h,p,g,v,y=[],m={};if(0===(u=e.length))return!1;switch(o){case"shift_down":for(h=n?n.col-t.col+1:0,p=n?n.row-t.row+1:0,c=0,f=(e=Object(E.translateRowsToColumns)(e)).length,g=Math.max(f,h);c<g;c++)if(c<f){var b;for(s=0,u=e[c].length;s<p-u;s++)e[c].push(e[c][s%u]);e[c].unshift(t.col+c,t.row,0),(b=X).spliceCol.apply(b,L(e[c]))}else{var w;e[c%f][0]=t.col+c,(w=X).spliceCol.apply(w,L(e[c%f]))}break;case"shift_right":for(h=n?n.col-t.col+1:0,p=n?n.row-t.row+1:0,s=0,u=e.length,v=Math.max(u,p);s<v;s++)if(s<u){var O;for(c=0,f=e[s].length;c<h-f;c++)e[s].push(e[s][c%f]);e[s].unshift(t.row+s,t.col,0),(O=X).spliceRow.apply(O,L(e[s]))}else{var C;e[s%u][0]=t.row+s,(C=X).spliceRow.apply(C,L(e[s%u]))}break;case"overwrite":default:m.row=t.row,m.col=t.col;var S,k={row:n&&t?n.row-t.row+1:1,col:n&&t?n.col-t.col+1:1},R=0,_=0,T=!0,M=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e[t%e.length];return null!==n?r[n%r.length]:r},A=e.length,N=n?n.row-t.row+1:0;for(u=n?N:Math.max(A,N),s=0;s<u&&!(n&&m.row>n.row&&N>A||!F.settings.allowInsertRow&&m.row>X.countRows()-1||m.row>=F.settings.maxRows);s++){var j=s-R,x=M(j).length,I=n?n.col-t.col+1:0;if(f=n?I:Math.max(x,I),m.col=t.col,S=X.getCellMeta(m.row,m.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!S.skipRowOnPaste){for(_=0,c=0;c<f&&!(n&&m.col>n.col&&I>x||!F.settings.allowInsertColumn&&m.col>X.countCols()-1||m.col>=F.settings.maxCols);c++)if(S=X.getCellMeta(m.row,m.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!S.skipColumnOnPaste)if(S.readOnly)m.col+=1;else{var P=c-_,H=M(j,P),B=X.getDataAtCell(m.row,m.col),U={row:j,col:P};if("Autofill.fill"===r){var W=X.runHooks("beforeAutofillInsidePopulate",U,i,e,a,{},k);W&&(H=Object(l.isUndefined)(W.value)?H:W.value)}if(null!==H&&"object"===D(H))if(Array.isArray(H)&&null===B&&(B=[]),null===B||"object"!==D(B))T=!1;else{var V=Object(d.duckSchema)(Array.isArray(B)?B:B[0]||B),Y=Object(d.duckSchema)(Array.isArray(H)?H:H[0]||H);Object(d.isObjectEqual)(V,Y)?H=Object(d.deepClone)(H):T=!1}else null!==B&&"object"===D(B)&&(T=!1);T&&y.push([m.row,m.col,H]),T=!0,m.col+=1}else _+=1,m.col+=1,f+=1;m.row+=1}else R+=1,m.row+=1,u+=1}X.setDataAtCell(y,null,null,r||"populateFromArray")}}},this.init=function(){U.setData(F.settings.data),X.runHooks("beforeInit"),Object(u.isMobileBrowser)()&&Object(o.addClass)(X.rootElement,"mobile"),this.updateSettings(F.settings,!0),this.view=new O.a(this),V=f.a.getInstance(X,F,Q,B),this.forceFullRender=!0,X.runHooks("init"),this.view.render(),"object"===D(F.firstRun)&&(X.runHooks("afterChange",F.firstRun[0],F.firstRun[1]),F.firstRun=!1),X.runHooks("afterInit")},this.validateCell=function(t,e,n,r){var o,i=X.getCellValidator(e);function s(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r&&!0!==e.hidden){var o=e.visualCol,i=e.visualRow,a=X.getCell(i,o,!0);a&&"TH"!==a.nodeName&&X.view.wt.wtSettings.settings.cellRenderer(i,o,a),n(t)}else n(t)}Object(l.isRegExp)(i)&&(o=i,i=function(t,e){e(o.test(t))}),Object(a.isFunction)(i)?(t=X.runHooks("beforeValidate",t,e.visualRow,e.prop,r),X._registerImmediate((function(){i.call(e,t,(function(n){X&&(n=X.runHooks("afterValidate",n,t,e.visualRow,e.prop,r),e.valid=n,s(n),X.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,r))}))}))):X._registerImmediate((function(){e.valid=!0,s(e.valid,!1)}))},this.setDataAtCell=function(t,e,n,r){var o,i,a,s=rt(t,e,n),l=[],u=r;for(o=0,i=s.length;o<i;o++){if("object"!==D(s[o]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof s[o][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");var c=$.toPhysicalRow(s[o][0]);a=B.colToProp(s[o][1]),l.push([s[o][0],a,U.getAtCell(c,s[o][1]),s[o][2]])}u||"object"!==D(t)||(u=e),X.runHooks("afterSetDataAtCell",l,u),et(l,u,(function(){nt(l,u)}))},this.setDataAtRowProp=function(t,e,n,r){var o,i,a=rt(t,e,n),s=[],l=r;for(o=0,i=a.length;o<i;o++){var u=$.toPhysicalRow(a[o][0]);s.push([a[o][0],a[o][1],U.getAtCell(u,a[o][1]),a[o][2]])}l||"object"!==D(t)||(l=e),X.runHooks("afterSetDataAtRowProp",s,l),et(s,l,(function(){nt(s,l)}))},this.listen=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=X,n=e.rootDocument;if(t){var r=!n.activeElement||n.activeElement&&void 0===n.activeElement.nodeName;n.activeElement&&n.activeElement!==n.body&&!r?n.activeElement.blur():r&&n.body.focus()}X&&!X.isListening()&&(H=X.guid,X.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(H=null,X.runHooks("afterUnlisten"))},this.isListening=function(){return H===X.guid},this.destroyEditor=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X._refreshBorders(t,e)},this.populateFromArray=function(t,e,n,r,o,i,a,s,l){if("object"!==D(n)||"object"!==D(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var u="number"==typeof r?new R.a(r,o):null;return W.populateFromArray(new R.a(t,e),n,u,i,a,s,l)},this.spliceCol=function(t,e,n){for(var r,o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return(r=B).spliceCol.apply(r,[t,e,n].concat(i))},this.spliceRow=function(t,e,n){for(var r,o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return(r=B).spliceRow.apply(r,[t,e,n].concat(i))},this.getSelected=function(){if(Q.isSelected())return Object(p.arrayMap)(Q.getSelectedRange(),(function(t){var e=t.from,n=t.to;return[e.row,e.col,n.row,n.col]}))},this.getSelectedLast=function(){var t,e=this.getSelected();return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(Q.isSelected())return Array.from(Q.getSelectedRange())},this.getSelectedRangeLast=function(){var t,e=this.getSelectedRange();return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(t){var e=this;if(Q.isSelected()){var n=[];Object(p.arrayEach)(Q.getSelectedRange(),(function(t){var r=t.getTopLeftCorner(),o=t.getBottomRightCorner();Object(w.rangeEach)(r.row,o.row,(function(t){Object(w.rangeEach)(r.col,o.col,(function(r){e.getCellMeta(t,r).readOnly||n.push([t,r,null])}))}))})),n.length>0&&this.setDataAtCell(n,t)}},this.render=function(){X.view&&(X.renderCall=!0,X.forceFullRender=!0,V.lockEditor(),X._refreshBorders(null),V.unlockEditor())},this.refreshDimensions=function(){if(X.view){var t=X.view.getLastSize(),e=t.width,n=t.height,r=X.rootElement.getBoundingClientRect(),o=r.width,i=r.height,a=o!==e||i!==n;!1===X.runHooks("beforeRefreshDimensions",{width:e,height:n},{width:o,height:i},a)||((a||X.view.wt.wtOverlays.scrollableElement===X.rootWindow)&&(X.view.setLastSize(o,i),X.render()),X.runHooks("afterRefreshDimensions",{width:e,height:n},{width:o,height:i},a))}},this.loadData=function(t){if(Array.isArray(F.settings.dataSchema)?X.dataType="array":Object(a.isFunction)(F.settings.dataSchema)?X.dataType="function":X.dataType="object",B&&B.destroy(),B=new c.a(X,F,q),"object"===D(t)&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error("loadData only accepts array of objects or array of arrays (".concat(D(t)," given)"));var e,n=B.getSchema();t=[];var r,o=0;for(o=0,r=F.settings.startRows;o<r;o++)if("object"!==X.dataType&&"function"!==X.dataType||!F.settings.dataSchema)if("array"===X.dataType)e=Object(d.deepClone)(n[0]),t.push(e);else{e=[];for(var i=0,s=F.settings.startCols;i<s;i++)e.push(null);t.push(e)}else e=Object(d.deepClone)(n),t.push(e)}F.isPopulated=!1,q.prototype.data=t,Array.isArray(t[0])&&(X.dataType="array"),B.dataSource=t,U.data=t,U.dataType=X.dataType,U.colToProp=B.colToProp.bind(B),U.propToCol=B.propToCol.bind(B),F.cellSettings.length=0,W.adjustRowsAndCols(),X.runHooks("afterLoadData",F.firstRun),F.firstRun?F.firstRun=[null,"loadData"]:(X.runHooks("afterChange",null,"loadData"),X.render()),F.isPopulated=!0},this.getData=function(t,e,n,r){return Object(l.isUndefined)(t)?B.getAll():B.getRange(new R.a(t,e),new R.a(n,r),B.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,r){return B.getCopyableText(new R.a(t,e),new R.a(n,r))},this.getCopyableData=function(t,e){return B.getCopyable(t,B.colToProp(e))},this.getSchema=function(){return B.getSchema()},this.updateSettings=function(t){var e,n,r,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],u=!1;if(Object(l.isDefined)(t.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(Object(l.isDefined)(t.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(e in t)"data"!==e&&("language"!==e?_.a.getSingleton().getRegistered().indexOf(e)>-1?(Object(a.isFunction)(t[e])||Array.isArray(t[e]))&&(t[e].initialHook=!0,X.addHook(e,t[e])):!s&&Object(d.hasOwnProperty)(t,e)&&(q.prototype[e]=t[e]):Z(t.language));void 0===t.data&&void 0===F.settings.data?X.loadData(null):void 0!==t.data?X.loadData(t.data):void 0!==t.columns&&B.createMap(),r=X.countCols();var c,f,h=t.columns||q.prototype.columns;if(h&&Object(a.isFunction)(h)&&(r=X.countSourceCols(),u=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||(F.cellSettings.length=0),r>0)for(e=0,n=0;e<r;e++)u&&!h(e)||(F.columnSettings[n]=Object(i.columnFactory)(q,F.columnsSettingConflicts),c=F.columnSettings[n].prototype,h&&(f=u?h(e):h[n])&&(Object(d.extend)(c,f),Object(d.extend)(c,ot(f))),n+=1);Object(l.isDefined)(t.cell)&&Object(d.objectEach)(t.cell,(function(t){X.setCellMetaObject(t.row,t.col,t)})),X.runHooks("afterCellMetaReset"),Object(l.isDefined)(t.className)&&(q.prototype.className&&Object(o.removeClass)(X.rootElement,q.prototype.className),t.className&&Object(o.addClass)(X.rootElement,t.className));var p=X.rootElement.style.height;""!==p&&(p=parseInt(X.rootElement.style.height,10));var g=t.height;if(Object(a.isFunction)(g)&&(g=g()),s){var v=X.rootElement.getAttribute("style");v&&X.rootElement.setAttribute("data-initialstyle",X.rootElement.getAttribute("style"))}if(null===g){var y=X.rootElement.getAttribute("data-initialstyle");y&&(y.indexOf("height")>-1||y.indexOf("overflow")>-1)?X.rootElement.setAttribute("style",y):(X.rootElement.style.height="",X.rootElement.style.overflow="")}else void 0!==g&&(X.rootElement.style.height=isNaN(g)?"".concat(g):"".concat(g,"px"),X.rootElement.style.overflow="hidden");if(void 0!==t.width){var m=t.width;Object(a.isFunction)(m)&&(m=m()),X.rootElement.style.width=isNaN(m)?"".concat(m):"".concat(m,"px")}s||(B.clearLengthCache(),X.view&&X.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),X.runHooks("afterUpdateSettings",t)),W.adjustRowsAndCols(),X.view&&!F.firstRun&&(X.forceFullRender=!0,V.lockEditor(),X._refreshBorders(null),V.unlockEditor()),s||!X.view||""!==p&&""!==g&&void 0!==g||p===g||X.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var t=X.getSelectedLast();if(q.prototype.getValue){if(Object(a.isFunction)(q.prototype.getValue))return q.prototype.getValue.call(X);if(t)return X.getData()[t[0][0]][q.prototype.getValue]}else if(t)return X.getDataAtCell(t[0],t[1])},this.getSettings=function(){return F.settings},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,r,o){W.alter(t,e,n,r,o)},this.getCell=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return X.view.getCellAtCoords(new R.a(t,e),n)},this.getCoords=function(t){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,t)},this.colToProp=function(t){return B.colToProp(t)},this.propToCol=function(t){return B.propToCol(t)},this.toVisualRow=function(t){return $.toVisualRow(t)},this.toVisualColumn=function(t){return $.toVisualColumn(t)},this.toPhysicalRow=function(t){return $.toPhysicalRow(t)},this.toPhysicalColumn=function(t){return $.toPhysicalColumn(t)},this.getDataAtCell=function(t,e){return B.get(t,B.colToProp(e))},this.getDataAtRowProp=function(t,e){return B.get(t,e)},this.getDataAtCol=function(t){var e;return(e=[]).concat.apply(e,L(B.getRange(new R.a(0,t),new R.a(F.settings.data.length-1,t),B.DESTINATION_RENDERER)))},this.getDataAtProp=function(t){var e,n=B.getRange(new R.a(0,B.propToCol(t)),new R.a(F.settings.data.length-1,B.propToCol(t)),B.DESTINATION_RENDERER);return(e=[]).concat.apply(e,L(n))},this.getSourceData=function(t,e,n,r){return void 0===t?U.getData():U.getByRange(new R.a(t,e),new R.a(n,r))},this.getSourceDataArray=function(t,e,n,r){return void 0===t?U.getData(!0):U.getByRange(new R.a(t,e),new R.a(n,r),!0)},this.getSourceDataAtCol=function(t){return U.getAtColumn(t)},this.getSourceDataAtRow=function(t){return U.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return U.getAtCell(t,e)},this.getDataAtRow=function(t){return B.getRange(new R.a(t,0),new R.a(t,this.countCols()-1),B.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,n,r){var o=this,i=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,n,r],a=i[0],s=i[1],l=i[2],u=i[3],c=null,f=null;void 0===l&&(l=a),void 0===u&&(u=s);var h="mixed";return Object(w.rangeEach)(Math.min(a,l),Math.max(a,l),(function(t){var e=!0;return Object(w.rangeEach)(Math.min(s,u),Math.max(s,u),(function(n){var r=o.getCellMeta(t,n);return f=r.type,c?e=c===f:c=f,e})),h=e?f:"mixed",e})),h},this.removeCellMeta=function(t,e,n){var r=P($.toPhysical(t,e),2),o=r[0],i=r[1],a=F.cellSettings[o][i][n];!1!==X.runHooks("beforeRemoveCellMeta",t,e,n,a)&&(delete F.cellSettings[o][i][n],X.runHooks("afterRemoveCellMeta",t,e,n,a)),a=null},this.spliceCellsMeta=function(t,e){for(var n,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];(n=F.cellSettings).splice.apply(n,[t,e].concat(o))},this.setCellMetaObject=function(t,e,n){var r=this;"object"===D(n)&&Object(d.objectEach)(n,(function(n,o){r.setCellMeta(t,e,o,n)}))},this.setCellMeta=function(t,e,n,r){var o=P($.toPhysical(t,e),2),a=o[0],s=o[1];F.columnSettings[s]||(F.columnSettings[s]=Object(i.columnFactory)(q,F.columnsSettingConflicts)),F.cellSettings[a]||(F.cellSettings[a]=[]),F.cellSettings[a][s]||(F.cellSettings[a][s]=new F.columnSettings[s]),F.cellSettings[a][s][n]=r,X.runHooks("afterSetCellMeta",t,e,n,r)},this.getCellsMeta=function(){return Object(p.arrayFlatten)(F.cellSettings)},this.getCellMeta=function(t,e){var n=B.colToProp(e),r=P($.toPhysical(t,e),2),o=r[0],a=r[1],s=o;null===s&&(s=t),F.columnSettings[a]||(F.columnSettings[a]=Object(i.columnFactory)(q,F.columnsSettingConflicts)),F.cellSettings[s]||(F.cellSettings[s]=[]),F.cellSettings[s][a]||(F.cellSettings[s][a]=new F.columnSettings[a]);var l=F.cellSettings[s][a];if(l.row=s,l.col=a,l.visualRow=t,l.visualCol=e,l.prop=n,l.instance=X,X.runHooks("beforeGetCellMeta",t,e,l),Object(d.extend)(l,ot(l)),l.cells){var u=l.cells.call(l,s,a,n);u&&(Object(d.extend)(l,u),Object(d.extend)(l,ot(u)))}return X.runHooks("afterGetCellMeta",t,e,l),l},this.getCellMetaAtRow=function(t){return F.cellSettings[t]},this.isColumnModificationAllowed=function(){return!("object"===X.dataType||X.getSettings().columns)};var it=Object(E.cellMethodLookupFactory)("renderer");this.getCellRenderer=function(t,e){return Object(y.b)(it.call(this,t,e))},this.getCellEditor=Object(E.cellMethodLookupFactory)("editor");var at=Object(E.cellMethodLookupFactory)("validator");function st(t){return function(){throw new Error('The "'.concat(t,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getCellValidator=function(t,e){var n=at.call(this,t,e);return"string"==typeof n&&(n=Object(m.b)(n)),n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){var r=new J;t&&(r.onQueueEmpty=t);for(var o=X.countRows()-1;o>=0;)if(void 0===e||-1!==e.indexOf(o)){for(var i=X.countCols()-1;i>=0;)void 0===n||-1!==n.indexOf(i)?(r.addValidatorToQueue(),X.validateCell(X.getDataAtCell(o,i),X.getCellMeta(o,i),(function(t){if("boolean"!=typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),i-=1):i-=1;o-=1}else o-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(t){var e=F.settings.rowHeaders,n=t;return void 0!==n&&(n=X.runHooks("modifyRowHeader",n)),void 0===n?(e=[],Object(w.rangeEach)(X.countRows()-1,(function(t){e.push(X.getRowHeader(t))}))):Array.isArray(e)&&void 0!==e[n]?e=e[n]:Object(a.isFunction)(e)?e=e(n):e&&"string"!=typeof e&&"number"!=typeof e&&(e=n+1),e},this.hasRowHeaders=function(){return!!F.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==F.settings.colHeaders&&null!==F.settings.colHeaders)return!!F.settings.colHeaders;for(var t=0,e=X.countCols();t<e;t++)if(X.getColHeader(t))return!0;return!1},this.getColHeader=function(t){var e=F.settings.columns&&Object(a.isFunction)(F.settings.columns),n=X.runHooks("modifyColHeader",t),r=F.settings.colHeaders;if(void 0===n){for(var o=[],i=e?X.countSourceCols():X.countCols(),s=0;s<i;s++)o.push(X.getColHeader(s));r=o}else{var l=n,u=X.runHooks("modifyCol",l),c=function(t){for(var e=[],n=X.countSourceCols(),r=0;r<n;r++)Object(a.isFunction)(X.getSettings().columns)&&X.getSettings().columns(r)&&e.push(r);return e[t]}(u);!1===F.settings.colHeaders?r=null:F.settings.columns&&Object(a.isFunction)(F.settings.columns)&&F.settings.columns(c)&&F.settings.columns(c).title?r=F.settings.columns(c).title:F.settings.columns&&F.settings.columns[u]&&F.settings.columns[u].title?r=F.settings.columns[u].title:Array.isArray(F.settings.colHeaders)&&void 0!==F.settings.colHeaders[u]?r=F.settings.colHeaders[u]:Object(a.isFunction)(F.settings.colHeaders)?r=F.settings.colHeaders(u):F.settings.colHeaders&&"string"!=typeof F.settings.colHeaders&&"number"!=typeof F.settings.colHeaders&&(r=Object(E.spreadsheetColumnLabel)(l))}return r},this._getColWidthFromSettings=function(t){var e=X.getCellMeta(0,t),n=e.width;if(void 0!==n&&n!==F.settings.width||(n=e.colWidths),null!=n){switch(D(n)){case"object":n=n[t];break;case"function":n=n(t)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(t){var e=X._getColWidthFromSettings(t);return void 0===(e=X.runHooks("modifyColWidth",e,t))&&(e=R.d.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){var e=F.settings.rowHeights;if(null!=e){switch(D(e)){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){var e=X._getRowHeightFromSettings(t);return e=X.runHooks("modifyRowHeight",e,t)},this.countSourceRows=function(){return X.runHooks("modifySourceLength")||(X.getSourceData()?X.getSourceData().length:0)},this.countSourceCols=function(){var t=X.getSourceData()&&X.getSourceData()[0]?X.getSourceData()[0]:[];return Object(d.isObject)(t)?Object(d.deepObjectSize)(t):t.length||0},this.countRows=function(){return B.getLength()},this.countCols=function(){var t=this.getSettings().maxCols,e=!1,n=0;if("array"===X.dataType&&(e=F.settings.data&&F.settings.data[0]&&F.settings.data[0].length),e&&(n=F.settings.data[0].length),F.settings.columns)if(Object(a.isFunction)(F.settings.columns))if("array"===X.dataType){for(var r=0,o=0;o<n;o++)F.settings.columns(o)&&(r+=1);n=r}else"object"!==X.dataType&&"function"!==X.dataType||(n=B.colToPropCache.length);else n=F.settings.columns.length;else"object"!==X.dataType&&"function"!==X.dataType||(n=B.colToPropCache.length);return Math.min(t,n)},this.rowOffset=function(){return X.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return X.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return X.view.wt.drawn?X.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return X.view.wt.drawn?X.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return X.view.wt.drawn?X.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return X.view.wt.drawn?X.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Object(w.rangeEachReverse)(X.countRows()-1,(function(n){if(X.isEmptyRow(n))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(X.countRows()<1)return 0;var e=0;return Object(w.rangeEachReverse)(X.countCols()-1,(function(n){if(X.isEmptyCol(n))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return F.settings.isEmptyRow.call(X,t)},this.isEmptyCol=function(t){return F.settings.isEmptyCol.call(X,t)},this.selectCell=function(t,e,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Object(l.isUndefined)(t)&&!Object(l.isUndefined)(e)&&this.selectCells([[t,e,n,r]],o,i)},this.selectCells=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===e&&(G=!0);var r=Q.selectCells(t);return r&&n&&X.listen(),G=!1,r},this.selectColumns=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return Q.selectColumns(t,e)},this.selectRows=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return Q.selectRows(t,e)},this.deselectCell=function(){Q.deselect()},this.selectAll=function(){G=!0,Q.selectAll(),G=!1},this.scrollViewportTo=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!n,i=!r,a=!1;return void 0!==t&&void 0!==e&&(a=X.view.scrollViewport(new R.a(t,e),o,r,n,i)),"number"==typeof t&&"number"!=typeof e&&(a=X.view.scrollViewportVertically(t,o,n)),"number"==typeof e&&"number"!=typeof t&&(a=X.view.scrollViewportHorizontally(e,r,i)),a},this.destroy=function(){if(X._clearTimeouts(),X._clearImmediates(),X.view&&X.view.destroy(),U&&U.destroy(),U=null,Object(x.c)(),Object(k.b)(X)){var t=this.rootDocument.querySelector("#hot-display-license-info");t&&t.parentNode.removeChild(t)}Object(o.empty)(X.rootElement),K.destroy(),V&&V.destroy(),X.runHooks("afterDestroy"),_.a.getSingleton().destroy(X),Object(d.objectEach)(X,(function(t,e,n){Object(a.isFunction)(t)?n[e]=st(e):"guid"!==e&&(n[e]=null)})),X.isDestroyed=!0,B&&B.destroy(),B=null,F=null,W=null,Q=null,V=null,X=null,q=null},this.getActiveEditor=function(){return V.getActiveEditor()},this.getPlugin=function(t){return Object(v.a)(this,t)},this.getInstance=function(){return X},this.addHook=function(t,e){_.a.getSingleton().add(t,e,X)},this.hasHook=function(t){return _.a.getSingleton().has(t,X)},this.addHookOnce=function(t,e){_.a.getSingleton().once(t,e,X)},this.removeHook=function(t,e){_.a.getSingleton().remove(t,e,X)},this.runHooks=function(t,e,n,r,o,i,a){return _.a.getSingleton().run(X,t,e,n,r,o,i,a)},this.getTranslatedPhrase=function(t,e){return Object(A.a)(F.settings.language,t,e)},this.toHTML=function(){return Object(g.instanceToHTML)(Y)},this.toTableElement=function(){var t=Y.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",Object(g.instanceToHTML)(Y)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;"function"==typeof n&&(n=setTimeout(n,e)),this.timeouts.push(n)},this._clearTimeouts=function(){Object(p.arrayEach)(this.timeouts,(function(t){clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(t(e))},this._clearImmediates=function(){Object(p.arrayEach)(this.immediates,(function(t){r(t)}))},this._refreshBorders=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];V.destroyEditor(t),X.view.render(),e&&Q.isSelected()&&V.prepareEditor()},_.a.getSingleton().run(X,"construct")}}).call(this,n(150).setImmediate,n(150).clearImmediate)},function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var r=n(51);function o(t,e){return void 0===e&&(e=0),"string"!=typeof t||0===e?t:t.length<=e?t:t.substr(0,e)+"..."}function i(t,e){var n=t,r=n.length;if(r<=150)return n;e>r&&(e=r);var o=Math.max(e-60,0);o<5&&(o=0);var i=Math.min(o+140,r);return i>r-5&&(i=r),i===r&&(o=Math.max(i-140,0)),n=n.slice(o,i),o>0&&(n="'{snip} "+n),i<r&&(n+=" {snip}"),n}function a(t,e){if(!Array.isArray(t))return"";for(var n=[],r=0;r<t.length;r++){var o=t[r];try{n.push(String(o))}catch(t){n.push("[value cannot be serialized]")}}return n.join(e)}function s(t,e){return Object(r.j)(e)?e.test(t):"string"==typeof e&&-1!==t.indexOf(e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(42),o=Object(r.g)(),i="Sentry Logger ",a=function(){function t(){this._enabled=!1}return t.prototype.disable=function(){this._enabled=!1},t.prototype.enable=function(){this._enabled=!0},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._enabled&&Object(r.c)((function(){o.console.log(i+"[Log]: "+t.join(" "))}))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._enabled&&Object(r.c)((function(){o.console.warn(i+"[Warn]: "+t.join(" "))}))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._enabled&&Object(r.c)((function(){o.console.error(i+"[Error]: "+t.join(" "))}))},t}();o.__SENTRY__=o.__SENTRY__||{};var s=o.__SENTRY__.logger||(o.__SENTRY__.logger=new a)},function(t,e,n){"use strict";n(10),n(11),n(12),n(27),n(251),n(63),n(107),n(30),n(43),n(7),n(80),n(24),n(217),n(75),n(5),n(15),n(54),n(8),n(108),n(9);var r=n(61),o=n(6);var i=function(t){var e=t.activeHeaderClassName;return new o.c({highlightHeaderClassName:e})};var a=function(t){var e=t.layerLevel,n=t.areaCornerVisible;return new o.c({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:n}})};var s=function(t){var e=t.cellCornerVisible;return new o.c({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}})};var l=function(t){var e=t.border,n=t.cellRange;return new o.c(e,n)};var u=function(){return new o.c({className:"fill",border:{width:1,color:"#ff0000"}})};var c=function(t){var e=t.headerClassName,n=t.rowClassName,r=t.columnClassName;return new o.c({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:n,highlightColumnClassName:r})},f=Object(r.a)("highlight/types"),h=f.register,d=f.getItem;function p(t,e){return d(t)(e)}h("active-header",i),h("area",a),h("cell",s),h("custom-selection",l),h("fill",u),h("header",c);var g=n(1);function v(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var O=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,this.layerLevel=0,this.cell=p("cell",e),this.fill=p("fill",e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}var e,n,r;return e=t,(n=[{key:"isEnabledFor",value:function(t){var e="current"===t?"cell":t,n=this.options.disableHighlight;return"string"==typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(e)}},{key:"useLayerLevel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var t,e=this.layerLevel;return this.areas.has(e)?t=this.areas.get(e):(t=p("area",m({layerLevel:e},this.options)),this.areas.set(e,t)),t}},{key:"getAreas",value:function(){return v(this.areas.values())}},{key:"createOrGetHeader",value:function(){var t,e=this.layerLevel;return this.headers.has(e)?t=this.headers.get(e):(t=p("header",m({},this.options)),this.headers.set(e,t)),t}},{key:"getHeaders",value:function(){return v(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var t,e=this.layerLevel;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=p("active-header",m({},this.options)),this.activeHeaders.set(e,t)),t}},{key:"getActiveHeaders",value:function(){return v(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return v(this.customSelections.values())}},{key:"addCustomSelection",value:function(t){this.customSelections.push(p("custom-selection",m({},t)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Object(g.arrayEach)(this.areas.values(),(function(t){t.clear()})),Object(g.arrayEach)(this.headers.values(),(function(t){t.clear()})),Object(g.arrayEach)(this.activeHeaders.values(),(function(t){t.clear()}))}},{key:Symbol.iterator,value:function(){return[this.cell,this.fill].concat(v(this.areas.values()),v(this.headers.values()),v(this.activeHeaders.values()),v(this.customSelections))[Symbol.iterator]()}}])&&w(e.prototype,n),r&&w(e,r),t}();n(38),n(109),n(92),n(93),n(81),n(94);function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var E=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ranges=[]}var e,n,r;return e=t,(n=[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(t){return this.clear(),this.ranges.push(new o.b(t)),this}},{key:"add",value:function(t){return this.ranges.push(new o.b(t)),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(t){return this.ranges.some((function(e){return e.includes(t)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+e-1;return n>=0&&(t=this.ranges[n]),t}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}])&&C(e.prototype,n),r&&C(e,r),t}(),S=n(82),k=n(2),R=n(13),_=n(44);function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var M=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=e,this.options=n}var e,n,r;return e=t,(n=[{key:"transformStart",value:function(t,e,n){var r=new o.a(t,e);this.runLocalHooks("beforeTransformStart",r);var i=this.options.countRows(),a=this.options.countCols(),s=this.options.fixedRowsBottom(),l=this.options.minSpareRows(),u=this.options.minSpareCols(),c=this.options.autoWrapRow(),f=this.options.autoWrapCol(),h=this.range.current().highlight;h.row+t>i-1?n&&l>0&&!(s&&h.row>=i-s-1)?(this.runLocalHooks("insertRowRequire",i),i=this.options.countRows()):f&&(r.row=1-i,r.col=h.col+r.col===a-1?1-a:1):f&&h.row+r.row<0&&h.col+r.col>=0&&(r.row=i-1,r.col=h.col+r.col===0?a-1:-1),h.col+r.col>a-1?n&&u>0?(this.runLocalHooks("insertColRequire",a),a=this.options.countCols()):c&&(r.row=h.row+r.row===i-1?1-i:1,r.col=1-a):c&&h.col+r.col<0&&h.row+r.row>=0&&(r.row=h.row+r.row===0?i-1:-1,r.col=a-1);var d=new o.a(h.row+r.row,h.col+r.col),p=0,g=0;return d.row<0?(p=-1,d.row=0):d.row>0&&d.row>=i&&(p=1,d.row=i-1),d.col<0?(g=-1,d.col=0):d.col>0&&d.col>=a&&(g=1,d.col=a-1),this.runLocalHooks("afterTransformStart",d,p,g),d}},{key:"transformEnd",value:function(t,e){var n=new o.a(t,e);this.runLocalHooks("beforeTransformEnd",n);var r=this.options.countRows(),i=this.options.countCols(),a=this.range.current(),s=new o.a(a.to.row+n.row,a.to.col+n.col),l=0,u=0;return s.row<0?(l=-1,s.row=0):s.row>0&&s.row>=r&&(l=1,s.row=r-1),s.col<0?(u=-1,s.col=0):s.col>0&&s.col>=i&&(u=1,s.col=i-1),this.runLocalHooks("afterTransformEnd",s,l,u),s}}])&&T(e.prototype,n),r&&T(e,r),t}();Object(k.mixin)(M,_.a);var A=M,N=n(55),j=n(36);function x(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function I(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) \n        or as an array of CellRange objects."]);return I=function(){return t},t}function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var P=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new E,this.highlight=new O({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disableHighlight:this.settings.disableVisualSelection,cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)}}),this.transformation=new A(this.selectedRange,{countRows:function(){return r.tableProps.countRows()},countCols:function(){return r.tableProps.countCols()},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(e))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(e))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(e))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(e))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(e))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(e))}))}var e,n,r;return e=t,(n=[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=Object(R.isUndefined)(e)?Object(S.a)():e,i=t.row<0,a=t.col<0,s=i&&a;i&&(t.row=0),a&&(t.col=0),this.selectedByCorner=s,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),t),(!r||r&&!o&&Object(R.isUndefined)(e))&&this.selectedRange.clear(),this.selectedRange.add(t),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!s&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!s&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(t)}},{key:"setRangeStartOnly",value:function(t,e){this.setRangeStart(t,e,!0)}},{key:"setRangeEnd",value:function(t){if(!this.selectedRange.isEmpty()){this.runLocalHooks("beforeSetRangeEnd",t),this.begin();var e=this.selectedRange.current();"single"!==this.settings.selectionMode&&e.setTo(new o.a(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor("cell")&&this.highlight.getCell().add(this.selectedRange.current().highlight);var n=this.getLayerLevel();n<this.highlight.layerLevel&&(Object(g.arrayEach)(this.highlight.getAreas(),(function(t){t.clear()})),Object(g.arrayEach)(this.highlight.getHeaders(),(function(t){t.clear()})),Object(g.arrayEach)(this.highlight.getActiveHeaders(),(function(t){t.clear()}))),this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();r.clear(),i.clear(),a.clear(),this.highlight.isEnabledFor("area")&&(this.isMultiple()||n>=1)&&(r.add(e.from).add(e.to),1===n&&(this.highlight.useLayerLevel(n-1).createOrGetArea().add(this.selectedRange.previous().from),this.highlight.useLayerLevel(n))),this.highlight.isEnabledFor("header")&&("single"===this.settings.selectionMode?i.add(e.highlight):i.add(e.from).add(e.to)),this.isSelectedByRowHeader()&&this.tableProps.countCols()===e.getWidth()&&a.add(new o.a(e.from.row,-1)).add(new o.a(e.to.row,-1)),this.isSelectedByColumnHeader()&&this.tableProps.countRows()===e.getHeight()&&a.add(new o.a(-1,e.from.col)).add(new o.a(-1,e.to.col)),this.runLocalHooks("afterSetRangeEnd",t)}}},{key:"isMultiple",value:function(){var t=Object(k.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}},{key:"transformStart",value:function(t,e,n){this.setRangeStart(this.transformation.transformStart(t,e,n))}},{key:"transformEnd",value:function(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t)}},{key:"isSelectedByColumnHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){this.clear(),this.setRangeStart(new o.a(-1,-1)),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new o.a(this.tableProps.countRows()-1,this.tableProps.countCols()-1))}},{key:"selectCells",value:function(t){var e=this,n=Object(N.c)(t);if(n===N.a)return!1;if(n===N.b)throw new Error(Object(j.a)(I()));var r=Object(N.e)(n,{propToCol:function(t){return e.tableProps.propToCol(t)},keepDirection:!0}),i=this.tableProps.countRows(),a=this.tableProps.countCols(),s=!t.some((function(t){var e=x(r(t),4),n=e[0],o=e[1],s=e[2],l=e[3];return!(Object(N.d)(n,i)&&Object(N.d)(o,a)&&Object(N.d)(s,i)&&Object(N.d)(l,a))}));return s&&(this.clear(),Object(g.arrayEach)(t,(function(t){var n=x(r(t),4),i=n[0],a=n[1],s=n[2],l=n[3];e.setRangeStartOnly(new o.a(i,a),!1),e.setRangeEnd(new o.a(s,l)),e.finish()}))),s}},{key:"selectColumns",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n="string"==typeof t?this.tableProps.propToCol(t):t,r="string"==typeof e?this.tableProps.propToCol(e):e,i=this.tableProps.countCols(),a=Object(N.d)(n,i)&&Object(N.d)(r,i);return a&&(this.setRangeStartOnly(new o.a(-1,n)),this.setRangeEnd(new o.a(this.tableProps.countRows()-1,r)),this.finish()),a}},{key:"selectRows",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this.tableProps.countRows(),r=Object(N.d)(t,n)&&Object(N.d)(e,n);return r&&(this.setRangeStartOnly(new o.a(t,-1)),this.setRangeEnd(new o.a(e,this.tableProps.countCols()-1)),this.finish()),r}}])&&D(e.prototype,n),r&&D(e,r),t}();Object(k.mixin)(P,_.a);var L=P;n(132);n.d(e,"a",(function(){return L})),n.d(e,"b",(function(){return N.c})),n.d(e,"c",(function(){return N.e}))},function(t,e){t.exports=!1},function(t,e,n){var r=n(187),o=n(49),i=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?i(r[t])||i(o[t]):r[t]&&r[t][e]||o[t]&&o[t][e]}},function(t,e,n){var r,o=n(57),i=n(228),a=n(162),s=n(119),l=n(191),u=n(158),c=n(136),f=c("IE_PROTO"),h=function(){},d=function(t){return"<script>"+t+"<\/script>"},p=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;p=r?function(t){t.write(d("")),t.close();var e=t.parentWindow.Object;return t=null,e}(r):((e=u("iframe")).style.display="none",l.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(d("document.F=Object")),t.close(),t.F);for(var n=a.length;n--;)delete p.prototype[a[n]];return p()};s[f]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(h.prototype=o(t),n=new h,h.prototype=null,n[f]=t):n=p(),void 0===e?n:i(n,e)}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,n){"use strict";var r=n(26),o=n(212);r({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},function(t,e,n){var r=n(49),o=n(201),i=n(212),a=n(78);for(var s in o){var l=r[s],u=l&&l.prototype;if(u&&u.forEach!==i)try{a(u,"forEach",i)}catch(t){u.forEach=i}}},function(t,e,n){"use strict";var r=n(26),o=n(84).some,i=n(91),a=n(68),s=i("some"),l=a("some");r({target:"Array",proto:!0,forced:!s||!l},{some:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){"use strict";var r=n(26),o=n(84).every,i=n(91),a=n(68),s=i("every"),l=a("every");r({target:"Array",proto:!0,forced:!s||!l},{every:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},,function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return f})),n.d(e,"d",(function(){return h}));n(27),n(38),n(81),n(33);var r=n(13),o=n(2),i=n(34),a=n(36),s=n(76);function l(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.']);return l=function(){return t},t}function u(t,e){return Object(o.objectEach)(e,(function(e,n){Object(r.isUndefined)(t[n])&&(t[n]=e)})),t}function c(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?"".concat(e[1].toLowerCase(),"-").concat(e[2].toUpperCase()):t}function f(t,e){var n=c(e);Object(s.d)(n)?t.language=n:(t.language=s.a,h(e))}function h(t){Object(r.isDefined)(t)&&Object(i.a)(Object(a.a)(l(),t))}},function(t,e,n){(function(e,n){t.exports=function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="swal-button";e.CLASS_NAMES={MODAL:"swal-modal",OVERLAY:"swal-overlay",SHOW_MODAL:"swal-overlay--show-modal",MODAL_TITLE:"swal-title",MODAL_TEXT:"swal-text",ICON:"swal-icon",ICON_CUSTOM:"swal-icon--custom",CONTENT:"swal-content",FOOTER:"swal-footer",BUTTON_CONTAINER:"swal-button-container",BUTTON:r,CONFIRM_BUTTON:r+"--confirm",CANCEL_BUTTON:r+"--cancel",DANGER_BUTTON:r+"--danger",BUTTON_LOADING:r+"--loading",BUTTON_LOADER:r+"__loader"},e.default=e.CLASS_NAMES},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getNode=function(t){var e="."+t;return document.querySelector(e)},e.stringToNode=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},e.insertAfter=function(t,e){var n=e.nextSibling;e.parentNode.insertBefore(t,n)},e.removeNode=function(t){t.parentElement.removeChild(t)},e.throwErr=function(t){throw"SweetAlert: "+(t=t.replace(/ +(?= )/g,"")).trim()},e.isPlainObject=function(t){if("[object Object]"!==Object.prototype.toString.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype},e.ordinalSuffixOf=function(t){var e=t%10,n=t%100;return 1===e&&11!==n?t+"st":2===e&&12!==n?t+"nd":3===e&&13!==n?t+"rd":t+"th"}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(25));var o=n(26);e.overlayMarkup=o.default,r(n(27)),r(n(28)),r(n(29));var i=n(0),a=i.default.MODAL_TITLE,s=i.default.MODAL_TEXT,l=i.default.ICON,u=i.default.FOOTER;e.iconMarkup='\n  <div class="'+l+'"></div>',e.titleMarkup='\n  <div class="'+a+'"></div>\n',e.textMarkup='\n  <div class="'+s+'"></div>',e.footerMarkup='\n  <div class="'+u+'"></div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);e.CONFIRM_KEY="confirm",e.CANCEL_KEY="cancel";var o={visible:!0,text:null,value:null,className:"",closeModal:!0},i=Object.assign({},o,{visible:!1,text:"Cancel",value:null}),a=Object.assign({},o,{text:"OK",value:!0});e.defaultButtonList={cancel:i,confirm:a};var s=function(t){switch(t){case e.CONFIRM_KEY:return a;case e.CANCEL_KEY:return i;default:var n=t.charAt(0).toUpperCase()+t.slice(1);return Object.assign({},o,{text:n,value:t})}},l=function(t,e){var n=s(t);return!0===e?Object.assign({},n,{visible:!0}):"string"==typeof e?Object.assign({},n,{visible:!0,text:e}):r.isPlainObject(e)?Object.assign({visible:!0},n,e):Object.assign({},n,{visible:!1})},u=function(t){var n={};switch(t.length){case 1:n[e.CANCEL_KEY]=Object.assign({},i,{visible:!1});break;case 2:n[e.CANCEL_KEY]=l(e.CANCEL_KEY,t[0]),n[e.CONFIRM_KEY]=l(e.CONFIRM_KEY,t[1]);break;default:r.throwErr("Invalid number of 'buttons' in array ("+t.length+").\n      If you want more than 2 buttons, you need to use an object!")}return n};e.getButtonListOpts=function(t){var n=e.defaultButtonList;return"string"==typeof t?n[e.CONFIRM_KEY]=l(e.CONFIRM_KEY,t):Array.isArray(t)?n=u(t):r.isPlainObject(t)?n=function(t){for(var e={},n=0,r=Object.keys(t);n<r.length;n++){var o=r[n],a=t[o],s=l(o,a);e[o]=s}return e.cancel||(e.cancel=i),e}(t):!0===t?n=u([!0,!0]):!1===t?n=u([!1,!1]):void 0===t&&(n=e.defaultButtonList),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(2),i=n(0),a=i.default.MODAL,s=i.default.OVERLAY,l=n(30),u=n(31),c=n(32),f=n(33);e.injectElIntoModal=function(t){var e=r.getNode(a),n=r.stringToNode(t);return e.appendChild(n),n};var h=function(t,e){!function(t){t.className=a,t.textContent=""}(t);var n=e.className;n&&t.classList.add(n)};e.initModalContent=function(t){var e=r.getNode(a);h(e,t),l.default(t.icon),u.initTitle(t.title),u.initText(t.text),f.default(t.content),c.default(t.buttons,t.dangerMode)},e.default=function(){var t=r.getNode(s),e=r.stringToNode(o.modalMarkup);t.appendChild(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),o={isOpen:!1,promise:null,actions:{},timer:null},i=Object.assign({},o);e.resetState=function(){i=Object.assign({},o)},e.setActionValue=function(t){if("string"==typeof t)return a(r.CONFIRM_KEY,t);for(var e in t)a(e,t[e])};var a=function(t,e){i.actions[t]||(i.actions[t]={}),Object.assign(i.actions[t],{value:e})};e.setActionOptionsFor=function(t,e){var n=(void 0===e?{}:e).closeModal,r=void 0===n||n;Object.assign(i.actions[t],{closeModal:r})},e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(3),i=n(0),a=i.default.OVERLAY,s=i.default.SHOW_MODAL,l=i.default.BUTTON,u=i.default.BUTTON_LOADING,c=n(5);e.openModal=function(){r.getNode(a).classList.add(s),c.default.isOpen=!0},e.onAction=function(t){void 0===t&&(t=o.CANCEL_KEY);var e=c.default.actions[t],n=e.value;if(!1===e.closeModal){var i=l+"--"+t;r.getNode(i).classList.add(u)}else r.getNode(a).classList.remove(s),c.default.isOpen=!1;c.default.promise.resolve(n)},e.getState=function(){var t=Object.assign({},c.default);return delete t.promise,delete t.timer,t},e.stopLoading=function(){for(var t=document.querySelectorAll("."+l),e=0;e<t.length;e++)t[e].classList.remove(u)}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(e){t.exports=e.sweetAlert=n(9)}).call(e,n(7))},function(t,e,n){(function(e){t.exports=e.swal=n(10)}).call(e,n(7))},function(t,e,n){"undefined"!=typeof window&&n(11),n(16);var r=n(23).default;t.exports=r},function(t,e,n){var r=n(12);"string"==typeof r&&(r=[[t.i,r,""]]);var o={insertAt:"top",transform:void 0};n(14)(r,o),r.locals&&(t.exports=r.locals)},function(t,e,n){(t.exports=n(13)(void 0)).push([t.i,'.swal-icon--error{border-color:#f27474;-webkit-animation:animateErrorIcon .5s;animation:animateErrorIcon .5s}.swal-icon--error__x-mark{position:relative;display:block;-webkit-animation:animateXMark .5s;animation:animateXMark .5s}.swal-icon--error__line{position:absolute;height:5px;width:47px;background-color:#f27474;display:block;top:37px;border-radius:2px}.swal-icon--error__line--left{-webkit-transform:rotate(45deg);transform:rotate(45deg);left:17px}.swal-icon--error__line--right{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);right:16px}@-webkit-keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@-webkit-keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}@keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}.swal-icon--warning{border-color:#f8bb86;-webkit-animation:pulseWarning .75s infinite alternate;animation:pulseWarning .75s infinite alternate}.swal-icon--warning__body{width:5px;height:47px;top:10px;border-radius:2px;margin-left:-2px}.swal-icon--warning__body,.swal-icon--warning__dot{position:absolute;left:50%;background-color:#f8bb86}.swal-icon--warning__dot{width:7px;height:7px;border-radius:50%;margin-left:-4px;bottom:-11px}@-webkit-keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}@keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}.swal-icon--success{border-color:#a5dc86}.swal-icon--success:after,.swal-icon--success:before{content:"";border-radius:50%;position:absolute;width:60px;height:120px;background:#fff;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.swal-icon--success:before{border-radius:120px 0 0 120px;top:-7px;left:-33px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:60px 60px;transform-origin:60px 60px}.swal-icon--success:after{border-radius:0 120px 120px 0;top:-11px;left:30px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:0 60px;transform-origin:0 60px;-webkit-animation:rotatePlaceholder 4.25s ease-in;animation:rotatePlaceholder 4.25s ease-in}.swal-icon--success__ring{width:80px;height:80px;border:4px solid hsla(98,55%,69%,.2);border-radius:50%;box-sizing:content-box;position:absolute;left:-4px;top:-4px;z-index:2}.swal-icon--success__hide-corners{width:5px;height:90px;background-color:#fff;padding:1px;position:absolute;left:28px;top:8px;z-index:1;-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.swal-icon--success__line{height:5px;background-color:#a5dc86;display:block;border-radius:2px;position:absolute;z-index:2}.swal-icon--success__line--tip{width:25px;left:14px;top:46px;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-animation:animateSuccessTip .75s;animation:animateSuccessTip .75s}.swal-icon--success__line--long{width:47px;right:8px;top:38px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-animation:animateSuccessLong .75s;animation:animateSuccessLong .75s}@-webkit-keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@-webkit-keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@-webkit-keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}@keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}.swal-icon--info{border-color:#c9dae1}.swal-icon--info:before{width:5px;height:29px;bottom:17px;border-radius:2px;margin-left:-2px}.swal-icon--info:after,.swal-icon--info:before{content:"";position:absolute;left:50%;background-color:#c9dae1}.swal-icon--info:after{width:7px;height:7px;border-radius:50%;margin-left:-3px;top:19px}.swal-icon{width:80px;height:80px;border-width:4px;border-style:solid;border-radius:50%;padding:0;position:relative;box-sizing:content-box;margin:20px auto}.swal-icon:first-child{margin-top:32px}.swal-icon--custom{width:auto;height:auto;max-width:100%;border:none;border-radius:0}.swal-icon img{max-width:100%;max-height:100%}.swal-title{color:rgba(0,0,0,.65);font-weight:600;text-transform:none;position:relative;display:block;padding:13px 16px;font-size:27px;line-height:normal;text-align:center;margin-bottom:0}.swal-title:first-child{margin-top:26px}.swal-title:not(:first-child){padding-bottom:0}.swal-title:not(:last-child){margin-bottom:13px}.swal-text{font-size:16px;position:relative;float:none;line-height:normal;vertical-align:top;text-align:left;display:inline-block;margin:0;padding:0 10px;font-weight:400;color:rgba(0,0,0,.64);max-width:calc(100% - 20px);overflow-wrap:break-word;box-sizing:border-box}.swal-text:first-child{margin-top:45px}.swal-text:last-child{margin-bottom:45px}.swal-footer{text-align:right;padding-top:13px;margin-top:13px;padding:13px 16px;border-radius:inherit;border-top-left-radius:0;border-top-right-radius:0}.swal-button-container{margin:5px;display:inline-block;position:relative}.swal-button{background-color:#7cd1f9;color:#fff;border:none;box-shadow:none;border-radius:5px;font-weight:600;font-size:14px;padding:10px 24px;margin:0;cursor:pointer}.swal-button:not([disabled]):hover{background-color:#78cbf2}.swal-button:active{background-color:#70bce0}.swal-button:focus{outline:none;box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(43,114,165,.29)}.swal-button[disabled]{opacity:.5;cursor:default}.swal-button::-moz-focus-inner{border:0}.swal-button--cancel{color:#555;background-color:#efefef}.swal-button--cancel:not([disabled]):hover{background-color:#e8e8e8}.swal-button--cancel:active{background-color:#d7d7d7}.swal-button--cancel:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(116,136,150,.29)}.swal-button--danger{background-color:#e64942}.swal-button--danger:not([disabled]):hover{background-color:#df4740}.swal-button--danger:active{background-color:#cf423b}.swal-button--danger:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(165,43,43,.29)}.swal-content{padding:0 20px;margin-top:20px;font-size:medium}.swal-content:last-child{margin-bottom:20px}.swal-content__input,.swal-content__textarea{-webkit-appearance:none;background-color:#fff;border:none;font-size:14px;display:block;box-sizing:border-box;width:100%;border:1px solid rgba(0,0,0,.14);padding:10px 13px;border-radius:2px;transition:border-color .2s}.swal-content__input:focus,.swal-content__textarea:focus{outline:none;border-color:#6db8ff}.swal-content__textarea{resize:vertical}.swal-button--loading{color:transparent}.swal-button--loading~.swal-button__loader{opacity:1}.swal-button__loader{position:absolute;height:auto;width:43px;z-index:2;left:50%;top:50%;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);text-align:center;pointer-events:none;opacity:0}.swal-button__loader div{display:inline-block;float:none;vertical-align:baseline;width:9px;height:9px;padding:0;border:none;margin:2px;opacity:.4;border-radius:7px;background-color:hsla(0,0%,100%,.9);transition:background .2s;-webkit-animation:swal-loading-anim 1s infinite;animation:swal-loading-anim 1s infinite}.swal-button__loader div:nth-child(3n+2){-webkit-animation-delay:.15s;animation-delay:.15s}.swal-button__loader div:nth-child(3n+3){-webkit-animation-delay:.3s;animation-delay:.3s}@-webkit-keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}@keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}.swal-overlay{position:fixed;top:0;bottom:0;left:0;right:0;text-align:center;font-size:0;overflow-y:auto;background-color:rgba(0,0,0,.4);z-index:10000;pointer-events:none;opacity:0;transition:opacity .3s}.swal-overlay:before{content:" ";display:inline-block;vertical-align:middle;height:100%}.swal-overlay--show-modal{opacity:1;pointer-events:auto}.swal-overlay--show-modal .swal-modal{opacity:1;pointer-events:auto;box-sizing:border-box;-webkit-animation:showSweetAlert .3s;animation:showSweetAlert .3s;will-change:transform}.swal-modal{width:478px;opacity:0;pointer-events:none;background-color:#fff;text-align:center;border-radius:5px;position:static;margin:20px auto;display:inline-block;vertical-align:middle;-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;z-index:10001;transition:opacity .2s,-webkit-transform .3s;transition:transform .3s,opacity .2s;transition:transform .3s,opacity .2s,-webkit-transform .3s}@media (max-width:500px){.swal-modal{width:calc(100% - 20px)}}@-webkit-keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}',""])},function(t,e){function n(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var o=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(r);return[n].concat(r.sources.map((function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"}))).concat([o]).join("\n")}return[n].join("\n")}t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=n(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r})).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(t,e,n){function r(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=p[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(c(r.parts[i],e))}else{var a=[];for(i=0;i<r.parts.length;i++)a.push(c(r.parts[i],e));p[r.id]={id:r.id,refs:1,parts:a}}}}function o(t,e){for(var n=[],r={},o=0;o<t.length;o++){var i=t[o],a=e.base?i[0]+e.base:i[0],s={css:i[1],media:i[2],sourceMap:i[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}function i(t,e){var n=v(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=b[b.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),b.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function a(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=b.indexOf(t);e>=0&&b.splice(e,1)}function s(t){var e=document.createElement("style");return t.attrs.type="text/css",u(e,t.attrs),i(t,e),e}function l(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",u(e,t.attrs),i(t,e),e}function u(t,e){Object.keys(e).forEach((function(n){t.setAttribute(n,e[n])}))}function c(t,e){var n,r,o,i;if(e.transform&&t.css){if(!(i=e.transform(t.css)))return function(){};t.css=i}if(e.singleton){var u=m++;n=y||(y=s(e)),r=f.bind(null,n,u,!1),o=f.bind(null,n,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=l(e),r=d.bind(null,n,e),o=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(e),r=h.bind(null,n),o=function(){a(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}function f(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=O(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function h(t,e){var n=e.css,r=e.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function d(t,e,n){var r=n.css,o=n.sourceMap,i=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||i)&&(r=w(r)),o&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([r],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}var p={},g=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}((function(){return window&&document&&document.all&&!window.atob})),v=function(t){var e={};return function(n){return void 0===e[n]&&(e[n]=t.call(this,n)),e[n]}}((function(t){return document.querySelector(t)})),y=null,m=0,b=[],w=n(15);t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=g()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=o(t,e);return r(n,e),function(t){for(var i=[],a=0;a<n.length;a++){var s=n[a];(l=p[s.id]).refs--,i.push(l)}for(t&&r(o(t,e),e),a=0;a<i.length;a++){var l;if(0===(l=i[a]).refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete p[l.id]}}}};var O=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,r=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var o,i=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(i)?t:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:r+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}},function(t,e,n){var r=n(17);"undefined"==typeof window||window.Promise||(window.Promise=r),n(21),String.prototype.includes||(String.prototype.includes=function(t,e){"use strict";return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;for(var o=0|e,i=Math.max(o>=0?o:r-Math.abs(o),0);i<r;){if(function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}(n[i],t))return!0;i++}return!1}}),"undefined"!=typeof window&&[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}))},function(t,e,n){(function(e){!function(n){function r(){}function o(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(t,this)}function i(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void s(e.promise,t)}a(e.promise,r)}else(1===t._state?a:s)(e.promise,t._value)}))):t._deferreds.push(e)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void l(t);if("function"==typeof n)return void c(function(t,e){return function(){t.apply(e,arguments)}}(n,e),t)}t._state=1,t._value=e,l(t)}catch(e){s(t,e)}}function s(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&o._immediateFn((function(){t._handled||o._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)i(t,t._deferreds[e]);t._deferreds=null}function u(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function c(t,e){var n=!1;try{t((function(t){n||(n=!0,a(e,t))}),(function(t){n||(n=!0,s(e,t))}))}catch(t){if(n)return;n=!0,s(e,t)}}var f=setTimeout;o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=new this.constructor(r);return i(this,new u(t,e,n)),n},o.all=function(t){var e=Array.prototype.slice.call(t);return new o((function(t,n){function r(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,(function(t){r(i,t)}),n)}e[i]=a,0==--o&&t(e)}catch(t){n(t)}}if(0===e.length)return t([]);for(var o=e.length,i=0;i<e.length;i++)r(i,e[i])}))},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o((function(e){e(t)}))},o.reject=function(t){return new o((function(e,n){n(t)}))},o.race=function(t){return new o((function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)}))},o._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){f(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},o._setImmediateFn=function(t){o._immediateFn=t},o._setUnhandledRejectionFn=function(t){o._unhandledRejectionFn=t},void 0!==t&&t.exports?t.exports=o:n.Promise||(n.Promise=o)}(this)}).call(e,n(18).setImmediate)},function(t,r,o){function i(t,e){this._id=t,this._clearFn=e}var a=Function.prototype.apply;r.setTimeout=function(){return new i(a.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new i(a.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},r.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},r._unrefActive=r.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},o(19),r.setImmediate=e,r.clearImmediate=n},function(t,e,n){(function(t,e){!function(t,n){"use strict";function r(t){delete s[t]}function o(t){if(l)setTimeout(o,0,t);else{var e=s[t];if(e){l=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{r(t),l=!1}}}}if(!t.setImmediate){var i,a=1,s={},l=!1,u=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){o(t)}))}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&o(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),i=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){o(t.data)},i=function(e){t.port2.postMessage(e)}}():u&&"onreadystatechange"in u.createElement("script")?function(){var t=u.documentElement;i=function(e){var n=u.createElement("script");n.onreadystatechange=function(){o(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():i=function(t){setTimeout(o,0,t)},c.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return s[a]=r,i(a),a++},c.clearImmediate=r}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n(7),n(20))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(u===setTimeout)return setTimeout(t,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function i(){p&&h&&(p=!1,h.length?d=h.concat(d):g=-1,d.length&&a())}function a(){if(!p){var t=o(i);p=!0;for(var e=d.length;e;){for(h=d,d=[];++g<e;)h&&h[g].run();g=-1,e=d.length}h=null,p=!1,function(t){if(c===clearTimeout)return clearTimeout(t);if((c===r||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}(t)}}function s(t,e){this.fun=t,this.array=e}function l(){}var u,c,f=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(t){u=n}try{c="function"==typeof clearTimeout?clearTimeout:r}catch(t){c=r}}();var h,d=[],p=!1,g=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new s(t,e)),1!==d.length||p||o(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){"use strict";n(22).polyfill()},function(t,e,n){"use strict";function r(t,e){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var i=Object.keys(Object(o)),a=0,s=i.length;a<s;a++){var l=i[a],u=Object.getOwnPropertyDescriptor(o,l);void 0!==u&&u.enumerable&&(n[l]=o[l])}}return n}t.exports={assign:r,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:r})}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(24),o=n(6),i=n(5),a=n(36),s=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof window){var n=a.getOpts.apply(void 0,t);return new Promise((function(t,e){i.default.promise={resolve:t,reject:e},r.default(n),setTimeout((function(){o.openModal()}))}))}};s.close=o.onAction,s.getState=o.getState,s.setActionValue=i.setActionValue,s.stopLoading=o.stopLoading,s.setDefaults=a.setDefaults,e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(0).default.MODAL,i=n(4),a=n(34),s=n(35),l=n(1);e.init=function(t){r.getNode(o)||(document.body||l.throwErr("You can only use SweetAlert AFTER the DOM has loaded!"),a.default(),i.default()),i.initModalContent(t),s.default(t)},e.default=e.init},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0).default.MODAL;e.modalMarkup='\n  <div class="'+r+'" role="dialog" aria-modal="true"></div>',e.default=e.modalMarkup},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r='<div \n    class="'+n(0).default.OVERLAY+'"\n    tabIndex="-1">\n  </div>';e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0).default.ICON;e.errorIconMarkup=function(){var t=r+"--error",e=t+"__line";return'\n    <div class="'+t+'__x-mark">\n      <span class="'+e+" "+e+'--left"></span>\n      <span class="'+e+" "+e+'--right"></span>\n    </div>\n  '},e.warningIconMarkup=function(){var t=r+"--warning";return'\n    <span class="'+t+'__body">\n      <span class="'+t+'__dot"></span>\n    </span>\n  '},e.successIconMarkup=function(){var t=r+"--success";return'\n    <span class="'+t+"__line "+t+'__line--long"></span>\n    <span class="'+t+"__line "+t+'__line--tip"></span>\n\n    <div class="'+t+'__ring"></div>\n    <div class="'+t+'__hide-corners"></div>\n  '}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0).default.CONTENT;e.contentMarkup='\n  <div class="'+r+'">\n\n  </div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=r.default.BUTTON_CONTAINER,i=r.default.BUTTON,a=r.default.BUTTON_LOADER;e.buttonMarkup='\n  <div class="'+o+'">\n\n    <button\n      class="'+i+'"\n    ></button>\n\n    <div class="'+a+'">\n      <div></div>\n      <div></div>\n      <div></div>\n    </div>\n\n  </div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),o=n(2),i=n(0),a=i.default.ICON,s=i.default.ICON_CUSTOM,l=["error","warning","success","info"],u={error:o.errorIconMarkup(),warning:o.warningIconMarkup(),success:o.successIconMarkup()};e.default=function(t){if(t){var e=r.injectElIntoModal(o.iconMarkup);l.includes(t)?function(t,e){var n=a+"--"+t;e.classList.add(n);var r=u[t];r&&(e.innerHTML=r)}(t,e):function(t,e){e.classList.add(s);var n=document.createElement("img");n.src=t,e.appendChild(n)}(t,e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(4),i=function(t){navigator.userAgent.includes("AppleWebKit")&&(t.style.display="none",t.offsetHeight,t.style.display="")};e.initTitle=function(t){if(t){var e=o.injectElIntoModal(r.titleMarkup);e.textContent=t,i(e)}},e.initText=function(t){if(t){var e=document.createDocumentFragment();t.split("\n").forEach((function(t,n,r){e.appendChild(document.createTextNode(t)),n<r.length-1&&e.appendChild(document.createElement("br"))}));var n=o.injectElIntoModal(r.textMarkup);n.appendChild(e),i(n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(4),i=n(0),a=i.default.BUTTON,s=i.default.DANGER_BUTTON,l=n(3),u=n(2),c=n(6),f=n(5),h=function(t,e,n){var o=e.text,i=e.value,h=e.className,d=e.closeModal,p=r.stringToNode(u.buttonMarkup),g=p.querySelector("."+a),v=a+"--"+t;g.classList.add(v),h&&(Array.isArray(h)?h:h.split(" ")).filter((function(t){return t.length>0})).forEach((function(t){g.classList.add(t)})),n&&t===l.CONFIRM_KEY&&g.classList.add(s),g.textContent=o;var y={};return y[t]=i,f.setActionValue(y),f.setActionOptionsFor(t,{closeModal:d}),g.addEventListener("click",(function(){return c.onAction(t)})),p};e.default=function(t,e){var n=o.injectElIntoModal(u.footerMarkup);for(var r in t){var i=t[r],a=h(r,i,e);i.visible&&n.appendChild(a)}0===n.children.length&&n.remove()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),o=n(4),i=n(2),a=n(5),s=n(6),l=n(0).default.CONTENT,u=function(t){t.addEventListener("input",(function(t){var e=t.target.value;a.setActionValue(e)})),t.addEventListener("keyup",(function(t){if("Enter"===t.key)return s.onAction(r.CONFIRM_KEY)})),setTimeout((function(){t.focus(),a.setActionValue("")}),0)};e.default=function(t){if(t){var e=o.injectElIntoModal(i.contentMarkup),n=t.element,r=t.attributes;"string"==typeof n?function(t,e,n){var r=document.createElement(e),o=l+"__"+e;for(var i in r.classList.add(o),n){var a=n[i];r[i]=a}"input"===e&&u(r),t.appendChild(r)}(e,n,r):e.appendChild(n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(2);e.default=function(){var t=r.stringToNode(o.overlayMarkup);document.body.appendChild(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(6),i=n(1),a=n(3),s=n(0),l=s.default.MODAL,u=s.default.BUTTON,c=s.default.OVERLAY,f=function(t){if(r.default.isOpen)switch(t.key){case"Escape":return o.onAction(a.CANCEL_KEY)}},h=function(t){if(r.default.isOpen)switch(t.key){case"Tab":return function(t){t.preventDefault(),p()}(t)}},d=function(t){if(r.default.isOpen)return"Tab"===t.key&&t.shiftKey?function(t){t.preventDefault(),g()}(t):void 0},p=function(){var t=i.getNode(u);t&&(t.tabIndex=0,t.focus())},g=function(){var t=i.getNode(l).querySelectorAll("."+u),e=t[t.length-1];e&&e.focus()},v=function(){var t=i.getNode(l).querySelectorAll("."+u);t.length&&(function(t){t[t.length-1].addEventListener("keydown",h)}(t),function(t){t[0].addEventListener("keydown",d)}(t))},y=function(t){if(i.getNode(c)===t.target)return o.onAction(a.CANCEL_KEY)};e.default=function(t){t.closeOnEsc?document.addEventListener("keyup",f):document.removeEventListener("keyup",f),t.dangerMode?p():g(),v(),function(t){var e=i.getNode(c);e.removeEventListener("click",y),t&&e.addEventListener("click",y)}(t.closeOnClickOutside),function(t){r.default.timer&&clearTimeout(r.default.timer),t&&(r.default.timer=window.setTimeout((function(){return o.onAction(a.CANCEL_KEY)}),t))}(t.timer)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(3),i=n(37),a=n(38),s={title:null,text:null,icon:null,buttons:o.defaultButtonList,content:null,className:null,closeOnClickOutside:!0,closeOnEsc:!0,dangerMode:!1,timer:null},l=Object.assign({},s);e.setDefaults=function(t){l=Object.assign({},s,t)};var u=function(t){var e=t&&t.button,n=t&&t.buttons;return void 0!==e&&void 0!==n&&r.throwErr("Cannot set both 'button' and 'buttons' options!"),void 0!==e?{confirm:e}:n},c=function(t){return r.ordinalSuffixOf(t+1)},f=function(t,e){r.throwErr(c(e)+" argument ('"+t+"') is invalid")},h=function(t,e){var n=t+1,o=e[n];r.isPlainObject(o)||void 0===o||r.throwErr("Expected "+c(n)+" argument ('"+o+"') to be a plain object")},d=function(t,e,n,o){var i=e instanceof Element;if("string"==typeof e){if(0===n)return{text:e};if(1===n)return{text:e,title:o[0]};if(2===n)return h(n,o),{icon:e};f(e,n)}else{if(i&&0===n)return h(n,o),{content:e};if(r.isPlainObject(e))return function(t,e){var n=t+1,o=e[n];void 0!==o&&r.throwErr("Unexpected "+c(n)+" argument ("+o+")")}(n,o),e;f(e,n)}};e.getOpts=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n={};t.forEach((function(e,r){var o=d(0,e,r,t);Object.assign(n,o)}));var r=u(n);n.buttons=o.getButtonListOpts(r),delete n.button,n.content=i.getContentOpts(n.content);var c=Object.assign({},s,l,n);return Object.keys(c).forEach((function(t){a.DEPRECATED_OPTS[t]&&a.logDeprecation(t)})),c}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o={element:"input",attributes:{placeholder:""}};e.getContentOpts=function(t){return r.isPlainObject(t)?Object.assign({},t):t instanceof Element?{element:t}:"input"===t?o:null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.logDeprecation=function(t){var n=e.DEPRECATED_OPTS[t],r=n.onlyRename,o=n.replacement,i=n.subOption,a=n.link,s='SweetAlert warning: "'+t+'" option has been '+(r?"renamed":"deprecated")+".";o&&(s+=" Please use"+(i?' "'+i+'" in ':" ")+'"'+o+'" instead.');var l="https://sweetalert.js.org";s+=a?" More details: "+l+a:" More details: "+l+"/guides/#upgrading-from-1x",console.warn(s)},e.DEPRECATED_OPTS={type:{replacement:"icon",link:"/docs/#icon"},imageUrl:{replacement:"icon",link:"/docs/#icon"},customClass:{replacement:"className",onlyRename:!0,link:"/docs/#classname"},imageSize:{},showCancelButton:{replacement:"buttons",link:"/docs/#buttons"},showConfirmButton:{replacement:"button",link:"/docs/#button"},confirmButtonText:{replacement:"button",link:"/docs/#button"},confirmButtonColor:{},cancelButtonText:{replacement:"buttons",link:"/docs/#buttons"},closeOnConfirm:{replacement:"button",subOption:"closeModal",link:"/docs/#button"},closeOnCancel:{replacement:"buttons",subOption:"closeModal",link:"/docs/#buttons"},showLoaderOnConfirm:{replacement:"buttons"},animation:{},inputType:{replacement:"content",link:"/docs/#content"},inputValue:{replacement:"content",link:"/docs/#content"},inputPlaceholder:{replacement:"content",link:"/docs/#content"},html:{replacement:"content",link:"/docs/#content"},allowEscapeKey:{replacement:"closeOnEsc",onlyRename:!0,link:"/docs/#closeonesc"},allowClickOutside:{replacement:"closeOnClickOutside",onlyRename:!0,link:"/docs/#closeonclickoutside"}}}])}).call(this,n(150).setImmediate,n(150).clearImmediate)},,function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(31),o=n(88),i="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==o(t)?i.call(t,""):Object(t)}:Object},function(t,e,n){var r=n(52);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports={}},function(t,e,n){var r=n(188),o=n(162).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,e,n){var r=n(50),o=n(105),i=n(64),a=r("unscopables"),s=Array.prototype;null==s[a]&&i.f(s,a,{configurable:!0,value:o(null)}),t.exports=function(t){s[a][t]=!0}},function(t,e,n){var r=n(188),o=n(162);t.exports=Object.keys||function(t){return r(t,o)}},function(t,e){t.exports={}},function(t,e,n){var r=n(119),o=n(52),i=n(60),a=n(64).f,s=n(137),l=n(195),u=s("meta"),c=0,f=Object.isExtensible||function(){return!0},h=function(t){a(t,u,{value:{objectID:"O"+ ++c,weakData:{}}})},d=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,u)){if(!f(t))return"F";if(!e)return"E";h(t)}return t[u].objectID},getWeakData:function(t,e){if(!i(t,u)){if(!f(t))return!0;if(!e)return!1;h(t)}return t[u].weakData},onFreeze:function(t){return l&&d.REQUIRED&&f(t)&&!i(t,u)&&h(t),t}};r[u]=!0},function(t,e,n){var r=n(106);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var r=n(88);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){"use strict";var r=n(118),o=n(64),i=n(116);t.exports=function(t,e,n){var a=r(e);a in t?o.f(t,a,i(0,n)):t[a]=n}},function(t,e,n){var r=n(31),o=n(50),i=n(206),a=o("species");t.exports=function(t){return i>=51||!r((function(){var e=[];return(e.constructor={})[a]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},function(t,e,n){var r=n(59),o=n(49),i=n(139),a=n(172),s=n(64).f,l=n(120).f,u=n(175),c=n(174),f=n(207),h=n(79),d=n(31),p=n(89).set,g=n(205),v=n(50)("match"),y=o.RegExp,m=y.prototype,b=/a/g,w=/a/g,O=new y(b)!==b,C=f.UNSUPPORTED_Y;if(r&&i("RegExp",!O||C||d((function(){return w[v]=!1,y(b)!=b||y(w)==w||"/a/i"!=y(b,"i")})))){for(var E=function(t,e){var n,r=this instanceof E,o=u(t),i=void 0===e;if(!r&&o&&t.constructor===E&&i)return t;O?o&&!i&&(t=t.source):t instanceof E&&(i&&(e=c.call(t)),t=t.source),C&&(n=!!e&&e.indexOf("y")>-1)&&(e=e.replace(/y/g,""));var s=a(O?new y(t,e):y(t,e),r?this:m,E);return C&&n&&p(s,{sticky:n}),s},S=function(t){t in E||s(E,t,{configurable:!0,get:function(){return y[t]},set:function(e){y[t]=e}})},k=l(y),R=0;k.length>R;)S(k[R++]);m.constructor=E,E.prototype=m,h(o,"RegExp",E)}g("RegExp")},function(t,e,n){"use strict";var r=n(145),o=n(57),i=n(62),a=n(65),s=n(176),l=n(146);r("match",1,(function(t,e,n){return[function(e){var n=a(this),r=null==e?void 0:e[t];return void 0!==r?r.call(e,n):new RegExp(e)[t](String(n))},function(t){var r=n(e,t,this);if(r.done)return r.value;var a=o(t),u=String(this);if(!a.global)return l(a,u);var c=a.unicode;a.lastIndex=0;for(var f,h=[],d=0;null!==(f=l(a,u));){var p=String(f[0]);h[d]=p,""===p&&(a.lastIndex=s(u,i(a.lastIndex),c)),d++}return 0===d?null:h}]}))},function(t,e,n){var r=n(26),o=n(104),i=n(106),a=n(57),s=n(52),l=n(105),u=n(239),c=n(31),f=o("Reflect","construct"),h=c((function(){function t(){}return!(f((function(){}),[],t)instanceof t)})),d=!c((function(){f((function(){}))})),p=h||d;r({target:"Reflect",stat:!0,forced:p,sham:p},{construct:function(t,e){i(t),a(e);var n=arguments.length<3?t:i(arguments[2]);if(d&&!h)return f(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(u.apply(t,r))}var o=n.prototype,c=l(s(o)?o:Object.prototype),p=Function.apply.call(t,c,e);return s(p)?p:c}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));n(7),n(80),n(5),n(8),n(9);var r=n(14),o=n(6);function i(t){var e=t.isShiftKey,n=t.isLeftClick,r=t.isRightClick,i=t.coords,a=t.selection,s=t.controller,l=a.isSelected()?a.getSelectedRange().current():null,u=a.isSelectedByCorner(),c=a.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cells?a.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cells?a.setRangeEnd(new o.a(i.row,i.col)):u&&i.row<0&&!s.column?a.setRangeEnd(new o.a(l.to.row,i.col)):c&&i.col<0&&!s.row?a.setRangeEnd(new o.a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?a.selectRows(l.from.row,i.row):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&a.selectColumns(l.from.col,i.col);else{var f=new o.a(i.row,i.col);f.row<0&&(f.row=0),f.col<0&&(f.col=0);var h=!a.inInSelection(f),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&a.selectColumns(i.col):i.col<0&&i.row>=0&&!s.row?d&&a.selectRows(i.row):i.col>=0&&i.row>=0&&!s.cells?d&&a.setRangeStart(i):i.col<0&&i.row<0&&a.setRangeStart(i)}}var a=new Map([["mousedown",i],["mouseover",function(t){var e=t.isLeftClick,n=t.coords,r=t.selection,i=t.controller;if(e){var a=r.isSelectedByRowHeader(),s=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();s&&!i.column?r.setRangeEnd(new o.a(u-1,n.col)):a&&!i.row?r.setRangeEnd(new o.a(n.row,l-1)):i.cell||r.setRangeEnd(n)}}],["touchstart",i]]);function s(t,e){var n=e.coords,o=e.selection,i=e.controller;a.get(t.type)({coords:n,selection:o,controller:i,isShiftKey:t.shiftKey,isLeftClick:Object(r.isLeftClick)(t)||"touchstart"===t.type,isRightClick:Object(r.isRightClick)(t)})}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r,o=n(51);!function(t){t.PENDING="PENDING",t.RESOLVED="RESOLVED",t.REJECTED="REJECTED"}(r||(r={}));var i=function(){function t(t){var e=this;this._state=r.PENDING,this._handlers=[],this._resolve=function(t){e._setResult(r.RESOLVED,t)},this._reject=function(t){e._setResult(r.REJECTED,t)},this._setResult=function(t,n){e._state===r.PENDING&&(Object(o.m)(n)?n.then(e._resolve,e._reject):(e._state=t,e._value=n,e._executeHandlers()))},this._attachHandler=function(t){e._handlers=e._handlers.concat(t),e._executeHandlers()},this._executeHandlers=function(){e._state!==r.PENDING&&(e._state===r.REJECTED?e._handlers.forEach((function(t){t.onrejected&&t.onrejected(e._value)})):e._handlers.forEach((function(t){t.onfulfilled&&t.onfulfilled(e._value)})),e._handlers=[])};try{t(this._resolve,this._reject)}catch(t){this._reject(t)}}return t.prototype.toString=function(){return"[object SyncPromise]"},t.resolve=function(e){return new t((function(t){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.all=function(e){return new t((function(n,r){if(Array.isArray(e))if(0!==e.length){var o=e.length,i=[];e.forEach((function(e,a){t.resolve(e).then((function(t){i[a]=t,0===(o-=1)&&n(i)})).then(null,r)}))}else n([]);else r(new TypeError("Promise.all requires an array as input."))}))},t.prototype.then=function(e,n){var r=this;return new t((function(t,o){r._attachHandler({onfulfilled:function(n){if(e)try{return void t(e(n))}catch(t){return void o(t)}else t(n)},onrejected:function(e){if(n)try{return void t(n(e))}catch(t){return void o(t)}else o(e)}})}))},t.prototype.catch=function(t){return this.then((function(t){return t}),t)},t.prototype.finally=function(e){var n=this;return new t((function(t,r){var o,i;return n.then((function(t){i=!1,o=t,e&&e()}),(function(t){i=!0,o=t,e&&e()})).then((function(){i?r(o):t(o)}))}))},t}()},,function(t,e,n){"use strict";var r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!r.call({1:2},1);e.f=i?function(t){var e=o(this,t);return!!e&&e.enumerable}:r},function(t,e,n){var r=n(160),o=n(137),i=r("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},function(t,e,n){var r=n(90),o=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?o(n+e,0):i(n,e)}},function(t,e,n){var r=n(31),o=/#|\.prototype\./,i=function(t,e){var n=s[a(t)];return n==u||n!=l&&("function"==typeof e?r(e):!!e)},a=i.normalize=function(t){return String(t).replace(o,".").toLowerCase()},s=i.data={},l=i.NATIVE="N",u=i.POLYFILL="P";t.exports=i},function(t,e,n){var r=n(60),o=n(67),i=n(136),a=n(193),s=i("IE_PROTO"),l=Object.prototype;t.exports=a?Object.getPrototypeOf:function(t){return t=o(t),r(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?l:null}},function(t,e,n){var r=n(64).f,o=n(60),i=n(50)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,i)&&r(t,i,{configurable:!0,value:e})}},function(t,e,n){"use strict";var r=n(26),o=n(49),i=n(139),a=n(79),s=n(124),l=n(170),u=n(171),c=n(52),f=n(31),h=n(199),d=n(141),p=n(172);t.exports=function(t,e,n){var g=-1!==t.indexOf("Map"),v=-1!==t.indexOf("Weak"),y=g?"set":"add",m=o[t],b=m&&m.prototype,w=m,O={},C=function(t){var e=b[t];a(b,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!c(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:function(t,n){return e.call(this,0===t?0:t,n),this})};if(i(t,"function"!=typeof m||!(v||b.forEach&&!f((function(){(new m).entries().next()})))))w=n.getConstructor(e,t,g,y),s.REQUIRED=!0;else if(i(t,!0)){var E=new w,S=E[y](v?{}:-0,1)!=E,k=f((function(){E.has(1)})),R=h((function(t){new m(t)})),_=!v&&f((function(){for(var t=new m,e=5;e--;)t[y](e,e);return!t.has(-0)}));R||((w=e((function(e,n){u(e,w,t);var r=p(new m,e,w);return null!=n&&l(n,r[y],r,g),r}))).prototype=b,b.constructor=w),(k||_)&&(C("delete"),C("has"),g&&C("get")),(_||S)&&C(y),v&&b.clear&&delete b.clear}return O[t]=w,r({global:!0,forced:w!=m},O),d(w,t),v||n.setStrong(w,t,g),w}},function(t,e,n){var r=n(104);t.exports=r("navigator","userAgent")||""},function(t,e,n){"use strict";var r,o,i=n(174),a=n(207),s=RegExp.prototype.exec,l=String.prototype.replace,u=s,c=(r=/a/,o=/b*/g,s.call(r,"a"),s.call(o,"a"),0!==r.lastIndex||0!==o.lastIndex),f=a.UNSUPPORTED_Y||a.BROKEN_CARET,h=void 0!==/()??/.exec("")[1];(c||h||f)&&(u=function(t){var e,n,r,o,a=this,u=f&&a.sticky,d=i.call(a),p=a.source,g=0,v=t;return u&&(-1===(d=d.replace("y","")).indexOf("g")&&(d+="g"),v=String(t).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==t[a.lastIndex-1])&&(p="(?: "+p+")",v=" "+v,g++),n=new RegExp("^(?:"+p+")",d)),h&&(n=new RegExp("^"+p+"$(?!\\s)",d)),c&&(e=a.lastIndex),r=s.call(u?n:a,v),u?r?(r.input=r.input.slice(g),r[0]=r[0].slice(g),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:c&&r&&(a.lastIndex=a.global?r.index+r[0].length:e),h&&r&&r.length>1&&l.call(r[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)})),r}),t.exports=u},function(t,e,n){"use strict";n(33);var r=n(79),o=n(31),i=n(50),a=n(144),s=n(78),l=i("species"),u=!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),c="$0"==="a".replace(/./,"$0"),f=i("replace"),h=!!/./[f]&&""===/./[f]("a","$0"),d=!o((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));t.exports=function(t,e,n,f){var p=i(t),g=!o((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),v=g&&!o((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[l]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return e=!0,null},n[p](""),!e}));if(!g||!v||"replace"===t&&(!u||!c||h)||"split"===t&&!d){var y=/./[p],m=n(p,""[t],(function(t,e,n,r,o){return e.exec===a?g&&!o?{done:!0,value:y.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),{REPLACE_KEEPS_$0:c,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:h}),b=m[0],w=m[1];r(String.prototype,t,b),r(RegExp.prototype,p,2==e?function(t,e){return w.call(t,this,e)}:function(t){return w.call(t,this)})}f&&s(RegExp.prototype[p],"sham",!0)}},function(t,e,n){var r=n(88),o=n(144);t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var i=n.call(t,e);if("object"!=typeof i)throw TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(t))throw TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},function(t,e,n){"use strict";var r=n(26),o=n(208).trim;r({target:"String",proto:!0,forced:n(234)("trim")},{trim:function(){return o(this)}})},function(t,e,n){"use strict";var r=n(26),o=n(126),i=[].reverse,a=[1,2];r({target:"Array",proto:!0,forced:String(a)===String(a.reverse())},{reverse:function(){return o(this)&&(this.length=this.length),i.call(this)}})},function(t,e,n){"use strict";var r=n(26),o=n(84).find,i=n(121),a=n(68),s=!0,l=a("find");"find"in[]&&Array(1).find((function(){s=!1})),r({target:"Array",proto:!0,forced:s||!l},{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("find")},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(242),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(115))},function(t,e,n){"use strict";var r=n(26),o=n(84).map,i=n(128),a=n(68),s=i("map"),l=a("map");r({target:"Array",proto:!0,forced:!s||!l},{map:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){"use strict";var r,o=n(26),i=n(83).f,a=n(62),s=n(177),l=n(65),u=n(178),c=n(103),f="".startsWith,h=Math.min,d=u("startsWith");o({target:"String",proto:!0,forced:!!(c||d||(r=i(String.prototype,"startsWith"),!r||r.writable))&&!d},{startsWith:function(t){var e=String(l(this));s(t);var n=a(h(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return f?f.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";function r(t){var e=new Date(t);return isNaN(new Date("".concat(t,"T00:00")).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}n.r(e),n.d(e,"getNormalizedDate",(function(){return r}))},function(t,e,n){"use strict";n(10),n(11),n(12),n(7),n(5),n(8),n(9);var r=n(13),o=n(2);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(){}a.prototype={licenseKey:void 0,data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:{autoInsertRow:!1},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!0,autoWrapCol:!0,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(t){var e,n,a,s;for(e=0,n=this.countCols();e<n;e++)if(""!==(a=this.getDataAtCell(t,e))&&null!==a&&Object(r.isDefined)(a))return"object"===i(a)&&(s=this.getCellMeta(t,e),Object(o.isObjectEqual)(this.getSchema()[s.prop],a));return!0},isEmptyCol:function(t){var e,n,o;for(e=0,n=this.countRows();e<n;e++)if(""!==(o=this.getDataAtCell(e,t))&&null!==o&&Object(r.isDefined)(o))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,skipRowOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,manualColumnFreeze:void 0,trimWhitespace:!0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,preventWheel:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0,nestedRows:void 0},e.a=a},function(t,e,n){"use strict";var r=n(1),o=n(76),i=n(61);n(92),n(93);var a=Object(i.a)("phraseFormatters"),s=a.register,l=a.getValues;s("pluralize",(function(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}));var u=n(13);function c(t,e,n){var i=Object(o.b)(t);if(null===i)return null;var a=i[e];if(Object(u.isUndefined)(a))return null;var s=function(t,e){var n=t;return Object(r.arrayEach)(function(){return l()}(),(function(r){n=r(t,e)})),n}(a,n);return Array.isArray(s)?s[0]:s}n.d(e,"a",(function(){return c}))},function(t,e,n){
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * json-patch-duplex.js version: 0.5.7
 * (c) 2013 Joachim Wester
 * MIT license
 */
var r,o=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=Error;!function(t){var e=function(t){if(l(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e};var n={add:function(t,e){return t[e]=this.value,!0},remove:function(t,e){return delete t[e],!0},replace:function(t,e){return t[e]=this.value,!0},move:function(t,e,n){var r={op:"_get",path:this.from};return v(n,[r]),v(n,[{op:"remove",path:this.from}]),v(n,[{op:"add",path:this.path,value:r.value}]),!0},copy:function(t,e,n){var r={op:"_get",path:this.from};return v(n,[r]),v(n,[{op:"add",path:this.path,value:r.value}]),!0},test:function(t,n){return function t(n,r){switch(typeof n){case"undefined":case"boolean":case"string":case"number":return n===r;case"object":if(null===n)return null===r;if(l(n)){if(!l(r)||n.length!==r.length)return!1;for(var o=0,i=n.length;o<i;o++)if(!t(n[o],r[o]))return!1;return!0}var a=e(r).length;if(e(n).length!==a)return!1;for(o=0;o<a;o++)if(!t(n[o],r[o]))return!1;return!0;default:return!1}}(t[n],this.value)},_get:function(t,e){this.value=t[e]}},r={add:function(t,e){return t.splice(e,0,this.value),!0},remove:function(t,e){return t.splice(e,1),!0},replace:function(t,e){return t[e]=this.value,!0},move:n.move,copy:n.copy,test:n.test,_get:n._get},a={add:function(t){for(var e in a.remove.call(this,t),this.value)this.value.hasOwnProperty(e)&&(t[e]=this.value[e]);return!0},remove:function(t){for(var e in t)t.hasOwnProperty(e)&&n.remove.call(this,t,e);return!0},replace:function(t){return v(t,[{op:"remove",path:this.path}]),v(t,[{op:"add",path:this.path,value:this.value}]),!0},move:n.move,copy:n.copy,test:function(t){return JSON.stringify(t)===JSON.stringify(this.value)},_get:function(t){this.value=t}};function s(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}var l,u=[],c=function(t){this.observers=[],this.obj=t},f=function(t,e){this.callback=t,this.observer=e};function h(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function d(t){for(var e,n=0,r=u.length;n<r;n++)if(u[n].obj===t.object){e=u[n];break}p(e.value,t.object,t.patches,""),t.patches.length&&v(e.value,t.patches);var o=t.patches;return o.length>0&&(t.patches=[],t.callback&&t.callback(o)),o}function p(t,n,r,o){for(var i=e(n),a=e(t),l=!1,u=a.length-1;u>=0;u--){var c=t[d=a[u]];if(n.hasOwnProperty(d)){var f=n[d];"object"==typeof c&&null!=c&&"object"==typeof f&&null!=f?p(c,f,r,o+"/"+s(d)):c!=f&&(!0,r.push({op:"replace",path:o+"/"+s(d),value:h(f)}))}else r.push({op:"remove",path:o+"/"+s(d)}),l=!0}if(l||i.length!=a.length)for(u=0;u<i.length;u++){var d=i[u];t.hasOwnProperty(d)||r.push({op:"add",path:o+"/"+s(d),value:h(n[d])})}}function g(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function v(t,e,o){for(var i,s,u=!1,c=0,f=e.length;c<f;){i=e[c],c++;for(var h=(i.path||"").split("/"),d=t,p=1,v=h.length,m=void 0;;){if(s=h[p],o&&void 0===m&&(void 0===d[s]?m=h.slice(0,p).join("/"):p==v-1&&(m=i.path),void 0!==m&&this.validator(i,c-1,t,m)),p++,void 0===s&&p>=v){u=a[i.op].call(i,d,s,t);break}if(l(d)){if("-"===s)s=d.length;else{if(o&&!g(s))throw new y("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",c-1,i.path,i);s=parseInt(s,10)}if(p>=v){if(o&&"add"===i.op&&s>d.length)throw new y("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",c-1,i.path,i);u=r[i.op].call(i,d,s,t);break}}else if(s&&-1!=s.indexOf("~")&&(s=s.replace(/~1/g,"/").replace(/~0/g,"~")),p>=v){u=n[i.op].call(i,d,s,t);break}d=d[s]}}return u}t.unobserve=function(t,e){e.unobserve()},t.observe=function(t,e){var n,r=function(t){for(var e=0,n=u.length;e<n;e++)if(u[e].obj===t)return u[e]}(t);if(r?n=function(t,e){for(var n=0,r=t.observers.length;n<r;n++)if(t.observers[n].callback===e)return t.observers[n].observer}(r,e):(r=new c(t),u.push(r)),n)return n;if(n={},r.value=h(t),e){n.callback=e,n.next=null;var o=this.intervals||[100,1e3,1e4,6e4];if(void 0===o.push)throw new i("jsonpatch.intervals must be an array");var a=0,s=function(){d(n)},l=function(){clearTimeout(n.next),n.next=setTimeout((function(){s(),a=0,n.next=setTimeout(p,o[a++])}),0)},p=function(){s(),a==o.length&&(a=o.length-1),n.next=setTimeout(p,o[a++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",l),window.addEventListener("mouseup",l),window.addEventListener("keydown",l)):(document.documentElement.attachEvent("onmousedown",l),document.documentElement.attachEvent("onmouseup",l),document.documentElement.attachEvent("onkeydown",l))),n.next=setTimeout(p,o[a++])}return n.patches=[],n.object=t,n.unobserve=function(){d(n),clearTimeout(n.next),function(t,e){for(var n=0,r=t.observers.length;n<r;n++)if(t.observers[n].observer===e)return void t.observers.splice(n,1)}(r,n),0===r.observers.length&&u.splice(u.indexOf(r),1),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",l),window.removeEventListener("mouseup",l),window.removeEventListener("keydown",l)):(document.documentElement.detachEvent("onmousedown",l),document.documentElement.detachEvent("onmouseup",l),document.documentElement.detachEvent("onkeydown",l)))},r.observers.push(new f(e,n)),n},t.generate=d,l=Array.isArray?Array.isArray:function(t){return t.push&&"number"==typeof t.length},t.apply=v,t.compare=function(t,e){var n=[];return p(t,e,n,""),n};var y=function(t){function e(e,n,r,o,i){t.call(this,e),this.message=e,this.name=n,this.index=r,this.operation=o,this.tree=i}return o(e,t),e}(i);t.JsonPatchError=y,t.Error=y,t.validator=function(e,r,o,i){if("object"!=typeof e||null===e||l(e))throw new y("Operation is not an object","OPERATION_NOT_AN_OBJECT",r,e,o);if(!n[e.op])throw new y("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",r,e,o);if("string"!=typeof e.path)throw new y("Operation `path` property is not a string","OPERATION_PATH_INVALID",r,e,o);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new y("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",r,e,o);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new y("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",r,e,o);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&function t(e){if(void 0===e)return!0;if("array"==typeof e||"object"==typeof e)for(var n in e)if(t(e[n]))return!0;return!1}(e.value))throw new y("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",r,e,o);if(o)if("add"==e.op){var a=e.path.split("/").length,s=i.split("/").length;if(a!==s+1&&a!==s)throw new y("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",r,e,o)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==i)throw new y("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",r,e,o)}else if("move"===e.op||"copy"===e.op){var u={op:"_get",path:e.from,value:void 0},c=t.validate([u],o);if(c&&"OPERATION_PATH_UNRESOLVABLE"===c.name)throw new y("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",r,e,o)}},t.validate=function(t,e){try{if(!l(t))throw new y("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)e=JSON.parse(JSON.stringify(e)),v.call(this,e,t,!0);else for(var n=0;n<t.length;n++)this.validator(t[n],n)}catch(t){if(t instanceof y)return t;throw t}}}(r||(r={})),e.apply=r.apply,e.observe=r.observe,e.unobserve=r.unobserve,e.generate=r.generate,e.compare=r.compare,e.validate=r.validate,e.validator=r.validator,e.JsonPatchError=r.JsonPatchError,e.Error=r.Error},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));var r=n(16),o=n(133),i=n(51),a=n(42),s=function(){function t(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._user={},this._tags={},this._extra={},this._context={}}return t.prototype.addScopeListener=function(t){this._scopeListeners.push(t)},t.prototype.addEventProcessor=function(t){return this._eventProcessors.push(t),this},t.prototype._notifyScopeListeners=function(){var t=this;this._notifyingListeners||(this._notifyingListeners=!0,setTimeout((function(){t._scopeListeners.forEach((function(e){e(t)})),t._notifyingListeners=!1})))},t.prototype._notifyEventProcessors=function(t,e,n,a){var s=this;return void 0===a&&(a=0),new o.a((function(o,l){var u=t[a];if(null===e||"function"!=typeof u)o(e);else{var c=u(r.a({},e),n);Object(i.m)(c)?c.then((function(e){return s._notifyEventProcessors(t,e,n,a+1).then(o)})).then(null,l):s._notifyEventProcessors(t,c,n,a+1).then(o).then(null,l)}}))},t.prototype.setUser=function(t){return this._user=t||{},this._notifyScopeListeners(),this},t.prototype.setTags=function(t){return this._tags=r.a({},this._tags,t),this._notifyScopeListeners(),this},t.prototype.setTag=function(t,e){var n;return this._tags=r.a({},this._tags,((n={})[t]=e,n)),this._notifyScopeListeners(),this},t.prototype.setExtras=function(t){return this._extra=r.a({},this._extra,t),this._notifyScopeListeners(),this},t.prototype.setExtra=function(t,e){var n;return this._extra=r.a({},this._extra,((n={})[t]=e,n)),this._notifyScopeListeners(),this},t.prototype.setFingerprint=function(t){return this._fingerprint=t,this._notifyScopeListeners(),this},t.prototype.setLevel=function(t){return this._level=t,this._notifyScopeListeners(),this},t.prototype.setTransaction=function(t){return this._transaction=t,this._span&&(this._span.transaction=t),this._notifyScopeListeners(),this},t.prototype.setContext=function(t,e){var n;return this._context=r.a({},this._context,((n={})[t]=e,n)),this._notifyScopeListeners(),this},t.prototype.setSpan=function(t){return this._span=t,this._notifyScopeListeners(),this},t.prototype.getSpan=function(){return this._span},t.clone=function(e){var n=new t;return e&&(n._breadcrumbs=r.d(e._breadcrumbs),n._tags=r.a({},e._tags),n._extra=r.a({},e._extra),n._context=r.a({},e._context),n._user=e._user,n._level=e._level,n._span=e._span,n._transaction=e._transaction,n._fingerprint=e._fingerprint,n._eventProcessors=r.d(e._eventProcessors)),n},t.prototype.clear=function(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._context={},this._level=void 0,this._transaction=void 0,this._fingerprint=void 0,this._span=void 0,this._notifyScopeListeners(),this},t.prototype.addBreadcrumb=function(t,e){var n=r.a({timestamp:Object(a.m)()},t);return this._breadcrumbs=void 0!==e&&e>=0?r.d(this._breadcrumbs,[n]).slice(-e):r.d(this._breadcrumbs,[n]),this._notifyScopeListeners(),this},t.prototype.clearBreadcrumbs=function(){return this._breadcrumbs=[],this._notifyScopeListeners(),this},t.prototype._applyFingerprint=function(t){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],this._fingerprint&&(t.fingerprint=t.fingerprint.concat(this._fingerprint)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint},t.prototype.applyToEvent=function(t,e){return this._extra&&Object.keys(this._extra).length&&(t.extra=r.a({},this._extra,t.extra)),this._tags&&Object.keys(this._tags).length&&(t.tags=r.a({},this._tags,t.tags)),this._user&&Object.keys(this._user).length&&(t.user=r.a({},this._user,t.user)),this._context&&Object.keys(this._context).length&&(t.contexts=r.a({},this._context,t.contexts)),this._level&&(t.level=this._level),this._transaction&&(t.transaction=this._transaction),this._applyFingerprint(t),t.breadcrumbs=r.d(t.breadcrumbs||[],this._breadcrumbs),t.breadcrumbs=t.breadcrumbs.length>0?t.breadcrumbs:void 0,this._notifyEventProcessors(r.d(l(),this._eventProcessors),t,e)},t}();function l(){var t=Object(a.g)();return t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.globalEventProcessors=t.__SENTRY__.globalEventProcessors||[],t.__SENTRY__.globalEventProcessors}function u(t){l().push(t)}},function(t,e,n){var r=n(49),o=n(52),i=r.document,a=o(i)&&o(i.createElement);t.exports=function(t){return a?i.createElement(t):{}}},function(t,e,n){var r=n(49),o=n(78);t.exports=function(t,e){try{o(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){var r=n(103),o=n(183);(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.4",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var r=n(72),o=n(62),i=n(138),a=function(t){return function(e,n,a){var s,l=r(e),u=o(l.length),c=i(a,u);if(t&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((t||c in l)&&l[c]===n)return t||c||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(31);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(t,e,n){"use strict";var r=n(26),o=n(229),i=n(140),a=n(166),s=n(141),l=n(78),u=n(79),c=n(50),f=n(103),h=n(123),d=n(192),p=d.IteratorPrototype,g=d.BUGGY_SAFARI_ITERATORS,v=c("iterator"),y=function(){return this};t.exports=function(t,e,n,c,d,m,b){o(n,e,c);var w,O,C,E=function(t){if(t===d&&T)return T;if(!g&&t in R)return R[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},S=e+" Iterator",k=!1,R=t.prototype,_=R[v]||R["@@iterator"]||d&&R[d],T=!g&&_||E(d),M="Array"==e&&R.entries||_;if(M&&(w=i(M.call(new t)),p!==Object.prototype&&w.next&&(f||i(w)===p||(a?a(w,p):"function"!=typeof w[v]&&l(w,v,y)),s(w,S,!0,!0),f&&(h[S]=y))),"values"==d&&_&&"values"!==_.name&&(k=!0,T=function(){return _.call(this)}),f&&!b||R[v]===T||l(R,v,T),h[e]=T,d)if(O={values:E("values"),keys:m?T:E("keys"),entries:E("entries")},b)for(C in O)!g&&!k&&C in R||u(R,C,O[C]);else r({target:e,proto:!0,forced:g||k},O);return O}},function(t,e,n){var r=n(57),o=n(230);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,i){return r(n),o(i),e?t.call(n,i):n.__proto__=i,n}}():void 0)},function(t,e,n){var r={};r[n(50)("toStringTag")]="z",t.exports="[object z]"===String(r)},function(t,e,n){var r=n(90),o=n(65),i=function(t){return function(e,n){var i,a,s=String(o(e)),l=r(n),u=s.length;return l<0||l>=u?t?"":void 0:(i=s.charCodeAt(l))<55296||i>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):i:t?s.slice(l,l+2):a-56320+(i-55296<<10)+65536}};t.exports={codeAt:i(!1),charAt:i(!0)}},function(t,e,n){var r=n(79);t.exports=function(t,e,n){for(var o in e)r(t,o,e[o],n);return t}},function(t,e,n){var r=n(57),o=n(196),i=n(62),a=n(125),s=n(197),l=n(198),u=function(t,e){this.stopped=t,this.result=e};(t.exports=function(t,e,n,c,f){var h,d,p,g,v,y,m,b=a(e,n,c?2:1);if(f)h=t;else{if("function"!=typeof(d=s(t)))throw TypeError("Target is not iterable");if(o(d)){for(p=0,g=i(t.length);g>p;p++)if((v=c?b(r(m=t[p])[0],m[1]):b(t[p]))&&v instanceof u)return v;return new u(!1)}h=d.call(t)}for(y=h.next;!(m=y.call(h)).done;)if("object"==typeof(v=l(h,b,m.value,c))&&v&&v instanceof u)return v;return new u(!1)}).stop=function(t){return new u(!0,t)}},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}},function(t,e,n){var r=n(52),o=n(166);t.exports=function(t,e,n){var i,a;return o&&"function"==typeof(i=e.constructor)&&i!==n&&r(a=i.prototype)&&a!==n.prototype&&o(t,a),t}},function(t,e,n){var r=n(52),o=n(126),i=n(50)("species");t.exports=function(t,e){var n;return o(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!o(n.prototype)?r(n)&&null===(n=n[i])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},function(t,e,n){"use strict";var r=n(57);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var r=n(52),o=n(88),i=n(50)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==o(t))}},function(t,e,n){"use strict";var r=n(168).charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},function(t,e,n){var r=n(175);t.exports=function(t){if(r(t))throw TypeError("The method doesn't accept regular expressions");return t}},function(t,e,n){var r=n(50)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,"/./"[t](e)}catch(t){}}return!1}},function(t,e){(function(){var t,e,n,r,o,i;o=void 0,d3.ternary={},n=Math.sqrt(3)/2,tickValues=[.2,.4,.6,.8,1],i=function(){var t,e,n,r;for(r="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",t=0;t<=3;++t)e=Math.floor(Math.random()*n.length),r+=n.charAt(e);return r},r=function(t){return t||(t="linear"),o=d3.svg.line().x((function(t){return t[0]})).y((function(t){return t[1]})).interpolate(t)},e=[0,120,240],d3.ternary.graticule=function(){var t,e,n,r,o;return e=.1,r=null,n=function(){var t,n,r;for(r=[],n=t=e;n<1;)r.push(n),n+=t;return r},o=function(){var t,n;if(n=[],null==r)return n;for(t=r;t<1;)t%e!=0&&n.push(t),t+=r;return n},(t=function(t){var e,r;return r=[0,1,2].map((function(){return d3.svg.axis().tickValues(n())})),e=function(e,r){var a,s,l,u;return a=d3.select(this),(l=a.selectAll("path.minor").data(o())).enter().append("path").attr("class",`minor axis-${r}`),(u=a.selectAll("path.major").data(n())).enter().append("path").attr("class",`major axis-${r}`),s=function(){return e.scale(t.scales[r]),l.attr("d",t.rule(r)),u.attr("d",t.rule(r))},t.on("resize."+i(),s),s()},t.axes().selectAll(".graticule").data(r).enter().append("g").attr("class","graticule").each(e)}).axes=function(){return gratAxes},t.majorInterval=function(n){return n?(e=n,t):e},t.minorInterval=function(e){return e?(r=e,t):r},t},d3.ternary.scalebars=function(t){var n,r,o,a,s,l;return null==t&&(t={}),s=null,a=t.labels||null,r=[0,1,2].map((function(t){return d3.svg.axis().tickSize(10).tickFormat(d3.format("%")).tickValues(tickValues).orient("top")})),n=function(t,e){return 0===e?d3.select(this).selectAll("text").attr("transform",(function(t){const e=d3.select(this).attr("y");return"translate(22 "+-e+") rotate(60 0 "+4.5*e+")"}))&&d3.select(this).selectAll("line").attr("transform",(function(t){const e=d3.select(this).attr("y");return"translate(0 "+-e+") rotate(-30 0 "+1*e+")"})):d3.select(this).selectAll("text").attr("transform",(function(t){const e=d3.select(this).attr("y");return"translate(-27 "+-e+") rotate(-120 0 "+2.5*e+")"}))&&d3.select(this).selectAll("line").attr("transform",(function(t){const e=d3.select(this).attr("y");return"translate(0 "+-e+") rotate(-30 0 "+1*e+")"}))},o=function(t,e){var n,r,o;return n=-30,r="translate("+(o=s.width())/2+")",2===e&&(n=42,r=" rotate(-180 0 0) translate("+-o/2+")"),d3.select(this).attr("class","label").attr("transform",r).attr("y",n).attr("text-anchor","middle").text(t)},(l=function(t){var l,u;return(l=(s=t).axes().selectAll(".bary-axis").data(e).enter().append("g").attr("class",(function(t,e){return t="bary-axis",2===e&&(t+=" bottom"),t}))).each((function(){return d3.select(this).append("text").attr("class","label")})),u=function(){var t,e,i;if(r.forEach((function(t,e){var n;return n=s.scales[e].copy(),t.scale(n)})),i=s.radius(),e=s.center(),l.each((function(t,e){var n;return n=d3.select(this),r[e](n)})).attr("transform",(function(t,n){return"rotate("+(120*n-60)+" "+e[0]+" "+e[1]+") translate(0 "+i/2+")"})).each(n),t)return s.axes().selectAll(".bary-axis .label").data(a).each(o)},s.on("resize."+i(),u),u()}).labels=function(t){return null==t?a:(a=t,l)},l.axes=r,l},d3.ternary.vertexLabels=function(t){var e=null,n=[0,60,-60];return function(r){var o,a,s;return s=r.vertices(20),o=t.map((function(t,e){return{label:t,vertex:s[e]}})),(e=r.axes().selectAll(".vertex-label").data(o)).enter().append("text").text((function(t){return t.label})).attr("dy",".35em").attr("text-anchor","middle").attr("class",(function(t){return"vertex-label "+t.label.toLowerCase()})),a=function(){return e.attr({transform:function(t,e){var r;return"translate("+(r=t.vertex)[0]+","+r[1]+")rotate("+n[e]+")"}})},r.on("resize."+i(),a),a(),e}},d3.ternary.neatline=function(){return function(t){return t.node().append("use").attr("class","neatline").attr("xlink:href","#bounds")}},t=function(t){var e,n,r,o,a,s,l,u,c;for(r=t.scales.map((function(t){return t.domain()})),u=[],s=l=0;l<=2;s=++l)-1===(c=s-1)&&(c=2),(n=r.map((function(t){return t[0]})))[c]=r[c][1],u.push(n),(n=r.map((function(t){return t[0]})))[s]=r[s][1],u.push(n);return e=d3.select(this),null==(a=e.select("#bounds")).node()&&(a=e.append("polygon")),a.datum(u).attr({id:"bounds"}),o=function(){return a.attr({points:function(e){return e.map((function(e){return(s=t.rawPoint(e)).join(",")})).join(" ")}})},t.on("resize."+i(),o),o()},d3.ternary.plot=function(){var e,i,a,s,l,u,c,f,h,d,p,g,v,y,m,b,w,O;return p=500,d=500,h={top:50,bottom:50,left:50,right:50},v=null,u=null,O=null,w=null,i=null,g=null,s=null,b=!1,a=[],m=[0,1,2].map((function(){return d3.scale.linear().domain([0,1]).range([0,1])})),l=d3.dispatch("resize"),f=function(t){return t-h.left-h.right},c=function(t){return t-h.top-h.bottom},y=function(){var n,r;if(null==O&&(O=f(p)),null==u&&(u=c(d)),null==v&&(v=O/Math.sqrt(3)),[O/2,v],null!=w){for(w.attr({transform:"translate("+h.left+","+h.top+")",width:O,height:u}),d3.select(w.node().parentElement).attr({width:p,height:d}),n=0,r=m.length;n<r;n++)m[n].range([0,O]);return t.call(s.node(),e),l.resize()}},(e=function(t){return w=t.append("g"),s=w.append("defs"),i=w.append("g").attr("id","axes"),g=w.append("g").attr("id","plot"),y(),s.append("clipPath").attr({id:"axesClip"}).append("use").attr({"xlink:href":"#bounds"}),a&&a.forEach((function(t){return t(e)})),a=[]}).on=function(t,e){return l.on(t,e)},e.fit=function(t,r){var o,i,a;return 2===arguments.length?(i=f(t),a=(o=c(r))<=n*i?2*o/3:i/Math.sqrt(3)):a=i/Math.sqrt(3),e.radius(a),e},e.node=function(){return w},e.axes=function(){return i},e.plot=function(){return g},e.call=function(t){return null!=w?t(e):a.push(t),e},e.scales=m,e.margin=function(t){return null==t?h:(h=null!=t.left?t:{left:t,right:t,top:t,bottom:t},y(),e)},e.point=function(t){var n;return 0!==(n=d3.sum(t))&&(t=t.map((function(t){return t/n}))),e.rawPoint(t)},e.rawPoint=function(t){var e,r,o,i;return 0===d3.sum(t)?[0,0]:(e=m[0],r=m[1],m[2],o=t[0],i=t[1],t[2],[e(o)/2+r(i),r((1-o)*n)])},e.value=function(t){var e,r,o,i,a,s;return a=t[0],s=t[1],e=m[0],r=m[1],m[2],[o=1-r.invert(s)/n,i=r.invert(a-e(o)/2),1-o-i]},e.path=function(t,n,i){var a;return r(i),n||(n=function(t){return t}),a=t.map((function(t){return e.point(n(t))})),o(a)},e.area=function(t,n,i){var a;return r(i),n||(n=function(t){return t}),a=t.map((function(t){return e.point(n(t))})),o(a)+"Z"},e.rule=function(t){return function(n){var r;return r=[],0===t?r=[[0,1-n,n],[1-n,0,n]]:1===t?r=[[0,n,1-n],[1-n,n,0]]:2===t&&(r=[[n,0,1-n],[n,1-n,0]]),e.path(r)}},e.vertices=function(t){return null==t&&(t=0),[0,-120,120].map((function(e){var n;return n=e*Math.PI/180,[O/2+Math.sin(n)*(v+t),v-Math.cos(n)*(v+t)]}))},e.range=function(t){return e},e.radius=function(t){return null==t?v:(v=t,u=3*t/2,O=t*Math.sqrt(3),d=u+h.top+h.bottom,p=O+h.left+h.right,y(),e)},e.center=function(){return[O/2,v]},e.height=function(){return u},e.width=function(){return O},e.clip=function(t){return null==t?b:(b=t,e)},e}}).call(this),t.exports=d3.ternary},function(t,e,n){
/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */
!function(e,r){"use strict";var o;try{o=n(28)}catch(t){}t.exports=function(t){var e="function"==typeof t,n=!!window.addEventListener,r=window.document,o=window.setTimeout,i=function(t,e,r,o){n?t.addEventListener(e,r,!!o):t.attachEvent("on"+e,r)},a=function(t,e,r,o){n?t.removeEventListener(e,r,!!o):t.detachEvent("on"+e,r)},s=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},l=function(t,e){s(t,e)||(t.className=""===t.className?e:t.className+" "+e)},u=function(t,e){var n;t.className=(n=(" "+t.className+" ").replace(" "+e+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,"")},c=function(t){return/Array/.test(Object.prototype.toString.call(t))},f=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},h=function(t){var e=t.getDay();return 0===e||6===e},d=function(t){return t%4==0&&t%100!=0||t%400==0},p=function(t,e){return[31,d(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},g=function(t){f(t)&&t.setHours(0,0,0,0)},v=function(t,e){return t.getTime()===e.getTime()},y=function(t,e,n){var r,o;for(r in e)(o=void 0!==t[r])&&"object"==typeof e[r]&&null!==e[r]&&void 0===e[r].nodeName?f(e[r])?n&&(t[r]=new Date(e[r].getTime())):c(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=y({},e[r],n):!n&&o||(t[r]=e[r]);return t},m=function(t,e,n){var o;r.createEvent?((o=r.createEvent("HTMLEvents")).initEvent(e,!0,!1),o=y(o,n),t.dispatchEvent(o)):r.createEventObject&&(o=r.createEventObject(),o=y(o,n),t.fireEvent("on"+e,o))},b=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},w={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},O=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},C=function(t){var e=[],n="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},E=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},S=function(t,e,n,r,o,i){var a,s,l,u,f,h=t._o,d=n===h.minYear,p=n===h.maxYear,g='<div id="'+i+'" class="pika-title" role="heading" aria-live="assertive">',v=!0,y=!0;for(l=[],a=0;a<12;a++)l.push('<option value="'+(n===o?a-e:12+a-e)+'"'+(a===r?' selected="selected"':"")+(d&&a<h.minMonth||p&&a>h.maxMonth?'disabled="disabled"':"")+">"+h.i18n.months[a]+"</option>");for(u='<div class="pika-label">'+h.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",c(h.yearRange)?(a=h.yearRange[0],s=h.yearRange[1]+1):(a=n-h.yearRange,s=1+n+h.yearRange),l=[];a<s&&a<=h.maxYear;a++)a>=h.minYear&&l.push('<option value="'+a+'"'+(a===n?' selected="selected"':"")+">"+a+"</option>");return f='<div class="pika-label">'+n+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",h.showMonthAfterYear?g+=f+u:g+=u+f,d&&(0===r||h.minMonth>=r)&&(v=!1),p&&(11===r||h.maxMonth<=r)&&(y=!1),0===e&&(g+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(g+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),g+"</div>"},k=function(a){var l=this,u=l.config(a);l._onMouseDown=function(t){if(l._v){var e=(t=t||window.event).target||t.srcElement;if(e)if(s(e,"is-disabled")||(!s(e,"pika-button")||s(e,"is-empty")||s(e.parentNode,"is-disabled")?s(e,"pika-prev")?l.prevMonth():s(e,"pika-next")&&l.nextMonth():(l.setDate(new Date(e.getAttribute("data-pika-year"),e.getAttribute("data-pika-month"),e.getAttribute("data-pika-day"))),u.bound&&o((function(){l.hide(),u.blurFieldOnSelect&&u.field&&u.field.blur()}),100))),s(e,"pika-select"))l._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}}},l._onChange=function(t){var e=(t=t||window.event).target||t.srcElement;e&&(s(e,"pika-select-month")?l.gotoMonth(e.value):s(e,"pika-select-year")&&l.gotoYear(e.value))},l._onKeyChange=function(t){if(t=t||window.event,l.isVisible())switch(t.keyCode){case 13:case 27:u.field&&u.field.blur();break;case 37:t.preventDefault(),l.adjustDate("subtract",1);break;case 38:l.adjustDate("subtract",7);break;case 39:l.adjustDate("add",1);break;case 40:l.adjustDate("add",7)}},l._onInputChange=function(n){var r;n.firedBy!==l&&(r=u.parse?u.parse(u.field.value,u.format):e?(r=t(u.field.value,u.format,u.formatStrict))&&r.isValid()?r.toDate():null:new Date(Date.parse(u.field.value)),f(r)&&l.setDate(r),l._v||l.show())},l._onInputFocus=function(){l.show()},l._onInputClick=function(){l.show()},l._onInputBlur=function(){var t=r.activeElement;do{if(s(t,"pika-single"))return}while(t=t.parentNode);l._c||(l._b=o((function(){l.hide()}),50)),l._c=!1},l._onClick=function(t){var e=(t=t||window.event).target||t.srcElement,r=e;if(e){!n&&s(e,"pika-select")&&(e.onchange||(e.setAttribute("onchange","return;"),i(e,"change",l._onChange)));do{if(s(r,"pika-single")||r===u.trigger)return}while(r=r.parentNode);l._v&&e!==u.trigger&&r!==u.trigger&&l.hide()}},l.el=r.createElement("div"),l.el.className="pika-single"+(u.isRTL?" is-rtl":"")+(u.theme?" "+u.theme:""),i(l.el,"mousedown",l._onMouseDown,!0),i(l.el,"touchend",l._onMouseDown,!0),i(l.el,"change",l._onChange),u.keyboardInput&&i(r,"keydown",l._onKeyChange),u.field&&(u.container?u.container.appendChild(l.el):u.bound?r.body.appendChild(l.el):u.field.parentNode.insertBefore(l.el,u.field.nextSibling),i(u.field,"change",l._onInputChange),u.defaultDate||(e&&u.field.value?u.defaultDate=t(u.field.value,u.format).toDate():u.defaultDate=new Date(Date.parse(u.field.value)),u.setDefaultDate=!0));var c=u.defaultDate;f(c)?u.setDefaultDate?l.setDate(c,!0):l.gotoDate(c):l.gotoDate(new Date),u.bound?(this.hide(),l.el.className+=" is-bound",i(u.trigger,"click",l._onInputClick),i(u.trigger,"focus",l._onInputFocus),i(u.trigger,"blur",l._onInputBlur)):this.show()};return k.prototype={config:function(t){this._o||(this._o=y({},w,!0));var e=y(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;var n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,f(e.minDate)||(e.minDate=!1),f(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),c(e.yearRange)){var r=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||w.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,f(this._d)?this._o.toString?this._o.toString(this._d,n):e?t(this._d).format(n):this._d.toDateString():""},getMoment:function(){return e?t(this._d):null},setMoment:function(n,r){e&&t.isMoment(n)&&this.setDate(n.toDate(),r)},getDate:function(){return f(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",m(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),f(t)){var n=this._o.minDate,r=this._o.maxDate;f(n)&&t<n?t=n:f(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),g(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),m(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(t){var e=!0;if(f(t)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=o<n.getTime()||r.getTime()<o}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){var n,r=this.getDate()||new Date,o=24*parseInt(e)*60*60*1e3;"add"===t?n=new Date(r.valueOf()+o):"subtract"===t&&(n=new Date(r.valueOf()-o)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=b(this.calendars[0]);for(var t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=b({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(g(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=w.minDate,this._o.minYear=w.minYear,this._o.minMonth=w.minMonth,this._o.startRange=w.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(g(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=w.maxDate,this._o.maxYear=w.maxYear,this._o.maxMonth=w.maxMonth,this._o.endRange=w.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(this._v||t){var e,n=this._o,r=n.minYear,i=n.maxYear,a=n.minMonth,s=n.maxMonth,l="";this._y<=r&&(this._y=r,!isNaN(a)&&this._m<a&&(this._m=a)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s)),e="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var u=0;u<n.numberOfMonths;u++)l+='<div class="pika-lendar">'+S(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,e)+this.render(this.calendars[u].year,this.calendars[u].month,e)+"</div>";this.el.innerHTML=l,n.bound&&"hidden"!==n.field.type&&o((function(){n.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)}},adjustPosition:function(){var t,e,n,o,i,a,s,c,f,h,d,p;if(!this._o.container){if(this.el.style.position="absolute",e=t=this._o.trigger,n=this.el.offsetWidth,o=this.el.offsetHeight,i=window.innerWidth||r.documentElement.clientWidth,a=window.innerHeight||r.documentElement.clientHeight,s=window.pageYOffset||r.body.scrollTop||r.documentElement.scrollTop,d=!0,p=!0,"function"==typeof t.getBoundingClientRect)c=(h=t.getBoundingClientRect()).left+window.pageXOffset,f=h.bottom+window.pageYOffset;else for(c=e.offsetLeft,f=e.offsetTop+e.offsetHeight;e=e.offsetParent;)c+=e.offsetLeft,f+=e.offsetTop;(this._o.reposition&&c+n>i||this._o.position.indexOf("right")>-1&&c-n+t.offsetWidth>0)&&(c=c-n+t.offsetWidth,d=!1),(this._o.reposition&&f+o>a+s||this._o.position.indexOf("top")>-1&&f-o-t.offsetHeight>0)&&(f=f-o-t.offsetHeight,p=!1),this.el.style.left=c+"px",this.el.style.top=f+"px",l(this.el,d?"left-aligned":"right-aligned"),l(this.el,p?"bottom-aligned":"top-aligned"),u(this.el,d?"right-aligned":"left-aligned"),u(this.el,p?"top-aligned":"bottom-aligned")}},render:function(t,e,n){var r=this._o,o=new Date,i=p(t,e),a=new Date(t,e,1).getDay(),s=[],l=[];g(o),r.firstDay>0&&(a-=r.firstDay)<0&&(a+=7);for(var u=0===e?11:e-1,c=11===e?0:e+1,d=0===e?t-1:t,y=11===e?t+1:t,m=p(d,u),b=i+a,w=b;w>7;)w-=7;b+=7-w;for(var S,k,R,_,T=!1,M=0,A=0;M<b;M++){var N=new Date(t,e,M-a+1),j=!!f(this._d)&&v(N,this._d),x=v(N,o),I=-1!==r.events.indexOf(N.toDateString()),D=M<a||M>=i+a,P=M-a+1,L=e,H=t,F=r.startRange&&v(r.startRange,N),B=r.endRange&&v(r.endRange,N),U=r.startRange&&r.endRange&&r.startRange<N&&N<r.endRange;D&&(M<a?(P=m+P,L=u,H=d):(P-=i,L=c,H=y));var W={day:P,month:L,year:H,hasEvent:I,isSelected:j,isToday:x,isDisabled:r.minDate&&N<r.minDate||r.maxDate&&N>r.maxDate||r.disableWeekends&&h(N)||r.disableDayFn&&r.disableDayFn(N),isEmpty:D,isStartRange:F,isEndRange:B,isInRange:U,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&j&&(T=!0),l.push(C(W)),7==++A&&(r.showWeekNumber&&l.unshift((S=M-a,k=e,R=t,_=void 0,void 0,_=new Date(R,0,1),'<td class="pika-week">'+Math.ceil(((new Date(R,k,S)-_)/864e5+_.getDay()+1)/7)+"</td>")),s.push(E(l,r.isRTL,r.pickWholeWeek,T)),l=[],A=0,T=!1)}return function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(t){var e,n=[];t.showWeekNumber&&n.push("<th></th>");for(e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+O(t,e)+'">'+O(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"}(t)+(r=e,"<tbody>"+r.join("")+"</tbody>")+"</table>";var r}(r,s,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),u(this.el,"is-hidden"),this._o.bound&&(i(r,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var t=this._v;!1!==t&&(this._o.bound&&a(r,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",l(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var t=this._o;this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),t.keyboardInput&&a(r,"keydown",this._onKeyChange),t.field&&(a(t.field,"change",this._onInputChange),t.bound&&(a(t.trigger,"click",this._onInputClick),a(t.trigger,"focus",this._onInputFocus),a(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},k}(o)}()},function(t,e,n){var r=n(59),o=n(31),i=n(158);t.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(183),o=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return o.call(t)}),t.exports=r.inspectSource},function(t,e,n){var r=n(49),o=n(159),i=r["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=i},function(t,e,n){var r=n(49),o=n(182),i=r.WeakMap;t.exports="function"==typeof i&&/native code/.test(o(i))},function(t,e,n){var r=n(60),o=n(186),i=n(83),a=n(64);t.exports=function(t,e){for(var n=o(e),s=a.f,l=i.f,u=0;u<n.length;u++){var c=n[u];r(t,c)||s(t,c,l(e,c))}}},function(t,e,n){var r=n(104),o=n(120),i=n(163),a=n(57);t.exports=r("Reflect","ownKeys")||function(t){var e=o.f(a(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(49);t.exports=r},function(t,e,n){var r=n(60),o=n(72),i=n(161).indexOf,a=n(119);t.exports=function(t,e){var n,s=o(t),l=0,u=[];for(n in s)!r(a,n)&&r(s,n)&&u.push(n);for(;e.length>l;)r(s,n=e[l++])&&(~i(u,n)||u.push(n));return u}},function(t,e,n){var r=n(72),o=n(120).f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==i.call(t)?function(t){try{return o(t)}catch(t){return a.slice()}}(t):o(r(t))}},function(t,e,n){var r=n(164);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){var r=n(104);t.exports=r("document","documentElement")},function(t,e,n){"use strict";var r,o,i,a=n(140),s=n(78),l=n(60),u=n(50),c=n(103),f=u("iterator"),h=!1;[].keys&&("next"in(i=[].keys())?(o=a(a(i)))!==Object.prototype&&(r=o):h=!0),null==r&&(r={}),c||l(r,f)||s(r,f,(function(){return this})),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},function(t,e,n){var r=n(31);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,n){var r=n(167),o=n(88),i=n(50)("toStringTag"),a="Arguments"==o(function(){return arguments}());t.exports=r?o:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:a?o(e):"Object"==(r=o(e))&&"function"==typeof e.callee?"Arguments":r}},function(t,e,n){var r=n(31);t.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(t,e,n){var r=n(50),o=n(123),i=r("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||a[i]===t)}},function(t,e,n){var r=n(194),o=n(123),i=n(50)("iterator");t.exports=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(57);t.exports=function(t,e,n,o){try{return o?e(r(n)[0],n[1]):e(n)}catch(e){var i=t.return;throw void 0!==i&&r(i.call(t)),e}}},function(t,e,n){var r=n(50)("iterator"),o=!1;try{var i=0,a={next:function(){return{done:!!i++}},return:function(){o=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var i={};i[r]=function(){return{next:function(){return{done:n=!0}}}},t(i)}catch(t){}return n}},function(t,e,n){"use strict";var r=n(169),o=n(124).getWeakData,i=n(57),a=n(52),s=n(171),l=n(170),u=n(84),c=n(60),f=n(89),h=f.set,d=f.getterFor,p=u.find,g=u.findIndex,v=0,y=function(t){return t.frozen||(t.frozen=new m)},m=function(){this.entries=[]},b=function(t,e){return p(t.entries,(function(t){return t[0]===e}))};m.prototype={get:function(t){var e=b(this,t);if(e)return e[1]},has:function(t){return!!b(this,t)},set:function(t,e){var n=b(this,t);n?n[1]=e:this.entries.push([t,e])},delete:function(t){var e=g(this.entries,(function(e){return e[0]===t}));return~e&&this.entries.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,u){var f=t((function(t,r){s(t,f,e),h(t,{type:e,id:v++,frozen:void 0}),null!=r&&l(r,t[u],t,n)})),p=d(e),g=function(t,e,n){var r=p(t),a=o(i(e),!0);return!0===a?y(r).set(e,n):a[r.id]=n,t};return r(f.prototype,{delete:function(t){var e=p(this);if(!a(t))return!1;var n=o(t);return!0===n?y(e).delete(t):n&&c(n,e.id)&&delete n[e.id]},has:function(t){var e=p(this);if(!a(t))return!1;var n=o(t);return!0===n?y(e).has(t):n&&c(n,e.id)}}),r(f.prototype,n?{get:function(t){var e=p(this);if(a(t)){var n=o(t);return!0===n?y(e).get(t):n?n[e.id]:void 0}},set:function(t,e){return g(this,t,e)}}:{add:function(t){return g(this,t,!0)}}),f}}},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,e,n){var r=n(50);e.f=r},function(t,e,n){var r=n(187),o=n(60),i=n(202),a=n(64).f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});o(e,t)||a(e,t,{value:i.f(t)})}},function(t,e,n){"use strict";var r=n(64).f,o=n(105),i=n(169),a=n(125),s=n(171),l=n(170),u=n(165),c=n(205),f=n(59),h=n(124).fastKey,d=n(89),p=d.set,g=d.getterFor;t.exports={getConstructor:function(t,e,n,u){var c=t((function(t,r){s(t,c,e),p(t,{type:e,index:o(null),first:void 0,last:void 0,size:0}),f||(t.size=0),null!=r&&l(r,t[u],t,n)})),d=g(e),v=function(t,e,n){var r,o,i=d(t),a=y(t,e);return a?a.value=n:(i.last=a={index:o=h(e,!0),key:e,value:n,previous:r=i.last,next:void 0,removed:!1},i.first||(i.first=a),r&&(r.next=a),f?i.size++:t.size++,"F"!==o&&(i.index[o]=a)),t},y=function(t,e){var n,r=d(t),o=h(e);if("F"!==o)return r.index[o];for(n=r.first;n;n=n.next)if(n.key==e)return n};return i(c.prototype,{clear:function(){for(var t=d(this),e=t.index,n=t.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete e[n.index],n=n.next;t.first=t.last=void 0,f?t.size=0:this.size=0},delete:function(t){var e=d(this),n=y(this,t);if(n){var r=n.next,o=n.previous;delete e.index[n.index],n.removed=!0,o&&(o.next=r),r&&(r.previous=o),e.first==n&&(e.first=r),e.last==n&&(e.last=o),f?e.size--:this.size--}return!!n},forEach:function(t){for(var e,n=d(this),r=a(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:n.first;)for(r(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!y(this,t)}}),i(c.prototype,n?{get:function(t){var e=y(this,t);return e&&e.value},set:function(t,e){return v(this,0===t?0:t,e)}}:{add:function(t){return v(this,t=0===t?0:t,t)}}),f&&r(c.prototype,"size",{get:function(){return d(this).size}}),c},setStrong:function(t,e,n){var r=e+" Iterator",o=g(e),i=g(r);u(t,e,(function(t,e){p(this,{type:r,target:t,state:o(t),kind:e,last:void 0})}),(function(){for(var t=i(this),e=t.kind,n=t.last;n&&n.removed;)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),c(e)}}},function(t,e,n){"use strict";var r=n(104),o=n(64),i=n(50),a=n(59),s=i("species");t.exports=function(t){var e=r(t),n=o.f;a&&e&&!e[s]&&n(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,n){var r,o,i=n(49),a=n(143),s=i.process,l=s&&s.versions,u=l&&l.v8;u?o=(r=u.split("."))[0]+r[1]:a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(o=r[1]),t.exports=o&&+o},function(t,e,n){"use strict";var r=n(31);function o(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=r((function(){var t=o("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=r((function(){var t=o("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},function(t,e,n){var r=n(65),o="["+n(209)+"]",i=RegExp("^"+o+o+"*"),a=RegExp(o+o+"*$"),s=function(t){return function(e){var n=String(r(e));return 1&t&&(n=n.replace(i,"")),2&t&&(n=n.replace(a,"")),n}};t.exports={start:s(1),end:s(2),trim:s(3)}},function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},function(t,e,n){"use strict";var r=n(26),o=n(236).start;r({target:"String",proto:!0,forced:n(237)},{padStart:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){"use strict";var r=n(90),o=n(65);t.exports="".repeat||function(t){var e=String(o(this)),n="",i=r(t);if(i<0||i==1/0)throw RangeError("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(e+=e))1&i&&(n+=e);return n}},function(t,e,n){"use strict";var r=n(84).forEach,o=n(91),i=n(68),a=o("forEach"),s=i("forEach");t.exports=a&&s?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,e,n){var r=n(26),o=n(240).values;r({target:"Object",stat:!0},{values:function(t){return o(t)}})},function(t,e,n){"use strict";var r=n(145),o=n(57),i=n(65),a=n(241),s=n(146);r("search",1,(function(t,e,n){return[function(e){var n=i(this),r=null==e?void 0:e[t];return void 0!==r?r.call(e,n):new RegExp(e)[t](String(n))},function(t){var r=n(e,t,this);if(r.done)return r.value;var i=o(t),l=String(this),u=i.lastIndex;a(u,0)||(i.lastIndex=0);var c=s(i,l);return a(i.lastIndex,u)||(i.lastIndex=u),null===c?-1:c.index}]}))},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var l,u=[],c=!1,f=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):f=-1,u.length&&d())}function d(){if(!c){var t=s(h);c=!0;for(var e=u.length;e;){for(l=u,u=[];++f<e;)l&&l[f].run();f=-1,e=u.length}l=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new p(t,e)),1!==u.length||c||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,n){"use strict";var r=n(26),o=n(250).left,i=n(91),a=n(68),s=i("reduce"),l=a("reduce",{1:0});r({target:"Array",proto:!0,forced:!s||!l},{reduce:function(t){return o(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(26),o=n(59),i=n(186),a=n(72),s=n(83),l=n(127);r({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(t){for(var e,n,r=a(t),o=s.f,u=i(r),c={},f=0;u.length>f;)void 0!==(n=o(r,e=u[f++]))&&l(c,e,n);return c}})},function(t,e,n){var r=n(26),o=n(253);r({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(t,e,n){t.exports=function(){var t,e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=document.body,r=document.createTextNode(""),o=document.createElement("SPAN"),i=function(t,e,n){t.addEventListener(e,n,!1)},a=function(t,e,n){t.removeEventListener(e,n,!1)},s=function(i){var a,s;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==r.textContent?r.textContent=t.value+i:r.data=t.value+i,o.style.fontSize=c(t).fontSize,o.style.fontFamily=c(t).fontFamily,o.style.whiteSpace="pre",n.appendChild(o),a=o.clientWidth+2,n.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>a?t.style.width=e.minWidth+"px":a>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=a+"px",s=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>s?t.style.height=e.minHeight+"px":e.maxHeight<s?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=s+"px"},l=function(){window.setTimeout(s,0)},u=function(n,a,u){t=n,function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)e.minHeight=t.clientHeight;else{var i=parseInt(n.minHeight);isNaN(i)||(e.minHeight=i)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)e.maxHeight=t.clientHeight;else{var a=parseInt(n.maxHeight);isNaN(a)||(e.maxHeight=a)}if(n&&n.minWidth)if("inherit"==n.minWidth)e.minWidth=t.clientWidth;else{var s=parseInt(n.minWidth);isNaN(s)||(e.minWidth=s)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)e.maxWidth=t.clientWidth;else{var l=parseInt(n.maxWidth);isNaN(l)||(e.maxWidth=l)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))}(a),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),u&&(i(t,"change",s),i(t,"cut",l),i(t,"paste",l),i(t,"drop",l),i(t,"keydown",l),i(t,"focus",s),i(t,"compositionstart",l),i(t,"compositionupdate",l),i(t,"compositionend",l)),s()};function c(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}return{init:function(t,e,n){u(t,e,n)},unObserve:function(){a(t,"change",s),a(t,"cut",l),a(t,"paste",l),a(t,"drop",l),a(t,"keydown",l),a(t,"focus",s),a(t,"compositionstart",l),a(t,"compositionupdate",l),a(t,"compositionend",l)},resize:s}}},function(t,e,n){"use strict";n(7),n(5),n(8),n(32),n(9);var r=n(6),o=n(21),i=n(14),a=n(35),s=n(22),l=n(66),u=n(0);function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=function(){function t(e,n,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.priv=n,this.selection=r,this.eventManager=new s.a(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.addHook("afterDocumentKeyDown",(function(t){return o.onAfterDocumentKeyDown(t)}));for(var i=this.instance.rootWindow;i;)this.eventManager.addEventListener(i.document.documentElement,"keydown",(function(t){o.destroyed||o.instance.runHooks("afterDocumentKeyDown",t)})),i=Object(u.getParentWindow)(i);this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(t){!o.destroyed&&o.activeEditor&&!o.activeEditor.isOpened()&&o.instance.isListening()&&o.openEditor("",t)})),this.instance.view.wt.update("onCellDblClick",(function(t,e,n){return o.onCellDblClick(t,e,n)}))}var e,n,f;return e=t,(n=[{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(t){this.lock||this.closeEditor(t)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var t=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(e){e&&t.prepareEditor()}));else{var e=this.instance.selection.selectedRange.current().highlight,n=e.row,r=e.col;if(this.cellProperties=this.instance.getCellMeta(n,r),this.cellProperties.readOnly)this.clearActiveEditor();else{var o=this.instance.getCellEditor(this.cellProperties),i=this.instance.getCell(n,r,!0);if(o&&i){var s=this.instance.colToProp(r),l=this.instance.getSourceDataAtCell(this.instance.runHooks("modifyRow",n),r);this.activeEditor=Object(a.b)(o,this.instance),this.activeEditor.prepare(n,r,s,i,l,this.cellProperties)}else this.clearActiveEditor()}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(t,e){this.activeEditor&&this.activeEditor.beginEditing(t,e)}},{key:"closeEditor",value:function(t,e,n){this.activeEditor?this.activeEditor.finishEditing(t,e,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(t){this.closeEditor(!1,t)}},{key:"closeEditorAndRestoreOriginalValue",value:function(t){return this.closeEditor(!0,t)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(t){var e="function"==typeof this.priv.settings.enterMoves?this.priv.settings.enterMoves(event):this.priv.settings.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}},{key:"moveSelectionUp",value:function(t){t?this.selection.transformEnd(-1,0):this.selection.transformStart(-1,0)}},{key:"moveSelectionDown",value:function(t){t?this.selection.transformEnd(1,0):this.selection.transformStart(1,0)}},{key:"moveSelectionRight",value:function(t){t?this.selection.transformEnd(0,1):this.selection.transformStart(0,1)}},{key:"moveSelectionLeft",value:function(t){t?this.selection.transformEnd(0,-1):this.selection.transformStart(0,-1)}},{key:"onAfterDocumentKeyDown",value:function(t){if(this.instance.isListening()&&(this.instance.runHooks("beforeKeyDown",t),!this.destroyed&&229!==t.keyCode&&!Object(i.isImmediatePropagationStopped)(t)&&(this.priv.lastKeyCode=t.keyCode,this.selection.isSelected()))){var e=(t.ctrlKey||t.metaKey)&&!t.altKey;if(!this.activeEditor||this.activeEditor.isWaiting()||Object(o.isMetaKey)(t.keyCode)||Object(o.isCtrlMetaKey)(t.keyCode)||e||this.isEditorOpened()){var n,a=t.shiftKey,s=a?this.selection.setRangeEnd:this.selection.setRangeStart;switch(t.keyCode){case o.KEY_CODES.A:!this.isEditorOpened()&&e&&(this.instance.selectAll(),t.preventDefault(),Object(i.stopPropagation)(t));break;case o.KEY_CODES.ARROW_UP:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(e),this.moveSelectionUp(a),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.ARROW_DOWN:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(e),this.moveSelectionDown(a),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.ARROW_RIGHT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(e),this.moveSelectionRight(a),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.ARROW_LEFT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(e),this.moveSelectionLeft(a),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.TAB:n="function"==typeof this.priv.settings.tabMoves?this.priv.settings.tabMoves(t):this.priv.settings.tabMoves,a?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.BACKSPACE:case o.KEY_CODES.DELETE:this.instance.emptySelectedCells(),this.prepareEditor(),t.preventDefault();break;case o.KEY_CODES.F2:this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,t),t.preventDefault();break;case o.KEY_CODES.ENTER:this.isEditorOpened()?(this.activeEditor&&this.activeEditor.state!==l.a.WAITING&&this.closeEditorAndSaveChanges(e),this.moveSelectionAfterEnter(a)):this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.activeEditor&&(this.activeEditor.enableFullEditMode(),this.openEditor(null,t)):this.moveSelectionAfterEnter(a),t.preventDefault(),Object(i.stopImmediatePropagation)(t);break;case o.KEY_CODES.ESCAPE:this.isEditorOpened()&&(this.closeEditorAndRestoreOriginalValue(e),this.activeEditor.focus()),t.preventDefault();break;case o.KEY_CODES.HOME:t.ctrlKey||t.metaKey?s.call(this.selection,new r.a(0,this.selection.selectedRange.current().from.col)):s.call(this.selection,new r.a(this.selection.selectedRange.current().from.row,0)),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.END:t.ctrlKey||t.metaKey?s.call(this.selection,new r.a(this.instance.countRows()-1,this.selection.selectedRange.current().from.col)):s.call(this.selection,new r.a(this.selection.selectedRange.current().from.row,this.instance.countCols()-1)),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0),t.preventDefault(),Object(i.stopPropagation)(t);break;case o.KEY_CODES.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0),t.preventDefault(),Object(i.stopPropagation)(t)}}else this.openEditor("",t)}}},{key:"onCellDblClick",value:function(t,e,n){"TD"===n.nodeName&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,t))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}])&&c(e.prototype,n),f&&c(e,f),t}(),h=new WeakMap;f.getInstance=function(t,e,n,r){var o=h.get(t);return o||(o=new f(t,e,n,r),h.set(t,o)),o},e.a=f},function(t,e,n){"use strict";n(10),n(11),n(12),n(7),n(5),n(15),n(8),n(32),n(9);var r=n(0),o=n(22),i=n(14),a=n(6),s=n(132);function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=new WeakMap,f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.eventManager=new o.a(e),this.settings=e.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this.wt=void 0,this.activeWt=void 0,c.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}var e,n,f;return e=t,(n=[{key:"render",value:function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1}},{key:"getCellAtCoords",value:function(t,e){var n=this.wt.getCell(t,e);return n<0?null:n}},{key:"scrollViewport",value:function(t,e,n,r,o){return this.wt.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this.wt.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this.wt.scrollViewportVertically(t,e,n)}},{key:"createElements",value:function(){var t=c.get(this),e=this.instance,n=e.rootElement,o=e.rootDocument,i=n.getAttribute("style");i&&n.setAttribute("data-originalstyle",i),Object(r.addClass)(n,"handsontable"),t.table=o.createElement("TABLE"),Object(r.addClass)(t.table,"htCore"),this.instance.getSettings().tableClassName&&Object(r.addClass)(t.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),t.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),t.table.appendChild(this.TBODY),this.instance.table=t.table,this.instance.container.insertBefore(t.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var t=this,e=c.get(this),n=this.instance,o=n.rootElement,a=n.rootDocument,s=a.documentElement;this.eventManager.addEventListener(o,"mousedown",(function(n){if(e.selectionMouseDown=!0,!t.isTextSelectionAllowed(n.target)){var o=t.instance.rootWindow;Object(r.clearTextSelection)(o),n.preventDefault(),o.focus()}})),this.eventManager.addEventListener(o,"mouseup",(function(){e.selectionMouseDown=!1})),this.eventManager.addEventListener(o,"mousemove",(function(n){e.selectionMouseDown&&!t.isTextSelectionAllowed(n.target)&&(t.settings.fragmentSelection&&Object(r.clearTextSelection)(t.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(s,"keyup",(function(e){t.instance.selection.isInProgress()&&!e.shiftKey&&t.instance.selection.finish()})),this.eventManager.addEventListener(s,"mouseup",(function(n){t.instance.selection.isInProgress()&&Object(i.isLeftClick)(n)&&t.instance.selection.finish(),e.mouseDown=!1,(Object(r.isOutsideInput)(a.activeElement)||!t.instance.selection.isSelected()&&!Object(i.isRightClick)(n))&&t.instance.unlisten()})),this.eventManager.addEventListener(s,"contextmenu",(function(n){t.instance.selection.isInProgress()&&Object(i.isRightClick)(n)&&(t.instance.selection.finish(),e.mouseDown=!1)})),this.eventManager.addEventListener(s,"touchend",(function(){t.instance.selection.isInProgress()&&t.instance.selection.finish(),e.mouseDown=!1})),this.eventManager.addEventListener(s,"mousedown",(function(n){var i=n.target,l=n.x||n.clientX,u=n.y||n.clientY,c=n.target;if(!e.mouseDown&&o&&t.instance.view){var f=t.instance.view.wt.wtTable.holder;if(c===f){var h=Object(r.getScrollbarWidth)(a);if(a.elementFromPoint(l+h,u)!==f||a.elementFromPoint(l,u+h)!==f)return}else for(;c!==s;){if(null===c){if(n.isTargetWebComponent)break;return}if(c===o)return;c=c.parentNode}("function"==typeof t.settings.outsideClickDeselects?t.settings.outsideClickDeselects(i):t.settings.outsideClickDeselects)?t.instance.deselectCell():t.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(e.table,"selectstart",(function(e){t.settings.fragmentSelection||Object(r.isInput)(e.target)||e.preventDefault()}))}},{key:"initializeWalkontable",value:function(){var t=this,e=c.get(this),n={debug:function(){return t.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,preventOverflow:function(){return t.settings.preventOverflow},preventWheel:function(){return t.settings.preventWheel},stretchH:function(){return t.settings.stretchH},data:this.instance.getDataAtCell,totalRows:function(){return t.instance.countRows()},totalColumns:function(){return t.instance.countCols()},fixedColumnsLeft:function(){return t.settings.fixedColumnsLeft},fixedRowsTop:function(){return t.settings.fixedRowsTop},fixedRowsBottom:function(){return t.settings.fixedRowsBottom},minSpareRows:function(){return t.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var e=[];return t.instance.hasRowHeaders()&&e.push((function(e,n){return t.appendRowHeader(e,n)})),t.instance.runHooks("afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return t.instance.hasColHeaders()&&e.push((function(e,n){t.appendColHeader(e,n)})),t.instance.runHooks("afterGetColumnHeaderRenderers",e),e},columnWidth:this.instance.getColWidth,rowHeight:this.instance.getRowHeight,cellRenderer:function(e,n,r){var o=t.instance.getCellMeta(e,n),i=t.instance.colToProp(n),a=t.instance.getDataAtRowProp(e,i);t.instance.hasHook("beforeValueRender")&&(a=t.instance.runHooks("beforeValueRender",a,o)),t.instance.runHooks("beforeRenderer",r,e,n,i,a,o),t.instance.getCellRenderer(o)(t.instance,r,e,n,i,a,o),t.instance.runHooks("afterRenderer",r,e,n,i,a,o)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onWindowResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,a){var l={row:!1,column:!1,cell:!1};t.instance.listen(),t.activeWt=a,e.mouseDown=!0,t.instance.runHooks("beforeOnCellMouseDown",n,r,o,l),Object(i.isImmediatePropagationStopped)(n)||(Object(s.a)(n,{coords:r,selection:t.instance.selection,controller:l}),t.instance.runHooks("afterOnCellMouseDown",n,r,o),t.activeWt=t.wt)},onCellContextMenu:function(n,r,o,a){t.activeWt=a,e.mouseDown=!1,t.instance.selection.isInProgress()&&t.instance.selection.finish(),t.instance.runHooks("beforeOnCellContextMenu",n,r,o),Object(i.isImmediatePropagationStopped)(n)||(t.instance.runHooks("afterOnCellContextMenu",n,r,o),t.activeWt=t.wt)},onCellMouseOut:function(e,n,r,o){t.activeWt=o,t.instance.runHooks("beforeOnCellMouseOut",e,n,r),Object(i.isImmediatePropagationStopped)(e)||(t.instance.runHooks("afterOnCellMouseOut",e,n,r),t.activeWt=t.wt)},onCellMouseOver:function(n,r,o,a){var l={row:!1,column:!1,cell:!1};t.activeWt=a,t.instance.runHooks("beforeOnCellMouseOver",n,r,o,l),Object(i.isImmediatePropagationStopped)(n)||(e.mouseDown&&Object(s.a)(n,{coords:r,selection:t.instance.selection,controller:l}),t.instance.runHooks("afterOnCellMouseOver",n,r,o),t.activeWt=t.wt)},onCellMouseUp:function(e,n,r,o){t.activeWt=o,t.instance.runHooks("beforeOnCellMouseUp",e,n,r),Object(i.isImmediatePropagationStopped)(e)||(t.instance.runHooks("afterOnCellMouseUp",e,n,r),t.activeWt=t.wt)},onCellCornerMouseDown:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:function(e,n){return t.beforeRender(e,n)},onDraw:function(e){return t.onDraw(e)},onScrollVertically:function(){return t.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return t.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return t.instance.runHooks("beforeRemoveCellClassNames")},onAfterDrawSelection:function(e,n,r,o){return t.instance.runHooks("afterDrawSelection",e,n,r,o)},onBeforeDrawBorders:function(e,n){return t.instance.runHooks("beforeDrawBorders",e,n)},onBeforeTouchScroll:function(){return t.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return t.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(e,n){return t.instance.runHooks("beforeStretchingColumnWidth",e,n)},onModifyRowHeaderWidth:function(e){return t.instance.runHooks("modifyRowHeaderWidth",e)},onModifyGetCellCoords:function(e,n,r){return t.instance.runHooks("modifyGetCellCoords",e,n,r)},viewportRowCalculatorOverride:function(e){var n=t.settings.viewportRowRenderingOffset;if("auto"===n&&t.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=t.instance.countRows();if("number"==typeof n)e.startRow=Math.max(e.startRow-n,0),e.endRow=Math.min(e.endRow+n,r-1);else if("auto"===n){var o=e.startRow+e.endRow-e.startRow,i=Math.ceil(o/r*12);e.startRow=Math.max(e.startRow-i,0),e.endRow=Math.min(e.endRow+i,r-1)}}t.instance.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){var n=t.settings.viewportColumnRenderingOffset;if("auto"===n&&t.settings.fixedColumnsLeft&&(n=10),n>0||"auto"===n){var r=t.instance.countCols();if("number"==typeof n&&(e.startColumn=Math.max(e.startColumn-n,0),e.endColumn=Math.min(e.endColumn+n,r-1)),"auto"===n){var o=e.startColumn+e.endColumn-e.startColumn,i=Math.ceil(o/r*12);e.startRow=Math.max(e.startColumn-i,0),e.endColumn=Math.min(e.endColumn+i,r-1)}}t.instance.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:function(){return t.settings.rowHeaderWidth},columnHeaderHeight:function(){var e=t.instance.runHooks("modifyColumnHeaderHeight");return t.settings.columnHeaderHeight||e}};this.instance.runHooks("beforeInitWalkontable",n),this.wt=new a.e(n),this.activeWt=this.wt;var r=this.wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),l=o.width,u=o.height;this.setLastSize(l,u),this.eventManager.addEventListener(r,"mousedown",(function(t){t.target===r&&3===t.which&&Object(i.stopPropagation)(t)})),this.eventManager.addEventListener(r,"contextmenu",(function(t){t.target===r&&3===t.which&&Object(i.stopPropagation)(t)})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){t.settings.observeDOMVisibility&&t.wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())}))}},{key:"isTextSelectionAllowed",value:function(t){if(Object(r.isInput)(t))return!0;var e=Object(r.isChildOf)(t,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return c.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var t=l(this.instance.getSelectedLast()||[],4),e=t[0],n=t[1],r=t[2],o=t[3];return void 0!==e&&e===r&&n===o}},{key:"isCellEdited",value:function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()}},{key:"beforeRender",value:function(t,e){t&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,e)}},{key:"onDraw",value:function(t){t&&this.instance.runHooks("afterRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(t,e){if(e.firstChild){var n=e.firstChild;if(!Object(r.hasClass)(n,"relative"))return Object(r.empty)(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var o=this.instance,i=o.rootDocument,a=o.getRowHeader,s=i.createElement("div"),l=i.createElement("span");s.className="relative",l.className="rowHeader",this.updateCellHeader(l,t,a),s.appendChild(l),e.appendChild(s)}this.instance.runHooks("afterGetRowHeader",t,e)}},{key:"appendColHeader",value:function(t,e){if(e.firstChild){var n=e.firstChild;Object(r.hasClass)(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),t,this.instance.getColHeader):(Object(r.empty)(e),this.appendColHeader(t,e))}else{var o=this.instance.rootDocument,i=o.createElement("div"),a=o.createElement("span");i.className="relative",a.className="colHeader",this.updateCellHeader(a,t,this.instance.getColHeader),i.appendChild(a),e.appendChild(i)}this.instance.runHooks("afterGetColHeader",t,e)}},{key:"updateCellHeader",value:function(t,e,n){var o=e,i=this.wt.wtOverlays.getParentOverlay(t)||this.wt;t.parentNode&&(Object(r.hasClass)(t,"colHeader")?o=i.wtTable.columnFilter.sourceToRendered(e):Object(r.hasClass)(t,"rowHeader")&&(o=i.wtTable.rowFilter.sourceToRendered(e))),o>-1?Object(r.fastInnerHTML)(t,n(e)):(Object(r.fastInnerText)(t,String.fromCharCode(160)),Object(r.addClass)(t,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(t){var e=this.wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0}},{key:"maximumVisibleElementHeight",value:function(t){var e=this.wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0}},{key:"setLastSize",value:function(t,e){var n=c.get(this),r=[t,e];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var t=c.get(this);return{width:t.lastWidth,height:t.lastHeight}}},{key:"mainViewIsActive",value:function(){return this.wt===this.activeWt}},{key:"destroy",value:function(){this.wt.destroy(),this.eventManager.destroy()}}])&&u(e.prototype,n),f&&u(e,f),t}();e.a=f},function(t,e,n){"use strict";n(38),n(75);var r=n(2),o=n(1),i=n(4);function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];a(this,t),this.hot=e,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}var e,n,l;return e=t,(n=[{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.data;return t&&(e=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),e}},{key:"setData",value:function(t){this.data=t}},{key:"getAtColumn",value:function(t){var e=this,n=[];return Object(o.arrayEach)(this.data,(function(o){var i,a=e.colToProp(t);i="string"==typeof a?Object(r.getProperty)(o,a):"function"==typeof a?a(o):o[a],n.push(i)})),n}},{key:"getAtRow",value:function(t){return this.data[t]}},{key:"getAtCell",value:function(t,e){var n=null,o=this.hot.runHooks("modifyRowData",t),i=isNaN(o)?o:this.data[t];if(i){var a=this.colToProp(e);n="string"==typeof a?Object(r.getProperty)(i,a):"function"==typeof a?a(this.data.slice(t,t+1)[0]):i[a]}return n}},{key:"getByRange",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Math.min(t.row,e.row),a=Math.min(t.col,e.col),s=Math.max(t.row,e.row),l=Math.max(t.col,e.col),u=[];return Object(i.rangeEach)(o,s,(function(t){var e,o=n.getAtRow(t);"array"===n.dataType?e=o.slice(a,l+1):"object"===n.dataType&&(e=r?[]:{},Object(i.rangeEach)(a,l,(function(t){var i=n.colToProp(t);r?e.push(o[i]):e[i]=o[i]}))),u.push(e)})),u}},{key:"countRows",value:function(){return Array.isArray(this.data)?this.data.length:0}},{key:"countColumns",value:function(){var t=0;return Array.isArray(this.data)&&("array"===this.dataType?t=this.data[0].length:"object"===this.dataType&&(t=Object.keys(this.data[0]).length)),t}},{key:"destroy",value:function(){this.data=null,this.hot=null}}])&&s(e.prototype,n),l&&s(e,l),t}();e.a=l},function(t,e){function n(){return"serviceWorker"in navigator&&("https:"===window.location.protocol||"localhost"===window.location.hostname||0===window.location.hostname.indexOf("127."))}e.install=function(t){if(t||(t={}),n())navigator.serviceWorker.register("/js/sw.js",{});else;},e.applyUpdate=function(t,e){},e.update=function(){n()&&navigator.serviceWorker.getRegistration().then((function(t){if(t)return t.update()}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(){this._hasWeakSet="function"==typeof WeakSet,this._inner=this._hasWeakSet?new WeakSet:[]}return t.prototype.memoize=function(t){if(this._hasWeakSet)return!!this._inner.has(t)||(this._inner.add(t),!1);for(var e=0;e<this._inner.length;e++){if(this._inner[e]===t)return!0}return this._inner.push(t),!1},t.prototype.unmemoize=function(t){if(this._hasWeakSet)this._inner.delete(t);else for(var e=0;e<this._inner.length;e++)if(this._inner[e]===t){this._inner.splice(e,1);break}},t}()},,function(t,e,n){"use strict";n(10),n(11),n(12),n(63),n(23),n(7),n(38),n(85),n(45),n(80),n(5),n(33),n(8),n(69),n(9),n(47);var r=n(96),o=n.n(r),i=n(74),a=n(95),s=n(2),l=n(1),u=(n(58),n(37));function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}var h=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.timer=null,this.func=e,this.delay=function(t){var e=t;"string"==typeof e&&/fps$/.test(e)&&(e=1e3/parseInt(e.replace("fps","")||0,10));return e}(n),this.stopped=!0,this._then=null,this._callback=function(){return r.__callback()}}return f(t,null,[{key:"create",value:function(e,n){return new t(e,n)}}]),f(t,[{key:"start",value:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=Object(u.requestAnimationFrame)(this._callback)),this}},{key:"stop",value:function(){return this.stopped||(this.stopped=!0,Object(u.cancelAnimationFrame)(this.timer),this.timer=null),this}},{key:"__callback",value:function(){if(this.timer=Object(u.requestAnimationFrame)(this._callback),this.delay){var t=Date.now(),e=t-this._then;e>this.delay&&(this._then=t-e%this.delay,this.func())}else this.func()}}]),t}();var d=n(4);function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e,n){return e&&g(t.prototype,e),n&&g(t,n),t}var y=Object(i.cellMethodLookupFactory)("copyable",!1),m=function(){function t(e,n,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=e,this.priv=n,this.GridSettings=r,this.dataSource=this.instance.getSettings().data,this.cachedLength=null,this.skipCache=!1,this.latestSourceRowsCount=0,this.duckSchema=this.dataSource&&this.dataSource[0]?Object(s.duckSchema)(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap(),this.interval=h.create((function(){return o.clearLengthCache()}),"15fps"),this.instance.addHook("skipLengthCache",(function(t){return o.onSkipLengthCache(t)})),this.onSkipLengthCache(500)}return v(t,null,[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),v(t,[{key:"createMap",value:function(){var t,e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new Map;var n=this.instance.getSettings().columns;if(n){var r=this.instance.getSettings().maxCols,o=Math.min(r,n.length),i=0,a=!1,l=Object(s.deepObjectSize)(e);for("function"==typeof n&&(o=l>0?l:this.instance.countSourceCols(),a=!0),t=0;t<o;t++){var u=a?n(t):n[t];if(Object(s.isObject)(u)){if(void 0!==u.data){var c=a?i:t;this.colToPropCache[c]=u.data,this.propToColCache.set(u.data,c)}i+=1}}}else this.recursiveDuckColumns(e)}},{key:"recursiveDuckColumns",value:function(t,e,n){var r,o=this,i=e,a=n;return void 0===i&&(i=0,a=""),"object"!==p(t)||Array.isArray(t)||Object(s.objectEach)(t,(function(t,e){null===t?(r=a+e,o.colToPropCache.push(r),o.propToColCache.set(r,i),i+=1):i=o.recursiveDuckColumns(t,i,"".concat(e,"."))})),i}},{key:"colToProp",value:function(t){var e=this.instance.toPhysicalColumn(t);return!isNaN(e)&&this.colToPropCache&&void 0!==this.colToPropCache[e]?this.colToPropCache[e]:e}},{key:"propToCol",value:function(t){var e;return e=void 0===this.propToColCache.get(t)?t:this.propToColCache.get(t),e=this.instance.toVisualColumn(e)}},{key:"getSchema",value:function(){var t=this.instance.getSettings().dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}},{key:"createRow",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=0,i=t;("number"!=typeof i||i>=this.instance.countSourceRows())&&(i=this.instance.countSourceRows());var a=this.instance.runHooks("beforeCreateRow",i,n,r);if(!1===a)return 0;for(var l=this.instance.getSettings().maxRows,u=this.instance.countCols(),c=function(){var t=null;"array"===e.instance.dataType?e.instance.getSettings().dataSchema?t=Object(s.deepClone)(e.getSchema()):(t=[],Object(d.rangeEach)(u-1,(function(){return t.push(null)}))):"function"===e.instance.dataType?t=e.instance.getSettings().dataSchema(i):(t={},Object(s.deepExtend)(t,e.getSchema())),i===e.instance.countSourceRows()?e.dataSource.push(t):e.spliceData(i,0,t),o+=1};o<n&&this.instance.countSourceRows()<l;)c();return this.instance.runHooks("afterCreateRow",i,o,r),this.instance.forceFullRender=!0,o}},{key:"createCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var r,o=this.instance.countSourceRows(),i=this.dataSource,s=this.instance.countCols(),l="number"!=typeof t||t>=s?s:t,u=0,c=this.instance.runHooks("beforeCreateCol",l,e,n);if(!1===c)return 0;r=l;for(var f=this.instance.getSettings().maxCols;u<e&&this.instance.countCols()<f;){var h=Object(a.columnFactory)(this.GridSettings,this.priv.columnsSettingConflicts);if("number"!=typeof l||l>=this.instance.countCols()){if(o>0)for(var d=0;d<o;d++)void 0===i[d]&&(i[d]=[]),i[d].push(null);else i.push([null]);this.priv.columnSettings.push(h)}else{for(var p=0;p<o;p++)i[p].splice(r,0,null);this.priv.columnSettings.splice(r,0,h)}u+=1,r+=1}return this.instance.runHooks("afterCreateCol",l,u,n),this.instance.forceFullRender=!0,u}},{key:"removeRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r="number"!=typeof t?-e:t,o=this.instance.runHooks("modifyRemovedAmount",e,r),i=this.instance.countSourceRows();r=(i+r)%i;var a=this.visualRowsToPhysical(r,o),s=this.instance.runHooks("beforeRemoveRow",r,o,a,n);if(!1!==s){var l=this.dataSource,u=this.filterData(r,o);u&&(l.length=0,Array.prototype.push.apply(l,u)),this.instance.runHooks("afterRemoveRow",r,o,a,n),this.instance.forceFullRender=!0}}},{key:"removeCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");var r="number"!=typeof t?-e:t;r=(this.instance.countCols()+r)%this.instance.countCols();var o=this.visualColumnsToPhysical(r,e),i=o.slice(0).sort((function(t,e){return e-t})),a=this.instance.runHooks("beforeRemoveCol",r,e,o,n);if(!1!==a){for(var s=!0,l=i.length,u=this.dataSource,c=0;c<l;c++)s&&o[0]!==o[c]-c&&(s=!1);if(s)for(var f=0,h=this.instance.countSourceRows();f<h;f++)u[f].splice(o[0],e);else{for(var d=0,p=this.instance.countSourceRows();d<p;d++)for(var g=0;g<l;g++)u[d].splice(i[g],1);for(var v=0;v<l;v++)this.priv.columnSettings.splice(o[v],1)}this.instance.runHooks("afterRemoveCol",r,e,o,n),this.instance.forceFullRender=!0}}},{key:"spliceCol",value:function(t,e,n){for(var r=this.instance.getDataAtCol(t),o=r.slice(e,e+n),i=r.slice(e+n),a=arguments.length,s=new Array(a>3?a-3:0),u=3;u<a;u++)s[u-3]=arguments[u];Object(l.extendArray)(s,i);for(var c=0;c<n;)s.push(null),c+=1;return Object(l.to2dArray)(s),this.instance.populateFromArray(e,t,s,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(t,e,n){for(var r=this.instance.getSourceDataAtRow(t),o=r.slice(e,e+n),i=r.slice(e+n),a=arguments.length,s=new Array(a>3?a-3:0),u=3;u<a;u++)s[u-3]=arguments[u];Object(l.extendArray)(s,i);for(var c=0;c<n;)s.push(null),c+=1;return this.instance.populateFromArray(t,e,[s],null,null,"spliceRow"),o}},{key:"spliceData",value:function(t,e,n){!1!==this.instance.runHooks("beforeDataSplice",t,e,n)&&this.dataSource.splice(t,e,n)}},{key:"filterData",value:function(t,e){var n=this.visualRowsToPhysical(t,e);if(!1!==this.instance.runHooks("beforeDataFilter",t,e,n))return this.dataSource.filter((function(t,e){return-1===n.indexOf(e)}))}},{key:"get",value:function(t,e){var n=this.instance.toPhysicalRow(t),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n),i=null;if((r=isNaN(o)?o:r)&&r.hasOwnProperty&&Object(s.hasOwnProperty)(r,e))i=r[e];else if("string"==typeof e&&e.indexOf(".")>-1){var a=e.split("."),l=r;if(!l)return null;for(var u=0,c=a.length;u<c;u++)if(void 0===(l=l[a[u]]))return null;i=l}else"function"==typeof e&&(i=e(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var f=Object(s.createObjectPropListener)(i);this.instance.runHooks("modifyData",n,this.propToCol(e),f,"get"),f.isTouched()&&(i=f.value)}return i}},{key:"getCopyable",value:function(t,e){return y.call(this.instance,t,this.propToCol(e))?this.get(t,e):""}},{key:"set",value:function(t,e,n,r){var o=this.instance.runHooks("modifyRow",t,r||"datamapGet"),i=n,a=this.dataSource[o],l=this.instance.runHooks("modifyRowData",o);if(a=isNaN(l)?l:a,this.instance.hasHook("modifyData")){var u=Object(s.createObjectPropListener)(i);this.instance.runHooks("modifyData",o,this.propToCol(e),u,"set"),u.isTouched()&&(i=u.value)}if(a&&a.hasOwnProperty&&Object(s.hasOwnProperty)(a,e))a[e]=i;else if("string"==typeof e&&e.indexOf(".")>-1){var c,f=e.split("."),h=a,d=0;for(d=0,c=f.length-1;d<c;d++)void 0===h[f[d]]&&(h[f[d]]={}),h=h[f[d]];h[f[d]]=i}else"function"==typeof e?e(this.dataSource.slice(o,o+1)[0],i):a[e]=i}},{key:"visualRowsToPhysical",value:function(t,e){for(var n,r=this.instance.countSourceRows(),o=[],i=(r+t)%r,a=e;i<r&&a;)n=this.instance.toPhysicalRow(i),o.push(n),a-=1,i+=1;return o}},{key:"visualColumnsToPhysical",value:function(t,e){for(var n=this.instance.countCols(),r=[],o=(n+t)%n,i=e;o<n&&i;){var a=this.instance.toPhysicalColumn(o);r.push(a),i-=1,o+=1}return r}},{key:"clear",value:function(){for(var t=0;t<this.instance.countSourceRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")}},{key:"clearLengthCache",value:function(){this.cachedLength=null}},{key:"getLength",value:function(){var t,e=this,n=this.instance.getSettings().maxRows;t=n<0||0===n?0:n||1/0;var r=this.instance.countSourceRows();if(this.instance.hasHook("modifyRow")){var o=this.skipCache;this.interval.start(),r!==this.latestSourceRowsCount&&(o=!0),this.latestSourceRowsCount=r,null===this.cachedLength||o?(Object(d.rangeEach)(r-1,(function(t){null===e.instance.toPhysicalRow(t)&&(r-=1)})),this.cachedLength=r):r=this.cachedLength}else this.interval.stop();return Math.min(r,t)}},{key:"getAll",value:function(){var e={row:0,col:0},n={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-n.row!=0||this.instance.countSourceRows()?this.getRange(e,n,t.DESTINATION_RENDERER):[]}},{key:"getRange",value:function(e,n,r){var o,i,a,s=[],l=this.instance.getSettings().maxRows,u=this.instance.getSettings().maxCols;if(0===l||0===u)return[];var c=r===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),h=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=f;o++){a=[];var d=this.instance.toPhysicalRow(o);for(i=Math.min(e.col,n.col);i<=h&&null!==d;i++)a.push(c.call(this,o,this.colToProp(i)));null!==d&&s.push(a)}return s}},{key:"getText",value:function(e,n){return o.a.stringify(this.getRange(e,n,t.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(e,n){return o.a.stringify(this.getRange(e,n,t.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"onSkipLengthCache",value:function(t){var e=this;this.skipCache=!0,setTimeout((function(){e.skipCache=!1}),t)}},{key:"destroy",value:function(){this.interval.stop(),this.interval=null,this.instance=null,this.priv=null,this.GridSettings=null,this.dataSource=null,this.cachedLength=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}]),t}();e.a=m},function(t,e,n){var r=n(26),o=n(31),i=n(189).f;r({target:"Object",stat:!0,forced:o((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:i})},function(t,e,n){var r=n(59),o=n(64),i=n(57),a=n(122);t.exports=r?Object.defineProperties:function(t,e){i(t);for(var n,r=a(e),s=r.length,l=0;s>l;)o.f(t,n=r[l++],e[n]);return t}},function(t,e,n){"use strict";var r=n(192).IteratorPrototype,o=n(105),i=n(116),a=n(141),s=n(123),l=function(){return this};t.exports=function(t,e,n){var u=e+" Iterator";return t.prototype=o(r,{next:i(1,n)}),a(t,u,!1,!0),s[u]=l,t}},function(t,e,n){var r=n(52);t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,n){"use strict";var r=n(167),o=n(194);t.exports=r?{}.toString:function(){return"[object "+o(this)+"]"}},function(t,e,n){"use strict";var r=n(125),o=n(67),i=n(198),a=n(196),s=n(62),l=n(127),u=n(197);t.exports=function(t){var e,n,c,f,h,d,p=o(t),g="function"==typeof this?this:Array,v=arguments.length,y=v>1?arguments[1]:void 0,m=void 0!==y,b=u(p),w=0;if(m&&(y=r(y,v>2?arguments[2]:void 0,2)),null==b||g==Array&&a(b))for(n=new g(e=s(p.length));e>w;w++)d=m?y(p[w],w):p[w],l(n,w,d);else for(h=(f=b.call(p)).next,n=new g;!(c=h.call(f)).done;w++)d=m?i(f,y,[c.value,w],!0):c.value,l(n,w,d);return n.length=w,n}},function(t,e,n){var r=n(57),o=n(106),i=n(50)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||null==(n=r(a)[i])?e:o(n)}},function(t,e,n){var r=n(31),o=n(209);t.exports=function(t){return r((function(){return!!o[t]()||"​᠎"!="​᠎"[t]()||o[t].name!==t}))}},function(t,e,n){"use strict";var r=n(26),o=n(168).codeAt;r({target:"String",proto:!0},{codePointAt:function(t){return o(this,t)}})},function(t,e,n){var r=n(62),o=n(211),i=n(65),a=Math.ceil,s=function(t){return function(e,n,s){var l,u,c=String(i(e)),f=c.length,h=void 0===s?" ":String(s),d=r(n);return d<=f||""==h?c:(l=d-f,(u=o.call(h,a(l/h.length))).length>l&&(u=u.slice(0,l)),t?c+u:u+c)}};t.exports={start:s(!1),end:s(!0)}},function(t,e,n){var r=n(143);t.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r)},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";var r=n(106),o=n(52),i=[].slice,a={},s=function(t,e,n){if(!(e in a)){for(var r=[],o=0;o<e;o++)r[o]="a["+o+"]";a[e]=Function("C,a","return new C("+r.join(",")+")")}return a[e](t,n)};t.exports=Function.bind||function(t){var e=r(this),n=i.call(arguments,1),a=function(){var r=n.concat(i.call(arguments));return this instanceof a?s(e,r.length,r):e.apply(t,r)};return o(e.prototype)&&(a.prototype=e.prototype),a}},function(t,e,n){var r=n(59),o=n(122),i=n(72),a=n(135).f,s=function(t){return function(e){for(var n,s=i(e),l=o(s),u=l.length,c=0,f=[];u>c;)n=l[c++],r&&!a.call(s,n)||f.push(t?[n,s[n]]:s[n]);return f}};t.exports={entries:s(!0),values:s(!1)}},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,o,i,a,s,l=1,u={},c=!1,f=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){p(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((i=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){i.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(o=f.documentElement,r=function(t){var e=f.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)}):r=function(t){setTimeout(p,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}),h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var o={callback:t,args:e};return u[l]=o,r(l),l++},h.clearImmediate=d}function d(t){delete u[t]}function p(t){if(c)setTimeout(p,0,t);else{var e=u[t];if(e){c=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{d(t),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(115),n(215))},function(t,e,n){var r=n(52),o=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&o(t)===t}},function(t,e,n){var r=n(26),o=n(49),i=n(245);r({global:!0,bind:!0,enumerable:!0,forced:!o.setImmediate||!o.clearImmediate},{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,n){var r,o,i,a=n(49),s=n(31),l=n(88),u=n(125),c=n(191),f=n(158),h=n(246),d=a.location,p=a.setImmediate,g=a.clearImmediate,v=a.process,y=a.MessageChannel,m=a.Dispatch,b=0,w={},O=function(t){if(w.hasOwnProperty(t)){var e=w[t];delete w[t],e()}},C=function(t){return function(){O(t)}},E=function(t){O(t.data)},S=function(t){a.postMessage(t+"",d.protocol+"//"+d.host)};p&&g||(p=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return w[++b]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},r(b),b},g=function(t){delete w[t]},"process"==l(v)?r=function(t){v.nextTick(C(t))}:m&&m.now?r=function(t){m.now(C(t))}:y&&!h?(i=(o=new y).port2,o.port1.onmessage=E,r=u(i.postMessage,i,1)):!a.addEventListener||"function"!=typeof postMessage||a.importScripts||s(S)?r="onreadystatechange"in f("script")?function(t){c.appendChild(f("script")).onreadystatechange=function(){c.removeChild(this),O(t)}}:function(t){setTimeout(C(t),0)}:(r=S,a.addEventListener("message",E,!1))),t.exports={set:p,clear:g}},function(t,e,n){var r=n(143);t.exports=/(iphone|ipod|ipad).*applewebkit/i.test(r)},function(t,e,n){"use strict";var r=n(26),o=n(84).findIndex,i=n(121),a=n(68),s=!0,l=a("findIndex");"findIndex"in[]&&Array(1).findIndex((function(){s=!1})),r({target:"Array",proto:!0,forced:s||!l},{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("findIndex")},function(t,e,n){var r=n(26),o=n(249);r({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},function(t,e,n){"use strict";var r=n(72),o=n(90),i=n(62),a=n(91),s=n(68),l=Math.min,u=[].lastIndexOf,c=!!u&&1/[1].lastIndexOf(1,-0)<0,f=a("lastIndexOf"),h=s("indexOf",{ACCESSORS:!0,1:0}),d=c||!f||!h;t.exports=d?function(t){if(c)return u.apply(this,arguments)||0;var e=r(this),n=i(e.length),a=n-1;for(arguments.length>1&&(a=l(a,o(arguments[1]))),a<0&&(a=n+a);a>=0;a--)if(a in e&&e[a]===t)return a||0;return-1}:u},function(t,e,n){var r=n(106),o=n(67),i=n(117),a=n(62),s=function(t){return function(e,n,s,l){r(n);var u=o(e),c=i(u),f=a(u.length),h=t?f-1:0,d=t?-1:1;if(s<2)for(;;){if(h in c){l=c[h],h+=d;break}if(h+=d,t?h<0:f<=h)throw TypeError("Reduce of empty array with no initial value")}for(;t?h>=0:f>h;h+=d)h in c&&(l=n(l,c[h],h,u));return l}};t.exports={left:s(!1),right:s(!0)}},function(t,e,n){var r=n(26),o=n(252),i=n(121);r({target:"Array",proto:!0},{fill:o}),i("fill")},function(t,e,n){"use strict";var r=n(67),o=n(138),i=n(62);t.exports=function(t){for(var e=r(this),n=i(e.length),a=arguments.length,s=o(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,u=void 0===l?n:o(l,n);u>s;)e[s++]=t;return e}},function(t,e,n){"use strict";var r=n(59),o=n(31),i=n(122),a=n(163),s=n(135),l=n(67),u=n(117),c=Object.assign,f=Object.defineProperty;t.exports=!c||o((function(){if(r&&1!==c({b:1},c(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=c({},t)[n]||"abcdefghijklmnopqrst"!=i(c({},e)).join("")}))?function(t,e){for(var n=l(t),o=arguments.length,c=1,f=a.f,h=s.f;o>c;)for(var d,p=u(arguments[c++]),g=f?i(p).concat(f(p)):i(p),v=g.length,y=0;v>y;)d=g[y++],r&&!h.call(p,d)||(n[d]=p[d]);return n}:c},function(t,e,n){"use strict";n(142)("WeakSet",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n(200))},function(t,e,n){"use strict";var r=n(26),o=n(90),i=n(256),a=n(211),s=n(31),l=1..toFixed,u=Math.floor,c=function(t,e,n){return 0===e?n:e%2==1?c(t,e-1,n*t):c(t*t,e/2,n)};r({target:"Number",proto:!0,forced:l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){l.call({})}))},{toFixed:function(t){var e,n,r,s,l=i(this),f=o(t),h=[0,0,0,0,0,0],d="",p="0",g=function(t,e){for(var n=-1,r=e;++n<6;)r+=t*h[n],h[n]=r%1e7,r=u(r/1e7)},v=function(t){for(var e=6,n=0;--e>=0;)n+=h[e],h[e]=u(n/t),n=n%t*1e7},y=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==h[t]){var n=String(h[t]);e=""===e?n:e+a.call("0",7-n.length)+n}return e};if(f<0||f>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(d="-",l=-l),l>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(l*c(2,69,1))-69)<0?l*c(2,-e,1):l/c(2,e,1),n*=4503599627370496,(e=52-e)>0){for(g(0,n),r=f;r>=7;)g(1e7,0),r-=7;for(g(c(10,r,1),0),r=e-1;r>=23;)v(1<<23),r-=23;v(1<<r),g(1,1),v(2),p=y()}else g(0,n),g(1<<-e,0),p=y()+a.call("0",f);return p=f>0?d+((s=p.length)<=f?"0."+a.call("0",f-s)+p:p.slice(0,s-f)+"."+p.slice(s-f)):d+p}})},function(t,e,n){var r=n(88);t.exports=function(t){if("number"!=typeof t&&"Number"!=r(t))throw TypeError("Incorrect invocation");return+t}},function(t,e,n){"use strict";var r,o=n(26),i=n(83).f,a=n(62),s=n(177),l=n(65),u=n(178),c=n(103),f="".endsWith,h=Math.min,d=u("endsWith");o({target:"String",proto:!0,forced:!!(c||d||(r=i(String.prototype,"endsWith"),!r||r.writable))&&!d},{endsWith:function(t){var e=String(l(this));s(t);var n=arguments.length>1?arguments[1]:void 0,r=a(e.length),o=void 0===n?r:h(a(n),r),i=String(t);return f?f.call(e,i,o):e.slice(o-i.length,o)===i}})},function(t,e,n){"use strict";var r=n(26),o=n(259);r({target:"String",proto:!0,forced:n(260)("link")},{link:function(t){return o(this,"a","href",t)}})},function(t,e,n){var r=n(65),o=/"/g;t.exports=function(t,e,n,i){var a=String(r(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(i).replace(o,"&quot;")+'"'),s+">"+a+"</"+e+">"}},function(t,e,n){var r=n(31);t.exports=function(t){return r((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},function(t,e,n){},function(t,e,n){},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},,,function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"Loose",(function(){return ls})),n.d(r,"Strict",(function(){return fs}));var o={};n.r(o),n.d(o,"OPERATION_NAME",(function(){return Qf})),n.d(o,"prepare",(function(){return Zf})),n.d(o,"operate",(function(){return Jf}));var i={};n.r(i),n.d(i,"OPERATION_NAME",(function(){return th})),n.d(i,"operate",(function(){return eh}));var a={};n.r(a),n.d(a,"OPERATION_NAME",(function(){return rh})),n.d(a,"operate",(function(){return oh}));var s={};n.r(s),n.d(s,"OPERATION_NAME",(function(){return ah})),n.d(s,"operate",(function(){return sh}));var l={};n.r(l),n.d(l,"OPERATION_NAME",(function(){return uh})),n.d(l,"operate",(function(){return ch}));var u={};n.r(u),n.d(u,"AutoColumnSize",(function(){return pt})),n.d(u,"AutoFill",(function(){return St})),n.d(u,"AutoRowSize",(function(){return It})),n.d(u,"Base",(function(){return W})),n.d(u,"BindRowsWithHeaders",(function(){return Cs})),n.d(u,"CollapsibleColumns",(function(){return As})),n.d(u,"ColumnSorting",(function(){return De})),n.d(u,"ColumnSummary",(function(){return Us})),n.d(u,"Comments",(function(){return dn})),n.d(u,"ContextMenu",(function(){return zn})),n.d(u,"CopyPaste",(function(){return pr})),n.d(u,"CustomBorders",(function(){return jr})),n.d(u,"DragToScroll",(function(){return Br})),n.d(u,"DropdownMenu",(function(){return $s})),n.d(u,"ExportFile",(function(){return kl})),n.d(u,"Filters",(function(){return vf})),n.d(u,"Formulas",(function(){return Fh})),n.d(u,"GanttChart",(function(){return od})),n.d(u,"HeaderTooltips",(function(){return hd})),n.d(u,"HiddenColumns",(function(){return yp})),n.d(u,"HiddenRows",(function(){return _p})),n.d(u,"ManualColumnFreeze",(function(){return Qr})),n.d(u,"ManualColumnMove",(function(){return Mo})),n.d(u,"ManualColumnResize",(function(){return Lo})),n.d(u,"ManualRowMove",(function(){return pi})),n.d(u,"ManualRowResize",(function(){return Ci})),n.d(u,"MergeCells",(function(){return Ji})),n.d(u,"MultiColumnSorting",(function(){return Hl})),n.d(u,"MultipleSelectionHandles",(function(){return sa})),n.d(u,"NestedHeaders",(function(){return kd})),n.d(u,"NestedRows",(function(){return ap})),n.d(u,"ObserveChanges",(function(){return Ca})),n.d(u,"PersistentState",(function(){return J})),n.d(u,"Search",(function(){return xa})),n.d(u,"TouchScroll",(function(){return Ua})),n.d(u,"TrimRows",(function(){return Hp})),n.d(u,"UndoRedo",(function(){return is}));var c={};n.r(c),n.d(c,"FunctionToString",(function(){return Qp})),n.d(c,"InboundFilters",(function(){return ig}));var f=n(46),h=n.n(f),d=(n(227),n(35)),p=n(41),g=n(56),v=n(87),y=n(99);n(27);var m=n(22),b=n(20),w=(n(107),n(147),n(108),n(0)),O=n(1);function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var E=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}var e,n,r;return e=t,(n=[{key:"addRow",value:function(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(t){var e=this.hot.getColHeader(0);if(null!=e){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(t){this.injected||this.injectTable(),Object(O.arrayEach)(this.rows,(function(e){t(e.row,Object(w.outerHeight)(e.table)-1)}))}},{key:"getWidths",value:function(t){this.injected||this.injectTable(),Object(O.arrayEach)(this.columns,(function(e){t(e.col,Object(w.outerWidth)(e.table))}))}},{key:"setSettings",value:function(t){this.settings=t}},{key:"setSetting",value:function(t,e){this.settings||(this.settings={}),this.settings[t]=e}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(t){return this.settings?this.settings[t]:null}},{key:"createColGroupsCol",value:function(){var t=this,e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach((function(n){Object(O.arrayEach)(n.strings,(function(n){e.appendChild(t.createColElement(n.col))}))})),e}},{key:"createRow",value:function(t){var e=this,n=this.hot.rootDocument,r=n.createDocumentFragment(),o=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,o),r.appendChild(o)),this.samples.forEach((function(o){Object(O.arrayEach)(o.strings,(function(o){var i=o.col,a=e.hot.getCellMeta(t,i);a.col=i,a.row=t;var s=e.hot.getCellRenderer(a),l=n.createElement("td");l.setAttribute("ghost-table",1),s(e.hot,l,t,i,e.hot.colToProp(i),o.value,a),r.appendChild(l)}))})),r}},{key:"createColumnHeadersRow",value:function(){var t=this,e=this.hot.rootDocument,n=e.createDocumentFragment();if(this.hot.hasRowHeaders()){var r=e.createElement("th");this.hot.view.appendColHeader(-1,r),n.appendChild(r)}return this.samples.forEach((function(r){Object(O.arrayEach)(r.strings,(function(r){var o=r.col,i=e.createElement("th");t.hot.view.appendColHeader(o,i),n.appendChild(i)}))})),n}},{key:"createCol",value:function(t){var e=this,n=this.hot.rootDocument,r=n.createDocumentFragment();return this.samples.forEach((function(o){Object(O.arrayEach)(o.strings,(function(o){var i=o.row,a=e.hot.getCellMeta(i,t);a.col=t,a.row=i;var s=e.hot.getCellRenderer(a),l=n.createElement("td"),u=n.createElement("tr");l.setAttribute("ghost-table",1),s(e.hot,l,i,t,e.hot.colToProp(t),o.value,a),u.appendChild(l),r.appendChild(u)}))})),r}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(t){var e=this.hot.rootDocument.createElement("col");return e.style.width="".concat(this.hot.view.wt.wtTable.getStretchedColumnWidth(t),"px"),e}},{key:"createTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.hot.rootDocument,n=e.createDocumentFragment(),r=e.createElement("table"),o=e.createElement("thead"),i=e.createElement("tbody"),a=e.createElement("colgroup"),s=e.createElement("tr"),l=e.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(s.appendChild(l),o.appendChild(s),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&i.appendChild(s),r.appendChild(i),Object(w.addClass)(r,t),n.appendChild(r),{fragment:n,table:r,tHead:o,tBody:i,colGroup:a,tr:s,th:l}}},{key:"createContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.hot.rootDocument,n=e.createDocumentFragment(),r=e.createElement("div"),o="htGhostTable htAutoSize ".concat(t.trim());return Object(w.addClass)(r,o),n.appendChild(r),{fragment:n,container:r}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}])&&C(e.prototype,n),r&&C(e,r),t}(),S=n(86),k=n(39),R=n(74),_=n(153),T=n(37),M=n(29),A=n(13),N=n(4),j=n(2),x=n(95),I=n(40),D=n(21),P=n(14),L=(n(10),n(11),n(12),n(7),n(24),n(17),n(18),n(5),n(25),n(8),n(9),n(23),n(45),n(32),n(73)),H=n(19);function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var B=new WeakMap,U=null,W=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object(j.defineGetter)(this,"hot",e,{writable:!1}),Object(j.defineGetter)(this,"t",Object(L.a)(e),{writable:!1}),B.set(this,{hooks:{}}),U=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(t){return n.onUpdateSettings(t)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}var e,n,r;return e=t,(n=[{key:"init",value:function(){this.pluginName=Object(H.b)(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),U||(U=Object(H.c)(this.hot)),U.indexOf(this.pluginName)>=0&&U.splice(U.indexOf(this.pluginName),1),U.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(t,e){B.get(this).hooks[t]=B.get(this).hooks[t]||[];var n=B.get(this).hooks[t];this.hot.addHook(t,e),n.push(e),B.get(this).hooks[t]=n}},{key:"removeHooks",value:function(t){var e=this;Object(O.arrayEach)(B.get(this).hooks[t]||[],(function(n){e.hot.removeHook(t,n)}))}},{key:"clearHooks",value:function(){var t=this,e=B.get(this).hooks;Object(j.objectEach)(e,(function(e,n){return t.removeHooks(n)})),e.length=0}},{key:"callOnPluginsReady",value:function(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}},{key:"onAfterPluginsInitialized",value:function(){Object(O.arrayEach)(this.pluginsInitializedCallbacks,(function(t){return t()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var t=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Object(j.objectEach)(this,(function(e,n){"hot"!==n&&"t"!==n&&(t[n]=null)})),delete this.t,delete this.hot}}])&&F(e.prototype,n),r&&F(e,r),t}();function V(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var z=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;V(this,t),this.rootWindow=n,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}var e,n,r;return e=t,(n=[{key:"saveValue",value:function(t,e){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(t),JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}},{key:"loadValue",value:function(t,e){var n=void 0===t?e:t,r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return null===r?void 0:JSON.parse(r)}},{key:"reset",value:function(t){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(t))}},{key:"resetAll",value:function(){var t=this;Object(O.arrayEach)(this.savedKeys,(function(e,n){t.rootWindow.localStorage.removeItem("".concat(t.prefix,"_").concat(t.savedKeys[n]))})),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var t=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}])&&Y(e.prototype,n),r&&Y(e,r),t}();function G(t){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function X(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function q(t,e){return!e||"object"!==G(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function K(t,e,n){return(K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function $(t){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Q(t,e){return(Q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}b.a.getSingleton().register("persistentStateSave"),b.a.getSingleton().register("persistentStateLoad"),b.a.getSingleton().register("persistentStateReset");var Z=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=q(this,$(e).call(this,t))).storage=void 0,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Q(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.storage||(this.storage=new z(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(function(e,n){return t.saveValue(e,n)})),this.addHook("persistentStateLoad",(function(e,n){return t.loadValue(e,n)})),this.addHook("persistentStateReset",(function(){return t.resetValue()})),K($(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,K($(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),K($(e.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(t,e){e.value=this.storage.loadValue(t)}},{key:"saveValue",value:function(t,e){this.storage.saveValue(t,e)}},{key:"resetValue",value:function(t){void 0===t?this.storage.resetAll():this.storage.reset(t)}},{key:"destroy",value:function(){K($(e.prototype),"destroy",this).call(this)}}])&&X(n.prototype,r),o&&X(n,o),e}(W);Object(H.d)("persistentState",Z);var J=Z;n(15),n(47),n(80),n(75);function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function et(t,e,n){return e&&tt(t.prototype,e),n&&tt(t,n),t}var nt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}return et(t,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]),et(t,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(t){this.customSampleCount=t}},{key:"setAllowDuplicates",value:function(t){this.allowDuplicates=t}},{key:"generateRowSamples",value:function(t,e){return this.generateSamples("row",e,t)}},{key:"generateColumnSamples",value:function(t,e){return this.generateSamples("col",e,t)}},{key:"generateSamples",value:function(t,e,n){var r=this,o=new Map,i="number"==typeof n?{from:n,to:n}:n,a=i.from,s=i.to;return Object(N.rangeEach)(a,s,(function(n){var i=r.generateSample(t,e,n);o.set(n,i)})),o}},{key:"generateSample",value:function(t,e,n){var r=this;if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");var o=new Map,i="row"===t?"col":"row",a=[];return Object(N.rangeEach)(e.from,e.to,(function(e){var s,l="row"===t?r.dataFactory(n,e):r.dataFactory(e,n),u=l.value,c=l.bundleCountSeed,f=c>0;s=Object(j.isObject)(u)?Object.keys(u).length:Array.isArray(u)?u.length:Object(A.stringify)(u).length,f&&(s+=c),o.has(s)||o.set(s,{needed:r.getSampleCount(),strings:[]});var h=o.get(s);h.needed&&((!(a.indexOf(u)>-1)||r.allowDuplicates||f)&&(h.strings.push(function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({value:u},i,e)),a.push(u),h.needed-=1))})),o}}]),t}(),rt=n(6);function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function it(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function at(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function st(t,e,n){return(st="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=lt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function lt(t){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ct(t,e,n){return e&&ut(t.prototype,e),n&&ut(t,n),t}function ft(t,e){return(ft=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ht=new WeakMap,dt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e){return!e||"object"!==ot(e)&&"function"!=typeof e?at(t):e}(this,lt(e).call(this,t)),ht.set(at(n),{cachedColumnHeaders:[]}),n.widths=[],n.ghostTable=new E(n.hot),n.samplesGenerator=new nt((function(t,e){var r=n.hot.getCellMeta(t,e),o="";r.spanned||(o=n.hot.getDataAtCell(t,e));var i=0;if(r.label){var a=r.label,s=a.value,l=a.property,u="";if(s)u="function"==typeof s?s(t,e,n.hot.colToProp(e),o):s;else if(l){var c=n.hot.getDataAtRowProp(t,l);u=null!==c?c:""}i=u.length}return{value:o,bundleCountSeed:i}})),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeColumnResize",(function(t,e,r){return n.onBeforeColumnResize(t,e,r)})),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ft(t,e)}(e,t),ct(e,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),ct(e,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().autoColumnSize;n&&null!==n.useHeaders&&void 0!==n.useHeaders&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData()})),this.addHook("beforeChange",(function(e){return t.onBeforeChange(e)})),this.addHook("beforeRender",(function(e){return t.onBeforeRender(e)})),this.addHook("modifyColWidth",(function(e,n){return t.getColumnWidth(n,e)})),this.addHook("afterInit",(function(){return t.onAfterInit()})),st(lt(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.findColumnsWhereHeaderWasChanged();t.length&&this.clearCache(t),st(lt(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){st(lt(e.prototype),"disablePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof e?{from:e,to:e}:e,i="number"==typeof n?{from:n,to:n}:n;Object(N.rangeEach)(o.from,o.to,(function(e){if(r||void 0===t.widths[e]&&!t.hot._getColWidthFromSettings(e)){var n=t.samplesGenerator.generateColumnSamples(e,i);Object(O.arrayEach)(n,(function(e){var n=it(e,2),r=n[0],o=n[1];return t.ghostTable.addColumn(r,o)}))}})),this.ghostTable.columns.length&&(this.ghostTable.getWidths((function(e,n){t.widths[e]=n})),this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},r=0,o=this.hot.countCols()-1,i=null;this.inProgress=!0;var a=function a(){if(!t.hot)return Object(T.cancelAnimationFrame)(i),void(t.inProgress=!1);t.calculateColumnsWidth({from:r,to:Math.min(r+e.CALCULATION_STEP,o)},n),(r=r+e.CALCULATION_STEP+1)<o?i=Object(T.requestAnimationFrame)(a):(Object(T.cancelAnimationFrame)(i),t.inProgress=!1,t.hot.view.wt.wtOverlays.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},n),this.firstCalculation=!1,r=s+1),r<o?a():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings().autoColumnSize,e=t&&Object(j.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,n=t&&Object(j.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view.wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var t=e.SYNC_CALCULATION_LIMIT,n=this.hot.countCols()-1;return Object(j.isObject)(this.hot.getSettings().autoColumnSize)&&(t=this.hot.getSettings().autoColumnSize.syncLimit,Object(I.isPercentValue)(t)?t=Object(N.valueAccordingPercent)(n,t):t>>=0),Math.min(t,n)}},{key:"getColumnWidth",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e;return void 0===r&&(r=this.widths[t],n&&"number"==typeof r&&(r=Math.max(r,rt.d.DEFAULT_WIDTH))),r}},{key:"getFirstVisibleColumn",value:function(){var t=this.hot.view.wt;return t.wtViewport.columnsVisibleCalculator?t.wtTable.getFirstVisibleColumn():t.wtViewport.columnsRenderCalculator?t.wtTable.getFirstRenderedColumn():-1}},{key:"getLastVisibleColumn",value:function(){var t=this.hot.view.wt;return t.wtViewport.columnsVisibleCalculator?t.wtTable.getLastVisibleColumn():t.wtViewport.columnsRenderCalculator?t.wtTable.getLastRenderedColumn():-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var t=this.hot.getColHeader(),e=ht.get(this).cachedColumnHeaders;return Object(O.arrayReduce)(t,(function(t,n,r){var o=e.length;return(o-1<r||e[r]!==n)&&t.push(r),o-1<r?e.push(n):e[r]=n,t}),[])}},{key:"clearCache",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length?Object(O.arrayEach)(e,(function(e){t.widths[e]=void 0})):this.widths.length=0}},{key:"isNeedRecalculate",value:function(){return!!Object(O.arrayFilter)(this.widths,(function(t){return void 0===t})).length}},{key:"onBeforeRender",value:function(){var t=this.hot.renderCall,e=this.hot.countRows(),n=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();-1!==n&&-1!==r&&e&&(this.calculateColumnsWidth({from:n,to:r},void 0,t),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){t.hot&&t.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(t){var e=this,n=Object(O.arrayMap)(t,(function(t){var n=it(t,2)[1];return e.hot.propToCol(n)}));this.clearCache(n)}},{key:"onBeforeColumnResize",value:function(t,e,n){var r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}},{key:"onAfterInit",value:function(){ht.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"destroy",value:function(){this.ghostTable.clean(),st(lt(e.prototype),"destroy",this).call(this)}}]),e}(W);Object(H.d)("autoColumnSize",dt);var pt=dt,gt=(n(30),n(43),n(54),{horizontal:"horizontal",vertical:"vertical"});function vt(t){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wt(t,e,n){return(wt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ot(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ot(t){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ct(t,e){return(Ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}b.a.getSingleton().register("modifyAutofillRange"),b.a.getSingleton().register("beforeAutofill");var Et=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==vt(e)&&"function"!=typeof e?bt(t):e}(this,Ot(e).call(this,t))).eventManager=new m.a(bt(n)),n.addingStarted=!1,n.mouseDownOnCellCorner=!1,n.mouseDragOutside=!1,n.handleDraggedCells=0,n.directions=[],n.autoInsertRow=!1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ct(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(function(e){return t.onAfterCellCornerMouseDown(e)})),this.addHook("afterOnCellCornerDblClick",(function(e){return t.onCellCornerDblClick(e)})),this.addHook("beforeOnCellMouseOver",(function(e,n){return t.onBeforeCellMouseOver(n)})),wt(Ot(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),wt(Ot(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),wt(Ot(e.prototype),"disablePlugin",this).call(this)}},{key:"getCopyableRanges",value:function(){var t=this.hot.getSelectedRangeLast(),e=t.getTopLeftCorner(),n=t.getBottomRightCorner(),r=e.row,o=e.col,i=n.row,a=n.col,s=[];return s.push({startRow:r,startCol:o,endRow:i,endCol:a}),s=this.hot.runHooks("modifyCopyableRange",s)}},{key:"getSelectionData",value:function(){var t=this,e=this.getCopyableRanges(),n=[],r=[],o=[];return Object(O.arrayEach)(e,(function(t){Object(N.rangeEach)(t.startRow,t.endRow,(function(t){-1===n.indexOf(t)&&n.push(t)})),Object(N.rangeEach)(t.startCol,t.endCol,(function(t){-1===r.indexOf(t)&&r.push(t)}))})),Object(O.arrayEach)(n,(function(e){var n=[];Object(O.arrayEach)(r,(function(r){n.push(t.hot.getCopyableData(e,r))})),o.push(n)})),o}},{key:"fillIn",value:function(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var t=this.hot.selection.highlight.getFill().getCorners();this.resetSelectionOfDraggedArea();var e=this.getCornersOfSelectedCells(),n=function(t,e){var n,r,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",n=new rt.a(e[0],e[1]),r=new rt.a(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",n=new rt.a(e[0],t[3]+1),r=new rt.a(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",n=new rt.a(e[0],e[1]),r=new rt.a(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",n=new rt.a(t[2]+1,e[1]),r=new rt.a(e[2],e[3])),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:r}}(e,t=this.hot.runHooks("modifyAutofillRange",t,e)),r=n.directionOfDrag,o=n.startOfDragCoords,i=n.endOfDragCoords;if(o&&o.row>-1&&o.col>-1){var a=this.getSelectionData();this.hot.runHooks("beforeAutofill",o,i,a);var s=function(t,e,n,r){var o=n.length,i=n?n[0].length:0,a=[],s=e.row-t.row,l=e.col-t.col;if(-1!==["down","up"].indexOf(r)){for(var u=[],c=0;c<l;c++){var f=parseInt(n[0][c],10),h=parseInt(n[o-1][c],10),d=("down"===r?h-f:f-h)/(o-1)||0;u.push(d)}a.push(u)}if(-1!==["right","left"].indexOf(r))for(var p=0;p<s;p++){var g=parseInt(n[p][0],10),v=parseInt(n[p][i-1],10),y=("right"===r?v-g:g-v)/(i-1)||0;a.push([y])}return a}(o,i,a,r),l=a;if(["up","left"].indexOf(r)>-1){l=[];var u=null,c=null;if("up"===r){c=(u=i.row-o.row+1)%a.length;for(var f=0;f<u;f++)l.push(a[(f+(a.length-c))%a.length])}else{c=(u=i.col-o.col+1)%a[0].length;for(var h=0;h<a.length;h++){l.push([]);for(var d=0;d<u;d++)l[h].push(a[h][(d+(a[h].length-c))%a[h].length])}}}this.hot.populateFromArray(o.row,o.col,l,i.row,i.col,"".concat(this.pluginName,".fill"),null,r,s),this.setSelection(t)}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}},{key:"getCoordsOfDragAndDropBorders",value:function(t){var e,n=this.hot.getSelectedRangeLast().getTopLeftCorner(),r=this.hot.getSelectedRangeLast().getBottomRightCorner();if(this.directions.includes(gt.vertical)&&(r.row<t.row||n.row>t.row))e=new rt.a(t.row,r.col);else{if(!this.directions.includes(gt.horizontal))return;e=new rt.a(r.row,t.col)}return this.reduceSelectionAreaIfNeeded(e)}},{key:"showBorder",value:function(t){var e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}},{key:"addRow",value:function(){var t=this;this.hot._registerTimeout(setTimeout((function(){t.hot.alter("insert_row",void 0,1,"".concat(t.pluginName,".fill")),t.addingStarted=!1}),200))}},{key:"addNewRowIfNeeded",value:function(){if(this.hot.selection.highlight.getFill().cellRange&&!1===this.addingStarted&&this.autoInsertRow){var t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getCorners(),n=this.hot.countRows();t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getCornersOfSelectedCells",value:function(){return this.hot.selection.isMultiple()?this.hot.selection.highlight.createOrGetArea().getCorners():this.hot.selection.highlight.getCell().getCorners()}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(t){for(var e,n=this.hot.getData(),r=this.hot.countRows(),o=t[2]+1;o<r;o++){for(var i=t[1];i<=t[3];i++)if(n[o][i])return-1;var a=n[o][t[1]-1],s=n[o][t[3]+1];(a||s)&&(e=o)}return e}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(t,e){this.hot.selection.highlight.getFill().clear().add(new rt.a(t[0],t[1])).add(new rt.a(e,t[3]))}},{key:"setSelection",value:function(t){var e;(e=this.hot).selectCell.apply(e,yt(t).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var t=this.getCornersOfSelectedCells(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(t){var e=this.hot.rootDocument.documentElement,n=Object(w.offset)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+Object(w.outerHeight)(this.hot.table),r=Object(w.offset)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+Object(w.outerWidth)(this.hot.table);return t.clientY>n&&t.clientX<=r}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)}))}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(t){var e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var t=function(t){var e={};return!0===t?(e.directions=Object.keys(gt),e.autoInsertRow=!0):Object(j.isObject)(t)?(Object(A.isDefined)(t.autoInsertRow)?t.direction===gt.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Object(A.isDefined)(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(gt)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}},{key:"destroy",value:function(){wt(Ot(e.prototype),"destroy",this).call(this)}}])&&mt(n.prototype,r),o&&mt(n,o),e}(W);Object(H.d)("autofill",Et);var St=Et;function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _t(t,e){return!e||"object"!==kt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tt(t,e,n){return(Tt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Mt(t){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function At(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nt(t,e,n){return e&&At(t.prototype,e),n&&At(t,n),t}function jt(t,e){return(jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xt=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=_t(this,Mt(e).call(this,t))).heights=[],n.ghostTable=new E(n.hot),n.samplesGenerator=new nt((function(t,e){var r;return t>=0?r=n.hot.getDataAtCell(t,e):-1===t&&(r=n.hot.getColHeader(e)),{value:r}})),n.firstCalculation=!0,n.inProgress=!1,n.addHook("beforeRowResize",(function(t,e,r){return n.onBeforeRowResize(t,e,r)})),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jt(t,e)}(e,t),Nt(e,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),Nt(e,[{key:"isEnabled",value:function(){return!0===this.hot.getSettings().autoRowSize||Object(j.isObject)(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData()})),this.addHook("beforeChange",(function(e){return t.onBeforeChange(e)})),this.addHook("beforeColumnMove",(function(){return t.recalculateAllRowsHeight()})),this.addHook("beforeColumnResize",(function(){return t.recalculateAllRowsHeight()})),this.addHook("beforeColumnSort",(function(){return t.clearCache()})),this.addHook("beforeRender",(function(e){return t.onBeforeRender(e)})),this.addHook("beforeRowMove",(function(e,n){return t.onBeforeRowMove(e,n)})),this.addHook("modifyRowHeight",(function(e,n){return t.getRowHeight(n,e)})),this.addHook("modifyColumnHeaderHeight",(function(){return t.getColumnHeaderHeight()})),Tt(Mt(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){Tt(Mt(e.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof e?{from:e,to:e}:e,i="number"==typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){var a=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(a.get(-1))}Object(N.rangeEach)(o.from,o.to,(function(e){if(r||void 0===t.heights[e]){var n=t.samplesGenerator.generateRowSamples(e,i);Object(O.arrayEach)(n,(function(e){var n=Rt(e,2),r=n[0],o=n[1];return t.ghostTable.addRow(r,o)}))}})),this.ghostTable.rows.length&&(this.ghostTable.getHeights((function(e,n){t.heights[e]=n})),this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},r=0,o=this.hot.countRows()-1,i=null;this.inProgress=!0;var a=function a(){if(!t.hot)return Object(T.cancelAnimationFrame)(i),void(t.inProgress=!1);t.calculateRowsHeight({from:r,to:Math.min(r+e.CALCULATION_STEP,o)},n),(r=r+e.CALCULATION_STEP+1)<o?i=Object(T.requestAnimationFrame)(a):(Object(T.cancelAnimationFrame)(i),t.inProgress=!1,t.hot.view.wt.wtOverlays.adjustElementsSize(!0),t.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&t.hot.view.wt.wtOverlays.leftOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},n),this.firstCalculation=!1,r=s+1),r<o?a():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings().autoRowSize,e=t&&Object(j.hasOwnProperty)(t,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,n=t&&Object(j.hasOwnProperty)(t,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){Object(w.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var t=e.SYNC_CALCULATION_LIMIT,n=this.hot.countRows()-1;return Object(j.isObject)(this.hot.getSettings().autoRowSize)&&(t=this.hot.getSettings().autoRowSize.syncLimit,Object(I.isPercentValue)(t)?t=Object(N.valueAccordingPercent)(n,t):t>>=0),Math.min(t,n)}},{key:"getRowHeight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=e;return void 0!==this.heights[t]&&this.heights[t]>(e||0)&&(n=this.heights[t]),n}},{key:"getColumnHeaderHeight",value:function(){return this.heights[-1]}},{key:"getFirstVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var t=this.hot.view.wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.heights.length=0,this.heights[-1]=void 0}},{key:"clearCacheByRange",value:function(t){var e=this,n="number"==typeof t?{from:t,to:t}:t,r=n.from,o=n.to;Object(N.rangeEach)(Math.min(r,o),Math.max(r,o),(function(t){e.heights[t]=void 0}))}},{key:"isNeedRecalculate",value:function(){return!!Object(O.arrayFilter)(this.heights,(function(t){return void 0===t})).length}},{key:"onBeforeRender",value:function(){var t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(-1!==n&&-1!==r){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){var o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-e,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(t,e){this.clearCacheByRange({from:t,to:e}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(t,e,n){var r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){t.hot&&t.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(t){var e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}},{key:"destroy",value:function(){this.ghostTable.clean(),Tt(Mt(e.prototype),"destroy",this).call(this)}}]),e}(W);Object(H.d)("autoRowSize",xt);var It=xt,Dt=(n(110),n(63),n(151),n(38),n(85),n(92),n(93),n(218),n(217),n(82));n(149);function Pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Lt=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Ht=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sortedColumnsStates=[],this.sortEmptyCells=!1,this.indicator=!0,this.headerAction=!0,this.compareFunctionFactory=void 0}var e,n,r;return e=t,(n=[{key:"updateAllColumnsProperties",value:function(t){var e=this;Object(j.isObject)(t)&&Object(j.objectEach)(t,(function(t,n){Lt.includes(n)&&(e[n]=t)}))}},{key:"getAllColumnsProperties",value:function(){var t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}},{key:"getFirstSortedColumn",value:function(){var t;return this.getNumberOfSortedColumns()>0&&(t=this.sortedColumnsStates[0].column),t}},{key:"getSortOrderOfColumn",value:function(t){var e,n=this.sortedColumnsStates.find((function(e){var n=e.column;return t===n}));return Object(j.isObject)(n)&&(e=n.sortOrder),e}},{key:"getSortedColumns",value:function(){return Object(O.arrayMap)(this.sortedColumnsStates,(function(t){return t.column}))}},{key:"getIndexOfColumnInSortQueue",value:function(t){return this.getSortedColumns().indexOf(t)}},{key:"getNumberOfSortedColumns",value:function(){return this.sortedColumnsStates.length}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(t){return this.getSortedColumns().includes(t)}},{key:"getSortStates",value:function(){return Object(j.deepClone)(this.sortedColumnsStates)}},{key:"getColumnSortState",value:function(t){if(this.isColumnSorted(t))return Object(j.deepClone)(this.sortedColumnsStates[this.getIndexOfColumnInSortQueue(t)])}},{key:"setSortStates",value:function(t){this.sortedColumnsStates=t}},{key:"destroy",value:function(){this.sortedColumnsStates.length=0,this.sortedColumnsStates=null}}])&&Pt(e.prototype,n),r&&Pt(e,r),t}(),Ft=(n(94),"asc"),Bt="desc";function Ut(t){if(Object(A.isUndefined)(t))return!1;var e=t.column,n=t.sortOrder;return Number.isInteger(e)&&[Ft,Bt].includes(n)}function Wt(t){if(t!==Bt)return t===Ft?Bt:Ft}function Vt(t){return t.querySelector(".".concat("colHeader"))}function Yt(t,e){if(t<0||!e.parentNode)return!1;var n=e.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(e.parentNode)-n.length}function zt(t,e,n){return-1===t&&e>=0&&!1===Object(P.isRightClick)(n)}var Gt=new Map([[Ft,"ascending"],[Bt,"descending"]]);function Xt(t,e,n,r){var o=["columnSorting"];if(r&&o.push("sortAction"),!1===n)o.push("indicatorDisabled");else if(t.isColumnSorted(e)){var i=t.getSortOrderOfColumn(e);o.push(Gt.get(i))}return o}function qt(){return Array.from(Gt.values()).concat("sortAction","indicatorDisabled","columnSorting")}function Kt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var $t={_arrayMap:[],getValueByIndex:function(t){var e=null;return t<this._arrayMap.length&&(e=this._arrayMap[t]),e},getIndexByValue:function(t){var e;return-1===(e=this._arrayMap.indexOf(t))?null:e},insertItems:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=Object(O.arrayMax)(this._arrayMap)+1,o=[];return Object(N.rangeEach)(n-1,(function(n){o.push(e._arrayMap.splice(t+n,0,r+n))})),o},removeItems:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[];if(Array.isArray(t)){var r=[].concat(this._arrayMap);t.sort((function(t,e){return e-t}));for(var o=0,i=t.length;o<i;o++){var a=t[o];this._arrayMap.splice(a,1),n.push(r[a])}}else n=this._arrayMap.splice(t,e);return n},unshiftItems:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.removeItems(t,e);function r(t){return Object(O.arrayReduce)(n,(function(e,n){var r=e;return t>n&&(r+=1),r}),0)}this._arrayMap=Object(O.arrayMap)(this._arrayMap,(function(t){var e=t,n=r(e);return n&&(e-=n),e}))},shiftItems:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this._arrayMap=Object(O.arrayMap)(this._arrayMap,(function(e){var r=e;return r>=t&&(r+=n),r})),Object(N.rangeEach)(n-1,(function(n){e._arrayMap.splice(t+n,0,t+n)}))},swapIndexes:function(t,e){var n;(n=this._arrayMap).splice.apply(n,[e,0].concat(Kt(this._arrayMap.splice(t,1))))},clearMap:function(){this._arrayMap.length=0}};Object(j.defineGetter)($t,"MIXIN_NAME","arrayMapper",{writable:!1,enumerable:!1});var Qt=$t;function Zt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Jt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,(n=[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(N.rangeEach)(n-1,(function(t){e._arrayMap[t]=t}))}},{key:"destroy",value:function(){this._arrayMap=null}}])&&Zt(e.prototype,n),r&&Zt(e,r),t}();Object(j.mixin)(Jt,Qt);var te=Jt;var ee=n(28),ne=n.n(ee);var re=n(61),oe=Object(re.a)("sorting.compareFunctionFactory"),ie=oe.register,ae=oe.getItem,se=oe.hasItem,le=Object(re.a)("sorting.mainSortComparator"),ue=le.register,ce=le.getItem;function fe(t){return se(t)?ae(t):ae("default")}function he(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function de(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}ie("numeric",(function(t,e,n){return function(e,r){var o=parseFloat(e),i=parseFloat(r),a=n.sortEmptyCells;if(o===i||isNaN(o)&&isNaN(i))return be;if(a){if(Object(A.isEmpty)(e))return"asc"===t?we:Oe;if(Object(A.isEmpty)(r))return"asc"===t?Oe:we}return isNaN(o)?Oe:isNaN(i)?we:o<i?"asc"===t?we:Oe:o>i?"asc"===t?Oe:we:be}})),ie("date",(function(t,e,n){return function(r,o){var i=n.sortEmptyCells;if(r===o)return be;if(Object(A.isEmpty)(r))return Object(A.isEmpty)(o)?be:i&&"asc"===t?we:Oe;if(Object(A.isEmpty)(o))return i&&"asc"===t?Oe:we;var a=e.dateFormat,s=ne()(r,a),l=ne()(o,a);return s.isValid()?l.isValid()?l.isAfter(s)?"asc"===t?we:Oe:l.isBefore(s)?"asc"===t?Oe:we:be:we:Oe}})),ie("default",(function(t,e,n){return function(e,r){var o=n.sortEmptyCells;return"string"==typeof e&&(e=e.toLowerCase()),"string"==typeof r&&(r=r.toLowerCase()),e===r?be:Object(A.isEmpty)(e)?Object(A.isEmpty)(r)?be:o&&"asc"===t?we:Oe:Object(A.isEmpty)(r)?o&&"asc"===t?Oe:we:isNaN(e)&&!isNaN(r)?"asc"===t?Oe:we:!isNaN(e)&&isNaN(r)?"asc"===t?we:Oe:(isNaN(e)||isNaN(r)||(e=parseFloat(e),r=parseFloat(r)),e<r?"asc"===t?we:Oe:e>r?"asc"===t?Oe:we:be)}}));var pe=function t(e){de(this,t),this.data=e,this.next=null,this.prev=null},ge=function(){function t(){de(this,t),this.first=null,this.last=null}var e,n,r;return e=t,(n=[{key:"push",value:function(t){var e=new pe(t);if(null===this.first)this.first=e,this.last=e;else{var n=this.last;this.last=e,e.prev=n,n.next=e}}},{key:"unshift",value:function(t){var e=new pe(t);if(null===this.first)this.first=e,this.last=e;else{var n=this.first;this.first=e,e.next=n,n.prev=e}}},{key:"inorder",value:function(t){for(var e=this.first;e;)t(e),e=e.next}},{key:"remove",value:function(t){if(null===this.first)return!1;for(var e,n,r=this.first;r;){if(r.data===t)return e=r.next,n=r.prev,e&&(e.prev=n),n&&(n.next=e),r===this.first&&(this.first=e),r===this.last&&(this.last=n),!0;r=r.next}return!1}},{key:"hasCycle",value:function(){for(var t=this.first,e=this.first;;){if(null===t)return!1;if(null===(t=t.next))return!1;if((t=t.next)===(e=e.next))return!0}}},{key:"pop",value:function(){if(null===this.last)return null;var t=this.last;return this.last=this.last.prev,t}},{key:"shift",value:function(){if(null===this.first)return null;var t=this.first;return this.first=this.first.next,t}},{key:"recursiveReverse",value:function(){if(this.first){!function t(e,n){n&&(t(n,n.next),n.next=e)}(this.first,this.first.next),this.first.next=null;var t=this.first;this.first=this.last,this.last=t}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var t,e=this.first.next,n=this.first;e;)t=e.next,e.next=n,n.prev=e,n=e,e=t;this.first.next=null,this.last.prev=null,t=this.first,this.first=n,this.last=t}}}])&&he(e.prototype,n),r&&he(e,r),t}(),ve=function(t,e){var n=t.toString(),r=e.toString();return n===r?0:n<r?-1:1};function ye(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ve,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(Math.abs(r-n)<=1)return[];var o=Math.ceil((n+r)/2);return ye(t,e,n,o),ye(t,e,o,r),me(t,e,n,o,r)}function me(t,e,n,r,o){for(var i=new ge,a=new ge,s=r-n,l=o-r,u=Math.max(s,l),c=o-n,f=0;f<u;f+=1)f<s&&i.push(t[n+f]),f<l&&a.push(t[r+f]);for(var h=0;h<c;)i.first&&a.first?e(i.first.data,a.first.data)>0?t[n+h]=a.shift().data:t[n+h]=i.shift().data:i.first?t[n+h]=i.shift().data:t[n+h]=a.shift().data,h+=1;return t}var be=0,we=-1,Oe=1;function Ce(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ee(t){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Se(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ke(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Re(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ke(Object(n),!0).forEach((function(e){_e(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Te(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function Me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ae(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ne(t,e,n){return(Ne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=je(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function je(t){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xe(t,e){return(xe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}ue("columnSorting",(function(t,e){return function(n,r){var o,i,a,s,l,u,c=Ce(n).slice(1),f=Ce(r).slice(1);return i=t[o=0],a=e[o],s=c[o],l=f[o],((u=a.columnSorting).compareFunctionFactory?u.compareFunctionFactory:fe(a.type))(i,a,u)(s,l)}})),b.a.getSingleton().register("beforeColumnSort"),b.a.getSingleton().register("afterColumnSort");var Ie=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==Ee(e)&&"function"!=typeof e?Ae(t):e}(this,je(e).call(this,t))).columnStatesManager=new Ht,n.rowsMapper=new te(Ae(n)),n.blockPluginTranslation=!0,n.columnMetaCache=new Map,n.pluginKey="columnSorting",n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xe(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(Object(A.isUndefined)(this.hot.getSettings().observeChanges)&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",(function(){return t.sortByPresetSortStates()})),this.addHook("afterUntrimRow",(function(){return t.sortByPresetSortStates()})),this.addHook("modifyRow",(function(e,n){return t.onModifyRow(e,n)})),this.addHook("unmodifyRow",(function(e,n){return t.onUnmodifyRow(e,n)})),this.addHook("afterGetColHeader",(function(e,n){return t.onAfterGetColHeader(e,n)})),this.addHook("beforeOnCellMouseDown",(function(e,n,r,o){return t.onBeforeOnCellMouseDown(e,n,r,o)})),this.addHook("afterOnCellMouseDown",(function(e,n){return t.onAfterOnCellMouseDown(e,n)})),this.addHook("afterCreateRow",(function(e,n){return t.onAfterCreateRow(e,n)})),this.addHook("afterRemoveRow",(function(e,n){return t.onAfterRemoveRow(e,n)})),this.addHook("afterInit",(function(){return t.loadOrSortBySettings()})),this.addHook("afterLoadData",(function(e){return t.onAfterLoadData(e)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol()})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol()})),this.hot.view&&this.loadOrSortBySettings(),Ne(je(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=this,n=function(e,n){var r=Vt(n);!1!==Yt(e,n)&&null!==r&&t.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",n),this.hot.addHookOnce("afterRender",(function(){t.hot.removeHook("afterGetColHeader",n)})),this.rowsMapper.clearMap(),Ne(je(e.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){var e=this,n=this.getSortConfig(),r=this.getNormalizedSortConfigs(t),o=this.areValidSortConfigs(r);if(!1!==this.hot.runHooks("beforeColumnSort",n,r,o)){if(o){var i=Object(O.arrayMap)(r,(function(t){return r=(n=t).column,o=Te(n,["column"]),Re({column:e.hot.toPhysicalColumn(r)},o);var n,r,o}));this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(),this.saveAllSortSettings(),this.hot.render(),this.hot.view.wt.draw(!0)}this.hot.runHooks("afterColumnSort",n,this.getSortConfig(),o)}}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(t){var e=this,n=function(t){var n=t.column,r=Te(t,["column"]);return Re({column:e.hot.toVisualColumn(n)},r)};if(Object(A.isDefined)(t)){var r=this.hot.toPhysicalColumn(t),o=this.columnStatesManager.getColumnSortState(r);return Object(A.isDefined)(o)?n(o):void 0}var i=this.columnStatesManager.getSortStates();return Object(O.arrayMap)(i,(function(t){return n(t)}))}},{key:"setSortConfig",value:function(t){var e=this,n=this.getNormalizedSortConfigs(t);if(this.areValidSortConfigs(n)){var r=Object(O.arrayMap)(n,(function(t){return r=(n=t).column,o=Te(n,["column"]),Re({column:e.hot.toPhysicalColumn(r)},o);var n,r,o}));this.columnStatesManager.setSortStates(r)}}},{key:"getNormalizedSortConfigs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t].slice(0,1)}},{key:"areValidSortConfigs",value:function(t){if(!1===Array.isArray(t))return!1;var e=t.map((function(t){return t.column})),n=this.hot.countCols(),r=e.every((function(t){return t<=n&&t>=0}));return function(t){if(!1===Array.isArray(t)||!1===t.every((function(t){return Object(j.isObject)(t)})))return!1;var e=t.map((function(t){return t.column}));return new Set(e).size===e.length&&t.every(Ut)}(t)&&r}},{key:"saveAllSortSettings",value:function(){var t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=this.columnStatesManager.getSortStates(),this.hot.runHooks("persistentStateSave","columnSorting",t)}},{key:"getAllSavedSortSettings",value:function(){var t=this,e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);var n=e.value;return Object(A.isDefined)(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Object(O.arrayMap)(n.initialConfig,(function(e){var n=e.column,r=Te(e,["column"]);return Re({column:t.hot.toVisualColumn(n)},r)}))),n}},{key:"getColumnNextConfig",value:function(t){var e=this.hot.toPhysicalColumn(t);if(this.columnStatesManager.isColumnSorted(e)){var n=this.getSortConfig(t),r=Wt(n.sortOrder);return Object(A.isDefined)(r)?(n.sortOrder=r,n):void 0}var o=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<o)return{column:t,sortOrder:Wt()}}},{key:"getNextSortConfig",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append",n=this.hot.toPhysicalColumn(t),r=this.columnStatesManager.getIndexOfColumnInSortQueue(n),o=this.columnStatesManager.isColumnSorted(n),i=this.getSortConfig(),a=this.getColumnNextConfig(t);if(o){if(Object(A.isUndefined)(a))return[].concat(Se(i.slice(0,r)),Se(i.slice(r+1)));if("append"===e)return[].concat(Se(i.slice(0,r)),Se(i.slice(r+1)),[a]);if("replace"===e)return[].concat(Se(i.slice(0,r)),[a],Se(i.slice(r+1)))}return Object(A.isDefined)(a)?i.concat(a):i}},{key:"setMergedPluginSettings",value:function(t){var e=this.hot.toPhysicalColumn(t),n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,t),i=Object.getPrototypeOf(o),a=Object.hasOwnProperty.call(i,this.pluginKey)?i[this.pluginKey]:{};this.columnMetaCache.set(e,Object.assign(r,n,a))}},{key:"getFirstCellSettings",value:function(t){var e=this.blockPluginTranslation;this.blockPluginTranslation=!0,(0===this.columnMetaCache.size||this.columnMetaCache.size<this.hot.countCols())&&this.rebuildColumnMetaCache();var n=this.hot.getCellMeta(0,t);this.blockPluginTranslation=e;var r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.get(this.hot.toPhysicalColumn(t)),r}},{key:"rebuildColumnMetaCache",value:function(){var t=this,e=this.hot.countCols();0===e?this.columnMetaCache.clear():Object(N.rangeEach)(e-1,(function(e){return t.setMergedPluginSettings(e)}))}},{key:"getNumberOfRowsToSort",value:function(t){var e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}},{key:"sortByPresetSortStates",value:function(){var t=this;if(this.columnStatesManager.isListOfSortedColumnsEmpty())this.rowsMapper.clearMap();else{var e=[],n=this.columnStatesManager.getSortedColumns(),r=this.hot.countRows();this.blockPluginTranslation=!0;for(var o=function(e){return Object(O.arrayMap)(n,(function(n){return t.hot.getDataAtCell(e,t.hot.toVisualColumn(n))}))},i=0;i<this.getNumberOfRowsToSort(r);i+=1)e.push([i].concat(o(i)));!function(t,e){for(var n=ce(e),r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];ye(t,n.apply(void 0,o))}(e,this.pluginKey,Object(O.arrayMap)(n,(function(e){return t.columnStatesManager.getSortOrderOfColumn(e)})),Object(O.arrayMap)(n,(function(e){return t.getFirstCellSettings(t.hot.toVisualColumn(e))})));for(var a=e.length;a<r;a+=1)e.push([a].concat(o(a)));this.blockPluginTranslation=!1,this.rowsMapper._arrayMap=Object(O.arrayMap)(e,(function(t){return t[0]}))}}},{key:"loadOrSortBySettings",value:function(){this.columnMetaCache.clear();var t=this.getAllSavedSortSettings();if(Object(j.isObject)(t))this.sortBySettings(t);else{var e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}},{key:"sortBySettings",value:function(t){if(Object(j.isObject)(t)){this.columnStatesManager.updateAllColumnsProperties(t);var e=t.initialConfig;(Array.isArray(e)||Object(j.isObject)(e))&&this.sort(e)}else this.hot.render()}},{key:"enableObserveChangesPlugin",value:function(){var t=this;this.hot._registerTimeout(setTimeout((function(){t.hot.updateSettings({observeChanges:!0})}),0))}},{key:"onModifyRow",value:function(t,e){if(!1===this.blockPluginTranslation&&e!==this.pluginName&&this.isSorted()){var n=this.rowsMapper.getValueByIndex(t);t=null===n?t:n}return t}},{key:"onUnmodifyRow",value:function(t,e){return!1===this.blockPluginTranslation&&e!==this.pluginName&&this.isSorted()&&(t=this.rowsMapper.getIndexByValue(t)),t}},{key:"onAfterGetColHeader",value:function(t,e){var n=Vt(e);if(!1!==Yt(t,e)&&null!==n){var r=this.hot.toPhysicalColumn(t),o=this.getFirstCellSettings(t)[this.pluginKey],i=o.indicator,a=o.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,r,i,a)}}},{key:"updateHeaderClasses",value:function(t){if(Object(w.removeClass)(t,qt()),!1!==this.enabled){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];Object(w.addClass)(t,Xt.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(t){Ne(je(e.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache.clear(),Object(A.isDefined)(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}},{key:"onAfterLoadData",value:function(t){this.rowsMapper.clearMap(),this.columnMetaCache.clear(),!0===t&&this.hot.view&&this.loadOrSortBySettings()}},{key:"onAfterCreateRow",value:function(t,e){this.rowsMapper.shiftItems(t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.rowsMapper.unshiftItems(t,e)}},{key:"onAfterCreateCol",value:function(){this.columnMetaCache.clear()}},{key:"onAfterRemoveCol",value:function(){this.columnMetaCache.clear()}},{key:"wasClickableHeaderClicked",value:function(t,e){return this.getFirstCellSettings(e)[this.pluginKey].headerAction&&"SPAN"===t.realTarget.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){!1!==zt(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&Object(Dt.a)()&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==zt(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(Object(Dt.a)()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}},{key:"destroy",value:function(){this.rowsMapper.destroy(),this.columnStatesManager.destroy(),Ne(je(e.prototype),"destroy",this).call(this)}}])&&Me(n.prototype,r),o&&Me(n,o),e}(W);Object(H.d)("columnSorting",Ie);var De=Ie;function Pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Le(t,e,n){return e&&Pe(t.prototype,e),n&&Pe(t,n),t}var He=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=null,this.rootDocument=e,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return Le(t,null,[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),Le(t,[{key:"setPosition",value:function(t,e){this.editorStyle.left="".concat(t,"px"),this.editorStyle.top="".concat(e,"px")}},{key:"setSize",value:function(t,e){if(t&&e){var n=this.getInputElement();n.style.width="".concat(t,"px"),n.style.height="".concat(e,"px")}}},{key:"resetSize",value:function(){var t=this.getInputElement();t.style.width="",t.style.height=""}},{key:"setReadOnlyState",value:function(t){this.getInputElement().readOnly=t}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t||"";this.getInputElement().value=e}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return this.container=this.rootDocument.querySelector(".".concat(t.CLASS_EDITOR_CONTAINER)),this.container||(this.container=this.rootDocument.createElement("div"),Object(w.addClass)(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container)),Object(w.addClass)(e,t.CLASS_EDITOR),Object(w.addClass)(n,t.CLASS_INPUT),e.appendChild(n),this.container.appendChild(e),e}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(t.CLASS_INPUT))}},{key:"destroy",value:function(){var t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}]),t}(),Fe=(n(148),n(71),n(33),n(58),"---------");function Be(t){return Object(w.hasClass)(t,"htSeparator")}function Ue(t){return Object(w.hasClass)(t,"htDisabled")}function We(t){return Object(w.hasClass)(t,"htSelectionDisabled")}function Ve(t){var e=t.getSelected();return e?e[0]<0?null:e:null}function Ye(t,e){var n={};return Object(O.arrayEach)(t,(function(t){for(var r=t.from,o=t.to,i=r.row;i<=o.row;i++)for(var a=r.col;a<=o.col;a++)n[i]||(n[i]=[]),n[i][a]=e(i,a)})),n}function ze(t,e,n,r,o){Object(O.arrayEach)(t,(function(t){var i=t.from,a=t.to;if(i.row===a.row&&i.col===a.col)Ge(i.row,i.col,e,n,r,o);else for(var s=i.row;s<=a.row;s++)for(var l=i.col;l<=a.col;l++)Ge(s,l,e,n,r,o)}))}function Ge(t,e,n,r,o,i){var a=o(t,e),s=r;a.className&&(s="vertical"===n?function(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(e)}(a.className,r):function(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(e)}(a.className,r)),i(t,e,"className",s)}function Xe(t,e){var n=!1;return Array.isArray(t)&&Object(O.arrayEach)(t,(function(t){return t.forAll((function(t,r){if(e(t,r))return n=!0,!1})),n})),n}function qe(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function Ke(t,e){for(var n=t.slice(0);0<n.length&&n[0].name===e;)n.shift();return n}function $e(t,e){var n=t.slice(0);return n.reverse(),(n=Ke(n,e)).reverse(),n}function Qe(t){var e=[];return Object(O.arrayEach)(t,(function(t,n){n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}var Ze=n(44);function Je(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var tn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}var e,n,r;return e=t,(n=[{key:"hide",value:function(){var t=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout((function(){!1===t.wasLastActionShow&&t.runLocalHooks("hide")}),250)}},{key:"show",value:function(t){this.wasLastActionShow=!0,this.showDebounced(t)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Object(M.debounce)((function(e){t.wasLastActionShow&&t.runLocalHooks("show",e.from.row,e.from.col)}),e)}},{key:"destroy",value:function(){this.clearLocalHooks()}}])&&Je(e.prototype,n),r&&Je(e,r),t}();Object(j.mixin)(tn,Ze.a);var en=tn,nn=n(3);function rn(t){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function on(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function an(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ln(t,e,n){return(ln="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=un(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function un(t){return(un=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cn(t,e){return(cn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fn=new WeakMap,hn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==rn(e)&&"function"!=typeof e?sn(t):e}(this,un(e).call(this,t))).editor=null,n.displaySwitch=null,n.eventManager=null,n.range={},n.mouseDown=!1,n.contextMenuEvent=!1,n.timer=null,fn.set(sn(n),{tempEditorDimensions:{},cellBelowCursor:null}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cn(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.editor||(this.editor=new He(this.hot.rootDocument)),this.eventManager||(this.eventManager=new m.a(this)),this.displaySwitch||(this.displaySwitch=new en(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(function(e){return t.addToContextMenu(e)})),this.addHook("afterRenderer",(function(e,n,r,o,i,a){return t.onAfterRenderer(e,a)})),this.addHook("afterScrollHorizontally",(function(){return t.hide()})),this.addHook("afterScrollVertically",(function(){return t.hide()})),this.addHook("afterBeginEditing",(function(){return t.onAfterBeginEditing()})),this.displaySwitch.addLocalHook("hide",(function(){return t.hide()})),this.displaySwitch.addLocalHook("show",(function(e,n){return t.showAtCell(e,n)})),this.registerListeners(),ln(un(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ln(un(e.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){ln(un(e.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var t=this,e=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(e,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(function(){return t.onEditorBlur()})),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(function(e){return t.onEditorMouseDown(e)})),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(function(e){return t.onEditorMouseUp(e)}))}},{key:"setRange",value:function(t){this.range=t}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(t){var e=Object(w.closest)(t.target,"TD","TBODY");return!!(e&&Object(w.hasClass)(e,"htCommentCell")&&Object(w.closest)(e,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(t){return this.editor.getInputElement()===t.target}},{key:"setComment",value:function(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.editor.getValue(),n="";null!=t?n=t:null!=e&&(n=e);var r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,on({},"value",n)),this.hot.render()}},{key:"setCommentAtCell",value:function(t,e,n){this.setRange({from:new rt.a(t,e)}),this.setComment(n)}},{key:"removeComment",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,"comment",void 0),t&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:new rt.a(t,e)}),this.removeComment(n)}},{key:"getComment",value:function(){var t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,"value")}},{key:"getCommentAtCell",value:function(t,e){return this.getCommentMeta(t,e,"value")}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(t.comment?t.comment.value:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(t,e){return this.setRange({from:new rt.a(t,e)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t||this.range.from&&this.editor.isVisible()){var e=this.hot.rootWindow,n=this.hot.view.wt,r=n.wtTable,o=n.wtOverlays,i=n.wtViewport,a=o.scrollableElement,s=r.getCell(this.range.from),l=this.range.from.row,u=this.range.from.col,c=Object(w.offset)(s),f=r.getStretchedColumnWidth(u),h=c.top<0?0:c.top,d=c.left;i.hasVerticalScroll()&&a!==e&&(h-=o.topOverlay.getScrollPosition()),i.hasHorizontalScroll()&&a!==e&&(d-=o.leftOverlay.getScrollPosition());var p=d+f,g=h,v=this.getCommentMeta(l,u,"style"),y=this.getCommentMeta(l,u,"readOnly");v?this.editor.setSize(v.width,v.height):this.editor.resetSize(),this.editor.setReadOnlyState(y),this.editor.setPosition(p,g)}}},{key:"checkSelectionCommentsConsistency",value:function(){var t=this.hot.getSelectedRangeLast();if(!t)return!1;var e=!1,n=t.from;return this.getCommentMeta(n.row,n.col,"value")&&(e=!0),e}},{key:"updateCommentMeta",value:function(t,e,n){var r,o=this.hot.getCellMeta(t,e).comment;o?(r=Object(j.deepClone)(o),Object(j.deepExtend)(r,n)):r=n,this.hot.setCellMeta(t,e,"comment",r)}},{key:"getCommentMeta",value:function(t,e,n){var r=this.hot.getCellMeta(t,e);if(r.comment)return r.comment[n]}},{key:"onMouseDown",value:function(t){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(t)){var e=Object(w.closest)(t.target,"TD","TBODY"),n=null;e&&(n=this.hot.view.wt.wtTable.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(t){var e=fn.get(this),n=this.hot.rootDocument;if(e.cellBelowCursor=n.elementFromPoint(t.clientX,t.clientY),!(this.mouseDown||this.editor.isFocused()||Object(w.hasClass)(t.target,"wtBorder")||e.cellBelowCursor!==t.target)&&this.editor)if(this.targetIsCellWithComment(t)){var r=this.hot.view.wt.wtTable.getCoords(t.target),o={from:new rt.a(r.row,r.col)};this.displaySwitch.show(o)}else Object(w.isChildOf)(t.target,n)&&!this.targetIsCommentTextArea(t)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(t,e){e.comment&&e.comment.value&&Object(w.addClass)(t,e.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(t){fn.get(this).tempEditorDimensions={width:Object(w.outerWidth)(t.target),height:Object(w.outerHeight)(t.target)}}},{key:"onEditorMouseUp",value:function(t){var e=fn.get(this),n=Object(w.outerWidth)(t.target),r=Object(w.outerHeight)(t.target);n===e.tempEditorDimensions.width+1&&r===e.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,on({},"style",{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var t=this;this.displaySwitch.cancelHiding();var e=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,this.setRange({from:e.from}),this.show(),setTimeout((function(){t.hot&&(t.hot.deselectCell(),t.editor.focus())}),10)}},{key:"onContextMenuRemoveComment",value:function(){var t=this.hot.getSelectedRangeLast(),e=t.from,n=t.to;this.contextMenuEvent=!0;for(var r=e.row;r<=n.row;r++)for(var o=e.col;o<=n.col;o++)this.removeCommentAtCell(r,o,!1);this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var t=this.hot.getSelectedRangeLast(),e=t.from,n=t.to;this.contextMenuEvent=!0;for(var r=e.row;r<=n.row;r++)for(var o=e.col;o<=n.col;o++){var i=!!this.getCommentMeta(r,o,"readOnly");this.updateCommentMeta(r,o,on({},"readOnly",!i))}}},{key:"addToContextMenu",value:function(t){var e=this;t.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return e.checkSelectionCommentsConsistency()?e.hot.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_EDIT_COMMENT):e.hot.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return e.onContextMenuAddComment()},disabled:function(){return!(this.getSelectedLast()&&!this.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(){return e.onContextMenuRemoveComment()},disabled:function(){return e.hot.selection.isSelectedByCorner()}},{key:"commentsReadOnly",name:function(){var t=this,e=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return Xe(this.getSelectedRangeLast(),(function(e,n){var r=t.getCellMeta(e,n).comment;if(r&&(r=r.readOnly),r)return!0}))&&(e=qe(e)),e},callback:function(){return e.onContextMenuMakeReadOnly()},disabled:function(){return e.hot.selection.isSelectedByCorner()||!e.checkSelectionCommentsConsistency()}})}},{key:"getDisplayDelaySetting",value:function(){var t=this.hot.getSettings().comments;if(Object(j.isObject)(t))return t.displayDelay}},{key:"onAfterBeginEditing",value:function(){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),ln(un(e.prototype),"destroy",this).call(this)}}])&&an(n.prototype,r),o&&an(n,o),e}(W);Object(H.d)("comments",hn);var dn=hn;n(70),n(69);function pn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gn(t,e){var n;return Object(O.arrayEach)(e,(function(e){var r=e.key?e.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=e,!1})),n}var vn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.commands={},this.commonCallback=null}var e,n,r;return e=t,(n=[{key:"registerCommand",value:function(t,e){this.commands[t]=e}},{key:"setCommonCallback",value:function(t){this.commonCallback=t}},{key:"execute",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=t.split(":"),a=i[0],s=2===i.length?i[1]:null,l=this.commands[a];if(!l)throw new Error("Menu command '".concat(a,"' not exists."));if(s&&l.submenu&&(l=gn(s,l.submenu.items)),!0!==l.disabled&&("function"!=typeof l.disabled||!0!==l.disabled.call(this.hot))&&!Object(j.hasOwnProperty)(l,"submenu")){var u=[];"function"==typeof l.callback&&u.push(l.callback),"function"==typeof this.commonCallback&&u.push(this.commonCallback),r.unshift(i.join(":")),Object(O.arrayEach)(u,(function(t){return t.apply(e.hot,r)}))}}}])&&pn(e.prototype,n),r&&pn(e,r),t}();function yn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function mn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function bn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var wn=n(55);function On(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Cn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var En;function Sn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var kn=["row_above","row_below","col_left","col_right","clear_column","remove_row","remove_col","undo","redo","make_read_only","alignment",Fe,"no_items"],Rn=(Sn(En={},Fe,(function(){return{name:Fe}})),Sn(En,"no_items",(function(){return{key:"no_items",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}})),Sn(En,"row_above",(function(){return{key:"row_above",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_row",n.start.row,1,"ContextMenu.rowAbove")},disabled:function(){return!Ve(this)||(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}})),Sn(En,"row_below",(function(){return{key:"row_below",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_row",n.end.row+1,1,"ContextMenu.rowBelow")},disabled:function(){return!Ve(this)||(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}})),Sn(En,"col_left",(function(){return{key:"col_left",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_col",n.start.col,1,"ContextMenu.columnLeft")},disabled:function(){var t=Ve(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=mn(t[0],3),n=e[0],r=e[1],o=[n,0,e[2],this.countCols()-1].join(",")===t.join(","),i=1===this.countCols();return r<0||this.countCols()>=this.getSettings().maxCols||!i&&o},hidden:function(){return!this.getSettings().allowInsertColumn}}})),Sn(En,"col_right",(function(){return{key:"col_right",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(t,e){var n=e[Math.max(e.length-1,0)];this.alter("insert_col",n.end.col+1,1,"ContextMenu.columnRight")},disabled:function(){var t=Ve(this);if(!t)return!0;if(!this.isColumnModificationAllowed())return!0;var e=bn(t[0],3),n=e[0],r=e[1],o=[n,0,e[2],this.countCols()-1].join(",")===t.join(","),i=1===this.countCols();return r<0||this.countCols()>=this.getSettings().maxCols||!i&&o},hidden:function(){return!this.getSettings().allowInsertColumn}}})),Sn(En,"clear_column",(function(){return{key:"clear_column",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(t,e){var n=e[0].start.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled:function(){var t=Ve(this);if(!t)return!0;var e=yn(t[0],3),n=e[0],r=e[1],o=[n,0,e[2],this.countCols()-1].join(",")===t.join(",");return r<0||this.countCols()>=this.getSettings().maxCols||o}}})),Sn(En,"remove_row",(function(){return{key:"remove_row",name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=Cn(t[0],3);n[0]-n[2]!=0&&(e=1)}return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback:function(){this.alter("remove_row",Object(wn.g)(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=Ve(this),e=this.countRows();return!t||(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner()||!e)},hidden:function(){return!this.getSettings().allowRemoveRow}}})),Sn(En,"remove_col",(function(){return{key:"remove_col",name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=On(t[0],4);n[1]-n[3]!=0&&(e=1)}return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback:function(){this.alter("remove_col",Object(wn.f)(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){var t=Ve(this),e=this.countCols();return!t||(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner()||!this.isColumnModificationAllowed()||!e)},hidden:function(){return!this.getSettings().allowRemoveColumn}}})),Sn(En,"undo",(function(){return{key:"undo",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}})),Sn(En,"redo",(function(){return{key:"redo",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}})),Sn(En,"make_read_only",(function(){return{key:"make_read_only",name:function(){var t=this,e=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_READ_ONLY);return Xe(this.getSelectedRange(),(function(e,n){return t.getCellMeta(e,n).readOnly}))&&(e=qe(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Xe(e,(function(e,n){return t.getCellMeta(e,n).readOnly}));Object(O.arrayEach)(e,(function(e){e.forAll((function(e,r){t.setCellMeta(e,r,"readOnly",!n)}))})),this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())}}})),Sn(En,"alignment",(function(){return{key:"alignment",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat("alignment",":left"),name:function(){var t=this,e=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return Xe(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htLeft"))return!0}))&&(e=qe(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ye(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"horizontal","htLeft"),ze(e,"horizontal","htLeft",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat("alignment",":center"),name:function(){var t=this,e=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return Xe(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htCenter"))return!0}))&&(e=qe(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ye(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"horizontal","htCenter"),ze(e,"horizontal","htCenter",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat("alignment",":right"),name:function(){var t=this,e=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return Xe(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htRight"))return!0}))&&(e=qe(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ye(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"horizontal","htRight"),ze(e,"horizontal","htRight",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat("alignment",":justify"),name:function(){var t=this,e=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return Xe(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htJustify"))return!0}))&&(e=qe(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ye(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"horizontal","htJustify"),ze(e,"horizontal","htJustify",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{name:Fe},{key:"".concat("alignment",":top"),name:function(){var t=this,e=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return Xe(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htTop"))return!0}))&&(e=qe(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ye(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"vertical","htTop"),ze(e,"vertical","htTop",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat("alignment",":middle"),name:function(){var t=this,e=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return Xe(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htMiddle"))return!0}))&&(e=qe(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ye(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"vertical","htMiddle"),ze(e,"vertical","htMiddle",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat("alignment",":bottom"),name:function(){var t=this,e=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return Xe(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htBottom"))return!0}))&&(e=qe(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=Ye(e,(function(e,n){return t.getCellMeta(e,n).className}));this.runHooks("beforeCellAlignment",n,e,"vertical","htBottom"),ze(e,"vertical","htBottom",(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1}]}}})),En);function _n(){var t={};return Object(j.objectEach)(Rn,(function(e,n){t[n]=e()})),t}function Tn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function An(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o=t;return o&&o.items?o=o.items:Array.isArray(o)||(o=e),Object(j.isObject)(o)?Object(j.objectEach)(o,(function(t,e){var o=n["string"==typeof t?t:e];o||(o=t),Object(j.isObject)(t)?Object(j.extend)(o,t):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=e),r.push(o)})):Object(O.arrayEach)(o,(function(t,e){var o=n[t];!o&&kn.indexOf(t)>=0||(o||(o={name:t,key:"".concat(e)}),Object(j.isObject)(t)&&Object(j.extend)(o,t),void 0===o.key&&(o.key=e),r.push(o))})),r}var Nn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Tn(this,t),this.hot=e,this.predefinedItems=_n(),this.defaultOrderPattern=n}var e,n,r;return e=t,(n=[{key:"setPredefinedItems",value:function(t){var e=this,n={};this.defaultOrderPattern.length=0,Object(j.objectEach)(t,(function(t,r){var o="";t.name===Fe?(n[Fe]=t,o=Fe):isNaN(parseInt(r,10))?(t.key=void 0===t.key?r:t.key,n[r]=t,o=t.key):(n[t.key]=t,o=t.key),e.defaultOrderPattern.push(o)})),this.predefinedItems=n}},{key:"getItems",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return An(t,this.defaultOrderPattern,this.predefinedItems)}}])&&Mn(e.prototype,n),r&&Mn(e,r),t}();n(129);function jn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r,o,i,a,s,l,u=Object(w.getWindowScrollTop)(n),c=Object(w.getWindowScrollLeft)(n);this.rootWindow=n,this.type=this.getSourceType(e),"literal"===this.type?(r=parseInt(e.top,10),i=parseInt(e.left,10),s=e.height||0,l=e.width||0,o=r,a=i,r+=u,i+=c):"event"===this.type&&(r=parseInt(Object(P.pageY)(e),10),i=parseInt(Object(P.pageX)(e),10),s=e.target.clientHeight,l=e.target.clientWidth,o=r-u,a=i-c),this.top=r,this.topRelative=o,this.left=i,this.leftRelative=a,this.scrollTop=u,this.scrollLeft=c,this.cellHeight=s,this.cellWidth=l}var e,n,r;return e=t,(n=[{key:"getSourceType",value:function(t){var e="literal";return t instanceof Event&&(e="event"),e}},{key:"fitsAbove",value:function(t){return this.topRelative>=t.offsetHeight}},{key:"fitsBelow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}},{key:"fitsOnRight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}},{key:"fitsOnLeft",value:function(t){return this.leftRelative>=t.offsetWidth}}])&&jn(e.prototype,n),r&&jn(e,r),t}();function In(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Dn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.eventManager=new m.a(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}var e,n,r;return e=t,(n=[{key:"registerEvents",value:function(){for(var t=this,e=this.hot.rootWindow;e;)this.eventManager.addEventListener(e.document,"mousedown",(function(e){return t.onDocumentMouseDown(e)})),e=Object(w.getParentWindow)(e)}},{key:"setMenuItems",value:function(t){this.menuItems=t}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[t]=e}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var t=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var e=Object(M.debounce)((function(e){return t.openSubMenu(e)}),300),n=this.options.minWidth||215,r=!1,o=Object(O.arrayFilter)(this.menuItems,(function(e){return"no_items"===e.key&&(r=!0),function(t,e){return!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))}(e,t.hot)}));if(o.length<1&&!r)o.push(_n().no_items);else if(0===o.length)return;o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fe,n=t.slice(0);return n=Qe(n=$e(n=Ke(n,e),e))}(o,Fe);var i=!1,a={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(t){return Object(A.isDefined)(t)&&t<n?n:t},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,columns:[{data:"name",renderer:function(e,n,r,o,i,a){return t.menuItemRenderer(e,n,r,o,i,a)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",beforeKeyDown:function(e){return t.onBeforeKeyDown(e)},afterOnCellMouseOver:function(n,r){t.isAllSubMenusClosed()?e(r.row):t.openSubMenu(r.row)},rowHeights:function(t){return o[t].name===Fe?1:23},afterOnCellContextMenu:function(e){e.preventDefault(),Object(k.isWindowsOS)()&&i&&t.hasSelectedItem()&&t.close(!0)},beforeOnCellMouseUp:function(e){t.hasSelectedItem()&&(i=!t.isCommandPassive(t.getSelectedItem()),t.executeCommand(e))},afterOnCellMouseUp:function(e){Object(k.isWindowsOS)()&&Object(P.isRightClick)(e)||!i||!t.hasSelectedItem()||t.close(!0)},afterUnlisten:function(){!t.hasSelectedItem()&&t.isOpened()&&t.hotMenu.listen(!1)}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new y.a(this.container,a),this.hotMenu.addHook("afterInit",(function(){return t.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return t.onAfterSelection.apply(t,arguments)})),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(t&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(e){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!function(t){return Object(w.hasClass)(t,"htSubmenu")}(n))return!1;var r=this.hotMenu.getSourceDataAtRow(e),o=new t(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=o,o}},{key:"closeSubMenu",value:function(t){var e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];n&&(n.destroy(),delete this.hotSubMenus[e.key])}},{key:"closeAllSubMenus",value:function(){var t=this;Object(O.arrayEach)(this.hotMenu.getData(),(function(e,n){return t.closeSubMenu(n)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(t){if(this.isOpened()&&this.hasSelectedItem()){var e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),!this.isCommandPassive(e)){var n=this.hot.getSelectedRange(),r=n?function(t){return Object(O.arrayMap)(t,(function(t){return{start:t.getTopLeftCorner(),end:t.getBottomRightCorner()}}))}(n):[];this.runLocalHooks("executeCommand",e.key,r,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,r,t)}}}},{key:"isCommandPassive",value:function(t){var e=t.isCommand,n=t.name,r=t.disabled,o=t.submenu,i=!0===r||"function"==typeof r&&!0===r.call(this.hot);return!1===e||n===Fe||!0===i||o}},{key:"setPosition",value:function(t){var e=new xn(t,this.container.ownerDocument.defaultView);this.options.keepInViewport?(e.fitsBelow(this.container)?this.setPositionBelowCursor(e):e.fitsAbove(this.container)?this.setPositionAboveCursor(e):this.setPositionBelowCursor(e),e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)):(this.setPositionBelowCursor(e),this.setPositionOnRightOfCursor(e))}},{key:"setPositionAboveCursor",value:function(t){var e=this.offset.above+t.top-this.container.offsetHeight;this.isSubMenu()&&(e=t.top+t.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(e,"px")}},{key:"setPositionBelowCursor",value:function(t){var e=this.offset.below+t.top;this.isSubMenu()&&(e=t.top-1),this.container.style.top="".concat(e,"px")}},{key:"setPositionOnRightOfCursor",value:function(t){var e;e=this.isSubMenu()?1+t.left+t.cellWidth:this.offset.right+1+t.left,this.container.style.left="".concat(e,"px")}},{key:"setPositionOnLeftOfCursor",value:function(t){var e=this.offset.left+t.left-this.container.offsetWidth+Object(w.getScrollbarWidth)(this.hot.rootDocument)+4;this.container.style.left="".concat(e,"px")}},{key:"selectFirstCell",value:function(){var t=this.hotMenu.getCell(0,0);Be(t)||Ue(t)||We(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var t=this.hotMenu.countRows()-1,e=this.hotMenu.getCell(t,0);Be(e)||Ue(e)||We(e)?this.selectPrevCell(t,0):this.hotMenu.selectCell(t,0)}},{key:"selectNextCell",value:function(t,e){var n=t+1,r=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,e):null;r&&(Be(r)||Ue(r)||We(r)?this.selectNextCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"selectPrevCell",value:function(t,e){var n=t-1,r=n>=0?this.hotMenu.getCell(n,e):null;r&&(Be(r)||Ue(r)||We(r)?this.selectPrevCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"menuItemRenderer",value:function(t,e,n,r,o,i){var a,s=this,l=t.getSourceDataAtRow(n),u=this.hot.rootDocument.createElement("div"),c=function(t){return t.disableSelection},f=i;"function"==typeof f&&(f=f.call(this.hot)),Object(w.empty)(e),Object(w.addClass)(u,"htItemWrapper"),e.appendChild(u),a=l,new RegExp(Fe,"i").test(a.name)?Object(w.addClass)(e,"htSeparator"):"function"==typeof l.renderer?(Object(w.addClass)(e,"htCustomMenuRenderer"),e.appendChild(l.renderer(t,u,n,r,o,f))):Object(w.fastInnerHTML)(u,f),function(t){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(s.hot)}(l)?(Object(w.addClass)(e,"htDisabled"),this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()}))):c(l)?(Object(w.addClass)(e,"htSelectionDisabled"),this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()}))):function(t){return Object(j.hasOwnProperty)(t,"submenu")}(l)?(Object(w.addClass)(e,"htSubmenu"),c(l)?this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()})):this.eventManager.addEventListener(e,"mouseenter",(function(){return t.selectCell(n,r,void 0,void 0,!1,!1)}))):(Object(w.removeClass)(e,["htSubmenu","htDisabled"]),c(l)?this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()})):this.eventManager.addEventListener(e,"mouseenter",(function(){return t.selectCell(n,r,void 0,void 0,!1,!1)})))}},{key:"createContainer",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.options.container.ownerDocument,r=e;return r&&(Object(M.isFunction)(r)&&(r=null===(r=r.call(this.hot))||Object(A.isUndefined)(r)?"":r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r="".concat(this.options.className,"Sub_").concat(r),t=n.querySelector(".".concat(this.options.className,".").concat(r))),t||(t=n.createElement("div"),Object(w.addClass)(t,"htMenu ".concat(this.options.className)),r&&Object(w.addClass)(t,r),this.options.container.appendChild(t)),t}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(t){if(Object(w.isInput)(t.target)&&this.container.contains(t.target))Object(P.stopImmediatePropagation)(t);else{var e=this.hotMenu.getSelectedLast(),n=!1;switch(this.keyEvent=!0,t.keyCode){case D.KEY_CODES.ESCAPE:this.close(),n=!0;break;case D.KEY_CODES.ENTER:e&&(this.hotMenu.getSourceDataAtRow(e[0]).submenu?n=!0:(this.executeCommand(t),this.close(!0)));break;case D.KEY_CODES.ARROW_DOWN:e?this.selectNextCell(e[0],e[1]):this.selectFirstCell(),n=!0;break;case D.KEY_CODES.ARROW_UP:e?this.selectPrevCell(e[0],e[1]):this.selectLastCell(),n=!0;break;case D.KEY_CODES.ARROW_RIGHT:if(e){var r=this.openSubMenu(e[0]);r&&r.selectFirstCell()}n=!0;break;case D.KEY_CODES.ARROW_LEFT:e&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),n=!0)}n&&(t.preventDefault(),Object(P.stopImmediatePropagation)(t)),this.keyEvent=!1}}},{key:"onAfterInit",value:function(){var t=this.hotMenu.view.wt.wtTable,e=this.hotMenu.getSettings().data,n=t.hider.style,r=t.holder.style,o=parseInt(n.width,10),i=Object(O.arrayReduce)(e,(function(t,e){return t+(e.name===Fe?1:26)}),0);r.width="".concat(o+22,"px"),r.height="".concat(i+4,"px"),n.height=r.height}},{key:"onAfterSelection",value:function(t,e,n,r,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Object(w.isChildOf)(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Object(w.isChildOf)(t.target,".htMenu")||!Object(w.isChildOf)(t.target,this.container.ownerDocument)&&!Object(w.isChildOf)(t.target,this.hot.rootDocument)||this.close(!0))}}])&&In(e.prototype,n),r&&In(e,r),t}();Object(j.mixin)(Dn,Ze.a);var Pn=Dn;function Ln(t){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fn(t,e,n){return(Fn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bn(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Bn(t){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wn(t,e,n){return e&&Un(t.prototype,e),n&&Un(t,n),t}function Vn(t,e){return(Vn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}b.a.getSingleton().register("afterContextMenuDefaultOptions"),b.a.getSingleton().register("beforeContextMenuShow"),b.a.getSingleton().register("afterContextMenuShow"),b.a.getSingleton().register("afterContextMenuHide"),b.a.getSingleton().register("afterContextMenuExecute");var Yn=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==Ln(e)&&"function"!=typeof e?Hn(t):e}(this,Bn(e).call(this,t))).eventManager=new m.a(Hn(n)),n.commandExecutor=new vn(n.hot),n.itemsFactory=null,n.menu=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vn(t,e)}(e,t),Wn(e,null,[{key:"DEFAULT_ITEMS",get:function(){return["row_above","row_below",Fe,"col_left","col_right",Fe,"remove_row","remove_col",Fe,"undo","redo",Fe,"make_read_only",Fe,"alignment"]}}]),Wn(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().contextMenu;"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Pn(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(function(){return t.onMenuBeforeOpen()})),this.menu.addLocalHook("afterOpen",(function(){return t.onMenuAfterOpen()})),this.menu.addLocalHook("afterClose",(function(){return t.onMenuAfterClose()})),this.menu.addLocalHook("executeCommand",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.executeCommand).call.apply(e,[t].concat(r))})),this.addHook("afterOnCellContextMenu",(function(e){return t.onAfterOnCellContextMenu(e)})),Fn(Bn(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Fn(Bn(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),Fn(Bn(e.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(t){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){var e=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement.getBoundingClientRect(),o=r.top,i=r.left;e=o-Object(w.getWindowScrollTop)(t.view),n=i-Object(w.getWindowScrollLeft)(t.view)}else e=-1*Object(w.getWindowScrollTop)(this.menu.hotMenu.rootWindow),n=-1*Object(w.getWindowScrollLeft)(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(Object(P.pageY)(t),10)+e,left:parseInt(Object(P.pageX)(t),10)+n}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(t){var e;null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"prepareMenuItems",value:function(){var t=this;this.itemsFactory=new Nn(this.hot,e.DEFAULT_ITEMS);var n=this.hot.getSettings().contextMenu,r={items:this.itemsFactory.getItems(n)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);var o=this.itemsFactory.getItems(n);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),Object(O.arrayEach)(o,(function(e){return t.commandExecutor.registerCommand(e.key,e)}))}},{key:"onAfterOnCellContextMenu",value:function(t){var e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;var o=t.realTarget;this.close(),Object(w.hasClass)(o,"handsontableInput")||(t.preventDefault(),Object(P.stopPropagation)(t),(n||r||function(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}(o)||Object(w.hasClass)(o,"current")&&Object(w.hasClass)(o,"wtBorder"))&&this.open(t))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Fn(Bn(e.prototype),"destroy",this).call(this)}}]),e}(W);Yn.SEPARATOR={name:Fe},Object(H.d)("contextMenu",Yn);var zn=Yn,Gn=n(96),Xn=n.n(Gn);function qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Kn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data={}}var e,n,r;return e=t,(n=[{key:"setData",value:function(t,e){this.data[t]=e}},{key:"getData",value:function(t){return this.data[t]||void 0}}])&&qn(e.prototype,n),r&&qn(e,r),t}();var $n=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.clipboardData=new Kn};n(254);function Qn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Zn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new m.a(this),this.listenersCount=new WeakSet,this.container=e}var e,n,r;return e=t,(n=[{key:"useSecondaryElement",value:function(){var t=function(t){var e=nr.get(t);if(e)return e.parentElement||t.appendChild(e),e;var n=(t.defaultView?t:t.ownerDocument).createElement("textarea");return nr.set(t,n),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",t.appendChild(n),n}(this.container);this.listenersCount.has(t)||(this.listenersCount.add(t),er(this.eventManager,t,this)),this.mainElement=t}},{key:"setFocusableElement",value:function(t){this.listenersCount.has(t)||(this.listenersCount.add(t),er(this.eventManager,t,this)),this.mainElement=t}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Object(k.isMobileBrowser)()||Object(w.selectElementIfAllowed)(this.mainElement)}}])&&Qn(e.prototype,n),r&&Qn(e,r),t}();Object(j.mixin)(Zn,Ze.a);var Jn=new WeakMap;var tr=function(t,e){return function(n){return e.runLocalHooks(t,n)}};function er(t,e,n){t.addEventListener(e,"copy",tr("copy",n)),t.addEventListener(e,"cut",tr("cut",n)),t.addEventListener(e,"paste",tr("paste",n))}var nr=new WeakMap;function rr(t){if(t instanceof Zn){var e=Jn.get(t.container);if((e=isNaN(e)?0:e)>0&&(e-=1),function(t){t.eventManager.clear()}(t),e<=0){e=0;var n=nr.get(t.container);n&&n.parentNode&&(n.parentNode.removeChild(n),nr.delete(t.container)),t.mainElement=null}Jn.set(t.container,e)}}function or(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ir(t){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lr(t,e,n){return(lr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ur(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ur(t){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cr(t,e){return(cr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}b.a.getSingleton().register("afterCopyLimit"),b.a.getSingleton().register("modifyCopyableRange"),b.a.getSingleton().register("beforeCut"),b.a.getSingleton().register("afterCut"),b.a.getSingleton().register("beforePaste"),b.a.getSingleton().register("afterPaste"),b.a.getSingleton().register("beforeCopy"),b.a.getSingleton().register("afterCopy");var fr=new WeakMap,hr=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),dr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==ir(e)&&"function"!=typeof e?sr(t):e}(this,ur(e).call(this,t))).columnsLimit=1e3,n.copyableRanges=[],n.focusableElement=void 0,n.pasteMode="overwrite",n.rowsLimit=1e3,n.uiContainer=n.hot.rootDocument.body,fr.set(sr(n),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cr(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n,r,o,i=this.hot.getSettings(),a=i.copyPaste,s=i.fragmentSelection;fr.get(this).isFragmentSelectionEnabled=!!s,"object"===ir(a)&&(this.pasteMode=a.pasteMode||this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,this.uiContainer=a.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",(function(e){return t.onAfterContextMenuDefaultOptions(e)})),this.addHook("afterOnCellMouseUp",(function(){return t.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return t.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return t.onBeforeKeyDown()})),this.focusableElement=(n=this.uiContainer,r=new Zn(n),o=Jn.get(n),o=isNaN(o)?0:o,Jn.set(n,o+1),r),this.focusableElement.addLocalHook("copy",(function(e){return t.onCopy(e)})).addLocalHook("cut",(function(e){return t.onCut(e)})).addLocalHook("paste",(function(e){return t.onPaste(e)})),lr(ur(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),lr(ur(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&rr(this.focusableElement),lr(ur(e.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){fr.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){fr.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(t){var e=this,n=[],r=[],o=[];return Object(O.arrayEach)(t,(function(t){Object(N.rangeEach)(t.startRow,t.endRow,(function(t){-1===r.indexOf(t)&&r.push(t)})),Object(N.rangeEach)(t.startCol,t.endCol,(function(t){-1===o.indexOf(t)&&o.push(t)}))})),Object(O.arrayEach)(r,(function(t){var r=[];Object(O.arrayEach)(o,(function(n){r.push(e.hot.getCopyableData(t,n))})),n.push(r)})),Xn.a.stringify(n)}},{key:"getRangedData",value:function(t){var e=this,n=[],r=[],o=[];return Object(O.arrayEach)(t,(function(t){Object(N.rangeEach)(t.startRow,t.endRow,(function(t){-1===r.indexOf(t)&&r.push(t)})),Object(N.rangeEach)(t.startCol,t.endCol,(function(t){-1===o.indexOf(t)&&o.push(t)}))})),Object(O.arrayEach)(r,(function(t){var r=[];Object(O.arrayEach)(o,(function(n){r.push(e.hot.getCopyableData(t,n))})),n.push(r)})),n}},{key:"paste",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(t||e){var n=new $n;t&&n.clipboardData.setData("text/plain",t),e&&n.clipboardData.setData("text/html",e),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var t=this.hot.getSelectedRangeLast();if(t){var e=t.getTopLeftCorner(),n=t.getBottomRightCorner(),r=e.row,o=e.col,i=n.row,a=n.col,s=Math.min(i,r+this.rowsLimit-1),l=Math.min(a,o+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:r,startCol:o,endRow:s,endCol:l}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),i===s&&a===l||this.hot.runHooks("afterCopyLimit",i-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var t=this.hot.getActiveEditor(),e=t?t.TEXTAREA:void 0;e?this.focusableElement.setFocusableElement(e):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var t=this.hot.getActiveEditor();return t&&t.isOpened()}},{key:"populateValues",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedLast();if(t.length){for(var n=t.length-1,r=t[0].length-1,o=Math.min(e[0],e[2]),i=Math.max(e[0],e[2],n+o),a=Math.min(e[1],e[3]),s=Math.max(e[1],e[3],r+a),l=[],u=o,c=0;u<=i;u+=1){for(var f=[],h=a,d=0;h<=s;h+=1)f.push(t[c][d]),d=d===r?0:d+=1;l.push(f),c=c===n?0:c+=1}return this.hot.populateFromArray(o,a,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,i,s]}}},{key:"onCopy",value:function(t){var e=fr.get(this);if((this.hot.isListening()||e.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),e.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCopy",n,this.copyableRanges)){var r=Xn.a.stringify(n);if(t&&t.clipboardData){var o=Object(S._dataToHTML)(n,this.hot.rootDocument);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",[hr,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",n,this.copyableRanges)}t.preventDefault()}}},{key:"onCut",value:function(t){var e=fr.get(this);if((this.hot.isListening()||e.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),e.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",n,this.copyableRanges)){var r=Xn.a.stringify(n);if(t&&t.clipboardData){var o=Object(S._dataToHTML)(n,this.hot.rootDocument);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",[hr,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}t.preventDefault()}}},{key:"onPaste",value:function(t){if(this.hot.isListening()&&!this.isEditorOpened()){var e;if(t&&t.preventDefault&&t.preventDefault(),t&&void 0!==t.clipboardData){var n=t.clipboardData.getData("text/html");e=n&&/(<table)|(<TABLE)/g.test(n)?Object(S.htmlToGridSettings)(n,this.hot.rootDocument).data:t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof e&&(e=Xn.a.parse(e)),(!e||0!==e.length)&&!1!==this.hot.runHooks("beforePaste",e,this.copyableRanges)){var r=or(this.populateValues(e),4),o=r[0],i=r[1],a=r[2],s=r[3];this.hot.selectCell(o,i,Math.min(this.hot.countRows()-1,a),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;t.items.push({name:"---------"},(e=this,{key:"copy",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_COPY)},callback:function(){e.copy()},disabled:function(){var t=this.getSelected();return!t||t.length>1},hidden:!1}),function(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_CUT)},callback:function(){t.cut()},disabled:function(){var t=this.getSelected();return!t||t.length>1},hidden:!1}}(this))}},{key:"onAfterOnCellMouseUp",value:function(){this.hot.isListening()&&!this.isEditorOpened()&&(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var t=fr.get(this).isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),t&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Object(w.getSelectionText)()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var t=this.hot.rootDocument.activeElement,e=this.hot.getActiveEditor();!e||t!==this.focusableElement.getFocusableElement()&&t!==e.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(rr(this.focusableElement),this.focusableElement=null),lr(ur(e.prototype),"destroy",this).call(this)}}])&&ar(n.prototype,r),o&&ar(n,o),e}(W);Object(H.d)("CopyPaste",dr);var pr=dr;n(213);function gr(t,e){return"border_row".concat(t,"col").concat(e)}function vr(t,e){return{id:gr(t,e),border:{width:1,color:"#000",cornerVisible:!1},row:t,col:e,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}}function yr(t,e){var n=!1;return Object(O.arrayEach)(t.getSelectedRange(),(function(r){r.forAll((function(r,o){var i=t.getCellMeta(r,o).borders;if(i){if(!e)return n=!0,!1;if(!Object(j.hasOwnProperty)(i[e],"hide")||!1===i[e].hide)return n=!0,!1}}))})),n}function mr(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function br(t){return{key:"borders:bottom",name:function(){var t=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return yr(this,"bottom")&&(t=mr(t)),t},callback:function(e,n){var r=yr(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function wr(t){return{key:"borders:left",name:function(){var t=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_BORDERS_LEFT);return yr(this,"left")&&(t=mr(t)),t},callback:function(e,n){var r=yr(this,"left");t.prepareBorder(n,"left",r)}}}function Or(t){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(e,n){t.prepareBorder(n,"noBorders")},disabled:function(){return!yr(this)}}}function Cr(t){return{key:"borders:right",name:function(){var t=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return yr(this,"right")&&(t=mr(t)),t},callback:function(e,n){var r=yr(this,"right");t.prepareBorder(n,"right",r)}}}var Er=n(102);function Sr(t){return(Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Rr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _r(t,e){return!e||"object"!==Sr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tr(t,e,n){return(Tr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mr(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Mr(t){return(Mr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ar(t,e){return(Ar=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=_r(this,Mr(e).call(this,t))).savedBorders=[],n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ar(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().customBorders}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(e){return t.onAfterContextMenuDefaultOptions(e)})),this.addHook("init",(function(){return t.onAfterInit()})),Tr(Mr(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Tr(Mr(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Tr(Mr(e.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(t,e){var n=this,r=e?Object.keys(e):["top","right","bottom","left"],o=Object(Er.b)(t),i=Object(Er.c)(o);Object(O.arrayEach)(t,(function(t){for(var o=kr(i(t),4),a=o[0],s=o[1],l=o[2],u=o[3],c=function(t){for(var o=function(o){Object(O.arrayEach)(r,(function(r){n.prepareBorderFromCustomAdded(t,o,e,r)}))},i=s;i<=u;i+=1)o(i)},f=a;f<=l;f+=1)c(f)})),this.hot.view.render()}},{key:"getBorders",value:function(t){var e=this;if(!Array.isArray(t))return this.savedBorders;var n=Object(Er.b)(t),r=Object(Er.c)(n),o=[];return Object(O.arrayEach)(t,(function(t){for(var n=kr(r(t),4),i=n[0],a=n[1],s=n[2],l=n[3],u=function(t){for(var n=function(n){Object(O.arrayEach)(e.savedBorders,(function(e){e.row===t&&e.col===n&&o.push(e)}))},r=a;r<=l;r+=1)n(r)},c=i;c<=s;c+=1)u(c)})),o}},{key:"clearBorders",value:function(t){var e=this;t?this.setBorders(t):(Object(O.arrayEach)(this.savedBorders,(function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange(),e.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(t,e){this.checkSavedBorders(t)||this.savedBorders.push(t);var n={row:t.row,col:t.col},r=new rt.b(n,n,n);this.checkCustomSelections(t,r,e)||this.hot.selection.highlight.addCustomSelection({border:t,cellRange:r})}},{key:"prepareBorderFromCustomAdded",value:function(t,e,n,r){var o,i,a=vr(t,e);n&&(o=a,i=n,Object(j.hasOwnProperty)(i,"border")&&(o.border=i.border),Object(j.hasOwnProperty)(i,"top")&&(i.top?(Object(j.isObject)(i.top)||(i.top={width:1,color:"#000"}),o.top=i.top):(i.top={hide:!0},o.top=i.top)),Object(j.hasOwnProperty)(i,"right")&&(i.right?(Object(j.isObject)(i.right)||(i.right={width:1,color:"#000"}),o.right=i.right):(i.right={hide:!0},o.right=i.right)),Object(j.hasOwnProperty)(i,"bottom")&&(i.bottom?(Object(j.isObject)(i.bottom)||(i.bottom={width:1,color:"#000"}),o.bottom=i.bottom):(i.bottom={hide:!0},o.bottom=i.bottom)),Object(j.hasOwnProperty)(i,"left")&&(i.left?(Object(j.isObject)(i.left)||(i.left={width:1,color:"#000"}),o.left=i.left):(i.left={hide:!0},o.left=i.left)),a=o,Object(O.arrayEach)(this.hot.selection.highlight.customSelections,(function(t){if(a.id===t.settings.id)return Object.assign(t.settings,n),a=t.settings,!1}))),this.hot.setCellMeta(t,e,"borders",a),this.insertBorderIntoSettings(a,r)}},{key:"prepareBorderFromCustomAddedRange",value:function(t){var e=this,n=t.range;Object(N.rangeEach)(n.from.row,n.to.row,(function(r){Object(N.rangeEach)(n.from.col,n.to.col,(function(o){var i=vr(r,o),a=0;r===n.from.row&&Object(j.hasOwnProperty)(t,"top")&&(a+=1,i.top=t.top),r===n.to.row&&Object(j.hasOwnProperty)(t,"bottom")&&(a+=1,i.bottom=t.bottom),o===n.from.col&&Object(j.hasOwnProperty)(t,"left")&&(a+=1,i.left=t.left),o===n.to.col&&Object(j.hasOwnProperty)(t,"right")&&(a+=1,i.right=t.right),a>0&&(e.hot.setCellMeta(r,o,"borders",i),e.insertBorderIntoSettings(i))}))}))}},{key:"removeAllBorders",value:function(t,e){var n=gr(t,e);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}},{key:"setBorder",value:function(t,e,n,r){var o=this.hot.getCellMeta(t,e).borders;o&&void 0!==o.border||(o=vr(t,e)),r?(o[n]={hide:!0},4===this.countHide(o)?this.removeAllBorders(t,e):(this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",o))):(o[n]={width:1,color:"#000"},this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",o))}},{key:"prepareBorder",value:function(t,e,n){var r=this;Object(O.arrayEach)(t,(function(t){var o=t.start,i=t.end;if(o.row===i.row&&o.col===i.col)"noBorders"===e?r.removeAllBorders(o.row,o.col):r.setBorder(o.row,o.col,e,n);else switch(e){case"noBorders":Object(N.rangeEach)(o.col,i.col,(function(t){Object(N.rangeEach)(o.row,i.row,(function(e){r.removeAllBorders(e,t)}))}));break;case"top":Object(N.rangeEach)(o.col,i.col,(function(t){r.setBorder(o.row,t,e,n)}));break;case"right":Object(N.rangeEach)(o.row,i.row,(function(t){r.setBorder(t,i.col,e,n)}));break;case"bottom":Object(N.rangeEach)(o.col,i.col,(function(t){r.setBorder(i.row,t,e,n)}));break;case"left":Object(N.rangeEach)(o.row,i.row,(function(t){r.setBorder(t,o.col,e,n)}))}}))}},{key:"createCustomBorders",value:function(t){var e=this;Object(O.arrayEach)(t,(function(t){t.range?e.prepareBorderFromCustomAddedRange(t):e.prepareBorderFromCustomAdded(t.row,t.col,t)}))}},{key:"countHide",value:function(t){var e=Object.values(t);return Object(O.arrayReduce)(e,(function(t,e){var n=t;return e.hide&&(n+=1),n}),0)}},{key:"clearBordersFromSelectionSettings",value:function(t){var e=Object(O.arrayMap)(this.hot.selection.highlight.customSelections,(function(t){return t.settings.id})).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}},{key:"clearNullCellRange",value:function(){var t=this;Object(O.arrayEach)(this.hot.selection.highlight.customSelections,(function(e,n){if(null===e.cellRange)return t.hot.selection.highlight.customSelections[n].destroy(),t.hot.selection.highlight.customSelections.splice(n,1),!1}))}},{key:"hideBorders",value:function(){var t=this;Object(O.arrayEach)(this.savedBorders,(function(e){t.clearBordersFromSelectionSettings(e.id),t.clearNullCellRange()}))}},{key:"spliceBorder",value:function(t){var e=Object(O.arrayMap)(this.savedBorders,(function(t){return t.id})).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}},{key:"checkSavedBorders",value:function(t){var e=this,n=!1;return 4===this.countHide(t)?(this.spliceBorder(t.id),n=!0):Object(O.arrayEach)(this.savedBorders,(function(r,o){if(t.id===r.id)return e.savedBorders[o]=t,n=!0,!1})),n}},{key:"checkCustomSelectionsFromContextMenu",value:function(t,e,n){var r=!1;return Object(O.arrayEach)(this.hot.selection.highlight.customSelections,(function(o){if(t.id===o.settings.id)return Object(j.objectEach)(o.instanceBorders,(function(t){t.toggleHiddenClass(e,n)})),r=!0,!1})),r}},{key:"checkCustomSelections",value:function(t,e,n){var r=this.countHide(t),o=!1;return 4===r?(this.removeAllBorders(t.row,t.col),o=!0):Object(O.arrayEach)(this.hot.selection.highlight.customSelections,(function(r){if(t.id===r.settings.id)return r.cellRange=e,n&&Object(j.objectEach)(r.instanceBorders,(function(e){e.changeBorderStyle(n,t)})),o=!0,!1})),o}},{key:"changeBorderSettings",value:function(){var t=this.hot.getSettings().customBorders;Array.isArray(t)?(t.length||(this.savedBorders=t),this.createCustomBorders(t)):void 0!==t&&this.createCustomBorders(this.savedBorders)}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;this.hot.getSettings().customBorders&&t.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[(e=this,{key:"borders:top",name:function(){var t=this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_BORDERS_TOP);return yr(this,"top")&&(t=mr(t)),t},callback:function(t,n){var r=yr(this,"top");e.prepareBorder(n,"top",r)}}),Cr(this),br(this),wr(this),Or(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Tr(Mr(e.prototype),"destroy",this).call(this)}}])&&Rr(n.prototype,r),o&&Rr(n,o),e}(W);Object(H.d)("customBorders",Nr);var jr=Nr;function xr(t){return(xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Dr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pr(t,e,n){return(Pr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Lr(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Lr(t){return(Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hr(t,e){return(Hr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==xr(e)&&"function"!=typeof e?Dr(t):e}(this,Lr(e).call(this,t))).eventManager=new m.a(Dr(n)),n.boundaries=null,n.callback=null,n.listening=!1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hr(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterOnCellMouseDown",(function(e){return t.setupListening(e)})),this.addHook("afterOnCellCornerMouseDown",(function(e){return t.setupListening(e)})),this.registerEvents(),Pr(Lr(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Pr(Lr(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),Pr(Lr(e.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(t){this.boundaries=t}},{key:"setCallback",value:function(t){this.callback=t}},{key:"check",value:function(t,e){var n=0,r=0;e<this.boundaries.top?r=e-this.boundaries.top:e>this.boundaries.bottom&&(r=e-this.boundaries.bottom),t<this.boundaries.left?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,r)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var t=this,e=this.hot.rootWindow;e;)this.eventManager.addEventListener(e.document,"contextmenu",(function(){return t.unlisten()})),this.eventManager.addEventListener(e.document,"mouseup",(function(){return t.unlisten()})),this.eventManager.addEventListener(e.document,"mousemove",(function(e){return t.onMouseMove(e)})),e=Object(w.getParentWindow)(e)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(t){if(!Object(P.isRightClick)(t)){var e=this.hot.view.wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((function(t,n){t<0?e.scrollLeft-=50:t>0&&(e.scrollLeft+=50),n<0?e.scrollTop-=20:n>0&&(e.scrollTop+=20)})),this.listen())}}},{key:"onMouseMove",value:function(t){this.isListening()&&this.check(t.clientX,t.clientY)}},{key:"destroy",value:function(){Pr(Lr(e.prototype),"destroy",this).call(this)}}])&&Ir(n.prototype,r),o&&Ir(n,o),e}(W);Object(H.d)("dragToScroll",Fr);var Br=Fr;function Ur(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Wr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Vr(t){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gr(t,e,n){return(Gr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xr(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Xr(t){return(Xr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qr(t,e){return(qr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kr=new WeakMap,$r=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e){return!e||"object"!==Vr(e)&&"function"!=typeof e?zr(t):e}(this,Xr(e).call(this,t)),Kr.set(zr(n),{moveByFreeze:!1,afterFirstUse:!1}),n.frozenColumnsBasePositions=[],n.manualColumnMovePlugin=void 0,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qr(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(e){return t.addContextMenuEntry(e)})),this.addHook("afterInit",(function(){return t.onAfterInit()})),this.addHook("beforeColumnMove",(function(e,n){return t.onBeforeColumnMove(e,n)})),Gr(Xr(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=Kr.get(this);t.afterFirstUse=!1,t.moveByFreeze=!1,Gr(Xr(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Gr(Xr(e.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(t){var e=Kr.get(this),n=this.hot.getSettings();e.afterFirstUse||(e.afterFirstUse=!0),n.fixedColumnsLeft===this.hot.countCols()||t<=n.fixedColumnsLeft-1||(e.moveByFreeze=!0,t!==this.getMovePlugin().columnsMapper.getValueByIndex(t)&&(this.frozenColumnsBasePositions[n.fixedColumnsLeft]=t),this.getMovePlugin().moveColumn(t,n.fixedColumnsLeft),n.fixedColumnsLeft+=1)}},{key:"unfreezeColumn",value:function(t){var e=Kr.get(this),n=this.hot.getSettings();if(e.afterFirstUse||(e.afterFirstUse=!0),!(n.fixedColumnsLeft<=0||t>n.fixedColumnsLeft-1)){var r=this.getBestColumnReturnPosition(t);e.moveByFreeze=!0,n.fixedColumnsLeft-=1,this.getMovePlugin().moveColumn(t,r+1)}}},{key:"getMovePlugin",value:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin}},{key:"getBestColumnReturnPosition",value:function(t){var e,n=this.getMovePlugin(),r=this.hot.getSettings().fixedColumnsLeft,o=n.columnsMapper.getValueByIndex(r);if(null===this.frozenColumnsBasePositions[t]||void 0===this.frozenColumnsBasePositions[t])for(e=n.columnsMapper.getValueByIndex(t);null!==o&&o<=e;)r+=1,o=n.columnsMapper.getValueByIndex(r);else{for(e=this.frozenColumnsBasePositions[t],this.frozenColumnsBasePositions[t]=void 0;null!==o&&o<=e;)r+=1,o=n.columnsMapper.getValueByIndex(r);r=o}return r-1}},{key:"addContextMenuEntry",value:function(t){var e;t.items.push({name:"---------"},(e=this,{key:"freeze_column",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function(t,n){var r=Ur(n,1)[0].start.col;e.freezeColumn(r),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(e=!0),e}}),function(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function(e,n){var r=Wr(n,1)[0].start.col;t.unfreezeColumn(r),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsLeft)&&(e=!0),e}}}(this))}},{key:"onAfterInit",value:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()}},{key:"onBeforeColumnMove",value:function(t,e){var n=Kr.get(this);if(n.afterFirstUse&&!n.moveByFreeze){var r=this.hot.getSettings().fixedColumnsLeft,o=e<r;if(o||Object(O.arrayEach)(t,(function(t){if(t<r)return o=!0,!1})),o)return!1}n.moveByFreeze&&(n.moveByFreeze=!1)}},{key:"destroy",value:function(){Gr(Xr(e.prototype),"destroy",this).call(this)}}])&&Yr(n.prototype,r),o&&Yr(n,o),e}(W);Object(H.d)("manualColumnFreeze",$r);var Qr=$r;function Zr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Jr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.manualColumnMove=e}var e,n,r;return e=t,(n=[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(N.rangeEach)(n-1,(function(t){e._arrayMap[t]=t}))}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveColumn",value:function(t,e){var n=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(e,0,n)}},{key:"clearNull",value:function(){this._arrayMap=Object(O.arrayFilter)(this._arrayMap,(function(t){return null!==t}))}}])&&Zr(e.prototype,n),r&&Zr(e,r),t}();Object(j.mixin)(Jr,Qt);var to=Jr;function eo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var no=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this._element=null,this.state=0}var e,n,r;return e=t,(n=[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=this.hot.rootDocument.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(t,e){Object(N.isNumeric)(t)&&(this._element.style.top=t+"px"),Object(N.isNumeric)(e)&&(this._element.style.left=e+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){Object(N.isNumeric)(t)&&(this._element.style.width=t+"px"),Object(N.isNumeric)(e)&&(this._element.style.height=e+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){Object(N.isNumeric)(t)&&(this._element.style.marginTop=t+"px"),Object(N.isNumeric)(e)&&(this._element.style.marginLeft=e+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}])&&eo(e.prototype,n),r&&eo(e,r),t}();function ro(t){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function io(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ao(t,e){return!e||"object"!==ro(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function so(t,e,n){return(so="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=lo(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function lo(t){return(lo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function uo(t,e){return(uo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var co=function(t){function e(){return oo(this,e),ao(this,lo(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uo(t,e)}(e,t),n=e,(r=[{key:"build",value:function(){so(lo(e.prototype),"build",this).call(this),Object(w.addClass)(this._element,"ht__manualColumnMove--backlight")}}])&&io(n.prototype,r),o&&io(n,o),e}(no);function fo(t){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ho(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function po(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function go(t,e){return!e||"object"!==fo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vo(t,e,n){return(vo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yo(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function yo(t){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mo(t,e){return(mo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bo=function(t){function e(){return ho(this,e),go(this,yo(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mo(t,e)}(e,t),n=e,(r=[{key:"build",value:function(){vo(yo(e.prototype),"build",this).call(this),Object(w.addClass)(this._element,"ht__manualColumnMove--guideline")}}])&&po(n.prototype,r),o&&po(n,o),e}(no);function wo(t){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oo(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Co(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Eo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function So(t,e,n){return(So="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ko(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ko(t){return(ko=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ro(t,e){return(Ro=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}b.a.getSingleton().register("beforeColumnMove"),b.a.getSingleton().register("afterColumnMove"),b.a.getSingleton().register("unmodifyCol");var _o=new WeakMap,To=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e){return!e||"object"!==wo(e)&&"function"!=typeof e?Eo(t):e}(this,ko(e).call(this,t)),_o.set(Eo(n),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}}),n.removedColumns=[],n.columnsMapper=new to(Eo(n)),n.eventManager=new m.a(Eo(n)),n.backlight=new co(t),n.guideline=new bo(t),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ro(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(e,n,r,o){return t.onBeforeOnCellMouseDown(e,n,r,o)})),this.addHook("beforeOnCellMouseOver",(function(e,n,r,o){return t.onBeforeOnCellMouseOver(e,n,r,o)})),this.addHook("afterScrollVertically",(function(){return t.onAfterScrollVertically()})),this.addHook("modifyCol",(function(e,n){return t.onModifyCol(e,n)})),this.addHook("beforeRemoveCol",(function(e,n){return t.onBeforeRemoveCol(e,n)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol()})),this.addHook("afterCreateCol",(function(e,n){return t.onAfterCreateCol(e,n)})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData()})),this.addHook("unmodifyCol",(function(e){return t.onUnmodifyCol(e)})),this.registerEvents(),Object(w.addClass)(this.hot.rootElement,"ht__manualColumnMove"),So(ko(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),So(ko(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this.hot.getSettings().manualColumnMove;Array.isArray(t)&&this.columnsMapper.clearMap(),Object(w.removeClass)(this.hot.rootElement,"ht__manualColumnMove"),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),So(ko(e.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(t,e){this.moveColumns([t],e)}},{key:"moveColumns",value:function(t,e){var n=this,r=Oo(t),o=_o.get(this),i=this.hot.runHooks("beforeColumnMove",r,e);o.disallowMoving=!i,!1!==i&&(Object(O.arrayEach)(t,(function(t,e,r){r[e]=n.columnsMapper.getValueByIndex(t)})),Object(O.arrayEach)(t,(function(t,r){var o=n.columnsMapper.getIndexByValue(t);o!==e&&n.columnsMapper.moveColumn(o,e+r)})),this.columnsMapper.clearNull(),this.hot.runHooks("afterColumnMove",r,e))}},{key:"changeSelection",value:function(t,e){this.hot.selectColumns(t,e)}},{key:"getColumnsWidth",value:function(t,e){for(var n=0,r=t;r<e;r++)n+=r<0?this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:this.hot.view.wt.wtTable.getStretchedColumnWidth(r)||0;return n}},{key:"initialSettings",value:function(){var t=this.hot.getSettings().manualColumnMove;Array.isArray(t)?this.moveColumns(t,0):void 0!==t&&this.persistentStateLoad()}},{key:"isFixedColumnsLeft",value:function(t){return t<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var t={};this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value&&(this.columnsMapper._arrayMap=t.value)}},{key:"prepareColumnsToMoving",value:function(t,e){var n=[];return Object(N.rangeEach)(t,e,(function(t){n.push(t)})),n}},{key:"refreshPositions",value:function(){var t=_o.get(this),e=this.hot.view.wt.wtTable.getFirstVisibleColumn(),n=this.hot.view.wt.wtTable.getLastVisibleColumn(),r=this.hot.view.wt.wtTable,o=this.hot.view.wt.wtOverlays.scrollableElement,i="number"==typeof o.scrollX?o.scrollX:o.scrollLeft,a=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,t.coordsColumn),s=t.target.eventPageX-(t.rootElementOffset-(void 0===o.scrollX?i:0)),l=r.hider.offsetWidth,u=r.TBODY.offsetLeft,c=this.backlight.getOffset().left,f=this.backlight.getSize().width,h=0;if(t.rootElementOffset+r.holder.offsetWidth+i<t.target.eventPageX&&t.coordsColumn<t.countCols&&(t.coordsColumn+=1),t.hasRowHeaders&&(h=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(t.coordsColumn)&&(a+=i),a+=h,t.coordsColumn<0)t.fixedColumns>0?t.target.col=0:t.target.col=e>0?e-1:e;else if(t.target.TD.offsetWidth/2+a<=s){var d=t.coordsColumn>=t.countCols?t.countCols-1:t.coordsColumn;t.target.col=d+1,a+=t.target.TD.offsetWidth,t.target.col>n&&n<t.countCols&&this.hot.scrollViewportTo(void 0,n+1,void 0,!0)}else t.target.col=t.coordsColumn,t.target.col<=e&&t.target.col>=t.fixedColumns&&e>0&&this.hot.scrollViewportTo(void 0,e-1);t.target.col<=e&&t.target.col>=t.fixedColumns&&e>0&&this.hot.scrollViewportTo(void 0,e-1);var p=s,g=a;s+f+c>=l?p=l-f-c:s+c<u+h&&(p=u+h+Math.abs(c)),a>=l-1?g=l-1:0===g?g=1:void 0!==o.scrollX&&t.coordsColumn<t.fixedColumns&&(g-=t.rootElementOffset<=o.scrollX?t.rootElementOffset:0),this.backlight.setPosition(null,p),this.guideline.setPosition(null,g)}},{key:"updateColumnsMapper",value:function(){var t=this.hot.countSourceCols(),e=this.columnsMapper._arrayMap.length;if(0===e)this.columnsMapper.createMap(t||this.hot.getSettings().startCols);else if(e<t){var n=t-e;this.columnsMapper.insertItems(e,n)}else if(e>t){var r=t-1,o=[];Object(O.arrayEach)(this.columnsMapper._arrayMap,(function(t,e){t>r&&o.push(e)})),this.columnsMapper.removeItems(o)}}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var o=this.hot.view.wt.wtTable,i=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),s=_o.get(this),l=Object(w.hasClass)(t.realTarget,"sortAction");if(!a||!i||s.pressed||0!==t.button||l)return s.pressed=!1,s.columnsToMove.length=0,void Object(w.removeClass)(this.hot.rootElement,["on-moving--columns","show-ui"]);var u=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&c&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var f=a.from,h=a.to,d=Math.min(f.col,h.col),p=Math.max(f.col,h.col);if(e.row<0&&e.col>=d&&e.col<=p){r.column=!0,s.pressed=!0,s.target.eventPageX=t.pageX,s.coordsColumn=e.col,s.target.TD=n,s.target.col=e.col,s.columnsToMove=this.prepareColumnsToMoving(d,p),s.hasRowHeaders=!!this.hot.getSettings().rowHeaders,s.countCols=this.hot.countCols(),s.fixedColumns=this.hot.getSettings().fixedColumnsLeft,s.rootElementOffset=Object(w.offset)(this.hot.rootElement).left;var g=s.hasRowHeaders?-1:0,v=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,y=e.col<s.fixedColumns,m=this.hot.view.wt.wtOverlays.scrollableElement,b=m.scrollX?m.scrollX-s.rootElementOffset:0,O=t.layerX-(y?b:0),C=Math.abs(this.getColumnsWidth(d,e.col)+O);this.backlight.setPosition(v,this.getColumnsWidth(g,d)+C),this.backlight.setSize(this.getColumnsWidth(d,p+1),o.hider.offsetHeight-v),this.backlight.setOffset(null,-1*C),Object(w.addClass)(this.hot.rootElement,"on-moving--columns")}else Object(w.removeClass)(this.hot.rootElement,"after-selection--columns"),s.pressed=!1,s.columnsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=_o.get(this);if(e.pressed){if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(n)}))}e.target.eventPageX=t.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var o=this.hot.getSelectedRangeLast(),i=_o.get(this);o&&i.pressed&&(i.columnsToMove.indexOf(e.col)>-1?Object(w.removeClass)(this.hot.rootElement,"show-ui"):Object(w.addClass)(this.hot.rootElement,"show-ui"),r.row=!0,r.column=!0,r.cell=!0,i.coordsColumn=e.col,i.target.TD=n)}},{key:"onMouseUp",value:function(){var t=_o.get(this);if(t.coordsColumn=void 0,t.pressed=!1,t.backlightWidth=0,Object(w.removeClass)(this.hot.rootElement,["on-moving--columns","show-ui","after-selection--columns"]),this.hot.selection.isSelectedByColumnHeader()&&Object(w.addClass)(this.hot.rootElement,"after-selection--columns"),!(t.columnsToMove.length<1||void 0===t.target.col||t.columnsToMove.indexOf(t.target.col)>-1)){if(this.moveColumns(t.columnsToMove,t.target.col),this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),!t.disallowMoving){var e=this.columnsMapper.getIndexByValue(t.columnsToMove[0]),n=this.columnsMapper.getIndexByValue(t.columnsToMove[t.columnsToMove.length-1]);this.changeSelection(e,n)}t.columnsToMove.length=0}}},{key:"onAfterScrollVertically",value:function(){var t=this.hot.view.wt.wtTable,e=t.getColumnHeaderHeight(0)+1+t.holder.scrollTop;this.backlight.setPosition(e),this.backlight.setSize(null,t.hider.offsetHeight-e)}},{key:"onAfterCreateCol",value:function(t,e){this.columnsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveCol",value:function(t,e){var n=this;this.removedColumns.length=0,!1!==t&&Object(N.rangeEach)(t,t+e-1,(function(t){n.removedColumns.push(n.hot.runHooks("modifyCol",t,n.pluginName))}))}},{key:"onAfterRemoveCol",value:function(){this.columnsMapper.unshiftItems(this.removedColumns)}},{key:"onAfterLoadData",value:function(){this.updateColumnsMapper()}},{key:"onModifyCol",value:function(t,e){var n=t;if(e!==this.pluginName){var r=this.columnsMapper.getValueByIndex(n);n=null===r?n:r}return n}},{key:"onUnmodifyCol",value:function(t){var e=this.columnsMapper.getIndexByValue(t);return null===e?t:e}},{key:"onAfterPluginsInitialized",value:function(){this.updateColumnsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),So(ko(e.prototype),"destroy",this).call(this)}}])&&Co(n.prototype,r),o&&Co(n,o),e}(W);Object(H.d)("ManualColumnMove",To);var Mo=To;function Ao(t){return(Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function No(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xo(t,e,n){return(xo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Io(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Io(t){return(Io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Do(t,e){return(Do=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Po=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=(n=function(t,e){return!e||"object"!==Ao(e)&&"function"!=typeof e?jo(t):e}(this,Io(e).call(this,t))).hot.rootDocument;return n.currentTH=null,n.currentCol=null,n.selectedCols=[],n.currentWidth=null,n.newSize=null,n.startY=null,n.startWidth=null,n.startOffset=null,n.handle=r.createElement("DIV"),n.guide=r.createElement("DIV"),n.eventManager=new m.a(jo(n)),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualColumnWidths=[],Object(w.addClass)(n.handle,"manualColumnResizer"),Object(w.addClass)(n.guide,"manualColumnResizerGuide"),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Do(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.manualColumnWidths=[];var n=this.hot.getSettings().manualColumnResize,r=this.loadManualColumnWidths();this.addHook("modifyColWidth",(function(e,n){return t.onModifyColWidth(e,n)})),this.addHook("beforeStretchingColumnWidth",(function(e,n){return t.onBeforeStretchingColumnWidth(e,n)})),this.addHook("beforeColumnResize",(function(e,n,r){return t.onBeforeColumnResize(e,n,r)})),void 0!==r?this.manualColumnWidths=r:Array.isArray(n)?this.manualColumnWidths=n:this.manualColumnWidths=[],this.bindEvents(),xo(Io(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().manualColumnResize;Array.isArray(t)?this.manualColumnWidths=t:t||(this.manualColumnWidths=[])}},{key:"disablePlugin",value:function(){xo(Io(e.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)}},{key:"loadManualColumnWidths",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",t),t.value}},{key:"setupHandlePosition",value:function(t){var e=this;if(!t.parentNode)return!1;this.currentTH=t;var n=this.hot.view.wt.wtTable.getCoords(this.currentTH),r=n.col,o=Object(w.outerHeight)(this.currentTH);if(r>=0){var i=this.currentTH.getBoundingClientRect(),a=r<this.hot.getSettings().fixedColumnsLeft?this.hot.view.wt.wtOverlays.topLeftCornerOverlay:this.hot.view.wt.wtOverlays.topOverlay,s=a.getRelativeCellPosition(this.currentTH,n.row,n.col);if(!s){var l=a.clone.wtTable.THEAD.lastChild.children[+!!this.hot.getSettings().rowHeaders+r];s=a.getRelativeCellPosition(l,n.row,n.col)}if(this.currentCol=r,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.isSelectedByColumnHeader()){var u=this.hot.getSelectedRangeLast(),c=u.from,f=u.to,h=c.col,d=f.col;h>=d&&(h=f.col,d=c.col),this.currentCol>=h&&this.currentCol<=d?Object(N.rangeEach)(h,d,(function(t){return e.selectedCols.push(t)})):this.selectedCols.push(this.currentCol)}else this.selectedCols.push(this.currentCol);this.startOffset=s.left-6,this.startWidth=parseInt(i.width,10),this.handle.style.top="".concat(s.top,"px"),this.handle.style.left="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(o,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var t=parseInt(Object(w.outerHeight)(this.handle),10),e=parseInt(this.handle.style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Object(w.addClass)(this.handle,"active"),Object(w.addClass)(this.guide,"active"),this.guide.style.top="".concat(e,"px"),this.guide.style.left=this.handle.style.left,this.guide.style.height="".concat(n-t,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){Object(w.removeClass)(this.handle,"active"),Object(w.removeClass)(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(t){if(t!==this.hot.rootElement){var e=t.parentNode;return"THEAD"===e.tagName||this.checkIfColumnHeader(e)}return!1}},{key:"getTHFromTargetElement",value:function(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getTHFromTargetElement(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(this.checkIfColumnHeader(t.target)){var e=this.getTHFromTargetElement(t.target);if(!e)return;var n=e.getAttribute("colspan");!e||null!==n&&1!==n||this.pressed||this.setupHandlePosition(e)}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){var o=t.hot.runHooks("beforeColumnResize",n,t.newSize,!0);void 0!==o&&(t.newSize=o),"all"===t.hot.getSettings().stretchH?t.clearManualSize(n):t.setManualSize(n,t.newSize),r&&e(),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",n,t.newSize,!0)};this.dblclick>=2&&(this.selectedCols.length>1?(Object(O.arrayEach)(this.selectedCols,(function(t){n(t)})),e()):Object(O.arrayEach)(this.selectedCols,(function(t){n(t,!0)}))),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;Object(w.hasClass)(t.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return e.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=Object(P.pageX)(t),this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentWidth=this.startWidth+(Object(P.pageX)(t)-this.startX),Object(O.arrayEach)(this.selectedCols,(function(t){e.newSize=e.setManualSize(t,e.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){t.hot.runHooks("beforeColumnResize",n,t.newSize,!1),r&&e(),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",n,t.newSize)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(Object(O.arrayEach)(this.selectedCols,(function(t){n(t)})),e()):Object(O.arrayEach)(this.selectedCols,(function(t){n(t,!0)}))),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var t=this,e=this.hot,n=e.rootWindow,r=e.rootElement;this.eventManager.addEventListener(r,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(r,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(n,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(n,"mouseup",(function(){return t.onMouseUp()}))}},{key:"setManualSize",value:function(t,e){var n=Math.max(e,20),r=this.hot.runHooks("modifyCol",t);return this.manualColumnWidths[r]=n,n}},{key:"clearManualSize",value:function(t){var e=this.hot.runHooks("modifyCol",t);this.manualColumnWidths[e]=void 0}},{key:"onModifyColWidth",value:function(t,e){var n=t;if(this.enabled){var r=this.hot.runHooks("modifyCol",e),o=this.manualColumnWidths[r];this.hot.getSettings().manualColumnResize&&o&&(n=o)}return n}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){var n=this.manualColumnWidths[e];return void 0===n&&(n=t),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}}])&&No(n.prototype,r),o&&No(n,o),e}(W);Object(H.d)("manualColumnResize",Po);var Lo=Po;function Ho(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Fo=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.manualRowMove=e}var e,n,r;return e=t,(n=[{key:"createMap",value:function(t){var e=this,n=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(N.rangeEach)(n-1,(function(t){e._arrayMap[t]=t}))}},{key:"destroy",value:function(){this._arrayMap=null}},{key:"moveRow",value:function(t,e){var n=this._arrayMap[t];this._arrayMap[t]=null,this._arrayMap.splice(e,0,n)}},{key:"clearNull",value:function(){this._arrayMap=Object(O.arrayFilter)(this._arrayMap,(function(t){return null!==t}))}}])&&Ho(e.prototype,n),r&&Ho(e,r),t}();Object(j.mixin)(Fo,Qt);var Bo=Fo;function Uo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wo=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this._element=null,this.state=0}var e,n,r;return e=t,(n=[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=2}},{key:"build",value:function(){this._element=this.hot.rootDocument.createElement("div"),this.state=1}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}},{key:"isAppended",value:function(){return 2===this.state}},{key:"isBuilt",value:function(){return this.state>=1}},{key:"setPosition",value:function(t,e){void 0!==t&&(this._element.style.top=t+"px"),void 0!==e&&(this._element.style.left=e+"px")}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){t&&(this._element.style.width=t+"px"),e&&(this._element.style.height=e+"px")}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){t&&(this._element.style.marginTop=t+"px"),e&&(this._element.style.marginLeft=e+"px")}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}])&&Uo(e.prototype,n),r&&Uo(e,r),t}();function Vo(t){return(Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Go(t,e){return!e||"object"!==Vo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xo(t,e,n){return(Xo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qo(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function qo(t){return(qo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ko(t,e){return(Ko=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $o=function(t){function e(){return Yo(this,e),Go(this,qo(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ko(t,e)}(e,t),n=e,(r=[{key:"build",value:function(){Xo(qo(e.prototype),"build",this).call(this),Object(w.addClass)(this._element,"ht__manualRowMove--backlight")}}])&&zo(n.prototype,r),o&&zo(n,o),e}(Wo);function Qo(t){return(Qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ti(t,e){return!e||"object"!==Qo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ei(t,e,n){return(ei="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ni(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ni(t){return(ni=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ri(t,e){return(ri=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oi=function(t){function e(){return Zo(this,e),ti(this,ni(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ri(t,e)}(e,t),n=e,(r=[{key:"build",value:function(){ei(ni(e.prototype),"build",this).call(this),Object(w.addClass)(this._element,"ht__manualRowMove--guideline")}}])&&Jo(n.prototype,r),o&&Jo(n,o),e}(Wo);function ii(t){return(ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ai(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function si(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function li(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ui(t,e,n){return(ui="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ci(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ci(t){return(ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fi(t,e){return(fi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}b.a.getSingleton().register("beforeRowMove"),b.a.getSingleton().register("afterRowMove"),b.a.getSingleton().register("unmodifyRow");var hi=new WeakMap,di=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e){return!e||"object"!==ii(e)&&"function"!=typeof e?li(t):e}(this,ci(e).call(this,t)),hi.set(li(n),{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}}),n.removedRows=[],n.rowsMapper=new Bo(li(n)),n.eventManager=new m.a(li(n)),n.backlight=new $o(t),n.guideline=new oi(t),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fi(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(e,n,r,o){return t.onBeforeOnCellMouseDown(e,n,r,o)})),this.addHook("beforeOnCellMouseOver",(function(e,n,r,o){return t.onBeforeOnCellMouseOver(e,n,r,o)})),this.addHook("afterScrollHorizontally",(function(){return t.onAfterScrollHorizontally()})),this.addHook("modifyRow",(function(e,n){return t.onModifyRow(e,n)})),this.addHook("beforeRemoveRow",(function(e,n){return t.onBeforeRemoveRow(e,n)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow()})),this.addHook("afterCreateRow",(function(e,n){return t.onAfterCreateRow(e,n)})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData()})),this.addHook("beforeColumnSort",(function(e,n){return t.onBeforeColumnSort(e,n)})),this.addHook("unmodifyRow",(function(e){return t.onUnmodifyRow(e)})),this.registerEvents(),Object(w.addClass)(this.hot.rootElement,"ht__manualRowMove"),ui(ci(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),ui(ci(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this.hot.getSettings().manualRowMove;Array.isArray(t)&&this.rowsMapper.clearMap(),Object(w.removeClass)(this.hot.rootElement,"ht__manualRowMove"),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ui(ci(e.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(t,e){this.moveRows([t],e)}},{key:"moveRows",value:function(t,e){var n=this,r=ai(t),o=hi.get(this),i=this.hot.runHooks("beforeRowMove",r,e);o.disallowMoving=!1===i,o.disallowMoving||(Object(O.arrayEach)(t,(function(t,e,r){r[e]=n.rowsMapper.getValueByIndex(t)})),Object(O.arrayEach)(t,(function(t,r){var o=n.rowsMapper.getIndexByValue(t);o!==e&&n.rowsMapper.moveRow(o,e+r)})),this.rowsMapper.clearNull()),this.hot.runHooks("afterRowMove",r,e)}},{key:"changeSelection",value:function(t,e){this.hot.selectRows(t,e)}},{key:"getRowsHeight",value:function(t,e){for(var n=0,r=t;r<e;r++)n+=this.hot.view.wt.wtTable.getRowHeight(r)||23;return n}},{key:"initialSettings",value:function(){var t=this.hot.getSettings().manualRowMove;if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){var e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}},{key:"isFixedRowTop",value:function(t){return t<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(t){return t>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)}},{key:"persistentStateLoad",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}},{key:"prepareRowsToMoving",value:function(){var t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;var n=t.from,r=t.to,o=Math.min(n.row,r.row),i=Math.max(n.row,r.row);return Object(N.rangeEach)(o,i,(function(t){e.push(t)})),e}},{key:"refreshPositions",value:function(){var t=hi.get(this),e=t.target.coords,n=this.hot.view.wt.wtTable.getFirstVisibleRow(),r=this.hot.view.wt.wtTable.getLastVisibleRow(),o=this.hot.getSettings().fixedRowsTop,i=this.hot.countRows();e.row<o&&n>0&&this.hot.scrollViewportTo(n-1),e.row>=r&&r<i&&this.hot.scrollViewportTo(r+1,void 0,!0);var a=this.hot.view.wt.wtTable,s=t.target.TD,l=Object(w.offset)(this.hot.rootElement),u=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row),c=t.target.eventPageY-l.top+a.holder.scrollTop,f=a.hider.offsetHeight,h=a.TBODY.offsetTop,d=this.backlight.getOffset().top,p=this.backlight.getSize().height;this.isFixedRowTop(e.row)&&(u+=a.holder.scrollTop),e.row<0?t.target.row=n>0?n-1:n:s.offsetHeight/2+u<=c?(t.target.row=e.row+1,u+=0===e.row?s.offsetHeight-1:s.offsetHeight):t.target.row=e.row;var g=c,v=u;c+p+d>=f?g=f-p-d:c+d<h&&(g=h+Math.abs(d)),u>=f-1&&(v=f-1);var y=0;this.hot.view.wt.wtOverlays.topOverlay&&(y=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),e.row>=o&&v-a.holder.scrollTop<y&&this.hot.scrollViewportTo(e.row),this.backlight.setPosition(g),this.guideline.setPosition(v)}},{key:"updateRowsMapper",value:function(){var t=this.hot.countSourceRows(),e=this.rowsMapper._arrayMap.length;if(0===e)this.rowsMapper.createMap(t||this.hot.getSettings().startRows);else if(e<t){var n=t-e;this.rowsMapper.insertItems(e,n)}else if(e>t){var r=t-1,o=[];Object(O.arrayEach)(this.rowsMapper._arrayMap,(function(t,e){t>r&&o.push(e)})),this.rowsMapper.removeItems(o)}}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeColumnSort",value:function(t,e){hi.get(this).disallowMoving=void 0!==e}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var o=this.hot.view.wt,i=o.wtTable,a=o.wtViewport,s=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),u=hi.get(this);if(!l||!s||u.pressed||0!==t.button)return u.pressed=!1,u.rowsToMove.length=0,void Object(w.removeClass)(this.hot.rootElement,["on-moving--rows","show-ui"]);var c=this.guideline.isBuilt()&&!this.guideline.isAppended(),f=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&f&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));var h=l.from,d=l.to,p=Math.min(h.row,d.row),g=Math.max(h.row,d.row);if(e.col<0&&e.row>=p&&e.row<=g){r.row=!0,u.pressed=!0,u.target.eventPageY=t.pageY,u.target.coords=e,u.target.TD=n,u.rowsToMove=this.prepareRowsToMoving();var v=i.holder.scrollLeft+a.getRowHeaderWidth();this.backlight.setPosition(null,v),this.backlight.setSize(i.hider.offsetWidth-v,this.getRowsHeight(p,g+1)),this.backlight.setOffset(-1*(this.getRowsHeight(p,e.row)+t.layerY),null),Object(w.addClass)(this.hot.rootElement,"on-moving--rows"),this.refreshPositions()}else Object(w.removeClass)(this.hot.rootElement,"after-selection--rows"),u.pressed=!1,u.rowsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=hi.get(this);if(e.pressed){if(t.realTarget===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,n)}))}e.target.eventPageY=t.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var o=this.hot.getSelectedRangeLast(),i=hi.get(this);o&&i.pressed&&(i.rowsToMove.indexOf(e.row)>-1?Object(w.removeClass)(this.hot.rootElement,"show-ui"):Object(w.addClass)(this.hot.rootElement,"show-ui"),r.row=!0,r.column=!0,r.cell=!0,i.target.coords=e,i.target.TD=n)}},{key:"onMouseUp",value:function(){var t=hi.get(this),e=t.target.row,n=t.rowsToMove.length;if(t.pressed=!1,t.backlightHeight=0,Object(w.removeClass)(this.hot.rootElement,["on-moving--rows","show-ui","after-selection--rows"]),this.hot.selection.isSelectedByRowHeader()&&Object(w.addClass)(this.hot.rootElement,"after-selection--rows"),!(n<1||void 0===e||t.rowsToMove.indexOf(e)>-1||t.rowsToMove[n-1]===e-1)){if(this.moveRows(t.rowsToMove,e),this.persistentStateSave(),this.hot.render(),!t.disallowMoving){var r=this.rowsMapper.getIndexByValue(t.rowsToMove[0]),o=this.rowsMapper.getIndexByValue(t.rowsToMove[n-1]);this.changeSelection(r,o)}t.rowsToMove.length=0}}},{key:"onAfterScrollHorizontally",value:function(){var t=this.hot.view.wt.wtTable,e=this.hot.view.wt.wtViewport.getRowHeaderWidth()+t.holder.scrollLeft;this.backlight.setPosition(null,e),this.backlight.setSize(t.hider.offsetWidth-e)}},{key:"onAfterCreateRow",value:function(t,e){this.rowsMapper.shiftItems(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&Object(N.rangeEach)(t,t+e-1,(function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t,n.pluginName))}))}},{key:"onAfterRemoveRow",value:function(){this.rowsMapper.unshiftItems(this.removedRows)}},{key:"onAfterLoadData",value:function(){this.updateRowsMapper()}},{key:"onModifyRow",value:function(t,e){var n=t;if(e!==this.pluginName){var r=this.rowsMapper.getValueByIndex(n);n=null===r?n:r}return n}},{key:"onUnmodifyRow",value:function(t){var e=this.rowsMapper.getIndexByValue(t);return null===e?t:e}},{key:"onAfterPluginsInitialized",value:function(){this.updateRowsMapper(),this.initialSettings(),this.backlight.build(),this.guideline.build()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),this.rowsMapper.destroy(),ui(ci(e.prototype),"destroy",this).call(this)}}])&&si(n.prototype,r),o&&si(n,o),e}(W);Object(H.d)("ManualRowMove",di);var pi=di;function gi(t){return(gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mi(t,e,n){return(mi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=bi(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function bi(t){return(bi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wi(t,e){return(wi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Oi=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=(n=function(t,e){return!e||"object"!==gi(e)&&"function"!=typeof e?yi(t):e}(this,bi(e).call(this,t))).hot.rootDocument;return n.currentTH=null,n.currentRow=null,n.selectedRows=[],n.currentHeight=null,n.newSize=null,n.startY=null,n.startHeight=null,n.startOffset=null,n.handle=r.createElement("DIV"),n.guide=r.createElement("DIV"),n.eventManager=new m.a(yi(n)),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.manualRowHeights=[],Object(w.addClass)(n.handle,"manualRowResizer"),Object(w.addClass)(n.guide,"manualRowResizerGuide"),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wi(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.manualRowHeights=[];var n=this.hot.getSettings().manualRowResize,r=this.loadManualRowHeights();void 0!==r?this.manualRowHeights=r:Array.isArray(n)?this.manualRowHeights=n:this.manualRowHeights=[],this.addHook("modifyRowHeight",(function(e,n){return t.onModifyRowHeight(e,n)})),this.bindEvents(),mi(bi(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().manualRowResize;Array.isArray(t)?this.manualRowHeights=t:t||(this.manualRowHeights=[])}},{key:"disablePlugin",value:function(){mi(bi(e.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)}},{key:"loadManualRowHeights",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",t),t.value}},{key:"setupHandlePosition",value:function(t){var e=this;this.currentTH=t;var n=this.hot.getCoords(this.currentTH),r=n.row,o=Object(w.outerWidth)(this.currentTH);if(r>=0){var i=this.currentTH.getBoundingClientRect(),a=r<this.hot.getSettings().fixedRowsTop,s=r>=this.hot.countRows()-this.hot.getSettings().fixedRowsBottom,l=this.hot.view.wt.wtOverlays.leftOverlay;a?l=this.hot.view.wt.wtOverlays.topLeftCornerOverlay:s&&(l=this.hot.view.wt.wtOverlays.bottomLeftCornerOverlay);var u=l.getRelativeCellPosition(this.currentTH,n.row,n.col);if(!u){var c=l.clone.wtTable.TBODY.children[+!!this.hot.getSettings().colHeaders+r].firstChild;u=l.getRelativeCellPosition(c,n.row,n.col)}if(this.currentRow=r,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.isSelectedByRowHeader()){var f=this.hot.getSelectedRangeLast(),h=f.from,d=f.to,p=h.row,g=d.row;p>=g&&(p=d.row,g=h.row),this.currentRow>=p&&this.currentRow<=g?Object(N.rangeEach)(p,g,(function(t){return e.selectedRows.push(t)})):this.selectedRows.push(this.currentRow)}else this.selectedRows.push(this.currentRow);this.startOffset=u.top-6,this.startHeight=parseInt(i.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style.left="".concat(u.left,"px"),this.handle.style.width="".concat(o,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var t=parseInt(Object(w.outerWidth)(this.handle),10),e=parseInt(this.handle.style.left,10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Object(w.addClass)(this.handle,"active"),Object(w.addClass)(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left="".concat(e,"px"),this.guide.style.width="".concat(n-t,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Object(w.removeClass)(this.handle,"active"),Object(w.removeClass)(this.guide,"active")}},{key:"checkIfRowHeader",value:function(t){if(t!==this.hot.rootElement){var e=t.parentNode;return"TBODY"===e.tagName||this.checkIfRowHeader(e)}return!1}},{key:"getTHFromTargetElement",value:function(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getTHFromTargetElement(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(this.checkIfRowHeader(t.target)){var e=this.getTHFromTargetElement(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){var o=t.hot.runHooks("beforeRowResize",n,t.newSize,!0);void 0!==o&&(t.newSize=o),t.setManualSize(n,t.newSize),r&&e(),t.hot.runHooks("afterRowResize",n,t.newSize,!0)};this.dblclick>=2&&(this.selectedRows.length>1?(Object(O.arrayEach)(this.selectedRows,(function(t){n(t)})),e()):Object(O.arrayEach)(this.selectedRows,(function(t){n(t,!0)}))),this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;Object(w.hasClass)(t.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return e.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=Object(P.pageY)(t),this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentHeight=this.startHeight+(Object(P.pageY)(t)-this.startY),Object(O.arrayEach)(this.selectedRows,(function(t){e.newSize=e.setManualSize(t,e.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){t.hot.runHooks("beforeRowResize",n,t.newSize),r&&e(),t.saveManualRowHeights(),t.hot.runHooks("afterRowResize",n,t.newSize,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(Object(O.arrayEach)(this.selectedRows,(function(t){n(t)})),e()):Object(O.arrayEach)(this.selectedRows,(function(t){n(t,!0)}))),this.setupHandlePosition(this.currentTH))}},{key:"bindEvents",value:function(){var t=this,e=this.hot,n=e.rootElement,r=e.rootWindow;this.eventManager.addEventListener(n,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(n,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(r,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(r,"mouseup",(function(){return t.onMouseUp()}))}},{key:"setManualSize",value:function(t,e){var n=this.hot.runHooks("modifyRow",t);return this.manualRowHeights[n]=e,e}},{key:"onModifyRowHeight",value:function(t,e){if(this.enabled){var n=this.hot.getPlugin("autoRowSize"),r=n?n.heights[e]:null,o=this.hot.runHooks("modifyRow",e),i=this.manualRowHeights[o];if(void 0!==i&&(i===r||i>(t||0)))return i}return t}}])&&vi(n.prototype,r),o&&vi(n,o),e}(W);Object(H.d)("manualRowResize",Oi);var Ci=Oi,Ei=(n(81),n(36));function Si(){var t=Ti(["The merged cell declared at [",", ",'] has "rowspan" or "colspan" declared as \n      "0", which is not supported. It cannot be added to the collection.']);return Si=function(){return t},t}function ki(){var t=Ti(["The merged cell declared at [",", ",'] has both "rowspan" \n     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.']);return ki=function(){return t},t}function Ri(){var t=Ti(["The merged cell declared at [",", ","] is positioned (or positioned partially) \n       outside of the table range. It was not added to the table, please fix your setup."]);return Ri=function(){return t},t}function _i(){var t=Ti(["The merged cell declared with {row: ",", col: ",", rowspan: \n    ",", colspan: ","} contains negative values, which is not supported. It \n    will not be added to the collection."]);return _i=function(){return t},t}function Ti(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Mi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ai=function(){function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.row=e,this.col=n,this.rowspan=r,this.colspan=o,this.removed=!1}var e,n,r;return e=t,r=[{key:"NEGATIVE_VALUES_WARNING",value:function(t){return Object(Ei.a)(_i(),t.row,t.col,t.rowspan,t.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(t){return Object(Ei.a)(Ri(),t.row,t.col)}},{key:"IS_SINGLE_CELL",value:function(t){return Object(Ei.a)(ki(),t.row,t.col)}},{key:"ZERO_SPAN_WARNING",value:function(t){return Object(Ei.a)(Si(),t.row,t.col)}},{key:"containsNegativeValues",value:function(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}},{key:"isSingleCell",value:function(t){return 1===t.colspan&&1===t.rowspan}},{key:"containsZeroSpan",value:function(t){return 0===t.colspan||0===t.rowspan}},{key:"isOutOfBounds",value:function(t,e,n){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=n||t.col+t.colspan-1>=n}}],(n=[{key:"normalize",value:function(t){var e=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}},{key:"includesHorizontally",value:function(t){return this.col<=t&&this.col+this.colspan-1>=t}},{key:"includesVertically",value:function(t){return this.row<=t&&this.row+this.rowspan-1>=t}},{key:"shift",value:function(t,e){var n=t[0]||t[1],r=e+Math.abs(t[0]||t[1])-1,o=t[0]?"colspan":"rowspan",i=t[0]?"col":"row",a=Math.min(e,r),s=Math.max(e,r),l=this[i],u=this[i]+this[o]-1;if(l>=e&&(this[i]+=n),n>0)e<=u&&e>l&&(this[o]+=n);else if(n<0){if(a<=l&&s>=u)return this.removed=!0,!1;if(l>=a&&l<=s){var c=s-l+1,f=Math.abs(n)-c;this[i]-=f+n,this[o]-=c}else if(l<=a&&u>=s)this[o]+=n;else if(l<=a&&u>=a&&u<s){var h=u-a+1;this[o]-=h}}return!0}},{key:"isFarther",value:function(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new rt.b(new rt.a(this.row,this.col),new rt.a(this.row,this.col),new rt.a(this.getLastRow(),this.getLastColumn()))}}])&&Mi(e.prototype,n),r&&Mi(e,r),t}(),Ni=n(34);function ji(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function xi(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["The merged cell declared at [",", ","], overlaps with the other declared merged \n    cell. The overlapping merged cell was not added to the table, please fix your setup."]);return xi=function(){return t},t}function Ii(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Di(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.mergedCells=[],this.hot=e.hot}var e,n,r;return e=t,r=[{key:"IS_OVERLAPPING_WARNING",value:function(t){return Object(Ei.a)(xi(),t.row,t.col)}}],(n=[{key:"get",value:function(t,e){var n=this.mergedCells,r=!1;return Object(O.arrayEach)(n,(function(n){return!(n.row<=t&&n.row+n.rowspan-1>=t&&n.col<=e&&n.col+n.colspan-1>=e&&(r=n,1))})),r}},{key:"getByRange",value:function(t){var e=this.mergedCells,n=!1;return Object(O.arrayEach)(e,(function(e){return!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(n=e)})),n}},{key:"getWithinRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.mergedCells,r=[],o=t;if(!o.includesRange){var i=new rt.a(o.from.row,o.from.col),a=new rt.a(o.to.row,o.to.col);o=new rt.b(i,i,a)}return Object(O.arrayEach)(n,(function(t){var n=new rt.a(t.row,t.col),i=new rt.a(t.row+t.rowspan-1,t.col+t.colspan-1),a=new rt.b(n,n,i);e?o.overlaps(a)&&r.push(t):o.includesRange(a)&&r.push(t)})),!!r.length&&r}},{key:"add",value:function(e){var n=this.mergedCells,r=e.row,o=e.col,i=e.rowspan,a=e.colspan,s=new Ai(r,o,i,a),l=this.get(r,o),u=this.isOverlapping(s);return l||u?(Object(Ni.b)(t.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),n.push(s),s)}},{key:"remove",value:function(t,e){var n=this.mergedCells,r=this.get(t,e),o=r?this.mergedCells.indexOf(r):null;return!(!r||!1===o)&&(n.splice(o,1),r)}},{key:"clear",value:function(){var t=this,e=this.mergedCells,n=[],r=[];Object(O.arrayEach)(e,(function(e){var r=t.hot.getCell(e.row,e.col);r&&n.push([r,t.get(e.row,e.col),e.row,e.col])})),this.mergedCells.length=0,Object(O.arrayEach)(n,(function(e,o){Object(N.rangeEach)(0,e.rowspan-1,(function(n){Object(N.rangeEach)(0,e.colspan-1,(function(o){if(0!==o||0!==n){var i=t.hot.getCell(e.row+n,e.col+o);i&&r.push([i,null,null,null])}}))})),n[o][1]=null})),Object(O.arrayEach)(n,(function(t){ji.apply(void 0,Ii(t))})),Object(O.arrayEach)(r,(function(t){ji.apply(void 0,Ii(t))}))}},{key:"isOverlapping",value:function(t){var e=new rt.b(null,new rt.a(t.row,t.col),new rt.a(t.row+t.rowspan-1,t.col+t.colspan-1)),n=!1;return Object(O.arrayEach)(this.mergedCells,(function(t){return!new rt.b(null,new rt.a(t.row,t.col),new rt.a(t.row+t.rowspan-1,t.col+t.colspan-1)).overlaps(e)||(n=!0,!1)})),n}},{key:"isMergedParent",value:function(t,e){var n=this.mergedCells,r=!1;return Object(O.arrayEach)(n,(function(n){return n.row!==t||n.col!==e||(r=!0,!1)})),r}},{key:"shiftCollections",value:function(t,e,n){var r=this,o=[0,0];switch(t){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n}Object(O.arrayEach)(this.mergedCells,(function(t){t.shift(o,e)})),Object(N.rangeEachReverse)(this.mergedCells.length-1,0,(function(t){var e=r.mergedCells[t];e&&e.removed&&r.mergedCells.splice(r.mergedCells.indexOf(e),1)}))}}])&&Di(e.prototype,n),r&&Di(e,r),t}();function Li(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Hi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Fi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}var e,n,r;return e=t,(n=[{key:"correctSelectionAreaSize",value:function(t){if(t[0]===t[2]&&t[1]===t[3]){var e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}},{key:"getDirection",value:function(t,e){return e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left"}},{key:"snapDragArea",value:function(t,e,n,r){var o=e.slice(0),i=this.getAutofillSize(t,e,n),a=Li(t,4),s=a[0],l=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(n)>-1?u-s+1:c-l+1,h=i-Math.floor(i/f)*f,d=this.getFarthestCollection(t,e,n,r);if(d)if("down"===n){var p=d.row+d.rowspan-s-h;o[2]+p>=this.plugin.hot.countRows()?o[2]-=h:o[2]+=h?p:0}else if("right"===n){var g=d.col+d.colspan-l-h;o[3]+g>=this.plugin.hot.countCols()?o[3]-=h:o[3]+=h?g:0}else if("up"===n){var v=u-h-d.row+1;o[0]+v<0?o[0]+=h:o[0]-=h?v:0}else if("left"===n){var y=c-h-d.col+1;o[1]+y<0?o[1]+=h:o[1]-=h?y:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:r,fillSize:i,dragArea:o,cycleLength:f}),o}},{key:"updateCurrentFillCache",value:function(t){this.currentFillData||(this.currentFillData={}),Object(j.extend)(this.currentFillData,t)}},{key:"getAutofillSize",value:function(t,e,n){var r=Li(t,4),o=r[0],i=r[1],a=r[2],s=r[3],l=Li(e,4),u=l[0],c=l[1],f=l[2],h=l[3];switch(n){case"up":return o-u;case"down":return f-a;case"left":return i-c;case"right":return h-s;default:return null}}},{key:"getDragArea",value:function(t,e,n){var r=Li(t,4),o=r[0],i=r[1],a=r[2],s=r[3],l=Li(e,4),u=l[0],c=l[1],f=l[2],h=l[3];switch(n){case"up":return[u,c,o-1,s];case"down":return[a+1,i,f,s];case"left":return[u,c,a,i-1];case"right":return[o,s+1,f,h];default:return null}}},{key:"getFarthestCollection",value:function(t,e,n,r){var o=Li(t,4),i=o[0],a=o[1],s=o[2],l=o[3],u=["up","down"].indexOf(n)>-1,c=u?s:l,f=u?i:a,h=this.getAutofillSize(t,e,n),d=u?s-i+1:l-a+1,p=h-Math.floor(h/d)*d,g=null,v=null,y=null;switch(n){case"up":g="includesVertically",y=c-p+1;break;case"left":g="includesHorizontally",y=c-p+1;break;case"down":g="includesVertically",y=f+p-1;break;case"right":g="includesHorizontally",y=f+p-1}return Object(O.arrayEach)(r,(function(t){t[g](y)&&t.isFarther(v,n)&&(v=t)})),v}},{key:"recreateAfterDataPopulation",value:function(t){if(this.currentFillData){var e=this.getRangeFromChanges(t),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=function(t,n){switch(r){case"up":return t.row-n>=e.from.row;case"down":return t.row+t.rowspan-1+n<=e.to.row;case"left":return t.col-n>=e.from.column;case"right":return t.col+t.colspan-1+n<=e.to.column;default:return null}},i=0,a=null,s=1;do{for(var l=0;l<n.length;l+=1){if(o(a=n[l],i=s*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-i,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+i,colspan:a.colspan})}l===n.length-1&&(s+=1)}}while(o(a,i));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(t){var e=this,n={min:null,max:null},r={min:null,max:null};return Object(O.arrayEach)(t,(function(t){var o=t[0],i=e.plugin.hot.propToCol(t[1]);(null===n.min||o<n.min)&&(n.min=o),(null===n.max||o>n.max)&&(n.max=o),(null===r.min||i<r.min)&&(r.min=i),(null===r.max||i>r.max)&&(r.max=i)})),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}},{key:"dragAreaOverlapsCollections",value:function(t,e,n){var r=Li(this.getDragArea(t,e,n),4),o=r[0],i=r[1],a=r[2],s=r[3],l=new rt.a(o,i),u=new rt.a(a,s),c=new rt.b(l,l,u);return!!this.mergedCellsCollection.getWithinRange(c,!0)}}])&&Hi(e.prototype,n),r&&Hi(e,r),t}();function Bi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ui(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}var e,n,r;return e=t,(n=[{key:"snapDelta",value:function(t,e,n){var r=e.to,o=r.row+t.row,i=r.col+t.col;t.row?this.jumpOverMergedCell(t,n,o):t.col&&this.jumpOverMergedCell(t,n,i)}},{key:"jumpOverMergedCell",value:function(t,e,n){var r=t.row||t.col,o=null,i=null,a=null;t.row?(o=e.includesVertically(n),i=e.row,a=e.getLastRow()):t.col&&(o=e.includesHorizontally(n),i=e.col,a=e.getLastColumn()),0!==r&&(r>0?o&&n!==i&&(r+=a-n+1):o&&n!==a&&(r-=n-i+1),t.row?t.row=r:t.col&&(t.col=r))}},{key:"getUpdatedSelectionRange",value:function(t,e){return new rt.b(t.highlight,t.from,new rt.a(t.to.row+e.row,t.to.col+e.col))}},{key:"getSelectedMergedCellClassName",value:function(t,e,n,r){var o=Bi(n,4),i=o[0],a=o[1],s=o[2],l=o[3];if(void 0!==r&&t>=i&&t<=s&&e>=a&&e<=l){if(!this.plugin.mergedCellsCollection.isMergedParent(t,e))return;var u=this.plugin.mergedCellsCollection.get(t,e);if(!u)return;if(u.row+u.rowspan-1<=s&&u.col+u.colspan-1<=l)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(r);if(this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}},{key:"isMergeCellFullySelected",value:function(t,e){var n=[];if(!e||!t)return!1;for(var r=0;r<t.rowspan;r+=1)for(var o=0;o<t.colspan;o+=1)n.push(new rt.a(t.row+r,t.col+o));for(var i=0;i<n.length;i+=1){for(var a=[],s=0;s<e.length;s+=1)a[s]=e[s].includes(n[i]);if(!a.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var t=[],e=0;e<=7;e+=1)t.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(e));return t.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),t}}])&&Ui(e.prototype,n),r&&Ui(e,r),t}();function Vi(t){return(Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function zi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Gi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qi(t,e,n){return(qi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ki(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ki(t){return(Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $i(t,e){return($i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}b.a.getSingleton().register("beforeMergeCells"),b.a.getSingleton().register("afterMergeCells"),b.a.getSingleton().register("beforeUnmergeCells"),b.a.getSingleton().register("afterUnmergeCells");var Qi=new WeakMap,Zi=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e){return!e||"object"!==Vi(e)&&"function"!=typeof e?Xi(t):e}(this,Ki(e).call(this,t)),Qi.set(Xi(n),{lastDesiredCoords:null}),n.mergedCellsCollection=null,n.autofillCalculations=null,n.selectionCalculations=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$i(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mergedCellsCollection=new Pi(this),this.autofillCalculations=new Fi(this),this.selectionCalculations=new Wi(this),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("beforeKeyDown",(function(){return t.onBeforeKeyDown.apply(t,arguments)})),this.addHook("modifyTransformStart",(function(){return t.onModifyTransformStart.apply(t,arguments)})),this.addHook("afterModifyTransformStart",(function(){return t.onAfterModifyTransformStart.apply(t,arguments)})),this.addHook("modifyTransformEnd",(function(){return t.onModifyTransformEnd.apply(t,arguments)})),this.addHook("modifyGetCellCoords",(function(){return t.onModifyGetCellCoords.apply(t,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return t.onBeforeSetRangeEnd.apply(t,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return t.onAfterIsMultipleSelection.apply(t,arguments)})),this.addHook("afterRenderer",(function(){return t.onAfterRenderer.apply(t,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.addMergeActionsToContextMenu.apply(t,arguments)})),this.addHook("afterGetCellMeta",(function(){return t.onAfterGetCellMeta.apply(t,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return t.onAfterViewportRowCalculatorOverride.apply(t,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return t.onAfterViewportColumnCalculatorOverride.apply(t,arguments)})),this.addHook("modifyAutofillRange",(function(){return t.onModifyAutofillRange.apply(t,arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol.apply(t,arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange.apply(t,arguments)})),this.addHook("beforeDrawBorders",(function(){return t.onBeforeDrawAreaBorders.apply(t,arguments)})),this.addHook("afterDrawSelection",(function(){return t.onAfterDrawSelection.apply(t,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return t.onBeforeRemoveCellClassNames.apply(t,arguments)})),qi(Ki(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),qi(Ki(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),qi(Ki(e.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(t){var e=!0;return!!t&&(Ai.containsNegativeValues(t)?(Object(Ni.b)(Ai.NEGATIVE_VALUES_WARNING(t)),e=!1):Ai.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(Object(Ni.b)(Ai.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):Ai.isSingleCell(t)?(Object(Ni.b)(Ai.IS_SINGLE_CELL(t)),e=!1):Ai.containsZeroSpan(t)&&(Object(Ni.b)(Ai.ZERO_SPAN_WARNING(t)),e=!1),e)}},{key:"generateFromSettings",value:function(t){var e=this;if(Array.isArray(t)){var n,r=[];Object(O.arrayEach)(t,(function(t){if(e.validateSetting(t)){var n=new rt.a(t.row,t.col),o=new rt.a(t.row+t.rowspan-1,t.col+t.colspan-1),i=new rt.b(n,n,o);r.push(e.mergeRange(i,!0,!0))}})),r=r.filter((function(t){return!0!==t}));var o=this.getBulkCollectionData(r);(n=this.hot).populateFromArray.apply(n,zi(o))}}},{key:"getBulkCollectionData",value:function(t){var e,n=this.getBulkCollectionDataRange(t),r=(e=this.hot).getData.apply(e,zi(n)).splice(0);return Object(O.arrayEach)(t,(function(t){var e=Yi(t,3),o=e[0],i=e[1],a=e[2];Object(O.arrayEach)(a,(function(t,e){Object(O.arrayEach)(t,(function(t,a){r[o-n[0]+e][i-n[1]+a]=t}))}))})),[n[0],n[1],r]}},{key:"getBulkCollectionDataRange",value:function(t){var e=[0,0],n=[0,0],r=null,o=null,i=null;return Object(O.arrayEach)(t,(function(t){r=t[0],o=t[1],i=t[2],e[0]=Math.min(r,e[0]),e[1]=Math.min(o,e[1]),n[0]=Math.max(r+i.length-1,n[0]),n[1]=Math.max(o+i[0].length-1,n[1])})),[].concat(e,n)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!e||this.validateSetting(t)}},{key:"toggleMergeOnSelection",value:function(){var t=this.hot.getSelectedRangeLast();if(t){t.setDirection("NW-SE");var e=t.from,n=t.to;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(t){t.setDirection("NW-SE");var e=t.from,n=t.to;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"unmergeSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(t){var e=t.from,n=t.to;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"mergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.getTopLeftCorner(),i=t.getBottomRightCorner(),a={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},s=[],l=null;if(!this.canMergeRange(a,n))return!1;this.hot.runHooks("beforeMergeCells",t,n),Object(N.rangeEach)(0,a.rowspan-1,(function(t){Object(N.rangeEach)(0,a.colspan-1,(function(n){var r=null;s[t]||(s[t]=[]),0===t&&0===n?r=e.hot.getDataAtCell(a.row,a.col):e.hot.setCellMeta(a.row+t,a.col+n,"hidden",!0),s[t][n]=r}))})),this.hot.setCellMeta(a.row,a.col,"spanned",!0);var u=this.mergedCellsCollection.add(a);return!u||(r?l=[a.row,a.col,s]:this.hot.populateFromArray(a.row,a.col,s,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",t,a,n),l)}},{key:"unmergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(t);r&&(this.hot.runHooks("beforeUnmergeCells",t,n),Object(O.arrayEach)(r,(function(t){e.mergedCellsCollection.remove(t.row,t.col),Object(N.rangeEach)(0,t.rowspan-1,(function(n){Object(N.rangeEach)(0,t.colspan-1,(function(r){e.hot.removeCellMeta(t.row+n,t.col+r,"hidden")}))})),e.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.render(),this.hot.runHooks("afterUnmergeCells",t,n))}},{key:"toggleMerge",value:function(t){var e=this.mergedCellsCollection.get(t.from.row,t.from.col);e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col?this.unmergeRange(t):this.mergeSelection(t)}},{key:"merge",value:function(t,e,n,r){var o=new rt.a(t,e),i=new rt.a(n,r);this.mergeRange(new rt.b(o,o,i))}},{key:"unmerge",value:function(t,e,n,r){var o=new rt.a(t,e),i=new rt.a(n,r);this.unmergeRange(new rt.b(o,o,i))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"onBeforeKeyDown",value:function(t){(t.ctrlKey||t.metaKey)&&!t.altKey&&77===t.keyCode&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),Object(P.stopImmediatePropagation)(t))}},{key:"onAfterIsMultipleSelection",value:function(t){if(t)for(var e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=0;r<e.length;r+=1)if(n.highlight.row===e[r].row&&n.highlight.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1;return t}},{key:"onModifyTransformStart",value:function(t){var e,n=Qi.get(this),r=this.hot.getSelectedRangeLast(),o={row:t.row,col:t.col},i=new rt.a(r.highlight.row,r.highlight.col),a=this.mergedCellsCollection.get(i.row,i.col);if(n.lastDesiredCoords||(n.lastDesiredCoords=new rt.a(null,null)),a){var s=new rt.a(a.row,a.col),l=new rt.a(a.row+a.rowspan-1,a.col+a.colspan-1);new rt.b(s,s,l).includes(n.lastDesiredCoords)||(n.lastDesiredCoords=new rt.a(null,null)),o.row=n.lastDesiredCoords.row?n.lastDesiredCoords.row-i.row:o.row,o.col=n.lastDesiredCoords.col?n.lastDesiredCoords.col-i.col:o.col,t.row>0?o.row=a.row+a.rowspan-1-i.row+t.row:t.row<0&&(o.row=i.row-a.row+t.row),t.col>0?o.col=a.col+a.colspan-1-i.col+t.col:t.col<0&&(o.col=i.col-a.col+t.col)}e=new rt.a(r.highlight.row+o.row,r.highlight.col+o.col);var u=this.mergedCellsCollection.get(e.row,e.col);u&&(n.lastDesiredCoords=e,o={row:u.row-i.row,col:u.col-i.col}),0!==o.row&&(t.row=o.row),0!==o.col&&(t.col=o.col)}},{key:"onModifyTransformEnd",value:function(t){var e=this,n=this.hot.getSelectedRangeLast(),r=Object(j.clone)(t),o=this.selectionCalculations.getUpdatedSelectionRange(n,t),i=Object(j.clone)(r),a=this.mergedCellsCollection.getWithinRange(o,!0);do{i=Object(j.clone)(r),this.selectionCalculations.getUpdatedSelectionRange(n,r),Object(O.arrayEach)(a,(function(t){e.selectionCalculations.snapDelta(r,n,t)}))}while(r.row!==i.row||r.col!==i.col);t.row=r.row,t.col=r.col}},{key:"onModifyGetCellCoords",value:function(t,e){var n=this.mergedCellsCollection.get(t,e);return n?[n.row,n.col,n.row+n.rowspan-1,n.col+n.colspan-1]:void 0}},{key:"addMergeActionsToContextMenu",value:function(t){var e;t.items.push({name:"---------"},(e=this,{key:"mergeCells",name:function(){var t=this.getSelectedLast();if(t){var n=e.mergedCellsCollection.get(t[0],t[1]);if(n.row===t[0]&&n.col===t[1]&&n.row+n.rowspan-1===t[2]&&n.col+n.colspan-1===t[3])return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var t=this.getSelectedLast();return!t||Ai.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}},{key:"onAfterRenderer",value:function(t,e,n){ji(t,this.mergedCellsCollection.get(e,n),e,n)}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this.hot.getSelectedRangeLast();e.highlight=new rt.a(e.highlight.row,e.highlight.col),e.to=t;var n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(var r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){var o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(t,e,n){var r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(t){var e,n=this,r=this.hot.countCols();Object(N.rangeEach)(0,r-1,(function(r){if((e=n.mergedCellsCollection.get(t.startRow,r))&&e.row<t.startRow)return t.startRow=e.row,n.onAfterViewportRowCalculatorOverride.call(n,t);if(e=n.mergedCellsCollection.get(t.endRow,r)){var o=e.row+e.rowspan-1;if(o>t.endRow)return t.endRow=o,n.onAfterViewportRowCalculatorOverride.call(n,t)}return!0}))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){var e,n=this,r=this.hot.countRows();Object(N.rangeEach)(0,r-1,(function(r){if((e=n.mergedCellsCollection.get(r,t.startColumn))&&e.col<t.startColumn)return t.startColumn=e.col,n.onAfterViewportColumnCalculatorOverride.call(n,t);if(e=n.mergedCellsCollection.get(r,t.endColumn)){var o=e.col+e.colspan-1;if(o>t.endColumn)return t.endColumn=o,n.onAfterViewportColumnCalculatorOverride.call(n,t)}return!0}))}},{key:"onModifyAutofillRange",value:function(t,e){this.autofillCalculations.correctSelectionAreaSize(e);var n=this.autofillCalculations.getDirection(e,t),r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e;var o=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return o?r=this.autofillCalculations.snapDragArea(e,r,n,o):r}},{key:"onAfterCreateCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}},{key:"onAfterRemoveCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}},{key:"onAfterCreateRow",value:function(t,e,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}},{key:"onAfterChange",value:function(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}},{key:"onBeforeDrawAreaBorders",value:function(t,e){if(e&&"area"===e){var n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);Object(O.arrayEach)(r,(function(e){n.getBottomRightCorner().row===e.getLastRow()&&n.getBottomRightCorner().col===e.getLastColumn()&&(t[2]=e.row,t[3]=e.col)}))}}},{key:"onAfterModifyTransformStart",value:function(t,e,n){if(this.enabled){var r=this.mergedCellsCollection.get(t.row,t.col);if(r){var o=e>0,i=e<0,a=n<0,s=n>0,l=r.row+r.rowspan-1==this.hot.countRows()-1,u=0===r.row,c=r.col+r.colspan-1==this.hot.countCols()-1,f=0===r.col;(o&&l||i&&u||s&&c||a&&f)&&(t.row=r.row,t.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(t,e,n,r){return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}])&&Gi(n.prototype,r),o&&Gi(n,o),e}(W);Object(H.d)("mergeCells",Zi);var Ji=Zi;function ta(t){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ea(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function na(t,e){return!e||"object"!==ta(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ra(t,e,n){return(ra="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=oa(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function oa(t){return(oa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ia(t,e){return(ia=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var aa=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=na(this,oa(e).call(this,t))).dragged=[],n.eventManager=null,n.lastSetCell=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ia(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return Object(k.isMobileBrowser)()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new m.a(this)),this.registerListeners(),ra(oa(e.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var t=this,e=this,n=this.hot.rootElement;function r(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;var n=e.dragged.indexOf(t);if(-1===n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1===n&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",(function(t){var n;return Object(w.hasClass)(t.target,"topLeftSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("topLeft"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):Object(w.hasClass)(t.target,"bottomRightSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("bottomRight"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchend",(function(t){return Object(w.hasClass)(t.target,"topLeftSelectionHandle-HitArea")?(r.call(e,"topLeft"),e.touchStartRange=void 0,t.preventDefault(),!1):Object(w.hasClass)(t.target,"bottomRightSelectionHandle-HitArea")?(r.call(e,"bottomRight"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchmove",(function(n){var r,o,i,a,s,l,u=t.hot,c=u.rootWindow,f=u.rootDocument,h=Object(w.getWindowScrollTop)(c),d=Object(w.getWindowScrollLeft)(c);if(0!==e.dragged.length){var p=f.elementFromPoint(n.touches[0].screenX-d,n.touches[0].screenY-h);p&&p!==e.lastSetCell&&("TD"!==p.nodeName&&"TH"!==p.nodeName||(-1===(r=e.hot.getCoords(p)).col&&(r.col=0),i=(o=e.hot.getSelectedRangeLast()).getWidth(),a=o.getHeight(),s=o.getDirection(),1===i&&1===a&&e.hot.selection.setRangeEnd(r),null!==(l=e.getCurrentRangeCoords(o,r,e.touchStartRange.direction,s,e.dragged[0])).start&&e.hot.selection.setRangeStart(l.start),e.hot.selection.setRangeEnd(l.end),e.lastSetCell=p),n.preventDefault())}}))}},{key:"getCurrentRangeCoords",value:function(t,e,n,r,o){var i=t.getTopLeftCorner(),a=t.getBottomRightCorner(),s=t.getBottomLeftCorner(),l=t.getTopRightCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":u="topLeft"===o?{start:new rt.a(e.row,t.highlight.col),end:new rt.a(s.row,e.col)}:{start:new rt.a(t.highlight.row,e.col),end:new rt.a(e.row,i.col)};break;case"SE-NW":"bottomRight"===o&&(u={start:new rt.a(a.row,e.col),end:new rt.a(e.row,i.col)})}break;case"NW-SE":switch(r){case"NE-SW":"topLeft"===o?u={start:e,end:s}:u.end=e;break;case"NW-SE":"topLeft"===o?u={start:e,end:a}:u.end=e;break;case"SE-NW":"topLeft"===o?u={start:e,end:i}:u.end=e;break;case"SW-NE":"topLeft"===o?u={start:e,end:l}:u.end=e}break;case"SW-NE":switch(r){case"NW-SE":u="bottomRight"===o?{start:new rt.a(e.row,i.col),end:new rt.a(s.row,e.col)}:{start:new rt.a(i.row,e.col),end:new rt.a(e.row,a.col)};break;case"SW-NE":u="topLeft"===o?{start:new rt.a(t.highlight.row,e.col),end:new rt.a(e.row,a.col)}:{start:new rt.a(e.row,i.col),end:new rt.a(i.row,e.col)};break;case"SE-NW":"bottomRight"===o?u={start:new rt.a(e.row,l.col),end:new rt.a(i.row,e.col)}:"topLeft"===o&&(u={start:s,end:e})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"===o&&(u.end=e);break;case"SE-NW":"topLeft"===o?u.end=e:u={start:e,end:i}}}return u}},{key:"isDragged",value:function(){return this.dragged.length>0}}])&&ea(n.prototype,r),o&&ea(n,o),e}(W);Object(H.d)("multipleSelectionHandles",aa);var sa=aa,la=n(156),ua=n.n(la);n(130);function ca(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function fa(t){var e=t.match(/^\/(\d+)\/?(.*)?$/);if(!e)return null;var n=ca(e,3),r=n[1],o=n[2];return{row:parseInt(r,10),col:/^\d*$/.test(o)?parseInt(o,10):o}}function ha(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var da=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.observedData=null,this.observer=null,this.paused=!1,this.setObservedData(e)}var e,n,r;return e=t,(n=[{key:"setObservedData",value:function(t){var e=this;this.observer&&ua.a.unobserve(this.observedData,this.observer),this.observedData=t,this.observer=ua.a.observe(this.observedData,(function(t){return e.onChange(t)}))}},{key:"isPaused",value:function(){return this.paused}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"onChange",value:function(t){this.runLocalHooks("change",function(t){var e=[],n=Object(O.arrayFilter)(t,(function(t){return!/[/]length/gi.test(t.path)&&!!fa(t.path)}));return n=Object(O.arrayMap)(n,(function(t){var e=fa(t.path);return t.row=e.row,t.col=e.col,t})),n=Object(O.arrayFilter)(n,(function(t){if(-1!==["add","remove"].indexOf(t.op)&&!isNaN(t.col)){if(-1!==e.indexOf(t.col))return!1;e.push(t.col)}return!0})),e.length=0,n}(t))}},{key:"destroy",value:function(){ua.a.unobserve(this.observedData,this.observer),this.observedData=null,this.observer=null}}])&&ha(e.prototype,n),r&&ha(e,r),t}();Object(j.mixin)(da,Ze.a);var pa=da;function ga(t){return(ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function va(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ya(t,e){return!e||"object"!==ga(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ma(t,e,n){return(ma="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ba(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ba(t){return(ba=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wa(t,e){return(wa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Oa=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ya(this,ba(e).call(this,t))).observer=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wa(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return this.hot.getSettings().observeChanges}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.observer||(this.observer=new pa(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",(function(e){return t.onDataChange(e)})),this.addHook("afterCreateRow",(function(){return t.onAfterTableAlter()})),this.addHook("afterRemoveRow",(function(){return t.onAfterTableAlter()})),this.addHook("afterCreateCol",(function(){return t.onAfterTableAlter()})),this.addHook("afterRemoveCol",(function(){return t.onAfterTableAlter()})),this.addHook("afterChange",(function(e,n){return t.onAfterTableAlter(n)})),this.addHook("afterLoadData",(function(e){return t.onAfterLoadData(e)})),ma(ba(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi()),ma(ba(e.prototype),"disablePlugin",this).call(this)}},{key:"onDataChange",value:function(t){var e=this;if(!this.observer.isPaused()){var n="".concat(this.pluginName,".change"),r={add:function(t){isNaN(t.col)?e.hot.runHooks("afterCreateRow",t.row,1,n):e.hot.runHooks("afterCreateCol",t.col,1,n)},remove:function(t){isNaN(t.col)?e.hot.runHooks("afterRemoveRow",t.row,1,n):e.hot.runHooks("afterRemoveCol",t.col,1,n)},replace:function(t){e.hot.runHooks("afterChange",[[t.row,t.col,null,t.value]],n)}};Object(O.arrayEach)(t,(function(t){r[t.op]&&r[t.op](t)})),this.hot.render()}this.hot.runHooks("afterChangesObserved")}},{key:"onAfterTableAlter",value:function(t){var e=this;"loadData"!==t&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",(function(){return e.observer.resume()})))}},{key:"onAfterLoadData",value:function(t){t||this.observer.setObservedData(this.hot.getSourceData())}},{key:"destroy",value:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi()),ma(ba(e.prototype),"destroy",this).call(this)}},{key:"_exposePublicApi",value:function(){var t=this,e=this.hot;e.pauseObservingChanges=function(){return t.observer.pause()},e.resumeObservingChanges=function(){return t.observer.resume()},e.isPausedObservingChanges=function(){return t.observer.isPaused()}}},{key:"_deletePublicApi",value:function(){var t=this.hot;delete t.pauseObservingChanges,delete t.resumeObservingChanges,delete t.isPausedObservingChanges}}])&&va(n.prototype,r),o&&va(n,o),e}(W),Ca=Oa;Object(H.d)("observeChanges",Oa);n(214);function Ea(t){return(Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sa(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ka(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ra(t,e){return!e||"object"!==Ea(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _a(t,e,n){return(_a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ta(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ta(t){return(Ta=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ma(t,e){return(Ma=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Aa=function(t,e,n,r,o){t.getCellMeta(e,n).isSearchResult=o},Na=function(t,e){return!(Object(A.isUndefined)(t)||null===t||!t.toLowerCase||0===t.length)&&(!Object(A.isUndefined)(e)&&null!==e&&-1!==e.toString().toLowerCase().indexOf(t.toLowerCase()))},ja=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ra(this,Ta(e).call(this,t))).callback=Aa,n.queryMethod=Na,n.searchResultClass="htSearchResult",n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ma(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return this.hot.getSettings().search}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().search;this.updatePluginSettings(n),this.addHook("beforeRenderer",(function(){return t.onBeforeRenderer.apply(t,arguments)})),_a(Ta(e.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var t=this,n=function(){return t.onBeforeRenderer.apply(t,arguments)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterRender",(function(){t.hot.removeHook("beforeRenderer",n)})),_a(Ta(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_a(Ta(e.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),o=this.hot.countRows(),i=this.hot.countCols(),a=[],s=this.hot;return Object(N.rangeEach)(0,o-1,(function(o){Object(N.rangeEach)(0,i-1,(function(i){var l=e.hot.getDataAtCell(o,i),u=e.hot.getCellMeta(o,i),c=u.search.callback||n,f=(u.search.queryMethod||r)(t,l,u);if(f){var h={row:o,col:i,data:l};a.push(h)}c&&c(s,o,i,l,f)}))})),a}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(t){this.callback=t}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(t){this.queryMethod=t}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(t){this.searchResultClass=t}},{key:"updatePluginSettings",value:function(t){Object(j.isObject)(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}},{key:"onBeforeRenderer",value:function(t,e,n,r,o,i){var a,s=i.className||[],l=[];"string"==typeof s?l=s.split(" "):(a=l).push.apply(a,Sa(s)),this.isEnabled()&&i.isSearchResult?l.includes(this.searchResultClass)||l.push("".concat(this.searchResultClass)):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),i.className=l.join(" ")}},{key:"destroy",value:function(){_a(Ta(e.prototype),"destroy",this).call(this)}}])&&ka(n.prototype,r),o&&ka(n,o),e}(W);Object(H.d)("search",ja);var xa=ja;function Ia(t){return(Ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pa(t,e){return!e||"object"!==Ia(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function La(t,e,n){return(La="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ha(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ha(t){return(Ha=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fa(t,e){return(Fa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ba=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Pa(this,Ha(e).call(this,t))).scrollbars=[],n.clones=[],n.lockedCollection=!1,n.freezeOverlays=!1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fa(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return Object(T.isTouchSupported)()}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterRender",(function(){return t.onAfterRender()})),this.registerEvents(),La(Ha(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,La(Ha(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){La(Ha(e.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.addHook("beforeTouchScroll",(function(){return t.onBeforeTouchScroll()})),this.addHook("afterMomentumScroll",(function(){return t.onAfterMomentumScroll()}))}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var t=this.hot.view.wt.wtOverlays,e=t.topOverlay,n=t.bottomOverlay,r=t.leftOverlay,o=t.topLeftCornerOverlay,i=t.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones.length=0,e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,Object(O.arrayEach)(this.clones,(function(t){Object(w.addClass)(t,"hide-tween")}))}},{key:"onAfterMomentumScroll",value:function(){var t=this;this.freezeOverlays=!1,Object(O.arrayEach)(this.clones,(function(t){Object(w.removeClass)(t,"hide-tween"),Object(w.addClass)(t,"show-tween")})),setTimeout((function(){Object(O.arrayEach)(t.clones,(function(t){Object(w.removeClass)(t,"show-tween")}))}),400),Object(O.arrayEach)(this.scrollbars,(function(t){t.refresh(),t.resetFixedPosition()})),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}])&&Da(n.prototype,r),o&&Da(n,o),e}(W);Object(H.d)("touchScroll",Ba);var Ua=Ba;n(216);function Wa(t){return(Wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Va(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ya(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function za(t,e,n){return e&&Ya(t.prototype,e),n&&Ya(t,n),t}function Ga(t,e){return!e||"object"!==Wa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xa(t){return(Xa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qa(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ka(t,e)}function Ka(t,e){return(Ka=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Qa(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Za(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",(function(n,r){var o=n&&n.length;if(o&&!["UndoRedo.undo","UndoRedo.redo","MergeCells"].includes(r)&&n.find((function(t){var e=Qa(t,4);return e[2]!==e[3]}))){var i=n.reduce((function(t,e){return t.push($a(e)),t}),[]);Object(O.arrayEach)(i,(function(e){e[1]=t.propToCol(e[1])}));var a=o>1?this.getSelected():[[i[0][0],i[0][1]]];e.done(new Za.ChangeAction(i,a))}})),t.addHook("afterCreateRow",(function(t,n,r){if("UndoRedo.undo"!==r&&"UndoRedo.undo"!==r&&"auto"!==r){var o=new Za.CreateRowAction(t,n);e.done(o)}})),t.addHook("beforeRemoveRow",(function(n,r,o,i){if("UndoRedo.undo"!==i&&"UndoRedo.redo"!==i&&"auto"!==i){var a=e.instance.getSourceDataArray(),s=(a.length+n)%a.length,l=t.toPhysicalRow(s),u=Object(j.deepClone)(a.slice(l,l+r));e.done(new Za.RemoveRowAction(s,u))}})),t.addHook("afterCreateCol",(function(t,n,r){"UndoRedo.undo"!==r&&"UndoRedo.redo"!==r&&"auto"!==r&&e.done(new Za.CreateColumnAction(t,n))})),t.addHook("beforeRemoveCol",(function(n,r,o,i){if("UndoRedo.undo"!==i&&"UndoRedo.redo"!==i&&"auto"!==i){var a=e.instance.getSourceDataArray(),s=(e.instance.countCols()+n)%e.instance.countCols(),l=[],u=[],c=[];Object(N.rangeEach)(a.length-1,(function(e){var n=[],o=a[e];Object(N.rangeEach)(s,s+(r-1),(function(e){n.push(o[t.runHooks("modifyCol",e)])})),l.push(n)})),Object(N.rangeEach)(r-1,(function(e){c.push(t.runHooks("modifyCol",s+e))})),Array.isArray(t.getSettings().colHeaders)&&Object(N.rangeEach)(r-1,(function(e){u.push(t.getSettings().colHeaders[t.runHooks("modifyCol",s+e)]||null)}));var f=e.instance.getPlugin("manualColumnMove"),h=f.isEnabled()?f.columnsMapper.__arrayMap:[],d=new Za.RemoveColumnAction(s,c,l,u,h);e.done(d)}})),t.addHook("beforeCellAlignment",(function(t,n,r,o){var i=new Za.CellAlignmentAction(t,n,r,o);e.done(i)})),t.addHook("beforeFilter",(function(t){e.done(new Za.FiltersAction(t))})),t.addHook("beforeRowMove",(function(t,n){!1!==t&&e.done(new Za.RowMoveAction(t,n))})),t.addHook("beforeMergeCells",(function(n,r){r||e.done(new Za.MergeCellsAction(t,n))})),t.addHook("afterUnmergeCells",(function(n,r){r||e.done(new Za.UnmergeCellsAction(t,n))}))}Za.prototype.done=function(t){this.ignoreNewActions||(this.doneActions.push(t),this.undoneActions.length=0)},Za.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.pop(),e=Object(j.deepClone)(t),n=this.instance;if(!1===n.runHooks("beforeUndo",e))return;this.ignoreNewActions=!0;var r=this;t.undo(this.instance,(function(){r.ignoreNewActions=!1,r.undoneActions.push(t)})),n.runHooks("afterUndo",e)}},Za.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.pop(),e=Object(j.deepClone)(t),n=this.instance;if(!1===n.runHooks("beforeRedo",e))return;this.ignoreNewActions=!0;var r=this;t.redo(this.instance,(function(){r.ignoreNewActions=!1,r.doneActions.push(t)})),n.runHooks("afterRedo",e)}},Za.prototype.isUndoAvailable=function(){return this.doneActions.length>0},Za.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},Za.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},Za.Action=function(){},Za.Action.prototype.undo=function(){},Za.Action.prototype.redo=function(){},Za.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},Object(j.inherit)(Za.ChangeAction,Za.Action),Za.ChangeAction.prototype.undo=function(t,e){for(var n=Object(j.deepClone)(this.changes),r=t.countEmptyRows(!0),o=t.countEmptyCols(!0),i=0,a=n.length;i<a;i++)n[i].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(var s=0,l=n.length;s<l;s++){var u=Qa(n[s],2),c=u[0],f=u[1];t.getSettings().minSpareRows&&c+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(c+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&f+1+t.getSettings().minSpareCols===t.countCols()&&o===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(f+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)},Za.ChangeAction.prototype.redo=function(t,e){for(var n=Object(j.deepClone)(this.changes),r=0,o=n.length;r<o;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},Za.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},Object(j.inherit)(Za.CreateRowAction,Za.Action),Za.CreateRowAction.prototype.undo=function(t,e){var n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},Za.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},Za.RemoveRowAction=function(t,e){this.index=t,this.data=e,this.actionType="remove_row"},Object(j.inherit)(Za.RemoveRowAction,Za.Action),Za.RemoveRowAction.prototype.undo=function(t,e){t.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterRender",e),t.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},Za.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},Za.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},Object(j.inherit)(Za.CreateColumnAction,Za.Action),Za.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},Za.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},Za.RemoveColumnAction=function(t,e,n,r,o){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.actionType="remove_col"},Object(j.inherit)(Za.RemoveColumnAction,Za.Action),Za.RemoveColumnAction.prototype.undo=function(t,e){var n,r=this,o=this.indexes.slice(0).sort(),i=function(t,e,n){return n[r.indexes.indexOf(o[e])]},a=[];Object(N.rangeEach)(this.data.length-1,(function(t){a[t]=Object(O.arrayMap)(r.data[t],i)}));var s;s=Object(O.arrayMap)(this.headers,i);var l=[];t.runHooks("beforeCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Object(N.rangeEach)(this.data.length-1,(function(e){n=t.getSourceDataAtRow(e),Object(N.rangeEach)(o.length-1,(function(t){n.splice(o[t],0,a[e][t]),l.push([e,o[t],null,a[e][t]])}))})),t.getPlugin("formulas")&&t.getPlugin("formulas").onAfterSetDataAtCell(l),void 0!==this.headers&&Object(N.rangeEach)(s.length-1,(function(e){t.getSettings().colHeaders.splice(o[e],0,s[e])})),t.getPlugin("manualColumnMove")&&(t.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions),t.addHookOnce("afterRender",e),t.runHooks("afterCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo"),t.getPlugin("formulas")&&t.getPlugin("formulas").recalculateFull(),t.render()},Za.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},Za.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r},Za.CellAlignmentAction.prototype.undo=function(t,e){var n=this;Object(O.arrayEach)(this.range,(function(e){for(var r=e.from,o=e.to,i=r.row;i<=o.row;i+=1)for(var a=r.col;a<=o.col;a+=1)t.setCellMeta(i,a,"className",n.stateBefore[i][a]||" htLeft")})),t.addHookOnce("afterRender",e),t.render()},Za.CellAlignmentAction.prototype.redo=function(t,e){ze(this.range,this.type,this.alignment,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),t.addHookOnce("afterRender",e),t.render()},Za.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},Object(j.inherit)(Za.FiltersAction,Za.Action),Za.FiltersAction.prototype.undo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},Za.FiltersAction.prototype.redo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var Ja=function(t){function e(t,n){var r;return Va(this,e),(r=Ga(this,Xa(e).call(this))).cellRange=n,r.rangeData=t.getData(n.from.row,n.from.col,n.to.row,n.to.col),r}return qa(e,t),za(e,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.unmergeRange(this.cellRange,!0),t.populateFromArray(this.cellRange.from.row,this.cellRange.from.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.mergeRange(this.cellRange)}}]),e}(Za.Action);Za.MergeCellsAction=Ja;var ts=function(t){function e(t,n){var r;return Va(this,e),(r=Ga(this,Xa(e).call(this))).cellRange=n,r}return qa(e,t),za(e,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterRender",e),n.unmergeRange(this.cellRange,!0),t.render()}}]),e}(Za.Action);function es(){void 0===this.getSettings().undo||this.getSettings().undo?this.undoRedo||(this.undoRedo=new Za(this),function(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}(this),this.addHook("beforeKeyDown",ns),this.addHook("afterChange",rs)):this.undoRedo&&(delete this.undoRedo,function(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}(this),this.removeHook("beforeKeyDown",ns),this.removeHook("afterChange",rs))}function ns(t){if(!Object(P.isImmediatePropagationStopped)(t)){var e=this.getActiveEditor();if(!e||!e.isOpened()){var n=t.altKey,r=t.ctrlKey,o=t.keyCode,i=t.metaKey,a=t.shiftKey;if((r||i)&&!n)89===o||a&&90===o?(this.undoRedo.redo(),Object(P.stopImmediatePropagation)(t)):90===o&&(this.undoRedo.undo(),Object(P.stopImmediatePropagation)(t))}}}function rs(t,e){if("loadData"===e)return this.undoRedo.clear()}Za.UnmergeCellsAction=ts,Za.RowMoveAction=function(t,e){this.rows=t.slice(),this.target=e},Object(j.inherit)(Za.RowMoveAction,Za.Action),Za.RowMoveAction.prototype.undo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterRender",e);for(var r=this.rows[0]<this.target?-1*this.rows.length:0,o=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],i=[],a=this.rows.length+r,s=r;s<a;s+=1)i.push(this.target+s);n.moveRows(i.slice(),o),t.render(),t.selectCell(this.rows[0],0,this.rows[this.rows.length-1],t.countCols()-1,!1,!1)},Za.RowMoveAction.prototype.redo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterRender",e),n.moveRows(this.rows.slice(),this.target),t.render();var r=this.rows[0]<this.target?this.target-this.rows.length:this.target;t.selectCell(r,0,r+this.rows.length-1,t.countCols()-1,!1,!1)};var os=b.a.getSingleton();os.add("afterInit",es),os.add("afterUpdateSettings",es),os.register("beforeUndo"),os.register("afterUndo"),os.register("beforeRedo"),os.register("afterRedo");var is=Za;function as(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ss=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"STRATEGY_NAME",get:function(){return"loose"}}],(n=[{key:"createRow",value:function(t,e){this.shiftItems(t,e)}},{key:"removeRow",value:function(t,e){this.unshiftItems(t,e)}},{key:"destroy",value:function(){this._arrayMap=null}}])&&as(e.prototype,n),r&&as(e,r),t}();Object(j.mixin)(ss,Qt);var ls=ss;function us(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var cs=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"STRATEGY_NAME",get:function(){return"strict"}}],(n=[{key:"createRow",value:function(t,e){this.insertItems(t,e)}},{key:"removeRow",value:function(t,e){this.removeItems(t,e)}},{key:"destroy",value:function(){this._arrayMap=null}}])&&us(e.prototype,n),r&&us(e,r),t}();Object(j.mixin)(cs,Qt);var fs=cs;function hs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ds(t,e,n){return e&&hs(t.prototype,e),n&&hs(t,n),t}var ps=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.strategy=null}return ds(t,null,[{key:"DEFAULT_STRATEGY",get:function(){return"loose"}}]),ds(t,[{key:"setStrategy",value:function(t){var e=r[Object(I.toUpperCaseFirst)(t)];if(!e)throw new Error('Bind strategy "'.concat(t,'" does not exist.'));this.strategy=new e}},{key:"createMap",value:function(t){var e=this.strategy,n=void 0===t?e._arrayMap.length:t;e._arrayMap.length=0,Object(N.rangeEach)(n-1,(function(t){e._arrayMap.push(t)}))}},{key:"createRow",value:function(){var t;(t=this.strategy).createRow.apply(t,arguments)}},{key:"removeRow",value:function(){var t;(t=this.strategy).removeRow.apply(t,arguments)}},{key:"translate",value:function(){var t;return(t=this.strategy).getValueByIndex.apply(t,arguments)}},{key:"clearMap",value:function(){this.strategy.clearMap()}},{key:"destroy",value:function(){this.strategy&&this.strategy.destroy(),this.strategy=null}}]),t}();function gs(t){return(gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ys(t,e){return!e||"object"!==gs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ms(t,e,n){return(ms="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=bs(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function bs(t){return(bs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ws(t,e){return(ws=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Os=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ys(this,bs(e).call(this,t))).bindStrategy=new ps,n.removedRows=[],n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ws(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof n&&(n=ps.DEFAULT_STRATEGY),this.bindStrategy.setStrategy(n),this.bindStrategy.createMap(this.hot.countSourceRows()),this.addHook("modifyRowHeader",(function(e){return t.onModifyRowHeader(e)})),this.addHook("afterCreateRow",(function(e,n){return t.onAfterCreateRow(e,n)})),this.addHook("beforeRemoveRow",(function(e,n){return t.onBeforeRemoveRow(e,n)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow()})),this.addHook("afterLoadData",(function(e){return t.onAfterLoadData(e)})),ms(bs(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){ms(bs(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.removedRows.length=0,this.bindStrategy.clearMap(),ms(bs(e.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(t){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",t))}},{key:"onAfterCreateRow",value:function(t,e){this.bindStrategy.createRow(t,e)}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&Object(N.rangeEach)(t,t+e-1,(function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t))}))}},{key:"onAfterRemoveRow",value:function(){this.bindStrategy.removeRow(this.removedRows)}},{key:"onAfterLoadData",value:function(t){t||this.bindStrategy.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.bindStrategy.destroy(),ms(bs(e.prototype),"destroy",this).call(this)}}])&&vs(n.prototype,r),o&&vs(n,o),e}(W);Object(H.d)("bindRowsWithHeaders",Os);var Cs=Os;function Es(t){return(Es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ss(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ks(t,e){return!e||"object"!==Es(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rs(t,e,n){return(Rs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_s(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _s(t){return(_s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ts(t,e){return(Ts=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ms=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ks(this,_s(e).call(this,t))).settings=null,n.buttonEnabledList={},n.hiddenColumnsPlugin=null,n.nestedHeadersPlugin=null,n.collapsedSections={},n.columnHeaderLevelCount=null,n.eventManager=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ts(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().collapsibleColumns,"boolean"!=typeof this.settings&&this.parseSettings(),this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns"),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.checkDependencies(),this.addHook("afterRender",(function(){return t.onAfterRender()})),this.addHook("afterInit",(function(){return t.onAfterInit()})),this.addHook("afterGetColHeader",(function(e,n){return t.onAfterGetColHeader(e,n)})),this.addHook("beforeOnCellMouseDown",(function(e,n,r){return t.onBeforeOnCellMouseDown(e,n,r)})),this.eventManager=new m.a(this.hot),Rs(_s(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.buttonEnabledList={},this.hiddenColumnsPlugin=null,this.collapsedSections={},this.clearButtons(),Rs(_s(e.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,o=function(t){t&&t.parentNode.removeChild(t)};Object(N.rangeEach)(0,t-1,(function(t){var i=e.childNodes[t],a=n.childNodes[t],s=r?r.childNodes[t]:null;Object(N.rangeEach)(0,i.childNodes.length-1,(function(t){var e=i.childNodes[t].querySelector(".collapsibleIndicator");o(e),a&&a.childNodes[t]&&(e=a.childNodes[t].querySelector(".collapsibleIndicator"),o(e)),r&&s&&s.childNodes[t]&&(e=s.childNodes[t].querySelector(".collapsibleIndicator"),o(e))}))}),!0)}}},{key:"parseSettings",value:function(){var t=this;Object(j.objectEach)(this.settings,(function(e){t.buttonEnabledList[e.row]||(t.buttonEnabledList[e.row]={}),t.buttonEnabledList[e.row][e.col]=e.collapsible}))}},{key:"meetsDependencies",value:function(){var t=this.hot.getSettings();return t.nestedHeaders&&t.hiddenColumns}},{key:"checkDependencies",value:function(){var t=this.hot.getSettings();this.meetsDependencies()||(t.nestedHeaders||Object(Ni.b)("You need to configure the Nested Headers plugin in order to use collapsible headers."),t.hiddenColumns||Object(Ni.b)("You need to configure the Hidden Columns plugin in order to use collapsible headers."))}},{key:"generateIndicator",value:function(t,e){var n=e.parentNode,r=n.parentNode,o=-1*r.childNodes.length+Array.prototype.indexOf.call(r.childNodes,n);if(Object.keys(this.buttonEnabledList).length>0&&(!this.buttonEnabledList[o]||!this.buttonEnabledList[o][t]))return null;var i=this.hot.rootDocument.createElement("DIV");return Object(w.addClass)(i,"collapsibleIndicator"),this.collapsedSections[o]&&!0===this.collapsedSections[o][t]?(Object(w.addClass)(i,"collapsed"),Object(w.fastInnerText)(i,"+")):(Object(w.addClass)(i,"expanded"),Object(w.fastInnerText)(i,"-")),i}},{key:"markSectionAs",value:function(t,e,n,r){switch(this.collapsedSections[e]||(this.collapsedSections[e]={}),t){case"collapsed":this.collapsedSections[e][n]=!0;break;case"expanded":this.collapsedSections[e][n]=void 0}if(r)for(var o=this.nestedHeadersPlugin.colspanArray,i=this.nestedHeadersPlugin.rowCoordsToLevel(e),a=this.nestedHeadersPlugin.getChildHeaders(e,n),s=o[i+1],l=1;l<a.length;l++)s&&s[a[l]].colspan>1&&this.markSectionAs(t,e+1,a[l],!0)}},{key:"expandSection",value:function(t){this.markSectionAs("expanded",t.row,t.col,!0),this.toggleCollapsibleSection(t,"expand")}},{key:"collapseSection",value:function(t){this.markSectionAs("collapsed",t.row,t.col,!0),this.toggleCollapsibleSection(t,"collapse")}},{key:"toggleAllCollapsibleSections",value:function(t){var e=this,n=this.nestedHeadersPlugin.colspanArray;!0===this.settings?Object(O.arrayEach)(n,(function(n,r){Object(O.arrayEach)(n,(function(n,o){if(n.colspan>1){var i=e.nestedHeadersPlugin.levelToRowCoords(parseInt(r,10)),a=parseInt(o,10);e.markSectionAs("collapse"===t?"collapsed":"expanded",i,a,!0),e.toggleCollapsibleSection({row:i,col:a},t)}}))})):Object(j.objectEach)(this.buttonEnabledList,(function(n,r){Object(j.objectEach)(n,(function(n,o){var i=parseInt(r,10),a=parseInt(o,10);e.markSectionAs("collapse"===t?"collapsed":"expanded",i,a,!0),e.toggleCollapsibleSection({row:i,col:a},t)}))}))}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(t,e){var n=this;t.row&&(t.row=parseInt(t.row,10)),t.col&&(t.col=parseInt(t.col,10));for(var r=this.hiddenColumnsPlugin.hiddenColumns,o=this.nestedHeadersPlugin.colspanArray,i=this.nestedHeadersPlugin.rowCoordsToLevel(t.row),a=o[i][t.col].colspan,s=this.nestedHeadersPlugin.getChildHeaders(t.row,t.col),l=i+1,u=o[l],c=u&&u[s[0]].colspan||1;c===a&&l<this.columnHeaderLevelCount;)c=(u=o[l+=1])&&u[s[0]].colspan||1;Object(N.rangeEach)(c,a-1,(function(o){var i=t.col+o;switch(e){case"collapse":n.hiddenColumnsPlugin.isHidden(i)||r.push(i);break;case"expand":n.hiddenColumnsPlugin.isHidden(i)&&r.splice(r.indexOf(i),1)}})),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0)}},{key:"onAfterGetColHeader",value:function(t,e){if(e.hasAttribute("colspan")&&e.getAttribute("colspan")>1&&t>=this.hot.getSettings().fixedColumnsLeft){var n=this.generateIndicator(t,e);null!==n&&e.querySelector("div:first-child").appendChild(n)}}},{key:"onBeforeOnCellMouseDown",value:function(t,e){if(Object(w.hasClass)(t.target,"collapsibleIndicator"))return Object(w.hasClass)(t.target,"expanded")?(this.collapsedSections[e.row]||(this.collapsedSections[e.row]=[]),this.markSectionAs("collapsed",e.row,e.col,!0),this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection(e,"collapse")):Object(w.hasClass)(t.target,"collapsed")&&(this.markSectionAs("expanded",e.row,e.col,!0),this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection(e,"expand")),Object(P.stopImmediatePropagation)(t),!1}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length}},{key:"onAfterRender",value:function(){this.nestedHeadersPlugin.enabled&&this.hiddenColumnsPlugin.enabled||this.disablePlugin()}},{key:"destroy",value:function(){this.settings=null,this.buttonEnabledList=null,this.hiddenColumnsPlugin=null,this.nestedHeadersPlugin=null,this.collapsedSections=null,this.columnHeaderLevelCount=null,Rs(_s(e.prototype),"destroy",this).call(this)}}])&&Ss(n.prototype,r),o&&Ss(n,o),e}(W);Object(H.d)("collapsibleColumns",Ms);var As=Ms;n(255);function Ns(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function js(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xs=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[],this.recordTranslator=Object(L.a)(this.hot)}var e,n,r;return e=t,(n=[{key:"getEndpoint",value:function(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(t){return this.parseSettings(t.call(this))}},{key:"parseSettings",value:function(t){var e=this,n=[],r=t;if(r||"function"!=typeof this.settings)return r||(r=this.settings),Object(O.arrayEach)(r,(function(t){var r={};e.assignSetting(t,r,"ranges",[[0,e.hot.countRows()-1]]),e.assignSetting(t,r,"reversedRowCoords",!1),e.assignSetting(t,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,r,"sourceColumn",t.destinationColumn),e.assignSetting(t,r,"type","sum"),e.assignSetting(t,r,"forceNumeric",!1),e.assignSetting(t,r,"suppressDataTypeErrors",!0),e.assignSetting(t,r,"suppressDataTypeErrors",!0),e.assignSetting(t,r,"customFunction",null),e.assignSetting(t,r,"readOnly",!0),e.assignSetting(t,r,"roundFloat",!1),n.push(r)})),n;this.settingsType="function"}},{key:"assignSetting",value:function(t,e,n,r){if("ranges"!==n||void 0!==t[n]){if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(r instanceof Error)throw r;e[n]=r}else"destinationRow"===n&&e.reversedRowCoords?e[n]=this.hot.countRows()-t[n]-1:e[n]=t[n]}else e[n]=r}},{key:"resetSetupBeforeStructureAlteration",value:function(t,e,n){if("function"===this.settingsType){var r=t.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();Object(O.arrayEach)(o,(function(o){"row"===r&&o.destinationRow>=e&&("insert_row"===t?o.alterRowOffset=n:"remove_row"===t&&(o.alterRowOffset=-1*n)),"col"===r&&o.destinationColumn>=e&&("insert_col"===t?o.alterColumnOffset=n:"remove_col"===t&&(o.alterColumnOffset=-1*n))})),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(t,e,n,r,o){var i=this,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var s=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=0===t.indexOf("move_row"),f=e;Object(O.arrayEach)(u,(function(t){"row"===s&&t.destinationRow>=f&&(t.alterRowOffset=l*n),"col"===s&&t.destinationColumn>=f&&(t.alterColumnOffset=l*n)})),this.resetAllEndpoints(u,!c),c?Object(O.arrayEach)(u,(function(t){i.extendEndpointRanges(t,f,r[0],r.length),i.recreatePhysicalRanges(t),i.clearOffsetInformation(t)})):Object(O.arrayEach)(u,(function(t){i.shiftEndpointCoordinates(t,f)})),a&&this.refreshAllEndpoints()}else{var h=function t(){return i.hot.removeHook("beforeRender",t),i.refreshAllEndpoints()};this.hot.addHookOnce("beforeRender",h)}}},{key:"clearOffsetInformation",value:function(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(t,e,n,r){Object(O.arrayEach)(t.ranges,(function(t){t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=r:n<t[0]&&(t[0]-=r):n>=t[0]&&n<=t[1]&&(t[1]-=r,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}},{key:"recreatePhysicalRanges",value:function(t){var e=this,n=t.ranges,r=[],o=[];Object(O.arrayEach)(n,(function(t){var n=[];if(t[1])for(var r=t[0];r<=t[1];r++)n.push(e.recordTranslator.toPhysicalRow(r));else n.push(e.recordTranslator.toPhysicalRow(t[0]));o.push(n)})),Object(O.arrayEach)(o,(function(t){var e=[];Object(O.arrayEach)(t,(function(n,o){0===o?e.push(n):t[o]!==t[o-1]+1&&(e.push(t[o-1]),r.push(e),(e=[]).push(n)),o===t.length-1&&(e.push(n),r.push(e))}))})),t.ranges=r}},{key:"shiftEndpointCoordinates",value:function(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,Object(O.arrayEach)(t.ranges,(function(n){Object(O.arrayEach)(n,(function(r,o){r>=e&&(n[o]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t;this.cellsToSetCache=[],r||(r=this.getAllEndpoints()),Object(O.arrayEach)(r,(function(t){e.resetEndpointValue(t,n)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshAllEndpoints",value:function(){var t=this;this.cellsToSetCache=[],Object(O.arrayEach)(this.getAllEndpoints(),(function(e){t.currentEndpoint=e,t.plugin.calculate(e),t.setEndpointValue(e,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(t){var e=this,n=[];this.cellsToSetCache=[],Object(O.arrayEach)(t,(function(t,r,o){"".concat(t[2]||"")!=="".concat(t[3])&&Object(O.arrayEach)(e.getAllEndpoints(),(function(t,i){e.hot.propToCol(o[r][1])===t.sourceColumn&&-1===n.indexOf(i)&&n.push(i)}))})),Object(O.arrayEach)(n,(function(t){e.refreshEndpoint(e.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.alterRowOffset||0,r=t.alterColumnOffset||0,o=this.recordTranslator.toVisual(t.destinationRow,t.destinationColumn),i=Ns(o,2),a=i[0],s=i[1],l=this.hot.getCellMeta(a,s);l.readOnly=!1,l.className="",this.cellsToSetCache.push([this.recordTranslator.toVisualRow(t.destinationRow+(e?n:0)),this.recordTranslator.toVisualColumn(t.destinationColumn+(e?r:0)),""])}},{key:"setEndpointValue",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=-1*t.alterRowOffset||0,o=-1*t.alterColumnOffset||0,i=this.getVisualRowIndex(t.destinationRow),a=this.hot.getCellMeta(this.getVisualRowIndex(t.destinationRow+r),t.destinationColumn+o);i>this.hot.countRows()||t.destinationColumn>this.hot.countCols()?this.throwOutOfBoundsWarning():("init"!==e&&a.readOnly===t.readOnly||(a.readOnly=t.readOnly,a.className="columnSummaryResult"),t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),n?this.hot.setDataAtCell(i,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0)}},{key:"getVisualRowIndex",value:function(t){return this.hot.runHooks("unmodifyRow",t,"columnSummary")}},{key:"getVisualColumnIndex",value:function(t){return this.hot.runHooks("unmodifyCol",t,"columnSummary")}},{key:"throwOutOfBoundsWarning",value:function(){Object(Ni.b)("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}}])&&js(e.prototype,n),r&&js(e,r),t}();function Is(t){return(Is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ds(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ps(t,e){return!e||"object"!==Is(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ls(t,e,n){return(Ls="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hs(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Hs(t){return(Hs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fs(t,e){return(Fs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bs=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ps(this,Hs(e).call(this,t))).endpoints=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fs(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new xs(this,this.settings),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(e,n,r){return t.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,n,null,r)})),this.addHook("beforeCreateCol",(function(e,n,r){return t.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,n,null,r)})),this.addHook("beforeRemoveRow",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_row"].concat(r))})),this.addHook("beforeRemoveCol",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_col"].concat(r))})),this.addHook("beforeRowMove",(function(){return t.onBeforeRowMove.apply(t,arguments)})),this.addHook("afterCreateRow",(function(e,n,r){return t.endpoints.resetSetupAfterStructureAlteration("insert_row",e,n,null,r)})),this.addHook("afterCreateCol",(function(e,n,r){return t.endpoints.resetSetupAfterStructureAlteration("insert_col",e,n,null,r)})),this.addHook("afterRemoveRow",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_row"].concat(r))})),this.addHook("afterRemoveCol",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_col"].concat(r))})),this.addHook("afterRowMove",(function(){return t.onAfterRowMove.apply(t,arguments)})),Ls(Hs(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}},{key:"calculateSum",value:function(t){var e=this,n=0;return Object(j.objectEach)(t.ranges,(function(r){n+=e.getPartialSum(r,t.sourceColumn)})),n}},{key:"getPartialSum",value:function(t,e){var n=0,r=t[1]||t[0],o=null,i=0;do{o=this.getCellValue(r,e)||0;var a=("".concat(o).split(".")[1]||[]).length||1;a>i&&(i=a),n+=o||0,r-=1}while(r>=t[0]);return Math.round(n*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(t,e){var n=this,r=null;return Object(j.objectEach)(t.ranges,(function(o){var i=n.getPartialMinMax(o,t.sourceColumn,e);if(null===r&&null!==i&&(r=i),null!==i)switch(e){case"min":r=Math.min(r,i);break;case"max":r=Math.max(r,i)}})),null===r?"Not enough data":r}},{key:"getPartialMinMax",value:function(t,e,n){var r,o=null,i=t[1]||t[0];do{if(r=this.getCellValue(i,e)||null,null===o)o=r;else if(null!==r)switch(n){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r)}i-=1}while(i>=t[0]);return o}},{key:"countEmpty",value:function(t,e){var n=0,r=t[1]||t[0];do{this.getCellValue(r,e)||(n+=1),r-=1}while(r>=t[0]);return n}},{key:"countEntries",value:function(t){var e=this,n=0,r=t.ranges;return Object(j.objectEach)(r,(function(r){var o=void 0===r[1]?1:r[1]-r[0]+1,i=e.countEmpty(r,t.sourceColumn);n+=o,n-=i})),n}},{key:"calculateAverage",value:function(t){return this.calculateSum(t)/this.countEntries(t)}},{key:"getCellValue",value:function(t,e){var n=this.endpoints.getVisualRowIndex(t),r=this.endpoints.getVisualColumnIndex(e),o=this.hot.getSourceDataAtCell(t,e);if((this.hot.getCellMeta(n,r).className||"").indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error("ColumnSummary plugin: cell at (".concat(t,", ").concat(e,") is not in a numeric format. Cannot do the calculation."));return o}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}},{key:"onBeforeRowMove",value:function(t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName)}},{key:"onAfterRowMove",value:function(t,e){this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}}])&&Ds(n.prototype,r),o&&Ds(n,o),e}(W);Object(H.d)("columnSummary",Bs);var Us=Bs;function Ws(t){return(Ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ys(t,e,n){return(Ys="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zs(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function zs(t){return(zs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xs(t,e,n){return e&&Gs(t.prototype,e),n&&Gs(t,n),t}function qs(t,e){return(qs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}b.a.getSingleton().register("afterDropdownMenuDefaultOptions"),b.a.getSingleton().register("beforeDropdownMenuShow"),b.a.getSingleton().register("afterDropdownMenuShow"),b.a.getSingleton().register("afterDropdownMenuHide"),b.a.getSingleton().register("afterDropdownMenuExecute");var Ks=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==Ws(e)&&"function"!=typeof e?Vs(t):e}(this,zs(e).call(this,t))).eventManager=new m.a(Vs(n)),n.commandExecutor=new vn(n.hot),n.itemsFactory=null,n.menu=null,n.hot.addHook("afterGetColHeader",(function(t,e){return n.onAfterGetColHeader(t,e)})),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qs(t,e)}(e,t),Xs(e,null,[{key:"DEFAULT_ITEMS",get:function(){return["col_left","col_right",Fe,"remove_col",Fe,"clear_column",Fe,"make_read_only",Fe,"alignment"]}}]),Xs(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.itemsFactory=new Nn(this.hot,e.DEFAULT_ITEMS);var n=this.hot.getSettings().dropdownMenu,r={items:this.itemsFactory.getItems(n)};this.registerEvents(),"function"==typeof n.callback&&this.commandExecutor.setCommonCallback(n.callback),Ys(zs(e.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady((function(){t.hot.runHooks("afterDropdownMenuDefaultOptions",r),t.itemsFactory.setPredefinedItems(r.items);var e=t.itemsFactory.getItems(n);t.menu&&t.menu.destroy(),t.menu=new Pn(t.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||t.hot.rootDocument.body}),t.hot.runHooks("beforeDropdownMenuSetItems",e),t.menu.setMenuItems(e),t.menu.addLocalHook("beforeOpen",(function(){return t.onMenuBeforeOpen()})),t.menu.addLocalHook("afterOpen",(function(){return t.onMenuAfterOpen()})),t.menu.addLocalHook("afterClose",(function(){return t.onMenuAfterClose()})),t.menu.addLocalHook("executeCommand",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.executeCommand).call.apply(e,[t].concat(r))})),Object(O.arrayEach)(e,(function(e){return t.commandExecutor.registerCommand(e.key,e)}))}))}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ys(zs(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),Ys(zs(e.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(e){return t.onTableClick(e)}))}},{key:"open",value:function(t){this.menu&&(this.menu.open(),t.width&&this.menu.setOffset("left",t.width),this.menu.setPosition(t),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv)}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"setListening",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(t){if(Object(P.stopPropagation)(t),Object(w.hasClass)(t.target,"changeType")&&!this.menu.isOpened()){var e=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement.getBoundingClientRect();e=r.top,n=r.left}var o=t.target.getBoundingClientRect();this.open({left:o.left+n,top:o.top+t.target.offsetHeight+3+e,width:o.width,height:o.height})}}},{key:"onAfterGetColHeader",value:function(t,e){var n=e.parentNode;if(n){var r=n.parentNode.childNodes,o=Array.prototype.indexOf.call(r,n);if(!(t<0||o!==r.length-1)){var i=e.querySelector(".".concat("changeType"));if(!this.enabled||!i)if(this.enabled){var a=this.hot.rootDocument.createElement("button");a.className="changeType",a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}else i&&i.parentNode.removeChild(i)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Ys(zs(e.prototype),"destroy",this).call(this)}}]),e}(W);Ks.SEPARATOR={name:Fe},Object(H.d)("dropdownMenu",Ks);var $s=Ks;function Qs(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Zs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Js=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.options={}}var e,n,r;return e=t,(n=[{key:"setOptions",value:function(t){this.options=t}},{key:"getData",value:function(){var t=this,e=this._getDataRange(),n=e.startRow,r=e.startCol,o=e.endRow,i=e.endCol,a=this.options,s=[];return Object(N.rangeEach)(n,o,(function(e){var n=[];!a.exportHiddenRows&&t._isHiddenRow(e)||(Object(N.rangeEach)(r,i,(function(r){!a.exportHiddenColumns&&t._isHiddenColumn(r)||n.push(t.hot.getDataAtCell(e,r))})),s.push(n))})),s}},{key:"getRowHeaders",value:function(){var t=this,e=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,o=n.endRow,i=this.hot.getRowHeader();Object(N.rangeEach)(r,o,(function(n){!t.options.exportHiddenRows&&t._isHiddenRow(n)||e.push(i[n])}))}return e}},{key:"getColumnHeaders",value:function(){var t=this,e=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,o=n.endCol,i=this.hot.getColHeader();Object(N.rangeEach)(r,o,(function(n){!t.options.exportHiddenColumns&&t._isHiddenColumn(n)||e.push(i[n])}))}return e}},{key:"_getDataRange",value:function(){var t=this.hot.countCols()-1,e=this.hot.countRows()-1,n=Qs(this.options.range,4),r=n[0],o=void 0===r?0:r,i=n[1],a=void 0===i?0:i,s=n[2],l=void 0===s?e:s,u=n[3],c=void 0===u?t:u;return{startRow:o=Math.max(o,0),startCol:a=Math.max(a,0),endRow:l=Math.min(l,e),endCol:c=Math.min(c,t)}}},{key:"_isHiddenRow",value:function(t){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",t)}},{key:"_isHiddenColumn",value:function(t){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",t)}}])&&Zs(e.prototype,n),r&&Zs(e,r),t}();n(210);function tl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function el(t,e,n){return e&&tl(t.prototype,e),n&&tl(t,n),t}var nl=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}return el(t,null,[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),el(t,[{key:"_mergeOptions",value:function(e){var n=Object(j.clone)(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=Object(j.extend)(Object(j.clone)(t.DEFAULT_OPTIONS),n),(n=Object(j.extend)(n,e)).filename=Object(I.substitute)(n.filename,{YYYY:r.getFullYear(),MM:"".concat(r.getMonth()+1).padStart(2,"0"),DD:"".concat(r.getDate()).padStart(2,"0")}),n}}]),t}();function rl(t){return(rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ol(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function il(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function al(t,e){return!e||"object"!==rl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sl(t){return(sl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ll(t,e){return(ll=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ul=String.fromCharCode(13),cl=String.fromCharCode(34),fl=String.fromCharCode(10),hl=function(t){function e(){return ol(this,e),al(this,sl(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ll(t,e)}(e,t),n=e,o=[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}],(r=[{key:"export",value:function(){var t=this,e=this.options,n=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),o=r.length>0,i=this.dataProvider.getRowHeaders(),a=i.length>0,s=e.bom?String.fromCharCode(65279):"";return o&&(r=Object(O.arrayMap)(r,(function(e){return t._escapeCell(e,!0)})),a&&(s+=e.columnDelimiter),s+=r.join(e.columnDelimiter),s+=e.rowDelimiter),Object(O.arrayEach)(n,(function(n,r){r>0&&(s+=e.rowDelimiter),a&&(s+=t._escapeCell(i[r])+e.columnDelimiter),s+=n.map((function(e){return t._escapeCell(e)})).join(e.columnDelimiter)})),s}},{key:"_escapeCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(A.stringify)(t);return""!==n&&(e||n.indexOf(ul)>=0||n.indexOf(cl)>=0||n.indexOf(fl)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'.concat(n,'"')),n}}])&&il(n.prototype,r),o&&il(n,o),e}(nl);var dl,pl,gl,vl=(gl=hl,(pl="csv")in(dl={})?Object.defineProperty(dl,pl,{value:gl,enumerable:!0,configurable:!0,writable:!0}):dl[pl]=gl,dl);function yl(t,e,n){return"function"==typeof vl[t]?new vl[t](e,n):null}function ml(t){return(ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ol(t,e){return!e||"object"!==ml(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Cl(t){return(Cl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function El(t,e){return(El=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sl=function(t){function e(){return bl(this,e),Ol(this,Cl(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&El(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}},{key:"exportAsBlob",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}},{key:"downloadFile",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.hot,r=n.rootDocument,o=n.rootWindow,i=this._createTypeFormatter(t,e),a=this._createBlob(i),s=o.URL||o.webkitURL,l=r.createElement("a"),u="".concat(i.options.filename,".").concat(i.options.fileExtension);if(void 0!==l.download){var c=s.createObjectURL(a);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout((function(){s.revokeObjectURL(c)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,u)}},{key:"_createTypeFormatter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!vl[t])throw new Error('Export format type "'.concat(t,'" is not supported.'));return yl(t,new Js(this.hot),e)}},{key:"_createBlob",value:function(t){var e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:"".concat(t.options.mimeType,";charset=").concat(t.options.encoding)})),e}}])&&wl(n.prototype,r),o&&wl(n,o),e}(W);Object(H.d)("exportFile",Sl);var kl=Sl;function Rl(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _l(){Object(Ni.b)("Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously.")}function Tl(t,e,n){var r=[];return!1===n?r:(t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push("".concat("sort","-").concat(t.getIndexOfColumnInSortQueue(e)+1)),r)}function Ml(t){var e=t.className.split(" "),n=new RegExp("^".concat("sort","-[0-9]{1,2}$"));return e.filter((function(t){return n.test(t)}))}function Al(t){return(Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jl(t,e){return!e||"object"!==Al(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xl(t,e,n){return(xl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Il(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Il(t){return(Il=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dl(t,e){return(Dl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}ue("multiColumnSorting",(function(t,e){return function(n,r){var o=Rl(n).slice(1),i=Rl(r).slice(1);return function n(r){var a=t[r],s=e[r],l=o[r],u=i[r],c=s.multiColumnSorting,f=(c.compareFunctionFactory?c.compareFunctionFactory:fe(s.type))(a,s,c)(l,u);if(f===be){var h=r+1;if(void 0!==e[h])return n(h)}return f}(0)}}));var Pl=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=jl(this,Il(e).call(this,t))).pluginKey="multiColumnSorting",n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dl(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return xl(Il(e.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){return!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings().columnSorting&&_l(),xl(Il(e.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){return xl(Il(e.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){return xl(Il(e.prototype),"sort",this).call(this,t)}},{key:"clearSort",value:function(){return xl(Il(e.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return xl(Il(e.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(t){return xl(Il(e.prototype),"getSortConfig",this).call(this,t)}},{key:"setSortConfig",value:function(t){return xl(Il(e.prototype),"setSortConfig",this).call(this,t)}},{key:"getNormalizedSortConfigs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}},{key:"updateHeaderClasses",value:function(t){for(var n,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];(n=xl(Il(e.prototype),"updateHeaderClasses",this)).call.apply(n,[this,t].concat(o)),Object(w.removeClass)(t,Ml(t)),!1!==this.enabled&&Object(w.addClass)(t,Tl.apply(void 0,o))}},{key:"onUpdateSettings",value:function(t){return this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings().columnSorting&&_l(),xl(Il(e.prototype),"onUpdateSettings",this).call(this,t)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==zt(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(Object(Dt.a)()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,"append"))):this.sort(this.getColumnNextConfig(e.col)))}}])&&Nl(n.prototype,r),o&&Nl(n,o),e}(De);Object(H.d)("multiColumnSorting",Pl);var Ll,Hl=Pl;n(152);function Fl(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Bl=function(t,e){return t._states["state_"+e]},Ul=function(t,e,n){t._states["state_"+e]=n},Wl=(Fl(Ll={},"_states",{}),Fl(Ll,"getCachedState",(function(t){return Bl(this,t)})),Fl(Ll,"setCachedState",(function(t,e){Ul(this,t,e)})),Fl(Ll,"saveState",(function(t){Ul(this,t,this.getState())})),Fl(Ll,"restoreState",(function(t){this.setState(Bl(this,t))})),Fl(Ll,"hasSavedState",(function(t){return void 0!==Bl(this,t)})),Fl(Ll,"clearState",(function(t){Ul(this,t)})),Fl(Ll,"clearStates",(function(){this._states={}})),Ll);Object(j.defineGetter)(Wl,"MIXIN_NAME","stateSaver",{writable:!1,enumerable:!1});var Vl=Wl;function Yl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var zl=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.elements=[],this.hidden=!1}var e,n,r;return e=t,(n=[{key:"reset",value:function(){Object(O.arrayEach)(this.elements,(function(t){return t.reset()}))}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hidden}},{key:"destroy",value:function(){this.clearLocalHooks(),Object(O.arrayEach)(this.elements,(function(t){return t.destroy()})),this.elements=null,this.hot=null}}])&&Yl(e.prototype,n),r&&Yl(e,r),t}();Object(j.mixin)(zl,Ze.a),Object(j.mixin)(zl,Vl);var Gl=zl,Xl={};function ql(t,e){if(!Xl[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));var n=Xl[t],r=n.condition,o=n.descriptor,i=e;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(t){return r.apply(t.meta.instance,[].concat([t],[i]))}}function Kl(t){if(!Xl[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));return Xl[t].descriptor}function $l(t,e,n){n.key=t,Xl[t]={condition:e,descriptor:n}}$l("none",(function(){return!0}),{name:nn.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});$l("empty",(function(t){return""===t.value||null===t.value||void 0===t.value}),{name:nn.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});function Ql(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}$l("not_empty",(function(t,e){return!ql("empty",e)(t)}),{name:nn.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});$l("eq",(function(t,e){var n=Ql(e,1)[0];return Object(A.stringify)(t.value).toLowerCase()===Object(A.stringify)(n)}),{name:nn.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});function Zl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}$l("neq",(function(t,e){return!ql("eq",e)(t)}),{name:nn.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});function Jl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}$l("gt",(function(t,e){var n=Zl(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>n}),{name:nn.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});function tu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}$l("gte",(function(t,e){var n=Jl(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>=n}),{name:nn.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});function eu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}$l("lt",(function(t,e){var n=tu(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<n}),{name:nn.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});function nu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}$l("lte",(function(t,e){var n=eu(e,1)[0];return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<=n}),{name:nn.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});function ru(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}$l("date_after",(function(t,e){var n=nu(e,1)[0],r=ne()(t.value,t.meta.dateFormat),o=ne()(n,t.meta.dateFormat);return!(!r.isValid()||!o.isValid())&&r.diff(o)>=0}),{name:nn.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});function ou(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}$l("date_before",(function(t,e){var n=ru(e,1)[0],r=ne()(t.value,t.meta.dateFormat),o=ne()(n,t.meta.dateFormat);return!(!r.isValid()||!o.isValid())&&r.diff(o)<=0}),{name:nn.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});$l("between",(function(t,e){var n=ou(e,2),r=n[0],o=n[1];if("numeric"===t.meta.type){var i=parseFloat(r,10),a=parseFloat(o,10);r=Math.min(i,a),o=Math.max(i,a)}else if("date"===t.meta.type){var s=ql("date_before",[o]),l=ql("date_after",[r]);return s(t)&&l(t)}return t.value>=r&&t.value<=o}),{name:nn.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});function iu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}$l("not_between",(function(t,e){return!ql("between",e)(t)}),{name:nn.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});$l("begins_with",(function(t,e){var n=iu(e,1)[0];return Object(A.stringify)(t.value).toLowerCase().startsWith(Object(A.stringify)(n))}),{name:nn.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});n(257);function au(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function su(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}$l("ends_with",(function(t,e){var n=au(e,1)[0];return Object(A.stringify)(t.value).toLowerCase().endsWith(Object(A.stringify)(n))}),{name:nn.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});$l("contains",(function(t,e){var n=su(e,1)[0];return Object(A.stringify)(t.value).toLowerCase().indexOf(Object(A.stringify)(n))>=0}),{name:nn.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});$l("not_contains",(function(t,e){return!ql("contains",e)(t)}),{name:nn.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});$l("date_tomorrow",(function(t){var e=ne()(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(ne()().subtract(-1,"days").startOf("day"),"d")}),{name:nn.FILTERS_CONDITIONS_TOMORROW,inputsCount:0});$l("date_today",(function(t){var e=ne()(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(ne()().startOf("day"),"d")}),{name:nn.FILTERS_CONDITIONS_TODAY,inputsCount:0});$l("date_yesterday",(function(t){var e=ne()(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(ne()().subtract(1,"days").startOf("day"),"d")}),{name:nn.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});Object(T.getComparisonFunction)();function lu(t,e){var n=t;return""===n&&(n="(".concat(e,")")),n}var uu=new Set([1]).has(1),cu=uu&&"function"==typeof Array.from;function fu(t){var e=t;return uu&&(e=new Set(e)),function(t){return uu?e.has(t):!!~e.indexOf(t)}}function hu(t){return null==t?"":t}function du(t){var e=t;return e=(e=cu?Array.from(new Set(e)):Object(O.arrayUnique)(e)).sort((function(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1}))}function pu(t,e,n,r){var o,i=[],a=t===e;return a||(o=fu(e)),Object(O.arrayEach)(t,(function(t){var e=!1;(a||o(t))&&(e=!0);var s={checked:e,value:t,visualValue:lu(t,n)};r&&r(s),i.push(s)})),i}function gu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}$l("by_value",(function(t,e){return(0,gu(e,1)[0])(t.value)}),{name:"By value",inputsCount:0,inputValuesDecorator:function(t){return[fu(gu(t,1)[0])]},showOperators:!1});$l("true",(function(){return!0}),{name:"True"});$l("false",(function(){return!1}),{name:"False"});var vu={};function yu(t){if(!vu[t])throw Error('Operation with id "'.concat(t,'" does not exist.'));var e=vu[t].func;return function(t,n){return e(t,n)}}function mu(t,e,n){vu[t]={name:e,func:n}}mu("conjunction",nn.FILTERS_LABELS_CONJUNCTION,(function(t,e){return t.every((function(t){return t.func(e)}))}));n(109);mu("disjunction",nn.FILTERS_LABELS_DISJUNCTION,(function(t,e){return t.some((function(t){return t.func(e)}))}));var bu;function wu(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}mu("disjunctionWithExtraCondition",nn.FILTERS_LABELS_DISJUNCTION,(function(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((function(t){return t.func(e)}))&&t[t.length-1].func(e)}));var Ou=(wu(bu={},"numeric",["none",Fe,"empty","not_empty",Fe,"eq","neq",Fe,"gt","gte","lt","lte","between","not_between"]),wu(bu,"text",["none",Fe,"empty","not_empty",Fe,"eq","neq",Fe,"begins_with","ends_with",Fe,"contains","not_contains"]),wu(bu,"date",["none",Fe,"empty","not_empty",Fe,"eq","neq",Fe,"date_before","date_after","between",Fe,"date_tomorrow","date_today","date_yesterday"]),bu);function Cu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Eu(t,e,n){return e&&Cu(t.prototype,e),n&&Cu(t,n),t}var Su=["click","input","keydown","keypress","keyup","focus","blur","change"],ku=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.eventManager=new m.a(this),this.options=Object(j.extend)(t.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=!1}return Eu(t,null,[{key:"DEFAULTS",get:function(){return Object(j.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),Eu(t,[{key:"setValue",value:function(t){this.options.value=t,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"isBuilt",value:function(){return"built"===this.buildState}},{key:"translateIfPossible",value:function(t){return"string"==typeof t&&t.startsWith(nn.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(t):t}},{key:"build",value:function(){var t=this,e=function(e,n){t.eventManager.addEventListener(e,n,(function(e){return t.runLocalHooks(n,e,t)}))};if(this.buildState||(this.buildState="building"),this.options.className&&Object(w.addClass)(this._element,this.options.className),this.options.children.length)Object(O.arrayEach)(this.options.children,(function(e){return t._element.appendChild(e.element)}));else if(this.options.wrapIt){var n=this.hot.rootDocument.createElement(this.options.tagName);Object(j.objectEach)(this.options,(function(e,r){void 0!==n[r]&&"className"!==r&&"tagName"!==r&&"children"!==r&&(n[r]=t.translateIfPossible(e))})),this._element.appendChild(n),Object(O.arrayEach)(Su,(function(t){return e(n,t)}))}else Object(O.arrayEach)(Su,(function(n){return e(t._element,n)}))}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}},{key:"element",get:function(){return"building"===this.buildState?this._element:"built"===this.buildState?(this.update(),this._element):(this.buildState="building",this.build(),this.buildState="built",this._element)}}]),t}();Object(j.mixin)(ku,Ze.a);var Ru=ku;function _u(t){return(_u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mu(t,e,n){return(Mu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Au(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Au(t){return(Au=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ju(t,e,n){return e&&Nu(t.prototype,e),n&&Nu(t,n),t}function xu(t,e){return(xu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Iu=new WeakMap,Du=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e){return!e||"object"!==_u(e)&&"function"!=typeof e?Tu(t):e}(this,Au(e).call(this,t,Object(j.extend)(e.DEFAULTS,n))),Iu.set(Tu(r),{}),r.registerHooks(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xu(t,e)}(e,t),ju(e,null,[{key:"DEFAULTS",get:function(){return Object(j.clone)({placeholder:"",type:"text",tagName:"input"})}}]),ju(e,[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",(function(){return t.onClick()})),this.addLocalHook("keyup",(function(e){return t.onKeyup(e)}))}},{key:"build",value:function(){Mu(Au(e.prototype),"build",this).call(this);var t=Iu.get(this),n=this.hot.rootDocument.createElement("div");t.input=this._element.firstChild,Object(w.addClass)(this._element,"htUIInput"),Object(w.addClass)(n,"htUIInputIcon"),this._element.appendChild(n),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=Iu.get(this).input;t.type=this.options.type,t.placeholder=this.translateIfPossible(this.options.placeholder),t.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&Iu.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(t){this.options.value=t.target.value}}]),e}(Ru);function Pu(t){return(Pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hu(t,e,n){return(Hu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Fu(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Fu(t){return(Fu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Uu(t,e,n){return e&&Bu(t.prototype,e),n&&Bu(t,n),t}function Wu(t,e){return(Wu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vu=new WeakMap,Yu=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e){return!e||"object"!==Pu(e)&&"function"!=typeof e?Lu(t):e}(this,Fu(e).call(this,t,Object(j.extend)(e.DEFAULTS,n))),Vu.set(Lu(r),{}),r.menu=null,r.items=[],r.registerHooks(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wu(t,e)}(e,t),Uu(e,null,[{key:"DEFAULTS",get:function(){return Object(j.clone)({className:"htUISelect",wrapIt:!1})}}]),Uu(e,[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",(function(){return t.onClick()}))}},{key:"setItems",value:function(t){this.items=this.translateNames(t),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(t){var e=this;return Object(O.arrayEach)(t,(function(t){t.name=e.translateIfPossible(t.name)})),t}},{key:"build",value:function(){var t=this;Hu(Fu(e.prototype),"build",this).call(this),this.menu=new Pn(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var n=new Ru(this.hot,{className:"htUISelectCaption"}),r=new Ru(this.hot,{className:"htUISelectDropdown"}),o=Vu.get(this);o.caption=n,o.captionElement=n.element,o.dropdown=r,Object(O.arrayEach)([n,r],(function(e){return t._element.appendChild(e.element)})),this.menu.addLocalHook("select",(function(e){return t.onMenuSelect(e)})),this.menu.addLocalHook("afterClose",(function(){return t.onMenuClosed()})),this.update()}},{key:"update",value:function(){var t;this.isBuilt()&&(t=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(nn.FILTERS_CONDITIONS_NONE),Vu.get(this).captionElement.textContent=t,Hu(Fu(e.prototype),"update",this).call(this))}},{key:"openOptions",value:function(){var t=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:t.left-5,top:t.top,width:t.width,height:t.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(t){t.name!==Fe&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var t=Vu.get(this),n=t.caption,r=t.dropdown;n&&n.destroy(),r&&r.destroy(),Hu(Fu(e.prototype),"destroy",this).call(this)}}]),e}(Ru);function zu(t){return(zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gu(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Xu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qu(t,e){return!e||"object"!==zu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ku(t,e,n){return(Ku="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$u(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function $u(t){return($u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qu(t,e){return(Qu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zu=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=qu(this,$u(e).call(this,t))).id=n.id,r.name=n.name,r.addSeparator=n.addSeparator,r.elements.push(new Yu(r.hot,{menuContainer:n.menuContainer})),r.elements.push(new Du(r.hot,{placeholder:nn.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),r.elements.push(new Du(r.hot,{placeholder:nn.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),r.registerHooks(),r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qu(t,e)}(e,t),n=e,(r=[{key:"registerHooks",value:function(){var t=this;this.getSelectElement().addLocalHook("select",(function(e){return t.onConditionSelect(e)})),this.getSelectElement().addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),Object(O.arrayEach)(this.getInputElements(),(function(e){e.addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)}))}))}},{key:"setState",value:function(t){var e=this;if(this.reset(),t){var n=Object(j.clone)(t.command);n.name.startsWith(nn.FILTERS_CONDITIONS_NAMESPACE)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),Object(O.arrayEach)(t.args,(function(t,r){if(r>n.inputsCount-1)return!1;var o=e.getInputElement(r);o.setValue(t),o[n.inputsCount>r?"show":"hide"](),r||setTimeout((function(){return o.focus()}),10)}))}}},{key:"getState",value:function(){var t=this.getSelectElement().getValue()||Kl("none"),e=[];return Object(O.arrayEach)(this.getInputElements(),(function(n,r){t.inputsCount>r&&e.push(n.getValue())})),{command:t,args:e}}},{key:"updateState",value:function(t,e){var n=Kl(t?t.name:"none");this.setCachedState(e,{command:n,args:t?t.args:[]}),t||Object(O.arrayEach)(this.getInputElements(),(function(t){return t.setValue(null)}))}},{key:"getSelectElement",value:function(){return this.elements.filter((function(t){return t instanceof Yu}))[0]}},{key:"getInputElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}},{key:"getInputElements",value:function(){return this.elements.filter((function(t){return t instanceof Du}))}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,r,o,i,a){Object(w.addClass)(n.parentNode,"htFiltersMenuCondition"),t.addSeparator&&Object(w.addClass)(n.parentNode,"border");var s=t.hot.rootDocument.createElement("div");return Object(w.addClass)(s,"htFiltersMenuLabel"),s.textContent=a,n.appendChild(s),n.parentNode.hasAttribute("ghost-table")||Object(O.arrayEach)(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"reset",value:function(){var t,n=this.hot.getPlugin("filters").getSelectedColumn(),r=n&&n.visualIndex,o=function(t){var e=[],n=t;return Ou[n]||(n="text"),Object(O.arrayEach)(Ou[n],(function(t){var n;n=t===Fe?{name:Fe}:Object(j.clone)(Kl(t)),e.push(n)})),e}((t=this.hot).getDataType.apply(t,Gu(this.hot.getSelectedLast()||[0,r])));Object(O.arrayEach)(this.getInputElements(),(function(t){return t.hide()})),this.getSelectElement().setItems(o),Ku($u(e.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(t){Object(O.arrayEach)(this.getInputElements(),(function(e,n){e[t.inputsCount>n?"show":"hide"](),n||setTimeout((function(){return e.focus()}),10)})),this.runLocalHooks("change",t)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(t){Object(D.isKey)(t.keyCode,"ENTER")?(this.runLocalHooks("accept"),Object(P.stopImmediatePropagation)(t)):Object(D.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(P.stopImmediatePropagation)(t))}}])&&Xu(n.prototype,r),o&&Xu(n,o),e}(Gl);function Ju(t){return(Ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ec(t,e,n){return(ec="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=nc(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function nc(t){return(nc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oc(t,e,n){return e&&rc(t.prototype,e),n&&rc(t,n),t}function ic(t,e){return(ic=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ac=new WeakMap,sc=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e){return!e||"object"!==Ju(e)&&"function"!=typeof e?tc(t):e}(this,nc(e).call(this,t,Object(j.extend)(e.DEFAULTS,n))),ac.set(tc(r),{}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ic(t,e)}(e,t),oc(e,null,[{key:"DEFAULTS",get:function(){return Object(j.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),oc(e,[{key:"build",value:function(){ec(nc(e.prototype),"build",this).call(this);var t=ac.get(this);t.input=this._element.firstChild;var n=this.hot.rootDocument.createElement("label");n.textContent=this.translateIfPossible(this.options.label.textContent),n.htmlFor=this.translateIfPossible(this.options.label.htmlFor),t.label=n,this._element.appendChild(n),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=ac.get(this);t.input.checked=this.options.checked,t.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=t,this.update()}},{key:"focus",value:function(){this.isBuilt()&&ac.get(this).input.focus()}}]),e}(Ru);function lc(t){return(lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uc(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["Radio button with index "," doesn't exist."]);return uc=function(){return t},t}function cc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fc(t,e){return!e||"object"!==lc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hc(t){return(hc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dc(t,e){return(dc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pc=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=fc(this,hc(e).call(this,t))).id=n.id,r.name=n.name,r.buildOperatorsElement(),r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dc(t,e)}(e,t),n=e,(r=[{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n){return Object(w.addClass)(n.parentNode,"htFiltersMenuOperators"),n.parentNode.hasAttribute("ghost-table")||Object(O.arrayEach)(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"buildOperatorsElement",value:function(){var t=this,e=["conjunction","disjunction"];Object(O.arrayEach)(e,(function(n){var r,o=new sc(t.hot,{name:"operator",label:{htmlFor:n,textContent:(r=n,vu[r].name)},value:n,checked:n===e[0],id:n});o.addLocalHook("change",(function(e){return t.onRadioInputChange(e)})),t.elements.push(o)}))}},{key:"setChecked",value:function(t){if(this.elements.length<t)throw Error(Object(Ei.a)(uc(),t));Object(O.arrayEach)(this.elements,(function(e,n){e.setChecked(n===t)}))}},{key:"getActiveOperationId",value:function(){var t=this.elements.find((function(t){return t instanceof sc&&t.isChecked()}));return t?t.getValue():"conjunction"}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(t){this.reset(),t&&this.getActiveOperationId()!==t&&Object(O.arrayEach)(this.elements,(function(e){e.setChecked(e.getValue()===t)}))}},{key:"updateState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"conjunction",e=arguments.length>1?arguments[1]:void 0,n=t;"disjunctionWithExtraCondition"===n&&(n="disjunction"),this.setCachedState(e,n)}},{key:"reset",value:function(){this.setChecked(0)}},{key:"onRadioInputChange",value:function(t){this.setState(t.realTarget.value)}}])&&cc(n.prototype,r),o&&cc(n,o),e}(Gl);n(258);function gc(t){return(gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yc(t,e,n){return(yc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=mc(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function mc(t){return(mc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wc(t,e,n){return e&&bc(t.prototype,e),n&&bc(t,n),t}function Oc(t,e){return(Oc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cc=new WeakMap,Ec=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e){return!e||"object"!==gc(e)&&"function"!=typeof e?vc(t):e}(this,mc(e).call(this,t,Object(j.extend)(e.DEFAULTS,n))),Cc.set(vc(r),{}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oc(t,e)}(e,t),wc(e,null,[{key:"DEFAULTS",get:function(){return Object(j.clone)({href:"#",tagName:"a"})}}]),wc(e,[{key:"build",value:function(){yc(mc(e.prototype),"build",this).call(this),Cc.get(this).link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(Cc.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}]),e}(Ru);function Sc(t){return(Sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kc(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Rc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _c(t,e,n){return(_c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tc(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Tc(t){return(Tc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ac(t,e,n){return e&&Mc(t.prototype,e),n&&Mc(t,n),t}function Nc(t,e){return(Nc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jc=new WeakMap,xc=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e){return!e||"object"!==Sc(e)&&"function"!=typeof e?Rc(t):e}(this,Tc(e).call(this,t,Object(j.extend)(e.DEFAULTS,n))),jc.set(Rc(r),{}),r.searchInput=new Du(r.hot,{placeholder:nn.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"}),r.selectAllUI=new Ec(r.hot,{textContent:nn.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"}),r.clearAllUI=new Ec(r.hot,{textContent:nn.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"}),r.items=[],r.itemsBox=null,r.registerHooks(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nc(t,e)}(e,t),Ac(e,null,[{key:"DEFAULTS",get:function(){return Object(j.clone)({className:"htUIMultipleSelect",value:[]})}}]),Ac(e,[{key:"registerHooks",value:function(){var t=this;this.searchInput.addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)})),this.searchInput.addLocalHook("input",(function(e){return t.onInput(e)})),this.selectAllUI.addLocalHook("click",(function(e){return t.onSelectAllClick(e)})),this.clearAllUI.addLocalHook("click",(function(e){return t.onClearAllClick(e)}))}},{key:"setItems",value:function(t){this.items=t,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"getItems",value:function(){return kc(this.items)}},{key:"getValue",value:function(){return t=this.items,e=[],Object(O.arrayEach)(t,(function(t){t.checked&&e.push(t.value)})),e;var t,e}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var t=this;_c(Tc(e.prototype),"build",this).call(this);var n=this.hot.rootDocument,r=n.createElement("div"),o=new Ru(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(o.element),this._element.appendChild(r);var i=function(e){t._element&&(t.itemsBox&&t.itemsBox.destroy(),Object(w.addClass)(e,"htUIMultipleSelectHot"),t.itemsBox=new t.hot.constructor(e,{data:t.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(t,e,n,r,o,i){t.title=i.instance.getDataAtRowProp(e,i.label.property)},autoWrapCol:!0,height:110,colWidths:function(){return t.itemsBox.container.scrollWidth-Object(w.getScrollbarWidth)(n)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(e){return t.onItemsBoxBeforeKeyDown(e)}}),t.itemsBox.init())};i(r),setTimeout((function(){return i(r)}),100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){var t,n,r;this.isBuilt()&&(this.itemsBox.loadData((t=this.items,n=this.options.value,r=fu(n),Object(O.arrayMap)(t,(function(t){return t.checked=r(t.value),t})))),_c(Tc(e.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,_c(Tc(e.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(t){var e,n=t.target.value.toLowerCase();e=""===n?kc(this.items):Object(O.arrayFilter)(this.items,(function(t){return"".concat(t.value).toLowerCase().indexOf(n)>=0})),this.itemsBox.loadData(e)}},{key:"onInputKeyDown",value:function(t){this.runLocalHooks("keydown",t,this),Object(M.partial)(D.isKey,t.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Object(P.stopImmediatePropagation)(t),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(t){var e=Object(M.partial)(D.isKey,t.keyCode);e("ESCAPE")&&this.runLocalHooks("keydown",t,this),e("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(Object(P.stopImmediatePropagation)(t),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(t){t.preventDefault(),Object(O.arrayEach)(this.itemsBox.getSourceData(),(function(t){t.checked=!0})),this.itemsBox.render()}},{key:"onClearAllClick",value:function(t){t.preventDefault(),Object(O.arrayEach)(this.itemsBox.getSourceData(),(function(t){t.checked=!1})),this.itemsBox.render()}}]),e}(Ru);function Ic(t){return(Ic="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Pc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Lc(t,e){return!e||"object"!==Ic(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hc(t,e,n){return(Hc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Fc(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Fc(t){return(Fc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bc(t,e){return(Bc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Uc=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Lc(this,Fc(e).call(this,t))).id=n.id,r.name=n.name,r.elements.push(new xc(r.hot)),r.registerHooks(),r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bc(t,e)}(e,t),n=e,(r=[{key:"registerHooks",value:function(){var t=this;this.getMultipleSelectElement().addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)}))}},{key:"setState",value:function(t){if(this.reset(),t&&"by_value"===t.command.key){var e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0])}}},{key:"getState",value:function(){var t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?"none":"by_value"},args:[t.getValue()],itemsSnapshot:e}}},{key:"updateState",value:function(t){var e=this,n=function(t,n,r,o,i){var a=Dc(Object(O.arrayFilter)(n,(function(t){return"by_value"===t.name})),1)[0],s={},l=e.hot.getTranslatedPhrase(nn.FILTERS_VALUES_BLANK_CELLS);if(a){var u=Object(O.arrayMap)(o(t,i),(function(t){return t.value}));u=du(u),r&&(a.args[0]=r);var c=[],f=pu(u,a.args[0],l,(function(t){t.checked&&c.push(t.value)}));s.args=[c],s.command=Kl("by_value"),s.itemsSnapshot=f}else s.args=[],s.command=Kl("none");e.setCachedState(t,s)};n(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&n(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter((function(t){return t instanceof xc}))[0]}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,r,o,i,a){Object(w.addClass)(n.parentNode,"htFiltersMenuValue");var s=t.hot.rootDocument.createElement("div");return Object(w.addClass)(s,"htFiltersMenuLabel"),s.textContent=a,n.appendChild(s),n.parentNode.hasAttribute("ghost-table")||Object(O.arrayEach)(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"reset",value:function(){var t=this.hot.getTranslatedPhrase(nn.FILTERS_VALUES_BLANK_CELLS),n=du(this._getColumnVisibleValues()),r=pu(n,n,t);this.getMultipleSelectElement().setItems(r),Hc(Fc(e.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(n)}},{key:"onInputKeyDown",value:function(t){Object(D.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Object(P.stopImmediatePropagation)(t))}},{key:"_getColumnVisibleValues",value:function(){var t=this.hot.getPlugin("filters").getSelectedColumn(),e=t&&t.visualIndex;return Object(O.arrayMap)(this.hot.getDataAtCol(e),(function(t){return hu(t)}))}}])&&Pc(n.prototype,r),o&&Pc(n,o),e}(Gl);function Wc(t){return(Wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vc(t,e){return!e||"object"!==Wc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yc(t){return(Yc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gc(t,e,n){return e&&zc(t.prototype,e),n&&zc(t,n),t}function Xc(t,e){return(Xc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qc=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Vc(this,Yc(e).call(this,t))).id=n.id,r.name=n.name,r.elements.push(new Du(r.hot,{type:"button",value:nn.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:e.BUTTON_OK})),r.elements.push(new Du(r.hot,{type:"button",value:nn.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:e.BUTTON_CANCEL})),r.registerHooks(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xc(t,e)}(e,t),Gc(e,null,[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),Gc(e,[{key:"registerHooks",value:function(){var t=this;Object(O.arrayEach)(this.elements,(function(e){e.addLocalHook("click",(function(e,n){return t.onButtonClick(e,n)}))}))}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n){return Object(w.addClass)(n.parentNode,"htFiltersMenuActionBar"),n.parentNode.hasAttribute("ghost-table")||Object(O.arrayEach)(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(t,n){n.options.identifier===e.BUTTON_OK?this.accept():this.cancel()}}]),e}(Gl);function Kc(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["The column of index "," has been already applied with a `","`\n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones.\n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`,\n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\n        use it consequently for a particular column)."]);return Kc=function(){return t},t}function $c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Qc=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.conditions=this.initConditionsCollection(),this.columnTypes={},this.orderStack=[]}var e,n,r;return e=t,(n=[{key:"isEmpty",value:function(){return!this.orderStack.length}},{key:"isMatch",value:function(t,e){var n=this,r=!0;if(void 0===e)Object(j.objectEach)(this.columnTypes,(function(e,o){return r=n.isMatchInConditions(n.conditions[e][o],t,e)}));else{var o=this.columnTypes[e];r=this.isMatchInConditions(this.getConditions(e),t,o)}return r}},{key:"isMatchInConditions",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"conjunction";return!t.length||yu(n)(t,e)}},{key:"addCondition",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"conjunction",r=Object(O.arrayMap)(e.args,(function(t){return"string"==typeof t?t.toLowerCase():t})),o=e.name||e.command.key;this.runLocalHooks("beforeAdd",t),-1===this.orderStack.indexOf(t)&&this.orderStack.push(t);var i=this.columnTypes[t];if(i){if(i!==n)throw Error(Object(Ei.a)(Kc(),t,i))}else{if(!this.conditions[n])throw new Error("Unexpected operation named `".concat(n,"`. Possible ones are `disjunction` and `conjunction`."));this.columnTypes[t]=n}this.getConditions(t).push({name:o,args:r,func:ql(o,r)}),this.runLocalHooks("afterAdd",t)}},{key:"getConditions",value:function(t){var e=this.columnTypes[t];return e?(this.conditions[e][t]||(this.conditions[e][t]=[]),this.conditions[e][t]):[]}},{key:"exportAllConditions",value:function(){var t=this,e=[];return Object(O.arrayEach)(this.orderStack,(function(n){var r=Object(O.arrayMap)(t.getConditions(n),(function(t){return{name:t.name,args:t.args}})),o=t.columnTypes[n];e.push({column:n,operation:o,conditions:r})})),e}},{key:"importAllConditions",value:function(t){var e=this;this.clean(),Object(O.arrayEach)(t,(function(t){e.orderStack.push(t.column),Object(O.arrayEach)(t.conditions,(function(n){return e.addCondition(t.column,n)}))}))}},{key:"removeConditions",value:function(t){this.runLocalHooks("beforeRemove",t),this.orderStack.indexOf(t)>=0&&this.orderStack.splice(this.orderStack.indexOf(t),1),this.clearConditions(t),this.runLocalHooks("afterRemove",t)}},{key:"clearConditions",value:function(t){this.runLocalHooks("beforeClear",t),this.getConditions(t).length=0,delete this.columnTypes[t],this.runLocalHooks("afterClear",t)}},{key:"hasConditions",value:function(t,e){if(!this.columnTypes[t])return!1;var n=this.getConditions(t);return e?Object(O.arrayFilter)(n,(function(t){return t.name===e})).length>0:n.length>0}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.columnTypes=Object.create(null),this.orderStack.length=0,this.conditions=this.initConditionsCollection(),this.runLocalHooks("afterClean")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.conditions=null,this.orderStack=null,this.columnTypes=null}},{key:"initConditionsCollection",value:function(){var t=Object.create(null);return Object(j.objectEach)(vu,(function(e,n){t[n]=Object.create(null)})),t}}])&&$c(e.prototype,n),r&&$c(e,r),t}();Object(j.mixin)(Qc,Ze.a);var Zc=Qc;function Jc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ef=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};Jc(this,t),this.conditionCollection=e,this.columnDataFactory=n}var e,n,r;return e=t,(n=[{key:"filter",value:function(){var t=this,e=[];return this.conditionCollection.isEmpty()||Object(O.arrayEach)(this.conditionCollection.orderStack,(function(n,r){var o=t.columnDataFactory(n);r&&(o=t._getIntersectData(o,e)),e=t.filterByColumn(n,o)})),e}},{key:"filterByColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return Object(O.arrayEach)(n,(function(n){void 0!==n&&e.conditionCollection.isMatch(n,t)&&r.push(n)})),r}},{key:"_getIntersectData",value:function(t,e){var n=[];return Object(O.arrayEach)(e,(function(e){var r=e.meta.visualRow;void 0!==t[r]&&(n[r]=t[r])})),n}}])&&tf(e.prototype,n),r&&tf(e,r),t}();function nf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var of=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};nf(this,t),this.conditionCollection=e,this.columnDataFactory=r,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(function(t){return n._onConditionBeforeModify(t)})),this.conditionCollection.addLocalHook("afterAdd",(function(t){return n.updateStatesAtColumn(t)})),this.conditionCollection.addLocalHook("afterClear",(function(t){return n.updateStatesAtColumn(t)})),this.conditionCollection.addLocalHook("beforeClean",(function(){return n._onConditionBeforeClean()})),this.conditionCollection.addLocalHook("afterClean",(function(){return n._onConditionAfterClean()}))}var e,n,r;return e=t,(n=[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var t=this;this.grouping=!1,Object(O.arrayEach)(this.changes,(function(e){t.updateStatesAtColumn(e)})),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(t){this.latestEditedColumnPosition=this.conditionCollection.orderStack.indexOf(t)}},{key:"updateStatesAtColumn",value:function(t,e){var n=this;if(this.grouping)-1===this.changes.indexOf(t)&&this.changes.push(t);else{var r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.orderStack.indexOf(t);-1===o&&(o=this.latestEditedColumnPosition);var i=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===t&&a.shift();var s=Object(M.curry)((function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new Zc,i=[].concat(t,r);o.importAllConditions(i);var a,s=n.columnDataFactory(e);a=o.isEmpty()?s:new ef(o,(function(t){return n.columnDataFactory(t)})).filter();var l=fu(a=Object(O.arrayMap)(a,(function(t){return t.meta.visualRow})));return Object(O.arrayFilter)(s,(function(t){return l(t.meta.visualRow)}))}))(i),l=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:l},dependentConditionStacks:a,filteredRowsFactory:s,conditionArgsChange:e})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=[].concat(this.conditionCollection.orderStack)}},{key:"_onConditionAfterClean",value:function(){var t=this;Object(O.arrayEach)(this.latestOrderStack,(function(e){t.updateStatesAtColumn(e)}))}},{key:"destroy",value:function(){var t=this;this.clearLocalHooks(),Object(j.objectEach)(this,(function(e,n){t[n]=null}))}}])&&rf(e.prototype,n),r&&rf(e,r),t}();Object(j.mixin)(of,Ze.a);var af=of;function sf(t){return(sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lf(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."]);return lf=function(){return t},t}function uf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function cf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ff(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hf(t,e,n){return(hf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=df(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function df(t){return(df=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pf(t,e){return(pf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gf=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==sf(e)&&"function"!=typeof e?ff(t):e}(this,df(e).call(this,t))).eventManager=new m.a(ff(n)),n.trimRowsPlugin=null,n.dropdownMenuPlugin=null,n.conditionCollection=null,n.conditionUpdateObserver=null,n.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),n.lastSelectedColumn=null,n.hiddenRowsCache=new Map,n.hot.addHook("afterGetColHeader",(function(t,e){return n.onAfterGetColHeader(t,e)})),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pf(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().filters}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,o=function(e){return e.addLocalHook("accept",(function(){return t.onActionBarSubmit("accept")})),e.addLocalHook("cancel",(function(){return t.onActionBarSubmit("cancel")})),e.addLocalHook("change",(function(n){return t.onComponentChange(e,n)})),e};if(!this.components.get("filter_by_condition")){var i=new Zu(this.hot,{id:"filter_by_condition",name:function(){return"".concat(t.hot.getTranslatedPhrase(nn.FILTERS_DIVS_FILTER_BY_CONDITION),":")},addSeparator:!1,menuContainer:r});i.addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),this.components.set("filter_by_condition",o(i))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new pc(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var a=new Zu(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),this.components.set("filter_by_condition2",o(a))}this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new Uc(this.hot,{id:"filter_by_value",name:function(){return"".concat(t.hot.getTranslatedPhrase(nn.FILTERS_DIVS_FILTER_BY_VALUE),":")}}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new qc(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Zc),this.conditionUpdateObserver||(this.conditionUpdateObserver=new af(this.conditionCollection,(function(e){return t.getDataMapAtColumn(e)})),this.conditionUpdateObserver.addLocalHook("update",(function(e){return t.updateComponents(e)}))),this.components.forEach((function(t){t.show()})),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",(function(e){return t.onBeforeDropdownMenuSetItems(e)})),this.addHook("afterDropdownMenuDefaultOptions",(function(e){return t.onAfterDropdownMenuDefaultOptions(e)})),this.addHook("afterDropdownMenuShow",(function(){return t.onAfterDropdownMenuShow()})),this.addHook("afterDropdownMenuHide",(function(){return t.onAfterDropdownMenuHide()})),this.addHook("afterChange",(function(e){return t.onAfterChange(e)})),this.hot.getSettings().trimRows=!0,this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().dropdownMenu&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),hf(df(e.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(e){return t.onTableClick(e)}))}},{key:"disablePlugin",value:function(){this.enabled&&(this.dropdownMenuPlugin.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((function(t){t.hide()})),this.conditionCollection.clean(),this.trimRowsPlugin.untrimAll()),hf(df(e.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"conjunction",o=this.t.toPhysicalColumn(t);this.conditionCollection.addCondition(o,{command:{key:e},args:n},r)}},{key:"removeConditions",value:function(t){var e=this.t.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}},{key:"clearConditions",value:function(t){if(void 0===t)this.conditionCollection.clean();else{var e=this.t.toPhysicalColumn(t);this.conditionCollection.clearConditions(e)}}},{key:"filter",value:function(){var t=this._createDataFilter(),e=!this.conditionCollection.isEmpty(),n=[],r=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",r))if(e){var o=[];this.trimRowsPlugin.trimmedRows.length=0;var i=fu(n=Object(O.arrayMap)(t.filter(),(function(t){return t.meta.visualRow})));Object(N.rangeEach)(this.hot.countSourceRows()-1,(function(t){i(t)||o.push(t)})),this.trimRowsPlugin.trimRows(o),n.length||this.hot.deselectCell()}else this.trimRowsPlugin.untrimAll();this.hot.view.wt.wtOverlays.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection(),this.hot.runHooks("afterFilter",r)}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var t=uf(this.hot.getSelectedLast()||[],2),e=t[0],n=t[1];void 0!==e&&void 0!==n&&this.hot.selectCell(e,n)}},{key:"getDataMapAtColumn",value:function(t){var e=this,n=this.t.toVisualColumn(t),r=[];return Object(O.arrayEach)(this.hot.getSourceDataAtCol(n),(function(t,o){var i=e.hot.getCellMeta(o,n),a=i.row,s=i.col,l=i.visualCol,u=i.visualRow,c=i.type,f=i.instance,h=i.dateFormat;r.push({meta:{row:a,col:s,visualCol:l,visualRow:u,type:c,instance:f,dateFormat:h},value:hu(t)})})),r}},{key:"onAfterChange",value:function(t){var e=this;t&&Object(O.arrayEach)(t,(function(t){var n=uf(t,2)[1],r=e.hot.propToCol(n);e.conditionCollection.hasConditions(r)&&e.updateValueComponentCondition(r)}))}},{key:"updateValueComponentCondition",value:function(t){var e=du(this.hot.getDataAtCol(t));this.conditionUpdateObserver.updateStatesAtColumn(t,e)}},{key:"restoreComponents",value:function(t){var e=this.getSelectedColumn(),n=e&&e.physicalIndex;t.forEach((function(t){!1===t.isHidden()&&t.restoreState(n)}))}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents([this.components.get("filter_by_condition"),this.components.get("filter_operators"),this.components.get("filter_by_condition2"),this.components.get("filter_by_value")])}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(t){var e=Object(O.arrayMap)(t,(function(t){return t.key}));this.components.forEach((function(t){t[-1===e.indexOf(t.getMenuItemDescriptor().key)?"hide":"show"]()})),this.initHiddenRowsCache()}},{key:"onAfterDropdownMenuDefaultOptions",value:function(t){t.items.push({name:Fe}),this.components.forEach((function(e){t.items.push(e.getMenuItemDescriptor())}))}},{key:"getOperationBasedOnArguments",value:function(t,e,n,r){var o=t;return"disjunction"===o&&"none"!==e.command.key&&"none"!==n.command.key&&"none"!==r.command.key?o="disjunctionWithExtraCondition":"none"!==r.command.key&&("none"!==e.command.key&&"none"!==n.command.key||(o="conjunction")),o}},{key:"onActionBarSubmit",value:function(t){if("accept"===t){var e=this.getSelectedColumn(),n=e&&e.physicalIndex,r=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),i=this.components.get("filter_by_value").getState(),a=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,o,i);this.conditionUpdateObserver.groupChanges(),this.conditionCollection.clearConditions(n),"none"===r.command.key&&"none"===o.command.key&&"none"===i.command.key?this.conditionCollection.removeConditions(n):("none"!==r.command.key&&(this.conditionCollection.addCondition(n,r,a),"none"!==o.command.key&&this.conditionCollection.addCondition(n,o,a)),"none"!==i.command.key&&this.conditionCollection.addCondition(n,i,a)),this.conditionUpdateObserver.flush(),this.components.get("filter_operators").saveState(n),this.components.get("filter_by_value").saveState(n),this.saveHiddenRowsCache(n),this.trimRowsPlugin.trimmedRows.length=0,this.filter()}this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(t,e){t===this.components.get("filter_by_condition")&&(e.showOperators?this.showComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators")):this.hideComponents(this.components.get("filter_by_condition2"),this.components.get("filter_operators"))),t.constructor!==Zu||e.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin.setListening()}},{key:"onAfterGetColHeader",value:function(t,e){var n=this.t.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?Object(w.addClass)(e,"htFiltersActive"):Object(w.removeClass)(e,"htFiltersActive")}},{key:"onTableClick",value:function(t){var e=Object(w.closest)(t.target,"TH");if(e){var n=this.hot.getCoords(e).col,r=this.t.toPhysicalColumn(n);this.lastSelectedColumn={visualIndex:n,physicalIndex:r}}}},{key:"destroy",value:function(){this.enabled&&(this.components.forEach((function(t){t.destroy()})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hiddenRowsCache.clear(),this.trimRowsPlugin.disablePlugin()),hf(df(e.prototype),"destroy",this).call(this)}},{key:"_createDataFilter",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new ef(e,(function(e){return t.getDataMapAtColumn(e)}))}},{key:"updateComponents",value:function(t){if(this.dropdownMenuPlugin.enabled){var e=t.editedConditionStack.conditions,n=t.editedConditionStack.column,r=e.filter((function(t){return"by_value"===t.name})),o=e.filter((function(t){return"by_value"!==t.name})),i=this.conditionCollection.columnTypes[n];2===r.length||3===o.length?Object(Ni.b)(Object(Ei.a)(lf())):(o.length>0&&this.showComponentForParticularColumn(this.components.get("filter_operators"),n),this.components.get("filter_by_condition").updateState(o[0],n),this.components.get("filter_by_condition2").updateState(o[1],n),this.components.get("filter_by_value").updateState(t),this.components.get("filter_operators").updateState(i,n))}}},{key:"showComponentForParticularColumn",value:function(t,e){if(this.hiddenRowsCache.has(e)){var n=this.getIndexesOfComponents(t);this.removeIndexesFromHiddenRowsCache(e,n)}else this.hiddenRowsCache.set(e,[])}},{key:"removeIndexesFromHiddenRowsCache",value:function(t,e){var n=this.hiddenRowsCache.get(t);Object(O.arrayEach)(e,(function(t){n.includes(t)&&n.splice(n.indexOf(t),1)}))}},{key:"getIndexesOfComponents",value:function(){for(var t=this.dropdownMenuPlugin.menu,e=[],n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Object(O.arrayEach)(r,(function(n){Object(O.arrayEach)(t.menuItems,(function(t,r){t.key===n.getMenuItemDescriptor().key&&e.push(r)}))})),e}},{key:"changeComponentsVisibility",value:function(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.dropdownMenuPlugin.menu,n=e.hotMenu,r=n.getPlugin("hiddenRows"),o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var s=this.getIndexesOfComponents.apply(this,i);t?r.showRows(s):r.hideRows(s),n.render()}},{key:"initHiddenRowsCache",value:function(){var t=this;this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(function(){var e=t.lastSelectedColumn.physicalIndex;t.hiddenRowsCache.has(e)||t.hiddenRowsCache.set(e,t.getIndexesOfComponents(t.components.get("filter_operators"),t.components.get("filter_by_condition2"))),t.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:{rows:t.hiddenRowsCache.get(e)}})}))}},{key:"saveHiddenRowsCache",value:function(t){this.hiddenRowsCache.set(t,this.dropdownMenuPlugin.menu.hotMenu.getPlugin("hiddenRows").hiddenRows)}},{key:"hideComponents",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(e))}},{key:"showComponents",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(e))}}])&&cf(n.prototype,r),o&&cf(n,o),e}(W);Object(H.d)("filters",gf);var vf=gf;function yf(t){return"string"==typeof t&&t.length>=2&&"="===t.charAt(0)}function mf(t){return"string"==typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function bf(t){var e=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,n=t.match(e)||[],r=-1;return t.toUpperCase().replace(e,(function(){return n[r+=1]}))}function wf(t,e){return function(n){return{row:"row"===t?e:n.row,column:"column"===t?e:n.column}}}var Of=n(53);function Cf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ef=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=Object(j.isObject)(e),o=Object(j.isObject)(n);this._row=r?e.index:e,this.rowAbsolute=!r||e.isAbsolute,this._column=o?n.index:n,this.columnAbsolute=!o||n.isAbsolute,this.rowOffset=0,this.columnOffset=0,Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(t){this._row=t},enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(t){this._column=t},enumerable:!0,configurable:!0})}var e,n,r;return e=t,(n=[{key:"translateTo",value:function(t,e){this.row=this.row+t,this.column=this.column+e}},{key:"isEqual",value:function(t){return t.row===this.row&&t.column===this.column}},{key:"toString",value:function(){return Object(Of.toLabel)({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}}])&&Cf(e.prototype,n),r&&Cf(e,r),t}();function Sf(t){return(Sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kf(t,e){return!e||"object"!==Sf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rf(t){return(Rf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tf(t,e,n){return e&&_f(t.prototype,e),n&&_f(t,n),t}function Mf(t,e){return(Mf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Af=[1,2,3],Nf=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=kf(this,Rf(e).call(this,t,n))).precedents=[],r.value=null,r.error=null,r.state=e.STATE_UP_TO_DATE,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mf(t,e)}(e,t),Tf(e,null,[{key:"STATE_OUT_OFF_DATE",get:function(){return 1}},{key:"STATE_COMPUTING",get:function(){return 2}},{key:"STATE_UP_TO_DATE",get:function(){return 3}}]),Tf(e,[{key:"setValue",value:function(t){this.value=t}},{key:"getValue",value:function(){return this.value}},{key:"setError",value:function(t){this.error=t}},{key:"getError",value:function(){return this.error}},{key:"hasError",value:function(){return null!==this.error}},{key:"setState",value:function(t){if(-1===Af.indexOf(t))throw Error("Unrecognized state: ".concat(t));this.state=t}},{key:"isState",value:function(t){return this.state===t}},{key:"addPrecedent",value:function(t){if(this.isEqual(t))throw Error(Of.ERROR_REF);this.hasPrecedent(t)||this.precedents.push(t)}},{key:"removePrecedent",value:function(t){if(this.isEqual(t))throw Error(Of.ERROR_REF);this.precedents=Object(O.arrayFilter)(this.precedents,(function(e){return!e.isEqual(t)}))}},{key:"clearPrecedents",value:function(){this.precedents.length=0}},{key:"getPrecedents",value:function(){return this.precedents}},{key:"hasPrecedents",value:function(){return this.precedents.length>0}},{key:"hasPrecedent",value:function(t){return Object(O.arrayFilter)(this.precedents,(function(e){return e.isEqual(t)})).length>0}}]),e}(Ef);function jf(t){return(jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function If(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Df(t,e){return!e||"object"!==jf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pf(t){return(Pf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lf(t,e){return(Lf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hf=function(t){function e(){return xf(this,e),Df(this,Pf(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lf(t,e)}(e,t),n=e,(r=[{key:"toString",value:function(){return Object(Of.toLabel)({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}}])&&If(n.prototype,r),o&&If(n,o),e}(Ef);function Ff(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Bf=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.t=e,this.data=[],this.cellReferences=[]}var e,n,r;return e=t,(n=[{key:"getCellAt",value:function(t,e){var n=null;return Object(O.arrayEach)(this.data,(function(r){if(r.row===t&&r.column===e)return n=r,!1})),n}},{key:"getOutOfDateCells",value:function(){return Object(O.arrayFilter)(this.data,(function(t){return t.isState(Nf.STATE_OUT_OFF_DATE)}))}},{key:"add",value:function(t){Object(O.arrayFilter)(this.data,(function(e){return e.isEqual(t)})).length||this.data.push(t)}},{key:"remove",value:function(t){var e=Array.isArray(t);this.data=Object(O.arrayFilter)(this.data,(function(n){return!function(t,n){var r=!1;return e?Object(O.arrayEach)(n,(function(e){if(t.isEqual(e))return r=!0,!1})):r=t.isEqual(n),r}(n,t)}))}},{key:"getDependencies",value:function(t){var e=this,n=function(t){return Object(O.arrayReduce)(e.data,(function(e,n){return n.hasPrecedent(t)&&-1===e.indexOf(n)&&e.push(n),e}),[])};return function t(r){var o=n(r);return o.length&&Object(O.arrayEach)(o,(function(n){n.hasPrecedents()&&(o=o.concat(t(e.t.toVisual(n))))})),o}(t)}},{key:"registerCellRef",value:function(t){Object(O.arrayFilter)(this.cellReferences,(function(e){return e.isEqual(t)})).length||this.cellReferences.push(t)}},{key:"removeCellRefsAtRange",value:function(t,e){var n=t.row,r=t.column,o=e.row,i=e.column,a=[];return this.cellReferences=Object(O.arrayFilter)(this.cellReferences,(function(t){return!function(t){return void 0===n||t.row>=n&&t.row<=o}(t)||!function(t){return void 0===r||t.column>=r&&t.column<=i}(t)||(a.push(t),!1)})),a}},{key:"reset",value:function(){this.data.length=0,this.cellReferences.length=0}}])&&Ff(e.prototype,n),r&&Ff(e,r),t}();function Uf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Wf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Vf=/^\$?[A-Z]+\$?\d+$/,Yf=/\$?[A-Z]+\$?\d+/,zf=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,Gf=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,Xf=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,qf=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.expression="",this.cells=[],this.customModifier=null,"string"==typeof e&&this.setExpression(e)}var e,n,r;return e=t,(n=[{key:"setExpression",value:function(t){return this.cells.length=0,this.expression=bf(t),this._extractCells(),this._extractCellsRange(),this}},{key:"useCustomModifier",value:function(t){this.customModifier=t}},{key:"translate",value:function(t){var e=this,n=t.row,r=t.column,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(O.arrayEach)(this.cells,(function(t){null!=n&&e._translateCell(t,"row",n,o.row),null!=r&&e._translateCell(t,"column",r,o.column)})),this}},{key:"toString",value:function(){var t=this,e=this.expression.replace(Xf,(function(e,n,r){var o=-1===e.indexOf(":"),i=e,a=e,s=null;o&&(a=Vf.test(n)?n:r);var l=t._searchCell(a);return l&&(s=l.refError?Object(Of.error)(Of.ERROR_REF):l.toLabel(),i=o?e.replace(a,s):s),i}));return e.startsWith("=")||(e="=".concat(e)),e}},{key:"_translateCell",value:function(t,e,n,r){var o=t.start,i=t.end,a=o[e].index,s=i[e].index,l=n,u=n,c=!1;if(this.customModifier){var f=Uf(this.customModifier(t,e,n,r),3);l=f[0],u=f[1],c=f[2]}else o[e].isAbsolute&&(l=0),i[e].isAbsolute&&(u=0);l&&!c&&(a+l<0&&(c=!0),o[e].index=Math.max(a+l,0)),u&&!c&&(s+u<0&&(c=!0),i[e].index=Math.max(s+u,0)),c&&(t.refError=!0)}},{key:"_extractCells",value:function(){var t=this,e=this.expression.match(zf);e&&Object(O.arrayEach)(e,(function(e){var n=e.match(Yf);if(n){var r=Uf(Object(Of.extractLabel)(n[0]),2),o=r[0],i=r[1];t.cells.push(t._createCell({row:o,column:i},{row:o,column:i},n[0]))}}))}},{key:"_extractCellsRange",value:function(){var t=this,e=this.expression.match(Gf);e&&Object(O.arrayEach)(e,(function(e){var n=Uf(e.split(":"),2),r=n[0],o=n[1],i=Uf(Object(Of.extractLabel)(r),2),a=i[0],s=i[1],l=Uf(Object(Of.extractLabel)(o),2),u={row:a,column:s},c={row:l[0],column:l[1]};t.cells.push(t._createCell(u,c,e))}))}},{key:"_searchCell",value:function(t){return Uf(Object(O.arrayFilter)(this.cells,(function(e){return e.origLabel===t})),1)[0]||null}},{key:"_createCell",value:function(t,e,n){return{start:t,end:e,origLabel:n,type:-1===n.indexOf(":")?"cell":"range",refError:!1,toLabel:function(){var t=Object(Of.toLabel)(this.start.row,this.start.column);return"range"===this.type&&(t+=":".concat(Object(Of.toLabel)(this.end.row,this.end.column))),t}}}}])&&Wf(e.prototype,n),r&&Wf(e,r),t}();Object(j.mixin)(qf,Ze.a);var Kf,$f=qf,Qf="column_sorting";function Zf(){var t=this.matrix,e=this.dataProvider;Kf=new WeakMap,Object(O.arrayEach)(t.data,(function(t){Kf.set(t,e.t.toVisualRow(t.row))}))}function Jf(){var t=this.matrix,e=this.dataProvider;t.cellReferences.length=0,Object(O.arrayEach)(t.data,(function(t){t.setState(Nf.STATE_OUT_OFF_DATE),t.clearPrecedents();var n=t.row,r=t.column,o=e.getSourceDataAtCell(n,r);if(yf(o)){var i=Kf.get(t),a=new $f(o);a.translate({row:e.t.toVisualRow(n)-i}),e.updateSourceData(n,r,a.toString())}})),Kf=null}var th="insert_column";function eh(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.matrix,o=this.dataProvider,i=[0,e];Object(O.arrayEach)(r.cellReferences,(function(e){e.column>=t&&e.translateTo.apply(e,i)})),Object(O.arrayEach)(r.data,(function(r){var a=r.row,s=r.column;if(r.column>=t&&(r.translateTo.apply(r,i),r.setState(Nf.STATE_OUT_OFF_DATE)),n){var l=r.row,u=r.column,c=o.getSourceDataAtCell(l,u);if(yf(c)){var f=wf("column",t),h=new $f(c);h.useCustomModifier(nh),h.translate({column:e},f({row:a,column:s})),o.updateSourceData(l,u,h.toString())}}}))}function nh(t,e,n,r){var o=t.start,i=t.end,a=n,s=n;return r>o[e].index&&(a=0),r>i[e].index&&(s=0),[a,s,!1]}var rh="insert_row";function oh(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.matrix,o=this.dataProvider,i=[e,0];Object(O.arrayEach)(r.cellReferences,(function(e){e.row>=t&&e.translateTo.apply(e,i)})),Object(O.arrayEach)(r.data,(function(r){var a=r.row,s=r.column;if(r.row>=t&&(r.translateTo.apply(r,i),r.setState(Nf.STATE_OUT_OFF_DATE)),n){var l=r.row,u=r.column,c=o.getSourceDataAtCell(l,u);if(yf(c)){var f=wf("row",t),h=new $f(c);h.useCustomModifier(ih),h.translate({row:e},f({row:a,column:s})),o.updateSourceData(l,u,h.toString())}}}))}function ih(t,e,n,r){var o=t.start,i=t.end,a=n,s=n;return r>o[e].index&&(a=0),r>i[e].index&&(s=0),[a,s,!1]}var ah="remove_column";function sh(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=-e,o=this.matrix,i=this.dataProvider,a=this.sheet,s=[0,r],l=Math.abs(r)-1,u=o.removeCellRefsAtRange({column:t},{column:t+l}),c=[];Object(O.arrayEach)(o.data,(function(e){Object(O.arrayEach)(u,(function(t){e.hasPrecedent(t)&&(e.removePrecedent(t),e.setState(Nf.STATE_OUT_OFF_DATE),Object(O.arrayEach)(a.getCellDependencies(e.row,e.column),(function(t){t.setState(Nf.STATE_OUT_OFF_DATE)})))})),e.column>=t&&e.column<=t+l&&c.push(e)})),o.remove(c),Object(O.arrayEach)(o.cellReferences,(function(e){e.column>=t&&e.translateTo.apply(e,s)})),Object(O.arrayEach)(o.data,(function(e){var o=e.row,a=e.column;if(e.column>=t&&(e.translateTo.apply(e,s),e.setState(Nf.STATE_OUT_OFF_DATE)),n){var l=e.row,u=e.column,c=i.getSourceDataAtCell(l,u);if(yf(c)){var f=wf("column",t),h=new $f(c);h.useCustomModifier(lh),h.translate({column:r},f({row:o,column:a})),i.updateSourceData(l,u,h.toString())}}}))}function lh(t,e,n,r){var o=t.start,i=t.end,a=t.type,s=o[e].index,l=i[e].index,u=Math.abs(n)-1,c=n,f=n,h=!1;return s>=r&&l<=r+u&&(h=!0),h||"cell"!==a||r>=s&&(c=0,f=0),h||"range"!==a||(r>=s&&(c=0),r>l?f=0:l<=r+u&&(f-=Math.min(l-(r+u),0))),s+c<0&&(c-=s+c),[c,f,h]}var uh="remove_row";function ch(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=-e,o=this.matrix,i=this.dataProvider,a=this.sheet,s=[r,0],l=Math.abs(r)-1,u=o.removeCellRefsAtRange({row:t},{row:t+l}),c=[];Object(O.arrayEach)(o.data,(function(e){Object(O.arrayEach)(u,(function(t){e.hasPrecedent(t)&&(e.removePrecedent(t),e.setState(Nf.STATE_OUT_OFF_DATE),Object(O.arrayEach)(a.getCellDependencies(e.row,e.column),(function(t){t.setState(Nf.STATE_OUT_OFF_DATE)})))})),e.row>=t&&e.row<=t+l&&c.push(e)})),o.remove(c),Object(O.arrayEach)(o.cellReferences,(function(e){e.row>=t&&e.translateTo.apply(e,s)})),Object(O.arrayEach)(o.data,(function(e){var o=e.row,a=e.column;if(e.row>=t&&(e.translateTo.apply(e,s),e.setState(Nf.STATE_OUT_OFF_DATE)),n){var l=e.row,u=e.column,c=i.getSourceDataAtCell(l,u);if(yf(c)){var f=wf("row",t),h=new $f(c);h.useCustomModifier(fh),h.translate({row:r},f({row:o,column:a})),i.updateSourceData(l,u,h.toString())}}}))}function fh(t,e,n,r){var o=t.start,i=t.end,a=t.type,s=o[e].index,l=i[e].index,u=Math.abs(n)-1,c=n,f=n,h=!1;return s>=r&&l<=r+u&&(h=!0),h||"cell"!==a||r>=s&&(c=0,f=0),h||"range"!==a||(r>=s&&(c=0),r>l?f=0:l<=r+u&&(f-=Math.min(l-(r+u),0))),s+c<0&&(c-=s+c),[c,f,h]}function hh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var dh=new Map;yh(Qf,o),yh(th,i),yh(rh,a),yh(ah,s),yh(uh,l);var ph=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sheet=e,this.hot=e.hot,this.dataProvider=e.dataProvider,this.matrix=e.matrix}var e,n,r;return e=t,(n=[{key:"prepareAlter",value:function(t){if(!dh.has(t))throw Error('Alter operation "'.concat(t,'" not exist.'));for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];dh.get(t).prepare.apply(this,n)}},{key:"triggerAlter",value:function(t){if(!dh.has(t))throw Error('Alter operation "'.concat(t,'" not exist.'));for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];dh.get(t).operate.apply(this,n),this.runLocalHooks.apply(this,["afterAlter"].concat(n))}},{key:"destroy",value:function(){this.sheet=null,this.hot=null,this.dataProvider=null,this.matrix=null}}])&&hh(e.prototype,n),r&&hh(e,r),t}();Object(j.mixin)(ph,Ze.a);var gh=ph,vh=function(){};function yh(t,e){dh.has(t)||dh.set(t,{prepare:e.prepare||vh,operate:e.operate||vh})}function mh(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function bh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var wh=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.t=Object(L.a)(this.hot),this.dataProvider=n,this.parser=new Of.Parser,this.matrix=new Bf(this.t),this.alterManager=new gh(this),this._processingCell=null,this._state=3,this.parser.on("callCellValue",(function(){return r._onCallCellValue.apply(r,arguments)})),this.parser.on("callRangeValue",(function(){return r._onCallRangeValue.apply(r,arguments)})),this.alterManager.addLocalHook("afterAlter",(function(){return r._onAfterAlter.apply(r,arguments)}))}var e,n,r;return e=t,(n=[{key:"recalculate",value:function(){switch(this._state){case 3:this.recalculateFull();break;case 2:this.recalculateOptimized()}}},{key:"recalculateOptimized",value:function(){var t=this,e=this.matrix.getOutOfDateCells();Object(O.arrayEach)(e,(function(e){var n=t.dataProvider.getSourceDataAtCell(e.row,e.column);yf(n)&&t.parseExpression(e,n.substr(1))})),this._state=1,this.runLocalHooks("afterRecalculate",e,"optimized")}},{key:"recalculateFull",value:function(){var t=this,e=this.dataProvider.getSourceDataByRange();this.matrix.reset(),Object(O.arrayEach)(e,(function(e,n){Object(O.arrayEach)(e,(function(e,r){yf(e)&&t.parseExpression(new Nf(n,r),e.substr(1))}))})),this._state=1,this.runLocalHooks("afterRecalculate",e,"full")}},{key:"setVariable",value:function(t,e){this.parser.setVariable(t,e)}},{key:"getVariable",value:function(t){return this.parser.getVariable(t)}},{key:"applyChanges",value:function(t,e,n){this.matrix.remove({row:t,column:e}),yf(n)&&this.parseExpression(new Nf(t,e),n.substr(1));var r=this.getCellDependencies.apply(this,mh(this.t.toVisual(t,e)));Object(O.arrayEach)(r,(function(t){t.setState(Nf.STATE_OUT_OFF_DATE)})),this._state=2}},{key:"parseExpression",value:function(t,e){t.setState(Nf.STATE_COMPUTING),this._processingCell=t;var n=this.parser.parse(bf(e)),r=n.error,o=n.result;yf(o)?this.parseExpression(t,o.substr(1)):(t.setValue(o),t.setError(r),t.setState(Nf.STATE_UP_TO_DATE)),this.matrix.add(t),this._processingCell=null}},{key:"getCellAt",value:function(t,e){return this.matrix.getCellAt(t,e)}},{key:"getCellDependencies",value:function(t,e){return this.matrix.getDependencies({row:t,column:e})}},{key:"_onCallCellValue",value:function(t,e){var n=t.row,r=t.column,o=new Hf(n,r);if(!this.dataProvider.isInDataRange(o.row,o.column))throw Error(Of.ERROR_REF);this.matrix.registerCellRef(o),this._processingCell.addPrecedent(o);var i=this.dataProvider.getRawDataAtCell(n.index,r.index);if(Object(Of.error)(i)){var a=this.matrix.getCellAt(n.index,r.index);if(a&&a.hasError())throw Error(i)}if(yf(i)){var s=this.parser.parse(i.substr(1)),l=s.error,u=s.result;if(l)throw Error(l);e(u)}else e(i)}},{key:"_onCallRangeValue",value:function(t,e,n){var r=this,o=t.row,i=t.column,a=e.row,s=e.column,l=this.dataProvider.getRawDataByRange(o.index,i.index,a.index,s.index);n(Object(O.arrayMap)(l,(function(t,e){return function(t,e){return Object(O.arrayMap)(t,(function(t,n){var a=o.index+e,s=i.index+n,l=new Hf(a,s);if(!r.dataProvider.isInDataRange(l.row,l.column))throw Error(Of.ERROR_REF);r.matrix.registerCellRef(l),r._processingCell.addPrecedent(l);var u=t;if(Object(Of.error)(u)){var c=r.matrix.getCellAt(l.row,l.column);if(c&&c.hasError())throw Error(u)}if(yf(u)){var f=r.parser.parse(u.substr(1)),h=f.error,d=f.result;if(h)throw Error(h);u=d}return u}))}(t,e)})))}},{key:"_onAfterAlter",value:function(){this.recalculateOptimized()}},{key:"destroy",value:function(){this.hot=null,this.t=null,this.dataProvider.destroy(),this.dataProvider=null,this.alterManager.destroy(),this.alterManager=null,this.parser=null,this.matrix.reset(),this.matrix=null}}])&&bh(e.prototype,n),r&&bh(e,r),t}();Object(j.mixin)(wh,Ze.a);var Oh=wh;function Ch(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Eh(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Sh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var kh=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=e,this.changes={},this.t=Object(L.a)(this.hot)}var e,n,r;return e=t,(n=[{key:"collectChanges",value:function(t,e,n){this.changes[this._coordId(t,e)]=n}},{key:"clearChanges",value:function(){this.changes={}}},{key:"isInDataRange",value:function(t,e){return t>=0&&t<this.hot.countRows()&&e>=0&&e<this.hot.countCols()}},{key:"getDataAtCell",value:function(t,e){var n=this._coordId.apply(this,Eh(this.t.toPhysical(t,e)));return Object(j.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getDataAtCell(t,e)}},{key:"getDataByRange",value:function(t,e,n,r){var o=this,i=this.hot.getData(t,e,n,r);return Object(O.arrayEach)(i,(function(n,r){Object(O.arrayEach)(n,(function(n,a){var s=o._coordId.apply(o,Eh(o.t.toPhysical(r+t,a+e)));Object(j.hasOwnProperty)(o.changes,s)&&(i[r][a]=o.changes[s])}))})),i}},{key:"getSourceDataAtCell",value:function(t,e){var n=this._coordId(t,e);return Object(j.hasOwnProperty)(this.changes,n)?this.changes[n]:this.hot.getSourceDataAtCell(t,e)}},{key:"getSourceDataByRange",value:function(t,e,n,r){return this.hot.getSourceDataArray(t,e,n,r)}},{key:"getRawDataAtCell",value:function(t,e){return this.getSourceDataAtCell.apply(this,Eh(this.t.toPhysical(t,e)))}},{key:"getRawDataByRange",value:function(t,e,n,r){var o=this,i=[];return Object(N.rangeEach)(t,n,(function(t){var n=[];Object(N.rangeEach)(e,r,(function(e){var r=Ch(o.t.toPhysical(t,e),2),i=r[0],a=r[1],s=o._coordId(i,a);Object(j.hasOwnProperty)(o.changes,s)?n.push(o.changes[s]):n.push(o.getSourceDataAtCell(i,a))})),i.push(n)})),i}},{key:"updateSourceData",value:function(t,e,n){this.hot.getSourceData()[t][this.hot.colToProp(e)]=n}},{key:"_coordId",value:function(t,e){return"".concat(t,":").concat(e)}},{key:"destroy",value:function(){this.hot=null,this.changes=null,this.t=null}}])&&Sh(e.prototype,n),r&&Sh(e,r),t}();function Rh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Th=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Rh(this,t),this.items=e}var e,n,r;return e=t,(n=[{key:"push",value:function(){var t;(t=this.items).push.apply(t,arguments)}},{key:"pop",value:function(){return this.items.pop()}},{key:"peek",value:function(){return this.isEmpty()?void 0:this.items[this.items.length-1]}},{key:"isEmpty",value:function(){return!this.size()}},{key:"size",value:function(){return this.items.length}}])&&_h(e.prototype,n),r&&_h(e,r),t}();function Mh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ah=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sheet=e,this.stack=new Th}var e,n,r;return e=t,(n=[{key:"save",value:function(t,e,n){var r=this.sheet,o=r.matrix,i=r.dataProvider,a=[];Object(O.arrayEach)(o.data,(function(r){var o=r.row,s=r.column;if(r[t]<e||r[t]>e+(n-1)){var l=i.getSourceDataAtCell(o,s);a.push({row:o,column:s,value:l})}})),this.stack.push({axis:t,index:e,amount:n,changes:a})}},{key:"restore",value:function(){var t=this.sheet,e=t.matrix,n=t.dataProvider,r=this.stack.pop(),o=r.axis,i=r.index,a=r.amount,s=r.changes;s&&Object(O.arrayEach)(s,(function(t){t[o]>i+(a-1)&&(t[o]-=a);var r=t.row,s=t.column,l=t.value;n.getSourceDataAtCell(r,s)!==l&&(n.updateSourceData(r,s,l),e.getCellAt(r,s).setState(Nf.STATE_OUT_OFF_DATE))}))}},{key:"destroy",value:function(){this.sheet=null,this.stack=null}}])&&Mh(e.prototype,n),r&&Mh(e,r),t}();function Nh(t){return(Nh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function xh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ih(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dh(t,e,n){return(Dh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ph(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ph(t){return(Ph=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lh(t,e){return(Lh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hh=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==Nh(e)&&"function"!=typeof e?Ih(t):e}(this,Ph(e).call(this,t))).eventManager=new m.a(Ih(n)),n.dataProvider=new kh(n.hot),n.sheet=new Oh(n.hot,n.dataProvider),n.undoRedoSnapshot=new Ah(n.sheet),n._skipRendering=!1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lh(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().formulas}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().formulas;Object(j.isObject)(n)&&Object(j.isObject)(n.variables)&&Object(j.objectEach)(n.variables,(function(e,n){return t.setVariable(n,e)})),this.addHook("afterColumnSort",(function(){return t.onAfterColumnSort.apply(t,arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData()})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("afterSetDataAtCell",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return t.onAfterSetDataAtCell.apply(t,arguments)})),this.addHook("beforeColumnSort",(function(){return t.onBeforeColumnSort.apply(t,arguments)})),this.addHook("beforeCreateCol",(function(){return t.onBeforeCreateCol.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(){return t.onBeforeCreateRow.apply(t,arguments)})),this.addHook("beforeRemoveCol",(function(){return t.onBeforeRemoveCol.apply(t,arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow.apply(t,arguments)})),this.addHook("beforeValidate",(function(){return t.onBeforeValidate.apply(t,arguments)})),this.addHook("beforeValueRender",(function(){return t.onBeforeValueRender.apply(t,arguments)})),this.addHook("modifyData",(function(){return t.onModifyData.apply(t,arguments)})),this.sheet.addLocalHook("afterRecalculate",(function(){return t.onSheetAfterRecalculate.apply(t,arguments)})),Dh(Ph(e.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){Dh(Ph(e.prototype),"disablePlugin",this).call(this)}},{key:"getCellValue",value:function(t,e){var n=this.sheet.getCellAt(t,e);return n?n.getError()||n.getValue():void 0}},{key:"hasComputedCellValue",value:function(t,e){return null!==this.sheet.getCellAt(t,e)}},{key:"recalculate",value:function(){this.sheet.recalculate()}},{key:"recalculateFull",value:function(){this.sheet.recalculateFull()}},{key:"recalculateOptimized",value:function(){this.sheet.recalculateOptimized()}},{key:"setVariable",value:function(t,e){this.sheet.setVariable(t,e)}},{key:"getVariable",value:function(t){return this.sheet.getVariable(t)}},{key:"onSheetAfterRecalculate",value:function(t){if(this._skipRendering)this._skipRendering=!1;else{var e=this.hot;Object(O.arrayEach)(t,(function(t){var n=t.row,r=t.column;e.validateCell(e.getDataAtCell(n,r),e.getCellMeta(n,r),(function(){}))})),e.render()}}},{key:"onModifyData",value:function(t,e,n,r){"get"===r&&this.hasComputedCellValue(t,e)?n.value=this.getCellValue(t,e):"set"===r&&yf(n.value)&&(n.value=bf(n.value))}},{key:"onBeforeValueRender",value:function(t){var e,n=t;return mf(n)&&(n=mf(e=n)?e.substr(1):e),n}},{key:"onBeforeValidate",value:function(t,e,n){var r=this.hot.propToCol(n),o=t;return this.hasComputedCellValue(e,r)&&(o=this.getCellValue(e,r)),o}},{key:"onAfterSetDataAtCell",value:function(t,e){var n=this;"loadData"!==e&&(this.dataProvider.clearChanges(),Object(O.arrayEach)(t,(function(t){var e=jh(t,4),r=e[0],o=e[1],i=e[2],a=e[3],s=n.hot.propToCol(o),l=n.t.toPhysicalRow(r),u=a;yf(u)&&(u=bf(u)),n.dataProvider.collectChanges(l,s,u),i!==u&&n.sheet.applyChanges(l,s,u)})),this.recalculate())}},{key:"onBeforeCreateRow",value:function(t,e,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateRow",value:function(t,e,n){this.sheet.alterManager.triggerAlter("insert_row",t,e,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveRow",value:function(t,e){this.undoRedoSnapshot.save("row",t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.sheet.alterManager.triggerAlter("remove_row",t,e)}},{key:"onBeforeCreateCol",value:function(t,e,n){"UndoRedo.undo"===n&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateCol",value:function(t,e,n){this.sheet.alterManager.triggerAlter("insert_column",t,e,"UndoRedo.undo"!==n)}},{key:"onBeforeRemoveCol",value:function(t,e){this.undoRedoSnapshot.save("column",t,e)}},{key:"onAfterRemoveCol",value:function(t,e){this.sheet.alterManager.triggerAlter("remove_column",t,e)}},{key:"onBeforeColumnSort",value:function(t,e){this.sheet.alterManager.prepareAlter("column_sorting",t,e)}},{key:"onAfterColumnSort",value:function(t,e){this.sheet.alterManager.triggerAlter("column_sorting",t,e)}},{key:"onAfterLoadData",value:function(){this._skipRendering=!0,this.recalculateFull()}},{key:"destroy",value:function(){this.dataProvider.destroy(),this.dataProvider=null,this.sheet.destroy(),this.sheet=null,Dh(Ph(e.prototype),"destroy",this).call(this)}}])&&xh(n.prototype,r),o&&xh(n,o),e}(W);Object(H.d)("formulas",Hh);var Fh=Hh;function Bh(t,e){return{name:t,days:7,daysBeforeFullWeeks:0,daysAfterFullWeeks:0,fullWeeks:1,index:e}}function Uh(t,e){var n=Wh(e[t].name),r=t>0?Wh(e[t-1].name):null,o=Wh(e[0].name),i=Wh(e[e.length-1].name);return t>0?"".concat(r,"/").concat(n):t===e.length-1?"".concat(n,"/").concat(o):"".concat(i,"/").concat(n)}function Wh(t){return t.substring(0,3)}function Vh(t){return zh(Array.isArray(t)?t[1]:t.startDate)}function Yh(t){return zh(Array.isArray(t)?t[2]:t.endDate)}function zh(t){var e=t;return null===e?null:e instanceof Date||"Invalid Date"!==(e=new Date(e)).toString()?e:null}function Gh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Xh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var qh=function(){function t(e){var n=e.year,r=e.allowSplitWeeks,o=void 0===r||r,i=e.hideDaysBeforeFullWeeks,a=void 0!==i&&i,s=e.hideDaysAfterFullWeeks,l=void 0!==s&&s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.year=n,this.firstWeekDay="monday",this.allowSplitWeeks=o,this.hideDaysBeforeFullWeeks=a,this.hideDaysAfterFullWeeks=l,this.weekSectionCount=0,this.monthListCache={},this.daysInColumns={},this.calculateWeekStructure()}var e,n,r;return e=t,(n=[{key:"setYear",value:function(t){this.year=t,this.monthListCache[t]=this.calculateMonthData(t),this.calculateWeekStructure(t)}},{key:"setFirstWeekDay",value:function(t){var e=t.toLowerCase();"monday"!==e&&"sunday"!==e&&Object(Ni.b)("First day of the week must be set to either Monday or Sunday"),this.firstWeekDay=e,this.calculateWeekStructure()}},{key:"countWeekSections",value:function(){return this.weekSectionCount}},{key:"getFirstWeekDay",value:function(){return this.firstWeekDay}},{key:"getYear",value:function(){return this.year}},{key:"getMonthList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.year;return this.monthListCache[t]||(this.monthListCache[t]=this.calculateMonthData(t)),this.monthListCache[t]}},{key:"getFullMonthList",value:function(){return this.monthListCache}},{key:"dateToColumn",value:function(t){var e=zh(t);if(!e)return!1;var n=e.getMonth(),r=e.getDate()-1,o=e.getFullYear();return this.getWeekColumn(r,n,o)}},{key:"getWeekColumn",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getYear(),r=null,o=this.getMonthCacheArray(e,n);return Object(O.arrayEach)(o,(function(e){if(Object(j.objectEach)(e,(function(e,n){if(e.indexOf(t+1)>-1)return r=parseInt(n,10),!1})),r)return!1})),r}},{key:"getMonthCacheArray",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear(),r=this.getMonthList(n),o=[];if(this.allowSplitWeeks)o.push(this.daysInColumns[n][t]);else{var i=-1;Object(j.objectEach)(this.daysInColumns[n],(function(a,s){var l=r[s];if(Object.keys(a).length>1&&(i+=1),i===t)return l.daysBeforeFullWeeks>0&&o.push(e.daysInColumns[n][parseInt(s,10)-1]),o.push(a),l.daysAfterFullWeeks>0&&o.push(e.daysInColumns[n][parseInt(s,10)+1]),!1}))}return o}},{key:"columnToDate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear(),n=null;Object(j.objectEach)(this.daysInColumns[e],(function(e,r){if(e[t])return n=r,!1}));var r=this.daysInColumns[e][n][t];if(1===r.length){var o=new Date(e,n,r[0]);return{start:o,end:o}}return{start:new Date(e,n,r[0]),end:new Date(e,n,r[r.length-1])}}},{key:"isOnTheEdgeOfWeek",value:function(t){var e=this,n=zh(t);if(!n)return null;var r=n.getMonth(),o=n.getDate()-1,i=n.getFullYear(),a=this.getMonthCacheArray(r,i),s=!1;return Object(O.arrayEach)(a,(function(t){if(Object(j.objectEach)(t,(function(t){if(!e.allowSplitWeeks&&7!==t.length&&(0===o||o===new Date(n.getYear(),n.getMonth()+1,0).getDate()-1))return!0;var r=t.indexOf(o+1);return 0===r?(s=[1,0],!1):r===t.length-1?(s=[0,1],!1):void 0})),s)return!1})),s}},{key:"generateHeaderSet",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.year,o=this.getMonthList(r),i=[];return Object(j.objectEach)(o,(function(o,a){var s=o.daysBeforeFullWeeks>0?1:0,l=o.daysAfterFullWeeks>0?1:0,u=n.hideDaysBeforeFullWeeks?0:s,c=n.hideDaysAfterFullWeeks?0:l,f=o.fullWeeks+(n.allowSplitWeeks?u+c:0),h=parseInt(a,10),d="";if("months"===t)i.push({label:o.name,colspan:f});else if("weeks"===t)for(var p=0;p<f;p++){var g=null,v=null;if(n.allowSplitWeeks||1!==o.fullWeeks){var y=Gh(n.getWeekColumnRange({monthObject:o,monthNumber:h,headerIndex:p,areDaysBeforeFullWeeksVisible:u,areDaysAfterFullWeeksVisible:c,headerCount:f,year:r}),2);g=y[0],v=y[1]}else{var m=Gh(n.getWeekColumnRange({monthObject:o,monthNumber:h,headerIndex:p,headerCount:f,areDaysBeforeFullWeeksVisible:u,areDaysAfterFullWeeksVisible:c,mixedMonth:!0,year:r}),2);g=m[0],v=m[1]}d=g===v?"".concat(g):"".concat(g," -  ").concat(v),i.push(e?e.call(n,g,v):d),n.addDaysToCache(h,i.length-1,g,v,r)}})),i}},{key:"getWeekColumnRange",value:function(t){var e=t.monthObject,n=t.monthNumber,r=t.headerIndex,o=t.headerCount,i=t.areDaysBeforeFullWeeksVisible,a=t.areDaysAfterFullWeeksVisible,s=t.mixedMonth,l=void 0!==s&&s,u=t.year,c=void 0===u?this.year:u,f=this.getMonthList(c),h=this.allowSplitWeeks,d=null,p=null;return l?0===n?d=31-(7-(p=f[n+1].daysBeforeFullWeeks))+1:n===f.length-1?(p=7-f[n-1].daysAfterFullWeeks,d=f[n-1].days-f[n-1].daysAfterFullWeeks+1):(p=f[n+1].daysBeforeFullWeeks,d=f[n-1].days-(7-p)+1):h&&i&&0===r?(d=r+1,p=e.daysBeforeFullWeeks):h&&a&&r===o-1?(d=e.days-e.daysAfterFullWeeks+1,p=e.days):(d=null,p=(d=h?e.daysBeforeFullWeeks+7*(r-i)+1:e.daysBeforeFullWeeks+7*r+1)+7-1),[d,p]}},{key:"addDaysToCache",value:function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getYear();if(this.daysInColumns[o]||(this.daysInColumns[o]={}),this.daysInColumns[o][t]||(this.daysInColumns[o][t]={}),this.daysInColumns[o][t][e]||(this.daysInColumns[o][t][e]=[]),n<=r)for(var i=n;i<=r;i++)this.daysInColumns[o][t][e].push(i);else{for(var a=t-1>=0?this.countMonthDays(t):31,s=n;s<=a;s++)this.daysInColumns[o][t][e].push(s);for(var l=1;l<=r;l++)this.daysInColumns[o][t][e].push(l)}}},{key:"isValidRangeBarData",value:function(t,e){var n=zh(t),r=zh(e);return n&&r&&n.getTime()<=r.getTime()}},{key:"calculateMonthData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.year;return[{name:"January",days:31},{name:"February",days:new Date(t,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}].slice(0)}},{key:"countMonths",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getYear();return this.monthListCache[t].length}},{key:"countMonthDays",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear();return this.monthListCache[e][t-1].days}},{key:"countMonthFullWeeks",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getYear();return this.monthListCache[e][t-1].fullWeeks}},{key:"calculateWeekStructure",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getYear();this.monthListCache[e]=this.calculateMonthData(e);var n=this.getFirstWeekDay(),r=this.getMonthList(e),o=[],i=this.hideDaysBeforeFullWeeks?0:1,a=this.hideDaysAfterFullWeeks?0:1,s=0,l=0;"monday"===n&&(s=1),Object(O.arrayEach)(r,(function(n,u){var c=new Date(e,u,1).getDay(),f=0;if(n.daysBeforeFullWeeks=(7-c+s)%7,!t.allowSplitWeeks&&n.daysBeforeFullWeeks&&(o.push(Bh(Uh(u,r),u)),f+=1),n.fullWeeks=Math.floor((n.days-n.daysBeforeFullWeeks)/7),n.daysAfterFullWeeks=n.days-n.daysBeforeFullWeeks-7*n.fullWeeks,t.allowSplitWeeks){var h=i*(n.daysBeforeFullWeeks?1:0),d=a*(n.daysAfterFullWeeks?1:0);l+=n.fullWeeks+h+d}else u===r.length-1&&n.daysAfterFullWeeks&&(o.push(Bh(Uh(u,r),null)),f+=1),l+=n.fullWeeks+f})),Object(O.arrayEach)(o,(function(n,r){var o=n.index;delete n.index,t.addMixedMonth(null===o?o:r+o,n,e)})),e===this.getYear()&&(this.weekSectionCount=l)}},{key:"addMixedMonth",value:function(t,e,n){null===t?this.monthListCache[n].push(e):this.monthListCache[n].splice(t,0,e)}}])&&Xh(e.prototype,n),r&&Xh(e,r),t}();function Kh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $h=function(){function t(e,n,r,o,i,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=n,this.chartInstance=e,this.chartPlugin=this.chartInstance.getPlugin("ganttChart"),this.hotSource=null,this.sourceHooks={},this.ongoingAsync=!1,this.applyData(n,r,o,i,a||!1)}var e,n,r;return e=t,(n=[{key:"applyData",value:function(t,e,n,r,o){if("[object Array]"===Object.prototype.toString.call(t))t.length>1&&this.chartInstance.alter("insert_row",0,t.length-1,"".concat(this.pluginName,".loadData")),this.loadData(t);else if(t instanceof this.chartInstance.constructor){var i=t.countRows();i>1&&this.chartInstance.alter("insert_row",0,i-1,"".concat(this.pluginName,".loadData")),this.bindWithHotInstance(t,e,n,r,o)}}},{key:"bindWithHotInstance",value:function(t,e,n,r,o){this.hotSource={instance:t,startColumn:e,endColumn:n,additionalData:r,asyncUpdates:o},this.addSourceHotHooks(),this.asyncCall(this.updateFromSource)}},{key:"asyncCall",value:function(t){var e=this;this.hotSource.asyncUpdates?(this.asyncStart(),setTimeout((function(){t.call(e),e.asyncEnd()}),0)):t.call(this)}},{key:"asyncStart",value:function(){this.ongoingAsync=!0}},{key:"asyncEnd",value:function(){this.ongoingAsync=!1}},{key:"addSourceHotHooks",value:function(){var t=this;this.sourceHooks={afterLoadData:function(){return t.onAfterSourceLoadData()},afterChange:function(e){return t.onAfterSourceChange(e)},afterColumnSort:function(){return t.onAfterColumnSort()}},this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData),this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange),this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"removeSourceHotHooks",value:function(t){this.sourceHooks.afterLoadData&&t.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData),this.sourceHooks.afterChange&&t.instance.removeHook("afterChange",this.sourceHooks.afterChange),this.sourceHooks.afterColumnSort&&t.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)}},{key:"getDataFromSource",value:function(t){var e,n={},r=this.hotSource,o=[];void 0===t?e=r.instance.getData(0,0,r.instance.countRows()-1,r.instance.countCols()-1):(e=[])[t]=r.instance.getDataAtRow(t);for(var i=function(t,i){n={};var a=e[t];if(null===a[r.startColumn]||""===a[r.startColumn])return"continue";Object(j.objectEach)(r.additionalData,(function(t,e){n[e]=a[t]})),o.push([t,a[r.startColumn],a[r.endColumn],n,t])},a=t||0,s=e.length;a<(t?t+1:s);a++)i(a);return o}},{key:"updateFromSource",value:function(t){var e=this.getDataFromSource(t);!t&&isNaN(t)&&(this.chartPlugin.clearRangeBars(),this.chartPlugin.clearRangeList()),this.loadData(e),this.chartInstance.render()}},{key:"loadData",value:function(t){var e=this,n=[];Object(O.arrayEach)(t,(function(t,r){t.row=r;var o=e.splitRangeIfNeeded(t);n=n.concat(o)})),Object(O.arrayEach)(n,(function(t){var n;e.chartPlugin.addRangeBar(t.row,Vh(t),Yh(t),(n=t,Array.isArray(n)?n[3]:n.additionalData)),delete t.row}))}},{key:"splitRangeIfNeeded",value:function(t){var e=[],n=new Date(Vh(t)),r=new Date(Yh(t));if("string"==typeof n||"string"==typeof r)return!1;var o=n.getFullYear(),i=r.getFullYear();return o===i?[t]:(Object(N.rangeEach)(o,i,(function(n){var r=Object(j.clone)(t);n!==o&&function(t,e){Array.isArray(t)?t[1]=e:t.startDate=e}(r,"01/01/".concat(n)),n!==i&&function(t,e){Array.isArray(t)?t[2]=e:t.endDate=e}(r,"12/31/".concat(n)),e.push(r)})),e)}},{key:"onAfterSourceChange",value:function(t){var e=this;this.asyncCall((function(){if(t){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r],a=parseInt(i[0],10),s=parseInt(i[1],10);n[a]||(n[a]={}),n[a][s]=[i[2],i[3]]}Object(j.objectEach)(n,(function(t,n){var r=parseInt(n,10);e.chartPlugin.getRangeBarCoordinates(r)&&e.chartPlugin.removeRangeBarByColumn(r,e.chartPlugin.rangeList[r][1]),e.updateFromSource(n)}))}}))}},{key:"onAfterSourceLoadData",value:function(){var t=this;this.asyncCall((function(){t.chartPlugin.removeAllRangeBars(),t.updateFromSource()}))}},{key:"onAfterColumnSort",value:function(){var t=this;this.asyncCall((function(){t.chartPlugin.removeAllRangeBars(),t.updateFromSource()}))}}])&&Kh(e.prototype,n),r&&Kh(e,r),t}();function Qh(t){return(Qh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jh(t,e){return!e||"object"!==Qh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function td(t,e,n){return(td="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ed(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ed(t){return(ed=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nd(t,e){return(nd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rd=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Jh(this,ed(e).call(this,t))).settings={},n.dateCalculator=null,n.currentYear=null,n.monthList=[],n.monthHeadersArray=[],n.weekHeadersArray=[],n.rangeBars={},n.rangeList={},n.nestedHeadersPlugin=null,n.hotSource=null,n.overallWeekSectionCount=null,n.initialSettings=null,n.dataFeed=null,n.colorData={},n.rangeBarMeta=Object.create(null),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nd(t,e)}(e,t),n=e,(r=[{key:"checkDependencies",value:function(){this.hot.getSettings().colHeaders||Object(Ni.b)("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")}},{key:"isEnabled",value:function(){return!!this.hot.getSettings().ganttChart}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.checkDependencies(),this.parseSettings(),this.currentYear=this.settings.startYear||(new Date).getFullYear(),this.dateCalculator=new qh({year:this.currentYear,allowSplitWeeks:this.settings.allowSplitWeeks,hideDaysBeforeFullWeeks:this.settings.hideDaysBeforeFullWeeks,hideDaysAfterFullWeeks:this.settings.hideDaysAfterFullWeeks}),this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay),this.monthList=this.dateCalculator.getMonthList(),this.monthHeadersArray=this.generateMonthHeaders(),this.weekHeadersArray=this.generateWeekHeaders(),this.overallWeekSectionCount=this.dateCalculator.countWeekSections(),this.assignGanttSettings(),this.nestedHeadersPlugin&&(this.applyDataSource(),this.colorData&&this.setRangeBarColors(this.colorData)),this.addHook("afterInit",(function(){return t.onAfterInit()})),Object(w.addClass)(this.hot.rootElement,"ganttChart"),td(ed(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.internalUpdateSettings||(this.dataFeed&&this.dataFeed.hotSource&&this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource),this.settings={},this.dataFeed={},this.currentYear=null,this.monthList=[],this.rangeBars={},this.rangeList={},this.rangeBarMeta={},this.hotSource=null,this.deassignGanttSettings(),Object(w.removeClass)(this.hot.rootElement,"ganttChart"),td(ed(e.prototype),"disablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),td(ed(e.prototype),"updatePlugin",this).call(this)}},{key:"parseSettings",value:function(){this.settings=this.hot.getSettings().ganttChart,"boolean"==typeof this.settings&&(this.settings={}),this.settings.firstWeekDay||(this.settings.firstWeekDay="monday"),void 0===this.settings.allowSplitWeeks&&(this.settings.allowSplitWeeks=!0),"function"!=typeof this.settings.weekHeaderGenerator&&(this.settings.weekHeaderGenerator=null)}},{key:"applyDataSource",value:function(){if(this.settings.dataSource){var t=this.settings.dataSource;t.instance?this.loadData(t.instance,t.startDateColumn,t.endDateColumn,t.additionalData,t.asyncUpdates):this.loadData(t)}}},{key:"loadData",value:function(t,e,n,r,o){this.dataFeed=new $h(this.hot,t,e,n,r,o),this.hot.render()}},{key:"clearRangeBars",value:function(){this.rangeBars={}}},{key:"clearRangeList",value:function(){this.rangeList={}}},{key:"getRangeBarCoordinates",value:function(t){return this.rangeList[t]}},{key:"generateMonthHeaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentYear;return this.dateCalculator.generateHeaderSet("months",this.settings.weekHeaderGenerator,t)}},{key:"generateWeekHeaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentYear;return this.dateCalculator.generateHeaderSet("weeks",this.settings.weekHeaderGenerator,t)}},{key:"assignGanttSettings",value:function(){var t=this;this.initialSettings=Object(j.deepClone)(this.hot.getSettings());var e={data:Object(R.createEmptySpreadsheetData)(1,this.overallWeekSectionCount),readOnly:!0,renderer:function(e,n,r,o,i,a,s){return t.uniformBackgroundRenderer(e,n,r,o,i,a,s)},colWidths:60,hiddenColumns:!this.hot.getSettings().hiddenColumns||this.hot.getSettings().hiddenColumns,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:!this.hot.getSettings().collapsibleColumns||this.hot.getSettings().collapsibleColumns,columnSorting:!1,copyPaste:!1};this.internalUpdateSettings=!0,this.hot.updateSettings(e),this.internalUpdateSettings=void 0}},{key:"deassignGanttSettings",value:function(){this.internalUpdateSettings=!0,this.initialSettings&&this.hot.updateSettings(this.initialSettings),this.internalUpdateSettings=void 0}},{key:"cacheRangeBarMeta",value:function(t,e,n,r){this.rangeBarMeta[t]||(this.rangeBarMeta[t]={}),this.rangeBarMeta[t][e]||(this.rangeBarMeta[t][e]={}),this.rangeBarMeta[t][e][n]=r}},{key:"applyRangeBarMetaCache",value:function(){var t=this;Object(j.objectEach)(this.rangeBarMeta,(function(e,n){Object(j.objectEach)(e,(function(e,r){Object(j.objectEach)(e,(function(e,o){t.hot.setCellMeta(n,r,o,e)}))}))}))}},{key:"getAdjacentWeekColumn",value:function(t,e,n){var r=zh(t),o=!0===n?-7:7,i=r.setDate(r.getDate()+o);return this.dateCalculator.dateToColumn(i)}},{key:"addRangeBar",value:function(t,e,n,r){var o=this;null!==e&&null!==n&&this.prepareDaysInColumnsInfo(zh(e),zh(n));var i,a=this.dateCalculator.dateToColumn(e),s=this.dateCalculator.dateToColumn(n),l=(i=zh(e))?i.getFullYear():null,u=!1,c=!1;return null===a&&this.settings.hideDaysBeforeFullWeeks&&!1!==(a=this.getAdjacentWeekColumn(e,!0,!1))&&(u=!0),null===s&&this.settings.hideDaysAfterFullWeeks&&!1!==(s=this.getAdjacentWeekColumn(n,!1,!0))&&(c=!0),!(!this.dateCalculator.isValidRangeBarData(e,n)||!1===a||!1===s)&&(this.rangeBars[l]||(this.rangeBars[l]={}),this.rangeBars[l][t]||(this.rangeBars[l][t]={}),this.rangeBars[l][t][a]={barLength:s-a+1,partialStart:!u&&!this.dateCalculator.isOnTheEdgeOfWeek(e)[0],partialEnd:!c&&!this.dateCalculator.isOnTheEdgeOfWeek(n)[1],additionalData:{}},Object(j.objectEach)(r,(function(e,n){o.rangeBars[l][t][a].additionalData[n]=e})),l===this.dateCalculator.getYear()&&(this.colorData[t]&&(this.rangeBars[l][t][a].colors=this.colorData[t]),this.rangeList[t]=[t,a],this.renderRangeBar(t,a,s,r)),[t,a])}},{key:"prepareDaysInColumnsInfo",value:function(t,e){for(var n=t.getFullYear();n<=e.getFullYear();n++)void 0===this.dateCalculator.daysInColumns[n]&&(this.dateCalculator.calculateWeekStructure(n),this.dateCalculator.generateHeaderSet("weeks",null,n))}},{key:"getRangeBarData",value:function(t,e){var n=this.dateCalculator.getYear(),r=this.getRangeBarCoordinates(t);if(!r)return!1;var o=this.rangeBars[n][r[0]][r[1]];return!(!o||t!==r[0]||!(e===r[1]||e>r[1]&&e<r[1]+o.barLength))&&o}},{key:"updateRangeBarData",value:function(t,e,n){var r=this.getRangeBarData(t,e);Object(j.objectEach)(n,(function(t,e){r[e]!==t&&(r[e]=t)}))}},{key:"renderRangeBar",value:function(t,e,n){for(var r=this.dateCalculator.getYear(),o=this.rangeBars[r][t][e],i=e;i<=n;i++){var a=this.hot.getCellMeta(t,i),s="".concat(a.className||""," rangeBar");(i===e&&o.partialStart||i===n&&o.partialEnd)&&(s+=" partial"),i===n&&(s+=" last"),this.hot.setCellMeta(t,i,"originalClassName",a.className),this.hot.setCellMeta(t,i,"className",s),this.hot.setCellMeta(t,i,"additionalData",o.additionalData),this.cacheRangeBarMeta(t,i,"originalClassName",a.className),this.cacheRangeBarMeta(t,i,"className",s),this.cacheRangeBarMeta(t,i,"additionalData",o.additionalData)}}},{key:"removeRangeBarByDate",value:function(t,e){var n=this.dateCalculator.dateToColumn(e);this.removeRangeBarByColumn(t,n)}},{key:"removeRangeBarByColumn",value:function(t,e){var n=this,r=this.dateCalculator.getYear(),o=this.rangeBars[r][t][e];o&&(this.unrenderRangeBar(t,e,e+o.barLength-1),this.rangeBars[r][t][e]=null,Object(j.objectEach)(this.rangeList,(function(r,o){var i=parseInt(o,10);JSON.stringify(r)===JSON.stringify([t,e])&&(n.rangeList[i]=null)})))}},{key:"removeAllRangeBars",value:function(){var t=this;Object(j.objectEach)(this.rangeBars,(function(e,n){Object(j.objectEach)(e,(function(e,r){t.removeRangeBarByColumn(n,r)}))}))}},{key:"unrenderRangeBar",value:function(t,e,n){for(var r=e;r<=n;r++){var o=this.hot.getCellMeta(t,r);this.hot.setCellMeta(t,r,"className",o.originalClassName),this.hot.setCellMeta(t,r,"originalClassName",void 0),this.cacheRangeBarMeta(t,r,"className",o.originalClassName),this.cacheRangeBarMeta(t,r,"originalClassName",void 0)}this.hot.render()}},{key:"uniformBackgroundRenderer",value:function(t,e,n,r,o,i,a){var s=this.getRangeBarData(n,r),l=this.getRangeBarCoordinates(n);e.innerHTML="",a.className&&(e.className=a.className);var u="";Object(j.objectEach)(a.additionalData,(function(t,e){u+="".concat(e,": ").concat(t,"\n")})),u=u.replace(/\n$/,""),e.title=u,s&&s.colors?r===l[1]&&s.partialStart||r===l[1]+s.barLength-1&&s.partialEnd?e.style.background=s.colors[1]:e.style.background=s.colors[0]:e.style.background=""}},{key:"setRangeBarColors",value:function(t){var e=this;this.colorData=t,Object(j.objectEach)(t,(function(t,n){var r=e.getRangeBarCoordinates(n);r&&e.updateRangeBarData(r[0],r[1],{colors:t})})),this.hot.render()}},{key:"setYear",value:function(t){var e=Object(j.extend)(this.hot.getSettings().ganttChart,{startYear:t});this.hot.updateSettings({ganttChart:e})}},{key:"onAfterInit",value:function(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.applyDataSource()}},{key:"onUpdateSettings",value:function(){this.internalUpdateSettings?this.applyRangeBarMetaCache():td(ed(e.prototype),"onUpdateSettings",this).call(this)}},{key:"destroy",value:function(){this.hotSource&&this.dataFeed.removeSourceHotHooks(this.hotSource),td(ed(e.prototype),"destroy",this).call(this)}}])&&Zh(n.prototype,r),o&&Zh(n,o),e}(W);Object(H.d)("ganttChart",rd);var od=rd;function id(t){return(id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ad(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function sd(t,e){return!e||"object"!==id(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ld(t,e,n){return(ld="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ud(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ud(t){return(ud=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cd(t,e){return(cd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fd=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=sd(this,ud(e).call(this,t))).settings=null,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cd(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().headerTooltips}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().headerTooltips,this.parseSettings(),this.addHook("afterGetColHeader",(function(e,n){return t.onAfterGetHeader(e,n)})),this.addHook("afterGetRowHeader",(function(e,n){return t.onAfterGetHeader(e,n)})),ld(ud(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.clearTitleAttributes(),ld(ud(e.prototype),"disablePlugin",this).call(this)}},{key:"parseSettings",value:function(){"boolean"==typeof this.settings&&(this.settings={rows:!0,columns:!0,onlyTrimmed:!1})}},{key:"clearTitleAttributes",value:function(){var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay,o=r?r.clone.wtTable.THEAD:null;Object(N.rangeEach)(0,t-1,(function(t){var r=e.childNodes[t],i=n.childNodes[t],a=o?o.childNodes[t]:null;Object(N.rangeEach)(0,r.childNodes.length-1,(function(t){r.childNodes[t].removeAttribute("title"),i&&i.childNodes[t]&&i.childNodes[t].removeAttribute("title"),o&&a&&a.childNodes[t]&&a.childNodes[t].removeAttribute("title")}))}),!0)}},{key:"onAfterGetHeader",value:function(t,e){var n=e.querySelector("span"),r="THEAD"===e.parentNode.parentNode.nodeName;(r&&this.settings.columns||!r&&this.settings.rows)&&(this.settings.onlyTrimmed?Object(w.outerWidth)(n)>=Object(w.outerWidth)(e)&&0!==Object(w.outerWidth)(n)&&e.setAttribute("title",n.textContent):e.setAttribute("title",n.textContent))}},{key:"destroy",value:function(){this.settings=null,ld(ud(e.prototype),"destroy",this).call(this)}}])&&ad(n.prototype,r),o&&ad(n,o),e}(W);Object(H.d)("headerTooltips",fd);var hd=fd;function dd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var pd=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nestedHeaders=e,this.container=void 0,this.widthsCache=[]}var e,n,r;return e=t,(n=[{key:"buildWidthsMapper",value:function(){this.container=this.nestedHeaders.hot.rootDocument.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);for(var t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length,n=0;n<e;n++)this.widthsCache.push(t[n].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(t){for(var e=this.nestedHeaders.hot.rootDocument,n=e.createDocumentFragment(),r=e.createElement("table"),o=!1,i=!!this.nestedHeaders.hot.getSettings().dropdownMenu,a=this.nestedHeaders.colspanArray.length,s=this.nestedHeaders.hot.countCols(),l=a-1,u=0;u<a;u++){var c=e.createElement("tr");o=!1;for(var f=0;f<s;f++){var h=e.createElement("th"),d=Object(j.clone)(this.nestedHeaders.colspanArray[u][f]);d&&!d.hidden&&(u===l&&(d.colspan>1&&(o=!0),i&&(d.label+='<button class="changeType"></button>')),Object(w.fastInnerHTML)(h,d.label),h.colSpan=d.colspan,c.appendChild(h))}r.appendChild(c)}if(o){for(var p=e.createElement("tr"),g=0;g<s;g++){var v=e.createElement("th");p.appendChild(v)}r.appendChild(p)}n.appendChild(r),t.appendChild(n)}},{key:"clear",value:function(){this.container=null,this.widthsCache.length=0}}])&&dd(e.prototype,n),r&&dd(e,r),t}();function gd(t){return(gd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vd(){var t=md(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\n                is currently not supported and might result in glitches."]);return vd=function(){return t},t}function yd(){var t=md(["You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual\n          glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns."]);return yd=function(){return t},t}function md(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function bd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Od(t,e,n){return(Od="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Cd(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Cd(t){return(Cd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ed(t,e){return(Ed=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sd=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==gd(e)&&"function"!=typeof e?wd(t):e}(this,Cd(e).call(this,t))).settings=[],n.columnHeaderLevelCount=0,n.colspanArray=[],n.ghostTable=new pd(wd(n)),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ed(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings().nestedHeaders,this.addHook("afterGetColumnHeaderRenderers",(function(e){return t.onAfterGetColumnHeaderRenderers(e)})),this.addHook("afterInit",(function(){return t.onAfterInit()})),this.addHook("afterOnCellMouseDown",(function(e,n){return t.onAfterOnCellMouseDown(e,n)})),this.addHook("beforeOnCellMouseOver",(function(e,n,r,o){return t.onBeforeOnCellMouseOver(e,n,r,o)})),this.addHook("afterViewportColumnCalculatorOverride",(function(e){return t.onAfterViewportColumnCalculatorOverride(e)})),this.addHook("modifyColWidth",(function(e,n){return t.onModifyColWidth(e,n)})),this.setupColspanArray(),this.checkForFixedColumnsCollision(),this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0,Od(Cd(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearColspans(),this.settings=[],this.columnHeaderLevelCount=0,this.colspanArray=[],this.ghostTable.clear(),Od(Cd(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Od(Cd(e.prototype),"updatePlugin",this).call(this),this.ghostTable.buildWidthsMapper()}},{key:"clearColspans",value:function(){if(this.hot.view)for(var t=this.hot.view.wt.getSetting("columnHeaders").length,e=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,o=0;o<t;o++){var i=e.childNodes[o];if(!i)break;for(var a=n.childNodes[o],s=r?r.childNodes[o]:null,l=0,u=i.childNodes.length;l<u;l++)i.childNodes[l].removeAttribute("colspan"),a&&a.childNodes[l]&&a.childNodes[l].removeAttribute("colspan"),r&&s&&s.childNodes[l]&&s.childNodes[l].removeAttribute("colspan")}}},{key:"checkForFixedColumnsCollision",value:function(){var t=this,e=this.hot.getSettings().fixedColumnsLeft;Object(O.arrayEach)(this.colspanArray,(function(n,r){t.getNestedParent(r,e)!==e&&Object(Ni.b)(Object(Ei.a)(yd()))}))}},{key:"checkForOverlappingHeaders",value:function(){var t=this;Object(O.arrayEach)(this.colspanArray,(function(e,n){Object(O.arrayEach)(t.colspanArray[n],(function(e,r){if(e.colspan>1){var o=t.levelToRowCoords(n),i=t.getChildHeaders(o,r);if(i.length>0){var a=0;return Object(O.arrayEach)(i,(function(e){a+=t.getColspan(o+1,e)})),a>e.colspan&&Object(Ni.b)(Object(Ei.a)(vd())),!1}}}))}))}},{key:"setupColspanArray",value:function(){var t=this;Object(j.objectEach)(this.settings,(function(e,n){Object(j.objectEach)(e,(function(e,r,o){var i,a;if((i=t.colspanArray)[a=n]||(i[a]=[]),void 0===o[r].colspan)t.colspanArray[n].push({label:o[r]||"",colspan:1,hidden:!1});else{var s=o[r].colspan||1;t.colspanArray[n].push({label:o[r].label||"",colspan:s,hidden:!1}),t.fillColspanArrayWithDummies(s,n)}}))}))}},{key:"fillColspanArrayWithDummies",value:function(t,e){var n=this;Object(N.rangeEach)(0,t-2,(function(){n.colspanArray[e].push({label:"",colspan:1,hidden:!0})}))}},{key:"headerRendererFactory",value:function(t){var e=this;return function(n,r){var o=e.hot.rootDocument;if(r.removeAttribute("colspan"),Object(w.removeClass)(r,"hiddenHeader"),e.colspanArray[t][n]&&e.colspanArray[t][n].colspan){var i=e.colspanArray[t][n].colspan,a=e.hot.getSettings().fixedColumnsLeft||0,s=e.hot.view.wt.wtOverlays,l=s.leftOverlay,u=s.topLeftCornerOverlay,c=!!u&&u.clone.wtTable.THEAD.contains(r),f=!!l&&l.clone.wtTable.THEAD.contains(r);i>1&&r.setAttribute("colspan",c||f?Math.min(i,a-n):i),(c||f&&n===a-1)&&Object(w.addClass)(r,"overlayEdge")}e.colspanArray[t][n]&&e.colspanArray[t][n].hidden&&Object(w.addClass)(r,"hiddenHeader"),Object(w.empty)(r);var h=o.createElement("DIV");Object(w.addClass)(h,"relative");var d=o.createElement("SPAN");Object(w.addClass)(d,"colHeader"),Object(w.fastInnerHTML)(d,e.colspanArray[t][n]&&e.colspanArray[t][n].label||""),h.appendChild(d),r.appendChild(h),e.hot.runHooks("afterGetColHeader",n,r)}}},{key:"getColspan",value:function(t,e){var n=this.colspanArray[this.rowCoordsToLevel(t)][e];return n?n.colspan:1}},{key:"levelToRowCoords",value:function(t){return t-this.columnHeaderLevelCount}},{key:"rowCoordsToLevel",value:function(t){return t+this.columnHeaderLevelCount}},{key:"getNestedParent",value:function(t,e){if(t<0)return!1;var n=this.colspanArray[t][e]?this.colspanArray[t][e].colspan:1,r=!!this.colspanArray[t][e]&&this.colspanArray[t][e].hidden;if(n>1||1===n&&!1===r)return e;var o=e-1;do{if(this.colspanArray[t][o].colspan>1)break;o-=1}while(e>=0);return o}},{key:"getChildHeaders",value:function(t,e){var n=this.rowCoordsToLevel(t),r=this.colspanArray[n+1],o=this.getNestedParent(n,e),i=this.colspanArray[n][e].colspan,a=[];return r?(Object(N.rangeEach)(o,o+i-1,(function(t){r[t]&&r[t].colspan>1&&(i-=r[t].colspan-1),r[t]&&!r[t].hidden&&-1===a.indexOf(t)&&a.push(t)})),a):a}},{key:"fillTheRemainingColspans",value:function(){var t=this;Object(j.objectEach)(this.settings,(function(e,n){Object(N.rangeEach)(t.colspanArray[n].length-1,t.hot.countCols()-1,(function(r){t.colspanArray[n].push({label:e[r]||"",colspan:1,hidden:!1})}),!0)}))}},{key:"updateHeadersHighlight",value:function(){var t=this,e=this.hot.getSelectedLast();if(void 0!==e){var n=this.hot.view.wt.wtOverlays,r=this.hot.selection.isSelectedByColumnHeader(),o=Math.min(e[1],e[3]),i=Math.max(e[1],e[3]),a=r?-1:this.columnHeaderLevelCount-1,s=[],l=function(t){return function(e,n){return function(){return n(e,t)}}},u=l("ht__highlight"),c=l("ht__active_highlight");Object(N.rangeEach)(o,i,(function(e){for(var l=function(l){var f=t.getNestedParent(l,e),h=[n.topOverlay?n.topOverlay.clone.wtTable.getColumnHeader(f,l):void 0,n.topLeftCornerOverlay?n.topLeftCornerOverlay.clone.wtTable.getColumnHeader(f,l):void 0],d=t.getColspan(l-t.columnHeaderLevelCount,f),p=f>=o&&f+d-1<=i;Object(O.arrayEach)(h,(function(t){if(void 0===t)return!1;!r&&l<a||r&&!p?(s.push(u(t,w.removeClass)),r&&s.push(c(t,w.removeClass))):(s.push(u(t,w.addClass)),r&&s.push(c(t,w.addClass)))}))},f=t.columnHeaderLevelCount-1;f>-1;f--)l(f)})),Object(O.arrayEach)(s,(function(t){t()})),s.length=0}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){var e=this,n=t.startColumn;Object(N.rangeEach)(0,Math.max(this.columnHeaderLevelCount-1,0),(function(r){var o=e.getNestedParent(r,t.startColumn);o<t.startColumn&&(n=Math.min(n,o))})),t.startColumn=n}},{key:"onAfterOnCellMouseDown",value:function(t,e){if(e.row<0){var n=this.getColspan(e.row,e.col),r=e.col+n-1;if(n>1){var o=this.hot.countRows()-1;this.hot.selection.setRangeEnd(new rt.a(o,r))}}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){if(!(e.row>=0||e.col<0)&&this.hot.view.isMouseDown()){var o=this.hot.getSelectedRangeLast(),i=o.from,a=o.to,s=this.getColspan(e.row,e.col),l=e.col+s-1,u=!1;if(i.col<=a.col?(e.col<i.col&&l===a.col||e.col<i.col&&l<i.col||e.col<i.col&&l>=i.col&&l<a.col)&&(u=!0):(e.col<a.col&&l>i.col||e.col>i.col||e.col<=a.col&&l>i.col||e.col>a.col&&l>i.col)&&(u=!0),u){var c=[a.col,i.col];i.col=c[0],a.col=c[1]}if(s>1){var f;r.column=!0,r.cell=!0;var h=[];i.col===a.col&&(l<=i.col&&e.col<i.col?h.push(a.col,e.col):h.push(e.col<i.col?e.col:i.col,l>a.col?l:a.col)),i.col<a.col&&h.push(e.col<i.col?e.col:i.col,l),i.col>a.col&&h.push(i.col,e.col),(f=this.hot).selectColumns.apply(f,h)}}}},{key:"onAfterInit",value:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length,this.fillTheRemainingColspans(),this.checkForOverlappingHeaders(),this.ghostTable.buildWidthsMapper()}},{key:"onAfterGetColumnHeaderRenderers",value:function(t){if(t){t.length=0;for(var e=this.colspanArray.length-1;e>=0;e--)t.push(this.headerRendererFactory(e));t.reverse()}this.updateHeadersHighlight()}},{key:"onModifyColWidth",value:function(t,e){var n=this.ghostTable.widthsCache[e];return t>n?t:n}},{key:"destroy",value:function(){this.settings=null,this.columnHeaderLevelCount=null,this.colspanArray=null,Od(Cd(e.prototype),"destroy",this).call(this)}}])&&bd(n.prototype,r),o&&bd(n,o),e}(W);Object(H.d)("nestedHeaders",Sd);var kd=Sd;function Rd(t){return(Rd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Td=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=n,this.data=r,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},this.recordTranslator=Object(L.a)(this.hot)}var e,n,r;return e=t,(n=[{key:"rewriteCache",value:function(){var t=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Object(N.rangeEach)(0,this.data.length-1,(function(e){t.cacheNode(t.data[e],0,null)}))}},{key:"cacheNode",value:function(t,e,n){var r=this;this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&Object(O.arrayEach)(t.__children,(function(n){r.cacheNode(n,e+1,t)}))}},{key:"getDataObject",value:function(t){return null==t?null:this.cache.rows[t]}},{key:"readTreeNodes",value:function(t,e,n,r){var o=this,i=!1,a=e;if(isNaN(a)&&a.end)return a;var s=t;return s||(s={__children:this.data},i=!0,a-=1),null!=n&&a===n?{result:s,end:!0}:null!=r&&s===r?{result:a,end:!0}:(a+=1,s.__children&&Object(O.arrayEach)(s.__children,(function(t){if(o.parentReference.set(t,i?null:s),a=o.readTreeNodes(t,a,n,r),isNaN(a)&&a.end)return!1})),a)}},{key:"updateParentReference",value:function(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())}},{key:"mockParent",value:function(){var t=this.mockNode();return t.__children=this.data,t}},{key:"mockNode",value:function(){var t={};return Object(j.objectEach)(this.data[0],(function(e,n){t[n]=null})),t}},{key:"getRowIndex",value:function(t){return null==t?null:this.cache.nodeInfo.get(t).row}},{key:"getRowIndexWithinParent",value:function(t){var e=null;e=isNaN(t)?t:this.getDataObject(t);var n=this.getRowParent(t);return null==n?this.data.indexOf(e):n.__children.indexOf(e)}},{key:"countAllRows",value:function(){var t={__children:this.data};return this.countChildren(t)}},{key:"countChildren",value:function(t){var e=this,n=0,r=t;return isNaN(r)||(r=this.getDataObject(r)),r&&r.__children?(Object(O.arrayEach)(r.__children,(function(t){n+=1,t.__children&&(n+=e.countChildren(t))})),n):0}},{key:"getRowParent",value:function(t){var e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}},{key:"getRowObjectParent",value:function(t){return"object"!==Rd(t)?null:this.cache.nodeInfo.get(t).parent}},{key:"getRowLevel",value:function(t){var e=null;return(e=isNaN(t)?t:this.getDataObject(t))?this.getRowObjectLevel(e):null}},{key:"getRowObjectLevel",value:function(t){return null==t?null:this.cache.nodeInfo.get(t).level}},{key:"hasChildren",value:function(t){var e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}},{key:"isParent",value:function(t){var e=t;return isNaN(e)||(e=this.getDataObject(e)),!!Object(j.hasOwnProperty)(e,"__children")}},{key:"addChild",value:function(t,e){var n=e;this.hot.runHooks("beforeAddChild",t,n);var r=null;t&&(r=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(t)+1,1);var o=t;t||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.push(n),this.rewriteCache();var i=this.getRowIndex(n);this.hot.runHooks("afterCreateRow",i,1),this.hot.runHooks("afterAddChild",t,n)}},{key:"addChildAtIndex",value:function(t,e,n,r){var o=n;this.hot.runHooks("beforeAddChild",t,o,e),this.hot.runHooks("beforeCreateRow",r+1,1);var i=t;t||(i=this.mockParent()),i.__children||(i.__children=[]),o||(o=this.mockNode()),i.__children.splice(e,null,o),this.rewriteCache(),this.hot.runHooks("afterCreateRow",r+1,1),this.hot.runHooks("afterAddChild",t,o,e)}},{key:"addSibling",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(t),r=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(e){case"below":this.addChildAtIndex(r,o+1,null,t);break;case"above":this.addChildAtIndex(r,o,null,t)}}},{key:"detachFromParent",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=null,o=[];Array.isArray(t)?(Object(N.rangeEach)(t[0],t[2],(function(t){var n=e.translateTrimmedRow(t);o.push(e.getDataObject(n))})),Object(N.rangeEach)(0,o.length-2,(function(t){e.detachFromParent(o[t],!1)})),r=o[o.length-1]):r=t;var i=this.getRowIndex(r),a=this.getRowIndexWithinParent(r),s=this.getRowParent(r),l=this.getRowParent(s),u=this.getRowIndex(l),c=null;this.hot.runHooks("beforeDetachChild",s,r),null!=a&&(this.hot.runHooks("beforeRemoveRow",i,1,[i],this.plugin.pluginName),s.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,1,[i],this.plugin.pluginName),l?(c=u+this.countChildren(l),this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName),l.__children.push(r)):(c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName),this.data.push(r))),this.rewriteCache(),this.hot.runHooks("afterCreateRow",c,1,this.plugin.pluginName),n&&this.hot.render(),this.hot.runHooks("afterDetachChild",s,r)}},{key:"filterData",value:function(t,e,n){var r=this,o=[];Object(O.arrayEach)(n,(function(t){o.push(r.getDataObject(t))})),Object(O.arrayEach)(o,(function(t){var e=r.getRowIndexWithinParent(t),n=r.getRowParent(t);null===n?r.data.splice(e,1):n.__children.splice(e,1)})),this.rewriteCache()}},{key:"spliceData",value:function(t,e,n){var r=this.translateTrimmedRow(t);if(null!=r){var o=this.getDataObject(r-1),i=null,a=null;o&&o.__children&&0===o.__children.length?(i=o,a=0):(i=this.getRowParent(r),a=this.getRowIndexWithinParent(r)),i?n?i.__children.splice(a,e,n):i.__children.splice(a,e):n?this.data.splice(a,e,n):this.data.splice(a,e),this.rewriteCache()}}},{key:"moveRow",value:function(t,e){var n=this.isParent(e),r=this.getRowParent(t),o=this.getRowIndexWithinParent(t),i=this.getRowParent(e);null==i&&(i=this.getRowParent(e-1)),null==i&&(i=this.getDataObject(e-1)),i?i.__children||(i.__children=[]):(i=this.getDataObject(e)).__children=[];var a=this.getRowParent(e-1),s=n?this.countChildren(a):this.getRowIndexWithinParent(e),l=r.__children.slice(o,o+1);r.__children.splice(o,1),i.__children.splice(s,0,l[0])}},{key:"moveCellMeta",value:function(t,e){var n=this.hot.getCellMetaAtRow(t);this.hot.spliceCellsMeta(e,0,n),this.hot.spliceCellsMeta(t+(t<e?0:1),1)}},{key:"translateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}}])&&_d(e.prototype,n),r&&_d(e,r),t}();var Md=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hot=n,this.plugin=e};function Ad(t){return(Ad="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nd(t,e){return!e||"object"!==Ad(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jd(t){return(jd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Id(t,e,n){return e&&xd(t.prototype,e),n&&xd(t,n),t}function Dd(t,e){return(Dd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pd=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Nd(this,jd(e).call(this,t,n))).dataManager=r.plugin.dataManager,r.collapsingUI=r.plugin.collapsingUI,r.rowHeaderWidthCache=null,r.trimRowsPlugin=t.trimRowsPlugin,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dd(t,e)}(e,t),Id(e,null,[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),Id(e,[{key:"appendLevelIndicators",value:function(t,n){var r=this.trimRowsPlugin.rowsMapper.getValueByIndex(t),o=this.dataManager.getRowLevel(r),i=this.dataManager.getDataObject(r),a=n.getElementsByTagName("DIV")[0],s=a.querySelector("span.rowHeader"),l=a.querySelectorAll('[class^="ht_nesting"]');if(Object(O.arrayEach)(l,(function(t){t&&a.removeChild(t)})),Object(w.addClass)(n,e.CSS_CLASSES.indicatorContainer),o){var u=this.hot.rootDocument,c=s.cloneNode(!0);a.innerHTML="",Object(N.rangeEach)(0,o-1,(function(){var t=u.createElement("SPAN");Object(w.addClass)(t,e.CSS_CLASSES.emptyIndicator),a.appendChild(t)})),a.appendChild(c)}if(this.dataManager.hasChildren(i)){var f=this.hot.rootDocument.createElement("DIV");Object(w.addClass)(n,e.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?Object(w.addClass)(f,"".concat(e.CSS_CLASSES.button," ").concat(e.CSS_CLASSES.expandButton)):Object(w.addClass)(f,"".concat(e.CSS_CLASSES.button," ").concat(e.CSS_CLASSES.collapseButton)),a.appendChild(f)}}},{key:"updateRowHeaderWidth",value:function(t){var e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}]),e}(Md);function Ld(t){return(Ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hd(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Fd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bd(t,e){return!e||"object"!==Ld(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ud(t){return(Ud=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wd(t,e){return(Wd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vd=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Bd(this,Ud(e).call(this,t,n))).trimRowsPlugin=t.trimRowsPlugin,r.dataManager=r.plugin.dataManager,r.collapsedRows=[],r.collapsedRowsStash={stash:function(){r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,!1)},shiftStash:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=r.translateTrimmedRow(t);Object(O.arrayEach)(r.lastCollapsedRows,(function(t,o){t>n-1&&(r.lastCollapsedRows[o]=t+e)}))},applyStash:function(){r.hot.runHooks("skipLengthCache",100),r.collapseMultipleChildren(r.lastCollapsedRows,!0),r.lastCollapsedRows=void 0},trimStash:function(t,e){Object(N.rangeEach)(t,t+e-1,(function(t){var e=r.lastCollapsedRows.indexOf(t);e>-1&&r.lastCollapsedRows.splice(e,1)}))}},r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wd(t,e)}(e,t),n=e,(r=[{key:"collapseChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,s=null;return isNaN(t)?(i=t,a=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(t),a=t),this.dataManager.hasChildren(i)&&Object(O.arrayEach)(i.__children,(function(t){o.push(e.dataManager.getRowIndex(t))})),s=this.collapseRows(o,!0,!1),r&&this.trimRowsPlugin.trimRows(s),n&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(a)&&this.collapsedRows.push(a),s}},{key:"collapseMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];Object(O.arrayEach)(t,(function(t){o.push.apply(o,Hd(e.collapseChildren(t,!1,!1)))})),r&&this.trimRowsPlugin.trimRows(o),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}},{key:"collapseRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return Object(O.arrayEach)(t,(function(t){o.push(t),n&&e.collapseChildRows(t,o)})),r&&this.trimRowsPlugin.trimRows(o),o}},{key:"collapseChildRows",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=(arguments.length>2&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3]);if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);Object(O.arrayEach)(o.__children,(function(t){var r=e.dataManager.getRowIndex(t);n.push(r),e.collapseChildRows(r,n)}))}r&&this.trimRowsPlugin.trimRows(n)}},{key:"expandRow",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}},{key:"expandRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return Object(O.arrayEach)(t,(function(t){o.push(t),n&&e.expandChildRows(t,o)})),r&&this.trimRowsPlugin.untrimRows(o),o}},{key:"expandChildRows",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=(arguments.length>2&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3]);if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);Object(O.arrayEach)(o.__children,(function(t){if(!e.isAnyParentCollapsed(t)){var r=e.dataManager.getRowIndex(t);n.push(r),e.expandChildRows(r,n)}}))}r&&this.trimRowsPlugin.untrimRows(n)}},{key:"expandChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,s=null;return isNaN(t)?(i=t,a=this.dataManager.getRowIndex(t)):(i=this.dataManager.getDataObject(t),a=t),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(i)&&Object(O.arrayEach)(i.__children,(function(t){var n=e.dataManager.getRowIndex(t);o.push(n)})),s=this.expandRows(o,!0,!1),r&&this.trimRowsPlugin.untrimRows(s),n&&this.renderAndAdjust(),s}},{key:"expandMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];Object(O.arrayEach)(t,(function(t){o.push.apply(o,Hd(e.expandChildren(t,!1,!1)))})),r&&this.trimRowsPlugin.untrimRows(o),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var t=this,e=this.hot.getSourceData(),n=[];Object(O.arrayEach)(e,(function(e){t.dataManager.hasChildren(e)&&n.push(e)})),this.collapseMultipleChildren(n),this.renderAndAdjust()}},{key:"expandAll",value:function(){var t=this,e=this.hot.getSourceData(),n=[];Object(O.arrayEach)(e,(function(e){t.dataManager.hasChildren(e)&&n.push(e)})),this.expandMultipleChildren(n),this.renderAndAdjust()}},{key:"areChildrenCollapsed",value:function(t){var e=this,n=null,r=!0;return n=isNaN(t)?t:this.dataManager.getDataObject(t),this.dataManager.hasChildren(n)&&Object(O.arrayEach)(n.__children,(function(t){var n=e.dataManager.getRowIndex(t);if(!e.trimRowsPlugin.isTrimmed(n))return r=!1,!1})),r}},{key:"isAnyParentCollapsed",value:function(t){for(var e=t;null!==e;){e=this.dataManager.getRowParent(e);var n=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}},{key:"toggleState",value:function(t,e){if(!(e.col>=0)){var n=this.translateTrimmedRow(e.row);Object(w.hasClass)(t.target,Pd.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Object(P.stopImmediatePropagation)(t))}}},{key:"translateTrimmedRow",value:function(t){return this.trimRowsPlugin.rowsMapper.getValueByIndex(t)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize()}}])&&Fd(n.prototype,r),o&&Fd(n,o),e}(Md);function Yd(t){return(Yd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gd(t){return(Gd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qd(t,e){return(qd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kd=new WeakMap,$d=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e){return!e||"object"!==Yd(e)&&"function"!=typeof e?Xd(t):e}(this,Gd(e).call(this,t,n)),Kd.set(Xd(r),{row_above:function(t,e){r.dataManager.addSibling(e.start.row,"above")},row_below:function(t,e){r.dataManager.addSibling(e.start.row,"below")}}),r.dataManager=r.plugin.dataManager,r}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qd(t,e)}(e,t),n=e,(r=[{key:"appendOptions",value:function(t){var e=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:function(){var t=e.dataManager.translateTrimmedRow(e.hot.getSelectedLast()[0]),n=e.dataManager.getDataObject(t);e.dataManager.addChild(n)},disabled:function(){var t=e.hot.getSelectedLast();return!t||t[0]<0||e.hot.selection.isSelectedByColumnHeader()||e.hot.countRows()>=e.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:function(){e.dataManager.detachFromParent(e.hot.getSelectedLast())},disabled:function(){var t=e.hot.getSelectedLast(),n=e.dataManager.translateTrimmedRow(t[0]);return!e.dataManager.getRowParent(n)||!t||t[0]<0||e.hot.selection.isSelectedByColumnHeader()||e.hot.countRows()>=e.hot.getSettings().maxRows}},{name:"---------"}];return Object(N.rangeEach)(0,t.items.length-1,(function(e){if(0===e)return Object(O.arrayEach)(n,(function(n,r){t.items.splice(e+r,0,n)})),!1})),this.modifyRowInsertingOptions(t)}},{key:"modifyRowInsertingOptions",value:function(t){var e=Kd.get(this);return Object(N.rangeEach)(0,t.items.length-1,(function(n){var r=e[t.items[n].key];null!=r&&(t.items[n].callback=r)})),t}}])&&zd(n.prototype,r),o&&zd(n,o),e}(Md);function Qd(t){return(Qd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zd(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Jd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ep(t,e,n){return(ep="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=np(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function np(t){return(np=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rp(t,e){return(rp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var op=new WeakMap,ip=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==Qd(e)&&"function"!=typeof e?tp(t):e}(this,np(e).call(this,t))).sourceData=null,n.trimRowsPlugin=null,n.bindRowsWithHeadersPlugin=null,n.dataManager=null,n.headersUI=null,op.set(tp(n),{changeSelection:!1,movedToFirstChild:!1,movedToCollapsed:!1,skipRender:null}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rp(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function(){var t=this;this.sourceData=this.hot.getSourceData(),this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove"),this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders"),this.dataManager=new Td(this,this.hot,this.sourceData),this.collapsingUI=new Vd(this,this.hot,this.trimRowsPlugin),this.headersUI=new Pd(this,this.hot),this.contextMenuUI=new $d(this,this.hot),this.dataManager.rewriteCache(),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("beforeRender",(function(){return t.onBeforeRender.apply(t,arguments)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData.apply(t,arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength.apply(t,arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice.apply(t,arguments)})),this.addHook("beforeDataFilter",(function(){return t.onBeforeDataFilter.apply(t,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)})),this.addHook("afterGetRowHeader",(function(){return t.onAfterGetRowHeader.apply(t,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("modifyRemovedAmount",(function(){return t.onModifyRemovedAmount.apply(t,arguments)})),this.addHook("beforeAddChild",(function(){return t.onBeforeAddChild.apply(t,arguments)})),this.addHook("afterAddChild",(function(){return t.onAfterAddChild.apply(t,arguments)})),this.addHook("beforeDetachChild",(function(){return t.onBeforeDetachChild.apply(t,arguments)})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild.apply(t,arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return t.onModifyRowHeaderWidth.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("beforeRowMove",(function(){return t.onBeforeRowMove.apply(t,arguments)})),this.addHook("afterRowMove",(function(){return t.onAfterRowMove.apply(t,arguments)})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.trimRowsPlugin.isEnabled()||(this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().trimRows=!0),ep(np(e.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){ep(np(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ep(np(e.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(t,e){var n,r,o,i=op.get(this),a=t.length,s=[],l=this.dataManager.translateTrimmedRow(e),u=!0,c=null;for(n=0;n<a;n++)s.push(this.dataManager.translateTrimmedRow(t[n])),this.dataManager.isParent(s[n])&&(u=!1);if(s.indexOf(l)>-1||!u)return!1;if(r=this.dataManager.getRowParent(s[0]),null==(c=this.dataManager.getRowParent(l))&&(c=this.dataManager.getRowParent(l-1)),null==c&&(c=this.dataManager.getDataObject(l-1),i.movedToFirstChild=!0),!c)return!1;for(o=r===c,i.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(c),this.collapsingUI.collapsedRowsStash.stash(),o||(Math.max.apply(Math,s)<=l?this.collapsingUI.collapsedRowsStash.shiftStash(s[0],-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(l,t.length)),i.changeSelection=!0,(s[a-1]<=l&&o||!0===i.movedToFirstChild)&&(t.reverse(),s.reverse(),!0!==i.movedToFirstChild&&(l-=1)),n=0;n<a;n++)this.dataManager.moveRow(s[n],l);if(s[s.length-1]<l)for(n=a-1;n>=0;n--)this.dataManager.moveCellMeta(s[n],l);else for(n=0;n<a;n++)this.dataManager.moveCellMeta(s[n],l);return(s[a-1]<=l&&o||this.dataManager.isParent(l))&&t.reverse(),this.dataManager.rewriteCache(),!1}},{key:"onAfterRowMove",value:function(t,e){var n=op.get(this);if(n.changeSelection){var r,o,i=t.length,a=0,s=0,l=null;if(this.collapsingUI.collapsedRowsStash.applyStash(),r=this.dataManager.translateTrimmedRow(e),n.movedToFirstChild)n.movedToFirstChild=!1,a=e,s=e+i-1,e>=Math.max.apply(Math,Zd(t))&&(a-=i,s-=i);else if(n.movedToCollapsed){var u=this.dataManager.getRowParent(r-1);null==u&&(u=this.dataManager.getDataObject(r-1)),s=a=this.dataManager.getRowIndex(u)}else t[i-1]<e?a=(s=e-1)-i+1:s=(a=e)+i-1;l=this.hot.selection,o=this.hot.countCols()-1,l.setRangeStart(new rt.a(a,0)),l.setRangeEnd(new rt.a(s,o),!0),n.changeSelection=!1}}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n){this.collapsingUI.toggleState(t,e,n)}},{key:"onModifyRowData",value:function(t){return this.dataManager.getDataObject(t)}},{key:"onModifySourceLength",value:function(){return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(t,e,n){return this.dataManager.spliceData(t,e,n),!1}},{key:"onBeforeDataFilter",value:function(t,e){var n=[],r=this.dataManager.translateTrimmedRow(t),o=op.get(this);return Object(N.rangeEach)(r,r+e-1,(function(t){n.push(t)})),this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r,e),this.collapsingUI.collapsedRowsStash.shiftStash(r,-1*e),this.dataManager.filterData(t,e,n),o.skipRender=!0,!1}},{key:"onAfterContextMenuDefaultOptions",value:function(t){return this.contextMenuUI.appendOptions(t)}},{key:"onAfterGetRowHeader",value:function(t,e){this.headersUI.appendLevelIndicators(t,e)}},{key:"onModifyRowHeaderWidth",value:function(t){return this.headersUI.rowHeaderWidthCache||t}},{key:"onAfterRemoveRow",value:function(t,e,n,r){var o=this;if(r!==this.pluginName){var i=op.get(this);setTimeout((function(){i.skipRender=null,o.headersUI.updateRowHeaderWidth(),o.collapsingUI.collapsedRowsStash.applyStash()}),0)}}},{key:"onModifyRemovedAmount",value:function(t,e){var n=this,r=[],o=0;return Object(N.rangeEach)(e,e+t-1,(function(t){var e=!1,i=n.collapsingUI.translateTrimmedRow(t),a=n.dataManager.getDataObject(i);n.dataManager.hasChildren(a)&&(r.push(a),Object(O.arrayEach)(r,(function(t){if(t.__children.indexOf(a)>-1)return e=!0,!1})),e||(o+=n.dataManager.countChildren(a))),e=!1,Object(O.arrayEach)(r,(function(t){if(t.__children.indexOf(a)>-1)return e=!0,!1})),e&&(o-=1)})),t+o}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(t,e,n){n!==this.pluginName&&this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){this.bindRowsWithHeadersPlugin.bindStrategy.strategy&&this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows());var t=Math.max.apply(Math,Zd(this.dataManager.cache.levels));t>0&&this.headersUI.updateRowHeaderWidth(t)}},{key:"onBeforeRender",value:function(t,e){op.get(this).skipRender&&(e.skipRender=!0)}},{key:"onAfterLoadData",value:function(){this.dataManager.data=this.hot.getSourceData(),this.dataManager.rewriteCache()}}])&&Jd(n.prototype,r),o&&Jd(n,o),e}(W);Object(H.d)("nestedRows",ip);var ap=ip;function sp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function lp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function up(t){return(up="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fp(t,e){return!e||"object"!==up(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hp(t,e,n){return(hp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=dp(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function dp(t){return(dp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pp(t,e){return(pp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}b.a.getSingleton().register("beforeHideColumns"),b.a.getSingleton().register("afterHideColumns"),b.a.getSingleton().register("beforeUnhideColumns"),b.a.getSingleton().register("afterUnhideColumns");var gp=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=fp(this,dp(e).call(this,t))).settings={},n.hiddenColumns=[],n.lastSelectedColumn=-1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pp(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.hot.hasColHeaders()?this.addHook("afterGetColHeader",(function(e,n){return t.onAfterGetColHeader(e,n)})):this.addHook("afterRenderer",(function(e,n,r){return t.onAfterGetColHeader(r,e)})),this.addHook("afterContextMenuDefaultOptions",(function(e){return t.onAfterContextMenuDefaultOptions(e)})),this.addHook("afterGetCellMeta",(function(e,n,r){return t.onAfterGetCellMeta(e,n,r)})),this.addHook("modifyColWidth",(function(e,n){return t.onModifyColWidth(e,n)})),this.addHook("beforeSetRangeStartOnly",(function(e){return t.onBeforeSetRangeStart(e)})),this.addHook("beforeSetRangeEnd",(function(e){return t.onBeforeSetRangeEnd(e)})),this.addHook("hiddenColumn",(function(e){return t.isHidden(e)})),this.addHook("beforeStretchingColumnWidth",(function(e,n){return t.onBeforeStretchingColumnWidth(e,n)})),this.addHook("afterCreateCol",(function(e,n){return t.onAfterCreateCol(e,n)})),this.addHook("afterRemoveCol",(function(e,n){return t.onAfterRemoveCol(e,n)})),this.addHook("init",(function(){return t.onInit()})),this.hot.view&&this.onInit(),hp(dp(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),hp(dp(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={},this.hiddenColumns=[],this.lastSelectedColumn=-1,this.hot.render(),hp(dp(e.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(t){var e=this.hiddenColumns,n=this.isColumnDataValid(t),r=e;n&&(r=this.hiddenColumns.filter((function(e){return!1===t.includes(e)}))),!1!==this.hot.runHooks("beforeUnhideColumns",e,r,n)&&(n&&(this.hiddenColumns=r),this.hot.runHooks("afterUnhideColumns",e,r,n,n&&r.length<e.length))}},{key:"showColumn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showColumns(e)}},{key:"hideColumns",value:function(t){var e=this.hiddenColumns,n=this.isColumnDataValid(t),r=e;n&&(r=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeHideColumns",e,r,n)&&(n&&(this.hiddenColumns=r),this.hot.runHooks("afterHideColumns",e,r,n,n&&r.length>e.length))}},{key:"hideColumn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideColumns(e)}},{key:"isHidden",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t;return e||(n=this.hot.toPhysicalColumn(t)),this.hiddenColumns.includes(n)}},{key:"isColumnDataValid",value:function(t){var e=this;return t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e.hot.countCols()}))}},{key:"resetCellsMeta",value:function(){Object(O.arrayEach)(this.hot.getCellsMeta(),(function(t){t&&(t.skipColumnOnPaste=!1,null!==t.baseRenderer&&(t.renderer=t.baseRenderer,t.baseRenderer=null))}))}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){var n=t;return this.isHidden(e)&&(n=0),n}},{key:"onModifyColWidth",value:function(t,e){return this.isHidden(e)?.1:this.settings.indicators&&(this.isHidden(e+1)||this.isHidden(e-1))?t+(this.hot.hasColHeaders()?15:0):void 0}},{key:"onAfterGetCellMeta",value:function(t,e,n){var r=this.hot.runHooks("unmodifyCol",e);if(!1===this.settings.copyPasteEnabled&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(r)?(n.renderer!==vp&&(n.baseRenderer=n.renderer),n.renderer=vp):null!==n.baseRenderer&&(n.renderer=n.baseRenderer,n.baseRenderer=null),this.isHidden(n.visualCol-1)){var o=!0,i=n.visualCol-1;n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");do{if(!this.isHidden(i)){o=!1;break}i-=1}while(i>=0);o&&-1===n.className.indexOf("firstVisibleColumn")&&(n.className+=" firstVisibleColumn")}else if(n.className){var a=n.className.split(" ");if(a.length){var s=a.indexOf("afterHiddenColumn");s>-1&&a.splice(s,1);var l=a.indexOf("firstVisibleColumn");l>-1&&a.splice(l,1),n.className=a.join(" ")}}}},{key:"onModifyCopyableRange",value:function(t){var e=this,n=[],r=function(t,e,r,o){n.push({startRow:t,endRow:e,startCol:r,endCol:o})};return Object(O.arrayEach)(t,(function(t){var n=!0,o=0;Object(N.rangeEach)(t.startCol,t.endCol,(function(i){e.isHidden(i)?(n||r(t.startRow,t.endRow,o,i-1),n=!0):(n&&(o=i),i===t.endCol&&r(t.startRow,t.endRow,o,i),n=!1)}))})),n}},{key:"onAfterGetColHeader",value:function(t,e){if(!this.isHidden(t)){var n=!0,r=t-1;do{if(!this.isHidden(r)){n=!1;break}r-=1}while(r>=0);n&&Object(w.addClass)(e,"firstVisibleColumn"),this.settings.indicators&&(this.isHidden(t-1)&&Object(w.addClass)(e,"afterHiddenColumn"),this.isHidden(t+1)&&t>-1&&Object(w.addClass)(e,"beforeHiddenColumn"))}}},{key:"onBeforeSetRangeStart",value:function(t){var e=this;t.col>0||(t.col=0,t.col=function t(n){var r=n,o=e.hot.toPhysicalColumn(r);return e.isHidden(o,!0)&&(r=t(r+=1)),r}(t.col))}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this,n=this.hot.countCols();t.col=function r(o){var i=o,a=e.hot.toPhysicalColumn(i);return e.isHidden(a,!0)&&(e.lastSelectedColumn>i||t.col===n-1?i>0?i=r(i-=1):Object(N.rangeEach)(0,e.lastSelectedColumn,(function(t){if(!e.isHidden(t))return i=t,!1})):i=r(i+=1)),i}(t.col),this.lastSelectedColumn=t.col}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;t.items.push({name:Fe},(e=this,{key:"hidden_columns_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=sp(t,4);n[1]-n[3]!=0&&(e=1)}return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_HIDE_COLUMN,e)},callback:function(){var t=this.getSelectedRangeLast(),n=t.from,r=t.to,o=Math.min(n.col,r.col),i=Math.max(n.col,r.col);Object(N.rangeEach)(o,i,(function(t){return e.hideColumn(t)})),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.isSelectedByColumnHeader()}}),function(t){var e=[],n=[];return{key:"hidden_columns_show",name:function(){var r=this.getSelectedLast(),o=0;if(Array.isArray(r)){var i=lp(r,4),a=i[1],s=i[3];if(a>s){var l=[s,a];a=l[0],s=l[1]}var u=0;a===s?u=e.length+n.length:Object(N.rangeEach)(a,s,(function(e){t.isHidden(e)&&(u+=1)})),o=u<=1?0:1}return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_SHOW_COLUMN,o)},callback:function(){var r=this.getSelectedRangeLast(),o=r.from,i=r.to,a=Math.min(o.col,i.col),s=Math.max(o.col,i.col);a===s?(e.length===a&&(t.showColumns(e),e.length=0),n.length===this.countSourceCols()-(a+1)&&(t.showColumns(n),n.length=0)):Object(N.rangeEach)(a,s,(function(e){return t.showColumn(e)})),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!t.hiddenColumns.length||!this.selection.isSelectedByColumnHeader())return!0;e.length=0,n.length=0;var r=this.getSelectedRangeLast(),o=r.from,i=r.to,a=Math.min(o.col,i.col),s=Math.max(o.col,i.col),l=!1;if(a===s){var u=this.countSourceCols();Object(N.rangeEach)(0,u,(function(r){if(e.length+n.length===t.hiddenColumns.length)return!1;r<a&&t.isHidden(r)?e.push(r):t.isHidden(r)&&n.push(r)})),u-=1,(e.length===a&&a>0||n.length===u-a&&a<u)&&(l=!0)}else Object(N.rangeEach)(a,s,(function(e){if(t.isHidden(e))return l=!0,!1}));return!l}}}(this))}},{key:"onAfterCreateCol",value:function(t,e){var n=[];Object(O.arrayEach)(this.hiddenColumns,(function(r){var o=r;o>=t&&(o+=e),n.push(o)})),this.hiddenColumns=n}},{key:"onAfterRemoveCol",value:function(t,e){var n=[];Object(O.arrayEach)(this.hiddenColumns,(function(r){var o=r;o>=t&&(o-=e),n.push(o)})),this.hiddenColumns=n}},{key:"onInit",value:function(){var t=this,e=this.hot.getSettings().hiddenColumns;"object"===up(e)&&(this.settings=e,void 0===e.copyPasteEnabled&&(e.copyPasteEnabled=!0),Array.isArray(e.columns)&&this.hideColumns(e.columns),e.copyPasteEnabled||this.addHook("modifyCopyableRange",(function(e){return t.onModifyCopyableRange(e)})))}},{key:"destroy",value:function(){hp(dp(e.prototype),"destroy",this).call(this)}}])&&cp(n.prototype,r),o&&cp(n,o),e}(W);function vp(t,e){e.textContent=""}Object(H.d)("hiddenColumns",gp);var yp=gp;function mp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function bp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function wp(t){return(wp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Op(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cp(t,e){return!e||"object"!==wp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ep(t,e,n){return(Ep="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sp(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Sp(t){return(Sp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kp(t,e){return(kp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}b.a.getSingleton().register("beforeHideRows"),b.a.getSingleton().register("afterHideRows"),b.a.getSingleton().register("beforeUnhideRows"),b.a.getSingleton().register("afterUnhideRows");var Rp=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Cp(this,Sp(e).call(this,t))).settings={},n.hiddenRows=[],n.lastSelectedRow=-1,n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kp(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.hot.hasRowHeaders()?this.addHook("afterGetRowHeader",(function(e,n){return t.onAfterGetRowHeader(e,n)})):this.addHook("afterRenderer",(function(e,n){return t.onAfterGetRowHeader(n,e)})),this.addHook("afterContextMenuDefaultOptions",(function(e){return t.onAfterContextMenuDefaultOptions(e)})),this.addHook("afterGetCellMeta",(function(e,n,r){return t.onAfterGetCellMeta(e,n,r)})),this.addHook("modifyRowHeight",(function(e,n){return t.onModifyRowHeight(e,n)})),this.addHook("beforeSetRangeStartOnly",(function(e){return t.onBeforeSetRangeStartOnly(e)})),this.addHook("beforeSetRangeStart",(function(e){return t.onBeforeSetRangeStart(e)})),this.addHook("beforeSetRangeEnd",(function(e){return t.onBeforeSetRangeEnd(e)})),this.addHook("hiddenRow",(function(e){return t.isHidden(e)})),this.addHook("afterCreateRow",(function(e,n){return t.onAfterCreateRow(e,n)})),this.addHook("afterRemoveRow",(function(e,n){return t.onAfterRemoveRow(e,n)})),this.addHook("init",(function(){return t.onInit()})),this.hot.view&&this.onInit(),Ep(Sp(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.onInit(),Ep(Sp(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.settings={},this.hiddenRows=[],this.lastSelectedRow=-1,Ep(Sp(e.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(t){var e=this,n=this.hiddenRows,r=this.isRowDataValid(t),o=Object(O.arrayMap)(t,(function(t){return e.hot.toPhysicalRow(t)})),i=n;r&&(i=this.hiddenRows.filter((function(t){return!1===o.includes(t)}))),!1!==this.hot.runHooks("beforeUnhideRows",n,i,r)&&(r&&(this.hiddenRows=i),this.hot.runHooks("afterUnhideRows",n,i,r,r&&i.length<n.length))}},{key:"showRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showRows(e)}},{key:"hideRows",value:function(t){var e=this,n=this.hiddenRows,r=this.isRowDataValid(t),o=Object(O.arrayMap)(t,(function(t){return e.hot.toPhysicalRow(t)})),i=n;r&&(i=Array.from(new Set(n.concat(o)))),!1!==this.hot.runHooks("beforeHideRows",n,i,r)&&(r&&(this.hiddenRows=i),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}},{key:"hideRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideRows(e)}},{key:"isHidden",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t;return e||(n=this.hot.toPhysicalRow(t)),this.hiddenRows.includes(n)}},{key:"isRowDataValid",value:function(t){var e=this;return t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e.hot.countRows()}))}},{key:"resetCellsMeta",value:function(){Object(O.arrayEach)(this.hot.getCellsMeta(),(function(t){t&&(t.skipRowOnPaste=!1)}))}},{key:"onAfterGetCellMeta",value:function(t,e,n){var r=this.hot.runHooks("unmodifyRow",t);if(!1===this.settings.copyPasteEnabled&&this.isHidden(r)?n.skipRowOnPaste=!0:n.skipRowOnPaste=!1,this.isHidden(r-1)){var o=!0,i=r-1;n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");do{if(!this.isHidden(i)){o=!1;break}i-=1}while(i>=0);o&&-1===n.className.indexOf("firstVisibleRow")&&(n.className+=" firstVisibleRow")}else if(n.className){var a=n.className.split(" ");if(a.length){var s=a.indexOf("afterHiddenRow");s>-1&&a.splice(s,1);var l=a.indexOf("firstVisibleRow");l>-1&&a.splice(l,1),n.className=a.join(" ")}}}},{key:"onAfterGetRowHeader",value:function(t,e){var n=e.parentNode;n&&(this.isHidden(t)?Object(w.addClass)(n,"hide"):Object(w.removeClass)(n,"hide"));var r=!0,o=t-1;do{if(!this.isHidden(o)){r=!1;break}o-=1}while(o>=0);r&&Object(w.addClass)(e,"firstVisibleRow"),this.settings.indicators&&this.hot.hasRowHeaders()&&(this.isHidden(t-1)&&Object(w.addClass)(e,"afterHiddenRow"),this.isHidden(t+1)&&Object(w.addClass)(e,"beforeHiddenRow"))}},{key:"onModifyRowHeight",value:function(t,e){return this.isHidden(e)?.1:t}},{key:"onModifyCopyableRange",value:function(t){var e=this,n=[],r=function(t,e,r,o){n.push({startRow:t,endRow:e,startCol:r,endCol:o})};return Object(O.arrayEach)(t,(function(t){var n=!0,o=0;Object(N.rangeEach)(t.startRow,t.endRow,(function(i){e.isHidden(i)?(n||r(o,i-1,t.startCol,t.endCol),n=!0):(n&&(o=i),i===t.endRow&&r(o,i,t.startCol,t.endCol),n=!1)}))})),n}},{key:"onBeforeSetRangeStart",value:function(t){var e=this,n=this.hot.getSelectedLast()||!1,r=this.hot.countRows()-1;t.row=function t(o){var i=0,a=o;return n&&(i=a>n[0]?1:-1,e.lastSelectedRow=n[0]),r<a||a<0?e.lastSelectedRow:(e.isHidden(a)&&(a=t(a+i)),a)}(t.row)}},{key:"onBeforeSetRangeStartOnly",value:function(t){var e=this;t.row>0||(t.row=0,t.row=function t(n){var r=n;return e.isHidden(r)&&(r=t(r+=1)),r}(t.row))}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this,n=this.hot.countRows();t.row=function r(o){var i=o;return e.isHidden(i)&&(e.lastSelectedRow>i||t.row===n-1?i>0?i=r(i-=1):Object(N.rangeEach)(0,e.lastSelectedRow,(function(t){if(!e.isHidden(t))return i=t,!1})):i=r(i+=1)),i}(t.row),this.lastSelectedRow=t.row}},{key:"onAfterContextMenuDefaultOptions",value:function(t){var e;t.items.push({name:"---------"},(e=this,{key:"hidden_rows_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=mp(t,3);n[0]-n[2]!=0&&(e=1)}return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_HIDE_ROW,e)},callback:function(){var t=this.getSelectedRangeLast(),n=t.from,r=t.to,o=Math.min(n.row,r.row),i=Math.max(n.row,r.row);Object(N.rangeEach)(o,i,(function(t){return e.hideRow(t)})),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.isSelectedByRowHeader()}}),function(t){var e=[],n=[];return{key:"hidden_rows_show",name:function(){var r=this.getSelectedLast(),o=0;if(Array.isArray(r)){var i=bp(r,3),a=i[0],s=i[2];if(a>s){var l=[s,a];a=l[0],s=l[1]}var u=0;a===s?u=e.length+n.length:Object(N.rangeEach)(a,s,(function(e){t.isHidden(e)&&(u+=1)})),o=u<=1?0:1}return this.getTranslatedPhrase(nn.CONTEXTMENU_ITEMS_SHOW_ROW,o)},callback:function(){var r=this.getSelectedRangeLast(),o=r.from,i=r.to,a=Math.min(o.row,i.row),s=Math.max(o.row,i.row);a===s?(e.length===a&&(t.showRows(e),e.length=0),n.length===this.countSourceRows()-(a+1)&&(t.showRows(n),n.length=0)):Object(N.rangeEach)(a,s,(function(e){return t.showRow(e)})),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!t.hiddenRows.length||!this.selection.isSelectedByRowHeader())return!0;e.length=0,n.length=0;var r=this.getSelectedRangeLast(),o=r.from,i=r.to,a=Math.min(o.row,i.row),s=Math.max(o.row,i.row),l=!1;if(a===s){var u=this.countSourceRows();Object(N.rangeEach)(0,u,(function(r){if(e.length+n.length===t.hiddenRows.length)return!1;r<a?t.isHidden(r)&&e.push(r):t.isHidden(r)&&n.push(r)})),u-=1,(e.length===a&&a>0||n.length===u-a&&a<u)&&(l=!0)}else Object(N.rangeEach)(a,s,(function(e){if(t.isHidden(e))return l=!0,!1}));return!l}}}(this))}},{key:"onAfterCreateRow",value:function(t,e){var n=[];Object(O.arrayEach)(this.hiddenRows,(function(r){var o=r;o>=t&&(o+=e),n.push(o)})),this.hiddenRows=n}},{key:"onAfterRemoveRow",value:function(t,e){var n=[];Object(O.arrayEach)(this.hiddenRows,(function(r){var o=r;o>=t&&(o-=e),n.push(o)})),this.hiddenRows=n}},{key:"onInit",value:function(){var t=this,e=this.hot.getSettings().hiddenRows;"object"===wp(e)&&(this.settings=e,void 0===e.copyPasteEnabled&&(e.copyPasteEnabled=!0),Array.isArray(e.rows)&&this.hideRows(e.rows),e.copyPasteEnabled||this.addHook("modifyCopyableRange",(function(e){return t.onModifyCopyableRange(e)})))}},{key:"destroy",value:function(){Ep(Sp(e.prototype),"destroy",this).call(this)}}])&&Op(n.prototype,r),o&&Op(n,o),e}(W);Object(H.d)("hiddenRows",Rp);var _p=Rp;function Tp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Mp=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.trimRows=e}var e,n,r;return e=t,(n=[{key:"createMap",value:function(t){var e=this,n=0,r=void 0===t?this._arrayMap.length:t;this._arrayMap.length=0,Object(N.rangeEach)(r-1,(function(t){e.trimRows.isTrimmed(t)?n+=1:e._arrayMap[t-n]=t}))}},{key:"destroy",value:function(){this._arrayMap=null}}])&&Tp(e.prototype,n),r&&Tp(e,r),t}();Object(j.mixin)(Mp,Qt);var Ap=Mp;function Np(t){return(Np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ip(t,e,n){return(Ip="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Dp(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Dp(t){return(Dp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pp(t,e){return(Pp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lp=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==Np(e)&&"function"!=typeof e?xp(t):e}(this,Dp(e).call(this,t))).trimmedRows=[],n.removedRows=[],n.rowsMapper=new Ap(xp(n)),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pp(t,e)}(e,t),n=e,(r=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var n=this.hot.getSettings().trimRows;Array.isArray(n)&&(this.trimmedRows=n),this.rowsMapper.createMap(this.hot.countSourceRows()),this.addHook("modifyRow",(function(e,n){return t.onModifyRow(e,n)})),this.addHook("unmodifyRow",(function(e,n){return t.onUnmodifyRow(e,n)})),this.addHook("beforeCreateRow",(function(e,n,r){return t.onBeforeCreateRow(e,n,r)})),this.addHook("afterCreateRow",(function(e,n){return t.onAfterCreateRow(e,n)})),this.addHook("beforeRemoveRow",(function(e,n){return t.onBeforeRemoveRow(e,n)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow()})),this.addHook("afterLoadData",(function(e){return t.onAfterLoadData(e)})),Ip(Dp(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings().trimRows;Array.isArray(t)&&(this.disablePlugin(),this.enablePlugin()),Ip(Dp(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.trimmedRows=[],this.removedRows.length=0,this.rowsMapper.clearMap(),Ip(Dp(e.prototype),"disablePlugin",this).call(this)}},{key:"trimRows",value:function(t){var e=this.trimmedRows,n=this.isValidConfig(t),r=e;n&&(r=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeTrimRow",e,r,n)&&(n&&(this.trimmedRows=r,this.hot.runHooks("skipLengthCache",100),this.rowsMapper.createMap(this.hot.countSourceRows())),this.hot.runHooks("afterTrimRow",e,r,n,n&&r.length>e.length))}},{key:"trimRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.trimRows(e)}},{key:"untrimRows",value:function(t){var e=this.trimmedRows,n=this.isValidConfig(t),r=e;n&&(r=this.trimmedRows.filter((function(e){return!1===t.includes(e)}))),!1!==this.hot.runHooks("beforeUntrimRow",e,r,n)&&(n&&(this.trimmedRows=r,this.hot.runHooks("skipLengthCache",100),this.rowsMapper.createMap(this.hot.countSourceRows())),this.hot.runHooks("afterUntrimRow",e,r,n,n&&r.length<e.length))}},{key:"untrimRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.untrimRows(e)}},{key:"isTrimmed",value:function(t){return this.trimmedRows.includes(t)}},{key:"untrimAll",value:function(){this.untrimRows([].concat(this.trimmedRows))}},{key:"isValidConfig",value:function(t){var e=this;return t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e.hot.countSourceRows()}))}},{key:"onModifyRow",value:function(t,e){var n=t;return e!==this.pluginName&&(n=this.rowsMapper.getValueByIndex(n)),n}},{key:"onUnmodifyRow",value:function(t,e){var n=t;return e!==this.pluginName&&(n=this.rowsMapper.getIndexByValue(n)),n}},{key:"onBeforeCreateRow",value:function(t,e,n){if(this.isEnabled()&&this.trimmedRows.length>0&&"auto"===n)return!1}},{key:"onAfterCreateRow",value:function(t,e){var n=this;this.rowsMapper.shiftItems(t,e),this.trimmedRows=Object(O.arrayMap)(this.trimmedRows,(function(r){return r>=n.rowsMapper.getValueByIndex(t)?r+e:r}))}},{key:"onBeforeRemoveRow",value:function(t,e){var n=this;this.removedRows.length=0,!1!==t&&Object(N.rangeEach)(t,t+e-1,(function(t){n.removedRows.push(n.hot.runHooks("modifyRow",t,n.pluginName))}))}},{key:"onAfterRemoveRow",value:function(){var t=this;this.rowsMapper.unshiftItems(this.removedRows),this.trimmedRows=Object(O.arrayMap)(this.trimmedRows,(function(e){return e-t.removedRows.filter((function(t){return t<e})).length}))}},{key:"onAfterLoadData",value:function(t){t||this.rowsMapper.createMap(this.hot.countSourceRows())}},{key:"destroy",value:function(){this.rowsMapper.destroy(),Ip(Dp(e.prototype),"destroy",this).call(this)}}])&&jp(n.prototype,r),o&&jp(n,o),e}(W);Object(H.d)("trimRows",Lp);var Hp=Lp,Fp=n(154),Bp=n(97),Up=n(155),Wp=n(76);function Vp(t,e){var n=new y.a(t,e||{},Bp.d);return n.init(),n}!function(t){var e="undefined"!=typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){var n,r=this.first(),o=r.data("handsontable");if("string"!=typeof e){var i=e||{};return o?o.updateSettings(i):(o=new t.Core(r[0],i),r.data("handsontable",o),o.init()),r}if(o){if(void 0===o[e])throw new Error("Handsontable do not provide action: ".concat(e));for(var a,s=arguments.length,l=new Array(s>1?s-1:0),u=1;u<s;u++)l[u-1]=arguments[u];n=(a=o[e]).call.apply(a,[o].concat(l)),"destroy"===e&&r.removeData()}return n})}(Vp),Vp.Core=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new y.a(t,e,Bp.d)},Vp.DefaultSettings=Fp.a,Vp.EventManager=m.a,Vp._getListenersCounter=m.b,Vp.packageName="handsontable",Vp.buildDate="19/02/2020 13:41:19",Vp.version="7.4.2",Vp.hooks=b.a.getSingleton(),Vp.__GhostTable=E;var Yp=[O,k,R,_,T,M,A,N,j,x,I,D,S],zp=[w,P];Vp.helper={},Vp.dom={},O.arrayEach(Yp,(function(t){O.arrayEach(Object.getOwnPropertyNames(t),(function(e){"_"!==e.charAt(0)&&(Vp.helper[e]=t[e])}))})),O.arrayEach(zp,(function(t){O.arrayEach(Object.getOwnPropertyNames(t),(function(e){"_"!==e.charAt(0)&&(Vp.dom[e]=t[e])}))})),Vp.cellTypes={},O.arrayEach(Object(v.b)(),(function(t){Vp.cellTypes[t]=Object(v.a)(t)})),Vp.cellTypes.registerCellType=v.c,Vp.cellTypes.getCellType=v.a,Vp.editors={},O.arrayEach(Object(d.c)(),(function(t){Vp.editors["".concat(I.toUpperCaseFirst(t),"Editor")]=Object(d.a)(t)})),Vp.editors.registerEditor=d.d,Vp.editors.getEditor=d.a,Vp.renderers={},O.arrayEach(Object(p.a)(),(function(t){var e=Object(p.b)(t);"base"===t&&(Vp.renderers.cellDecorator=e),Vp.renderers["".concat(I.toUpperCaseFirst(t),"Renderer")]=e})),Vp.renderers.registerRenderer=p.c,Vp.renderers.getRenderer=p.b,Vp.validators={},O.arrayEach(Object(g.a)(),(function(t){Vp.validators["".concat(I.toUpperCaseFirst(t),"Validator")]=Object(g.b)(t)})),Vp.validators.registerValidator=g.c,Vp.validators.getValidator=g.b,Vp.plugins={},O.arrayEach(Object.getOwnPropertyNames(u),(function(t){var e=u[t];"Base"===t?Vp.plugins["".concat(t,"Plugin")]=e:Vp.plugins[t]=e})),Vp.plugins.registerPlugin=H.d,Vp.languages={},Vp.languages.dictionaryKeys=nn,Vp.languages.getLanguageDictionary=Wp.b,Vp.languages.getLanguagesDictionaries=Wp.c,Vp.languages.registerLanguageDictionary=Wp.e,Vp.languages.getTranslatedPhrase=function(){return Up.a.apply(void 0,arguments)};var Gp,Xp=Vp,qp=n(113),Kp=n.n(qp),$p=n(223),Qp=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(){Gp=Function.prototype.toString,Function.prototype.toString=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.__sentry_original__||this;return Gp.apply(n,t)}},t.id="FunctionToString",t}(),Zp=n(16),Jp=n(157),tg=n(270),eg=n(101),ng=n(42),rg=n(100),og=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],ig=function(){function t(e){void 0===e&&(e={}),this._options=e,this.name=t.id}return t.prototype.setupOnce=function(){Object(Jp.b)((function(e){var n=Object(tg.a)();if(!n)return e;var r=n.getIntegration(t);if(r){var o=n.getClient(),i=o?o.getOptions():{},a=r._mergeOptions(i);if(r._shouldDropEvent(e,a))return null}return e}))},t.prototype._shouldDropEvent=function(t,e){return this._isSentryError(t,e)?(eg.a.warn("Event dropped due to being internal Sentry Error.\nEvent: "+Object(ng.e)(t)),!0):this._isIgnoredError(t,e)?(eg.a.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+Object(ng.e)(t)),!0):this._isBlacklistedUrl(t,e)?(eg.a.warn("Event dropped due to being matched by `blacklistUrls` option.\nEvent: "+Object(ng.e)(t)+".\nUrl: "+this._getEventFilterUrl(t)),!0):!this._isWhitelistedUrl(t,e)&&(eg.a.warn("Event dropped due to not being matched by `whitelistUrls` option.\nEvent: "+Object(ng.e)(t)+".\nUrl: "+this._getEventFilterUrl(t)),!0)},t.prototype._isSentryError=function(t,e){if(void 0===e&&(e={}),!e.ignoreInternal)return!1;try{return t&&t.exception&&t.exception.values&&t.exception.values[0]&&"SentryError"===t.exception.values[0].type||!1}catch(t){return!1}},t.prototype._isIgnoredError=function(t,e){return void 0===e&&(e={}),!(!e.ignoreErrors||!e.ignoreErrors.length)&&this._getPossibleEventMessages(t).some((function(t){return e.ignoreErrors.some((function(e){return Object(rg.a)(t,e)}))}))},t.prototype._isBlacklistedUrl=function(t,e){if(void 0===e&&(e={}),!e.blacklistUrls||!e.blacklistUrls.length)return!1;var n=this._getEventFilterUrl(t);return!!n&&e.blacklistUrls.some((function(t){return Object(rg.a)(n,t)}))},t.prototype._isWhitelistedUrl=function(t,e){if(void 0===e&&(e={}),!e.whitelistUrls||!e.whitelistUrls.length)return!0;var n=this._getEventFilterUrl(t);return!n||e.whitelistUrls.some((function(t){return Object(rg.a)(n,t)}))},t.prototype._mergeOptions=function(t){return void 0===t&&(t={}),{blacklistUrls:Zp.d(this._options.blacklistUrls||[],t.blacklistUrls||[]),ignoreErrors:Zp.d(this._options.ignoreErrors||[],t.ignoreErrors||[],og),ignoreInternal:void 0===this._options.ignoreInternal||this._options.ignoreInternal,whitelistUrls:Zp.d(this._options.whitelistUrls||[],t.whitelistUrls||[])}},t.prototype._getPossibleEventMessages=function(t){if(t.message)return[t.message];if(t.exception)try{var e=t.exception.values&&t.exception.values[0]||{},n=e.type,r=void 0===n?"":n,o=e.value,i=void 0===o?"":o;return[""+i,r+": "+i]}catch(e){return eg.a.error("Cannot extract message for event "+Object(ng.e)(t)),[]}return[]},t.prototype._getEventFilterUrl=function(t){try{if(t.stacktrace){var e=t.stacktrace.frames;return e&&e[e.length-1].filename||null}if(t.exception){var n=t.exception.values&&t.exception.values[0].stacktrace&&t.exception.values[0].stacktrace.frames;return n&&n[n.length-1].filename||null}return null}catch(e){return eg.a.error("Cannot extract url for event "+Object(ng.e)(t)),null}},t.id="InboundFilters",t}();var ag=n(133),sg=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){return t.__proto__=e,t}:function(t,e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n]);return t});var lg=function(t){function e(e){var n=this.constructor,r=t.call(this,e)||this;return r.message=e,r.name=n.prototype.constructor.name,sg(r,n.prototype),r}return Zp.b(e,t),e}(Error),ug=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w\.-]+)(?::(\d+))?\/(.+)/,cg=function(){function t(t){"string"==typeof t?this._fromString(t):this._fromComponents(t),this._validate()}return t.prototype.toString=function(t){void 0===t&&(t=!1);var e=this,n=e.host,r=e.path,o=e.pass,i=e.port,a=e.projectId;return e.protocol+"://"+e.user+(t&&o?":"+o:"")+"@"+n+(i?":"+i:"")+"/"+(r?r+"/":r)+a},t.prototype._fromString=function(t){var e=ug.exec(t);if(!e)throw new lg("Invalid Dsn");var n=Zp.c(e.slice(1),6),r=n[0],o=n[1],i=n[2],a=void 0===i?"":i,s=n[3],l=n[4],u=void 0===l?"":l,c="",f=n[5],h=f.split("/");h.length>1&&(c=h.slice(0,-1).join("/"),f=h.pop()),this._fromComponents({host:s,pass:a,path:c,projectId:f,port:u,protocol:r,user:o})},t.prototype._fromComponents=function(t){this.protocol=t.protocol,this.user=t.user,this.pass=t.pass||"",this.host=t.host,this.port=t.port||"",this.path=t.path||"",this.projectId=t.projectId},t.prototype._validate=function(){var t=this;if(["protocol","user","host","projectId"].forEach((function(e){if(!t[e])throw new lg("Invalid Dsn")})),"http"!==this.protocol&&"https"!==this.protocol)throw new lg("Invalid Dsn");if(this.port&&isNaN(parseInt(this.port,10)))throw new lg("Invalid Dsn")},t}(),fg=n(77),hg=function(){function t(t){this.dsn=t,this._dsnObject=new cg(t)}return t.prototype.getDsn=function(){return this._dsnObject},t.prototype.getStoreEndpoint=function(){return""+this._getBaseUrl()+this.getStoreEndpointPath()},t.prototype.getStoreEndpointWithUrlEncodedAuth=function(){var t={sentry_key:this._dsnObject.user,sentry_version:"7"};return this.getStoreEndpoint()+"?"+Object(fg.e)(t)},t.prototype._getBaseUrl=function(){var t=this._dsnObject,e=t.protocol?t.protocol+":":"",n=t.port?":"+t.port:"";return e+"//"+t.host+n},t.prototype.getStoreEndpointPath=function(){var t=this._dsnObject;return(t.path?"/"+t.path:"")+"/api/"+t.projectId+"/store/"},t.prototype.getRequestHeaders=function(t,e){var n=this._dsnObject,r=["Sentry sentry_version=7"];return r.push("sentry_client="+t+"/"+e),r.push("sentry_key="+n.user),n.pass&&r.push("sentry_secret="+n.pass),{"Content-Type":"application/json","X-Sentry-Auth":r.join(", ")}},t.prototype.getReportDialogEndpoint=function(t){void 0===t&&(t={});var e=this._dsnObject,n=this._getBaseUrl()+(e.path?"/"+e.path:"")+"/api/embed/error-page/",r=[];for(var o in r.push("dsn="+e.toString()),t)if("user"===o){if(!t.user)continue;t.user.name&&r.push("name="+encodeURIComponent(t.user.name)),t.user.email&&r.push("email="+encodeURIComponent(t.user.email))}else r.push(encodeURIComponent(o)+"="+encodeURIComponent(t[o]));return r.length?n+"?"+r.join("&"):n},t}(),dg=n(51),pg=[];function gg(t){var e={};return function(t){var e=t.defaultIntegrations&&Zp.d(t.defaultIntegrations)||[],n=t.integrations,r=[];if(Array.isArray(n)){var o=n.map((function(t){return t.name})),i=[];e.forEach((function(t){-1===o.indexOf(t.name)&&-1===i.indexOf(t.name)&&(r.push(t),i.push(t.name))})),n.forEach((function(t){-1===i.indexOf(t.name)&&(r.push(t),i.push(t.name))}))}else"function"==typeof n?(r=n(e),r=Array.isArray(r)?r:[r]):r=Zp.d(e);var a=r.map((function(t){return t.name}));return-1!==a.indexOf("Debug")&&r.push.apply(r,Zp.d(r.splice(a.indexOf("Debug"),1))),r}(t).forEach((function(t){e[t.name]=t,function(t){-1===pg.indexOf(t.name)&&(t.setupOnce(Jp.b,tg.a),pg.push(t.name),eg.a.log("Integration installed: "+t.name))}(t)})),e}var vg,yg=function(){function t(t,e){this._integrations={},this._processing=!1,this._backend=new t(e),this._options=e,e.dsn&&(this._dsn=new cg(e.dsn)),this._isEnabled()&&(this._integrations=gg(this._options))}return t.prototype.captureException=function(t,e,n){var r=this,o=e&&e.event_id;return this._processing=!0,this._getBackend().eventFromException(t,e).then((function(t){return r._processEvent(t,e,n)})).then((function(t){o=t&&t.event_id,r._processing=!1})).then(null,(function(t){eg.a.error(t),r._processing=!1})),o},t.prototype.captureMessage=function(t,e,n,r){var o=this,i=n&&n.event_id;return this._processing=!0,(Object(dg.i)(t)?this._getBackend().eventFromMessage(""+t,e,n):this._getBackend().eventFromException(t,n)).then((function(t){return o._processEvent(t,n,r)})).then((function(t){i=t&&t.event_id,o._processing=!1})).then(null,(function(t){eg.a.error(t),o._processing=!1})),i},t.prototype.captureEvent=function(t,e,n){var r=this,o=e&&e.event_id;return this._processing=!0,this._processEvent(t,e,n).then((function(t){o=t&&t.event_id,r._processing=!1})).then(null,(function(t){eg.a.error(t),r._processing=!1})),o},t.prototype.getDsn=function(){return this._dsn},t.prototype.getOptions=function(){return this._options},t.prototype.flush=function(t){var e=this;return this._isClientProcessing(t).then((function(n){return clearInterval(n.interval),e._getBackend().getTransport().close(t).then((function(t){return n.ready&&t}))}))},t.prototype.close=function(t){var e=this;return this.flush(t).then((function(t){return e.getOptions().enabled=!1,t}))},t.prototype.getIntegrations=function(){return this._integrations||{}},t.prototype.getIntegration=function(t){try{return this._integrations[t.id]||null}catch(e){return eg.a.warn("Cannot retrieve integration "+t.id+" from the current Client"),null}},t.prototype._isClientProcessing=function(t){var e=this;return new ag.a((function(n){var r=0,o=0;clearInterval(o),o=setInterval((function(){e._processing?(r+=1,t&&r>=t&&n({interval:o,ready:!1})):n({interval:o,ready:!0})}),1)}))},t.prototype._getBackend=function(){return this._backend},t.prototype._isEnabled=function(){return!1!==this.getOptions().enabled&&void 0!==this._dsn},t.prototype._prepareEvent=function(t,e,n){var r=this,o=this.getOptions(),i=o.environment,a=o.release,s=o.dist,l=o.maxValueLength,u=void 0===l?250:l,c=o.normalizeDepth,f=void 0===c?3:c,h=Zp.a({},t);void 0===h.environment&&void 0!==i&&(h.environment=i),void 0===h.release&&void 0!==a&&(h.release=a),void 0===h.dist&&void 0!==s&&(h.dist=s),h.message&&(h.message=Object(rg.d)(h.message,u));var d=h.exception&&h.exception.values&&h.exception.values[0];d&&d.value&&(d.value=Object(rg.d)(d.value,u));var p=h.request;p&&p.url&&(p.url=Object(rg.d)(p.url,u)),void 0===h.event_id&&(h.event_id=n&&n.event_id?n.event_id:Object(ng.n)()),this._addIntegrations(h.sdk);var g=ag.a.resolve(h);return e&&(g=e.applyToEvent(h,n)),g.then((function(t){return"number"==typeof f&&f>0?r._normalizeEvent(t,f):t}))},t.prototype._normalizeEvent=function(t,e){return t?Zp.a({},t,t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map((function(t){return Zp.a({},t,t.data&&{data:Object(fg.c)(t.data,e)})}))},t.user&&{user:Object(fg.c)(t.user,e)},t.contexts&&{contexts:Object(fg.c)(t.contexts,e)},t.extra&&{extra:Object(fg.c)(t.extra,e)}):null},t.prototype._addIntegrations=function(t){var e=Object.keys(this._integrations);t&&e.length>0&&(t.integrations=e)},t.prototype._processEvent=function(t,e,n){var r=this,o=this.getOptions(),i=o.beforeSend,a=o.sampleRate;return this._isEnabled()?"number"==typeof a&&Math.random()>a?ag.a.reject("This event has been sampled, will not send event."):new ag.a((function(o,a){r._prepareEvent(t,n,e).then((function(t){if(null!==t){var n=t;if(e&&e.data&&!0===e.data.__sentry__||!i)return r._getBackend().sendEvent(n),void o(n);var s=i(t,e);if(void 0===s)eg.a.error("`beforeSend` method has to return `null` or a valid event.");else if(Object(dg.m)(s))r._handleAsyncBeforeSend(s,o,a);else{if(null===(n=s))return eg.a.log("`beforeSend` returned `null`, will not send event."),void o(null);r._getBackend().sendEvent(n),o(n)}}else a("An event processor returned null, will not send event.")})).then(null,(function(t){r.captureException(t,{data:{__sentry__:!0},originalException:t}),a("Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: "+t)}))})):ag.a.reject("SDK not enabled, will not send event.")},t.prototype._handleAsyncBeforeSend=function(t,e,n){var r=this;t.then((function(t){null!==t?(r._getBackend().sendEvent(t),e(t)):n("`beforeSend` returned `null`, will not send event.")})).then(null,(function(t){n("beforeSend rejected with "+t)}))},t}();!function(t){t.Unknown="unknown",t.Skipped="skipped",t.Success="success",t.RateLimit="rate_limit",t.Invalid="invalid",t.Failed="failed"}(vg||(vg={})),function(t){t.fromHttpCode=function(e){return e>=200&&e<300?t.Success:429===e?t.RateLimit:e>=400&&e<500?t.Invalid:e>=500?t.Failed:t.Unknown}}(vg||(vg={}));var mg,bg=function(){function t(){}return t.prototype.sendEvent=function(t){return ag.a.resolve({reason:"NoopTransport: Event has been skipped because no Dsn is configured.",status:vg.Skipped})},t.prototype.close=function(t){return ag.a.resolve(!0)},t}(),wg=function(){function t(t){this._options=t,this._options.dsn||eg.a.warn("No DSN provided, backend will not do anything."),this._transport=this._setupTransport()}return t.prototype._setupTransport=function(){return new bg},t.prototype.eventFromException=function(t,e){throw new lg("Backend has to implement `eventFromException` method")},t.prototype.eventFromMessage=function(t,e,n){throw new lg("Backend has to implement `eventFromMessage` method")},t.prototype.sendEvent=function(t){this._transport.sendEvent(t).then(null,(function(t){eg.a.error("Error while sending event: "+t)}))},t.prototype.getTransport=function(){return this._transport},t}();function Og(){if(!("fetch"in Object(ng.g)()))return!1;try{return new Headers,new Request(""),new Response,!0}catch(t){return!1}}function Cg(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function Eg(){if(!Og())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch(t){return!1}}!function(t){t.Fatal="fatal",t.Error="error",t.Warning="warning",t.Log="log",t.Info="info",t.Debug="debug",t.Critical="critical"}(mg||(mg={})),function(t){t.fromString=function(e){switch(e){case"debug":return t.Debug;case"info":return t.Info;case"warn":case"warning":return t.Warning;case"error":return t.Error;case"fatal":return t.Fatal;case"critical":return t.Critical;case"log":default:return t.Log}}}(mg||(mg={}));var Sg=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,kg=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js))(?::(\d+))?(?::(\d+))?\s*$/i,Rg=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,_g=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Tg=/\((\S*)(?::(\d+))(?::(\d+))\)/;function Mg(t){var e=null,n=t&&t.framesToPop;try{if(e=function(t){if(!t||!t.stacktrace)return null;for(var e,n=t.stacktrace,r=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,o=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,i=n.split("\n"),a=[],s=0;s<i.length;s+=2){var l=null;(e=r.exec(i[s]))?l={url:e[2],func:e[3],args:[],line:+e[1],column:null}:(e=o.exec(i[s]))&&(l={url:e[6],func:e[3]||e[4],args:e[5]?e[5].split(","):[],line:+e[1],column:+e[2]}),l&&(!l.func&&l.line&&(l.func="?"),a.push(l))}if(!a.length)return null;return{message:Ng(t),name:t.name,stack:a}}(t))return Ag(e,n)}catch(t){}try{if(e=function(t){if(!t||!t.stack)return null;for(var e,n,r,o=[],i=t.stack.split("\n"),a=0;a<i.length;++a){if(n=Sg.exec(i[a])){var s=n[2]&&0===n[2].indexOf("native");n[2]&&0===n[2].indexOf("eval")&&(e=Tg.exec(n[2]))&&(n[2]=e[1],n[3]=e[2],n[4]=e[3]),r={url:n[2]&&0===n[2].indexOf("address at ")?n[2].substr("address at ".length):n[2],func:n[1]||"?",args:s?[n[2]]:[],line:n[3]?+n[3]:null,column:n[4]?+n[4]:null}}else if(n=Rg.exec(i[a]))r={url:n[2],func:n[1]||"?",args:[],line:+n[3],column:n[4]?+n[4]:null};else{if(!(n=kg.exec(i[a])))continue;n[3]&&n[3].indexOf(" > eval")>-1&&(e=_g.exec(n[3]))?(n[1]=n[1]||"eval",n[3]=e[1],n[4]=e[2],n[5]=""):0!==a||n[5]||void 0===t.columnNumber||(o[0].column=t.columnNumber+1),r={url:n[3],func:n[1]||"?",args:n[2]?n[2].split(","):[],line:n[4]?+n[4]:null,column:n[5]?+n[5]:null}}!r.func&&r.line&&(r.func="?"),o.push(r)}if(!o.length)return null;return{message:Ng(t),name:t.name,stack:o}}(t))return Ag(e,n)}catch(t){}return{message:Ng(t),name:t&&t.name,stack:[],failed:!0}}function Ag(t,e){try{return Zp.a({},t,{stack:t.stack.slice(e)})}catch(e){return t}}function Ng(t){var e=t&&t.message;return e?e.error&&"string"==typeof e.error.message?e.error.message:e:"No error message"}function jg(t){var e=Ig(t.stack),n={type:t.name,value:t.message};return e&&e.length&&(n.stacktrace={frames:e}),void 0===n.type&&""===n.value&&(n.value="Unrecoverable error caught"),n}function xg(t){return{exception:{values:[jg(t)]}}}function Ig(t){if(!t||!t.length)return[];var e=t,n=e[0].func||"",r=e[e.length-1].func||"";return-1===n.indexOf("captureMessage")&&-1===n.indexOf("captureException")||(e=e.slice(1)),-1!==r.indexOf("sentryWrapped")&&(e=e.slice(0,-1)),e.map((function(t){return{colno:null===t.column?void 0:t.column,filename:t.url||e[0].url,function:t.func||"?",in_app:!0,lineno:null===t.line?void 0:t.line}})).slice(0,50).reverse()}function Dg(t,e,n){var r;if(void 0===n&&(n={}),Object(dg.e)(t)&&t.error)return r=xg(Mg(t=t.error));if(Object(dg.a)(t)||Object(dg.b)(t)){var o=t,i=o.name||(Object(dg.a)(o)?"DOMError":"DOMException"),a=o.message?i+": "+o.message:i;return r=Pg(a,e,n),Object(ng.b)(r,a),r}return Object(dg.d)(t)?r=xg(Mg(t)):Object(dg.h)(t)||Object(dg.f)(t)?(r=function(t,e,n){var r={exception:{values:[{type:Object(dg.f)(t)?t.constructor.name:n?"UnhandledRejection":"Error",value:"Non-Error "+(n?"promise rejection":"exception")+" captured with keys: "+Object(fg.a)(t)}]},extra:{__serialized__:Object(fg.d)(t)}};if(e){var o=Ig(Mg(e).stack);r.stacktrace={frames:o}}return r}(t,e,n.rejection),Object(ng.a)(r,{synthetic:!0}),r):(r=Pg(t,e,n),Object(ng.b)(r,""+t,void 0),Object(ng.a)(r,{synthetic:!0}),r)}function Pg(t,e,n){void 0===n&&(n={});var r={message:t};if(n.attachStacktrace&&e){var o=Ig(Mg(e).stack);r.stacktrace={frames:o}}return r}var Lg=function(){function t(t){this._limit=t,this._buffer=[]}return t.prototype.isReady=function(){return void 0===this._limit||this.length()<this._limit},t.prototype.add=function(t){var e=this;return this.isReady()?(-1===this._buffer.indexOf(t)&&this._buffer.push(t),t.then((function(){return e.remove(t)})).then(null,(function(){return e.remove(t).then(null,(function(){}))})),t):ag.a.reject(new lg("Not adding Promise due to buffer limit reached."))},t.prototype.remove=function(t){return this._buffer.splice(this._buffer.indexOf(t),1)[0]},t.prototype.length=function(){return this._buffer.length},t.prototype.drain=function(t){var e=this;return new ag.a((function(n){var r=setTimeout((function(){t&&t>0&&n(!1)}),t);ag.a.all(e._buffer).then((function(){clearTimeout(r),n(!0)})).then(null,(function(){n(!0)}))}))},t}(),Hg=function(){function t(t){this.options=t,this._buffer=new Lg(30),this.url=new hg(this.options.dsn).getStoreEndpointWithUrlEncodedAuth()}return t.prototype.sendEvent=function(t){throw new lg("Transport Class has to implement `sendEvent` method")},t.prototype.close=function(t){return this._buffer.drain(t)},t}(),Fg=Object(ng.g)(),Bg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._disabledUntil=new Date(Date.now()),e}return Zp.b(e,t),e.prototype.sendEvent=function(t){var e=this;if(new Date(Date.now())<this._disabledUntil)return Promise.reject({event:t,reason:"Transport locked till "+this._disabledUntil+" due to too many requests.",status:429});var n={body:JSON.stringify(t),method:"POST",referrerPolicy:Eg()?"origin":""};return void 0!==this.options.headers&&(n.headers=this.options.headers),this._buffer.add(new ag.a((function(t,r){Fg.fetch(e.url,n).then((function(n){var o=vg.fromHttpCode(n.status);if(o!==vg.Success){if(o===vg.RateLimit){var i=Date.now();e._disabledUntil=new Date(i+Object(ng.k)(i,n.headers.get("Retry-After"))),eg.a.warn("Too many requests, backing off till: "+e._disabledUntil)}r(n)}else t({status:o})})).catch(r)})))},e}(Hg),Ug=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._disabledUntil=new Date(Date.now()),e}return Zp.b(e,t),e.prototype.sendEvent=function(t){var e=this;return new Date(Date.now())<this._disabledUntil?Promise.reject({event:t,reason:"Transport locked till "+this._disabledUntil+" due to too many requests.",status:429}):this._buffer.add(new ag.a((function(n,r){var o=new XMLHttpRequest;for(var i in o.onreadystatechange=function(){if(4===o.readyState){var t=vg.fromHttpCode(o.status);if(t!==vg.Success){if(t===vg.RateLimit){var i=Date.now();e._disabledUntil=new Date(i+Object(ng.k)(i,o.getResponseHeader("Retry-After"))),eg.a.warn("Too many requests, backing off till: "+e._disabledUntil)}r(o)}else n({status:t})}},o.open("POST",e.url),e.options.headers)e.options.headers.hasOwnProperty(i)&&o.setRequestHeader(i,e.options.headers[i]);o.send(JSON.stringify(t))})))},e}(Hg),Wg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zp.b(e,t),e.prototype._setupTransport=function(){if(!this._options.dsn)return t.prototype._setupTransport.call(this);var e=Zp.a({},this._options.transportOptions,{dsn:this._options.dsn});return this._options.transport?new this._options.transport(e):Og()?new Bg(e):new Ug(e)},e.prototype.eventFromException=function(t,e){var n=Dg(t,e&&e.syntheticException||void 0,{attachStacktrace:this._options.attachStacktrace});return Object(ng.a)(n,{handled:!0,type:"generic"}),n.level=mg.Error,e&&e.event_id&&(n.event_id=e.event_id),ag.a.resolve(n)},e.prototype.eventFromMessage=function(t,e,n){void 0===e&&(e=mg.Info);var r=Pg(t,n&&n.syntheticException||void 0,{attachStacktrace:this._options.attachStacktrace});return r.level=e,n&&n.event_id&&(r.event_id=n.event_id),ag.a.resolve(r)},e}(wg),Vg=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Wg,e)||this}return Zp.b(e,t),e.prototype._prepareEvent=function(e,n,r){return e.platform=e.platform||"javascript",e.sdk=Zp.a({},e.sdk,{name:"sentry.javascript.browser",packages:Zp.d(e.sdk&&e.sdk.packages||[],[{name:"npm:@sentry/browser",version:"5.13.0"}]),version:"5.13.0"}),t.prototype._prepareEvent.call(this,e,n,r)},e.prototype.showReportDialog=function(t){void 0===t&&(t={});var e=Object(ng.g)().document;if(e)if(this._isEnabled()){var n=t.dsn||this.getDsn();if(t.eventId)if(n){var r=e.createElement("script");r.async=!0,r.src=new hg(n).getReportDialogEndpoint(t),t.onLoad&&(r.onload=t.onLoad),(e.head||e.body).appendChild(r)}else eg.a.error("Missing `Dsn` option in showReportDialog call");else eg.a.error("Missing `eventId` option in showReportDialog call")}else eg.a.error("Trying to call showReportDialog with Sentry Client is disabled")},e}(yg);function Yg(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=Object(tg.a)();if(r&&r[t])return r[t].apply(r,Zp.d(e));throw new Error("No hub defined or "+t+" was not found on the hub, please open a bug report.")}function zg(t){var e;try{throw new Error("Sentry syntheticException")}catch(t){e=t}return Yg("captureException",t,{originalException:t,syntheticException:e})}function Gg(t){Yg("withScope",t)}var Xg=0;function qg(){return Xg>0}function Kg(){Xg+=1,setTimeout((function(){Xg-=1}))}function $g(t,e,n){if(void 0===e&&(e={}),"function"!=typeof t)return t;try{if(t.__sentry__)return t;if(t.__sentry_wrapped__)return t.__sentry_wrapped__}catch(e){return t}var r=function(){var r=Array.prototype.slice.call(arguments);try{n&&"function"==typeof n&&n.apply(this,arguments);var o=r.map((function(t){return $g(t,e)}));return t.handleEvent?t.handleEvent.apply(this,o):t.apply(this,o)}catch(t){throw Kg(),Gg((function(n){n.addEventProcessor((function(t){var n=Zp.a({},t);return e.mechanism&&(Object(ng.b)(n,void 0,void 0),Object(ng.a)(n,e.mechanism)),n.extra=Zp.a({},n.extra,{arguments:r}),n})),zg(t)})),t}};try{for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}catch(t){}t.prototype=t.prototype||{},r.prototype=t.prototype,Object.defineProperty(t,"__sentry_wrapped__",{enumerable:!1,value:r}),Object.defineProperties(r,{__sentry__:{enumerable:!1,value:!0},__sentry_original__:{enumerable:!1,value:t}});try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get:function(){return t.name}})}catch(t){}return r}var Qg,Zg=function(){function t(){this._ignoreOnError=0,this.name=t.id}return t.prototype._wrapTimeFunction=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e[0];return e[0]=$g(r,{mechanism:{data:{function:Object(ng.f)(t)},handled:!0,type:"instrument"}}),t.apply(this,e)}},t.prototype._wrapRAF=function(t){return function(e){return t($g(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Object(ng.f)(t)},handled:!0,type:"instrument"}}))}},t.prototype._wrapEventTarget=function(t){var e=Object(ng.g)(),n=e[t]&&e[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(Object(fg.b)(n,"addEventListener",(function(e){return function(n,r,o){try{"function"==typeof r.handleEvent&&(r.handleEvent=$g(r.handleEvent.bind(r),{mechanism:{data:{function:"handleEvent",handler:Object(ng.f)(r),target:t},handled:!0,type:"instrument"}}))}catch(t){}return e.call(this,n,$g(r,{mechanism:{data:{function:"addEventListener",handler:Object(ng.f)(r),target:t},handled:!0,type:"instrument"}}),o)}})),Object(fg.b)(n,"removeEventListener",(function(t){return function(e,n,r){var o=n;try{o=o&&(o.__sentry_wrapped__||o)}catch(t){}return t.call(this,e,o,r)}})))},t.prototype._wrapXHR=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=this,o=["onload","onerror","onprogress","onreadystatechange"];return o.forEach((function(t){t in r&&"function"==typeof r[t]&&Object(fg.b)(r,t,(function(e){var n={mechanism:{data:{function:t,handler:Object(ng.f)(e)},handled:!0,type:"instrument"}};return e.__sentry_original__&&(n.mechanism.data.handler=Object(ng.f)(e.__sentry_original__)),$g(e,n)}))})),t.apply(this,e)}},t.prototype.setupOnce=function(){this._ignoreOnError=this._ignoreOnError;var t=Object(ng.g)();Object(fg.b)(t,"setTimeout",this._wrapTimeFunction.bind(this)),Object(fg.b)(t,"setInterval",this._wrapTimeFunction.bind(this)),Object(fg.b)(t,"requestAnimationFrame",this._wrapRAF.bind(this)),"XMLHttpRequest"in t&&Object(fg.b)(XMLHttpRequest.prototype,"send",this._wrapXHR.bind(this)),["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].forEach(this._wrapEventTarget.bind(this))},t.id="TryCatch",t}(),Jg=Object(ng.g)(),tv={},ev={};function nv(t){if(!ev[t])switch(ev[t]=!0,t){case"console":!function(){if(!("console"in Jg))return;["debug","info","warn","error","log","assert"].forEach((function(t){t in Jg.console&&Object(fg.b)(Jg.console,t,(function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];ov("console",{args:n,level:t}),e&&Function.prototype.apply.call(e,Jg.console,n)}}))}))}();break;case"dom":!function(){if(!("document"in Jg))return;Jg.document.addEventListener("click",cv("click",ov.bind(null,"dom")),!1),Jg.document.addEventListener("keypress",fv(ov.bind(null,"dom")),!1),["EventTarget","Node"].forEach((function(t){var e=Jg[t]&&Jg[t].prototype;e&&e.hasOwnProperty&&e.hasOwnProperty("addEventListener")&&(Object(fg.b)(e,"addEventListener",(function(t){return function(e,n,r){return n&&n.handleEvent?("click"===e&&Object(fg.b)(n,"handleEvent",(function(t){return function(e){return cv("click",ov.bind(null,"dom"))(e),t.call(this,e)}})),"keypress"===e&&Object(fg.b)(n,"handleEvent",(function(t){return function(e){return fv(ov.bind(null,"dom"))(e),t.call(this,e)}}))):("click"===e&&cv("click",ov.bind(null,"dom"),!0)(this),"keypress"===e&&fv(ov.bind(null,"dom"))(this)),t.call(this,e,n,r)}})),Object(fg.b)(e,"removeEventListener",(function(t){return function(e,n,r){var o=n;try{o=o&&(o.__sentry_wrapped__||o)}catch(t){}return t.call(this,e,o,r)}})))}))}();break;case"xhr":!function(){if(!("XMLHttpRequest"in Jg))return;var t=XMLHttpRequest.prototype;Object(fg.b)(t,"open",(function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e[1];return this.__sentry_xhr__={method:Object(dg.k)(e[0])?e[0].toUpperCase():e[0],url:e[1]},Object(dg.k)(r)&&"POST"===this.__sentry_xhr__.method&&r.match(/sentry_key/)&&(this.__sentry_own_request__=!0),t.apply(this,e)}})),Object(fg.b)(t,"send",(function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=this,o={args:e,startTimestamp:Date.now(),xhr:r};return ov("xhr",Zp.a({},o)),r.addEventListener("readystatechange",(function(){if(4===r.readyState){try{r.__sentry_xhr__&&(r.__sentry_xhr__.status_code=r.status)}catch(t){}ov("xhr",Zp.a({},o,{endTimestamp:Date.now()}))}})),t.apply(this,e)}}))}();break;case"fetch":!function(){if(!function(){if(!Og())return!1;var t=Object(ng.g)();if(Cg(t.fetch))return!0;var e=!1,n=t.document;if(n)try{var r=n.createElement("iframe");r.hidden=!0,n.head.appendChild(r),r.contentWindow&&r.contentWindow.fetch&&(e=Cg(r.contentWindow.fetch)),n.head.removeChild(r)}catch(t){eg.a.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",t)}return e}())return;Object(fg.b)(Jg,"fetch",(function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r={args:e,fetchData:{method:iv(e),url:av(e)},startTimestamp:Date.now()};return ov("fetch",Zp.a({},r)),t.apply(Jg,e).then((function(t){return ov("fetch",Zp.a({},r,{endTimestamp:Date.now(),response:t})),t}),(function(t){throw ov("fetch",Zp.a({},r,{endTimestamp:Date.now(),error:t})),t}))}}))}();break;case"history":!function(){if(t=Object(ng.g)(),e=t.chrome,n=e&&e.app&&e.app.runtime,r="history"in t&&!!t.history.pushState&&!!t.history.replaceState,n||!r)return;var t,e,n,r;var o=Jg.onpopstate;function i(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.length>2?e[2]:void 0;if(r){var o=Qg,i=String(r);Qg=i,ov("history",{from:o,to:i})}return t.apply(this,e)}}Jg.onpopstate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Jg.location.href,r=Qg;if(Qg=n,ov("history",{from:r,to:n}),o)return o.apply(this,t)},Object(fg.b)(Jg.history,"pushState",i),Object(fg.b)(Jg.history,"replaceState",i)}();break;default:eg.a.warn("unknown instrumentation type:",t)}}function rv(t){t&&"string"==typeof t.type&&"function"==typeof t.callback&&(tv[t.type]=tv[t.type]||[],tv[t.type].push(t.callback),nv(t.type))}function ov(t,e){var n,r;if(t&&tv[t])try{for(var o=Zp.e(tv[t]||[]),i=o.next();!i.done;i=o.next()){var a=i.value;try{a(e)}catch(e){eg.a.error("Error while triggering instrumentation handler.\nType: "+t+"\nName: "+Object(ng.f)(a)+"\nError: "+e)}}}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}function iv(t){return void 0===t&&(t=[]),"Request"in Jg&&Object(dg.g)(t[0],Request)&&t[0].method?String(t[0].method).toUpperCase():t[1]&&t[1].method?String(t[1].method).toUpperCase():"GET"}function av(t){return void 0===t&&(t=[]),"string"==typeof t[0]?t[0]:"Request"in Jg&&Object(dg.g)(t[0],Request)?t[0].url:String(t[0])}var sv,lv,uv=0;function cv(t,e,n){return void 0===n&&(n=!1),function(r){sv=void 0,r&&lv!==r&&(lv=r,uv&&clearTimeout(uv),n?uv=setTimeout((function(){e({event:r,name:t})})):e({event:r,name:t}))}}function fv(t){return function(e){var n;try{n=e.target}catch(t){return}var r=n&&n.tagName;r&&("INPUT"===r||"TEXTAREA"===r||n.isContentEditable)&&(sv||cv("input",t)(e),clearTimeout(sv),sv=setTimeout((function(){sv=void 0}),1e3))}}var hv=function(){function t(e){this.name=t.id,this._options=Zp.a({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},e)}return t.prototype._consoleBreadcrumb=function(t){var e={category:"console",data:{arguments:t.args,logger:"console"},level:mg.fromString(t.level),message:Object(rg.b)(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;e.message="Assertion failed: "+(Object(rg.b)(t.args.slice(1)," ")||"console.assert"),e.data.arguments=t.args.slice(1)}Object(tg.a)().addBreadcrumb(e,{input:t.args,level:t.level})},t.prototype._domBreadcrumb=function(t){var e;try{e=t.event.target?Object(ng.i)(t.event.target):Object(ng.i)(t.event)}catch(t){e="<unknown>"}0!==e.length&&Object(tg.a)().addBreadcrumb({category:"ui."+t.name,message:e},{event:event,name:t.name})},t.prototype._xhrBreadcrumb=function(t){if(t.endTimestamp){if(t.xhr.__sentry_own_request__)return;Object(tg.a)().addBreadcrumb({category:"xhr",data:t.xhr.__sentry_xhr__,type:"http"},{xhr:t.xhr})}else t.xhr.__sentry_own_request__&&dv(t.args[0])},t.prototype._fetchBreadcrumb=function(t){if(t.endTimestamp){var e=Object(tg.a)().getClient(),n=e&&e.getDsn();if(n){var r=new hg(n).getStoreEndpoint();if(r&&-1!==t.fetchData.url.indexOf(r)&&"POST"===t.fetchData.method&&t.args[1]&&t.args[1].body)return void dv(t.args[1].body)}t.error?Object(tg.a)().addBreadcrumb({category:"fetch",data:Zp.a({},t.fetchData,{status_code:t.response.status}),level:mg.Error,type:"http"},{data:t.error,input:t.args}):Object(tg.a)().addBreadcrumb({category:"fetch",data:Zp.a({},t.fetchData,{status_code:t.response.status}),type:"http"},{input:t.args,response:t.response})}},t.prototype._historyBreadcrumb=function(t){var e=Object(ng.g)(),n=t.from,r=t.to,o=Object(ng.l)(e.location.href),i=Object(ng.l)(n),a=Object(ng.l)(r);i.path||(i=o),o.protocol===a.protocol&&o.host===a.host&&(r=a.relative),o.protocol===i.protocol&&o.host===i.host&&(n=i.relative),Object(tg.a)().addBreadcrumb({category:"navigation",data:{from:n,to:r}})},t.prototype.setupOnce=function(){var t=this;this._options.console&&rv({callback:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._consoleBreadcrumb.apply(t,Zp.d(e))},type:"console"}),this._options.dom&&rv({callback:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._domBreadcrumb.apply(t,Zp.d(e))},type:"dom"}),this._options.xhr&&rv({callback:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._xhrBreadcrumb.apply(t,Zp.d(e))},type:"xhr"}),this._options.fetch&&rv({callback:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._fetchBreadcrumb.apply(t,Zp.d(e))},type:"fetch"}),this._options.history&&rv({callback:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._historyBreadcrumb.apply(t,Zp.d(e))},type:"history"})},t.id="Breadcrumbs",t}();function dv(t){try{var e=JSON.parse(t);Object(tg.a)().addBreadcrumb({category:"sentry."+("transaction"===e.type?"transaction":"event"),event_id:e.event_id,level:e.level||mg.fromString("error"),message:Object(ng.e)(e)},{event:e})}catch(t){eg.a.error("Error while adding sentry type breadcrumb")}}var pv=function(){function t(e){this.name=t.id,this._global=Object(ng.g)(),this._oldOnErrorHandler=null,this._oldOnUnhandledRejectionHandler=null,this._onErrorHandlerInstalled=!1,this._onUnhandledRejectionHandlerInstalled=!1,this._options=Zp.a({onerror:!0,onunhandledrejection:!0},e)}return t.prototype.setupOnce=function(){Error.stackTraceLimit=50,this._options.onerror&&(eg.a.log("Global Handler attached: onerror"),this._installGlobalOnErrorHandler()),this._options.onunhandledrejection&&(eg.a.log("Global Handler attached: onunhandledrejection"),this._installGlobalOnUnhandledRejectionHandler())},t.prototype._installGlobalOnErrorHandler=function(){if(!this._onErrorHandlerInstalled){var e=this;this._oldOnErrorHandler=this._global.onerror,this._global.onerror=function(n,r,o,i,a){var s=Object(tg.a)(),l=s.getIntegration(t),u=a&&!0===a.__sentry_own_request__;if(!l||qg()||u)return!!e._oldOnErrorHandler&&e._oldOnErrorHandler.apply(this,arguments);var c=s.getClient(),f=Object(dg.i)(a)?e._eventFromIncompleteOnError(n,r,o,i):e._enhanceEventWithInitialFrame(Dg(a,void 0,{attachStacktrace:c&&c.getOptions().attachStacktrace,rejection:!1}),r,o,i);return Object(ng.a)(f,{handled:!1,type:"onerror"}),s.captureEvent(f,{originalException:a}),!!e._oldOnErrorHandler&&e._oldOnErrorHandler.apply(this,arguments)},this._onErrorHandlerInstalled=!0}},t.prototype._installGlobalOnUnhandledRejectionHandler=function(){if(!this._onUnhandledRejectionHandlerInstalled){var e=this;this._oldOnUnhandledRejectionHandler=this._global.onunhandledrejection,this._global.onunhandledrejection=function(n){var r=n;try{"reason"in n?r=n.reason:"detail"in n&&"reason"in n.detail&&(r=n.detail.reason)}catch(t){}var o=Object(tg.a)(),i=o.getIntegration(t),a=r&&!0===r.__sentry_own_request__;if(!i||qg()||a)return!e._oldOnUnhandledRejectionHandler||e._oldOnUnhandledRejectionHandler.apply(this,arguments);var s=o.getClient(),l=Object(dg.i)(r)?e._eventFromIncompleteRejection(r):Dg(r,void 0,{attachStacktrace:s&&s.getOptions().attachStacktrace,rejection:!0});return l.level=mg.Error,Object(ng.a)(l,{handled:!1,type:"onunhandledrejection"}),o.captureEvent(l,{originalException:r}),!e._oldOnUnhandledRejectionHandler||e._oldOnUnhandledRejectionHandler.apply(this,arguments)},this._onUnhandledRejectionHandlerInstalled=!0}},t.prototype._eventFromIncompleteOnError=function(t,e,n,r){var o,i=Object(dg.e)(t)?t.message:t;if(Object(dg.k)(i)){var a=i.match(/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i);a&&(o=a[1],i=a[2])}var s={exception:{values:[{type:o||"Error",value:i}]}};return this._enhanceEventWithInitialFrame(s,e,n,r)},t.prototype._eventFromIncompleteRejection=function(t){return{exception:{values:[{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+t}]}}},t.prototype._enhanceEventWithInitialFrame=function(t,e,n,r){t.exception=t.exception||{},t.exception.values=t.exception.values||[],t.exception.values[0]=t.exception.values[0]||{},t.exception.values[0].stacktrace=t.exception.values[0].stacktrace||{},t.exception.values[0].stacktrace.frames=t.exception.values[0].stacktrace.frames||[];var o=isNaN(parseInt(r,10))?void 0:r,i=isNaN(parseInt(n,10))?void 0:n,a=Object(dg.k)(e)&&e.length>0?e:Object(ng.h)();return 0===t.exception.values[0].stacktrace.frames.length&&t.exception.values[0].stacktrace.frames.push({colno:o,filename:a,function:"?",in_app:!0,lineno:i}),t},t.id="GlobalHandlers",t}(),gv=function(){function t(e){void 0===e&&(e={}),this.name=t.id,this._key=e.key||"cause",this._limit=e.limit||5}return t.prototype.setupOnce=function(){Object(Jp.b)((function(e,n){var r=Object(tg.a)().getIntegration(t);return r?r._handler(e,n):e}))},t.prototype._handler=function(t,e){if(!(t.exception&&t.exception.values&&e&&Object(dg.g)(e.originalException,Error)))return t;var n=this._walkErrorTree(e.originalException,this._key);return t.exception.values=Zp.d(n,t.exception.values),t},t.prototype._walkErrorTree=function(t,e,n){if(void 0===n&&(n=[]),!Object(dg.g)(t[e],Error)||n.length+1>=this._limit)return n;var r=jg(Mg(t[e]));return this._walkErrorTree(t[e],e,Zp.d([r],n))},t.id="LinkedErrors",t}(),vv=Object(ng.g)(),yv=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(){Object(Jp.b)((function(e){if(Object(tg.a)().getIntegration(t)){if(!vv.navigator||!vv.location)return e;var n=e.request||{};return n.url=n.url||vv.location.href,n.headers=n.headers||{},n.headers["User-Agent"]=vv.navigator.userAgent,Zp.a({},e,{request:n})}return e}))},t.id="UserAgent",t}(),mv=[new c.InboundFilters,new c.FunctionToString,new Zg,new hv,new pv,new gv,new yv];n(179);function bv(t){return t.toLowerCase().replace(/\b[a-z]/g,t=>t.toUpperCase())}function wv(t){window.innerWidth>550?t.fit(500,500):t.fit(window.innerWidth,window.innerHeight)}function Ov(t){for(;null===t[t.length-1]||""===t[t.length-1];)t.pop();return t}function Cv(t){const e=[];return t.forEach(t=>{const[n,r,o]=Object.values(t);e.push([n,o,r])}),e}const Ev=h.a.ternary.graticule().majorInterval(.2).minorInterval(.05),Sv=window.innerWidth>500?[500,500]:[window.innerWidth,window.innerWidth],kv=h.a.ternary.plot().call(wv,Sv).call(h.a.ternary.scalebars()).call(h.a.ternary.neatline()).call(Ev);let Rv,_v=!1;const Tv=["colour","color","shape","linestyle","title","opacity","strokewidth","opacity"];function Mv(){h.a.selectAll(".vertex-label").remove(),_v=!1,Rv=void 0}function Av(t){if(Rv){if(JSON.stringify(t.slice(0,3))!==JSON.stringify(Rv)){const e=document.createElement("div");e.innerHTML=`The current labels are <code>'${Rv}'</code> and you're now trying to plot data with columns <code>'${t.slice(0,3)}'</code>. Your data will still be plotted, but it might not appear the way you intended. <br> Try clicking the <input type="button" id="specialClearLabels" aria-label="Remove Labels" value="Remove Labels"> button and plotting again.`,Kp()({title:"Your columns names entered in the Points, Lines and Areas tables don't seem to match",content:e,icon:"warning"}),document.getElementById("specialClearLabels").addEventListener("click",Mv)}}else Rv=t.slice(0,3),_v||(!function(t){const e=t.columns.slice(0,3);kv.call(h.a.ternary.vertexLabels(e))}({columns:t}),_v=!0);Rv.filter(t=>Tv.includes(t.toLowerCase())).some(()=>Kp()("Reserved column name",`You can't use any of the following names as your columns names (i.e. the first three columns): ${Tv.join(", ")}`,"error"))}function Nv(t){const[e,n,r]=Object.values(t),o=[e,r,n],i=[[o,[0,parseFloat(e)+parseFloat(r),parseFloat(n)]],[o,[parseFloat(e),0,parseFloat(r)+parseFloat(n)]],[o,[parseFloat(e)+parseFloat(n),parseFloat(r),0]]];kv.plot().selectAll(".line").data(i).enter().append("path").attr("class","help-line").attr("d",t=>kv.path(t)).attr("stroke-dasharray","3, 3, 3").attr("stroke","black").attr("stroke-width","1px").attr("z-index","-1")}const jv={Points(t){let e=t,n=e.shift();return Av(n),e.map(t=>Ov(t)),n=Ov(n),e=e.filter(t=>0!==t.length),e.map(t=>n.reduce((e,n,r)=>{const o=e;return o[n.toString().toLowerCase()]=t[r],o},{}))},LinesAreas(t){const e=t;let n=e.shift();Av(n),e.map(t=>Ov(t)),n=Ov(n);const r=[];let o=[];for(const t of e)0!==t.length?o.push(t):0===t.length&&(0!==o.length&&r.push(o),o=[]);return r.map(t=>t.map(t=>n.reduce((e,n,r)=>{const o=e;return o[n.toLowerCase()]=t[r],o},{})))}},xv={defaults:{pointColor:"black",pointShape:"circle",pointSize:70,lineStyle:"none",lineColor:"black",lineStrokewidth:"4px",areaColor:"gold",areaOpacity:.2},setListeners(){document.querySelector("#defaultColorPoints").onchange=({target:t})=>{xv.defaults.pointColor=t.value},document.querySelector("select[name='defaultShape']").onchange=({target:t})=>{xv.defaults.pointShape=t.value},document.querySelector("#defaultPointsize").onchange=({target:t})=>{xv.defaults.pointSize=t.value},document.querySelector("#defaultColorLines").onchange=({target:t})=>{xv.defaults.lineColor=t.value},document.querySelector("select[name='defaultLineStyle']").onchange=({target:t})=>{xv.defaults.lineStyle=t.value},document.querySelector("#defaultLinewidth").onchange=({target:t})=>{xv.defaults.lineStrokewidth=t.value},document.querySelector("#defaultColorAreas").onchange=({target:t})=>{xv.defaults.areaColor=t.value},document.querySelector("select[name='defaultAreaOpacity']").onchange=({target:t})=>{xv.defaults.areaOpacity=t.value}},Points(t){const e=t.slice([0,3]),n=h.a.svg.symbol();kv.plot().selectAll(".point").data(e).enter().append("path").attr("class","point").attr("fill",t=>t.color?t.color.trim():t.colour?t.colour.trim():xv.defaults.pointColor).attr("fill-opacity",({opacity:t})=>t||1).attr("d",n.type(({shape:t})=>t?t.trim():xv.defaults.pointShape).size(({size:t})=>t||xv.defaults.pointSize)).attr("transform",t=>{const[e,n,r]=Object.values(t),o=[e,r,n],[i,a]=kv.point(o);return`translate(${i},${a})`}).on("mouseover",Nv).on("mouseout",()=>{h.a.selectAll(".help-line").remove()}).append("title").text(t=>{const[e,n,r]=Object.entries(t),o=`${e.join(": ")}\n${n.join(": ")}\n${r.join(": ")}`;return t.title?`${bv(t.title.trim())}\n${o}`:o})},Lines(t){const e=kv.plot().selectAll(".line").data(t),n={dotted:"3 2","dot-dash":"10 3 4 3","dot-dot-dash":"10 3 4 3 4 3","short-dashed":4,"medium-dashed":17,"long-dashed":26};e.enter().append("path").attr("class","ternary-line").attr("d",t=>{const e=Cv(t);return kv.path(e)}).attr("stroke-dasharray",([{linestyle:t}])=>t?n[t]:xv.defaults.lineStyle).attr("stroke",([t])=>t.color?t.color.trim():t.colour?t.colour.trim():xv.defaults.lineColor).attr("stroke-opacity",([{opacity:t}])=>t?t.trim():1).attr("fill-opacity","0").attr("stroke-width",([{strokewidth:t}])=>t||xv.defaults.lineStrokewidth).filter(([{title:t}])=>t).append("title").text(([{title:t}])=>bv(t.toString().trim()))},Areas(t){kv.plot().selectAll(".area").data(t).enter().append("path").attr("class","ternary-area").attr("d",t=>{const e=Cv(t);return kv.area(e)}).attr("z-index",-1).attr("fill",([t])=>t.color?t.color.trim():t.colour?t.colour.trim():xv.defaults.lineColor).attr("fill-opacity",([{opacity:t}])=>t||.5).filter(([{title:t}])=>t).append("title").text(([{title:t}])=>bv(t.toString().trim()))}};h.a.select("#ternary-plot").call(kv),window.addEventListener("resize",wv(kv));n(261),n(262);if(function(t){if(void 0===t&&(t={}),void 0===t.defaultIntegrations&&(t.defaultIntegrations=mv),void 0===t.release){var e=Object(ng.g)();e.SENTRY_RELEASE&&e.SENTRY_RELEASE.id&&(t.release=e.SENTRY_RELEASE.id)}!function(t,e){!0===e.debug&&eg.a.enable(),Object(tg.a)().bindClient(new t(e))}(Vg,t)}({dsn:"https://c5f23918169a47e482965fb2461d0c6c@sentry.io/3228669"}),$p.install(),document.cookie.split(";").filter(t=>t.includes("visited=true")).length)document.querySelector("#intro").remove();else{const t=document.getElementById("closeIntro");t.addEventListener("click",()=>{t.parentElement.remove()});const e=new Date;e.setDate(e.getDate()+2),document.cookie=`visited=true;expires=${e}`}function Iv(t){h.a.selectAll(t).remove()}const Dv=window.innerWidth>500?500:window.innerWidth-20;function Pv(t,e,n){return new Xp(document.getElementById(t),{colHeaders:e,columns:n,fixedRowsTop:1,rowHeaders:!0,minRows:60,height:330,width:Dv,manualRowMove:!0,dropdownMenu:!0,manualColumnResize:!0,licenseKey:"non-commercial-and-evaluation",cells(t){const e={};return e.renderer=0===t?"firstRowRenderer":"emptyCellRenderer",e},afterChange(){const e=t;this.getData()[0][0]&&(localStorage[e]=JSON.stringify(this.getData()))}})}Xp.renderers.registerRenderer("emptyCellRenderer",(function(t,e,n,r,o,i){Xp.renderers.TextRenderer.apply(this,arguments),n>0&&(null!==i&&""!==i||(e.style.background="#efefef"))})),Xp.renderers.registerRenderer("firstRowRenderer",(function(t,e){Xp.renderers.TextRenderer.apply(this,arguments),e.style.fontWeight="bold",e.style.background="#f0f8ff",e.className="keep-blue"}));const Lv=["Variable 1","Variable 2","Variable 3","Color","Shape","Size","Opacity","Title"],Hv=Pv("pointsTable",Lv.slice(0,3),[{type:"numeric"},{type:"numeric"},{type:"numeric"},{},{type:"dropdown",source:["circle","cross","diamond","triangle-down","triangle-up"]},{type:"numeric"},{type:"numeric"},{}]),Fv=document.enterPoints;Xp.dom.addEvent(Fv,"submit",t=>{t.preventDefault(),Iv(".point");const e=jv.Points(Hv.getData());xv.Points(e)});const Bv=["Variable 1","Variable 2","Variable 3","Color","Linestyle","Strokewidth","Title"],Uv=Pv("linesTable",Bv.slice(0,3),[{type:"numeric"},{type:"numeric"},{type:"numeric"},{},{type:"dropdown",source:["dotted","dot-dash","dot-dot-dash","short-dashed","medium-dashed","long-dashed"]},{type:"numeric"},{}]),Wv=document.enterLines;Xp.dom.addEvent(Wv,"submit",t=>{t.preventDefault(),Iv(".ternary-line");const e=jv.LinesAreas(Uv.getData());xv.Lines(e)});const Vv=["Variable 1","Variable 2","Variable 3","Color","Opacity","Title"],Yv=Pv("areasTable",Vv.slice(0,3),[{type:"numeric"},{type:"numeric"},{type:"numeric"},{},{},{}]),zv=document.enterAreas;Xp.dom.addEvent(zv,"submit",t=>{t.preventDefault(),Iv(".ternary-area");const e=jv.LinesAreas(Yv.getData());xv.Areas(e)});const Gv=(t,e,n)=>{Hv.loadData(t),Uv.loadData(e),Yv.loadData(n)},Xv=()=>{Gv([["1. Sand","2. Silt","3. Clay","Color","Shape","Size","Opacity","Title"],[.3,.3,.4,"limegreen",,,1,"Sample Nr 1"],[1,0,0],[0,1,0],[0,0,1],[.2,.5,.3,"coral",,800,.5,"Half opacity big point"],[.3,.1,.6,"magenta","cross"],[.5,.5,0,"#d1b621","diamond"],[.6,.2,.2,"peru","triangle-up"]],[["1. Sand","2. Silt","3. Clay","Color","Linestyle","Strokewidth","Title"],[.2,.8,0,"orangered","dot-dash",2,"Dotted line #1"],[.8,0,.2],[],[.1,.1,.8,"slateblue"],[.4,.1,.5],[0,0,1]],[["1. Sand","2. Silt","3. Clay","Color","Opacity","Title"],[0,.5,.5,"palegreen",.1,"More than 50% silt"],[.5,.5,0],[0,1,0],[],[.5,0,.5,"moccasin",.4,"More than 50% sand"],[.5,.5,0],[1,0,0],[],[0,.5,.5,"coral",.3,"More than 50% clay"],[.5,0,.5],[0,0,1]])};if(localStorage.getItem("pointsTable")){const t=document.createElement("div");t.innerHTML='\n    <p>If you have found this site to be useful consider</p>\n    <div class=\'donate-buttons\'>\n      <a class="donate" role="button" href="https://paypal.me/BlomJ" rel="noopener noreferrer" target="_blank">donating</a>\n      <a class="bmc-button" rel="noopener" target="_blank" href="https://www.buymeacoffee.com/OfU1nAuiI">\n        <img src="https://bmc-cdn.nyc3.digitaloceanspaces.com/BMC-button-images/BMC-btn-logo.svg" alt="Buying me a coffee">\n        <span style="margin-left:5px">Buy me a coffee</span>\n      </a>\n    </div>\n    <hr>\n    <p>\n      <strong>Do you wan\'t to load your previously entered data into the tables?</strong>\n    </p>\n  ',Kp()({title:"You've been here before!",content:t,buttons:{sample:{text:"No, show example data",value:null,visible:!0,className:"show-sample",closeModal:!0},empty:{text:"No, empty the tables",value:"empty",visible:!0,className:"show-empty",closeModal:!0},load:{text:"Yes, load previous data",value:"ok",visible:!0,className:"load-old",closeModal:!0}}}).then(t=>{if("ok"===t){const t=JSON.parse(localStorage.getItem("pointsTable")),e=JSON.parse(localStorage.getItem("linesTable")),n=JSON.parse(localStorage.getItem("areasTable"));Gv(t,e,n)}else if("empty"===t){Gv([Lv],[Bv],[Vv])}else t||Xv()})}else Xv();xv.setListeners();const qv=document.getElementById("clearPoints");qv.addEventListener("click",()=>Iv(".point")),qv.addEventListener("mouseover",()=>{h.a.selectAll(".point").attr("opacity","0.4"),setTimeout(()=>{h.a.selectAll(".point").attr("opacity","1")},600)});const Kv=document.getElementById("clearLines");Kv.addEventListener("click",()=>Iv(".ternary-line")),Kv.addEventListener("mouseover",()=>{h.a.selectAll(".ternary-line").attr("stroke-opacity","0.3"),setTimeout(()=>{h.a.selectAll(".ternary-line").attr("stroke-opacity","1")},600)});const $v=document.getElementById("clearAreas");$v.addEventListener("click",()=>Iv(".ternary-area")),$v.addEventListener("mouseover",()=>{h.a.selectAll(".ternary-area").attr("opacity","0.1"),setTimeout(()=>{h.a.selectAll(".ternary-area").attr("opacity","1")},600)}),document.querySelectorAll(".clearLabels").forEach(t=>{t.addEventListener("click",Mv),t.addEventListener("mouseover",()=>{h.a.selectAll(".vertex-label").attr("text-decoration","line-through"),setTimeout(()=>{h.a.selectAll(".vertex-label").attr("text-decoration","none")},600)})});const Qv=document.getElementById("clearAll");function Zv(t,e){Kp()(`This will remove all values you have entered into ${e}`,"There's no going back once you click OK!",{buttons:["Cancel","OK, remove values"],icon:"warning"}).then(e=>{e&&t.forEach(t=>{let e;switch(t){case Hv:e=Lv;break;case Uv:e=Bv;break;case Yv:e=Vv;break;default:e=[]}t.loadData([e])})})}Qv.addEventListener("click",(function(){Iv(".ternary-line,.ternary-area,.point"),Mv()})),Qv.addEventListener("mouseover",()=>{h.a.selectAll(".ternary-line,.vertex-label,.ternary-area,.point").attr("opacity","0.3").attr("text-decoration","line-through").attr("stroke-opacity","0.3"),setTimeout(()=>{h.a.selectAll(".ternary-line,.vertex-label,.ternary-area,.point").attr("opacity","1").attr("text-decoration","none").attr("stroke-opacity","1")},600)}),document.getElementById("clearAllTables").addEventListener("click",()=>{Zv([Hv,Uv,Yv],"all tables.")}),document.getElementById("clearPointsTable").addEventListener("click",()=>{Zv([Hv],"the points table.")}),document.getElementById("clearLinesTable").addEventListener("click",()=>{Zv([Uv],"the lines table.")}),document.getElementById("clearAreasTable").addEventListener("click",()=>{Zv([Yv],"the areas table.")})},,,,function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return c}));var r=n(16),o=n(42),i=n(101),a=n(157),s=function(){function t(t,e,n){void 0===e&&(e=new a.a),void 0===n&&(n=3),this._version=n,this._stack=[],this._stack.push({client:t,scope:e})}return t.prototype._invokeClient=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=this.getStackTop();i&&i.client&&i.client[t]&&(e=i.client)[t].apply(e,r.d(n,[i.scope]))},t.prototype.isOlderThan=function(t){return this._version<t},t.prototype.bindClient=function(t){this.getStackTop().client=t},t.prototype.pushScope=function(){var t=this.getStack(),e=t.length>0?t[t.length-1].scope:void 0,n=a.a.clone(e);return this.getStack().push({client:this.getClient(),scope:n}),n},t.prototype.popScope=function(){return void 0!==this.getStack().pop()},t.prototype.withScope=function(t){var e=this.pushScope();try{t(e)}finally{this.popScope()}},t.prototype.getClient=function(){return this.getStackTop().client},t.prototype.getScope=function(){return this.getStackTop().scope},t.prototype.getStack=function(){return this._stack},t.prototype.getStackTop=function(){return this._stack[this._stack.length-1]},t.prototype.captureException=function(t,e){var n=this._lastEventId=Object(o.n)(),i=e;if(!e){var a=void 0;try{throw new Error("Sentry syntheticException")}catch(t){a=t}i={originalException:t,syntheticException:a}}return this._invokeClient("captureException",t,r.a({},i,{event_id:n})),n},t.prototype.captureMessage=function(t,e,n){var i=this._lastEventId=Object(o.n)(),a=n;if(!n){var s=void 0;try{throw new Error(t)}catch(t){s=t}a={originalException:t,syntheticException:s}}return this._invokeClient("captureMessage",t,e,r.a({},a,{event_id:i})),i},t.prototype.captureEvent=function(t,e){var n=this._lastEventId=Object(o.n)();return this._invokeClient("captureEvent",t,r.a({},e,{event_id:n})),n},t.prototype.lastEventId=function(){return this._lastEventId},t.prototype.addBreadcrumb=function(t,e){var n=this.getStackTop();if(n.scope&&n.client){var i=n.client.getOptions&&n.client.getOptions()||{},a=i.beforeBreadcrumb,s=void 0===a?null:a,l=i.maxBreadcrumbs,u=void 0===l?100:l;if(!(u<=0)){var c=Object(o.m)(),f=r.a({timestamp:c},t),h=s?Object(o.c)((function(){return s(f,e)})):f;null!==h&&n.scope.addBreadcrumb(h,Math.min(u,100))}}},t.prototype.setUser=function(t){var e=this.getStackTop();e.scope&&e.scope.setUser(t)},t.prototype.setTags=function(t){var e=this.getStackTop();e.scope&&e.scope.setTags(t)},t.prototype.setExtras=function(t){var e=this.getStackTop();e.scope&&e.scope.setExtras(t)},t.prototype.setTag=function(t,e){var n=this.getStackTop();n.scope&&n.scope.setTag(t,e)},t.prototype.setExtra=function(t,e){var n=this.getStackTop();n.scope&&n.scope.setExtra(t,e)},t.prototype.setContext=function(t,e){var n=this.getStackTop();n.scope&&n.scope.setContext(t,e)},t.prototype.configureScope=function(t){var e=this.getStackTop();e.scope&&e.client&&t(e.scope)},t.prototype.run=function(t){var e=u(this);try{t(this)}finally{u(e)}},t.prototype.getIntegration=function(t){var e=this.getClient();if(!e)return null;try{return e.getIntegration(t)}catch(e){return i.a.warn("Cannot retrieve integration "+t.id+" from the current Hub"),null}},t.prototype.startSpan=function(t,e){return void 0===e&&(e=!1),this._callExtensionMethod("startSpan",t,e)},t.prototype.traceHeaders=function(){return this._callExtensionMethod("traceHeaders")},t.prototype._callExtensionMethod=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=l(),o=r.__SENTRY__;if(o&&o.extensions&&"function"==typeof o.extensions[t])return o.extensions[t].apply(this,e);i.a.warn("Extension method "+t+" couldn't be found, doing nothing.")},t}();function l(){var t=Object(o.g)();return t.__SENTRY__=t.__SENTRY__||{extensions:{},hub:void 0},t}function u(t){var e=l(),n=h(e);return d(e,t),n}function c(){var e=l();return f(e)&&!h(e).isOlderThan(3)||d(e,new s),Object(o.j)()?function(e){try{var n=Object(o.d)(t,"domain").active;if(!n)return h(e);if(!f(n)||h(n).isOlderThan(3)){var r=h(e).getStackTop();d(n,new s(r.client,a.a.clone(r.scope)))}return h(n)}catch(t){return h(e)}}(e):h(e)}function f(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function h(t){return t&&t.__SENTRY__&&t.__SENTRY__.hub?t.__SENTRY__.hub:(t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.hub=new s,t.__SENTRY__.hub)}function d(t,e){return!!t&&(t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.hub=e,!0)}}).call(this,n(263)(t))}]);
//# sourceMappingURL=app.bundle.js.map